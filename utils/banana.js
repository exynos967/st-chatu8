(function(_0x1b0d71,_0x433907){function _0x50c2fc(_0x425c5b,_0x1ac3f4,_0x5aae74,_0x193264){return _0x4c66(_0x5aae74- -0x1be,_0x193264);}const _0x46159e=_0x1b0d71();function _0x5cf702(_0x204543,_0x200016,_0x2db8ef,_0x4a6c2e){return _0x4c66(_0x4a6c2e-0xf4,_0x200016);}while(!![]){try{const _0x31e4d0=-parseInt(_0x5cf702(0x28d,0x293,0x365,0x2d8))/(-0x35d+0xba3+-0x845)+parseInt(_0x50c2fc(0x2c,0x0,-0x30,-0x2f))/(-0x121*-0x5+-0x1*-0xeae+-0x1451*0x1)*(parseInt(_0x50c2fc(0x15,0x9a,0x7f,0x9f))/(0x26db+-0x14b9+-0x121f))+parseInt(_0x5cf702(0x2a7,0x267,0x237,0x2ab))/(-0x7e9+0xa*0x17a+-0x6d7)+parseInt(_0x5cf702(0x323,0x30a,0x3c7,0x385))/(0xd65+-0x11*-0xf0+-0x1d50)*(parseInt(_0x50c2fc(-0x15,0x67,0x44,0x61))/(-0x2257+-0x1907*-0x1+0xa*0xef))+-parseInt(_0x50c2fc(0xa,0xf8,0x77,0x4e))/(-0x23d6+0x2*-0x1048+-0x3*-0x16cf)+parseInt(_0x5cf702(0x264,0x290,0x310,0x27f))/(-0xe09*-0x2+-0x32*-0x86+-0x3636)*(-parseInt(_0x50c2fc(-0x52,-0x6c,-0x46,-0x70))/(0x75b+-0x1d41+-0x15ef*-0x1))+-parseInt(_0x50c2fc(-0x1c,0xd,-0x37,-0x5e))/(-0x1f9b+-0x1b*-0x102+0x46f);if(_0x31e4d0===_0x433907)break;else _0x46159e['push'](_0x46159e['shift']());}catch(_0x21dd29){_0x46159e['push'](_0x46159e['shift']());}}}(_0x3f02,0x103899+0x1*0x6df91+-0xcd46f));const _0x540607=(function(){let _0x11a45f=!![];return function(_0x59276f,_0x504f8f){const _0x417730=_0x11a45f?function(){function _0x37a05a(_0xf7c66c,_0x528822,_0x4d0c82,_0x2999b0){return _0x4c66(_0x528822- -0x1b0,_0x2999b0);}if(_0x504f8f){const _0x1a7d73=_0x504f8f[_0x37a05a(0x42,0xac,0x94,0x66)](_0x59276f,arguments);return _0x504f8f=null,_0x1a7d73;}}:function(){};return _0x11a45f=![],_0x417730;};}()),_0x138d47=_0x540607(this,function(){const _0x1e0ede={};function _0x590ec1(_0x26c1a8,_0x2f44cc,_0xaa2619,_0x234f12){return _0x4c66(_0xaa2619-0x2cc,_0x2f44cc);}function _0x359699(_0x60f2f9,_0x586786,_0x10248b,_0x1c7bd2){return _0x4c66(_0x60f2f9- -0xb7,_0x586786);}_0x1e0ede[_0x590ec1(0x5bd,0x4c4,0x551,0x58f)]='(((.+)+)+)'+'+$';const _0x6f4194=_0x1e0ede;return _0x138d47['toString']()[_0x590ec1(0x45e,0x446,0x475,0x453)](_0x6f4194[_0x359699(0x1ce,0x1e8,0x259,0x235)])[_0x590ec1(0x433,0x4d0,0x445,0x401)]()[_0x359699(0x114,0x145,0x16c,0x166)+'r'](_0x138d47)[_0x590ec1(0x4ae,0x446,0x475,0x3f7)](_0x590ec1(0x46b,0x45c,0x4be,0x4c8)+'+$');});_0x138d47();import{extension_settings}from'../../../../extensions.js';import{eventSource}from'../../../../../script.js';function _0x4c66(_0x249cbd,_0x50caa6){_0x249cbd=_0x249cbd-(-0x7b*0x35+0x1*-0x1795+-0x194*-0x20);const _0x18ce5d=_0x3f02();let _0x100344=_0x18ce5d[_0x249cbd];if(_0x4c66['izrWlR']===undefined){var _0x5e9dc6=function(_0x333914){const _0x44eebf='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x19dc9d='',_0x286520='',_0x26dbfd=_0x19dc9d+_0x5e9dc6;for(let _0xce80a8=-0x6da*0x1+0x936+-0x25c,_0x4cb135,_0x429425,_0x4ebd26=0x201d+-0xcc8+-0x1355;_0x429425=_0x333914['charAt'](_0x4ebd26++);~_0x429425&&(_0x4cb135=_0xce80a8%(-0x1a58+-0x1606+-0x2*-0x1831)?_0x4cb135*(0x1*0x208f+-0x44e+-0x1c01)+_0x429425:_0x429425,_0xce80a8++%(0x8d0+0x46*0x1+-0x912*0x1))?_0x19dc9d+=_0x26dbfd['charCodeAt'](_0x4ebd26+(0x3*0x88b+-0xc*-0x2a2+0x392f*-0x1))-(0x2109+0xef3+0x22*-0x169)!==-0x4a*0xb+-0x1*-0x10be+-0x70*0x1f?String['fromCharCode'](0xd*0x5b+0x214a*-0x1+0x1daa*0x1&_0x4cb135>>(-(0x25*-0x4d+0x11a8+-0x685)*_0xce80a8&-0x368+-0x27b*-0x1+0xf3)):_0xce80a8:0x11d2+0x2023+-0x31f5){_0x429425=_0x44eebf['indexOf'](_0x429425);}for(let _0x2cee81=0xf*0x285+-0x141*-0x5+-0xeb0*0x3,_0x1e76ee=_0x19dc9d['length'];_0x2cee81<_0x1e76ee;_0x2cee81++){_0x286520+='%'+('00'+_0x19dc9d['charCodeAt'](_0x2cee81)['toString'](0x20ff*0x1+-0x772+0xf*-0x1b3))['slice'](-(-0x1c5b+-0x1*0xd95+0x29f2));}return decodeURIComponent(_0x286520);};_0x4c66['onfslw']=_0x5e9dc6,_0x4c66['IWaWWi']={},_0x4c66['izrWlR']=!![];}const _0x1876d0=_0x18ce5d[-0x237*0x3+-0x8*0x15b+0x25*0x79],_0x520dc8=_0x249cbd+_0x1876d0,_0x56ad73=_0x4c66['IWaWWi'][_0x520dc8];if(!_0x56ad73){const _0x442ee5=function(_0x573980){this['cKzune']=_0x573980,this['WdTVXa']=[-0x90d+-0x2*-0x1227+-0x1b40,0xc5f*-0x2+-0x2477+0x9*0x6cd,0x86+-0x20c+-0x82*-0x3],this['IWJvGI']=function(){return'newState';},this['toofDd']='\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*',this['HpdDTX']='[\x27|\x22].+[\x27|\x22];?\x20*}';};_0x442ee5['prototype']['mOlmJX']=function(){const _0x33eced=new RegExp(this['toofDd']+this['HpdDTX']),_0x5eea01=_0x33eced['test'](this['IWJvGI']['toString']())?--this['WdTVXa'][0xaa0+-0x1cb8+-0x71*-0x29]:--this['WdTVXa'][0x10af*0x1+0x10a4+-0x2153*0x1];return this['ELDvSU'](_0x5eea01);},_0x442ee5['prototype']['ELDvSU']=function(_0x16f0f7){if(!Boolean(~_0x16f0f7))return _0x16f0f7;return this['SeCXcv'](this['cKzune']);},_0x442ee5['prototype']['SeCXcv']=function(_0x32a324){for(let _0xda0c16=-0x299+-0x26a+0x503,_0x403d24=this['WdTVXa']['length'];_0xda0c16<_0x403d24;_0xda0c16++){this['WdTVXa']['push'](Math['round'](Math['random']())),_0x403d24=this['WdTVXa']['length'];}return _0x32a324(this['WdTVXa'][-0xe85+0x246d+0x2bd*-0x8]);},new _0x442ee5(_0x4c66)['mOlmJX'](),_0x100344=_0x4c66['onfslw'](_0x100344),_0x4c66['IWaWWi'][_0x520dc8]=_0x100344;}else _0x100344=_0x56ad73;return _0x100344;}import{extensionName,EventType}from'./config.js';function _0x296165(_0x2cd78a,_0x49c3f6,_0x32be72,_0x30bb0e){return _0x4c66(_0x2cd78a- -0x28b,_0x30bb0e);}function _0x433658(_0xa01af0,_0x45aa9c,_0xd36f55,_0xfd2ee9){return _0x4c66(_0xa01af0- -0x1c1,_0xfd2ee9);}import{sleep,generateRandomSeed,zhengmian,fumian,getRequestHeaders,prompt_replace,addLog,clearLog,parsePromptStringWithCoordinates,prompt_replace_for_character,stripChineseAnnotations}from'./utils.js';import{initializeImageProcessing}from'./iframe.js';import{processCharacterPrompt}from'./characterprompt.js';import{setItemImg}from'./database.js';import{getConfigImage}from'./configDatabase.js';async function getImageFromTurnData(_0x135b12){const _0x4d62de={'UUKRg':_0x10f994(0x13f,0xd5,0x132,0xc6),'dQRco':function(_0x460133,_0x2d420b){return _0x460133(_0x2d420b);},'oaGnz':function(_0x141862,_0x52cfef){return _0x141862||_0x52cfef;},'icifk':_0x10f994(0x113,0x14f,0x192,0x16e),'cSAHL':_0x10f994(0x18d,0xde,0xd9,0x134)};if(!_0x135b12)return'';if(_0x135b12[_0x10f994(0x1b9,0xe9,0xe4,0x137)]&&_0x135b12[_0x271547(-0x4d,-0x26,-0x8a,-0x8a)]['startsWith'](_0x4d62de[_0x10f994(0x1d6,0x116,0x18a,0x156)])){const _0x9327cb=await _0x4d62de[_0x271547(-0x55,-0x28,-0x9,-0x12)](getConfigImage,_0x135b12[_0x271547(-0x9c,-0x16,-0xaf,-0x8a)]);return _0x4d62de[_0x271547(-0xa8,-0xf4,-0xef,-0x7a)](_0x9327cb,'');}function _0x10f994(_0x57daa2,_0x39602e,_0x30da22,_0x4c1c35){return _0x4c66(_0x4c1c35- -0xe8,_0x30da22);}function _0x271547(_0x52ccd2,_0x1e779e,_0x4f95a8,_0x47acd1){return _0x4c66(_0x47acd1- -0x2a9,_0x52ccd2);}if(_0x135b12['image']&&_0x135b12[_0x271547(-0x54,0x49,0x3f,-0x1d)][_0x271547(-0x3f,-0xd6,-0x157,-0xd0)](_0x4d62de[_0x271547(-0x4d,-0x112,-0x10c,-0xd1)])){if(_0x4d62de[_0x271547(-0x57,-0x7,0x47,-0x48)]===_0x10f994(0x117,0xc2,0x184,0x134))return _0x135b12[_0x10f994(0x1ca,0x191,0x235,0x1a4)];else _0x10e68e=_0xa8b64b[_0x10f994(0x102,0xcd,0xc8,0xcd)](_0x271547(-0xe0,-0x124,-0x7c,-0x95),'');}return'';}function _0x3f02(){const _0xe70dd2=['kcGOlISPkYKRkq','qMTryNC','AxrOihn0yxr1CW','5lIT55QeihbYB21WDooaGG','5zco572U5yMn','Dgv4Da','l3yXyMv0ys9TBW','CM9Szq','zw5KAw5NihjLCq','w0jHBMfUyv0Gsq','s29HBxe','z0zHC1O','v3PXBM4','tufhrv9srvnqtW','AfbOqMS','zwHyCxu','nMrIAfrjwq','qMfUyw5HtgLZDa','q29UDgvUDc1uEq','kerPDMLKzv9YBW','C3nMDwXSEs4','ue9tva','CMvWBgfJzq','vezvv1u','5zU+5Rwb56Il44cc5A6I5OI356UV5lI6','BgvUz3rO','zML4zwrqCM9TCa','ChjVBxb0','55sO5lQgihVKV67LM759ioAGH+IVHG','DcbMywLSzwqGDW','qLP1Cvy','qxbPuuy','yxnWzwn0uMf0Aq','AxnbCNjHEq','E+s/RUwBVN0','vMDZEKu','BvjnDui','DcbVBMX5lcbUBW','zw5LCMf0Aw9Uia','rKrzzLe','w0jHBMfUyv0GuG','zMfPBgvKigzVCG','yvPjsgW','rwDtBwC','B3nPDgLVBG','Aw1Hz2vjza','zgvSCY8','zxnWB25ZzsbJBW','DM1iqw4','ieLeia','yKPwCNy','BKzZrwW','vhbLvMG','CIbWCM9TChq6ia','l3yXlW','Aw1Hz2veyxrH','5Q2J6z2I5O+q56s66k+noIa','EhLVqu8','vLnKqNy','w0jHBMfUyv0Gua','BNrHAw5ZihrLEa','B2fhBNO','B2fKihDPDgGG','w0jHBMfUyv0G5zcV','BwfNzs1YzxnWBW','Aw5ZDgfUy2vZ','Bw9Kzq','mtiXnduWAe9dBunH','DvPoBeK','Evjct1i','zMLSDgvY','AgL2twK','CxH1sw4','tLnf','wuXzuxi','mZq5mde4mLDSA1v6yW','vvvluMC','zLHkywO','Aw1Hz2vdB25MAq','z29frhO','vev1rxC','rhfvuey','BwL0DgvKigzHAq','5zU+5yop5BEY5A2y5ywL5PwW5O2U5BQtigy','q2HHCMfJDgvYia','CgfYyw1LDgvYCW','uvjbC0m','y29UDMvYC2f0Aq','BwfNzv9Yzxf1zq','BNnL','Aw9U','uLnHqLG','Bw9KywWGCgf5Ba','vxHPwLu','Cw5ju1O','ywDLigDLBMvYyq','zw5KC1DPDgG','BwvZC2fNzxm','iIbMCM9TihbYzq','5yIg6kEs6iMY5QIH5BYpoIdOP6pMNPdLUky','zgf0ytPPBwfNzq','w0jHBMfUyv0G5l2/','yMfUyw5Hq2HHCG','rfrXr2C','5zU+5QIH5BYp77YA5BEY5RE75yQG5B6f5l+U5Ps5','ruvsCLq','yxbWBhK','svnYvgC','5yMn572U5yMn','5Qch5yEg5QIH5BYpoIdKVB/NLkJOR7FMSyi','5yMn572U5zco','y1nbseW','twXpufG','5zU+5lQl5lU255Ur5zcS5zMO5BEY5ywZ6zET44cc','B3vUzcbTyxrJAa','DuX0Awi','qxPlvMO','zxjYB3i','DxnLCG','ywn0zxjqCMvZzq','C3rYAw5NAwz5','5zU+5QIH5BYp77YA5OYh5lUKid0G','CMvTB3zLtgLZDa','DvLTAxi','tKLuA2q','AM9PBG','w0jHBMfUyv0GrW','Au1vDMO','qMfUyw5H5l+U5zU+5QIH5BYp','DxzOz2i','twfJuee','wxrnEu0','qNLbrhq','refWzgq','ExDirMe','Bxb0','Aw5JBhvKzxm','C2v0ici','Cg9ZDgzPEfbYBW','57Yt5A2y6k6+572U5lI65lIn5A2y5ywL5PwW5O2U','DgLVBIbYzxf1zq','q3DwAeq','Aw5PDgLHBgL6zq','Cvj2v24','55Qe5zU+54Mh','Egv2sLK','qKz6swm','ve5Yze0','EhfqBeq','5zco572U5zco','DwvZDcb0BZOG','zw5bssbMB3jTyq','Bvfbwge','zM9YrwfJAa','Aw1Hz2u','wNfWr1K','zwnLAxzLzcbPBq','venyrNq','thrgtvO','mJKWota0nwveu3jwyW','y29UDgvUDa','sLfcC1C','BNnLigzVCIbjra','5BYa5AEliejHBMfUyEEuNW','rejrtKK','zffsy28','wNjVDM0','ChvZAa','re9KvNG','sxH5t3O','v1rKsMq','wK1Nyvq','u3PftNi','DhLWzq','y2XPzw50','y2fJAgu','y3bAyLa','mtu3nte2mKPOAu1QEG','Dg9tDhjPBMC','DxjS','qKnKDNu','C3vJy2vZCW','yxbWBgLJyxrPBW','v016ze4','CuX1B1K','Dg9mB3DLCKnHCW','zMD6s2y','Dw1KrLC','zLL5vgW','B21WBgv0Aw9UCW','DgLVBIb3AxrOia','C3qGkeLeoIa','mtaWnJu1mhL2CxDNBq','5l+U5zU+5zU+54MhoIbB5BEY5O+q5l6B','rhvnt3a','z2vUzxjHDgvFAq','ndbuzvbkC08','w0jHBMfUyv0Grq','CMTIBvi','mKnJDufbAW','qxfmseW','v0rRDNC','D2L0AcbWCM9TCa','y2HHBMDL','ifbYB21WDa','v0rxruu','EuTMCvu','tufhrv9srvfvrq','DdOG','qMvHCMvYia','Bw9KzwW','rKjAsLe','r0vorvjbvevFsq','EenuBfm','DwLSDcbjBwfNzq','Exflufe','BgvZktOG','BIbWyxLSB2fKia','z2vUzxjHDguTAq','l3yXl2nOyxqVyW','BeD2Agy','BKz1tuu','5z2q5Qch55Qe5O+q56s66k+n5A2x56YM5lIY44cc','zw1PDa','v3LNqLK','BfrkALm','C2vHCMnO','qvbjihjLCxvLCW','s0LLy0O','t3vLzwu','BLjoyM4','y2zNAw1NxW','qwHvs0K','w0jHBMfUyv0G5l+U','rvPurfa','AgLPAxu','w0jHBMfUyv0GuW','qwPszLe','CMvWBgfJzufSBa','qxv0Ag9YAxPHDa','ndaXntm4mhDtzvbACG','zuHWsKy','5B2t5yMn55sF5zU+5QYH5PwW5lI6igzV','AhPSq3K','zuvoBLa','t3jwshK','l3yX','qvbjihjLC3bVBG','w0jHBMfUyv0G55sF','wNjms2S','ANnVBG','yMTkyue','DhjPBq','shfpzuK','55sO5l+U5zU+6Ake6k6+oIaI','BwL0DgvKihn1yW','DfnJwMu','zxrJAcbLCNjVCG','zw5LCG','BwfNzsbPBIbpCa','y29UC3rYDwn0BW','5lU255Ur5zcS5zMO5BEY5yID5AEl5yYw44cc','yxrLzcbZDwnJzq','DwLSDcbTDwX0Aq','yMfUyw5H','BwfW','5PYa5zco572U','ihWG','zxL1D2O','lcdPQ5JLUQyGlsa','BwvZC2fNzq','y2LZAhu','yuTVALe','AwnPzMS','C3rHCNrZv2L0Aa','5l+U5zU+5OYh5lUKoIa','Dxjkteq','BxHLu1m','DhjPz2DLCNm','w0jHBMfUyv0GqG','Aw1Hz2vFDxjS','6k+35Rgc5Bc65A+4oIdLRR3LUQyGlq','rvbWvvC','u0XQu0m','vfPsANu','mta4mZi1nhbTB1Hkua','rM1krfC','BLjcuxK','CLfPseq','y1Lhr1C','DwX6Eeq','w0jHBMfUyv0GrG','B3iGChjVBxb0oG','igLTywDLlG','yxnZAxn0yw50','C2fTCgXLq291BG','rxLKC28','v1rzELi','CwrUB2i'];_0x3f02=function(){return _0xe70dd2;};return _0x3f02();}async function generateBananaImage({prompt:_0xff49f5,width:_0x46fbc4,height:_0x1174b9,change:_0x8e7b43,retouchPrompt:_0x4fc669,retouchImage:_0x4bf022}){const _0x546b5d={'iMUvj':function(_0x2e67cf,_0x17d181){return _0x2e67cf<=_0x17d181;},'DOdVx':function(_0x1e077c,_0x3799ac){return _0x1e077c+_0x3799ac;},'lTJjS':function(_0x6a6aab,_0x111218){return _0x6a6aab(_0x111218);},'rcVRe':function(_0x2cc8ff){return _0x2cc8ff();},'UcLZY':function(_0x410d32,_0x55112b){return _0x410d32(_0x55112b);},'uvhgb':'Scene\x20Comp'+_0x593642(0x2ae,0x2da,0x270,0x28a),'zFOka':'标准模式:\x20使用请求'+_0x593642(0x2d5,0x229,0x247,0x1ec),'EZTDP':_0x593642(0x274,0x1ff,0x211,0x1d6)+_0x13ad68(0x59b,0x5c8,0x619,0x61b),'DszPU':function(_0x5c3852,_0x151f81){return _0x5c3852(_0x151f81);},'yRBOR':_0x13ad68(0x5b5,0x542,0x574,0x5e2)+'se\x20did\x20not'+'\x20contain\x20i'+_0x13ad68(0x4f3,0x570,0x580,0x5c7)+_0x13ad68(0x5d9,0x60e,0x63f,0x5f1)+'t','WTYzR':function(_0x5211e6,_0x3206b2){return _0x5211e6+_0x3206b2;},'hPhBk':function(_0xc9ae0f,_0x543ee1){return _0xc9ae0f+_0x543ee1;},'NITkd':function(_0x4ca175,_0x352dfc){return _0x4ca175(_0x352dfc);},'eyuwj':_0x13ad68(0x5b0,0x5d8,0x5d0,0x5c3)+_0x593642(0x235,0x289,0x273,0x27e)+_0x593642(0x2bf,0x2d2,0x280,0x2fc)+_0x13ad68(0x652,0x65e,0x5cd,0x661)+_0x593642(0x281,0x237,0x23e,0x2a3),'Zrovm':_0x593642(0x2c8,0x271,0x2b0,0x25a),'uLtib':_0x13ad68(0x66d,0x660,0x616,0x615),'HqOeI':_0x593642(0x35a,0x2f9,0x2d9,0x258),'DqUPF':_0x13ad68(0x54e,0x53a,0x587,0x532),'gXiOu':function(_0x68c01e,_0x368a48){return _0x68c01e(_0x368a48);},'fAzet':function(_0x143381,_0x27a37a){return _0x143381(_0x27a37a);},'nFuME':function(_0x5d3dfa,_0x4f70fa){return _0x5d3dfa(_0x4f70fa);},'ZqpGY':function(_0x1eb9c,_0x25bf1c){return _0x1eb9c||_0x25bf1c;},'YtMyM':function(_0x3dc9e1,_0x2bae60){return _0x3dc9e1(_0x2bae60);},'AqLHL':function(_0xdd7b9e,_0x1ebfac){return _0xdd7b9e!==_0x1ebfac;},'exTIy':_0x13ad68(0x5b5,0x602,0x62d,0x686),'VWFcW':_0x593642(0x242,0x207,0x24e,0x275),'SzENr':function(_0x2cbceb,_0x43c61d){return _0x2cbceb(_0x43c61d);},'eENnP':function(_0x49194c,_0x22bb8f){return _0x49194c(_0x22bb8f);},'lxPFI':function(_0x401763,_0x455dc1){return _0x401763+_0x455dc1;},'qLuoY':function(_0x319efe,_0x4ee971){return _0x319efe+_0x4ee971;},'KIecJ':function(_0x4e259a,_0x38daaa){return _0x4e259a+_0x38daaa;},'hvfrV':function(_0x571d6e,_0x395d72){return _0x571d6e(_0x395d72);},'WDWEE':'imagen','WMzdN':_0x13ad68(0x54f,0x532,0x5ac,0x5b3),'OKftY':function(_0x324384,_0xd53085){return _0x324384(_0xd53085);},'bJVrv':_0x13ad68(0x624,0x5af,0x62e,0x5d1),'hzlCy':_0x13ad68(0x4da,0x597,0x558,0x548)+_0x593642(0x20c,0x1dc,0x1d6,0x24f),'cpZbP':_0x13ad68(0x581,0x5df,0x5ca,0x5d0),'lGvhf':_0x593642(0x2a4,0x2bd,0x250,0x24f),'EgSmg':function(_0x1f70ca,_0x26dd5a){return _0x1f70ca(_0x26dd5a);},'FBZJQ':_0x593642(0x21e,0x1f1,0x249,0x2c2),'pAelT':function(_0x374c42,_0x205239){return _0x374c42(_0x205239);},'BZuqV':'image_url','yKfqU':'tRyoy','ApiQF':_0x13ad68(0x4e2,0x5c2,0x554,0x5c4),'uZNlI':'plhld','umdFW':'SKVkL','IxyOz':function(_0x2f752c,_0x45e085){return _0x2f752c!==_0x45e085;},'nRBQy':_0x593642(0x253,0x318,0x2a2,0x242),'fYyTl':_0x13ad68(0x63e,0x61e,0x61e,0x5e0),'qdnob':function(_0x454be1,_0x267629){return _0x454be1(_0x267629);},'zsjuN':function(_0x3bdfda,_0x5cb103){return _0x3bdfda>_0x5cb103;},'QRAsC':_0x13ad68(0x562,0x57c,0x5f2,0x65c),'VSdBv':_0x593642(0x27d,0x29f,0x23f,0x2d1),'fXJaj':function(_0x1e5b24,_0x4bf411){return _0x1e5b24===_0x4bf411;},'hiiiu':_0x13ad68(0x610,0x581,0x611,0x5a0),'TEuEw':_0x13ad68(0x5ce,0x666,0x646,0x6ca),'mQAXa':function(_0x7a3f52,_0x537288){return _0x7a3f52(_0x537288);},'aKojQ':function(_0xbccd9,_0x388a3f){return _0xbccd9(_0x388a3f);},'TZRju':_0x593642(0x221,0x276,0x20f,0x1cd),'xyoAO':_0x593642(0x26e,0x26a,0x27a,0x308),'ZrLKk':_0x13ad68(0x63c,0x625,0x605,0x5fe),'DBQNI':function(_0x1ebe7a,_0xfbaaf){return _0x1ebe7a+_0xfbaaf;},'xCTlS':function(_0x295efb,_0x1e0905){return _0x295efb+_0x1e0905;},'uYmir':function(_0x43d351,_0x2c29b8){return _0x43d351(_0x2c29b8);},'BkQbw':function(_0x58d4ad,_0x74b2fd){return _0x58d4ad(_0x74b2fd);},'mrMxo':function(_0x17fe20,_0x1d3a7e,_0x50af78){return _0x17fe20(_0x1d3a7e,_0x50af78);},'SYyWe':_0x13ad68(0x539,0x530,0x5bd,0x5fd),'VwVen':function(_0x575ac3,_0x109747){return _0x575ac3!==_0x109747;},'FDYfQ':_0x13ad68(0x607,0x5d0,0x635,0x666),'OrVHy':_0x13ad68(0x5c9,0x5a4,0x592,0x613),'nGlAQ':_0x593642(0x332,0x279,0x2b8,0x2cd),'HDTnb':_0x13ad68(0x59c,0x537,0x59b,0x539),'iFtAP':function(_0x3140d2,_0x2a409){return _0x3140d2===_0x2a409;},'fgzKf':_0x593642(0x23a,0x314,0x293,0x208),'SLjSC':_0x593642(0x317,0x33d,0x2c8,0x29e),'rkbmR':function(_0x489f0d,_0xba6fb3){return _0x489f0d===_0xba6fb3;},'nFsEl':'string','MlOPX':_0x593642(0x19f,0x18b,0x1cd,0x159),'BFzIc':function(_0x3ebd4a,_0x46ba74){return _0x3ebd4a!==_0x46ba74;},'RSaBX':'cALsB'};_0xff49f5=_0x546b5d['UcLZY'](processCharacterPrompt,_0xff49f5),_0xff49f5=await _0x546b5d[_0x593642(0x252,0x337,0x2c0,0x287)](stripChineseAnnotations,_0xff49f5);function _0x13ad68(_0x5cb1dd,_0x2ef121,_0x5f3f12,_0x42e80f){return _0x4c66(_0x5f3f12-0x3b6,_0x42e80f);}let _0x13f6b2=_0x8e7b43;_0x8e7b43=processCharacterPrompt(_0x8e7b43),_0x8e7b43=await stripChineseAnnotations(_0x8e7b43),_0x546b5d[_0x13ad68(0x5a8,0x599,0x55a,0x4e4)](addLog,_0x13ad68(0x5e3,0x5fa,0x64b,0x68e)+_0x13ad68(0x5c7,0x593,0x5c0,0x5e9)+extension_settings[extensionName][_0x593642(0x14f,0x14a,0x1c7,0x17d)]),_0x546b5d[_0x593642(0x261,0x287,0x1fa,0x1c4)](addLog,_0x593642(0x2af,0x202,0x232,0x280)+'\x20'+_0x546b5d[_0x13ad68(0x5d9,0x68c,0x643,0x5cb)](_0x46fbc4,'默认')+_0x13ad68(0x517,0x582,0x58a,0x50d)+(_0x1174b9||'默认')),_0xff49f5=_0x8e7b43&&_0x8e7b43[_0x593642(0x1ea,0x1cc,0x215,0x1a6)]()!==''?_0x8e7b43:_0xff49f5,_0x546b5d[_0x593642(0x28d,0x2d7,0x2c7,0x350)](addLog,'用于生成的Tag:\x20'+_0xff49f5);let _0x4ebbf2=![];if(_0xff49f5[_0x593642(0x28a,0x335,0x2cc,0x313)](_0x546b5d[_0x13ad68(0x5b2,0x59b,0x629,0x5e1)])){if(_0x546b5d[_0x13ad68(0x509,0x4fa,0x545,0x534)](_0x546b5d['exTIy'],_0x546b5d['VWFcW']))_0x4ebbf2=!![];else for(let _0x3e2773=0x2*-0xdf1+0x1565+-0x2*-0x33f;_0x546b5d[_0x593642(0x247,0x2c1,0x2c3,0x33b)](_0x3e2773,0x2533+0x866+-0x2d95);_0x3e2773++){_0x1520d9['Character\x20'+_0x3e2773+_0x593642(0x1c7,0x175,0x1e5,0x24d)]&&(_0x2229f1=_0x546b5d[_0x13ad68(0x5e6,0x69f,0x650,0x657)](_0x359c2d,_0x593642(0x1ba,0x267,0x224,0x240))+_0x546b5d[_0x593642(0x195,0x19b,0x1fa,0x20a)](_0x65a65c,_0x2c84aa['Character\x20'+_0x3e2773+_0x593642(0x1f8,0x270,0x1e5,0x189)]));}}_0x546b5d[_0x593642(0x2b0,0x260,0x2f0,0x354)](addLog,'是否启用分角色模式\x20'+_0x13ad68(0x60e,0x5ac,0x5bb,0x588)+_0x593642(0x18c,0x164,0x1f1,0x235)+_0x4ebbf2);let _0x2fd2ea={},_0x131778='',_0x6b7076='';if(_0x4ebbf2){addLog(_0x13ad68(0x613,0x617,0x60b,0x61b)+_0x13ad68(0x5d8,0x520,0x55b,0x5d5)),_0x2fd2ea=_0x546b5d[_0x593642(0x276,0x1a8,0x20d,0x259)](parsePromptStringWithCoordinates,_0xff49f5),_0x131778=_0x2fd2ea[_0x546b5d[_0x593642(0x305,0x23f,0x2c5,0x25b)]];for(let _0x8e913d=-0x3*0x499+0x128b+0x87*-0x9;_0x546b5d[_0x13ad68(0x640,0x64d,0x627,0x68b)](_0x8e913d,-0x1*0x2039+0x1*0xb19+-0x4*-0x549);_0x8e913d++){_0x2fd2ea[_0x593642(0x241,0x327,0x298,0x2d9)+_0x8e913d+_0x593642(0x1dd,0x220,0x1e5,0x17d)]&&(_0x6b7076=_0x546b5d['lxPFI'](_0x546b5d[_0x593642(0x241,0x221,0x1d1,0x23f)](_0x6b7076,',\x20'),_0x2fd2ea[_0x593642(0x204,0x29a,0x298,0x223)+_0x8e913d+'\x20Prompt']));}}else _0x546b5d[_0x13ad68(0x5e4,0x505,0x55e,0x532)](addLog,_0x13ad68(0x697,0x620,0x615,0x61f)+_0x13ad68(0x5bf,0x58b,0x5ab,0x597)),_0x131778=_0xff49f5;let {modifiedPrompt:_0x205d4d,insertions:_0x558855}=await prompt_replace(_0x131778,_0x6b7076);if(_0x4ebbf2)for(let _0x1d8773=-0x515*-0x2+-0xc5b+0x232;_0x1d8773<=0x2296+0x471+-0x2703;_0x1d8773++){_0x2fd2ea[_0x593642(0x22a,0x306,0x298,0x2af)+_0x1d8773+'\x20Prompt']&&(_0x205d4d=_0x546b5d[_0x593642(0x174,0x211,0x1fd,0x170)](_0x546b5d['DOdVx'](_0x205d4d,_0x13ad68(0x5ca,0x5ce,0x588,0x572)),_0x546b5d['hvfrV'](prompt_replace_for_character,_0x2fd2ea[_0x13ad68(0x690,0x686,0x5fc,0x5e5)+_0x1d8773+_0x13ad68(0x58b,0x50e,0x549,0x542)])));}const _0x1fb422=extension_settings[extensionName][_0x593642(0x1db,0x1d9,0x221,0x192)],{model:_0x16a7ec,apiUrl:_0xc435d0,apiKey:_0x333514,conversationPresets:_0x57dfd1,conversationPresetId:_0x2f21ce,editPresetId:_0x1dd9eb,aspectRatio:_0x2efccc}=_0x1fb422;addLog(_0x593642(0x1d2,0x19c,0x205,0x240)+'tarting\x20im'+_0x593642(0x252,0x26d,0x2a3,0x2e1)+_0x593642(0x1a4,0x22b,0x1d7,0x212)+'model:\x20'+_0x16a7ec);let _0x4919af,_0x3f4360;if(_0x16a7ec[_0x593642(0x21e,0x22c,0x22b,0x1fb)](_0x546b5d[_0x593642(0x1ce,0x23d,0x1e6,0x153)])){_0x4919af='/v1beta/mo'+_0x593642(0x203,0x2e2,0x272,0x205)+_0x16a7ec;const _0x21c26c={};_0x21c26c['fixedPromp'+'t']='';const _0x5c80de=_0x57dfd1[_0x2f21ce]||_0x21c26c,_0x2818c1=[_0x5c80de[_0x13ad68(0x5d7,0x63e,0x5c2,0x650)+'t'],_0x558855[_0x546b5d[_0x593642(0x269,0x2d9,0x2ea,0x335)]],_0x558855[_0x546b5d[_0x13ad68(0x5be,0x64e,0x61b,0x6a4)]],_0x205d4d,_0x558855[_0x546b5d[_0x13ad68(0x59d,0x561,0x534,0x536)]],_0x558855[_0x13ad68(0x66a,0x61e,0x63d,0x626)],_0x5c80de[_0x13ad68(0x633,0x613,0x632,0x5c3)+_0x593642(0x2e3,0x249,0x2cb,0x286)],_0x558855[_0x546b5d[_0x13ad68(0x61f,0x5fb,0x5f9,0x62a)]]][_0x593642(0x2ef,0x2ef,0x28a,0x2a3)](Boolean)[_0x593642(0x34b,0x26a,0x2c1,0x26b)](',\x20');_0x546b5d['OKftY'](addLog,'正面提示词:\x20'+_0x2818c1);const _0x49a69d={};_0x49a69d[_0x13ad68(0x655,0x5d7,0x5c3,0x572)]=_0x2818c1;const _0x15a064={};_0x15a064[_0x13ad68(0x5ae,0x5e5,0x5a4,0x5c4)+'t']=0x1,_0x15a064[_0x13ad68(0x5b7,0x544,0x5c8,0x5d6)+'o']=_0x2efccc;const _0x298d92={};_0x298d92[_0x13ad68(0x646,0x57c,0x5e9,0x5cb)]=[_0x49a69d],_0x298d92[_0x593642(0x21c,0x209,0x299,0x324)]=_0x15a064,_0x3f4360=_0x298d92,addLog(_0x13ad68(0x549,0x509,0x594,0x50c)+_0x13ad68(0x4c5,0x5b7,0x553,0x4e4)+_0x13ad68(0x4d9,0x4c5,0x556,0x5bb)+_0x593642(0x1a1,0x255,0x1e3,0x255)+_0x13ad68(0x4c0,0x590,0x54d,0x573)+_0x2818c1);}else{if(_0x546b5d[_0x593642(0x219,0x254,0x276,0x1ee)]!==_0x546b5d['bJVrv'])_0x117f66[_0x13ad68(0x622,0x5a4,0x636,0x623)+_0x593642(0x28e,0x1d8,0x255,0x2e0)+'ener']=!![],_0x546b5d['rcVRe'](_0x58e6de);else{_0x4919af=_0x546b5d[_0x593642(0x1ab,0x273,0x20c,0x246)];let _0x2ccd99;if(_0x8e7b43[_0x593642(0x2fd,0x2fa,0x2cc,0x239)](_0x546b5d[_0x593642(0x133,0x1a3,0x1c9,0x149)])){if(_0x546b5d[_0x13ad68(0x537,0x57d,0x559,0x4e5)]!==_0x593642(0x214,0x2e2,0x250,0x245)){_0x546b5d['UcLZY'](_0x43e01f,_0x13ad68(0x653,0x60a,0x60b,0x685)+'坐标的提示词字符串。'),_0x5a1496=_0x1b1f38(_0x2b877a),_0x32b6d2=_0x13c593[_0x546b5d[_0x593642(0x2ce,0x35a,0x2c5,0x27b)]];for(let _0x571209=-0x175*-0xa+-0x904+-0x7*0xcb;_0x571209<=0x1c13+-0x5c*-0x13+-0x22e3;_0x571209++){_0x5dd11b[_0x593642(0x215,0x254,0x298,0x2db)+_0x571209+'\x20Prompt']&&(_0x5a619a=_0x546b5d[_0x13ad68(0x5be,0x653,0x650,0x687)](_0x546b5d[_0x13ad68(0x5bf,0x5e1,0x650,0x615)](_0x102305,',\x20'),_0x54199f[_0x13ad68(0x573,0x5c8,0x5fc,0x568)+_0x571209+_0x593642(0x20d,0x1cf,0x1e5,0x27a)]));}}else{_0x546b5d[_0x13ad68(0x57a,0x545,0x5d3,0x5c4)](addLog,'[Banana]\x20启'+_0x13ad68(0x5cd,0x557,0x5c4,0x5de)+'。');const _0x56b6a3=_0x546b5d['ZqpGY'](_0x1dd9eb,'默认'),_0x2378ca={};_0x2378ca['conversati'+'on']=[],_0x2378ca[_0x13ad68(0x5fd,0x62b,0x5c2,0x603)+'t']='',_0x2ccd99=_0x57dfd1[_0x56b6a3]||_0x2378ca,_0x546b5d[_0x13ad68(0x626,0x600,0x654,0x60b)](addLog,_0x13ad68(0x5e3,0x5cb,0x60d,0x5c3)+_0x593642(0x2a5,0x1e4,0x217,0x29c)+_0x56b6a3+'\x22');}}else{const _0x21b6b2={};_0x21b6b2['conversati'+'on']=[],_0x21b6b2[_0x13ad68(0x637,0x567,0x5c2,0x52f)+'t']='',_0x2ccd99=_0x57dfd1[_0x2f21ce]||_0x21b6b2;}const _0x1137e4=[_0x2ccd99[_0x593642(0x266,0x242,0x25e,0x252)+'t'],_0x558855[_0x546b5d[_0x593642(0x2d1,0x2f1,0x2ea,0x2bb)]],_0x558855[_0x546b5d[_0x13ad68(0x598,0x5cc,0x61b,0x5c1)]],_0x205d4d,_0x558855[_0x13ad68(0x529,0x5d7,0x5ac,0x524)],_0x558855[_0x546b5d[_0x593642(0x1f4,0x293,0x216,0x1bd)]],_0x2ccd99[_0x593642(0x25a,0x25d,0x2ce,0x2e3)+_0x593642(0x2c4,0x263,0x2cb,0x259)],_0x558855[_0x546b5d[_0x593642(0x30d,0x2e3,0x295,0x2aa)]]][_0x593642(0x305,0x200,0x28a,0x212)](Boolean)['join'](',\x20');addLog(_0x593642(0x2f2,0x235,0x27c,0x1f2)+_0x1137e4);const _0x2e315f={};_0x2e315f['role']=_0x13ad68(0x5f9,0x675,0x61e,0x660),_0x2e315f[_0x13ad68(0x607,0x5b5,0x648,0x6bf)]=[];const _0x31070b={};_0x31070b['role']=_0x13ad68(0x550,0x537,0x5a3,0x540),_0x31070b[_0x593642(0x2b0,0x365,0x2e4,0x274)]=[];const _0x1ec978=_0x2ccd99['conversati'+'on'][_0x593642(0x1fc,0x288,0x222,0x198)](_0x2f5893=>[_0x2e315f,_0x31070b])['flat']();let _0x4a5d81=-0xfb1+-0x1b1*-0xa+0x139*-0x1;for(const _0x9136cc of _0x2ccd99[_0x13ad68(0x664,0x5c7,0x5ff,0x5ee)+'on']){if(_0x9136cc[_0x13ad68(0x67d,0x6b0,0x61e,0x5ed)]?.['text'])_0x1ec978[_0x4a5d81]['content'][_0x13ad68(0x694,0x6af,0x64f,0x62c)]({'type':_0x546b5d[_0x13ad68(0x546,0x4df,0x550,0x4e0)],'text':_0x9136cc['user'][_0x593642(0x1d1,0x2a6,0x249,0x2d0)]});const _0x52e198=await _0x546b5d['pAelT'](getImageFromTurnData,_0x9136cc[_0x13ad68(0x5ca,0x617,0x61e,0x5ac)]);if(_0x52e198)_0x1ec978[_0x4a5d81][_0x593642(0x27a,0x2b2,0x2e4,0x339)][_0x13ad68(0x6ad,0x5c1,0x64f,0x657)]({'type':_0x546b5d['BZuqV'],'image_url':{'url':_0x52e198}});_0x4a5d81++;if(_0x9136cc[_0x593642(0x235,0x1dd,0x1eb,0x171)]?.['text'])_0x1ec978[_0x4a5d81][_0x13ad68(0x659,0x697,0x648,0x67d)]['push']({'type':_0x546b5d[_0x593642(0x25c,0x25d,0x1ec,0x1db)],'text':_0x9136cc['model']['text']});const _0x1c9544=await _0x546b5d[_0x13ad68(0x5d0,0x59f,0x624,0x5c9)](getImageFromTurnData,_0x9136cc[_0x13ad68(0x55f,0x5d6,0x54f,0x5bd)]);if(_0x1c9544)_0x1ec978[_0x4a5d81]['content']['push']({'type':_0x546b5d[_0x13ad68(0x5c5,0x5dc,0x5c6,0x622)],'image_url':{'url':_0x1c9544}});_0x4a5d81++;}if(!_0x8e7b43[_0x13ad68(0x5c2,0x5d1,0x630,0x5cd)](_0x546b5d[_0x13ad68(0x54e,0x567,0x52d,0x57d)])){if(_0x593642(0x1d3,0x18d,0x1db,0x189)===_0x546b5d[_0x593642(0x173,0x186,0x1e7,0x225)])_0x3b9001[_0x593642(0x259,0x21b,0x298,0x2e3)+_0xd1504c+_0x593642(0x17c,0x181,0x1e5,0x191)]&&(_0x26a822=_0x2793e8+',\x20'+_0x2274a7[_0x593642(0x25a,0x2c7,0x298,0x2cb)+_0x3d35bf+_0x13ad68(0x5db,0x598,0x549,0x583)]);else{const _0x3ddf2d=extension_settings[extensionName][_0x593642(0x2ba,0x247,0x2aa,0x2fb)+_0x593642(0x290,0x2e8,0x2bb,0x258)+'ts']||{};for(const _0x3f0531 in _0x3ddf2d){if(_0x13ad68(0x52a,0x508,0x554,0x559)!==_0x546b5d[_0x13ad68(0x5cb,0x599,0x5c7,0x621)])_0x117e0a(_0x546b5d['zFOka']),_0x32e690=_0x5630ca;else{const _0x19370a=_0x3ddf2d[_0x3f0531],_0x26c4ec=(_0x19370a[_0x593642(0x294,0x279,0x22f,0x244)]||'')['split']('|')['filter'](_0x57ce04=>_0x57ce04['trim']()!=='');for(const _0x205edd of _0x26c4ec){if(_0x1137e4[_0x593642(0x1b8,0x1d4,0x1d2,0x20e)+'e']()[_0x13ad68(0x5c0,0x5ba,0x630,0x62f)](_0x205edd['toLowerCas'+'e']())){_0x546b5d[_0x593642(0x2d0,0x2e9,0x2f0,0x2e3)](addLog,'[Banana]\x20F'+_0x593642(0x257,0x2d0,0x2b6,0x2e6)+'ing\x20trigge'+'r\x20\x22'+_0x205edd+(_0x13ad68(0x621,0x60d,0x60a,0x57f)+_0x593642(0x353,0x34b,0x2cd,0x237))+_0x3f0531+'\x22.');const _0x35b791=_0x19370a[_0x593642(0x225,0x25a,0x29b,0x243)+'on'];if(_0x35b791){if(_0x546b5d[_0x593642(0x1a8,0x196,0x1e1,0x1d1)](_0x546b5d[_0x593642(0x201,0x2f0,0x288,0x239)],_0x546b5d[_0x13ad68(0x4b9,0x5b6,0x538,0x5bc)])){const _0x457d51=[];if(_0x35b791[_0x13ad68(0x61c,0x616,0x61e,0x654)]&&_0x35b791[_0x13ad68(0x6a5,0x629,0x61e,0x687)][_0x593642(0x1e1,0x2ab,0x249,0x2a7)])_0x457d51[_0x593642(0x371,0x2bb,0x2eb,0x2d1)]({'type':_0x546b5d['FBZJQ'],'text':_0x35b791['user'][_0x13ad68(0x606,0x62b,0x5ad,0x579)]});const _0x5da6e5=await _0x546b5d[_0x13ad68(0x4ca,0x58e,0x55e,0x5f2)](getImageFromTurnData,_0x35b791[_0x13ad68(0x605,0x65b,0x61e,0x5e2)]);if(_0x5da6e5)_0x457d51[_0x593642(0x2da,0x27d,0x2eb,0x2cf)]({'type':_0x546b5d[_0x13ad68(0x636,0x5eb,0x5c6,0x5a5)],'image_url':{'url':_0x5da6e5}});if(_0x457d51['length']>-0x24fe+-0x8*0x324+0x3e1e){if(_0x546b5d[_0x593642(0x342,0x34e,0x2ed,0x2f0)](_0x546b5d[_0x593642(0x1bb,0x207,0x238,0x269)],_0x546b5d[_0x13ad68(0x605,0x629,0x59c,0x570)])){if(_0x4ef8ad){const _0x25ff86=_0x599c52['apply'](_0x1b7ac8,arguments);return _0x3f6f57=null,_0x25ff86;}}else{const _0x3be1f1={};_0x3be1f1[_0x13ad68(0x5ab,0x5f2,0x5af,0x576)]=_0x546b5d[_0x13ad68(0x577,0x4fe,0x539,0x59c)],_0x3be1f1[_0x13ad68(0x605,0x63a,0x648,0x637)]=_0x457d51,_0x1ec978['push'](_0x3be1f1);}}const _0x5293ee=[];if(_0x35b791[_0x593642(0x259,0x1a8,0x1eb,0x17b)]&&_0x35b791[_0x13ad68(0x4f0,0x4cc,0x54f,0x4d0)][_0x13ad68(0x53b,0x5a6,0x5ad,0x5f6)])_0x5293ee['push']({'type':'text','text':_0x35b791['model'][_0x593642(0x2cf,0x2b6,0x249,0x20d)]});const _0x210d93=await _0x546b5d[_0x593642(0x2d7,0x23c,0x243,0x1cd)](getImageFromTurnData,_0x35b791['model']);if(_0x210d93)_0x5293ee['push']({'type':_0x546b5d[_0x593642(0x25f,0x28d,0x262,0x2e8)],'image_url':{'url':_0x210d93}});if(_0x546b5d['zsjuN'](_0x5293ee[_0x13ad68(0x534,0x61e,0x5c1,0x62c)],0x35*0x4+-0xdf7+0x1*0xd23)){if(_0x546b5d[_0x13ad68(0x64a,0x5d8,0x5fe,0x636)]==='alzsr')_0x53ee3e[_0x593642(0x2a6,0x2d5,0x2be,0x22e)+_0x593642(0x1bd,0x1fa,0x21b,0x257)](_0x91580f[_0x13ad68(0x55a,0x5b0,0x551,0x557)+'MAGE_REQUE'+'ST'],_0x25574c),_0x5c302b[_0x13ad68(0x637,0x618,0x641,0x623)](_0x174b50=>{function _0x3012d1(_0x26018b,_0x12a9d4,_0x9df173,_0x3796ff){return _0x13ad68(_0x26018b-0x1a0,_0x12a9d4-0xe,_0x12a9d4- -0x284,_0x26018b);}_0xcdb0c0[_0x3012d1(0x412,0x39e,0x321,0x3e1)+'ener'](_0x174b50,_0x4db928);}),_0x59357f[_0x593642(0x241,0x24d,0x2d2,0x2d3)+_0x13ad68(0x549,0x642,0x5b9,0x5be)+_0x13ad68(0x59b,0x508,0x57f,0x599)]=![],_0x546b5d['lTJjS'](_0x3195d0,_0x546b5d[_0x593642(0x17b,0x16e,0x203,0x234)]);else{const _0x511cc7={};_0x511cc7['role']=_0x546b5d[_0x13ad68(0x61d,0x5a3,0x5e2,0x556)],_0x511cc7[_0x13ad68(0x6cd,0x66b,0x648,0x692)]=_0x5293ee,_0x1ec978[_0x593642(0x336,0x2e4,0x2eb,0x2e4)](_0x511cc7);}}}else _0x5290a3[_0x13ad68(0x5ad,0x5b1,0x622,0x596)+'ener'](_0x3653b0,_0x46559e);}break;}}}}}}if(!_0x8e7b43[_0x593642(0x2fe,0x347,0x2cc,0x302)](_0x13ad68(0x5da,0x5aa,0x5ca,0x592))){if(_0x546b5d[_0x593642(0x300,0x2d2,0x291,0x2f5)](_0x546b5d[_0x593642(0x253,0x18f,0x204,0x1c0)],_0x546b5d[_0x593642(0x308,0x21c,0x294,0x24b)]))return _0x31a766[_0x13ad68(0x672,0x5e7,0x642,0x6c8)];else{const _0x228567={};_0x228567[_0x593642(0x1db,0x2c0,0x24b,0x2ac)]=_0x546b5d[_0x593642(0x1ae,0x22a,0x1d5,0x228)],_0x228567['content']=[{'type':_0x546b5d[_0x13ad68(0x53a,0x522,0x550,0x50d)],'text':_0x1137e4}],_0x1ec978[_0x13ad68(0x60e,0x6ba,0x64f,0x638)](_0x228567);}}else{const _0x50be4e=[],_0x17a354=_0x546b5d['ZqpGY'](_0x4fc669,_0x1137e4),_0x3d428a=[_0x2ccd99[_0x13ad68(0x534,0x642,0x5c2,0x616)+'t'],_0x17a354,_0x2ccd99[_0x13ad68(0x5d3,0x67c,0x632,0x5bf)+_0x13ad68(0x627,0x5bf,0x62f,0x5f4)]]['filter'](Boolean)[_0x593642(0x244,0x2fc,0x2c1,0x291)](',\x20'),_0x3d736a={};_0x3d736a[_0x13ad68(0x4f0,0x4da,0x52a,0x55f)]=_0x546b5d[_0x593642(0x236,0x1f8,0x1ec,0x27e)],_0x3d736a[_0x13ad68(0x59d,0x622,0x5ad,0x5bb)]=_0x3d428a,_0x50be4e[_0x593642(0x2aa,0x26f,0x2eb,0x26f)](_0x3d736a);if(_0x4bf022){if(_0x546b5d[_0x593642(0x24d,0x21b,0x1e1,0x1f2)]('TZdXU',_0x13ad68(0x67f,0x694,0x637,0x638))){const _0x205eaa={};_0x205eaa['url']=_0x4bf022;const _0x794bdf={};_0x794bdf['type']=_0x546b5d[_0x13ad68(0x5c4,0x5cf,0x5c6,0x613)],_0x794bdf['image_url']=_0x205eaa,_0x50be4e[_0x593642(0x28e,0x32a,0x2eb,0x341)](_0x794bdf),_0x546b5d[_0x13ad68(0x5e6,0x606,0x640,0x641)](addLog,_0x593642(0x1e0,0x24f,0x202,0x18a)+_0x593642(0x250,0x2af,0x2ac,0x2ab)+'的图片');}else _0x3554ae=!![];}const _0x49a2d7={};_0x49a2d7[_0x593642(0x298,0x1cd,0x24b,0x225)]=_0x546b5d[_0x13ad68(0x50b,0x543,0x539,0x557)],_0x49a2d7[_0x13ad68(0x6a8,0x5c9,0x648,0x62f)]=_0x50be4e,_0x1ec978[_0x13ad68(0x66b,0x611,0x64f,0x62b)](_0x49a2d7),_0x546b5d['DszPU'](addLog,_0x593642(0x187,0x275,0x202,0x238)+_0x593642(0x337,0x28f,0x2bd,0x31a)+_0x3d428a);}const _0x1767d3={};_0x1767d3[_0x593642(0x254,0x296,0x264,0x20c)+'o']=_0x2efccc;const _0x421576={};_0x421576[_0x13ad68(0x5ad,0x561,0x5f6,0x633)+'g']=_0x1767d3,_0x3f4360={'model':_0x16a7ec,'messages':_0x1ec978[_0x593642(0x23e,0x2f4,0x28a,0x275)](_0x30059d=>_0x30059d[_0x13ad68(0x5ba,0x64f,0x648,0x618)][_0x593642(0x2ce,0x239,0x25d,0x2a7)]>0x1ba*-0x8+0x1d*0xb0+0x62*-0x10),'config':_0x421576},_0x546b5d[_0x593642(0x221,0x1a6,0x229,0x1fd)](addLog,_0x593642(0x260,0x29f,0x230,0x228)+_0x13ad68(0x5be,0x5de,0x584,0x500)+_0x13ad68(0x673,0x574,0x604,0x627)+_0x593642(0x2d9,0x240,0x282,0x279)+_0x3f4360[_0x13ad68(0x69f,0x668,0x609,0x63c)]['length']+'\x20messages.');}}let _0x561621=_0xc435d0['replace'](/\/$/,''),_0x5990f4;_0x561621[_0x13ad68(0x64c,0x699,0x608,0x5ea)](_0x546b5d[_0x13ad68(0x522,0x577,0x599,0x5b7)])||_0x561621[_0x593642(0x239,0x281,0x2cc,0x298)](_0x546b5d[_0x13ad68(0x597,0x54c,0x5e1,0x63a)])?_0x546b5d['fXJaj'](_0x546b5d[_0x13ad68(0x5c9,0x51a,0x576,0x5f4)],_0x546b5d[_0x593642(0x1e0,0x1cd,0x212,0x293)])?_0x5990f4=_0x546b5d['DBQNI'](_0x561621,_0x4919af):_0x546b5d['DszPU'](_0x530555,_0x593642(0x24a,0x2e9,0x2cf,0x28e)+'库'):_0x5990f4=_0x546b5d[_0x593642(0x358,0x2ad,0x2e8,0x343)](_0x546b5d[_0x593642(0x1a5,0x1a6,0x1ee,0x192)](_0x561621,_0x13ad68(0x583,0x529,0x573,0x547)),_0x4919af);function _0x593642(_0x24f3b8,_0x38e852,_0x134b3e,_0x41ee2f){return _0x4c66(_0x134b3e-0x52,_0x38e852);}_0x5990f4=_0x5990f4[_0x13ad68(0x5f3,0x64b,0x5be,0x5e1)](/\/v1\/v1\//g,_0x546b5d['xyoAO']),_0x546b5d[_0x13ad68(0x662,0x5b7,0x623,0x5d0)](addLog,'[Banana]\x20S'+_0x593642(0x239,0x223,0x24c,0x25a)+_0x593642(0x30e,0x2f9,0x2da,0x300)+_0x5990f4),_0x546b5d[_0x593642(0x21d,0x1c8,0x245,0x21a)](addLog,_0x13ad68(0x663,0x637,0x5e3,0x622)+'ayload:\x20'+JSON[_0x593642(0x346,0x324,0x2bc,0x271)](_0x3f4360,null,-0x893+-0x1*-0xc5b+-0x1*0x3c6));try{const _0xca3ab2={};_0xca3ab2[_0x593642(0x22e,0x296,0x256,0x2d0)+'pe']=_0x593642(0x140,0x194,0x1cf,0x24f)+'n/json',_0xca3ab2[_0x593642(0x245,0x216,0x208,0x196)+_0x593642(0x2f4,0x2ea,0x29e,0x262)]=_0x593642(0x272,0x1c8,0x1ea,0x26b)+_0x333514;const _0x53a7b3=await _0x546b5d['mrMxo'](fetch,_0x5990f4,{'method':_0x546b5d['SYyWe'],'headers':_0xca3ab2,'body':JSON[_0x593642(0x249,0x246,0x2bc,0x28b)](_0x3f4360)});if(!_0x53a7b3['ok']){if(_0x546b5d['VwVen'](_0x546b5d[_0x13ad68(0x608,0x539,0x5cf,0x57a)],_0x546b5d['FDYfQ']))throw new _0x24259e(_0x546b5d[_0x593642(0x226,0x228,0x289,0x2a3)]);else{const _0x36b773=await _0x53a7b3[_0x13ad68(0x5cd,0x5df,0x5ad,0x5f3)]();throw new Error(_0x13ad68(0x531,0x5a2,0x560,0x553)+_0x13ad68(0x649,0x553,0x5c5,0x65b)+_0x13ad68(0x5bf,0x61f,0x5aa,0x5b3)+'\x20'+_0x53a7b3['status']+':\x20'+_0x36b773);}}const _0x1d729e=await _0x53a7b3[_0x593642(0x1d4,0x299,0x213,0x22d)]();let _0x1e4c90='';const _0x440ae4=_0x1d729e['choices'];if(_0x440ae4&&_0x440ae4[_0x13ad68(0x5a5,0x542,0x5c1,0x629)]>0x1c52+-0x37*0x4b+-0xc35){if(_0x593642(0x27b,0x19c,0x20a,0x1b2)!==_0x546b5d[_0x13ad68(0x519,0x5b0,0x572,0x543)]){const _0x2ddb29=_0x440ae4[0x124a+-0xb*-0x345+0x2b*-0x143][_0x13ad68(0x5c9,0x51c,0x58b,0x5ff)]?.[_0x13ad68(0x677,0x696,0x648,0x5bb)];if(Array[_0x593642(0x257,0x1f3,0x265,0x212)](_0x2ddb29)){if(_0x13ad68(0x65b,0x675,0x649,0x5e3)!==_0x546b5d['nGlAQ'])for(const _0x38043e of _0x2ddb29){if(_0x546b5d['fXJaj']('Lpyco',_0x546b5d['HDTnb'])){_0x39ba5e(_0x593642(0x24e,0x2f1,0x283,0x2dd)+'用了\x20{修图}\x20标识'+'。');const _0x51369d=_0x2d8893||'默认',_0x52eed6={};_0x52eed6[_0x13ad68(0x577,0x66d,0x5ff,0x63d)+'on']=[],_0x52eed6[_0x593642(0x2cd,0x20a,0x25e,0x247)+'t']='',_0x26558c=_0x2471e6[_0x51369d]||_0x52eed6,_0x4d9e37('[Banana]\x20使'+_0x13ad68(0x528,0x5d0,0x57b,0x58c)+_0x51369d+'\x22');}else{if(_0x38043e[_0x593642(0x1a3,0x1fb,0x1c6,0x183)]===_0x546b5d[_0x593642(0x212,0x2b0,0x262,0x2b7)]&&_0x38043e[_0x13ad68(0x5f0,0x58b,0x595,0x5a4)]?.[_0x13ad68(0x5b9,0x5bc,0x530,0x584)]){if(_0x546b5d['iFtAP'](_0x546b5d[_0x593642(0x1c8,0x1a0,0x1d3,0x19c)],_0x546b5d[_0x593642(0x289,0x1cb,0x234,0x21e)]))_0x4877c2['on'](_0x538387,_0x5a23f1);else{_0x1e4c90=_0x38043e[_0x593642(0x1ba,0x1b3,0x231,0x2ad)]['url'];break;}}}}else _0x41a498=_0x546b5d[_0x593642(0x243,0x2ae,0x242,0x2c3)](_0x546b5d[_0x593642(0x24e,0x27c,0x252,0x1f6)](_0x24a3b5,',\x20'),_0x5bff51[_0x593642(0x212,0x300,0x298,0x2c5)+_0x1a531f+'\x20Prompt']);}else _0x546b5d[_0x13ad68(0x4eb,0x55b,0x543,0x4e0)](typeof _0x2ddb29,_0x546b5d[_0x593642(0x256,0x2b3,0x277,0x306)])&&_0x546b5d[_0x13ad68(0x534,0x54c,0x5a9,0x57f)](addLog,_0x546b5d[_0x593642(0x1ea,0x1a7,0x225,0x211)]);}else _0x32e2d9=_0x3ed959;}if(!_0x1e4c90){if(_0x546b5d['IxyOz'](_0x546b5d[_0x593642(0x23e,0x28e,0x2b4,0x255)],_0x546b5d['MlOPX']))_0x546b5d[_0x593642(0x326,0x2d1,0x2c0,0x2b0)](_0x2fcc70,_0x546b5d['eyuwj']);else throw new Error(_0x546b5d[_0x593642(0x2b5,0x28d,0x289,0x2bd)]);}return _0x546b5d['YtMyM'](addLog,_0x593642(0x2c9,0x25d,0x24d,0x2a8)+'mage\x20gener'+_0x593642(0x1fc,0x18f,0x21f,0x1b5)+_0x593642(0x21f,0x273,0x258,0x281)),{'image':_0x1e4c90,'change':_0x546b5d[_0x593642(0x2ae,0x2b2,0x2df,0x29f)](_0x13f6b2,'')};}catch(_0x26ad61){if(_0x546b5d[_0x593642(0x2b8,0x2fb,0x2d6,0x31d)]('cALsB',_0x546b5d[_0x593642(0x2c8,0x31b,0x29f,0x2aa)])){_0x183a62=_0x593642(0x23a,0x2a9,0x24a,0x20f)+'dels/'+_0x2b5978;const _0x927706={};_0x927706[_0x13ad68(0x55d,0x59a,0x5c2,0x5fc)+'t']='';const _0x5b8b55=_0x37e601[_0x57e2cb]||_0x927706,_0x728b=[_0x5b8b55[_0x13ad68(0x57b,0x558,0x5c2,0x5dc)+'t'],_0x557348[_0x546b5d[_0x593642(0x34d,0x2d2,0x2ea,0x2d5)]],_0x4c836c[_0x546b5d[_0x593642(0x33b,0x323,0x2b7,0x2eb)]],_0x1dfc32,_0x4581c4[_0x593642(0x1f2,0x243,0x248,0x238)],_0x45d902[_0x546b5d[_0x593642(0x211,0x19d,0x216,0x26e)]],_0x5b8b55['postfixPro'+_0x593642(0x34f,0x2f3,0x2cb,0x331)],_0xa24e38[_0x546b5d[_0x13ad68(0x5d9,0x593,0x5f9,0x58f)]]][_0x13ad68(0x598,0x63b,0x5ee,0x681)](_0xdfcd2a)['join'](',\x20');_0x546b5d['gXiOu'](_0x219adb,'正面提示词:\x20'+_0x728b);const _0x2ab463={};_0x2ab463[_0x13ad68(0x591,0x55d,0x5c3,0x533)]=_0x728b;const _0xb8fe5f={};_0xb8fe5f[_0x593642(0x255,0x1cc,0x240,0x217)+'t']=0x1,_0xb8fe5f[_0x13ad68(0x536,0x5e3,0x5c8,0x630)+'o']=_0xcea8a6;const _0x567f6f={};_0x567f6f[_0x13ad68(0x5de,0x642,0x5e9,0x5d4)]=[_0x2ab463],_0x567f6f[_0x13ad68(0x684,0x68f,0x5fd,0x668)]=_0xb8fe5f,_0x3c84bb=_0x567f6f,_0x546b5d['fAzet'](_0x6e6bbf,'[Banana]\x20B'+'uilt\x20Image'+_0x13ad68(0x577,0x5ab,0x556,0x583)+_0x593642(0x262,0x278,0x1e3,0x1ec)+_0x593642(0x1cc,0x214,0x1e9,0x185)+_0x728b);}else{addLog(_0x13ad68(0x606,0x51f,0x5a0,0x5d9)+_0x593642(0x1e1,0x28d,0x21a,0x293)+':\x20'+_0x26ad61[_0x13ad68(0x569,0x590,0x58b,0x5b2)]),console[_0x593642(0x266,0x26b,0x2b9,0x2d5)](_0x593642(0x2c2,0x1f3,0x23c,0x26a)+_0x593642(0x1b6,0x28c,0x21a,0x246)+':',_0x26ad61);throw _0x26ad61;}}}export async function bananaGenerate(_0x21a558){const _0x1bf209={'cYGGW':function(_0x1473cb,_0x6a1b9b){return _0x1473cb(_0x6a1b9b);},'WygBY':'image_url','TpeVh':function(_0x28df2c){return _0x28df2c();},'xevJY':_0x8bb902(0x2b7,0x299,0x21d,0x289),'qxuIn':'{修图}','tScZe':function(_0x53c90e,_0x28707f){return _0x53c90e(_0x28707f);},'hivMi':function(_0x24de70,_0x24a997,_0x596ba7,_0x27b8c1){return _0x24de70(_0x24a997,_0x596ba7,_0x27b8c1);},'rQiHD':function(_0x83d877,_0x51234e){return _0x83d877(_0x51234e);},'AhUKI':function(_0x45e37a,_0x15c561){return _0x45e37a(_0x15c561);},'bNsSJ':function(_0x3b8786,_0x409e21){return _0x3b8786===_0x409e21;},'DTqGg':_0x4b589c(0x2b7,0x2cc,0x302,0x2c7),'EPpUW':'ezioX','TCXFt':function(_0x325028,_0xe169e2){return _0x325028(_0xe169e2);},'ISrTg':_0x4b589c(0x348,0x2c6,0x313,0x352)+_0x4b589c(0x39e,0x3da,0x3a4,0x356)+_0x4b589c(0x43a,0x381,0x3bd,0x39a)};function _0x8bb902(_0x4c9af0,_0xc78e60,_0x2f14d6,_0x53fc13){return _0x4c66(_0xc78e60-0xaa,_0x53fc13);}_0x1bf209[_0x4b589c(0x31d,0x382,0x398,0x34c)](clearLog);let {id:_0x8a4b6f,prompt:_0x5ab8da,width:_0x1a02c8,height:_0x1e3a5e,change:_0x3b3f1e,retouchPrompt:_0x3424e7,retouchImage:_0x391c4d}=_0x21a558;addLog(_0x4b589c(0x36a,0x409,0x38c,0x40b)+_0x4b589c(0x418,0x3a3,0x400,0x48b)+_0x4b589c(0x36c,0x33b,0x3c3,0x408)+_0x4b589c(0x39b,0x3d0,0x3f0,0x464)+_0x4b589c(0x2b7,0x329,0x2f8,0x357)+_0x8a4b6f+')');let _0x104e30='';if(_0x3b3f1e){if(_0x1bf209[_0x8bb902(0x30a,0x32d,0x337,0x38a)]==='jIPVv'){_0x32a7b9(_0x4b589c(0x34e,0x35e,0x3e4,0x451)+'启动');if(_0x49aafa)_0x152c50('修图指令:\x20'+_0x8eb2f8);if(_0x240b0c)_0x1bf209['cYGGW'](_0x3eef70,'修图图片:\x20[已提供'+']');}else _0x104e30=_0x3b3f1e[_0x8bb902(0x25b,0x25f,0x26b,0x26f)](_0x1bf209['qxuIn'],'');}else{if(_0x4b589c(0x466,0x378,0x3f8,0x39c)===_0x8bb902(0x2d5,0x330,0x30d,0x335))_0x104e30=_0x5ab8da;else{const _0x45877f={};_0x45877f[_0x8bb902(0x2a3,0x224,0x1da,0x23a)]=_0xa56fef;const _0x51ead1={};_0x51ead1['type']=_0x1bf209[_0x4b589c(0x32f,0x313,0x319,0x365)],_0x51ead1[_0x8bb902(0x20f,0x289,0x237,0x288)]=_0x45877f,_0x47210c[_0x4b589c(0x3d1,0x389,0x40b,0x3bb)](_0x51ead1),_0x1bf209[_0x8bb902(0x316,0x292,0x2c4,0x2e6)](_0x251e3d,_0x8bb902(0x232,0x25a,0x20f,0x252)+_0x8bb902(0x338,0x304,0x339,0x37a)+_0x4b589c(0x411,0x402,0x3f4,0x426));}}function _0x4b589c(_0x10d614,_0x2a0da3,_0x5f53ca,_0x31edb0){return _0x4c66(_0x5f53ca-0x172,_0x2a0da3);}if(_0x3b3f1e&&_0x3b3f1e[_0x4b589c(0x44a,0x470,0x3ec,0x3ca)](_0x1bf209[_0x8bb902(0x33a,0x2e4,0x345,0x354)])){_0x1bf209['cYGGW'](addLog,_0x8bb902(0x332,0x31c,0x392,0x390)+'启动');if(_0x3424e7)_0x1bf209[_0x8bb902(0x291,0x271,0x304,0x237)](addLog,_0x4b589c(0x311,0x2da,0x34c,0x307)+_0x3424e7);if(_0x391c4d)addLog(_0x8bb902(0x278,0x232,0x2bf,0x261)+']');}try{const {image:_0x34f27e,change:_0x12b7be}=await _0x1bf209[_0x8bb902(0x292,0x292,0x2ff,0x2d6)](generateBananaImage,{'prompt':_0x5ab8da,'width':_0x1a02c8,'height':_0x1e3a5e,'change':_0x3b3f1e,'retouchPrompt':_0x3424e7,'retouchImage':_0x391c4d});if(extension_settings[extensionName][_0x8bb902(0x222,0x220,0x25d,0x2b1)]!='0'){const _0x2fe4e0={};_0x2fe4e0['change']=_0x104e30,await _0x1bf209[_0x4b589c(0x315,0x3e2,0x3ab,0x42b)](setItemImg,_0x5ab8da,_0x34f27e,_0x2fe4e0),_0x1bf209[_0x4b589c(0x31a,0x3e1,0x359,0x2f9)](addLog,_0x8bb902(0x304,0x2ef,0x32e,0x2db)+_0x8bb902(0x30a,0x295,0x24c,0x23d)+'\x20'+_0x5ab8da),extension_settings[extensionName][_0x8bb902(0x2fe,0x279,0x202,0x25d)][_0x8bb902(0x1f1,0x280,0x23b,0x299)]?(extension_settings[extensionName][_0x4b589c(0x3a2,0x3ba,0x341,0x2dc)][_0x4b589c(0x2e3,0x3b5,0x348,0x371)]=extension_settings[extensionName][_0x8bb902(0x304,0x279,0x2fd,0x2b1)][_0x4b589c(0x359,0x3a8,0x348,0x2d7)]+(0x1f44*0x1+-0x208c+0x149),addLog(_0x4b589c(0x378,0x380,0x32b,0x37f)+_0x4b589c(0x42f,0x3c0,0x399,0x32b)+extension_settings[extensionName][_0x4b589c(0x3b8,0x3b1,0x341,0x36a)][_0x8bb902(0x20a,0x280,0x2ff,0x271)])):(extension_settings[extensionName][_0x4b589c(0x2da,0x31b,0x341,0x36b)][_0x4b589c(0x396,0x2f8,0x348,0x351)]=-0x4*0x3fb+0x1e13+-0xe26,_0x1bf209[_0x8bb902(0x2b2,0x259,0x22e,0x1f7)](addLog,_0x4b589c(0x2e4,0x2ce,0x32b,0x384)+_0x8bb902(0x29c,0x2d1,0x288,0x356)+extension_settings[extensionName][_0x4b589c(0x2b6,0x2fc,0x341,0x398)]['cishu']));}else{if(_0x1bf209['bNsSJ'](_0x1bf209[_0x8bb902(0x2e0,0x303,0x38a,0x376)],_0x1bf209[_0x4b589c(0x302,0x3df,0x353,0x337)])){const _0xdd3eec={};_0xdd3eec[_0x4b589c(0x3c8,0x40b,0x3bb,0x38d)+'on']=[],_0xdd3eec['fixedPromp'+'t']='',_0x339b99=_0x30c22f[_0x498363]||_0xdd3eec;}else _0x1bf209[_0x8bb902(0x2ce,0x339,0x3a6,0x2a6)](addLog,_0x4b589c(0x3c1,0x37e,0x3ef,0x484)+'库');}const _0x369526={};_0x369526['id']=_0x8a4b6f,_0x369526['success']=!![],_0x369526[_0x8bb902(0x2e1,0x2d3,0x287,0x2f6)]=_0x34f27e,_0x369526[_0x8bb902(0x2e2,0x2b7,0x2a5,0x313)]=_0x5ab8da,_0x369526[_0x4b589c(0x32f,0x319,0x304,0x296)]=_0x104e30,eventSource[_0x8bb902(0x210,0x250,0x2ca,0x25e)](EventType[_0x8bb902(0x243,0x245,0x2d4,0x222)+_0x8bb902(0x231,0x2a9,0x2ad,0x2d2)+_0x4b589c(0x42e,0x43b,0x3ad,0x43c)],_0x369526);const _0x157507={};_0x157507['id']=_0x8a4b6f,_0x157507[_0x8bb902(0x294,0x226,0x273,0x266)]=!![],_0x157507[_0x8bb902(0x2dd,0x2d3,0x35c,0x258)]=_0x34f27e,_0x157507[_0x8bb902(0x227,0x2b7,0x2b8,0x22d)]=_0x5ab8da,_0x157507[_0x8bb902(0x2cc,0x23c,0x1f0,0x294)]=_0x104e30,eventSource[_0x4b589c(0x31e,0x337,0x318,0x2a0)](_0x1bf209[_0x4b589c(0x439,0x411,0x3cf,0x35f)],_0x157507),_0x1bf209[_0x8bb902(0x224,0x292,0x260,0x268)](addLog,_0x8bb902(0x1b7,0x236,0x1b7,0x224)+_0x8bb902(0x26e,0x270,0x1eb,0x2b1)+'cess\x20respo'+'nse\x20for\x20ID'+':\x20'+_0x8a4b6f);}catch(_0x3619d7){const _0x274e0c=_0x4b589c(0x40a,0x3aa,0x3e2,0x45a)+_0x4b589c(0x3d5,0x327,0x38a,0x372)+_0x4b589c(0x38f,0x335,0x38d,0x32b)+_0x4b589c(0x303,0x369,0x395,0x3ee)+_0x8a4b6f+':\x20'+_0x3619d7['message'];addLog(_0x274e0c),console['error'](_0x274e0c);const _0x3ba56e={};_0x3ba56e['id']=_0x8a4b6f,_0x3ba56e['success']=![],_0x3ba56e['error']=_0x3619d7[_0x8bb902(0x2cf,0x27f,0x284,0x295)],_0x3ba56e[_0x4b589c(0x3e1,0x310,0x37f,0x2fa)]=_0x5ab8da,eventSource[_0x8bb902(0x27f,0x250,0x2b5,0x21c)](EventType[_0x8bb902(0x1d2,0x245,0x1dc,0x246)+'MAGE_RESPO'+'NSE'],_0x3ba56e);const _0x375606={};_0x375606['id']=_0x8a4b6f,_0x375606[_0x4b589c(0x2ae,0x312,0x2ee,0x275)]=![],_0x375606[_0x4b589c(0x42e,0x456,0x3d9,0x409)]=_0x3619d7[_0x4b589c(0x34b,0x2fb,0x347,0x2f9)],_0x375606[_0x8bb902(0x297,0x2b7,0x2eb,0x2eb)]=_0x5ab8da,eventSource[_0x4b589c(0x2b3,0x346,0x318,0x2a6)]('generate-i'+_0x8bb902(0x275,0x2dc,0x2fa,0x286)+'nse',_0x375606),_0x1bf209[_0x4b589c(0x3ac,0x2bc,0x321,0x39b)](addLog,'[Banana]\x20E'+_0x8bb902(0x335,0x2ee,0x319,0x2bb)+'lure\x20respo'+_0x4b589c(0x3e6,0x3e2,0x406,0x3d1)+':\x20'+_0x8a4b6f);}}const LEGACY_EVENT_NAMES=[_0x433658(-0x20,-0x4b,0x23,-0x29)+'mage-reque'+'st',_0x433658(-0x37,-0x91,0x11,-0xc5)+_0x433658(0x89,0xa5,0x1d,0x8e)+'st'];function initializeBananaListener(){const _0x5b6c0e={'Oueee':function(_0x49570a,_0x1035d5){return _0x49570a(_0x1035d5);},'WTdJd':'banana\x20生图事'+_0x4bf190(0x1f,0x3f,-0x53,0xd4)};eventSource['on'](EventType['GENERATE_I'+'MAGE_REQUE'+'ST'],bananaGenerate),LEGACY_EVENT_NAMES[_0x4bf190(0x18a,0xfe,0x97,0xd2)](_0x5b7fba=>{eventSource['on'](_0x5b7fba,bananaGenerate);});function _0x16c119(_0x4f2549,_0x19e01d,_0x5cac77,_0x284cd3){return _0x296165(_0x19e01d-0x1a4,_0x19e01d-0x136,_0x5cac77-0x101,_0x284cd3);}function _0x4bf190(_0x3cb126,_0x137b45,_0x549e5a,_0xb0576){return _0x433658(_0x137b45-0x34,_0x137b45-0xc8,_0x549e5a-0x94,_0xb0576);}_0x5b6c0e[_0x4bf190(-0x1a,0x1f,0x53,0x55)](addLog,_0x5b6c0e[_0x4bf190(0x108,0x10f,0x115,0x10b)]);}export async function replaceWithBanana(){function _0x2a239f(_0x57cf33,_0x6fc727,_0x24f74d,_0x2ae76e){return _0x296165(_0x24f74d- -0xb7,_0x6fc727-0x75,_0x24f74d-0x93,_0x6fc727);}function _0x363126(_0x22a5ec,_0x2f3381,_0x194198,_0x5e4923){return _0x296165(_0x194198-0x5b4,_0x2f3381-0x3,_0x194198-0x137,_0x5e4923);}const _0x107ceb={'tpzxo':function(_0x2fbb8d,_0x16352f){return _0x2fbb8d(_0x16352f);},'ZMgaT':_0x363126(0x4fb,0x475,0x4e8,0x56a)+_0x363126(0x54c,0x506,0x58c,0x5e1),'ehXqu':function(_0x5f11d6,_0x301d1e){return _0x5f11d6+_0x301d1e;},'AjRfQ':_0x363126(0x4f0,0x554,0x4fb,0x52e),'TFUWU':function(_0x5763b0,_0x30998){return _0x5763b0(_0x30998);},'mRMuB':function(_0x1443b3,_0x33abcb){return _0x1443b3==_0x33abcb;},'urJLD':'EmEPf','vmHAn':_0x2a239f(-0xf3,-0xf6,-0x159,-0x186),'nRNbn':function(_0x2556b8){return _0x2556b8();},'MacPA':_0x363126(0x495,0x4de,0x526,0x502),'CzULD':function(_0x4c80e8,_0x53cc07){return _0x4c80e8!==_0x53cc07;},'VgszE':_0x363126(0x494,0x48f,0x4eb,0x527)};if(_0x107ceb[_0x363126(0x5b4,0x4d8,0x53f,0x4ec)](extension_settings[extensionName][_0x363126(0x5e1,0x5c4,0x55d,0x4df)],'banana'))_0x107ceb[_0x2a239f(-0x1b8,-0x16c,-0x167,-0xf1)]===_0x107ceb[_0x363126(0x507,0x51d,0x54b,0x545)]?_0x4a75ab[_0x363126(0x517,0x5c9,0x5a9,0x61e)+'BananaList'+_0x363126(0x48c,0x4bb,0x4f2,0x55f)]&&(_0x1987e1['removeList'+_0x2a239f(-0xef,-0xf7,-0x179,-0x1cd)](_0x1a6a46[_0x363126(0x4e0,0x555,0x4c4,0x439)+_0x2a239f(-0x209,-0x123,-0x1ac,-0x211)+'ST'],_0x469b50),_0xc5bf7c[_0x2a239f(-0x101,-0x108,-0xb7,-0x5e)](_0x1b9732=>{function _0xa44f4b(_0x3a782d,_0x2e9185,_0x1a0bd8,_0x433660){return _0x2a239f(_0x3a782d-0xec,_0x3a782d,_0x433660-0x3ba,_0x433660-0x14d);}_0x143b7e['removeList'+_0xa44f4b(0x2c5,0x2c8,0x29f,0x241)](_0x1b9732,_0x177c25);}),_0x34e3a0[_0x363126(0x61a,0x5a7,0x5a9,0x638)+_0x2a239f(-0x108,-0x135,-0x13f,-0x109)+_0x2a239f(-0x153,-0x1e6,-0x179,-0x1d9)]=![],_0x107ceb['tpzxo'](_0xd3eeaa,_0x107ceb[_0x363126(0x530,0x547,0x5c6,0x5a2)])):(!window[_0x2a239f(-0x92,-0x32,-0xc2,-0x87)+'BananaList'+_0x363126(0x493,0x561,0x4f2,0x4bb)]&&(window[_0x363126(0x5bb,0x5ce,0x5a9,0x533)+_0x2a239f(-0xd9,-0x1c8,-0x13f,-0x1b9)+_0x363126(0x583,0x463,0x4f2,0x469)]=!![],_0x107ceb[_0x2a239f(-0x207,-0x1a7,-0x195,-0x213)](initializeBananaListener)),initializeImageProcessing());else{if(_0x107ceb['MacPA']!==_0x107ceb[_0x363126(0x5db,0x5be,0x59d,0x5ac)])_0x429425=_0x107ceb[_0x2a239f(-0x12d,-0x103,-0x141,-0x15c)](_0x4ebd26+_0x107ceb[_0x363126(0x4b6,0x4b0,0x4dd,0x538)],_0x107ceb[_0x2a239f(-0x184,-0x15c,-0x139,-0x1a6)](_0x2cee81,_0x1e76ee[_0x363126(0x544,0x508,0x56f,0x4dd)+_0x442ee5+_0x363126(0x4db,0x43d,0x4bc,0x433)]));else{if(window[_0x2a239f(-0x133,-0x36,-0xc2,-0x36)+'BananaList'+_0x2a239f(-0x17e,-0x12e,-0x179,-0x11d)]){if(_0x107ceb['CzULD'](_0x107ceb[_0x363126(0x547,0x563,0x53e,0x4ee)],_0x107ceb[_0x2a239f(-0x19d,-0x13b,-0x12d,-0x11f)])){const _0x4cbe4c=_0xf887e5?function(){if(_0x576d78){const _0x2c9801=_0x17f669['apply'](_0x2868b6,arguments);return _0x3a7187=null,_0x2c9801;}}:function(){};return _0x2646f9=![],_0x4cbe4c;}else eventSource[_0x363126(0x584,0x5ad,0x595,0x603)+_0x363126(0x4d4,0x586,0x4f2,0x486)](EventType['GENERATE_I'+'MAGE_REQUE'+'ST'],bananaGenerate),LEGACY_EVENT_NAMES[_0x363126(0x599,0x613,0x5b4,0x5d0)](_0x328543=>{function _0x4c1ef7(_0x4e3ea7,_0x42c4ba,_0x3c4a1a,_0x5dd6eb){return _0x2a239f(_0x4e3ea7-0x1ac,_0x3c4a1a,_0x42c4ba-0xf9,_0x5dd6eb-0x28);}function _0x5becca(_0x465f07,_0x32fd33,_0x51c4b4,_0x28723d){return _0x363126(_0x465f07-0x14d,_0x32fd33-0xc2,_0x465f07- -0x5f6,_0x51c4b4);}eventSource[_0x4c1ef7(0xa7,0x23,-0x5f,0x41)+_0x5becca(-0x104,-0x80,-0x75,-0x116)](_0x328543,bananaGenerate);}),window[_0x2a239f(-0x87,-0x14e,-0xc2,-0xe6)+_0x2a239f(-0xb3,-0x175,-0x13f,-0xf3)+_0x363126(0x4ea,0x53a,0x4f2,0x512)]=![],addLog(_0x107ceb[_0x2a239f(-0x75,-0x11e,-0xa5,-0x100)]);}}}}