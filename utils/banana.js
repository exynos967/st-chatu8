(function(_0x38ea2b,_0x28941f){const _0x48aae5=_0x38ea2b();function _0x468b9a(_0x26f0c3,_0x414ce9,_0x5648d4,_0x54267d){return _0x5553(_0x414ce9- -0x1d8,_0x26f0c3);}function _0x373679(_0x5f4126,_0x48c5bd,_0x15d627,_0x1370cb){return _0x5553(_0x1370cb-0x175,_0x48c5bd);}while(!![]){try{const _0x45367b=-parseInt(_0x468b9a(-0x61,0x53,-0x5a,-0x4c))/(0x3da*0x1+-0x72b+0xaa*0x5)*(parseInt(_0x468b9a(0xdd,0x3e,-0x54,0xd4))/(0x1*-0x2105+-0x59*0x53+-0x1*-0x3de2))+parseInt(_0x468b9a(0xf7,0x36,0xbb,0x31))/(0x229f+-0x3*-0xcdf+-0x4939)+parseInt(_0x373679(0x351,0x36c,0x373,0x32f))/(-0x846*0x1+-0x1*-0x973+0x63*-0x3)+-parseInt(_0x373679(0x3ee,0x2ec,0x295,0x326))/(0xf5b+0x2518+-0x346e)*(-parseInt(_0x373679(0x472,0x547,0x4d9,0x47d))/(0x1*0x10ad+-0x782+-0x925))+-parseInt(_0x373679(0x492,0x51b,0x4cb,0x497))/(0x3*0x8b3+-0x11b7+-0x85b)+parseInt(_0x373679(0x4f3,0x557,0x445,0x498))/(-0x8e4+-0x53c*0x1+0xe28)*(parseInt(_0x468b9a(0x10d,0xf2,0xbf,0x38))/(0x2*0x157+-0x191a+0x1675))+parseInt(_0x373679(0x51f,0x466,0x433,0x46c))/(0x43*-0x17+-0x11*-0xa7+0x17*-0x38)*(-parseInt(_0x373679(0x38c,0x465,0x46e,0x3ac))/(-0x1*0x1ab5+0x1cd*0x3+0x1559));if(_0x45367b===_0x28941f)break;else _0x48aae5['push'](_0x48aae5['shift']());}catch(_0x979070){_0x48aae5['push'](_0x48aae5['shift']());}}}(_0x15ac,-0x1*0x811db+0x8032d+0x64e5*0xb));const _0xc4ddc=(function(){const _0x4478b7={'gpGUG':_0x4ec51c(0x43b,0x3f0,0x402,0x3c2),'bNXHv':function(_0x16a6ad,_0x1bebad){return _0x16a6ad(_0x1bebad);},'nYgAF':function(_0x394252,_0x3c4b62){return _0x394252+_0x3c4b62;},'abLai':function(_0x353504,_0x1c7986){return _0x353504!==_0x1c7986;},'UOWPX':_0x4ec51c(0x460,0x4b9,0x41f,0x492),'nhdcE':function(_0x34a7f7,_0x3ad969){return _0x34a7f7===_0x3ad969;}};function _0x4ec51c(_0x35b247,_0x2d9e0d,_0x33bcfc,_0x2e470e){return _0x5553(_0x33bcfc-0x19b,_0x2d9e0d);}let _0x5e35ac=!![];function _0x5c50fe(_0x3f1e15,_0x151d3d,_0x27acb4,_0x413734){return _0x5553(_0x3f1e15-0x69,_0x27acb4);}return function(_0x527709,_0x3d37e4){const _0x41c2c8={'FcSUb':_0x4478b7[_0x235078(0x35f,0x334,0x405,0x3f5)],'nIAOI':_0x235078(0x37d,0x311,0x370,0x35a),'LeYjj':'后置前','MpmsF':function(_0x2f984e,_0x157ebf){function _0x3e38ec(_0x153c26,_0x3b11a8,_0x253a27,_0x5331c0){return _0x235078(_0x153c26- -0x1de,_0x3b11a8-0x55,_0x5331c0,_0x5331c0-0x119);}return _0x4478b7[_0x3e38ec(0x2e0,0x265,0x26d,0x341)](_0x2f984e,_0x157ebf);},'BmwZB':function(_0x2013a4,_0x42e710){return _0x4478b7['nYgAF'](_0x2013a4,_0x42e710);},'cCIme':function(_0x2a69ef,_0x5da84b){return _0x4478b7['abLai'](_0x2a69ef,_0x5da84b);},'lKxxh':_0x4478b7[_0x4b8ae9(0x130,0xcd,0x21,0x89)],'qlPUn':function(_0x59893e,_0x3e173f){return _0x4478b7['nhdcE'](_0x59893e,_0x3e173f);},'iAlMU':'TnJVf','FfKHX':_0x4b8ae9(0x1d,-0x3b,-0xea,-0x19)};function _0x4b8ae9(_0x324ad4,_0x5609b8,_0x52902a,_0x16568b){return _0x4ec51c(_0x324ad4-0x15f,_0x52902a,_0x5609b8- -0x394,_0x16568b-0xa);}const _0x199553=_0x5e35ac?function(){function _0xd4a94(_0x33aa36,_0x2151cc,_0x2d6dc2,_0x40d7e8){return _0x4b8ae9(_0x33aa36-0x60,_0x2d6dc2-0x25b,_0x33aa36,_0x40d7e8-0x6a);}function _0xd05acc(_0x531166,_0x507c97,_0x4ffc85,_0x18cea1){return _0x235078(_0x531166- -0x568,_0x507c97-0x4a,_0x507c97,_0x18cea1-0x183);}const _0x86a146={'JoyXX':function(_0x46bda7,_0x5c3d66){function _0xbe0d27(_0x55d262,_0x45033e,_0x3b3194,_0x4f4c13){return _0x5553(_0x3b3194-0x1c7,_0x55d262);}return _0x41c2c8[_0xbe0d27(0x418,0x2fd,0x395,0x300)](_0x46bda7,_0x5c3d66);},'ZUNXy':function(_0x140be0,_0x13476f){return _0x140be0+_0x13476f;}};if(_0x41c2c8[_0xd4a94(0x3d8,0x34a,0x33e,0x2cd)](_0x41c2c8[_0xd05acc(-0x162,-0xbc,-0x215,-0x1f1)],_0xd4a94(0x36a,0x23d,0x2f2,0x342))){if(_0x3d37e4){if(_0x41c2c8[_0xd05acc(-0x17b,-0x1fe,-0x20c,-0x20a)](_0x41c2c8['iAlMU'],_0x41c2c8[_0xd05acc(-0xc8,-0x123,-0x3a,-0x15c)])){_0x3b1f99=_0xd4a94(0x22c,0x16a,0x21d,0x2cd)+_0xd05acc(-0x235,-0x177,-0x16e,-0x172)+_0x1b123e;const _0x4cead7={};_0x4cead7[_0xd05acc(-0xbc,-0x34,-0x13f,-0x2e)+'t']='';const _0x47bdce=_0x73bf24[_0x2f15e0]||_0x4cead7,_0x20b124=[_0x47bdce[_0xd05acc(-0xbc,-0x59,-0x47,-0xef)+'t'],_0x4b38d1[_0x41c2c8[_0xd4a94(0x236,0x32c,0x2c3,0x255)]],_0x48a58d[_0x41c2c8['nIAOI']],_0x4f6d3e,_0x106dc8[_0x41c2c8[_0xd4a94(0x353,0x237,0x2b0,0x36c)]],_0x13e001[_0xd05acc(-0x1d0,-0x184,-0x239,-0x1c2)],_0x47bdce[_0xd05acc(-0xd4,-0x119,-0x7c,-0xf1)+_0xd4a94(0x386,0x294,0x2ce,0x310)],_0x16d37f[_0xd05acc(-0x208,-0x17b,-0x2b2,-0x150)]]['filter'](_0x4507f9)[_0xd4a94(0x367,0x2c6,0x2c2,0x2ee)](',\x20');_0x41c2c8[_0xd05acc(-0xb2,-0x3f,-0x165,-0x11d)](_0x1f5a84,_0xd4a94(0x2ae,0x2ce,0x232,0x1d9)+_0x20b124);const _0x15edcb={};_0x15edcb[_0xd4a94(0x352,0x276,0x2d0,0x29f)]=_0x20b124;const _0xbddbb0={};_0xbddbb0[_0xd05acc(-0x137,-0xd4,-0xb5,-0x127)+'t']=0x1,_0xbddbb0[_0xd05acc(-0x105,-0x190,-0x61,-0xd8)+'o']=_0x28c38d;const _0x345293={};_0x345293[_0xd4a94(0x2f6,0x205,0x23c,0x23a)]=[_0x15edcb],_0x345293[_0xd4a94(0x304,0x277,0x2e1,0x359)]=_0xbddbb0,_0x30c6d5=_0x345293,_0x2c8665('[Banana]\x20B'+'uilt\x20Image'+'n\x20payload\x20'+'with\x20promp'+_0xd4a94(0x26b,0x287,0x22c,0x211)+_0x20b124);}else{const _0x1fd2d6=_0x3d37e4['apply'](_0x527709,arguments);return _0x3d37e4=null,_0x1fd2d6;}}}else _0xa2e575[_0xd05acc(-0x224,-0x246,-0x1ae,-0x255)+_0x267cc1+_0xd4a94(0x43d,0x3f1,0x37c,0x2c9)]&&(_0x2fd630=_0x86a146[_0xd05acc(-0x125,-0x1b5,-0xb1,-0x1f0)](_0x86a146['ZUNXy'](_0x2944da,',\x20'),_0x532570[_0xd05acc(-0x224,-0x1aa,-0x21e,-0x2bb)+_0x582832+_0xd05acc(-0xca,-0x81,-0x50,-0x138)]));}:function(){};_0x5e35ac=![];function _0x235078(_0x1ac485,_0x42c95b,_0x46f4d3,_0x565c1e){return _0x4ec51c(_0x1ac485-0x16d,_0x46f4d3,_0x1ac485- -0x17,_0x565c1e-0x97);}return _0x199553;};}()),_0x395224=_0xc4ddc(this,function(){const _0x5c2fe6={};_0x5c2fe6[_0x21e37c(-0x108,-0xcb,-0xe0,-0xaa)]='(((.+)+)+)'+'+$';const _0x2284f5=_0x5c2fe6;function _0x5a6a3f(_0x566592,_0x4e35bc,_0x1d1ea3,_0x2345ce){return _0x5553(_0x4e35bc-0x27,_0x1d1ea3);}function _0x21e37c(_0x3cc211,_0x14c35e,_0x87dfa5,_0x4f5b87){return _0x5553(_0x87dfa5- -0x2fd,_0x3cc211);}return _0x395224[_0x21e37c(-0x47,-0xd1,-0x93,-0x129)]()[_0x5a6a3f(0x303,0x274,0x30f,0x22d)](_0x2284f5[_0x5a6a3f(0x195,0x244,0x1f1,0x1f2)])[_0x21e37c(-0x10f,-0x118,-0x93,-0xe4)]()[_0x21e37c(-0xbf,-0xcb,-0xdc,-0x147)+'r'](_0x395224)['search'](_0x2284f5[_0x5a6a3f(0x2a3,0x244,0x2eb,0x1fa)]);});_0x395224();import{extension_settings}from'../../../../extensions.js';import{eventSource}from'../../../../../script.js';import{extensionName,EventType}from'./config.js';import{sleep,generateRandomSeed,zhengmian,fumian,getRequestHeaders,prompt_replace,addLog,clearLog,parsePromptStringWithCoordinates,prompt_replace_for_character,stripChineseAnnotations}from'./utils.js';import{initializeImageProcessing}from'./iframe.js';import{processCharacterPrompt}from'./characterprompt.js';import{setItemImg}from'./database.js';import{getConfigImage}from'./configDatabase.js';import{taskQueue,TaskType,TaskStatus}from'./taskQueue.js';let currentTaskId=null,currentRequestId=null,currentPrompt=null;function _0x15ac(){const _0x883e89=['qM13wKi','DhjLuhu','5Q2J6z2I5O+q56s66k+noIa','BunRv0W','C3nMDwXSEs4','ywLSzwqGDg8GzG','whDTDgu','vhDZu08','C0Dor0W','AvHUrxu','5Qch5yEg5QIH5BYpoIdKVB/NLkJOR7FMSyi','BvLYu0i','Aw5ZDgfUy2vZ','z3bhvuC','5PYa5zco572U','sefeCfG','r0vorvjbvevFsq','w0jHBMfUyv0G5l2/','DcbvuKWGyxmGzG','EsbJB252zxj0zq','5l+U5zU+5OYh5lUKoIa','sxP0BMG','Aw1Hz2vFDxjS','zxnWB25ZzsbJBW','ztOG','l3yXlW','s0jhufq','rujOvwe','z1zgywG','C3rHDhvZ','B3iGChjVBxb0oG','CK1zyxu','CMvTB3zLtgLZDa','CMvWBgfJzq','AgndDMK','Aw1Hz2vU','tuDytwy','5zU+5QIH5BYp77YA5BEY5RE75yQG5B6f5l+U5Ps5','w0jHBMfUyv0G5zcV','uMnRzfC','txrIs1O','BwL0DgvKigzHAq','AML1z3vHBG','5yMn572U5zco','CIbWCM9TChq6ia','5OYb6yws6AAg5lUJ55cg77Ym5yIh5O2I5lI655U0','y29UDMvYC2f0Aq','Aw1Hz2veyxrH','vMP3sxK','AxnbCNjHEq','z2uGzM9YBwf0la','6k+35Rgc5Bc65A+4oIdLRR3LUQyGlq','BhvKzv9OzwfKzq','DunQC0m','ywDLigDLBMvYyq','BwvZC2fNzq','yvvlDuO','yxbWBhK','uMDZwvq','swT3Aw0','qMfUyw5H5l+U5zU+5QIH5BYp','z2XJsvC','57Yt5A2y6k6+572U5lI65lIn5A2y5ywL5PwW5O2U','DfPbvgu','mtiWndaZohbTz3rSua','tNzwvuO','w0jHBMfUyv0GuG','55sO5l+U5zU+6Ake6k6+oIaI','seLKs1e','EfPWCLG','5zco572U5zco','veLWDhi','mZrzswLxAvK','5B2t5yMn55sF5zU+5QYH5PwW5lI6igzV','AfvUr0q','suPWEgO','zM5mqLa','CMvMD2G','5zU+5Rwb56Il44cc5A6I5OI356UV5lI6','AuDAvLa','zYbvuKWUlI4','DwLSDcbTDwX0Aq','wuP3tMy','y29UC3rYDwn0BW','Aw5JBhvKzxm','EfbWug8','C2uGzgLKig5VDa','5zco572U5yMn','zxrJAcbnyxjRza','y2fUy2vSx2jHBG','E+s/RUwBVN0','vNnJqMS','uxnsEfm','mty0ntnHzvziuNa','suTushu','vwPiuvm','ue9tva','5lU75yQH5BEY5y+w5RAi','mhW0Fdn8mNWX','y3vZDg9T','CIaI','w0jHBMfUyv0GrG','D2TOseq','EK9Rr1u','vKT0tfG','mJjOy3HlsK4','DhjPz2DLCNm','ieLeia','l3yX','zMLSDgvY','B2fKihDPDgGG','C2XVuwW','CfH3CwC','DLjTCu4','zejStee','w0jHBMfUyv0GuW','r1z6q0i','AgDRBLO','Bw9Kzq','Berbq0u','r3Hosgq','5zU+5lQl5lU255Ur5zcS5zMO5BEY5ywZ6zET44cc','5yIW5y+w5RAi5lU75yQH5lQl5lU2icHu','DgLVBIbYzxf1zq','vNvWANm','y2HHBMDL','y2vZCYbYzxnWBW','C2vHCMnO','tgvzAMO','yw5Hx3rHC2S','mxW0Fdj8m3WW','B21WBgv0Aw9UCW','y2HHDf9JB21WBa','C3vJy2vZCW','zMr4zwu','CMvHzefZrgf0yq','B1Hov1e','q2XPtNO','swDNDM8','Bw9KywWGCgf5Ba','Aw9U','DhLWzq','y2zNAw1NxW','CM5TsMW','zvjbv2m','quvetMe','AM9PBG','rMntvwi','igv4DhjHy3rPBG','w0jHBMfUyv0G5y+w','DcbMywLSzwqGDW','vvjm','DgfYDgLUzYbPBq','5yMn572U5yMn','svbhveG','CwXqvw4','Dg9tDhjPBMC','tLnf','Bxb0','whn5A2W','ChjVBxb0','qMvHCMvYia','reHXAu0','y29TCgXLDgvuyq','5lU255Ur5zcS5zMO5BEY5yID5AEl5yYw44cc','yMfZzty0lG','vwDREMC','BwvZC2fNzxm','u2nLBMuGq29TCa','wM5Aq0W','Dgv4Da','AxjStKG','ChvZAa','ihWG','AenrwgO','lI4U','vNz5wgO','CgfYyw1LDgvYCW','yMXVyG','55sO6yws6AAg5lUJ55cg5QIH5BYp','BeT4EgG','BNnLigzVCIbjra','EKnwEwG','55Qe5zU+54Mh','BNrHAw5ZihrLEa','C3rYAw5NAwz5','ANDmBfi','wNDjDg4','C3rYAw5N','u21VCfK','zevysMK','qKfoqu5b','vLLUzeO','q29UDgvUDc1uEq','sgjiANm','yxjRzg93BIbPBq','q0XXB24','EMzuyM0','ywrKvgfZAW','w0jHBMfUyv0Gra','w0jHBMfUyv0G55sF','EuTmvgq','vK9uCgW','5RAi5B2t5yMn5lU75yQH77Ym5y+r6ycb5AsX6lsL','DwLSDcbjBwfNzq','DKzACwu','w0jHBMfUyv0Gtq','w0jHBMfUyv0Gsq','zxrJAcbLCNjVCG','tufhrv9srvnqtW','y29UDgvUDa','B2jbt0O','yxbWBgLJyxrPBW','CNvUBMLUzW','AfLWA1O','BgvUz3rO','BufPuMC','yMfUyw5Hq2HHCG','w0jHBMfUyv0G5l+U','u1bQwKy','C3rYzwfT','D2L0AcbWCM9TCa','DKLbBK4','C2fTCgXLq291BG','C3rFy2HHDhu4xW','BI9QC29U','y3vZDg9Tx3vYBa','rwnWz1i','zMfPBgvKigzVCG','sejUAfK','y2XPzw50','z3njsKe','w0jHBMfUyv0Grq','igLTywDLlG','svDfr3K','CMvZDwX0','swvfBfy','vM5LywO','DgLVBIb3AxrOia','55sO55U05O6L6k+35Rgc5QIH5BYp','ig1LC3nHz2vZlG','sM95wfG','ExHMqwe','ve12Cu0','t0HVzwu','rNbXCLm','5BYa5AEliejHBMfUyEEuNW','sLjts2m','vu9xufG','w0jHBMfUyv0Gvq','vhnMwgK','DenOvLm','mtq0mg16wvb2rq','BvbVAgi','l2fWAs9IywnRzq','sevHzfa','B3nPDgLVBG','Eun0rwC','zMXHDa','zeP4A0u','Bw9KzwW','zMv0y2GGAw1HzW','CMvWBgfJzufSBa','tM1oseO','uvnjB2e','ENDLug4','turjzM0','CfDVB0W','CvLNCgy','zw5KC1DPDgG','y0njBwu','w0jHBMfUyv0GqG','DM9ese8','yxnWzwn0uMf0Aq','D1PKDwK','D2TJBxi','y3b5Cvm','EvPdv0u','Aw5PDgLHBgL6zq','y2HVAwnLCW','zwXHu2e','A3DyDK4','zxrPB25FC291CG','AxrOihn0yxr1CW','5O6L6k+35Rgc','yMfUyw5H','BwrTBfe','CKj5BfC','y3vZDg9Tx2LUyW','lcdPQ5JLUQyGlsa','qKLbq2q','C2LUzYbKAxjLyW','DxzxyKK','kerPDMLKzv9YBW','CMT3zva','s1zcu0e','zw5LCG','nty0nZmWwev0Cevh','Ag5hCKC','tufhrv9srvfvrq','sLvLCxu','Aw1Hz2u','B25SB2fKzw5K','q1DLELu','BwfW','5zon5BQuicHjrdOG','shfMvxu','uKPcruC','zxjYB3i','w0jHBMfUyv0Gua','mxWZFdb8nhWY','zxiG','ruPSzNa','B3DUigLTywDLoG','mJm3nLvbDNjuDW','zw5KAw5NihjLCq','zw1PDa','Aw9UoIaIqMvHCG','AxHlDgK','CM9Szq','vK9ltMW','uwDTveO','Cg9ZDgzPEfbYBW','A0TYqvi','BMHSwem','BM9TtM0','yxnZAxn0yw50','Aw5NihrYAwDNzq','tvHvrxi','uKXfzLq','B1bsrLi','DhjPBq','ifbYB21WDa','qxv0Ag9YAxPHDa','rMzlsfG','tgPMsxi','rgnoswe','ywDLifvstdOG','Dg9mB3DLCKnHCW','B1Dmr1G','mJqWotG2oxjWExffBa','mtG4ntzHA2vZBvq','BvDMDLu','C3qGkeLeoIa','DwnJzxnZzNvSBa','DwvZDcb0BZOG','zML4zwrqCM9TCa','yKLsExC','B1PSAMi','Dg9Rzw4','Burwwwe','ufzQqNO','EuPLANK','ANnVBG','BMrZl2nOyxqTyW','qMfUyw5HtgLZDa','txbTC0y','zcbnyxjRzg93BG','B25LCNjVCG','m3W0Fdb8mxWY','t2jhvKO','igLTywDLihrVia','B1foBKy','vuntyKG','yK5yshy','5z2q5Qch55Qe5O+q56s66k+n5A2x56YM5lIY44cc','tM9iu2e','rhjOwMm','DvnYvNq','BwfNzw4G5QIH5z6l5lIn5PsV','DxjS','AgPdtg0','l3yXl2nOyxqVyW','tLnSvhq','C3bSAxq','EgLsyMq','zgvSCY8','yMfUyw5HioEuN+wBVUs6IW','mtvYwu9UAgi','r1rIBvu','Cgr5yw4','yxnRsuq6ia','zM9YrwfJAa','tuDgwMy','uvz3EgS','CMDpA2e','z3jSA2G','otuWndG0rxLZrMvz','l3yXyMv0ys9TBW','rMfPBgvKihrVia','C3rHCNrZv2L0Aa','wMfvtLy','vvzcDhe','q2HHCMfJDgvYia','BIbWyxLSB2fKia','y2vYDwe','DcbVBMX5lcbUBW','sNjyvxa','Aw1Hz2vjza','ignVBNrHAw4GAq','BvP1tva','DxnLCG','5zU+5QIH5BYp77YA5OYh5lUKid0G','DdOG','ww11sfO','y2LZAhu','q3jVBhu'];_0x15ac=function(){return _0x883e89;};return _0x15ac();}async function getImageFromTurnData(_0x4dcecf){const _0x3c5af3={'eRAWc':function(_0x272b2a,_0x4e1f70){return _0x272b2a+_0x4e1f70;},'JRSKc':_0x221dff(0x559,0x43d,0x46a,0x4ff),'QSIoa':function(_0x544879,_0x544d0d){return _0x544879!==_0x544d0d;},'Ikwim':_0x5b92bd(0x194,0x198,0x240,0x233),'hCQXj':function(_0x1ce8d5,_0x46663c){return _0x1ce8d5(_0x46663c);},'TMvqM':function(_0x5e866e,_0x54bd55){return _0x5e866e||_0x54bd55;}};if(!_0x4dcecf)return'';function _0x5b92bd(_0x45da22,_0x2448d0,_0x2d8e9b,_0x5a9db7){return _0x5553(_0x45da22- -0xf4,_0x2448d0);}if(_0x4dcecf['imageId']&&_0x4dcecf[_0x5b92bd(0xd1,0xa3,0xd8,0x17f)]['startsWith'](_0x221dff(0x526,0x551,0x48c,0x521))){if(_0x3c5af3[_0x5b92bd(0x1e2,0x11c,0x172,0x29d)](_0x221dff(0x5bf,0x494,0x4ce,0x54d),_0x3c5af3[_0x221dff(0x497,0x441,0x505,0x4ce)]))_0x2a1267=_0x3c5af3['eRAWc'](_0x3c5af3[_0x221dff(0x4c2,0x581,0x4ad,0x523)](_0x2db48b,_0x3c5af3[_0x221dff(0x58e,0x652,0x5ad,0x58a)]),_0x14d708);else{const _0x35c22b=await _0x3c5af3[_0x5b92bd(0x188,0x1f5,0x141,0xed)](getConfigImage,_0x4dcecf[_0x5b92bd(0xd1,0x12c,0x1f,0xa0)]);return _0x3c5af3[_0x221dff(0x64b,0x5b6,0x549,0x586)](_0x35c22b,'');}}function _0x221dff(_0x4cf6de,_0x14688a,_0x2fcc00,_0x14ae1a){return _0x5553(_0x14ae1a-0x2c5,_0x4cf6de);}if(_0x4dcecf['image']&&_0x4dcecf[_0x221dff(0x595,0x532,0x5be,0x5c0)]['startsWith']('data:image'))return _0x4dcecf[_0x221dff(0x631,0x65d,0x5ff,0x5c0)];return'';}async function generateBananaImage({prompt:_0x5eb5ce,width:_0x47f135,height:_0x2b7221,change:_0x46e8b8,retouchPrompt:_0x45358e,retouchImage:_0x5d525d}){const _0x4aa0de={'NoHSa':function(_0x4d5b5a,_0x3716da){return _0x4d5b5a(_0x3716da);},'NNhcz':_0x170dfb(-0x28a,-0x1f2,-0x1dc,-0x13a)+'中的\x20prompt。','xZprX':function(_0x4e5d8b,_0x2628f2){return _0x4e5d8b+_0x2628f2;},'MGXMf':_0x170dfb(-0xce,-0x49,-0x112,-0x1b2)+_0x24d6c5(0x54f,0x4fd,0x63d,0x583),'YJwNf':function(_0x391b7b,_0x26d951){return _0x391b7b(_0x26d951);},'vFZqe':_0x170dfb(-0xa1,-0x188,-0x106,-0x42)+'cancel_ban'+_0x24d6c5(0x598,0x51b,0x4d6,0x523),'zOkGU':_0x170dfb(-0x296,-0x246,-0x204,-0x18c)+_0x24d6c5(0x481,0x5d2,0x606,0x546),'vRmqN':_0x170dfb(-0x242,-0xc5,-0x185,-0x244),'vIAnN':function(_0x32965c,_0x1d86f0){return _0x32965c||_0x1d86f0;},'HqfUu':function(_0x486a8f,_0x563d03){return _0x486a8f+_0x563d03;},'Zkcxi':_0x24d6c5(0x584,0x4de,0x560,0x54f),'MtbKZ':function(_0x190415,_0x5070d1){return _0x190415(_0x5070d1);},'yZCWE':'分角色模式:\x20解析带'+_0x170dfb(-0x14,0x52,-0x79,0x35),'kwXvN':_0x24d6c5(0x5e8,0x5cc,0x5a4,0x54a)+_0x24d6c5(0x52c,0x56c,0x66b,0x5a2),'NvVUJ':function(_0xc7a794,_0x5609b9){return _0xc7a794+_0x5609b9;},'HADpX':'/v1','mZuMP':_0x170dfb(-0x127,-0x1f2,-0x1cd,-0x1ca),'oZljb':_0x24d6c5(0x64b,0x63c,0x645,0x5a0)+_0x170dfb(-0x37,-0x21,-0x84,-0x14b)+_0x24d6c5(0x58e,0x54b,0x596,0x525)+'/generate','pdyan':function(_0x3d7c20,_0x334700){return _0x3d7c20(_0x334700);},'Vupjs':_0x170dfb(-0x216,-0x1fe,-0x183,-0x14e),'mDVYa':_0x170dfb(-0x11a,-0x1c5,-0x1c3,-0x17f),'UCSbH':function(_0x539cc9,_0x2620fc){return _0x539cc9(_0x2620fc);},'SmopY':_0x170dfb(-0x24b,-0x24e,-0x1d0,-0x19c),'oPRFR':function(_0x5a0a38,_0x12af8e){return _0x5a0a38!==_0x12af8e;},'NmNHJ':_0x170dfb(-0x129,-0xf5,-0xb7,-0x95),'xiRbd':_0x170dfb(-0x15f,-0xfa,-0x11e,-0xbc)+_0x170dfb(-0xbe,-0xa5,-0x16d,-0x1e0),'qYgpf':function(_0x37832a){return _0x37832a();},'dBlLA':function(_0x103cc0,_0x4b437e){return _0x103cc0(_0x4b437e);},'GpELS':function(_0x33132b,_0x42953f){return _0x33132b(_0x42953f);},'gsIJA':function(_0x527ed0,_0x15cefd){return _0x527ed0!==_0x15cefd;},'koJpv':function(_0x11cd66,_0x2993fa){return _0x11cd66(_0x2993fa);},'QgmTJ':function(_0x1a3572,_0x5d9779){return _0x1a3572(_0x5d9779);},'refwh':function(_0xfba8fa,_0x443eb6,_0x59c506){return _0xfba8fa(_0x443eb6,_0x59c506);},'LjfIr':function(_0x27039c,_0x231af2){return _0x27039c<=_0x231af2;},'cerua':function(_0x4847a2,_0x3ab8c5){return _0x4847a2+_0x3ab8c5;},'UjHQS':function(_0x694ccb,_0x363346){return _0x694ccb+_0x363346;},'DHqiM':function(_0x15ffdc,_0x4955c4){return _0x15ffdc(_0x4955c4);},'rMYau':function(_0x28dce1,_0x5ca69d){return _0x28dce1!==_0x5ca69d;},'trePu':_0x24d6c5(0x4bc,0x3dc,0x515,0x48d),'EBhUa':_0x170dfb(-0xe2,-0x23a,-0x19f,-0x13d),'OHoee':_0x170dfb(-0x210,-0x197,-0x14d,-0x1ba),'zfTbm':'前置后','BIACd':_0x24d6c5(0x4cc,0x57f,0x45f,0x4f9),'Vneaj':_0x24d6c5(0x586,0x4fd,0x4f0,0x4e8),'rnmJl':_0x24d6c5(0x458,0x4f2,0x423,0x4b0),'irlNH':function(_0x1f70db,_0x29e37c){return _0x1f70db===_0x29e37c;},'VKtLX':_0x24d6c5(0x597,0x618,0x559,0x57d),'RJBEG':'FUyJU','ixKti':_0x24d6c5(0x3eb,0x490,0x4b8,0x47f)+_0x170dfb(-0x10c,-0x177,-0x163,-0x11a),'rgOka':_0x170dfb(-0x10c,-0xe5,-0x18c,-0x15b),'nomNm':_0x24d6c5(0x537,0x559,0x442,0x4e1),'EcpgR':_0x24d6c5(0x405,0x409,0x491,0x4c8)+'用了\x20{修图}\x20标识'+'。','VOTpl':function(_0x326c89,_0x22c0b9){return _0x326c89||_0x22c0b9;},'TsfXi':function(_0xe39589,_0x14080c){return _0xe39589(_0x14080c);},'TivAi':function(_0x383955,_0x562928){return _0x383955(_0x562928);},'yxfAa':_0x24d6c5(0x4fe,0x525,0x55e,0x54c),'hjCLm':function(_0x472a6b,_0x57c4a4){return _0x472a6b(_0x57c4a4);},'KOEEs':'GtVWK','fnLBP':'zryiG','Crolu':_0x24d6c5(0x562,0x598,0x540,0x4ed),'yCtEg':_0x24d6c5(0x68c,0x5b6,0x5a2,0x5c8),'qRZLq':function(_0xa2498c,_0x58adc8){return _0xa2498c(_0x58adc8);},'ObGVJ':function(_0x4a2856,_0xb3efa7){return _0x4a2856>_0xb3efa7;},'GxNHd':_0x24d6c5(0x55e,0x557,0x437,0x49c),'TwsSO':function(_0x47e910,_0xff7f47){return _0x47e910>_0xff7f47;},'RLEfT':function(_0x5b6be2,_0x644a3f){return _0x5b6be2!==_0x644a3f;},'JUequ':_0x24d6c5(0x42b,0x475,0x4fa,0x4da),'HEadP':_0x170dfb(0x6,0x13,-0xa0,-0xd1),'YmuHZ':_0x24d6c5(0x486,0x520,0x562,0x4d7),'JTKYz':_0x24d6c5(0x5f0,0x59a,0x664,0x5c0),'jtOpy':_0x170dfb(-0x129,-0x1b9,-0x1bf,-0x1db),'IWEGy':function(_0x54684d,_0x436078){return _0x54684d===_0x436078;},'hNrvE':_0x24d6c5(0x654,0x5f1,0x540,0x5e2),'VvyXj':_0x170dfb(-0x28b,-0x22b,-0x1cc,-0x245),'wkcmr':_0x24d6c5(0x473,0x432,0x3ed,0x4aa),'CNzWK':function(_0x4219fc,_0x22ab2c){return _0x4219fc+_0x22ab2c;},'sloQl':function(_0x4e38f5,_0x3e438d){return _0x4e38f5===_0x3e438d;},'CkeSC':function(_0x338567,_0xd1c63b){return _0x338567!==_0xd1c63b;},'nhlXC':_0x170dfb(-0xc4,-0x23,-0xdd,-0x32),'mAiRg':function(_0x3571ce,_0x5ef1ef){return _0x3571ce+_0x5ef1ef;},'EdbVJ':function(_0x3ff5e4,_0x18bb80){return _0x3ff5e4(_0x18bb80);},'elaSa':function(_0x4c03b2,_0x2edb7c){return _0x4c03b2(_0x2edb7c);},'hKuuV':function(_0x156638,_0x1ea541){return _0x156638!==_0x1ea541;},'dEXJi':_0x24d6c5(0x660,0x574,0x584,0x5c9),'hgknZ':function(_0x22f0df,_0x4e90a8){return _0x22f0df!==_0x4e90a8;},'rBylW':_0x24d6c5(0x695,0x5e6,0x6cf,0x612),'NSlTt':_0x24d6c5(0x4e6,0x4ae,0x591,0x577),'kBnAB':_0x170dfb(-0x1bc,-0xd9,-0x186,-0x110),'MGFZf':function(_0x50a764,_0x3a9aef){return _0x50a764===_0x3a9aef;},'yKLTd':'XoBuh','kKrAR':_0x24d6c5(0x425,0x514,0x4df,0x4b7),'IPGTH':_0x170dfb(-0xef,-0x123,-0x176,-0x1b0),'hnGrG':_0x24d6c5(0x469,0x438,0x51c,0x4a5),'mWfvU':function(_0x5d7676,_0x39a372){return _0x5d7676===_0x39a372;},'CliNz':function(_0x45f69d,_0x1c7e19){return _0x45f69d===_0x1c7e19;},'MDIfm':_0x170dfb(-0x131,-0x1ac,-0x12a,-0xba),'QsRxS':function(_0x364768,_0x28dde0){return _0x364768(_0x28dde0);},'Xsykl':_0x170dfb(-0x158,-0x9b,-0x11f,-0x159)+'etected\x20Ma'+'rkdown\x20ima'+_0x24d6c5(0x51b,0x5a0,0x518,0x4d4)+_0x24d6c5(0x4fe,0x496,0x556,0x536)+_0x24d6c5(0x5a5,0x4a6,0x512,0x4f2),'GTbmU':function(_0x3e5ded,_0x171bce){return _0x3e5ded(_0x171bce);},'Bcyow':function(_0x2a4345,_0x31eeaa){return _0x2a4345(_0x31eeaa);},'UVBtq':function(_0x214284,_0x47399b){return _0x214284(_0x47399b);},'IVrDr':function(_0x223f95,_0x3aad38){return _0x223f95(_0x3aad38);},'xPpPo':_0x24d6c5(0x635,0x533,0x600,0x59b)+_0x170dfb(-0x132,-0x135,-0xc3,-0x10e)+_0x24d6c5(0x403,0x4e9,0x444,0x4b4)+'allback.','xNmGn':function(_0x5dbfd6,_0x552180){return _0x5dbfd6(_0x552180);},'tChVS':_0x170dfb(-0x23f,-0x19a,-0x1a4,-0x20e)+_0x24d6c5(0x46d,0x4f2,0x577,0x4b9)+_0x170dfb(-0xa3,-0x93,-0x12e,-0x151)+_0x24d6c5(0x4ba,0x4cf,0x3d1,0x497)+_0x24d6c5(0x4df,0x5e3,0x610,0x58b),'uvWbI':function(_0x6c1d7d,_0x1e897a){return _0x6c1d7d===_0x1e897a;},'jAeSq':'EJlfp','wkhHD':'API\x20respon'+_0x24d6c5(0x4ef,0x5ae,0x475,0x4f8)+_0x24d6c5(0x4c9,0x3f6,0x55f,0x49a)+'mage\x20in\x20Op'+'enAI\x20forma'+'t','obAOJ':_0x170dfb(-0x9d,-0xf3,-0x117,-0x1ab)+'mage\x20gener'+'ated\x20succe'+_0x24d6c5(0x40d,0x45c,0x434,0x4a6),'VjwIy':_0x24d6c5(0x4f6,0x4c0,0x520,0x504),'hUnGD':function(_0x354839,_0x528dce){return _0x354839(_0x528dce);},'hoYfy':function(_0x30fa6d,_0x5a51e8){return _0x30fa6d===_0x5a51e8;},'IeElV':_0x24d6c5(0x459,0x442,0x482,0x507)+'etch\x20error'+':'};_0x4aa0de[_0x170dfb(-0xdc,-0x81,-0xda,-0x93)](clearLog);const _0x2866b3=taskQueue[_0x24d6c5(0x538,0x593,0x607,0x568)]({'name':_0x4aa0de[_0x170dfb(-0x186,-0x180,-0x108,-0x16d)](_0x5eb5ce,'')['substring'](-0x845+0x2128+0x18e3*-0x1,0xe96+-0x2569+0x16f1)+(_0x5eb5ce&&_0x5eb5ce[_0x24d6c5(0x4be,0x60f,0x567,0x579)]>-0x1da0+-0x1*0x115e+0x2f1c?_0x24d6c5(0x5ef,0x59c,0x576,0x551):''),'type':TaskType[_0x24d6c5(0x58f,0x4ee,0x563,0x561)],'prompt':_0x5eb5ce});currentTaskId=_0x2866b3,_0x5eb5ce=_0x4aa0de[_0x170dfb(-0x21b,-0x18c,-0x174,-0x120)](processCharacterPrompt,_0x5eb5ce),_0x5eb5ce=await _0x4aa0de[_0x170dfb(-0x2b,-0x57,-0x7b,-0x38)](stripChineseAnnotations,_0x5eb5ce);let _0x4346d=_0x46e8b8;_0x46e8b8=_0x4aa0de['GpELS'](processCharacterPrompt,_0x46e8b8),_0x46e8b8=await _0x4aa0de[_0x24d6c5(0x55c,0x4af,0x4df,0x4f4)](stripChineseAnnotations,_0x46e8b8),_0x4aa0de['YJwNf'](addLog,_0x170dfb(-0x13c,-0x137,-0xf0,-0x18b)+_0x24d6c5(0x460,0x59e,0x4f3,0x4f0)+extension_settings[extensionName][_0x170dfb(-0x162,-0xeb,-0x100,-0x120)]),_0x4aa0de[_0x24d6c5(0x553,0x4e6,0x489,0x4f4)](addLog,_0x24d6c5(0x534,0x469,0x502,0x4d5)+'\x20'+_0x4aa0de[_0x170dfb(-0x14c,-0xc2,-0x108,-0xbd)](_0x47f135,'默认')+_0x170dfb(-0x2a,-0x9,-0xc5,-0x159)+(_0x2b7221||'默认')),_0x5eb5ce=_0x46e8b8&&_0x4aa0de[_0x170dfb(-0x197,-0x126,-0xff,-0x19d)](_0x46e8b8[_0x170dfb(-0x143,-0x15b,-0x9b,-0x8a)](),'')?_0x46e8b8:_0x5eb5ce,_0x4aa0de[_0x24d6c5(0x558,0x4aa,0x465,0x4f4)](addLog,'用于生成的Tag:\x20'+_0x5eb5ce);let _0x37d91f=![];_0x5eb5ce[_0x24d6c5(0x4a0,0x4dc,0x46b,0x4f6)](_0x170dfb(-0x17b,-0xf3,-0x13e,-0xd1)+_0x24d6c5(0x5d5,0x58c,0x4f1,0x5a2))&&(_0x37d91f=!![]);_0x4aa0de['koJpv'](addLog,'是否启用分角色模式\x20'+_0x24d6c5(0x631,0x657,0x65c,0x5c7)+'les):\x20'+_0x37d91f);let _0x5d67be={},_0x2847d4='',_0x1205d8='';if(_0x37d91f){addLog(_0x4aa0de[_0x170dfb(-0x14e,-0x2f,-0xd1,-0xc6)]),_0x5d67be=parsePromptStringWithCoordinates(_0x5eb5ce),_0x2847d4=_0x5d67be[_0x4aa0de[_0x24d6c5(0x64b,0x50b,0x639,0x5bb)]];for(let _0x67f6db=-0x22f+0x1cf5+0xb*-0x26f;_0x67f6db<=-0x1*-0x17c2+0x1*-0xc1f+-0xb9f;_0x67f6db++){_0x5d67be[_0x24d6c5(0x535,0x47e,0x4ca,0x494)+_0x67f6db+'\x20Prompt']&&(_0x1205d8=_0x4aa0de['xZprX'](_0x1205d8,',\x20')+_0x5d67be[_0x24d6c5(0x4a1,0x529,0x50c,0x494)+_0x67f6db+_0x170dfb(-0xcc,-0xc,-0x9a,-0x50)]);}}else _0x4aa0de['QgmTJ'](addLog,_0x4aa0de['NNhcz']),_0x2847d4=_0x5eb5ce;let {modifiedPrompt:_0x3d27ee,insertions:_0x2c07a8}=await _0x4aa0de[_0x170dfb(-0xce,-0x201,-0x199,-0x17d)](prompt_replace,_0x2847d4,_0x1205d8);if(_0x37d91f)for(let _0x3c7441=0xa3*-0x17+-0x2076+0x2f1c;_0x4aa0de[_0x24d6c5(0x5ce,0x649,0x5d0,0x5f1)](_0x3c7441,-0x19e6+0x1b40+-0x156);_0x3c7441++){_0x5d67be[_0x24d6c5(0x530,0x3cc,0x463,0x494)+_0x3c7441+_0x24d6c5(0x630,0x5ec,0x63c,0x5ee)]&&(_0x3d27ee=_0x4aa0de[_0x170dfb(-0x23e,-0x1d3,-0x1f2,-0x12e)](_0x4aa0de[_0x170dfb(-0x236,-0x1ec,-0x187,-0xbe)](_0x3d27ee,_0x4aa0de['Zkcxi']),_0x4aa0de[_0x24d6c5(0x510,0x5a8,0x56b,0x544)](prompt_replace_for_character,_0x5d67be['Character\x20'+_0x3c7441+'\x20Prompt'])));}const _0x1130c3=extension_settings[extensionName]['banana'],{model:_0x5d1ac5,apiUrl:_0x10f466,apiKey:_0x16a28d,conversationPresets:_0x35c9d1,conversationPresetId:_0x1f0b8c,editPresetId:_0x2e2a7a,aspectRatio:_0x1736cf}=_0x1130c3;addLog(_0x24d6c5(0x512,0x5d8,0x517,0x515)+_0x24d6c5(0x4b2,0x521,0x491,0x53a)+_0x170dfb(-0x1fc,-0x26e,-0x1b0,-0x140)+_0x170dfb(-0xd7,-0xd0,-0xf8,-0x4e)+'model:\x20'+_0x5d1ac5);let _0xbb218a,_0x2c956c;if(_0x5d1ac5['startsWith'](_0x4aa0de[_0x170dfb(-0xf8,-0xff,-0x88,-0xe6)])){if(_0x4aa0de[_0x170dfb(-0x23a,-0x120,-0x1c7,-0x290)](_0x4aa0de[_0x24d6c5(0x567,0x490,0x3de,0x4a3)],_0x4aa0de[_0x24d6c5(0x57b,0x585,0x418,0x4bd)])){_0xbb218a=_0x24d6c5(0x3f6,0x43c,0x4be,0x48f)+_0x170dfb(-0x1df,-0x247,-0x205,-0x1c1)+_0x5d1ac5;const _0x2582f5={};_0x2582f5[_0x24d6c5(0x58e,0x58f,0x5be,0x5fc)+'t']='';const _0x29d728=_0x35c9d1[_0x1f0b8c]||_0x2582f5,_0x1c6acf=[_0x29d728['fixedPromp'+'t'],_0x2c07a8[_0x4aa0de[_0x170dfb(-0xa3,-0x118,-0xf2,-0xe3)]],_0x2c07a8[_0x4aa0de[_0x24d6c5(0x4d9,0x61c,0x592,0x567)]],_0x3d27ee,_0x2c07a8[_0x4aa0de[_0x24d6c5(0x65a,0x5b4,0x4fb,0x5c4)]],_0x2c07a8[_0x4aa0de[_0x170dfb(-0x187,-0xfd,-0xf9,-0x49)]],_0x29d728[_0x24d6c5(0x63d,0x65d,0x5f0,0x5e4)+_0x24d6c5(0x554,0x57a,0x5d5,0x540)],_0x2c07a8[_0x4aa0de[_0x24d6c5(0x54d,0x4e4,0x59d,0x531)]]]['filter'](Boolean)['join'](',\x20');addLog(_0x24d6c5(0x4f8,0x55d,0x556,0x4a4)+_0x1c6acf);const _0x2eed28={};_0x2eed28[_0x24d6c5(0x486,0x602,0x5ae,0x542)]=_0x1c6acf;const _0x1d1a14={};_0x1d1a14[_0x170dfb(-0x12f,-0x112,-0x107,-0x4b)+'t']=0x1,_0x1d1a14[_0x170dfb(-0xbf,-0x196,-0xd5,-0x33)+'o']=_0x1736cf;const _0x59c6f4={};_0x59c6f4[_0x24d6c5(0x44b,0x432,0x52c,0x4ae)]=[_0x2eed28],_0x59c6f4[_0x24d6c5(0x5d6,0x5a2,0x4ee,0x553)]=_0x1d1a14,_0x2c956c=_0x59c6f4,addLog(_0x170dfb(-0x17d,-0x11e,-0xd7,-0x1a)+_0x24d6c5(0x563,0x5a4,0x5d8,0x56e)+_0x24d6c5(0x466,0x450,0x470,0x495)+_0x24d6c5(0x531,0x547,0x507,0x57f)+_0x24d6c5(0x53a,0x4f7,0x54a,0x49e)+_0x1c6acf);}else{const _0x371a8a=_0x3905b7?function(){if(_0x5c3eb7){const _0x138180=_0x3ef92c['apply'](_0x51c618,arguments);return _0x19b03b=null,_0x138180;}}:function(){};return _0x212c56=![],_0x371a8a;}}else{if(_0x4aa0de['irlNH'](_0x4aa0de[_0x170dfb(-0x186,-0x242,-0x17e,-0x221)],_0x4aa0de[_0x24d6c5(0x63c,0x626,0x669,0x5d5)]))_0x4aa0de[_0x24d6c5(0x59a,0x5ed,0x552,0x610)](_0xa8acfc,_0x170dfb(-0x1c4,-0xe4,-0x1a8,-0xf2)+'库');else{_0xbb218a=_0x4aa0de[_0x170dfb(-0x112,-0x13a,-0xa8,-0x6)];let _0x6230c6;if(_0x46e8b8[_0x24d6c5(0x546,0x502,0x4ab,0x4f6)](_0x4aa0de[_0x170dfb(-0x154,-0x237,-0x1fc,-0x1e5)])){if(_0x4aa0de['irlNH'](_0x4aa0de[_0x170dfb(-0x5c,0x23,-0xa1,-0x25)],_0x4aa0de[_0x170dfb(-0x11c,-0x2e,-0xa1,-0xcd)])){_0x4aa0de[_0x24d6c5(0x534,0x445,0x581,0x4ca)](addLog,_0x4aa0de[_0x24d6c5(0x594,0x596,0x566,0x585)]);const _0x1cd644=_0x4aa0de[_0x170dfb(-0x17a,-0x1d7,-0x11c,-0x183)](_0x2e2a7a,'默认'),_0x2f24ca={};_0x2f24ca[_0x170dfb(-0x249,-0x203,-0x1b8,-0x240)+'on']=[],_0x2f24ca[_0x24d6c5(0x556,0x60e,0x655,0x5fc)+'t']='',_0x6230c6=_0x35c9d1[_0x1cd644]||_0x2f24ca,_0x4aa0de[_0x24d6c5(0x60f,0x5e7,0x506,0x59c)](addLog,'[Banana]\x20使'+_0x170dfb(-0x11b,-0x10c,-0x1a3,-0x1e2)+_0x1cd644+'\x22');}else _0x493fbd(_0x4aa0de['NNhcz']),_0xb87eb4=_0x4b7ee2;}else{const _0x5c717d={};_0x5c717d['conversati'+'on']=[],_0x5c717d[_0x24d6c5(0x5ee,0x649,0x591,0x5fc)+'t']='',_0x6230c6=_0x35c9d1[_0x1f0b8c]||_0x5c717d;}const _0xb36b64=[_0x6230c6[_0x24d6c5(0x5f6,0x58d,0x5d0,0x5fc)+'t'],_0x2c07a8[_0x4aa0de[_0x24d6c5(0x5b9,0x50e,0x635,0x596)]],_0x2c07a8[_0x4aa0de[_0x170dfb(-0x18f,-0x7c,-0x121,-0x17a)]],_0x3d27ee,_0x2c07a8[_0x4aa0de[_0x170dfb(-0x13f,-0xc0,-0xc4,-0x3e)]],_0x2c07a8[_0x4aa0de[_0x170dfb(-0xcb,-0x67,-0xf9,-0x15d)]],_0x6230c6['postfixPro'+_0x170dfb(-0x15b,-0x194,-0x148,-0x177)],_0x2c07a8[_0x24d6c5(0x49e,0x41a,0x490,0x4b0)]][_0x24d6c5(0x4fa,0x4d8,0x585,0x50f)](Boolean)[_0x170dfb(-0x1c7,-0x1ea,-0x154,-0xf5)](',\x20');_0x4aa0de['TivAi'](addLog,'正面提示词:\x20'+_0xb36b64);const _0x1e4b96={};_0x1e4b96[_0x170dfb(-0x14c,-0x10e,-0xa7,-0x102)]=_0x24d6c5(0x3d8,0x4f7,0x47d,0x49c),_0x1e4b96[_0x170dfb(-0xd9,-0x170,-0x114,-0x182)]=[];const _0x7ac8ae={};_0x7ac8ae[_0x170dfb(-0xd8,-0x47,-0xa7,-0x2a)]=_0x170dfb(-0x80,-0xaa,-0xa0,-0x148),_0x7ac8ae[_0x24d6c5(0x57c,0x61d,0x4e5,0x574)]=[];const _0x2c965e=_0x6230c6[_0x24d6c5(0x4b8,0x4bf,0x52f,0x4d0)+'on'][_0x170dfb(-0x5c,-0x5c,-0xb6,-0xb7)](_0x225fa0=>[_0x1e4b96,_0x7ac8ae])[_0x24d6c5(0x502,0x4d9,0x5a5,0x5a4)]();let _0x26e6ef=-0x5*0x5+0x7da+-0x7c1;for(const _0x2e0471 of _0x6230c6[_0x170dfb(-0x241,-0x108,-0x1b8,-0x221)+'on']){if(_0x2e0471[_0x170dfb(-0x237,-0x176,-0x1ec,-0x216)]?.['text'])_0x2c965e[_0x26e6ef][_0x170dfb(-0x4d,-0x7e,-0x114,-0xc6)][_0x170dfb(-0x73,-0x103,-0x13a,-0x1a8)]({'type':_0x4aa0de[_0x170dfb(-0x3d,-0x16f,-0xf4,-0x163)],'text':_0x2e0471[_0x24d6c5(0x3f8,0x41d,0x508,0x49c)][_0x170dfb(-0x1ce,-0xd5,-0x13c,-0xa2)]});const _0xc9c76b=await _0x4aa0de[_0x170dfb(-0x144,-0x29d,-0x20a,-0x292)](getImageFromTurnData,_0x2e0471['user']);if(_0xc9c76b)_0x2c965e[_0x26e6ef][_0x24d6c5(0x512,0x514,0x558,0x574)][_0x24d6c5(0x586,0x5cc,0x56c,0x54e)]({'type':_0x4aa0de['SmopY'],'image_url':{'url':_0xc9c76b}});_0x26e6ef++;if(_0x2e0471[_0x170dfb(-0xa4,-0x38,-0xe2,-0x80)]?.['text'])_0x2c965e[_0x26e6ef][_0x170dfb(-0x13b,-0x177,-0x114,-0x9b)][_0x24d6c5(0x585,0x522,0x4f1,0x54e)]({'type':_0x4aa0de[_0x170dfb(-0xc3,-0x185,-0xf4,-0xba)],'text':_0x2e0471[_0x170dfb(-0x116,-0x105,-0xe2,-0xc7)][_0x24d6c5(0x5fe,0x579,0x51d,0x54c)]});const _0x206c3f=await _0x4aa0de[_0x170dfb(-0x206,-0x1ce,-0x194,-0x1e6)](getImageFromTurnData,_0x2e0471['model']);if(_0x206c3f)_0x2c965e[_0x26e6ef][_0x170dfb(-0xfa,-0xb4,-0x114,-0x101)]['push']({'type':_0x4aa0de['SmopY'],'image_url':{'url':_0x206c3f}});_0x26e6ef++;}if(!_0x46e8b8[_0x170dfb(-0x16c,-0x110,-0x192,-0x13b)](_0x4aa0de[_0x170dfb(-0x18b,-0x193,-0x1fc,-0x183)])){if(_0x4aa0de['KOEEs']===_0x4aa0de[_0x170dfb(-0x102,-0x208,-0x19a,-0x15d)]){const _0x588ef7=new _0x292f89();_0x588ef7['onloadend']=()=>_0x5c22af(_0x588ef7[_0x170dfb(-0xba,-0x125,-0xfb,-0x37)]),_0x588ef7['onerror']=_0x2dc62b,_0x588ef7[_0x24d6c5(0x4f2,0x4f0,0x557,0x529)+'URL'](_0x4c27ea);}else{const _0x1de3bf=extension_settings[extensionName][_0x24d6c5(0x5a9,0x533,0x58d,0x57b)+'acterPrese'+'ts']||{};for(const _0x3dd2e6 in _0x1de3bf){if(_0x4aa0de[_0x170dfb(-0x5,-0x43,-0x9c,0x6)](_0x4aa0de[_0x170dfb(-0x29b,-0x213,-0x1e7,-0x2b1)],_0x4aa0de[_0x170dfb(-0x125,-0xf5,-0xe5,-0x188)])){const _0x124358=_0x1de3bf[_0x3dd2e6],_0x46b4db=(_0x124358[_0x170dfb(-0xdb,-0x10e,-0x17c,-0x18e)]||'')[_0x170dfb(-0x1c5,-0x15d,-0x207,-0x19c)]('|')[_0x24d6c5(0x4ac,0x4ba,0x58d,0x50f)](_0x540c2a=>_0x540c2a[_0x170dfb(-0x38,0x23,-0x9b,-0x13a)]()!=='');for(const _0x5935b3 of _0x46b4db){if(_0xb36b64[_0x24d6c5(0x60c,0x57c,0x574,0x5f4)+'e']()[_0x24d6c5(0x4f2,0x4f3,0x46e,0x4f6)](_0x5935b3[_0x170dfb(-0x144,-0x4e,-0x94,-0x3c)+'e']())){_0x4aa0de[_0x24d6c5(0x5da,0x62b,0x5e2,0x5e3)](addLog,'[Banana]\x20F'+'ound\x20match'+_0x170dfb(-0xaf,-0x69,-0x9f,-0x1)+_0x24d6c5(0x508,0x4e3,0x523,0x506)+_0x5935b3+('\x22\x20from\x20pre'+'set\x20\x22')+_0x3dd2e6+'\x22.');const _0x37242a=_0x124358['conversati'+'on'];if(_0x37242a){const _0x372a45=[];if(_0x37242a[_0x170dfb(-0x1f9,-0x18e,-0x1ec,-0x1d2)]&&_0x37242a[_0x24d6c5(0x450,0x42c,0x3d1,0x49c)][_0x170dfb(-0x13e,-0x120,-0x13c,-0x189)])_0x372a45[_0x24d6c5(0x610,0x4e8,0x4e9,0x54e)]({'type':_0x4aa0de[_0x24d6c5(0x62e,0x55c,0x634,0x594)],'text':_0x37242a[_0x24d6c5(0x53b,0x515,0x49b,0x49c)]['text']});const _0x517ce2=await _0x4aa0de['qRZLq'](getImageFromTurnData,_0x37242a[_0x24d6c5(0x4da,0x511,0x4bc,0x49c)]);if(_0x517ce2)_0x372a45['push']({'type':_0x4aa0de[_0x24d6c5(0x4e4,0x508,0x55c,0x55f)],'image_url':{'url':_0x517ce2}});if(_0x4aa0de[_0x170dfb(-0x3d,-0xf3,-0x7e,-0x83)](_0x372a45[_0x170dfb(-0x13d,-0x18f,-0x10f,-0x9d)],0x1996+-0xba*-0x1b+-0x2d34)){const _0x4a28e2={};_0x4a28e2[_0x24d6c5(0x5aa,0x66d,0x5e8,0x5e1)]=_0x4aa0de[_0x24d6c5(0x4d8,0x4c3,0x52d,0x51a)],_0x4a28e2[_0x24d6c5(0x59b,0x5c7,0x5ec,0x574)]=_0x372a45,_0x2c965e[_0x24d6c5(0x596,0x60a,0x4b3,0x54e)](_0x4a28e2);}const _0x4e07d7=[];if(_0x37242a['model']&&_0x37242a['model'][_0x24d6c5(0x4ef,0x50f,0x538,0x54c)])_0x4e07d7[_0x170dfb(-0xea,-0x114,-0x13a,-0x1ce)]({'type':_0x4aa0de['yxfAa'],'text':_0x37242a['model'][_0x24d6c5(0x4e5,0x575,0x4e4,0x54c)]});const _0x902011=await _0x4aa0de[_0x170dfb(-0xb9,-0xe5,-0xec,-0x14d)](getImageFromTurnData,_0x37242a[_0x170dfb(-0xce,-0x28,-0xe2,-0x14d)]);if(_0x902011)_0x4e07d7['push']({'type':_0x4aa0de[_0x24d6c5(0x5e6,0x59b,0x57f,0x55f)],'image_url':{'url':_0x902011}});if(_0x4aa0de[_0x24d6c5(0x4ef,0x52b,0x452,0x4a9)](_0x4e07d7[_0x24d6c5(0x4f4,0x5f9,0x56f,0x579)],-0x1*-0xd6b+-0x1dc8+-0x1*-0x105d)){if(_0x4aa0de[_0x24d6c5(0x60d,0x56f,0x5a4,0x5eb)](_0x4aa0de[_0x24d6c5(0x583,0x598,0x567,0x5ce)],_0x4aa0de[_0x24d6c5(0x5ed,0x5bf,0x5f0,0x5ce)]))_0x3c237c=_0x4aa0de['xZprX'](_0x33ecb3,_0x466f58);else{const _0x595a87={};_0x595a87[_0x24d6c5(0x56a,0x546,0x5c9,0x5e1)]=_0x4aa0de[_0x24d6c5(0x550,0x59c,0x5a9,0x5a1)],_0x595a87[_0x24d6c5(0x51d,0x5d4,0x538,0x574)]=_0x4e07d7,_0x2c965e[_0x24d6c5(0x488,0x54f,0x5e0,0x54e)](_0x595a87);}}}break;}}}else{_0x414e12=_0x2cd909;const _0x532e61={};_0x532e61[_0x24d6c5(0x4df,0x53f,0x4b7,0x563)+'pe']=_0x4aa0de[_0x170dfb(-0x1e5,-0x10d,-0x1c2,-0x243)],_0x532e61[_0x170dfb(-0xd0,-0x65,-0x99,-0xaf)+_0x24d6c5(0x49a,0x4ee,0x515,0x52e)]='Bearer\x20'+_0x427a1e,_0x4a063c=_0x532e61,_0x17280e=_0x37012b,_0x4aa0de['YJwNf'](_0x3ef4bc,_0x24d6c5(0x3ee,0x548,0x3f5,0x4b3)+_0x170dfb(-0x4d,-0x9f,-0xf7,-0x76));}}}}if(!_0x46e8b8[_0x24d6c5(0x514,0x51d,0x517,0x4f6)](_0x4aa0de['rgOka'])){const _0x385b03={};_0x385b03[_0x24d6c5(0x515,0x516,0x5b0,0x52f)]=_0x4aa0de[_0x24d6c5(0x532,0x4eb,0x64d,0x594)],_0x385b03[_0x170dfb(-0xe1,-0x1be,-0x13c,-0x196)]=_0xb36b64;const _0x354e94={};_0x354e94[_0x24d6c5(0x5df,0x677,0x63f,0x5e1)]=_0x24d6c5(0x468,0x512,0x41c,0x49c),_0x354e94[_0x170dfb(-0xbe,-0x1c4,-0x114,-0xc2)]=[_0x385b03],_0x2c965e[_0x170dfb(-0x161,-0xe6,-0x13a,-0x1e6)](_0x354e94);}else{if(_0x4aa0de[_0x24d6c5(0x47c,0x501,0x3f9,0x4c1)](_0x4aa0de[_0x170dfb(-0x163,-0x21c,-0x1e9,-0x20e)],_0x24d6c5(0x420,0x483,0x4f8,0x4d7)))_0x12dcc5[_0x24d6c5(0x40c,0x54a,0x465,0x4c2)+_0x24d6c5(0x679,0x51c,0x5d2,0x5ca)](_0x558027,_0x164461);else{const _0x205c0a=[],_0x33d5d3=_0x45358e||_0xb36b64,_0x410f4f=[_0x6230c6[_0x170dfb(-0x10b,0x38,-0x8c,-0x143)+'t'],_0x33d5d3,_0x6230c6[_0x170dfb(-0xb3,-0xb7,-0xa4,-0x9f)+_0x24d6c5(0x60a,0x47f,0x4c0,0x540)]][_0x24d6c5(0x5c1,0x4f0,0x554,0x50f)](Boolean)[_0x170dfb(-0x93,-0x109,-0x154,-0x1cc)](',\x20'),_0x48b38b={};_0x48b38b[_0x24d6c5(0x4a3,0x4f1,0x4f5,0x52f)]=_0x170dfb(-0xb0,-0xef,-0x13c,-0x206),_0x48b38b[_0x24d6c5(0x5d3,0x4f6,0x5b0,0x54c)]=_0x410f4f,_0x205c0a[_0x24d6c5(0x58d,0x48b,0x5bb,0x54e)](_0x48b38b);if(_0x5d525d){if(_0x4aa0de[_0x24d6c5(0x602,0x5ec,0x551,0x54d)](_0x4aa0de['JTKYz'],_0x4aa0de['jtOpy']))_0x5c157e['on'](_0xe6d3a4[_0x170dfb(-0x19d,-0x23c,-0x1d6,-0x13c)+_0x170dfb(-0xad,-0xf9,-0xbb,-0x2b)+'ST'],_0x48e652),_0x7b8140['on'](_0x4aa0de[_0x170dfb(-0x19f,-0xca,-0x119,-0x19c)],_0x19fa9b),_0x4aa0de['NoHSa'](_0x170fb0,_0x4aa0de[_0x170dfb(-0x1a9,-0x1e8,-0x17f,-0x1b3)]);else{const _0x5372d9={};_0x5372d9['url']=_0x5d525d;const _0x26e497={};_0x26e497[_0x170dfb(-0xf1,-0x109,-0x159,-0xcd)]=_0x4aa0de[_0x24d6c5(0x5ae,0x4b6,0x572,0x55f)],_0x26e497[_0x170dfb(-0x175,-0x107,-0x1d0,-0x1dd)]=_0x5372d9,_0x205c0a['push'](_0x26e497),_0x4aa0de[_0x170dfb(-0x1a6,-0x278,-0x20a,-0x1d4)](addLog,'[Banana]\x20修'+'图模式：已添加待修改'+_0x24d6c5(0x52d,0x52e,0x5c4,0x559));}}const _0x20ba3f={};_0x20ba3f[_0x170dfb(-0x41,-0x14e,-0xa7,-0x58)]=_0x4aa0de[_0x170dfb(-0xd9,-0xea,-0x16e,-0x1f8)],_0x20ba3f[_0x170dfb(-0x17b,-0x161,-0x114,-0xa9)]=_0x205c0a,_0x2c965e[_0x170dfb(-0x204,-0x173,-0x13a,-0xe6)](_0x20ba3f),_0x4aa0de[_0x24d6c5(0x462,0x537,0x578,0x4ca)](addLog,_0x24d6c5(0x4f1,0x589,0x53b,0x57c)+_0x24d6c5(0x432,0x441,0x559,0x49d)+_0x410f4f);}}const _0x36dfa8={};_0x36dfa8[_0x24d6c5(0x626,0x4e8,0x659,0x5b3)+'o']=_0x1736cf;const _0x115812={};_0x115812['imageConfi'+'g']=_0x36dfa8,_0x2c956c={'model':_0x5d1ac5,'messages':_0x2c965e[_0x24d6c5(0x479,0x471,0x4bd,0x50f)](_0x24b841=>_0x24b841['content'][_0x24d6c5(0x5ec,0x55b,0x4ec,0x579)]>-0x13a5+0x12c1*0x1+0xe4),'config':_0x115812},addLog('[Banana]\x20B'+_0x24d6c5(0x4b9,0x472,0x47b,0x4f3)+_0x170dfb(-0xa8,-0x108,-0x15b,-0x14c)+_0x170dfb(-0x1db,-0x115,-0x178,-0x1cf)+_0x2c956c[_0x24d6c5(0x53d,0x58c,0x4e8,0x549)][_0x170dfb(-0xa6,-0xde,-0x10f,-0x167)]+_0x170dfb(-0x1c1,-0xee,-0xf6,-0x95));}}let _0x4848a=_0x10f466[_0x24d6c5(0x555,0x555,0x44a,0x4c3)](/\/$/,''),_0x4bf206;if(_0x4848a[_0x24d6c5(0x648,0x4eb,0x52a,0x5af)](_0x4aa0de['HADpX'])||_0x4848a['includes'](_0x4aa0de[_0x24d6c5(0x48f,0x567,0x551,0x49b)])){if(_0x4aa0de['IWEGy'](_0x4aa0de['hNrvE'],_0x4aa0de[_0x170dfb(-0x1ef,-0x1a0,-0x136,-0x7c)])){const _0x3a3c7d=_0x170dfb(0x9,0x1c,-0x7f,-0x76)[_0x170dfb(-0x1c0,-0x15b,-0x207,-0x16f)]('|');let _0x30d0be=0x231b+-0x16*0x2f+-0xb*0x2d3;while(!![]){switch(_0x3a3c7d[_0x30d0be++]){case'0':_0x4368f0=null;continue;case'1':_0x888a06=null;continue;case'2':_0x2b2ea9=null;continue;case'3':_0x46c258(_0x24d6c5(0x4d3,0x493,0x51b,0x537)+_0x170dfb(-0x61,-0x172,-0x11b,-0x93)+_0x170dfb(-0xe1,-0x6c,-0xb5,-0x10f)+_0x4feb82+')');continue;case'4':_0x210d0f[_0x24d6c5(0x62d,0x613,0x54f,0x5de)](_0x4f376d[_0x24d6c5(0x549,0x52d,0x53a,0x4b2)+_0x170dfb(-0x1ce,-0x175,-0x115,-0x1a2)+'NSE'],{'id':_0x3419ec,'success':![],'error':_0x4aa0de[_0x24d6c5(0x547,0x538,0x5b4,0x513)],'prompt':_0x4aa0de[_0x24d6c5(0x53f,0x4d0,0x625,0x580)](_0x56ee87,'')});continue;}break;}}else _0x4bf206=_0x4848a+_0xbb218a;}else _0x4aa0de[_0x24d6c5(0x5ba,0x60f,0x53c,0x58c)](_0x4aa0de[_0x170dfb(-0x53,-0x53,-0xd3,-0x19c)],_0x170dfb(-0x153,-0x27f,-0x1de,-0x1a4))?_0x4bf206=_0x4aa0de[_0x170dfb(-0x10c,-0x138,-0x1a1,-0x1ae)](_0x4aa0de['CNzWK'](_0x4848a,_0x24d6c5(0x565,0x5da,0x44b,0x50e)),_0xbb218a):_0x8a821b[_0x170dfb(-0x29c,-0x18f,-0x1f4,-0x1d4)+_0x2bdb57+_0x24d6c5(0x56f,0x5e2,0x5f3,0x5ee)]&&(_0x2da0e8=_0x4aa0de[_0x24d6c5(0x566,0x44e,0x524,0x4e7)](_0x4cdedf+_0x170dfb(-0x12e,-0x1a3,-0x139,-0x124),_0xda3b8c(_0x4e44a3[_0x24d6c5(0x464,0x4bb,0x520,0x494)+_0xcf5b3d+_0x170dfb(0x26,-0x2d,-0x9a,-0x12c)])));_0x4bf206=_0x4bf206['replace'](/\/v1\/v1\//g,'/v1/');function _0x24d6c5(_0x4ef635,_0x5bc4ee,_0x2f034d,_0x4e6ee4){return _0x5553(_0x4e6ee4-0x2d4,_0x2f034d);}const _0x1f1610=extension_settings[extensionName]['client'];let _0x7b75,_0x7221bf,_0x2e02da;if(_0x4aa0de[_0x170dfb(-0xfa,-0x1c1,-0x177,-0x238)](_0x1f1610,_0x24d6c5(0x48f,0x57c,0x542,0x4cc))){if(_0x4aa0de['CkeSC'](_0x4aa0de[_0x24d6c5(0x658,0x5cf,0x5bb,0x5e6)],_0x24d6c5(0x4b9,0x412,0x4b3,0x4dc))){let _0x4a2ce3=_0x4848a;!_0x4a2ce3[_0x170dfb(-0x49,-0xd0,-0xd9,-0xbe)](_0x4aa0de[_0x170dfb(-0x1f6,-0x24d,-0x1d7,-0x1a0)])&&!_0x4a2ce3[_0x24d6c5(0x51f,0x439,0x522,0x4f6)](_0x4aa0de[_0x170dfb(-0x2ac,-0x19c,-0x1ed,-0x14e)])&&(_0x4a2ce3=_0x4aa0de[_0x170dfb(-0x1a6,-0x1c0,-0x10e,-0x8f)](_0x4a2ce3,_0x4aa0de[_0x24d6c5(0x45b,0x44a,0x55c,0x4b1)]));_0x4a2ce3=_0x4a2ce3['replace'](/\/v1\/$/,_0x4aa0de[_0x170dfb(-0x160,-0x1a7,-0x1d7,-0x13c)]),_0x7b75=_0x4aa0de[_0x24d6c5(0x5fd,0x5e6,0x53f,0x5fe)],_0x7221bf=_0x4aa0de['EdbVJ'](getRequestHeaders,window[_0x170dfb(-0x127,-0xd4,-0x89,-0x36)]);const _0x397fce={};_0x397fce['chat_compl'+_0x170dfb(-0x149,-0x192,-0xcc,-0x69)+'ce']=_0x4aa0de[_0x170dfb(-0x114,-0xeb,-0x16a,-0xcf)],_0x397fce[_0x24d6c5(0x59f,0x5b8,0x613,0x584)]=_0x4a2ce3,_0x397fce['custom_inc'+'lude_heade'+'rs']='Authorizat'+_0x170dfb(-0x10a,-0x4,-0xa9,-0x110)+_0x24d6c5(0x54c,0x621,0x583,0x5d9)+_0x16a28d+'\x22',_0x397fce[_0x24d6c5(0x66b,0x51b,0x627,0x5a6)]=_0x5d1ac5,_0x397fce[_0x170dfb(-0x1cf,-0xd1,-0x13f,-0xb9)]=_0x2c956c[_0x170dfb(-0x146,-0x169,-0x13f,-0x1f1)],_0x397fce[_0x24d6c5(0x52e,0x54d,0x5d6,0x57e)]=![],_0x2e02da=_0x397fce;if(_0x5d1ac5[_0x24d6c5(0x4aa,0x3fb,0x484,0x491)](_0x4aa0de['mDVYa'])){addLog('[Banana]\x20I'+_0x170dfb(-0x2b3,-0x1fa,-0x20c,-0x2b4)+_0x170dfb(-0x13f,-0x146,-0x1b9,-0x1d1)+_0x24d6c5(0x5c5,0x598,0x4f3,0x5be)),_0x7b75=_0x4bf206;const _0x197ab2={};_0x197ab2[_0x24d6c5(0x602,0x58d,0x505,0x563)+'pe']='applicatio'+'n/json',_0x197ab2[_0x170dfb(-0x91,-0x9c,-0x99,-0xc0)+_0x170dfb(-0x177,-0x144,-0x15a,-0x179)]=_0x24d6c5(0x603,0x561,0x5b5,0x543)+_0x16a28d,_0x7221bf=_0x197ab2,_0x2e02da=_0x2c956c;}_0x4aa0de[_0x170dfb(-0x148,-0xac,-0xce,-0x154)](addLog,'[Banana]\x20使'+_0x170dfb(-0xd3,-0x17f,-0x133,-0x1b1));}else _0x2c055f=_0x4aa0de[_0x170dfb(-0x94,-0xda,-0xb4,-0x13c)](_0x4aa0de[_0x24d6c5(0x523,0x54e,0x50a,0x5d4)](_0x53dc28,_0x4aa0de['Zkcxi']),_0x4aa0de[_0x170dfb(-0x271,-0x1ca,-0x1be,-0x227)](_0x487709,_0x436915['Character\x20'+_0x11761c+_0x170dfb(-0x162,-0x5f,-0x9a,-0x17)]));}else{if(_0x4aa0de['hKuuV'](_0x24d6c5(0x673,0x512,0x525,0x5c9),_0x4aa0de[_0x24d6c5(0x5be,0x5e2,0x5a7,0x560)])){if(_0x53b755){const _0x24bfe1=_0x82a34b[_0x170dfb(-0x1f8,-0x16f,-0x1ad,-0x12c)](_0x20610d,arguments);return _0x3f6431=null,_0x24bfe1;}}else{_0x7b75=_0x4bf206;const _0x1152b4={};_0x1152b4[_0x170dfb(-0x6f,-0x1b4,-0x125,-0xe0)+'pe']=_0x4aa0de['MGXMf'],_0x1152b4['Authorizat'+_0x170dfb(-0x1b6,-0x108,-0x15a,-0x165)]=_0x170dfb(-0x12c,-0x86,-0x145,-0x87)+_0x16a28d,_0x7221bf=_0x1152b4,_0x2e02da=_0x2c956c,addLog(_0x24d6c5(0x4cb,0x4de,0x45a,0x4b3)+'用直接请求模式');}}_0x4aa0de[_0x170dfb(-0x1a7,-0x210,-0x144,-0x108)](addLog,'[Banana]\x20S'+_0x170dfb(0x13,-0x16d,-0xab,-0xd4)+_0x24d6c5(0x5e5,0x638,0x612,0x5fb)+_0x7b75),_0x4aa0de[_0x24d6c5(0x538,0x5e0,0x59c,0x544)](addLog,_0x170dfb(-0x1,-0xe7,-0xb1,-0x100)+'ayload:\x20'+JSON[_0x170dfb(-0x150,-0x8c,-0x12d,-0x88)](_0x2e02da,null,0x1*0xf59+-0x1*-0xdf4+-0x1d4b*0x1));function _0x170dfb(_0x51a506,_0x8f358,_0x1ed2eb,_0x159bd1){return _0x5553(_0x1ed2eb- -0x3b4,_0x8f358);}try{if(_0x4aa0de[_0x170dfb(-0x157,-0x15b,-0x171,-0xdd)](_0x4aa0de[_0x24d6c5(0x5f0,0x684,0x68a,0x5c1)],_0x4aa0de[_0x170dfb(-0xb9,-0x154,-0xc7,-0x120)]))_0x1178a4[_0x24d6c5(0x4a1,0x60f,0x4bc,0x545)+'sk'](_0x3b6d73,![]);else{taskQueue['updateStat'+'us'](_0x2866b3,_0x4aa0de[_0x170dfb(-0x1f2,-0x1cd,-0x208,-0x2c4)]);const _0x3b654e=await fetch(_0x7b75,{'method':_0x4aa0de['kBnAB'],'headers':_0x7221bf,'body':JSON[_0x24d6c5(0x4c9,0x5ed,0x49f,0x55b)](_0x2e02da)});if(!_0x3b654e['ok']){if(_0x4aa0de[_0x170dfb(-0x1b2,-0x1fe,-0x1fe,-0x270)](_0x4aa0de[_0x24d6c5(0x4f2,0x634,0x580,0x56b)],_0x4aa0de[_0x24d6c5(0x57b,0x5b3,0x5b3,0x5e5)])){_0x271a9d(_0x4aa0de[_0x170dfb(-0x155,-0x169,-0xd1,-0x131)]),_0x486766=_0x4d4c10(_0x45adfd),_0x36d70b=_0x1def09[_0x4aa0de['kwXvN']];for(let _0x171531=0xbc2+-0x613*0x1+-0x5ae;_0x171531<=-0x128e+-0x2395+-0x3*-0x120d;_0x171531++){_0x4953e5[_0x170dfb(-0x1f8,-0x1ee,-0x1f4,-0x26c)+_0x171531+_0x170dfb(-0x8c,-0x22,-0x9a,-0x4a)]&&(_0x4914a7=_0x4aa0de[_0x24d6c5(0x425,0x52a,0x4e4,0x4e3)](_0x5c59be,',\x20')+_0x24ca8c[_0x24d6c5(0x426,0x3e9,0x41f,0x494)+_0x171531+'\x20Prompt']);}}else{const _0x100a46=await _0x3b654e['text']();throw new Error('API\x20reques'+_0x170dfb(-0xe3,-0x145,-0x150,-0x17e)+_0x170dfb(-0x158,-0x135,-0xcb,-0xaa)+'\x20'+_0x3b654e[_0x24d6c5(0x549,0x52e,0x537,0x4bf)]+':\x20'+_0x100a46);}}const _0x23a5a0=await _0x3b654e[_0x24d6c5(0x623,0x5a2,0x69a,0x603)]();let _0x4894aa='';const _0x35428f=_0x23a5a0[_0x24d6c5(0x5d9,0x55e,0x665,0x5b9)];if(_0x35428f&&_0x35428f['length']>-0x842*0x3+-0x163*0x8+0x23de){const _0x233676=_0x35428f[0x125+0x1ec6+0x1*-0x1feb][_0x170dfb(-0x12e,-0x16a,-0x1af,-0x11a)]?.[_0x170dfb(-0x91,-0x56,-0x114,-0x1b6)];if(Array[_0x170dfb(-0x149,-0x1e7,-0x1b5,-0x197)](_0x233676))for(const _0x21512e of _0x233676){if(_0x4aa0de[_0x170dfb(-0x116,-0xe5,-0x14c,-0xeb)]===_0x4aa0de[_0x170dfb(-0x5c,-0x5f,-0xbc,-0x186)]){let _0x393399=_0x2be0af;!_0x393399[_0x24d6c5(0x59d,0x580,0x500,0x5af)](_0x4aa0de[_0x24d6c5(0x521,0x520,0x50b,0x4b1)])&&!_0x393399[_0x170dfb(-0xd9,-0xdb,-0x192,-0x178)](_0x4aa0de[_0x24d6c5(0x4f9,0x4aa,0x423,0x49b)])&&(_0x393399=_0x4aa0de[_0x170dfb(-0x19f,-0x1cd,-0x1a1,-0xda)](_0x393399,_0x4aa0de[_0x24d6c5(0x4cb,0x481,0x445,0x4b1)]));_0x393399=_0x393399[_0x24d6c5(0x460,0x4e3,0x494,0x4c3)](/\/v1\/$/,_0x4aa0de[_0x170dfb(-0x117,-0x255,-0x1d7,-0x1b4)]),_0x473179=_0x4aa0de[_0x24d6c5(0x559,0x658,0x5df,0x5fe)],_0xe72233=_0x4aa0de[_0x24d6c5(0x48b,0x3bb,0x3bc,0x487)](_0x434983,_0x41ee22['token']);const _0x45155f={};_0x45155f[_0x170dfb(-0x166,-0x16b,-0x162,-0x1d3)+_0x24d6c5(0x5fb,0x66f,0x516,0x5bc)+'ce']=_0x4aa0de[_0x24d6c5(0x546,0x525,0x5c0,0x51e)],_0x45155f[_0x170dfb(-0x18d,-0x185,-0x104,-0x7e)]=_0x393399,_0x45155f[_0x170dfb(-0xde,-0xaf,-0xc6,-0xf1)+_0x170dfb(-0x1da,-0x184,-0x1b2,-0x269)+'rs']='Authorizat'+_0x24d6c5(0x52a,0x54e,0x51e,0x5df)+_0x170dfb(-0x63,-0x5b,-0xaf,-0xe3)+_0x1b902e+'\x22',_0x45155f[_0x24d6c5(0x64d,0x532,0x65e,0x5a6)]=_0x47634b,_0x45155f[_0x24d6c5(0x5c5,0x557,0x4c3,0x549)]=_0x235b11[_0x24d6c5(0x4cb,0x565,0x4c4,0x549)],_0x45155f['stream']=![],_0x36fc85=_0x45155f;if(_0x1453b4[_0x170dfb(-0x234,-0x18d,-0x1f7,-0x2aa)](_0x4aa0de[_0x24d6c5(0x61c,0x62a,0x58b,0x600)])){_0x4aa0de[_0x170dfb(-0x100,-0x134,-0x1be,-0x222)](_0x9a7427,_0x24d6c5(0x4ca,0x534,0x5bf,0x571)+_0x170dfb(-0x2a0,-0x24f,-0x20c,-0x27a)+_0x24d6c5(0x4ef,0x4b1,0x42b,0x4cf)+_0x24d6c5(0x635,0x50b,0x515,0x5be)),_0x4fc138=_0x197583;const _0x4b3621={};_0x4b3621[_0x170dfb(-0x195,-0x15a,-0x125,-0x123)+'pe']=_0x4aa0de['MGXMf'],_0x4b3621[_0x24d6c5(0x583,0x663,0x64a,0x5ef)+_0x170dfb(-0xc0,-0x1c0,-0x15a,-0x222)]=_0x24d6c5(0x5a3,0x4b7,0x587,0x543)+_0x282432,_0x135c76=_0x4b3621,_0x110ab3=_0x51aeaa;}_0x4aa0de['UCSbH'](_0x2ce974,'[Banana]\x20使'+_0x24d6c5(0x4cc,0x5cd,0x585,0x555));}else{if(_0x4aa0de[_0x24d6c5(0x531,0x5e4,0x632,0x5f8)](_0x21512e[_0x170dfb(-0x102,-0x189,-0x159,-0xe1)],_0x4aa0de['SmopY'])&&_0x21512e['image_url']?.[_0x24d6c5(0x502,0x3e5,0x4e1,0x47d)]){_0x4894aa=_0x21512e[_0x24d6c5(0x42c,0x4a8,0x3fc,0x4b8)][_0x170dfb(-0x1cc,-0x158,-0x20b,-0x24e)];break;}}}else{if(_0x4aa0de[_0x170dfb(-0x203,-0x1c3,-0x15d,-0xbe)](typeof _0x233676,_0x4aa0de[_0x24d6c5(0x586,0x615,0x5a9,0x5ac)])){const _0x239d95=/!\[.*?\]\((https?:\/\/[^\s\)]+)\)/,_0x2c467a=_0x233676['match'](_0x239d95);if(_0x2c467a&&_0x2c467a[0x77a+-0x1*-0x47+-0x7c0]){_0x4aa0de[_0x24d6c5(0x5c5,0x521,0x4dc,0x4fe)](addLog,_0x4aa0de[_0x24d6c5(0x5c5,0x5a6,0x518,0x541)]);const _0x43f67c=_0x2c467a[-0x220b+0x10+0x21fc];_0x4aa0de[_0x24d6c5(0x3c6,0x4db,0x545,0x486)](addLog,_0x24d6c5(0x5de,0x630,0x541,0x570)+_0x170dfb(-0xcd,-0x187,-0x123,-0x112)+_0x24d6c5(0x59d,0x66d,0x6a3,0x5f3)+_0x43f67c);try{const _0x30f076=await _0x4aa0de['Bcyow'](fetch,_0x43f67c);if(!_0x30f076['ok'])throw new Error(_0x24d6c5(0x4c3,0x3d2,0x4d8,0x490)+_0x24d6c5(0x618,0x645,0x50a,0x5a7)+_0x24d6c5(0x4fc,0x4c7,0x4d5,0x4ba)+_0x30f076[_0x24d6c5(0x40c,0x4b9,0x51f,0x4bf)]);const _0x8d8d65=await _0x30f076[_0x170dfb(-0xd5,-0x83,-0x134,-0xd0)](),_0xd100f9=await new Promise((_0x367acb,_0x361485)=>{function _0x587593(_0x34d47c,_0x3f792c,_0x152241,_0x44932e){return _0x24d6c5(_0x34d47c-0x103,_0x3f792c-0xd2,_0x44932e,_0x34d47c- -0x219);}function _0x5a8e83(_0x42c9a7,_0x206b97,_0xbab59b,_0x2ae5e2){return _0x170dfb(_0x42c9a7-0x36,_0xbab59b,_0x42c9a7-0x6f6,_0x2ae5e2-0x4b);}if(_0x4aa0de[_0x5a8e83(0x65a,0x5e7,0x59f,0x644)](_0x4aa0de['NmNHJ'],_0x4aa0de[_0x5a8e83(0x617,0x66c,0x5af,0x623)])){const _0xe6690e={};_0xe6690e[_0x5a8e83(0x4eb,0x434,0x5ab,0x4e7)]=_0x56d17f;const _0x30d780={};_0x30d780[_0x5a8e83(0x59d,0x4fd,0x63d,0x52d)]=_0x4aa0de['SmopY'],_0x30d780[_0x587593(0x29f,0x34e,0x219,0x315)]=_0xe6690e,_0x15afb7[_0x587593(0x335,0x32e,0x391,0x30c)](_0x30d780),_0x3a9386(_0x5a8e83(0x5ea,0x631,0x663,0x559)+_0x587593(0x2ae,0x212,0x2a3,0x28b)+_0x587593(0x340,0x3e1,0x38d,0x391));}else{const _0x48a2c5=new FileReader();_0x48a2c5[_0x5a8e83(0x63e,0x612,0x6ac,0x6c3)]=()=>_0x367acb(_0x48a2c5[_0x587593(0x374,0x3fc,0x2fa,0x438)]),_0x48a2c5[_0x5a8e83(0x676,0x657,0x5f6,0x6cf)]=_0x361485,_0x48a2c5[_0x587593(0x310,0x388,0x331,0x252)+_0x587593(0x320,0x2cd,0x3b3,0x2ae)](_0x8d8d65);}});_0x4894aa=_0xd100f9,_0x4aa0de[_0x170dfb(-0x1fa,-0x1fd,-0x1f5,-0x2a5)](addLog,_0x24d6c5(0x4f2,0x4f3,0x5d4,0x515)+_0x24d6c5(0x639,0x5a6,0x5b1,0x5fa)+_0x24d6c5(0x544,0x576,0x56c,0x4b5)+_0x24d6c5(0x62d,0x558,0x6c3,0x607)+_0x170dfb(-0xa4,-0x9e,-0x7d,-0x51)+_0x170dfb(-0x174,-0x1b4,-0x141,-0x7c));}catch(_0x312fbb){_0x4aa0de['IVrDr'](addLog,_0x24d6c5(0x4a1,0x50e,0x4c3,0x507)+_0x24d6c5(0x4dd,0x559,0x52f,0x4a7)+_0x170dfb(-0x120,-0x142,-0x18e,-0x1c3)+_0x170dfb(-0x121,-0xa,-0xad,0x2)+'\x20'+_0x312fbb[_0x170dfb(-0x1c8,-0xf4,-0x1af,-0x177)]),_0x4894aa=_0x43f67c,addLog(_0x4aa0de[_0x170dfb(-0xf2,-0x1fe,-0x191,-0xc8)]);}}else _0x4aa0de['xNmGn'](addLog,_0x4aa0de[_0x170dfb(-0xbe,-0x90,-0xeb,-0x14c)]);}}}if(!_0x4894aa){if(_0x4aa0de[_0x24d6c5(0x628,0x5b4,0x628,0x5c6)](_0x4aa0de['jAeSq'],_0x170dfb(0x0,-0x1e,-0xae,-0x79)))throw new Error(_0x4aa0de[_0x24d6c5(0x596,0x453,0x503,0x508)]);else{if(_0x38783a[_0x24d6c5(0x538,0x674,0x677,0x5b8)+_0x170dfb(-0x1d,-0xef,-0x83,-0x26)+_0x24d6c5(0x641,0x517,0x5d3,0x5ca)]){const _0x19866f=_0x170dfb(-0x136,-0x169,-0xb0,-0xfe)[_0x170dfb(-0x248,-0x2b9,-0x207,-0x1b0)]('|');let _0x5df401=0xd21*-0x2+0xd0e+0xd34;while(!![]){switch(_0x19866f[_0x5df401++]){case'0':_0x2e2ad2['forEach'](_0x14240c=>{function _0x563174(_0x4ed3d8,_0x2374a2,_0x2fa29c,_0x4664fb){return _0x24d6c5(_0x4ed3d8-0xb0,_0x2374a2-0x1ce,_0x4ed3d8,_0x4664fb- -0x122);}function _0xb13fc6(_0x3c7737,_0xddfb66,_0x5eae8d,_0xfd9673){return _0x24d6c5(_0x3c7737-0x1b4,_0xddfb66-0xa8,_0x5eae8d,_0xfd9673- -0x3cb);}_0x55f5f5[_0xb13fc6(0x18c,0x13b,0x14e,0xf7)+_0xb13fc6(0x151,0x23c,0x13a,0x1ff)](_0x14240c,_0x204208);});continue;case'1':_0x9c9e03[_0x24d6c5(0x4b2,0x4e9,0x44f,0x4c2)+_0x170dfb(-0xd1,-0x62,-0xbe,-0x136)](_0xdcb3a9[_0x24d6c5(0x421,0x4f8,0x571,0x4b2)+_0x24d6c5(0x670,0x673,0x5ff,0x5cd)+'ST'],_0x21b827);continue;case'2':_0x4aa0de['UCSbH'](_0x59466e,_0x4aa0de[_0x170dfb(-0x2b4,-0x2ba,-0x206,-0x1a4)]);continue;case'3':_0x36f50d[_0x170dfb(-0x23b,-0x1b2,-0x1c6,-0x1a5)+_0x24d6c5(0x5c8,0x638,0x574,0x5ca)](_0x4aa0de['vFZqe'],_0x244d37);continue;case'4':_0x2aecdf[_0x170dfb(-0x79,-0x115,-0xd0,-0xd5)+_0x24d6c5(0x68a,0x5c4,0x65f,0x605)+_0x170dfb(-0x6c,-0x15f,-0xbe,-0x13e)]=![];continue;}break;}}}}return _0x4aa0de['elaSa'](addLog,_0x4aa0de[_0x24d6c5(0x5da,0x4c5,0x4ea,0x575)]),taskQueue[_0x170dfb(-0x121,-0xb1,-0x143,-0x185)+'sk'](_0x2866b3,!![]),currentTaskId=null,{'image':_0x4894aa,'change':_0x4aa0de[_0x24d6c5(0x54d,0x5bd,0x4ce,0x580)](_0x4346d,'')};}}catch(_0x198b67){const _0x723701=_0x4aa0de[_0x24d6c5(0x411,0x4d6,0x4c6,0x4d2)][_0x170dfb(-0x2bb,-0x1c7,-0x207,-0x175)]('|');let _0x27dba2=-0x4*0x12+-0x5*0x3b5+0x12d1*0x1;while(!![]){switch(_0x723701[_0x27dba2++]){case'0':_0x4aa0de[_0x24d6c5(0x51d,0x535,0x4aa,0x4ec)](addLog,_0x24d6c5(0x4b3,0x576,0x4ab,0x507)+_0x24d6c5(0x4c8,0x55e,0x61c,0x572)+':\x20'+_0x198b67['message']);continue;case'1':throw _0x198b67;continue;case'2':currentTaskId=null;continue;case'3':if(_0x4aa0de['hoYfy'](_0x198b67[_0x24d6c5(0x464,0x53d,0x411,0x4d9)],_0x24d6c5(0x5b0,0x4eb,0x4e4,0x503))){}else taskQueue[_0x24d6c5(0x5cf,0x5de,0x609,0x545)+'sk'](_0x2866b3,![]);continue;case'4':console[_0x170dfb(-0xeb,0x10,-0xb2,-0x14b)](_0x4aa0de[_0x24d6c5(0x63d,0x4de,0x5ac,0x58e)],_0x198b67);continue;}break;}}}export async function bananaGenerate(_0x2ce74c){const _0x3aac65={'mPohb':function(_0x2bb530){return _0x2bb530();},'FpqrS':function(_0x21366a,_0x108f73){return _0x21366a(_0x108f73);},'mjamC':_0x2bdf88(0x579,0x5c7,0x60d,0x553)+_0x2bdf88(0x5fe,0x727,0x678,0x62a)+':','pWooL':function(_0x550dee,_0x2dff15){return _0x550dee===_0x2dff15;},'SmpkH':'任务已取消','glcIW':'AdYrq','GVzCB':_0x8040bc(0x240,0x192,0x101,0x15c),'yJejy':'{修图}','HIdKQ':function(_0x5fcfba,_0x35fe53){return _0x5fcfba(_0x35fe53);},'gVFah':function(_0x34e093,_0x14b43a){return _0x34e093!==_0x14b43a;},'ytlXb':_0x2bdf88(0x65d,0x704,0x6ba,0x669),'mYrSB':function(_0x5ad8e8,_0xf63511){return _0x5ad8e8!=_0xf63511;},'PVjBz':_0x2bdf88(0x637,0x5fe,0x591,0x572),'VYndJ':_0x8040bc(0x157,0x104,0x12f,0xaa),'MXUEr':function(_0xf0e9a5,_0x490f0d,_0x1a923e,_0x1094a6){return _0xf0e9a5(_0x490f0d,_0x1a923e,_0x1094a6);},'DcNIa':_0x2bdf88(0x5fe,0x5e3,0x663,0x5a8),'CLqon':function(_0x2537d7,_0x36a0f5){return _0x2537d7(_0x36a0f5);},'uyhLr':function(_0x51d54d,_0xeb49ca){return _0x51d54d(_0xeb49ca);},'xuGTQ':function(_0x51fe5a,_0x3de6e9){return _0x51fe5a(_0x3de6e9);}};_0x3aac65[_0x8040bc(0x19c,0x17b,0x126,0xb6)](clearLog);let {id:_0x4594fb,prompt:_0x18fb21,width:_0x2797fe,height:_0x1eee94,change:_0x2c7d0f,retouchPrompt:_0x10a8e9,retouchImage:_0x422fab}=_0x2ce74c;currentRequestId=_0x4594fb,currentPrompt=_0x18fb21,_0x3aac65[_0x8040bc(0x1b4,0x173,0xd8,0x159)](addLog,_0x8040bc(0x11d,0xc0,0xdc,0x129)+'eceived\x20im'+_0x2bdf88(0x67c,0x65d,0x5de,0x56e)+_0x8040bc(0x11a,0xf9,0xae,0x10b)+_0x2bdf88(0x682,0x680,0x6ff,0x765)+_0x4594fb+')');let _0x4f2197='';_0x2c7d0f?_0x3aac65[_0x2bdf88(0x60c,0x59d,0x5e5,0x64b)]===_0x3aac65[_0x8040bc(0xb0,0xf2,0x4a,0x153)]?(!_0x5b65fe[_0x8040bc(0x22c,0x194,0x248,0x1be)+_0x8040bc(0x1bb,0x1e1,0x28c,0x205)+_0x8040bc(0x198,0x1a6,0x265,0xed)]&&(_0x56681a[_0x8040bc(0x130,0x194,0x101,0x146)+'BananaList'+_0x2bdf88(0x6f6,0x661,0x6d0,0x75f)]=!![],_0x3aac65[_0x8040bc(0x16d,0x17b,0x1c9,0x185)](_0x2cf8b3)),_0x3aac65[_0x2bdf88(0x6e6,0x6b4,0x6a5,0x6a7)](_0x1ff33b)):_0x4f2197=_0x2c7d0f[_0x8040bc(0x16c,0x184,0xee,0x153)](_0x3aac65[_0x8040bc(0x230,0x1de,0x1c6,0x191)],''):_0x4f2197=_0x18fb21;function _0x2bdf88(_0x49baff,_0x65e00a,_0x2f7efc,_0x533d54){return _0x5553(_0x2f7efc-0x3da,_0x533d54);}if(_0x2c7d0f&&_0x2c7d0f[_0x8040bc(0x199,0xd2,0x13,0xc)](_0x3aac65['yJejy'])){_0x3aac65['HIdKQ'](addLog,_0x2bdf88(0x59e,0x537,0x5e4,0x52e)+'启动');if(_0x10a8e9)addLog(_0x2bdf88(0x575,0x57e,0x5bc,0x54e)+_0x10a8e9);if(_0x422fab)_0x3aac65['FpqrS'](addLog,'修图图片:\x20[已提供'+']');}function _0x8040bc(_0x2ff36f,_0x5890cb,_0x4091ba,_0x960bfb){return _0x5553(_0x5890cb- -0x150,_0x2ff36f);}try{if(_0x3aac65[_0x2bdf88(0x5bf,0x60e,0x5c4,0x52d)](_0x3aac65['ytlXb'],_0x2bdf88(0x602,0x5c6,0x5ca,0x5bb))){const {image:_0x334142,change:_0x1e9923}=await _0x3aac65[_0x2bdf88(0x644,0x5b3,0x5ec,0x5fc)](generateBananaImage,{'prompt':_0x18fb21,'width':_0x2797fe,'height':_0x1eee94,'change':_0x2c7d0f,'retouchPrompt':_0x10a8e9,'retouchImage':_0x422fab});if(_0x3aac65[_0x2bdf88(0x5a6,0x5ed,0x5b3,0x586)](extension_settings[extensionName]['cache'],'0')){if(_0x3aac65[_0x2bdf88(0x756,0x6c8,0x6b3,0x638)](_0x3aac65[_0x2bdf88(0x6c9,0x767,0x707,0x69f)],_0x3aac65[_0x2bdf88(0x70a,0x6ff,0x668,0x634)]))return _0x861dd3[_0x8040bc(0x117,0x1ab,0xee,0x1d5)];else{const _0xe8b026={};_0xe8b026[_0x2bdf88(0x6da,0x59a,0x625,0x56c)]=_0x4f2197,await _0x3aac65[_0x2bdf88(0x737,0x646,0x6f0,0x662)](setItemImg,_0x18fb21,_0x334142,_0xe8b026),addLog('图像已存入数据库\x20f'+_0x2bdf88(0x577,0x662,0x5c6,0x5b0)+'\x20'+_0x18fb21);if(extension_settings[extensionName][_0x8040bc(0x226,0x19b,0x14d,0x113)][_0x2bdf88(0x62a,0x577,0x5a6,0x550)])extension_settings[extensionName][_0x8040bc(0x178,0x19b,0x16e,0x167)][_0x2bdf88(0x63e,0x5f5,0x5a6,0x561)]=extension_settings[extensionName][_0x8040bc(0x11b,0x19b,0x1d1,0x1be)][_0x2bdf88(0x532,0x5f8,0x5a6,0x575)]+(-0xdb9*0x2+0x11*0x16d+0x336),_0x3aac65[_0x8040bc(0x172,0xc2,0x123,0x156)](addLog,_0x2bdf88(0x65a,0x6b7,0x5f1,0x605)+'r\x20prompt:\x20'+extension_settings[extensionName][_0x8040bc(0xf7,0x19b,0x1c7,0x131)]['cishu']);else{if(_0x3aac65[_0x8040bc(0x22,0x9a,-0x1c,0x7b)](_0x3aac65[_0x8040bc(0x20e,0x1ce,0x153,0x1a6)],_0x8040bc(0x203,0x181,0x229,0x1a9)))extension_settings[extensionName][_0x8040bc(0x25b,0x19b,0x1a0,0x15e)]['cishu']=-0x23*-0x7e+-0x827*-0x1+0x196*-0x10,_0x3aac65[_0x2bdf88(0x6fa,0x6c8,0x66c,0x5a8)](addLog,_0x2bdf88(0x66c,0x58f,0x5f1,0x5c6)+_0x2bdf88(0x645,0x552,0x5d4,0x691)+extension_settings[extensionName][_0x8040bc(0x1fe,0x19b,0x1ef,0x10d)][_0x8040bc(0xe,0x7c,-0x15,-0x4)]);else{_0x3aac65['FpqrS'](_0x305ea8,'[Banana]\x20F'+'etch\x20error'+':\x20'+_0x1439d2['message']),_0x2f40d5[_0x2bdf88(0x6ff,0x663,0x6dc,0x63b)](_0x3aac65['mjamC'],_0x2e25fa);if(_0x3aac65['pWooL'](_0x38a807['message'],_0x3aac65['SmpkH'])){}else _0x5380f6[_0x8040bc(0x6f,0x121,0x1db,0x166)+'sk'](_0x47a6ce,![]);_0x21288f=null;throw _0x2822dc;}}}}else _0x3aac65['uyhLr'](addLog,_0x8040bc(0x16a,0xbc,0x165,0xbb)+'库');const _0x304530={};_0x304530['id']=_0x4594fb,_0x304530[_0x2bdf88(0x690,0x5fd,0x62d,0x6b2)]=!![],_0x304530[_0x8040bc(0x99,0xad,-0x8,0x4e)]=_0x334142,_0x304530[_0x8040bc(0x11f,0x11e,0x135,0x98)]=_0x18fb21,_0x304530[_0x2bdf88(0x5a0,0x5dd,0x625,0x692)]=_0x4f2197,eventSource[_0x2bdf88(0x74f,0x780,0x6e4,0x775)](EventType[_0x8040bc(0xe,0x8e,0xfe,-0x37)+_0x8040bc(0x1ad,0x14f,0x135,0x201)+_0x8040bc(0xbf,0x11b,0x1c9,0xfb)],_0x304530),_0x3aac65['xuGTQ'](addLog,_0x8040bc(0x231,0x166,0xfe,0x198)+'mitted\x20suc'+_0x2bdf88(0x593,0x69c,0x626,0x5b9)+_0x8040bc(0xd1,0x133,0x1f1,0x1ac)+':\x20'+_0x4594fb);}else _0x51227d[_0x2bdf88(0x606,0x779,0x6be,0x5f6)+_0x8040bc(0x19d,0x1e1,0x278,0x1a4)+_0x2bdf88(0x799,0x628,0x6d0,0x61e)]=!![],_0x3aac65[_0x2bdf88(0x628,0x759,0x6a5,0x684)](_0x48049f);}catch(_0x388efa){const _0x36fc84='[Banana]\x20G'+'eneration\x20'+_0x2bdf88(0x5d1,0x74d,0x68c,0x6db)+_0x8040bc(0xbf,0xe9,0xa5,0x61)+_0x4594fb+':\x20'+_0x388efa[_0x2bdf88(0x561,0x55a,0x5df,0x6a5)];addLog(_0x36fc84),console[_0x8040bc(0xe8,0x1b2,0x126,0x1e5)](_0x36fc84);const _0x3fa989={};_0x3fa989['id']=_0x4594fb,_0x3fa989[_0x8040bc(0xc0,0x103,0x125,0x1a7)]=![],_0x3fa989['error']=_0x388efa[_0x8040bc(0x72,0xb5,0x33,0x71)],_0x3fa989[_0x8040bc(0x108,0x11e,0x142,0x90)]=_0x18fb21,eventSource[_0x2bdf88(0x70a,0x62c,0x6e4,0x705)](EventType[_0x2bdf88(0x55e,0x684,0x5b8,0x4fa)+'MAGE_RESPO'+_0x2bdf88(0x591,0x61a,0x645,0x625)],_0x3fa989),addLog(_0x2bdf88(0x6c0,0x6ec,0x690,0x63e)+_0x8040bc(0x3c,0xa7,0x141,-0x5)+'lure\x20respo'+_0x8040bc(0xa9,0x133,0x95,0xd8)+':\x20'+_0x4594fb);}}function handleCancelBananaTask(_0x4656ea){function _0x7194ad(_0x2e1424,_0x2cd22c,_0x4ce903,_0xd4973){return _0x5553(_0xd4973-0xf9,_0x2cd22c);}const _0x149259={'oXNWQ':function(_0x3dbe24,_0x388397){return _0x3dbe24(_0x388397);},'Iggvo':function(_0x4e8cd7,_0x12c69a){return _0x4e8cd7||_0x12c69a;}},{taskId:_0x4ca60f}=_0x4656ea;_0x149259[_0x23442e(0x581,0x44d,0x4ec,0x535)](addLog,'[Banana]\x20收'+_0x7194ad(0x2fe,0x37a,0x35d,0x341)+_0x7194ad(0x31a,0x233,0x1f9,0x2ad)+_0x4ca60f+')');function _0x23442e(_0x412a74,_0x4663b2,_0xb9f71b,_0x223588){return _0x5553(_0xb9f71b-0x296,_0x4663b2);}if(currentTaskId===_0x4ca60f&&currentRequestId){const _0x824e67=_0x7194ad(0x3fb,0x308,0x3bb,0x349)['split']('|');let _0x211df6=-0x1442+-0x1fb7+-0x5*-0xa65;while(!![]){switch(_0x824e67[_0x211df6++]){case'0':currentPrompt=null;continue;case'1':_0x149259[_0x7194ad(0x2dc,0x361,0x39f,0x34f)](addLog,_0x7194ad(0x2b1,0x34f,0x350,0x35c)+_0x23442e(0x576,0x4f6,0x52f,0x4a8)+'响应\x20(ID:\x20'+currentRequestId+')');continue;case'2':currentTaskId=null;continue;case'3':currentRequestId=null;continue;case'4':eventSource[_0x7194ad(0x410,0x3ed,0x4c3,0x403)](EventType[_0x23442e(0x4b8,0x3ab,0x474,0x47c)+_0x23442e(0x5b5,0x53f,0x535,0x47f)+'NSE'],{'id':currentRequestId,'success':![],'error':_0x23442e(0x47d,0x457,0x4c5,0x4a0),'prompt':_0x149259[_0x7194ad(0x3d5,0x286,0x31d,0x351)](currentPrompt,'')});continue;}break;}}}function _0x5553(_0x4c1160,_0x1968e4){_0x4c1160=_0x4c1160-(0x1*0x1532+-0x2034+0xcaa);const _0x5c6f30=_0x15ac();let _0x409682=_0x5c6f30[_0x4c1160];if(_0x5553['WThbrf']===undefined){var _0x3649f1=function(_0x4e44a3){const _0xcf5b3d='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x5785af='',_0x339de9='',_0x750848=_0x5785af+_0x3649f1;for(let _0x37daef=0x1ed7+-0x1001+-0x1a6*0x9,_0x410c00,_0x2c055f,_0x53dc28=0x3*0xc49+-0x13c*0x11+0x1*-0xfdf;_0x2c055f=_0x4e44a3['charAt'](_0x53dc28++);~_0x2c055f&&(_0x410c00=_0x37daef%(0xaff+-0x7*-0x577+-0x112*0x2e)?_0x410c00*(0x147*-0xd+-0x10ac+0x2187)+_0x2c055f:_0x2c055f,_0x37daef++%(-0x51*0x25+0x7af*0x4+-0x1303))?_0x5785af+=_0x750848['charCodeAt'](_0x53dc28+(0x1021+-0x2272+-0x1*-0x125b))-(-0x37f*-0x5+-0x14fe+0x38d)!==0x2c*-0x1+0xa41+-0xa15*0x1?String['fromCharCode'](0x25*-0x10b+0x1bea+-0xa6*-0x12&_0x410c00>>(-(0x12b*-0x15+0x120f+0x67a)*_0x37daef&0x8*0x288+0x1842+-0x2c7c)):_0x37daef:0x2548+-0x22c+-0x118e*0x2){_0x2c055f=_0xcf5b3d['indexOf'](_0x2c055f);}for(let _0x487709=-0x58a*0x1+0xa81*0x2+-0xc*0x14a,_0x436915=_0x5785af['length'];_0x487709<_0x436915;_0x487709++){_0x339de9+='%'+('00'+_0x5785af['charCodeAt'](_0x487709)['toString'](-0x1380+0x1*0x1981+0x9*-0xa9))['slice'](-(0x1ebb*-0x1+-0x251a+0x43d7));}return decodeURIComponent(_0x339de9);};_0x5553['bWCuMI']=_0x3649f1,_0x5553['KzYlII']={},_0x5553['WThbrf']=!![];}const _0x2da0e8=_0x5c6f30[0x1f*0x1+-0x542+-0x5*-0x107],_0x4cdedf=_0x4c1160+_0x2da0e8,_0xda3b8c=_0x5553['KzYlII'][_0x4cdedf];if(!_0xda3b8c){const _0x11761c=function(_0x2d52ff){this['vjAJdI']=_0x2d52ff,this['XjncsL']=[0xd82+0x1*0x217d+-0x2efe,-0x17b*-0x1+0x3*-0xb8e+0x212f,-0x1d2*0x2+-0x170c+0x70*0x3d],this['TthMRO']=function(){return'newState';},this['wETQNU']='\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*',this['Wznjel']='[\x27|\x22].+[\x27|\x22];?\x20*}';};_0x11761c['prototype']['ildZQV']=function(){const _0x49a3ce=new RegExp(this['wETQNU']+this['Wznjel']),_0x391245=_0x49a3ce['test'](this['TthMRO']['toString']())?--this['XjncsL'][0x170c+0x16*-0x14b+0x567]:--this['XjncsL'][0x232b+-0x2c*-0x2c+0x1*-0x2abb];return this['befLkL'](_0x391245);},_0x11761c['prototype']['befLkL']=function(_0x346103){if(!Boolean(~_0x346103))return _0x346103;return this['LlerrB'](this['vjAJdI']);},_0x11761c['prototype']['LlerrB']=function(_0x185790){for(let _0x218355=-0x5*0x1b7+-0x21bb+0x39*0xbe,_0x54f0f=this['XjncsL']['length'];_0x218355<_0x54f0f;_0x218355++){this['XjncsL']['push'](Math['round'](Math['random']())),_0x54f0f=this['XjncsL']['length'];}return _0x185790(this['XjncsL'][-0x1ef+0x1d5d+-0x1b6e]);},new _0x11761c(_0x5553)['ildZQV'](),_0x409682=_0x5553['bWCuMI'](_0x409682),_0x5553['KzYlII'][_0x4cdedf]=_0x409682;}else _0x409682=_0xda3b8c;return _0x409682;}function initializeBananaListener(){const _0x54532d={'VscBk':_0x2c0b16(0x309,0x42d,0x3af,0x475)+_0x3b0f8d(-0xd0,-0x5a,-0x3b,-0xdc)+_0x2c0b16(0x346,0x418,0x350,0x404),'hYpkZ':function(_0x19c310,_0x1b17a5){return _0x19c310(_0x1b17a5);}};eventSource['on'](EventType[_0x3b0f8d(-0xea,-0xa3,-0x1d,-0xd4)+_0x3b0f8d(0x116,0x78,0x45,0xe2)+'ST'],bananaGenerate);function _0x3b0f8d(_0x58359d,_0x348231,_0x5234c3,_0xbdeba1){return _0x5553(_0x348231- -0x281,_0x58359d);}function _0x2c0b16(_0x261964,_0x5d2bc6,_0x4c7aac,_0x5177b4){return _0x5553(_0x4c7aac-0x101,_0x5d2bc6);}eventSource['on'](_0x54532d[_0x2c0b16(0x2d3,0x28c,0x32a,0x2e9)],handleCancelBananaTask),_0x54532d[_0x3b0f8d(0xe0,0x23,0x29,0xd6)](addLog,_0x3b0f8d(-0x16b,-0xd1,-0x4c,-0x99)+_0x3b0f8d(0xae,-0xf,0x57,-0xda));}export async function replaceWithBanana(){function _0x9a9d3e(_0x49b479,_0x573074,_0x1a8624,_0x487e8c){return _0x5553(_0x49b479-0xb,_0x573074);}const _0x4f6dda={'ZnZCL':function(_0x175b4d,_0x187676){return _0x175b4d===_0x187676;},'oQNnF':_0x9a9d3e(0x26a,0x2b4,0x2b0,0x2c6),'Xwmte':function(_0x206722,_0x229506){return _0x206722+_0x229506;},'IKTHu':function(_0xee613c,_0x42280b){return _0xee613c==_0x42280b;},'HBnhY':function(_0x37d7f9,_0x1c2a38){return _0x37d7f9===_0x1c2a38;},'JrXUp':'kNhBO','oWLGX':_0x2a9551(0x17f,0x213,0x209,0x117),'bIRyw':function(_0x14c8c5){return _0x14c8c5();},'iXnEu':function(_0x16a9a5){return _0x16a9a5();},'Ugkzg':'ZCoQI','DrhZc':_0x9a9d3e(0x2b9,0x260,0x21f,0x271)+_0x2a9551(0x161,0x19f,0x1a5,0x122)+_0x9a9d3e(0x25a,0x24f,0x21e,0x1e8),'NhSOQ':function(_0x2e3f4a,_0xc13c42){return _0x2e3f4a(_0xc13c42);},'voDHO':_0x9a9d3e(0x2a1,0x234,0x308,0x1fc)+_0x2a9551(0x181,0x18e,0x134,0xbf)};function _0x2a9551(_0x436255,_0x307a72,_0x3c9abd,_0x5919b4){return _0x5553(_0x436255- -0xc6,_0x307a72);}_0x4f6dda[_0x9a9d3e(0x237,0x1fc,0x2b1,0x1c4)](extension_settings[extensionName][_0x9a9d3e(0x24f,0x2d1,0x260,0x23e)],_0x2a9551(0x225,0x213,0x2f1,0x212))?_0x4f6dda[_0x2a9551(0x1ed,0x22a,0x184,0x155)](_0x4f6dda[_0x9a9d3e(0x1cf,0x13e,0x11e,0x27c)],_0x4f6dda[_0x9a9d3e(0x32c,0x340,0x269,0x3df)])?_0x1cf30e=_0x2fb886:(!window['initialize'+_0x2a9551(0x26b,0x2de,0x2fd,0x26f)+_0x2a9551(0x230,0x2a1,0x24a,0x234)]&&(window[_0x9a9d3e(0x2ef,0x2a4,0x280,0x2c9)+_0x2a9551(0x26b,0x327,0x2fc,0x224)+_0x2a9551(0x230,0x1be,0x16a,0x1ae)]=!![],_0x4f6dda[_0x9a9d3e(0x334,0x3c2,0x292,0x38b)](initializeBananaListener)),_0x4f6dda[_0x9a9d3e(0x1e2,0x25b,0x272,0x11c)](initializeImageProcessing)):_0x4f6dda[_0x9a9d3e(0x282,0x1dc,0x2f7,0x230)]('ZCoQI',_0x4f6dda[_0x2a9551(0x1ae,0x107,0x166,0x192)])?window[_0x2a9551(0x21e,0x17e,0x15b,0x274)+'BananaList'+_0x2a9551(0x230,0x2fa,0x1c7,0x1aa)]&&(eventSource[_0x2a9551(0x128,0xe9,0x62,0xc3)+'ener'](EventType[_0x9a9d3e(0x1e9,0x1f3,0x176,0x28b)+_0x9a9d3e(0x304,0x366,0x39f,0x2ab)+'ST'],bananaGenerate),eventSource['removeList'+'ener'](_0x4f6dda[_0x2a9551(0x277,0x1eb,0x216,0x1c6)],handleCancelBananaTask),LEGACY_EVENT_NAMES[_0x2a9551(0xef,0x9e,0x150,0x140)](_0x2515f8=>{function _0x2947d9(_0x340083,_0x17f7c2,_0x3b1bb8,_0x8aeec3){return _0x2a9551(_0x17f7c2- -0x28d,_0x3b1bb8,_0x3b1bb8-0xff,_0x8aeec3-0x4f);}function _0x4fdb3e(_0x2994bf,_0x34b80e,_0x24f2cc,_0x345944){return _0x9a9d3e(_0x34b80e-0x2ad,_0x345944,_0x24f2cc-0x92,_0x345944-0x26);}if(_0x4f6dda['ZnZCL'](_0x4f6dda[_0x4fdb3e(0x5a0,0x5f0,0x6a5,0x661)],_0x4f6dda[_0x2947d9(-0x2a,-0x1b,0x39,0x27)]))eventSource[_0x2947d9(-0x177,-0x165,-0x21e,-0x20d)+_0x2947d9(-0x5a,-0x5d,-0x22,-0x78)](_0x2515f8,bananaGenerate);else throw new _0x4e276e(_0x2947d9(-0x218,-0x197,-0x18c,-0x221)+_0x4fdb3e(0x4ea,0x58b,0x52c,0x5ba)+_0x2947d9(-0xe9,-0x16d,-0xf6,-0x142)+_0x698698['status']);}),window[_0x2a9551(0x21e,0x158,0x1d2,0x2b1)+_0x2a9551(0x26b,0x28a,0x2e6,0x318)+'ener']=![],_0x4f6dda['NhSOQ'](addLog,_0x4f6dda[_0x2a9551(0x218,0x232,0x1ca,0x25f)])):_0x588fc8=_0x4f6dda[_0x2a9551(0x10e,0x10b,0x195,0xfa)](_0x1cb0fe,',\x20')+_0x55109c[_0x9a9d3e(0x1cb,0x13d,0x164,0x129)+_0x2ff794+'\x20Prompt'];}