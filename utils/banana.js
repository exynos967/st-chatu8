(function(_0x3b5d92,_0x225224){function _0x48bf3e(_0x5105b8,_0x2c1f5a,_0x579e69,_0x414011){return _0x1d39(_0x5105b8- -0x219,_0x414011);}function _0x33acc7(_0x28050b,_0x332845,_0x11ebc0,_0x2d4c8c){return _0x1d39(_0x28050b- -0x262,_0x332845);}const _0x3ea777=_0x3b5d92();while(!![]){try{const _0x4a784c=parseInt(_0x48bf3e(-0x87,-0x53,-0x69,-0x17))/(-0x47c+-0x995+0xe12)*(parseInt(_0x33acc7(-0x106,-0xd4,-0x8d,-0x161))/(0xa55+-0x5d1+-0x241*0x2))+-parseInt(_0x33acc7(-0x3e,-0x17,-0x25,-0x67))/(0xde3+-0x6*0x537+0x116a)+-parseInt(_0x48bf3e(0x19,0x2f,0x8c,-0x21))/(-0x22c3*-0x1+-0x1ba*0x13+-0x1f1)+-parseInt(_0x48bf3e(-0x34,-0x2b,-0x8a,-0x84))/(0x208*0xb+-0x87*-0xf+0x2b*-0xb4)+-parseInt(_0x48bf3e(-0xb4,-0x47,-0xb8,-0xe9))/(0x1b21+0x1675*0x1+-0x3190)+parseInt(_0x48bf3e(-0xc6,-0x9e,-0xc1,-0x61))/(0x21de+-0x11*0x14a+-0xbed)*(-parseInt(_0x48bf3e(0x1,0x43,0x6f,-0x87))/(0xc3*0x17+0xec7*-0x1+-0x2b6*0x1))+-parseInt(_0x48bf3e(-0x4,0x8a,-0x9,-0x68))/(-0x6cd*0x2+-0x2706+0x34a9)*(-parseInt(_0x48bf3e(-0x59,-0x12,-0x15,-0xdf))/(-0x7*-0x4db+0x1*-0x1a75+-0x7*0x112));if(_0x4a784c===_0x225224)break;else _0x3ea777['push'](_0x3ea777['shift']());}catch(_0x480a36){_0x3ea777['push'](_0x3ea777['shift']());}}}(_0x2e94,-0x8*0x1327a+-0xafed8+-0x2a7*-0xa3d));const _0x118617=(function(){function _0x543fd1(_0x15c186,_0x5935e3,_0x2e9db6,_0x247915){return _0x1d39(_0x15c186-0x1c3,_0x2e9db6);}const _0x3de991={'NUBuU':function(_0x1b55f0,_0x1f9108){return _0x1b55f0(_0x1f9108);},'WzOSt':_0x543fd1(0x3f3,0x406,0x3ac,0x365),'Wcrmz':_0x543fd1(0x36b,0x3e8,0x368,0x3f6)};function _0x29439d(_0x366975,_0x109818,_0x8b72e0,_0x456577){return _0x1d39(_0x8b72e0-0x164,_0x366975);}let _0x303629=!![];return function(_0x560320,_0x5cb9e9){const _0x3f80f1=_0x303629?function(){const _0x202852={'jLHib':function(_0x5ee8f9,_0x1b929b){function _0x4fd566(_0x2b7eba,_0x453687,_0x105e27,_0x2ea182){return _0x1d39(_0x453687-0x140,_0x105e27);}return _0x3de991[_0x4fd566(0x3c9,0x34b,0x37a,0x381)](_0x5ee8f9,_0x1b929b);}};function _0x50624e(_0xe90b9c,_0x54d4b0,_0x285cf4,_0x16531f){return _0x1d39(_0x54d4b0-0x353,_0xe90b9c);}function _0xefdbd3(_0x54f6aa,_0x1dadd6,_0x1e1504,_0x30bb17){return _0x1d39(_0x1e1504-0x194,_0x1dadd6);}if(_0x3de991[_0x50624e(0x5f7,0x5cf,0x5bb,0x587)]===_0x3de991[_0x50624e(0x5a5,0x593,0x52d,0x5fc)])_0x202852[_0x50624e(0x43d,0x4ca,0x4dc,0x4d6)](_0x5f538b,'[Banana]\x20R'+'esponse\x20co'+_0xefdbd3(0x37b,0x301,0x2f4,0x33b)+_0x50624e(0x575,0x5cd,0x63a,0x5bb)+'\x20image.');else{if(_0x5cb9e9){const _0x26acd7=_0x5cb9e9[_0xefdbd3(0x43f,0x38f,0x3ca,0x414)](_0x560320,arguments);return _0x5cb9e9=null,_0x26acd7;}}}:function(){};return _0x303629=![],_0x3f80f1;};}()),_0x17ee5d=_0x118617(this,function(){const _0x10c6bd={};_0x10c6bd[_0xd6cf6f(-0x197,-0x97,-0x111,-0xd5)]=_0xd6cf6f(-0x1b6,-0x150,-0x17c,-0xfa)+'+$';function _0x29e19f(_0x45ae9f,_0xfdebe5,_0x5a7a65,_0x68e91c){return _0x1d39(_0x68e91c- -0x164,_0x5a7a65);}function _0xd6cf6f(_0x56c723,_0x6fd71d,_0x365eb6,_0x10dfcb){return _0x1d39(_0x365eb6- -0x365,_0x10dfcb);}const _0x27eb93=_0x10c6bd;return _0x17ee5d[_0xd6cf6f(-0x19c,-0x14c,-0x147,-0x17c)]()['search'](_0x27eb93[_0x29e19f(0x110,0x69,0x9d,0xf0)])['toString']()[_0x29e19f(0xdd,0xcd,0x16c,0xeb)+'r'](_0x17ee5d)[_0x29e19f(0xd7,0x31,0x10f,0xac)](_0x29e19f(0x1,0x109,0x7e,0x85)+'+$');});_0x17ee5d();import{extension_settings}from'../../../../extensions.js';import{eventSource}from'../../../../../script.js';function _0x1d39(_0x4a15c4,_0x2f83c8){_0x4a15c4=_0x4a15c4-(-0x1*-0x11a7+0xd9a+-0x1df3);const _0x80d963=_0x2e94();let _0x2ed334=_0x80d963[_0x4a15c4];if(_0x1d39['LaOsSy']===undefined){var _0xeae175=function(_0x1b98ec){const _0x1b19dd='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x1eecdc='',_0x219299='',_0x2453c1=_0x1eecdc+_0xeae175;for(let _0x3de038=0x1*-0xf21+0x3*0xa63+-0x26*0x6c,_0xe15742,_0x18ffee,_0x48a85d=-0x9ef*0x3+-0x1c7+0x1f94;_0x18ffee=_0x1b98ec['charAt'](_0x48a85d++);~_0x18ffee&&(_0xe15742=_0x3de038%(-0x5ab*-0x2+-0x3ec+0x1*-0x766)?_0xe15742*(0x2152+-0x4*-0x8c7+-0x442e)+_0x18ffee:_0x18ffee,_0x3de038++%(0x35b*0x4+-0x1818+0xab0))?_0x1eecdc+=_0x2453c1['charCodeAt'](_0x48a85d+(0x22f4+0x17*0xdf+-0x36f3))-(-0x16*-0x90+0x3df*0x5+-0x487*0x7)!==0x2120+0x1801+-0x3921?String['fromCharCode'](0x1d09*-0x1+-0x2d6+-0x20de*-0x1&_0xe15742>>(-(-0xf6*-0x10+-0xcd1+-0x28d)*_0x3de038&-0x118d*0x1+-0x14e*0x1+0xb3*0x1b)):_0x3de038:0x17*0x12f+-0x1a90+-0xa9){_0x18ffee=_0x1b19dd['indexOf'](_0x18ffee);}for(let _0x3ebbb5=-0x1*-0x4ba+-0xb6*0x17+-0x18*-0x7c,_0x6e90f8=_0x1eecdc['length'];_0x3ebbb5<_0x6e90f8;_0x3ebbb5++){_0x219299+='%'+('00'+_0x1eecdc['charCodeAt'](_0x3ebbb5)['toString'](0x1*-0x151+-0xb6*0x2+0xef*0x3))['slice'](-(-0x17*-0xd3+-0x1*0xe1+-0x1212));}return decodeURIComponent(_0x219299);};_0x1d39['LGcUtE']=_0xeae175,_0x1d39['yyTDFN']={},_0x1d39['LaOsSy']=!![];}const _0x1155ae=_0x80d963[-0x3b*-0x95+-0x9ca*-0x1+-0x8f*0x4f],_0x56114a=_0x4a15c4+_0x1155ae,_0x469517=_0x1d39['yyTDFN'][_0x56114a];if(!_0x469517){const _0x495472=function(_0x364b14){this['ccIQSA']=_0x364b14,this['erZUJu']=[0x1*0x13fa+0x78+-0x1471,-0xda3+-0x6b*0x1+0xe0e,-0x23*-0x11+0x8bb+0x1*-0xb0e],this['RyvYnm']=function(){return'newState';},this['fJULiF']='\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*',this['wYhuUI']='[\x27|\x22].+[\x27|\x22];?\x20*}';};_0x495472['prototype']['tGShqV']=function(){const _0x1efe2d=new RegExp(this['fJULiF']+this['wYhuUI']),_0x5e3930=_0x1efe2d['test'](this['RyvYnm']['toString']())?--this['erZUJu'][0xcdf+-0x4f*0xb+-0x979]:--this['erZUJu'][-0x67*0x2f+0x633+-0x1*-0xcb6];return this['kyoZnT'](_0x5e3930);},_0x495472['prototype']['kyoZnT']=function(_0x4bc962){if(!Boolean(~_0x4bc962))return _0x4bc962;return this['HZJBYG'](this['ccIQSA']);},_0x495472['prototype']['HZJBYG']=function(_0x21cb7d){for(let _0x33c9ea=0x2423+-0x1d*0x111+-0x1d*0x2e,_0x3a95c0=this['erZUJu']['length'];_0x33c9ea<_0x3a95c0;_0x33c9ea++){this['erZUJu']['push'](Math['round'](Math['random']())),_0x3a95c0=this['erZUJu']['length'];}return _0x21cb7d(this['erZUJu'][-0xa3d+0x1*-0x1597+0x1fd4]);},new _0x495472(_0x1d39)['tGShqV'](),_0x2ed334=_0x1d39['LGcUtE'](_0x2ed334),_0x1d39['yyTDFN'][_0x56114a]=_0x2ed334;}else _0x2ed334=_0x469517;return _0x2ed334;}import{extensionName,EventType}from'./config.js';import{sleep,generateRandomSeed,zhengmian,fumian,getRequestHeaders,prompt_replace,addLog,clearLog,parsePromptStringWithCoordinates,prompt_replace_for_character,stripChineseAnnotations}from'./utils.js';import{initializeImageProcessing}from'./iframe.js';import{processCharacterPrompt}from'./characterprompt.js';import{setItemImg}from'./database.js';import{getConfigImage}from'./configDatabase.js';function _0x2e94(){const _0x111609=['q1jivfy','C3rHDhvZ','s3Peu3u','C3vJy2vZCW','l3yX','C2fTCgXLq291BG','zxrJAcbLCNjVCG','BgvZktOG','r2rys0O','l3yXlW','BwfNzv9Yzxf1zq','tKHrr3O','vNjpsuy','DhLWzq','y2fJAgu','B3zouvy','BNnLigzVCIbjra','zgf0ytPPBwfNzq','BwDqqMK','wxfSqxe','BwL0DgvKihn1yW','tvbcEuC','q2HHCMfJDgvYia','5lU255Ur5zcS5zMO5BEY5yID5AEl5yYw44cc','C2uGzgLKig5VDa','zvjMENO','sMP0D0y','B0TuELC','rMvlyxq','Cg9ZDgzPEfbYBW','DwvZDcb0BZOG','CIaI','tLvcDvu','BgnoENq','CIbWCM9TChq6ia','57Yt5A2y6k6+572U5lI65lIn5A2y5ywL5PwW5O2U','5yMn572U5yMn','C2vHCMnO','wxb1rg0','AfnYqNi','EhbhzKO','zw5KAw5NihjLCq','mZzsuNzRDha','5lIT55QeihbYB21WDooaGG','Ce1lEgu','sxPZExm','wwnxtMS','ntK4mdCYthrUCK9v','ChjVBxb0','D2L0AcbWCM9TCa','w0jHBMfUyv0GrW','Dg9tDhjPBMC','ieLeia','z2vUzxjHDgvFAq','A3vjq04','Aw1Hz2veyxrH','CNDjCg8','otq1mtqXveLvy21e','t25OEey','y2HVAwnLCW','BwHjwfO','uNnltMi','ywj1vxK','q3HNBLm','B3vUzcbTyxrJAa','zMXHDa','r0Xcyxm','w0jHBMfUyv0G5zcV','EwjvCKC','Ew1Ly3i','r0vorvjbvevFsq','otqZntu2EgP3t0nI','qvbjihjLCxvLCW','Aw5ZDgfUy2vZ','BLz3DuO','yxbWBhK','zw1PDa','CMvTB3zLtgLZDa','wuvzqvi','Bw9KzwW','ufLJzvu','zw5LCMf0Aw9Uia','w0jHBMfUyv0Gua','5Qch5yEg5QIH5BYpoIdKVB/NLkJOR7FMSyi','zxjYB3i','v2nYBxO','y1LSCNa','DhjPz2DLCNm','CvLMuxa','BLHhEwW','C3qGkeLeoIa','BgvUz3rO','Dxfgvui','zMfPBgvKigzVCG','y29UDMvYC2f0Aq','ExztDuW','DNb0s0y','y29UDgvUDa','AxrOihn0yxr1CW','C3rLswC','y29UC3rYDwn0BW','iIbMCM9TihbYzq','55sO5l+U5zU+6Ake6k6+oIaI','qMvHCMvYia','zgvSCY8','DKDRDve','DwLSDcbTDwX0Aq','rfbKBgm','qvbjihjLC3bVBG','BuTwv1i','lcdPQ5JLUQyGlsa','q0nYBKe','l3yXyMv0ys9TBW','y1j6sK0','ue9tva','y2XPzw50','B3nPDgLVBG','w0jHBMfUyv0Gsq','Aw5NihrYAwDNzq','q214r2W','y2zNAw1NxW','yLrgDLm','zwjqy0e','EfHHEwS','EvnfCgK','BwvZC2fNzq','BwfW','DhjPBq','B2fKihDPDgGG','BwL0DgvKigzHAq','DLrgqvC','w0jHBMfUyv0G5l2/','5l+U5zU+5zU+54MhoIbB5BEY5O+q5l6B','yxbWBgLJyxrPBW','v1joyMW','w0jHBMfUyv0GuW','Bw9Kzq','ifbYB21WDa','Dg9mB3DLCKnHCW','tKfVCei','qNznz2C','uejlDMm','w0jHBMfUyv0GqG','DcbVBMX5lcbUBW','EvbXBwK','v3Ppu3q','t0HPCge','CvriuuS','uwL5vKS','zw5bssbMB3jTyq','C3nMDwXSEs4','BwvZC2fNzxm','5zU+5QIH5BYp77YA5BEY5RE75yQG5B6f5l+U5Ps5','n2HlAejyqG','B0ruCfa','BwfNzs1YzxnWBW','C3rYAw5N','w0jHBMfUyv0G5l+U','r3jPzNa','ywn0zxjqCMvZzq','zML4zwrqCM9TCa','CuDtug8','mKHsCwLIrW','CLPQswO','yKrkBwu','y2HHBMDL','BNrHAw5ZihrLEa','zM9YrwfJAa','BwfNzsbPBIbpCa','DxHMzeq','txvZC0e','mJC1nJuYnNPjtK9Qra','Aw1Hz2vFDxjS','u1nWtxq','rNvtDwC','zxnWB25ZzsbJBW','ig1LC3nHz2vZlG','BwXvCeW','kerPDMLKzv9YBW','z2vUzxjHDguTAq','y2LZAhu','w0jHBMfUyv0GrG','BwfNzsbNzw5LCG','q2vJvhO','z2XbtKS','t0vyv3m','DxjS','yMfUyw5H','C3rYAw5NAwz5','AKXiAwi','ihWG','B3j1A2S','qMfUyw5HtgLZDa','uxbHA20','DgLVBIbYzxf1zq','DMXjAgy','vM9fBey','DgfYDgLUzYbPBq','5B2t5yMn55sF5zU+5QYH5PwW5lI6igzV','C3rHCNrZv2L0Aa','tgfAuM0','A3Dhrvy','w0jHBMfUyv0G55sF','yxnZAxn0yw50','yxrLzcbZDwnJzq','BNnL','qKvns1i','yMfUyw5Hq2HHCG','tufhrv9srvfvrq','Bu5Jww4','EefRweq','BxbbqKG','uMfzAMC','zMLSDgvY','BhvYzsbYzxnWBW','5Q2J6z2I5O+q56s66k+noIa','ndK2mZuXANHmAKH5','reTgqMu','C3bSAxq','Aw1Hz2vU','q3rmwNi','tLnf','AM9PBG','y2vZCYbYzxnWBW','Dur6EKC','t2ncsg0','DxnLCG','DgHxufq','z3vUz2G','rg13y3C','tKHsywu','BI9QC29U','igLTywDLlG','q3P4teC','Aw5PDgLHBgL6zq','DgLVBIb3AxrOia','5zU+5lQl5lU255Ur5zcS5zMO5BEY5ywZ6zET44cc','C2v0ici','Dw1swgO','t3fRAMW','vLPhuNi','tMjvshO','CMvWBgfJzq','5PIV5zcM5zcV55sO5yIg6kEs6iMY5QIH5BYpia','CfHjEhq','D0f2wNq','5zco572U5zco','ChvZAa','qMfUyw5H5l+U5zU+5QIH5BYp','w0jHBMfUyv0Grq','5yMn572U5zco','ufL3uvu','EKfxqKC','z0nuvhi','rfzdwge','ueLYz28','55sO5lQgihVKV67LM759ioAGH+IVHG','A1HctKO','tLzyD0u','D0rntei','5zU+5yop5BEY5A2y5ywL5PwW5O2U5BQtigy','CMvWBgfJzufSBa','mZu0mdC5mhzxrxbHyW','zw5LCG','E+s/RUwBVN0','wgv0uMq','Dgv4Da','thzNqxa','yNbeENG','B21WBgv0Aw9UCW','C0v3Bhe','Bw9KzwW6ia','DdOG','5yIg6kEs6iMY5QIH5BYpoIdOP6pMNPdLUky','5z2q5Qch55Qe5O+q56s66k+n5A2x56YM5lIY44cc','yMfUyw5HioEuN+wBVUs6IW','l3yXl2nOyxqVyW','tevUEeO','Dvnjv0e','sMLKqKW','z3bNseS','Cu5pzLm','Dfnnr0K','w0jHBMfUyv0GuG','Aw5JBhvKzxm','vg1dD3K','v2fLuMi','Aw1Hz2vjza','tufhrv9srvnqtW','DwLSDcbjBwfNzq','Bxb0','CwHYCLi','z2j6qNq','Aw1Hz2u','wwnstLi','5zU+5Rwb56Il44cc5A6I5OI356UV5lI6','ywDLigDLBMvYyq','v3nXr3G','CM9Szq','mtK4mdC4mgX1z0DNwG','ANnVBG','qK5qyM4','tePqCuW','kcGOlISPkYKRkq','Bw9KywWGCgf5Ba'];_0x2e94=function(){return _0x111609;};return _0x2e94();}function _0x18000b(_0x24e7d8,_0xdd3f2c,_0x27cb40,_0x392c10){return _0x1d39(_0x27cb40-0x335,_0xdd3f2c);}function _0x49b344(_0x195425,_0x4c749f,_0x8736b4,_0x59cea8){return _0x1d39(_0x59cea8- -0xb3,_0x4c749f);}async function getImageFromTurnData(_0x54c20b){function _0x5257d6(_0x471141,_0x1c8b2a,_0x1cca8a,_0x31df1a){return _0x1d39(_0x31df1a- -0x309,_0x1c8b2a);}const _0x252e5f={'CxgnS':_0x5d726a(0x2d7,0x366,0x3b7,0x346),'WsqGx':function(_0x50ab27,_0x548aad){return _0x50ab27(_0x548aad);},'YcWNk':function(_0x3e755e,_0x598ab2){return _0x3e755e||_0x598ab2;},'qNOfS':_0x5d726a(0x291,0x2ff,0x2ef,0x2df)};if(!_0x54c20b)return'';function _0x5d726a(_0x568d6a,_0x41ed5a,_0x79da1b,_0x675127){return _0x1d39(_0x675127-0xe3,_0x79da1b);}if(_0x54c20b['imageId']&&_0x54c20b[_0x5257d6(-0x102,-0x10e,-0x14f,-0x130)][_0x5257d6(-0x15a,-0x1eb,-0x118,-0x188)](_0x252e5f[_0x5257d6(-0x159,-0xff,-0x5a,-0xdf)])){const _0x21dced=await _0x252e5f[_0x5d726a(0x2e6,0x25a,0x326,0x2c6)](getConfigImage,_0x54c20b['imageId']);return _0x252e5f[_0x5257d6(-0x168,-0x12a,-0xd0,-0xf0)](_0x21dced,'');}if(_0x54c20b['image']&&_0x54c20b['image']['startsWith'](_0x252e5f[_0x5d726a(0x26a,0x284,0x237,0x2b6)]))return _0x54c20b['image'];return'';}async function generateBananaImage({prompt:_0x49f3c2,width:_0x1e1eb6,height:_0x380e5c,change:_0x3d1725,retouchPrompt:_0x4e0069,retouchImage:_0x55d1fc}){const _0x4b6604={'ovNQV':function(_0x48d6ae){return _0x48d6ae();},'bpDzx':function(_0x974810,_0x28de68){return _0x974810(_0x28de68);},'RaYjg':_0x166fcc(0x2bd,0x325,0x27a,0x352)+_0x4d6642(0x387,0x336,0x3c8,0x2ff)+':','uJaxK':_0x4d6642(0x37f,0x2fe,0x2f6,0x3da)+'+$','oDTpP':_0x4d6642(0x3ed,0x43d,0x400,0x39d)+_0x4d6642(0x399,0x345,0x354,0x31e)+'\x20contain\x20i'+_0x4d6642(0x2f8,0x2b6,0x2ff,0x2f2)+_0x4d6642(0x2e5,0x2e5,0x37d,0x324)+'t','PBKvc':'[Banana]\x20生'+_0x166fcc(0x2f4,0x380,0x344,0x35e),'OEXWs':function(_0x4efe0b,_0x4b24fd){return _0x4efe0b(_0x4b24fd);},'zAWBG':_0x4d6642(0x303,0x282,0x378,0x2ff)+_0x4d6642(0x2eb,0x330,0x2f5,0x367)+_0x4d6642(0x31d,0x293,0x35c,0x35f),'azfbf':_0x166fcc(0x319,0x359,0x2bb,0x3ad)+_0x4d6642(0x362,0x32c,0x31b,0x348),'pMKxe':function(_0x4c1afc,_0x4bb620){return _0x4c1afc<=_0x4bb620;},'gCTTr':function(_0xfc13c,_0x495476){return _0xfc13c+_0x495476;},'LEnxJ':function(_0x49541f,_0x783d00){return _0x49541f(_0x783d00);},'VZGRr':function(_0x35ad76,_0x5e976a){return _0x35ad76+_0x5e976a;},'eRfzz':_0x166fcc(0x2c6,0x334,0x30a,0x2e6),'SSpMt':function(_0x2a2680,_0x57bc22){return _0x2a2680+_0x57bc22;},'kXBNJ':_0x166fcc(0x31b,0x368,0x29f,0x3aa)+_0x166fcc(0x350,0x3d8,0x35b,0x3ae),'xpGfJ':function(_0x5e8dc3,_0x4525bb){return _0x5e8dc3(_0x4525bb);},'CCrnA':function(_0x2b1aac,_0x16a3af){return _0x2b1aac(_0x16a3af);},'JidBL':function(_0x34676e,_0xa4b8e7){return _0x34676e(_0xa4b8e7);},'PYceU':function(_0x3bf4a2,_0x5bad9d){return _0x3bf4a2||_0x5bad9d;},'yvSuL':function(_0x142c37,_0xd95f64){return _0x142c37!==_0xd95f64;},'pXIxt':function(_0x5b8a66,_0x2c1d50){return _0x5b8a66(_0x2c1d50);},'orukk':function(_0x1a9890,_0x28e723){return _0x1a9890(_0x28e723);},'nXGyl':'Scene\x20Comp'+_0x4d6642(0x3f5,0x3a9,0x45a,0x457),'nVwuJ':_0x166fcc(0x2e1,0x2a1,0x24a,0x2a8),'AxLvZ':_0x166fcc(0x2ed,0x316,0x29b,0x2f2),'XetRd':function(_0x31b053,_0x28fc6f){return _0x31b053+_0x28fc6f;},'kuICN':function(_0x42102d,_0x2abca8){return _0x42102d+_0x2abca8;},'BvMgg':_0x166fcc(0x34e,0x3c5,0x2c3,0x2cb),'GLBas':function(_0x5833b9,_0x8e0616,_0x1766e5){return _0x5833b9(_0x8e0616,_0x1766e5);},'VmMHp':function(_0x50e1e3,_0x5c6f38){return _0x50e1e3<=_0x5c6f38;},'OcBHm':function(_0x4eb7ce,_0x30813f){return _0x4eb7ce===_0x30813f;},'DPdlc':'fgEkT','NAopB':function(_0x239e43,_0x182617){return _0x239e43+_0x182617;},'mhIXZ':function(_0x320b37,_0x2d1599){return _0x320b37(_0x2d1599);},'KpzBI':function(_0x3f4e96,_0x26db10){return _0x3f4e96(_0x26db10);},'OLxVE':_0x166fcc(0x399,0x3e4,0x41b,0x335),'WaeRb':_0x4d6642(0x3a5,0x3af,0x32f,0x398),'mpABH':_0x166fcc(0x302,0x2da,0x32e,0x396),'kwGEV':'后置前','CtLZr':function(_0x17349b,_0x12329b){return _0x17349b(_0x12329b);},'steIg':_0x166fcc(0x2cc,0x355,0x2f7,0x240),'xXayk':_0x4d6642(0x364,0x3ac,0x2f7,0x39f)+_0x166fcc(0x315,0x305,0x29d,0x33f),'ySEpi':_0x166fcc(0x310,0x35f,0x375,0x2f2),'ALRqm':'bkZnW','KzDSu':'AxKgY','YcRNR':function(_0x1fe6e0,_0xf4b8af){return _0x1fe6e0(_0xf4b8af);},'uxfdD':function(_0x451783,_0x496768){return _0x451783||_0x496768;},'WRNbl':_0x4d6642(0x346,0x308,0x2ed,0x2cd),'vVGWN':'最后置','OnhxF':function(_0x146002,_0x31cc15){return _0x146002(_0x31cc15);},'wDMLB':_0x166fcc(0x341,0x37f,0x37f,0x339),'qTHQK':_0x4d6642(0x35a,0x31d,0x346,0x30e),'wAvZt':function(_0x1e162d,_0xd121ec){return _0x1e162d(_0xd121ec);},'CecTz':_0x4d6642(0x2fc,0x332,0x265,0x347),'OHipa':'PIrgo','Grifp':function(_0x54bc5f,_0x281c28){return _0x54bc5f(_0x281c28);},'VrOIF':function(_0x53cc09,_0x30fbee){return _0x53cc09>_0x30fbee;},'NbUHz':_0x4d6642(0x332,0x3cb,0x39a,0x2ef),'lMWbY':_0x4d6642(0x31b,0x2da,0x328,0x2e4),'lcNzt':_0x166fcc(0x336,0x348,0x2bf,0x312),'tMrrG':_0x4d6642(0x374,0x3b7,0x373,0x3bd),'mFoRE':_0x4d6642(0x3ee,0x3ca,0x41a,0x413),'gungh':function(_0x5240eb,_0x5da6a6){return _0x5240eb!==_0x5da6a6;},'YqlAq':_0x4d6642(0x2f4,0x25d,0x32f,0x316),'kWdVU':function(_0x5cdec1,_0x2696f1){return _0x5cdec1(_0x2696f1);},'RxAtK':function(_0x59d330,_0x1cf463){return _0x59d330(_0x1cf463);},'mNcYn':function(_0x227400,_0x6a3b37){return _0x227400(_0x6a3b37);},'NVXwE':_0x4d6642(0x38a,0x407,0x38d,0x3c3),'oKTzW':_0x4d6642(0x330,0x390,0x2d9,0x33a),'JjtwF':_0x166fcc(0x37d,0x307,0x3c3,0x347),'vlIhf':function(_0x471251,_0x4baa3c){return _0x471251+_0x4baa3c;},'NSiKo':_0x4d6642(0x385,0x392,0x367,0x38a),'glANK':function(_0x5045d9,_0x2f711e){return _0x5045d9(_0x2f711e);},'yPqmi':'rZjIj','CzxLG':_0x4d6642(0x406,0x466,0x48f,0x3a9)+_0x4d6642(0x337,0x3b6,0x3a0,0x318),'pEjMM':_0x166fcc(0x3aa,0x3fd,0x423,0x364),'xvlyY':function(_0x5b76d5,_0x4e618f){return _0x5b76d5>_0x4e618f;},'LvgAp':_0x166fcc(0x371,0x324,0x30c,0x3cf),'BNPbn':'FeKat','Oqkjl':function(_0x44c983,_0x4e9d41){return _0x44c983===_0x4e9d41;},'PYwQU':_0x4d6642(0x34e,0x391,0x338,0x316),'ebPcA':_0x166fcc(0x2b6,0x2aa,0x342,0x325),'CRHTV':function(_0xd44902,_0x596ea5){return _0xd44902===_0x596ea5;},'eSibV':function(_0x4efc77,_0x847b52){return _0x4efc77===_0x847b52;},'QiyVK':_0x4d6642(0x2ec,0x280,0x2ad,0x2b5),'MussA':function(_0xba53df,_0x37a661){return _0xba53df(_0x37a661);},'gpgHK':_0x4d6642(0x3f6,0x471,0x369,0x44d)+_0x166fcc(0x2be,0x32d,0x2cb,0x2fc)+_0x4d6642(0x31c,0x33c,0x3a6,0x38d)+_0x166fcc(0x29e,0x2be,0x288,0x28f)};_0x49f3c2=_0x4b6604[_0x4d6642(0x309,0x2ae,0x2ee,0x321)](processCharacterPrompt,_0x49f3c2),_0x49f3c2=await _0x4b6604['xpGfJ'](stripChineseAnnotations,_0x49f3c2);let _0x1e6fde=_0x3d1725;_0x3d1725=processCharacterPrompt(_0x3d1725),_0x3d1725=await stripChineseAnnotations(_0x3d1725),_0x4b6604[_0x4d6642(0x3f0,0x417,0x45a,0x409)](addLog,'开始\x20Banana生'+_0x4d6642(0x377,0x2e7,0x3d5,0x2f3)+extension_settings[extensionName][_0x166fcc(0x3ac,0x415,0x356,0x3b7)]),_0x4b6604[_0x166fcc(0x31f,0x2dc,0x315,0x350)](addLog,'请求尺寸:\x20宽度\x20-'+'\x20'+_0x4b6604['PYceU'](_0x1e1eb6,'默认')+_0x166fcc(0x3a7,0x42b,0x396,0x384)+_0x4b6604[_0x4d6642(0x3d1,0x369,0x428,0x3cd)](_0x380e5c,'默认')),_0x49f3c2=_0x3d1725&&_0x4b6604[_0x4d6642(0x3e0,0x43f,0x3e1,0x3a0)](_0x3d1725[_0x166fcc(0x3b8,0x393,0x39d,0x3d4)](),'')?_0x3d1725:_0x49f3c2,_0x4b6604[_0x166fcc(0x2c1,0x26d,0x317,0x31d)](addLog,'用于生成的Tag:\x20'+_0x49f3c2);let _0x1535c5=![];function _0x166fcc(_0x116d67,_0x7d4ef4,_0x46a8ef,_0xa2dadc){return _0x1d39(_0x116d67-0x14e,_0x7d4ef4);}_0x49f3c2[_0x166fcc(0x324,0x334,0x2bf,0x296)]('Scene\x20Comp'+_0x4d6642(0x3f5,0x361,0x44e,0x35d))&&(_0x1535c5=!![]);_0x4b6604[_0x166fcc(0x2fc,0x275,0x32c,0x263)](addLog,_0x4d6642(0x343,0x39b,0x2b3,0x36f)+_0x166fcc(0x2ba,0x2ce,0x28e,0x2c6)+_0x166fcc(0x340,0x374,0x313,0x34f)+_0x1535c5);let _0x16feee={},_0x196e88='',_0xc24cce='';if(_0x1535c5){_0x4b6604[_0x166fcc(0x2c7,0x28e,0x32e,0x338)](addLog,_0x166fcc(0x319,0x301,0x2a6,0x2fd)+'坐标的提示词字符串。'),_0x16feee=_0x4b6604[_0x166fcc(0x361,0x387,0x36a,0x32d)](parsePromptStringWithCoordinates,_0x49f3c2),_0x196e88=_0x16feee[_0x4b6604[_0x166fcc(0x392,0x30b,0x423,0x423)]];for(let _0x39080a=-0x1*0xf6f+0x1*-0x14c3+0x2433;_0x39080a<=-0x269*-0x1+0x1*0x897+0x1*-0xafc;_0x39080a++){_0x16feee[_0x166fcc(0x34f,0x319,0x300,0x2fe)+_0x39080a+'\x20Prompt']&&(_0x4b6604['yvSuL'](_0x4b6604[_0x166fcc(0x383,0x40a,0x33d,0x317)],_0x4b6604['AxLvZ'])?_0xc24cce=_0x4b6604[_0x166fcc(0x311,0x313,0x32a,0x343)](_0x4b6604[_0x166fcc(0x36f,0x324,0x38f,0x323)](_0xc24cce,',\x20'),_0x16feee[_0x166fcc(0x34f,0x3a0,0x2e8,0x2bb)+_0x39080a+_0x4d6642(0x40a,0x41a,0x3c6,0x410)]):(!_0x4110a1[_0x166fcc(0x2f2,0x274,0x277,0x2af)+_0x4d6642(0x310,0x386,0x287,0x392)+_0x166fcc(0x30f,0x285,0x30c,0x37d)]&&(_0x183457[_0x166fcc(0x2f2,0x298,0x26a,0x25d)+'BananaList'+_0x166fcc(0x30f,0x301,0x28a,0x2a8)]=!![],_0x4b6604[_0x4d6642(0x390,0x3ad,0x40e,0x3f3)](_0x439de6)),_0x4b6604['ovNQV'](_0x371434)));}}else{if(_0x4b6604[_0x166fcc(0x398,0x310,0x3b7,0x333)](_0x4d6642(0x36a,0x348,0x3b5,0x3a8),_0x4b6604[_0x4d6642(0x40d,0x38c,0x3d2,0x398)]))_0x4b6604[_0x166fcc(0x361,0x3bb,0x312,0x315)](addLog,_0x4d6642(0x3d4,0x3aa,0x404,0x3e6)+_0x4d6642(0x3ac,0x3e6,0x3c9,0x3d5)),_0x196e88=_0x49f3c2;else{_0x4b6604[_0x166fcc(0x314,0x37b,0x2aa,0x345)](_0x2a8c83,_0x166fcc(0x2bd,0x31e,0x26d,0x2a6)+_0x166fcc(0x33f,0x393,0x376,0x2eb)+':\x20'+_0x349fde[_0x4d6642(0x3fe,0x41e,0x40f,0x38f)]),_0x3cb220[_0x4d6642(0x3d5,0x340,0x45a,0x401)](_0x4b6604[_0x4d6642(0x324,0x2e7,0x362,0x39c)],_0x1bac13);throw _0x57252f;}}let {modifiedPrompt:_0x5dc222,insertions:_0xd3c00}=await _0x4b6604[_0x4d6642(0x3c3,0x3b6,0x391,0x424)](prompt_replace,_0x196e88,_0xc24cce);if(_0x1535c5){if(_0x4b6604['yvSuL'](_0x4d6642(0x35e,0x32a,0x370,0x398),_0x166fcc(0x2ee,0x35f,0x2ba,0x2be)))for(let _0x166799=0x7d*0x3+0x1c5*-0x12+0x1e64;_0x4b6604['VmMHp'](_0x166799,-0xd1*-0x2d+-0x43*-0x5c+-0xc29*0x5);_0x166799++){if(_0x4b6604[_0x166fcc(0x2e9,0x2eb,0x37b,0x32d)](_0x4b6604[_0x4d6642(0x3ec,0x380,0x485,0x40f)],_0x4b6604[_0x4d6642(0x3ec,0x40b,0x367,0x417)]))_0x16feee['Character\x20'+_0x166799+_0x166fcc(0x3c2,0x42f,0x3a0,0x440)]&&(_0x5dc222=_0x4b6604[_0x166fcc(0x3c4,0x38a,0x42b,0x350)](_0x4b6604[_0x4d6642(0x340,0x3bc,0x36d,0x3d1)](_0x5dc222,_0x4b6604[_0x4d6642(0x39a,0x40c,0x323,0x403)]),_0x4b6604[_0x166fcc(0x375,0x3b9,0x32b,0x3ab)](prompt_replace_for_character,_0x16feee['Character\x20'+_0x166799+'\x20Prompt'])));else return _0x1a6a7f[_0x166fcc(0x36c,0x2db,0x31e,0x352)]()[_0x4d6642(0x3a6,0x34e,0x38c,0x36f)]('(((.+)+)+)'+'+$')[_0x166fcc(0x36c,0x389,0x3e4,0x323)]()['constructo'+'r'](_0x1b20f6)[_0x4d6642(0x3a6,0x403,0x3e0,0x3bf)](ZvhOML['uJaxK']);}else throw new _0xf61aff(_0x4b6604[_0x166fcc(0x2a2,0x217,0x27e,0x29d)]);}const _0x5c75c8=extension_settings[extensionName][_0x166fcc(0x2c3,0x22a,0x277,0x23c)],{model:_0x1ea4ad,apiUrl:_0x1502b0,apiKey:_0x44fa32,conversationPresets:_0x267952,conversationPresetId:_0x44bd55,editPresetId:_0x5c0ba7,aspectRatio:_0x4f928c}=_0x5c75c8;_0x4b6604['KpzBI'](addLog,'[Banana]\x20S'+_0x4d6642(0x315,0x2d3,0x27f,0x290)+_0x166fcc(0x330,0x2bf,0x2ef,0x31f)+_0x4d6642(0x33b,0x366,0x2c5,0x2c9)+_0x166fcc(0x317,0x329,0x38c,0x2d5)+_0x1ea4ad);let _0x305a12,_0x53d43f;if(_0x1ea4ad['startsWith'](_0x166fcc(0x2e3,0x2d4,0x2d1,0x34b))){if(_0x4b6604[_0x4d6642(0x3e0,0x3d8,0x40e,0x3e5)]('vptKF',_0x4b6604['OLxVE']))_0x316e84[_0x166fcc(0x2f2,0x2a2,0x2a6,0x2d7)+_0x4d6642(0x310,0x2c1,0x309,0x38e)+'ener']&&(_0x47fc8e[_0x166fcc(0x386,0x31a,0x412,0x2f2)+_0x4d6642(0x357,0x2d1,0x313,0x305)](_0x4bec13[_0x166fcc(0x37f,0x3c2,0x3f1,0x348)+_0x166fcc(0x2d8,0x324,0x347,0x2a9)+'ST'],_0x4090b1),_0x341bb0[_0x4d6642(0x2f7,0x290,0x2de,0x310)](_0x59d145=>{function _0x2f88cf(_0x1d52e0,_0x19cbc3,_0x39d455,_0x4c829e){return _0x166fcc(_0x1d52e0-0x23,_0x4c829e,_0x39d455-0x41,_0x4c829e-0x1ae);}function _0x58c649(_0x3a4f09,_0x306eb5,_0x506a0d,_0x3c040c){return _0x4d6642(_0x3c040c- -0x1ba,_0x306eb5,_0x506a0d-0x1af,_0x3c040c-0x139);}_0x8cf9ff[_0x2f88cf(0x3a9,0x351,0x413,0x3df)+_0x58c649(0x1e0,0x21b,0x117,0x19d)](_0x59d145,_0x397eb0);}),_0x3af816[_0x166fcc(0x2f2,0x30a,0x2bc,0x279)+_0x4d6642(0x310,0x3a8,0x27c,0x2eb)+'ener']=![],_0x4b6604['bpDzx'](_0xa70f4d,_0x4b6604[_0x166fcc(0x3c6,0x363,0x3d6,0x390)]));else{_0x305a12=_0x4d6642(0x3f1,0x476,0x3ad,0x3ae)+_0x4d6642(0x3e9,0x353,0x356,0x40c)+_0x1ea4ad;const _0x17a041={};_0x17a041['fixedPromp'+'t']='';const _0x345cf5=_0x267952[_0x44bd55]||_0x17a041,_0xb9a32e=[_0x345cf5[_0x166fcc(0x2a8,0x319,0x29b,0x2ef)+'t'],_0xd3c00[_0x4b6604[_0x4d6642(0x36e,0x36e,0x3ca,0x30b)]],_0xd3c00[_0x4b6604['mpABH']],_0x5dc222,_0xd3c00[_0x4b6604['kwGEV']],_0xd3c00[_0x166fcc(0x2fe,0x26a,0x360,0x30f)],_0x345cf5['postfixPro'+_0x4d6642(0x372,0x33c,0x37a,0x3c1)],_0xd3c00['最后置']][_0x4d6642(0x325,0x32d,0x31e,0x342)](Boolean)[_0x166fcc(0x2e6,0x368,0x2d3,0x27f)](',\x20');_0x4b6604[_0x4d6642(0x32c,0x367,0x358,0x2dc)](addLog,_0x166fcc(0x2df,0x27d,0x311,0x362)+_0xb9a32e);const _0x21499d={};_0x21499d[_0x166fcc(0x369,0x30c,0x2f9,0x397)]=_0xb9a32e;const _0x5704ef={};_0x5704ef[_0x4d6642(0x386,0x3f9,0x3c8,0x317)+'t']=0x1,_0x5704ef['aspectRati'+'o']=_0x4f928c;const _0x5548cf={};_0x5548cf[_0x4d6642(0x3ca,0x407,0x3a8,0x37b)]=[_0x21499d],_0x5548cf['parameters']=_0x5704ef,_0x53d43f=_0x5548cf,addLog(_0x4d6642(0x40f,0x41f,0x454,0x481)+_0x166fcc(0x329,0x34f,0x354,0x353)+'n\x20payload\x20'+_0x4d6642(0x3b2,0x382,0x3b9,0x39b)+_0x4d6642(0x360,0x338,0x2da,0x33a)+_0xb9a32e);}}else{if(_0x4b6604[_0x4d6642(0x331,0x2de,0x315,0x2a3)](_0x4b6604[_0x4d6642(0x3e4,0x42b,0x355,0x468)],_0x4b6604['steIg'])){_0x305a12=_0x4b6604[_0x166fcc(0x3b4,0x399,0x37b,0x394)];let _0x1c43d8;if(_0x3d1725[_0x166fcc(0x324,0x2c8,0x369,0x384)](_0x4b6604[_0x166fcc(0x3b5,0x407,0x3d9,0x33b)])){if(_0x4b6604['ALRqm']!==_0x4b6604[_0x166fcc(0x33b,0x360,0x2d1,0x2e1)]){_0x4b6604[_0x4d6642(0x376,0x32d,0x35d,0x316)](addLog,_0x166fcc(0x37c,0x367,0x345,0x397)+_0x166fcc(0x308,0x2a2,0x380,0x275)+'。');const _0x2857a1=_0x4b6604[_0x4d6642(0x2f9,0x381,0x326,0x344)](_0x5c0ba7,'默认'),_0x3c749c={};_0x3c749c[_0x4d6642(0x3df,0x35b,0x370,0x360)+'on']=[],_0x3c749c[_0x4d6642(0x2f0,0x308,0x265,0x2e0)+'t']='',_0x1c43d8=_0x267952[_0x2857a1]||_0x3c749c,_0x4b6604[_0x166fcc(0x31d,0x291,0x2cb,0x33c)](addLog,_0x166fcc(0x3bc,0x3cb,0x41c,0x337)+_0x166fcc(0x39f,0x3d7,0x3b1,0x3e5)+_0x2857a1+'\x22');}else _0x4b6604[_0x166fcc(0x2c1,0x25e,0x2f8,0x2cf)](_0x1bdc5c,_0x4d6642(0x3d4,0x43c,0x373,0x389)+_0x166fcc(0x364,0x3fa,0x2dc,0x315)),_0xc8baee=_0x1f0aed;}else{const _0x2e9a42={};_0x2e9a42[_0x4d6642(0x3df,0x34a,0x36b,0x35d)+'on']=[],_0x2e9a42['fixedPromp'+'t']='',_0x1c43d8=_0x267952[_0x44bd55]||_0x2e9a42;}const _0x34383b=[_0x1c43d8[_0x166fcc(0x2a8,0x2a7,0x333,0x28a)+'t'],_0xd3c00[_0x4b6604[_0x166fcc(0x326,0x375,0x2fb,0x33b)]],_0xd3c00[_0x4b6604[_0x4d6642(0x323,0x295,0x376,0x2e8)]],_0x5dc222,_0xd3c00[_0x4b6604[_0x4d6642(0x319,0x39c,0x292,0x2a8)]],_0xd3c00[_0x4b6604[_0x166fcc(0x3bf,0x41d,0x3bf,0x3a8)]],_0x1c43d8[_0x166fcc(0x356,0x2c1,0x3dc,0x39b)+_0x4d6642(0x372,0x2fd,0x3c1,0x3ee)],_0xd3c00[_0x4b6604['vVGWN']]]['filter'](Boolean)[_0x166fcc(0x2e6,0x2c1,0x353,0x2ee)](',\x20');_0x4b6604[_0x4d6642(0x3bb,0x39b,0x433,0x43f)](addLog,_0x4d6642(0x327,0x37d,0x351,0x2ce)+_0x34383b);const _0x4f1cb6={};_0x4f1cb6[_0x4d6642(0x37a,0x413,0x398,0x38a)]=_0x4d6642(0x332,0x348,0x37c,0x2a5),_0x4f1cb6[_0x4d6642(0x3e2,0x3c9,0x3a6,0x3e4)]=[];const _0x37aa0c={};_0x37aa0c[_0x166fcc(0x332,0x363,0x305,0x390)]=_0x166fcc(0x2d3,0x307,0x2ff,0x2f7),_0x37aa0c[_0x166fcc(0x39a,0x31e,0x3bf,0x339)]=[];const _0x499928=_0x1c43d8[_0x4d6642(0x3df,0x37c,0x449,0x365)+'on'][_0x166fcc(0x3b7,0x3e5,0x382,0x434)](_0x45bb6e=>[_0x4f1cb6,_0x37aa0c])[_0x166fcc(0x37a,0x2fa,0x3a9,0x30e)]();let _0x38124d=-0x1*-0xd87+0x1*0x7e9+-0x31*0x70;for(const _0xbe21f2 of _0x1c43d8[_0x166fcc(0x397,0x367,0x39a,0x361)+'on']){if(_0x4b6604[_0x166fcc(0x2e9,0x2af,0x2d7,0x251)](_0x4b6604[_0x4d6642(0x353,0x394,0x2df,0x2ea)],_0x4b6604[_0x166fcc(0x30b,0x2b1,0x321,0x393)])){if(_0xbe21f2[_0x4d6642(0x332,0x314,0x3c7,0x2a0)]?.[_0x4d6642(0x35a,0x2d5,0x35b,0x39a)])_0x499928[_0x38124d][_0x4d6642(0x3e2,0x3f9,0x381,0x3e3)]['push']({'type':_0x4b6604['qTHQK'],'text':_0xbe21f2[_0x166fcc(0x2ea,0x372,0x29d,0x26f)][_0x166fcc(0x312,0x28a,0x377,0x29c)]});const _0x102064=await _0x4b6604[_0x4d6642(0x345,0x2b8,0x328,0x3be)](getImageFromTurnData,_0xbe21f2[_0x4d6642(0x332,0x347,0x392,0x34f)]);if(_0x102064)_0x499928[_0x38124d][_0x166fcc(0x39a,0x3ac,0x39e,0x41a)][_0x166fcc(0x2ff,0x296,0x2f4,0x27e)]({'type':_0x4b6604[_0x166fcc(0x2bf,0x27f,0x283,0x277)],'image_url':{'url':_0x102064}});_0x38124d++;if(_0xbe21f2['model']?.[_0x166fcc(0x312,0x33d,0x301,0x350)])_0x499928[_0x38124d][_0x166fcc(0x39a,0x3cd,0x39d,0x3fa)][_0x4d6642(0x347,0x3d3,0x2eb,0x35a)]({'type':_0x4b6604[_0x166fcc(0x3cc,0x450,0x43a,0x36a)],'text':_0xbe21f2[_0x166fcc(0x388,0x31c,0x335,0x3d2)]['text']});const _0x37fffb=await _0x4b6604[_0x4d6642(0x30f,0x2fb,0x2e8,0x287)](getImageFromTurnData,_0xbe21f2[_0x4d6642(0x3d0,0x384,0x452,0x363)]);if(_0x37fffb)_0x499928[_0x38124d]['content'][_0x166fcc(0x2ff,0x36c,0x299,0x386)]({'type':_0x166fcc(0x2b4,0x241,0x2d9,0x33b),'image_url':{'url':_0x37fffb}});_0x38124d++;}else{const _0x17125d=_0x166fcc(0x36b,0x352,0x367,0x378)+_0x166fcc(0x38a,0x37c,0x3a6,0x364)+'failed\x20for'+_0x166fcc(0x36d,0x3bb,0x3be,0x358)+_0x28785b+':\x20'+_0x10f332[_0x166fcc(0x3b6,0x3d4,0x3de,0x410)];_0x272a14(_0x17125d),_0x29470c[_0x4d6642(0x3d5,0x452,0x3eb,0x383)](_0x17125d);const _0x370a2b={};_0x370a2b['id']=_0x285fa5,_0x370a2b[_0x4d6642(0x384,0x32f,0x33e,0x387)]=![],_0x370a2b[_0x166fcc(0x38d,0x36f,0x3a5,0x330)]=_0x4d3221[_0x4d6642(0x3fe,0x3ca,0x3d6,0x3b5)],_0x370a2b[_0x4d6642(0x3b1,0x356,0x31b,0x424)]=_0x13b809,_0x53334a[_0x4d6642(0x3cd,0x3ae,0x452,0x447)](_0x16ec61[_0x4d6642(0x3c7,0x372,0x446,0x35b)+_0x4d6642(0x370,0x2fd,0x336,0x3ba)+'NSE'],_0x370a2b);const _0x4a59a4={};_0x4a59a4['id']=_0x440934,_0x4a59a4[_0x4d6642(0x384,0x407,0x351,0x3cc)]=![],_0x4a59a4[_0x166fcc(0x38d,0x3b5,0x3bc,0x413)]=_0x1bb3f8[_0x4d6642(0x3fe,0x36e,0x42a,0x3c9)],_0x4a59a4[_0x166fcc(0x369,0x38f,0x35e,0x333)]=_0x50cebb,_0x53696b['emit'](_0x4b6604[_0x166fcc(0x304,0x389,0x33e,0x399)],_0x4a59a4),_0x4b6604[_0x166fcc(0x2c1,0x2d3,0x22c,0x325)](_0x3024cf,_0x166fcc(0x301,0x28d,0x2aa,0x399)+_0x166fcc(0x3ba,0x34a,0x3cb,0x3b5)+_0x166fcc(0x2de,0x2e5,0x302,0x24f)+_0x166fcc(0x349,0x338,0x2e5,0x347)+':\x20'+_0x5d6f77);}}if(!_0x3d1725['includes'](_0x4b6604[_0x166fcc(0x3b5,0x44d,0x41a,0x3b8)])){const _0x46a272=extension_settings[extensionName][_0x4d6642(0x31f,0x32e,0x38f,0x304)+_0x4d6642(0x2ef,0x2c8,0x333,0x31b)+'ts']||{};for(const _0x3dd480 in _0x46a272){const _0x53f5a6=_0x46a272[_0x3dd480],_0x49fad3=(_0x53f5a6[_0x4d6642(0x3d8,0x3a6,0x3d6,0x438)]||'')[_0x4d6642(0x32a,0x321,0x2ab,0x2ff)]('|')[_0x4d6642(0x325,0x2bf,0x2ec,0x2b3)](_0x1b54bb=>_0x1b54bb[_0x4d6642(0x400,0x435,0x43d,0x464)]()!=='');for(const _0x360941 of _0x49fad3){if(_0x4b6604[_0x4d6642(0x331,0x396,0x34b,0x304)](_0x4d6642(0x34f,0x36c,0x328,0x3c3),_0x4b6604[_0x166fcc(0x3cb,0x351,0x39e,0x3c2)])){if(_0x34383b[_0x4d6642(0x40b,0x3bb,0x47c,0x3a8)+'e']()[_0x166fcc(0x324,0x2ef,0x341,0x28e)](_0x360941[_0x166fcc(0x3c3,0x3f0,0x331,0x440)+'e']())){addLog('[Banana]\x20F'+_0x166fcc(0x379,0x321,0x3ec,0x3e9)+_0x166fcc(0x3af,0x332,0x41a,0x363)+_0x166fcc(0x358,0x3c0,0x2d3,0x36c)+_0x360941+(_0x4d6642(0x3e6,0x3a9,0x455,0x371)+_0x4d6642(0x33d,0x2e4,0x394,0x2ad))+_0x3dd480+'\x22.');const _0x104fcb=_0x53f5a6['conversati'+'on'];if(_0x104fcb){const _0x3894e3=[];if(_0x104fcb[_0x166fcc(0x2ea,0x2d5,0x267,0x2d9)]&&_0x104fcb[_0x166fcc(0x2ea,0x2be,0x353,0x266)]['text'])_0x3894e3['push']({'type':_0x4b6604[_0x4d6642(0x414,0x3d7,0x455,0x38b)],'text':_0x104fcb[_0x4d6642(0x332,0x3b7,0x340,0x33c)][_0x4d6642(0x35a,0x388,0x3a7,0x2e7)]});const _0x21ef5e=await _0x4b6604[_0x4d6642(0x2ee,0x2e6,0x36d,0x2e0)](getImageFromTurnData,_0x104fcb[_0x4d6642(0x332,0x36e,0x3b6,0x39c)]);if(_0x21ef5e)_0x3894e3['push']({'type':_0x4b6604[_0x4d6642(0x307,0x313,0x369,0x2eb)],'image_url':{'url':_0x21ef5e}});if(_0x4b6604[_0x4d6642(0x38d,0x403,0x318,0x409)](_0x3894e3['length'],-0x1016+-0xfa6+0x2a5*0xc)){const _0xc843bb={};_0xc843bb[_0x166fcc(0x332,0x2bb,0x3c6,0x2c4)]=_0x4b6604[_0x166fcc(0x2f9,0x311,0x2ac,0x2a7)],_0xc843bb['content']=_0x3894e3,_0x499928[_0x4d6642(0x347,0x385,0x395,0x2df)](_0xc843bb);}const _0x3eac87=[];if(_0x104fcb[_0x4d6642(0x3d0,0x378,0x3ae,0x45b)]&&_0x104fcb[_0x166fcc(0x388,0x2fa,0x317,0x3fa)][_0x166fcc(0x312,0x35e,0x366,0x324)])_0x3eac87['push']({'type':_0x4b6604['qTHQK'],'text':_0x104fcb[_0x166fcc(0x388,0x30c,0x2f1,0x3f5)][_0x166fcc(0x312,0x2c3,0x2fa,0x371)]});const _0x2ffa5a=await getImageFromTurnData(_0x104fcb[_0x4d6642(0x3d0,0x38b,0x378,0x3a0)]);if(_0x2ffa5a)_0x3eac87['push']({'type':_0x4b6604[_0x4d6642(0x307,0x31c,0x347,0x32b)],'image_url':{'url':_0x2ffa5a}});if(_0x4b6604['VrOIF'](_0x3eac87['length'],-0xf92*0x2+0x2061+0x1*-0x13d)){const _0x2bb48a={};_0x2bb48a[_0x166fcc(0x332,0x33f,0x378,0x365)]=_0x4b6604['lMWbY'],_0x2bb48a[_0x166fcc(0x39a,0x326,0x405,0x320)]=_0x3eac87,_0x499928['push'](_0x2bb48a);}}break;}}else{if(_0x1fce80){const _0xc0a57e=_0x55dd60['apply'](_0x4529a1,arguments);return _0x141adb=null,_0xc0a57e;}}}}}if(!_0x3d1725[_0x166fcc(0x324,0x297,0x363,0x33a)](_0x4b6604['ySEpi'])){if(_0x4b6604[_0x166fcc(0x398,0x3e8,0x40c,0x41e)](_0x166fcc(0x344,0x3a6,0x3c6,0x395),_0x4b6604[_0x166fcc(0x35a,0x3d0,0x3ec,0x2c3)])){const _0x56bc7d={};_0x56bc7d[_0x4d6642(0x38e,0x332,0x32b,0x376)]=_0x4b6604[_0x166fcc(0x3cc,0x427,0x336,0x454)],_0x56bc7d[_0x166fcc(0x312,0x34c,0x2ee,0x307)]=_0x34383b;const _0x9c6333={};_0x9c6333[_0x166fcc(0x332,0x3be,0x2c1,0x2e2)]=_0x4d6642(0x332,0x2ea,0x2a7,0x3b9),_0x9c6333[_0x4d6642(0x3e2,0x3d2,0x391,0x3c0)]=[_0x56bc7d],_0x499928[_0x166fcc(0x2ff,0x37a,0x30d,0x351)](_0x9c6333);}else{_0x1a44ba(_0x4b6604['azfbf']),_0x2e18a2=_0x3217aa(_0x7a065),_0x486484=_0x53727a['Scene\x20Comp'+_0x166fcc(0x3ad,0x415,0x426,0x3f4)];for(let _0xe030c0=0x8b*0x19+-0x1*-0x8bf+-0x1651;_0x4b6604[_0x166fcc(0x365,0x315,0x35b,0x3fc)](_0xe030c0,0x19f0+0x661+-0x204d);_0xe030c0++){_0x35747b['Character\x20'+_0xe030c0+_0x166fcc(0x3c2,0x419,0x37c,0x355)]&&(_0x3ade24=_0x4b6604[_0x4d6642(0x34d,0x34a,0x3a9,0x321)](_0xf51c22+',\x20',_0x5c6e92['Character\x20'+_0xe030c0+_0x166fcc(0x3c2,0x362,0x3ce,0x39f)]));}}}else{if(_0x4b6604[_0x166fcc(0x398,0x32f,0x3af,0x384)](_0x4b6604['tMrrG'],_0x4b6604['mFoRE'])){const _0x57b90c=[],_0x23c2c8=_0x4b6604['uxfdD'](_0x4e0069,_0x34383b),_0x2dfcf2=[_0x1c43d8[_0x166fcc(0x2a8,0x2e9,0x2b7,0x27b)+'t'],_0x23c2c8,_0x1c43d8[_0x4d6642(0x39e,0x390,0x358,0x432)+_0x4d6642(0x372,0x40a,0x380,0x3ba)]][_0x166fcc(0x2dd,0x2a1,0x2a4,0x2c1)](Boolean)[_0x166fcc(0x2e6,0x2db,0x2b6,0x35d)](',\x20'),_0x136e5c={};_0x136e5c[_0x166fcc(0x346,0x2eb,0x2f7,0x31b)]=_0x4b6604[_0x4d6642(0x414,0x492,0x41b,0x3ae)],_0x136e5c[_0x4d6642(0x35a,0x2e3,0x325,0x3f1)]=_0x2dfcf2,_0x57b90c[_0x4d6642(0x347,0x36b,0x2d9,0x2be)](_0x136e5c);if(_0x55d1fc){if(_0x4b6604[_0x4d6642(0x334,0x357,0x3c5,0x305)](_0x4b6604[_0x4d6642(0x394,0x3f6,0x395,0x421)],_0x4d6642(0x322,0x31e,0x2bd,0x329))){const _0x4306e1={};_0x4306e1['url']=_0x55d1fc;const _0x729534={};_0x729534[_0x166fcc(0x346,0x338,0x3a2,0x2e0)]=_0x4b6604[_0x4d6642(0x307,0x277,0x36e,0x393)],_0x729534[_0x166fcc(0x2b4,0x334,0x250,0x23a)]=_0x4306e1,_0x57b90c['push'](_0x729534),_0x4b6604['kWdVU'](addLog,'[Banana]\x20修'+_0x4d6642(0x2e8,0x30f,0x2d3,0x2b7)+'的图片');}else{const _0x595648=_0x407bbf[_0x166fcc(0x384,0x306,0x300,0x36d)](_0x4fe355,arguments);return _0x33b0a0=null,_0x595648;}}const _0x52c367={};_0x52c367[_0x4d6642(0x37a,0x3da,0x367,0x3d0)]=_0x4b6604[_0x166fcc(0x2f9,0x360,0x26d,0x373)],_0x52c367[_0x166fcc(0x39a,0x38a,0x404,0x41e)]=_0x57b90c,_0x499928[_0x4d6642(0x347,0x314,0x2d6,0x399)](_0x52c367),_0x4b6604['RxAtK'](addLog,_0x166fcc(0x2a5,0x26f,0x23f,0x26e)+'图模式：指令\x20=\x20'+_0x2dfcf2);}else _0x436d24[_0x1efcfe][_0x166fcc(0x2c3,0x241,0x27d,0x359)]['cishu']=_0x4b6604['gCTTr'](_0x18e9f6[_0x321280][_0x166fcc(0x2c3,0x2c6,0x30e,0x2c5)][_0x4d6642(0x304,0x346,0x2e5,0x383)],0x655+-0x19e4+-0x4*-0x4e4),_0x4b6604['LEnxJ'](_0x336732,_0x166fcc(0x2ce,0x28e,0x281,0x2b8)+_0x4d6642(0x3a3,0x348,0x311,0x34b)+_0x501ae8[_0x40beea][_0x4d6642(0x30b,0x334,0x31f,0x31f)][_0x166fcc(0x2bc,0x2af,0x2b3,0x2eb)]);}const _0x42f443={};_0x42f443['aspectRati'+'o']=_0x4f928c;const _0x18795a={};_0x18795a['imageConfi'+'g']=_0x42f443,_0x53d43f={'model':_0x1ea4ad,'messages':_0x499928[_0x4d6642(0x325,0x320,0x29c,0x2a7)](_0x123503=>_0x123503[_0x166fcc(0x39a,0x3e0,0x3b7,0x3f0)][_0x166fcc(0x394,0x374,0x3a6,0x32e)]>0x1*0x376+-0x2*-0xa01+0x5de*-0x4),'config':_0x18795a},_0x4b6604[_0x4d6642(0x321,0x3a6,0x2a1,0x32a)](addLog,_0x166fcc(0x3c7,0x417,0x370,0x369)+_0x166fcc(0x3a3,0x348,0x346,0x425)+_0x166fcc(0x338,0x3be,0x311,0x331)+_0x166fcc(0x3b9,0x382,0x3ef,0x33c)+_0x53d43f[_0x166fcc(0x29f,0x2e6,0x256,0x327)][_0x166fcc(0x394,0x352,0x346,0x3fd)]+_0x4d6642(0x300,0x322,0x34b,0x2e9));}else{const _0x16f9bb={};_0x16f9bb['role']=_0x4d6642(0x31b,0x2fd,0x32a,0x3a6),_0x16f9bb[_0x4d6642(0x3e2,0x3c6,0x418,0x45a)]=_0x15651a,_0x1a0d33[_0x4d6642(0x347,0x32b,0x310,0x36f)](_0x16f9bb);}}let _0x23bb05=_0x1502b0[_0x4d6642(0x342,0x394,0x3ae,0x34a)](/\/$/,''),_0x21a4e6;function _0x4d6642(_0x46b5de,_0x18cca5,_0x317a77,_0x66bdff){return _0x1d39(_0x46b5de-0x196,_0x18cca5);}_0x23bb05['endsWith'](_0x166fcc(0x33d,0x389,0x2a5,0x336))||_0x23bb05[_0x4d6642(0x36c,0x306,0x32c,0x330)](_0x4b6604[_0x4d6642(0x352,0x371,0x2d8,0x337)])?_0x4b6604[_0x4d6642(0x334,0x2a5,0x389,0x2a4)](_0x4b6604[_0x4d6642(0x39c,0x341,0x356,0x324)],_0x4b6604[_0x4d6642(0x39b,0x31a,0x3bf,0x3d5)])?_0x21a4e6=_0x23bb05+_0x305a12:_0x41dc84=_0x2c7454[_0x4d6642(0x355,0x381,0x338,0x2ce)](_0x166fcc(0x310,0x2f0,0x30d,0x2da),''):_0x21a4e6=_0x4b6604[_0x166fcc(0x2cb,0x2e2,0x2b3,0x23b)](_0x23bb05,_0x4b6604['NSiKo'])+_0x305a12;_0x21a4e6=_0x21a4e6[_0x166fcc(0x2fa,0x37d,0x368,0x30a)](/\/v1\/v1\//g,'/v1/'),_0x4b6604[_0x4d6642(0x345,0x2bc,0x2ed,0x341)](addLog,_0x4d6642(0x408,0x426,0x463,0x48b)+_0x166fcc(0x362,0x355,0x36a,0x320)+_0x4d6642(0x39f,0x372,0x3f2,0x42e)+_0x21a4e6),_0x4b6604[_0x4d6642(0x308,0x326,0x27d,0x2df)](addLog,_0x4d6642(0x3d3,0x40c,0x3b6,0x3f8)+'ayload:\x20'+JSON[_0x4d6642(0x30c,0x339,0x281,0x360)](_0x53d43f,null,0x2678+0x114*0x8+-0x2f16));try{if(_0x4d6642(0x2f3,0x35e,0x290,0x2fa)===_0x4b6604[_0x166fcc(0x3c9,0x415,0x425,0x34d)]){const _0x407de1=await _0x4b6604[_0x166fcc(0x37b,0x2f8,0x2e2,0x2ea)](fetch,_0x21a4e6,{'method':_0x4d6642(0x3f3,0x457,0x486,0x390),'headers':{'Content-Type':_0x4b6604[_0x166fcc(0x2f1,0x2f2,0x354,0x378)],'Authorization':_0x166fcc(0x3a0,0x3c3,0x382,0x439)+_0x44fa32},'body':JSON[_0x4d6642(0x30c,0x345,0x388,0x302)](_0x53d43f)});if(!_0x407de1['ok']){if(_0x4b6604[_0x166fcc(0x398,0x42f,0x402,0x365)](_0x4d6642(0x3f8,0x444,0x40c,0x392),_0x4b6604['pEjMM'])){const _0x56e1a3=await _0x407de1['text']();throw new Error(_0x4d6642(0x3c9,0x3bd,0x417,0x338)+'t\x20failed\x20w'+_0x166fcc(0x39b,0x313,0x329,0x3d4)+'\x20'+_0x407de1[_0x166fcc(0x33a,0x342,0x327,0x39f)]+':\x20'+_0x56e1a3);}else _0x2330e9[_0x4d6642(0x397,0x3f6,0x3ed,0x3e5)+_0x155612+_0x166fcc(0x3c2,0x3e8,0x3f6,0x42e)]&&(_0x2f83c8=_0x4b6604[_0x4d6642(0x34d,0x2e8,0x3bf,0x3c9)](_0x4b6604[_0x4d6642(0x340,0x2ff,0x328,0x36b)](_0x80d963,_0x4b6604[_0x166fcc(0x352,0x3c6,0x3b0,0x392)]),_0x4b6604[_0x4d6642(0x35c,0x348,0x2e9,0x3ec)](_0x2ed334,_0xeae175['Character\x20'+_0x1155ae+'\x20Prompt'])));}const _0x349283=await _0x407de1[_0x166fcc(0x334,0x2af,0x2cc,0x366)]();let _0x305159='';const _0x45c00d=_0x349283[_0x166fcc(0x374,0x32f,0x350,0x327)];if(_0x45c00d&&_0x4b6604['xvlyY'](_0x45c00d[_0x4d6642(0x3dc,0x433,0x46c,0x3cc)],-0xb4*0x2f+0x2333*-0x1+0x1*0x443f)){if(_0x4b6604[_0x4d6642(0x35b,0x387,0x3b4,0x3c2)]===_0x4d6642(0x3b9,0x391,0x378,0x406)){const _0x5f5703=_0x45c00d[0x1*0xf49+-0xf*0x215+0x7f9*0x2][_0x4d6642(0x3fe,0x3a5,0x3ff,0x37b)]?.[_0x166fcc(0x39a,0x3a1,0x395,0x42d)];if(Array['isArray'](_0x5f5703)){if(_0x4b6604['OcBHm'](_0x4d6642(0x39d,0x31f,0x338,0x3d9),_0x4b6604[_0x166fcc(0x335,0x39a,0x35d,0x2e9)]))for(const _0x51e73e of _0x5f5703){if(_0x4b6604[_0x4d6642(0x33f,0x2e7,0x353,0x367)](_0x4b6604[_0x166fcc(0x303,0x2dc,0x390,0x2da)],_0x4b6604[_0x4d6642(0x3fb,0x3a6,0x43b,0x428)]))return _0xc3fee0[_0x4d6642(0x375,0x32c,0x2ee,0x3ad)];else{if(_0x4b6604[_0x166fcc(0x339,0x379,0x391,0x337)](_0x51e73e[_0x166fcc(0x346,0x2ca,0x324,0x35a)],_0x4b6604[_0x4d6642(0x307,0x300,0x2d5,0x2e7)])&&_0x51e73e[_0x166fcc(0x2b4,0x250,0x34c,0x242)]?.[_0x4d6642(0x30a,0x2ee,0x31b,0x295)]){_0x305159=_0x51e73e['image_url']['url'];break;}}}else for(let _0x31f0f1=0x37*-0x89+0x1eab+-0x3f*0x5;_0x31f0f1<=0x19c8+-0x425*-0x4+0x8*-0x54b;_0x31f0f1++){_0x467fbb[_0x166fcc(0x34f,0x339,0x31b,0x2ba)+_0x31f0f1+_0x166fcc(0x3c2,0x39d,0x438,0x3ac)]&&(_0x3c0d4c=_0x4b6604[_0x4d6642(0x2fd,0x2da,0x31b,0x2c0)](_0x4b6604['gCTTr'](_0x128ad9,_0x4b6604['eRfzz']),_0x1f8a30(_0x368c33[_0x4d6642(0x397,0x353,0x30e,0x3c4)+_0x31f0f1+_0x4d6642(0x40a,0x385,0x383,0x3f7)])));}}else _0x4b6604['eSibV'](typeof _0x5f5703,_0x4b6604[_0x4d6642(0x2e4,0x31b,0x27e,0x346)])&&_0x4b6604['OnhxF'](addLog,_0x166fcc(0x323,0x3bb,0x2e9,0x2b7)+_0x4d6642(0x2ff,0x2c7,0x281,0x2d7)+_0x4d6642(0x2f6,0x33a,0x27b,0x2b6)+_0x4d6642(0x410,0x45e,0x45c,0x404)+_0x4d6642(0x338,0x318,0x322,0x2a5));}else _0x556a97=!![];}if(!_0x305159)throw new Error(_0x4b6604[_0x166fcc(0x2a2,0x311,0x23d,0x2dc)]);return _0x4b6604[_0x4d6642(0x2fa,0x348,0x30c,0x2d1)](addLog,_0x4b6604[_0x4d6642(0x368,0x369,0x2d3,0x349)]),{'image':_0x305159,'change':_0x4b6604[_0x166fcc(0x2b1,0x29a,0x27e,0x303)](_0x1e6fde,'')};}else _0x20edbe['on'](_0x4f134f[_0x4d6642(0x3c7,0x40d,0x33c,0x3fb)+_0x4d6642(0x320,0x3a1,0x365,0x2ee)+'ST'],_0x26f34d),_0x57f063['forEach'](_0x41fb7c=>{_0x5edb82['on'](_0x41fb7c,_0x1417ed);}),_0x5e204f(_0x4b6604[_0x4d6642(0x351,0x3bd,0x2d1,0x356)]);}catch(_0x586a01){_0x4b6604[_0x4d6642(0x367,0x3bc,0x352,0x2d1)](addLog,_0x166fcc(0x2bd,0x32f,0x2ae,0x323)+_0x166fcc(0x33f,0x3b2,0x3a4,0x3be)+':\x20'+_0x586a01['message']),console[_0x166fcc(0x38d,0x308,0x398,0x3df)](_0x4b6604[_0x4d6642(0x324,0x339,0x33d,0x32c)],_0x586a01);throw _0x586a01;}}export async function bananaGenerate(_0x207e0e){const _0x20d160={'amjQv':function(_0x634e66,_0x3521c4){return _0x634e66+_0x3521c4;},'yQQqx':function(_0x3d05b2){return _0x3d05b2();},'mgPBi':_0x9f8dab(0x3f3,0x47a,0x4a1,0x4a7),'bTFvS':function(_0x4d4649,_0x3e24c3){return _0x4d4649(_0x3e24c3);},'cYlrp':function(_0x29256a,_0x492e2b){return _0x29256a!=_0x492e2b;},'vTFAW':function(_0x3bf2d5,_0x51a27c){return _0x3bf2d5!==_0x51a27c;},'uSIWA':_0x5aff93(0x5ec,0x617,0x58b,0x634),'LaZRm':function(_0x69e95,_0x2ffb8a,_0x57d2e0,_0x581c38){return _0x69e95(_0x2ffb8a,_0x57d2e0,_0x581c38);},'BEMKR':function(_0x25b16f,_0x296530){return _0x25b16f(_0x296530);},'mlUpL':function(_0x4bfe0d,_0x5388a3){return _0x4bfe0d(_0x5388a3);},'Qpakm':_0x5aff93(0x531,0x4b9,0x4dd,0x58a)+_0x9f8dab(0x466,0x40d,0x3d5,0x414)+_0x9f8dab(0x499,0x43f,0x486,0x415),'Izsys':function(_0x16a885,_0x4046ee){return _0x16a885(_0x4046ee);}};_0x20d160['yQQqx'](clearLog);let {id:_0x413864,prompt:_0x135585,width:_0x3be6ce,height:_0x3d47d3,change:_0x400b8f,retouchPrompt:_0x2f1ed6,retouchImage:_0x1c2414}=_0x207e0e;function _0x5aff93(_0x396f97,_0x21157c,_0x45d764,_0x311f7e){return _0x1d39(_0x396f97-0x3c4,_0x311f7e);}addLog(_0x9f8dab(0x4ee,0x48d,0x45e,0x4ec)+'eceived\x20im'+'age\x20genera'+_0x9f8dab(0x409,0x434,0x4af,0x3cc)+_0x9f8dab(0x560,0x4fd,0x50d,0x548)+_0x413864+')');let _0x56a96d='';function _0x9f8dab(_0x345725,_0x382f3c,_0x1f0da9,_0x40b446){return _0x1d39(_0x382f3c-0x2b8,_0x345725);}_0x400b8f?_0x56a96d=_0x400b8f['replaceAll'](_0x20d160['mgPBi'],''):_0x56a96d=_0x135585;if(_0x400b8f&&_0x400b8f[_0x5aff93(0x59a,0x508,0x54a,0x5ee)](_0x20d160[_0x5aff93(0x5c1,0x558,0x5c5,0x60b)])){addLog(_0x5aff93(0x576,0x57d,0x55f,0x5b7)+'启动');if(_0x2f1ed6)_0x20d160[_0x9f8dab(0x51c,0x51c,0x554,0x541)](addLog,'修图指令:\x20'+_0x2f1ed6);if(_0x1c2414)addLog(_0x9f8dab(0x538,0x527,0x530,0x4c3)+']');}try{const {image:_0x318d2e,change:_0x3594de}=await _0x20d160[_0x9f8dab(0x4ca,0x51c,0x4b0,0x588)](generateBananaImage,{'prompt':_0x135585,'width':_0x3be6ce,'height':_0x3d47d3,'change':_0x400b8f,'retouchPrompt':_0x2f1ed6,'retouchImage':_0x1c2414});if(_0x20d160[_0x9f8dab(0x4aa,0x4f9,0x514,0x47c)](extension_settings[extensionName][_0x9f8dab(0x47b,0x4b1,0x481,0x462)],'0')){if(_0x20d160[_0x9f8dab(0x4d1,0x525,0x51d,0x50b)](_0x20d160[_0x9f8dab(0x402,0x488,0x45f,0x419)],_0x20d160[_0x5aff93(0x594,0x55d,0x619,0x60b)]))_0x1f49ea=_0x20d160['amjQv'](_0x5e9626,_0x55766d);else{const _0x5f0e92={};_0x5f0e92['change']=_0x56a96d,await _0x20d160[_0x5aff93(0x546,0x4ba,0x56f,0x5b4)](setItemImg,_0x135585,_0x318d2e,_0x5f0e92),_0x20d160['BEMKR'](addLog,_0x5aff93(0x582,0x52b,0x55c,0x557)+'or\x20prompt:'+'\x20'+_0x135585),extension_settings[extensionName][_0x5aff93(0x539,0x58c,0x599,0x4fc)][_0x5aff93(0x532,0x534,0x571,0x5c5)]?(extension_settings[extensionName][_0x9f8dab(0x4aa,0x42d,0x49e,0x3e6)][_0x5aff93(0x532,0x4c7,0x4b5,0x57c)]=extension_settings[extensionName][_0x9f8dab(0x3cb,0x42d,0x478,0x450)][_0x9f8dab(0x40b,0x426,0x4ad,0x413)]+(-0x2f9*-0x7+0x1e3+-0x16b1*0x1),addLog(_0x9f8dab(0x3bd,0x438,0x3b3,0x45b)+_0x5aff93(0x5d1,0x539,0x551,0x5a1)+extension_settings[extensionName][_0x5aff93(0x539,0x4c4,0x593,0x4ce)][_0x9f8dab(0x487,0x426,0x3db,0x40a)])):(extension_settings[extensionName][_0x9f8dab(0x47a,0x42d,0x4ac,0x3f4)]['cishu']=-0x2658+-0x1*-0x2433+0x226,_0x20d160[_0x9f8dab(0x480,0x423,0x3e9,0x3ec)](addLog,_0x9f8dab(0x43a,0x438,0x3eb,0x3e0)+_0x5aff93(0x5d1,0x54b,0x641,0x580)+extension_settings[extensionName][_0x9f8dab(0x453,0x42d,0x488,0x485)][_0x9f8dab(0x48c,0x426,0x3e0,0x44a)]));}}else _0x20d160[_0x5aff93(0x54c,0x56e,0x5a8,0x51b)](addLog,_0x5aff93(0x5d2,0x5db,0x578,0x63b)+'库');const _0x79a5f6={};_0x79a5f6['id']=_0x413864,_0x79a5f6['success']=!![],_0x79a5f6['imageData']=_0x318d2e,_0x79a5f6[_0x9f8dab(0x564,0x4d3,0x483,0x4df)]=_0x135585,_0x79a5f6[_0x9f8dab(0x406,0x417,0x432,0x421)]=_0x56a96d,eventSource[_0x5aff93(0x5fb,0x66a,0x5be,0x583)](EventType[_0x5aff93(0x5f5,0x5d6,0x5cf,0x628)+'MAGE_RESPO'+_0x5aff93(0x55b,0x53c,0x501,0x5df)],_0x79a5f6);const _0x536d32={};_0x536d32['id']=_0x413864,_0x536d32['success']=!![],_0x536d32[_0x9f8dab(0x491,0x4da,0x4e6,0x54a)]=_0x318d2e,_0x536d32[_0x5aff93(0x5df,0x59b,0x618,0x596)]=_0x135585,_0x536d32[_0x5aff93(0x523,0x499,0x492,0x5b9)]=_0x56a96d,eventSource[_0x9f8dab(0x577,0x4ef,0x4ee,0x4d9)](_0x20d160[_0x9f8dab(0x3c7,0x433,0x44f,0x4af)],_0x536d32),_0x20d160[_0x5aff93(0x5dc,0x5da,0x56c,0x548)](addLog,'[Banana]\x20E'+_0x5aff93(0x5c3,0x610,0x618,0x578)+_0x9f8dab(0x453,0x451,0x3cd,0x417)+_0x5aff93(0x5bf,0x5b1,0x619,0x614)+':\x20'+_0x413864);}catch(_0x20ec3b){const _0x3754e9=_0x5aff93(0x5e1,0x622,0x597,0x640)+_0x9f8dab(0x4dc,0x4f4,0x4ca,0x49c)+_0x9f8dab(0x553,0x500,0x569,0x46d)+_0x9f8dab(0x500,0x4d7,0x4ea,0x4be)+_0x413864+':\x20'+_0x20ec3b['message'];addLog(_0x3754e9),console[_0x9f8dab(0x4aa,0x4f7,0x547,0x503)](_0x3754e9);const _0x1c9bf3={};_0x1c9bf3['id']=_0x413864,_0x1c9bf3[_0x9f8dab(0x4c9,0x4a6,0x4f7,0x4c9)]=![],_0x1c9bf3[_0x5aff93(0x603,0x5fd,0x657,0x61b)]=_0x20ec3b[_0x5aff93(0x62c,0x678,0x699,0x61d)],_0x1c9bf3['prompt']=_0x135585,eventSource['emit'](EventType[_0x9f8dab(0x521,0x4e9,0x4c5,0x4b0)+_0x9f8dab(0x50d,0x492,0x421,0x4b0)+_0x9f8dab(0x4d9,0x44f,0x4b6,0x43d)],_0x1c9bf3);const _0x34c2d0={};_0x34c2d0['id']=_0x413864,_0x34c2d0[_0x5aff93(0x5b2,0x594,0x636,0x5a7)]=![],_0x34c2d0[_0x5aff93(0x603,0x595,0x613,0x5ca)]=_0x20ec3b[_0x5aff93(0x62c,0x5b2,0x66d,0x653)],_0x34c2d0[_0x9f8dab(0x43c,0x4d3,0x48f,0x4b4)]=_0x135585,eventSource[_0x5aff93(0x5fb,0x5f1,0x647,0x64c)](_0x20d160[_0x5aff93(0x53f,0x5d1,0x4df,0x4fa)],_0x34c2d0),_0x20d160[_0x9f8dab(0x456,0x4d0,0x4a6,0x44e)](addLog,_0x9f8dab(0x494,0x46b,0x3df,0x49c)+_0x5aff93(0x630,0x64a,0x5d0,0x643)+_0x9f8dab(0x4a2,0x448,0x43f,0x43e)+_0x5aff93(0x5bf,0x5e9,0x5b8,0x5af)+':\x20'+_0x413864);}}const LEGACY_EVENT_NAMES=[_0x49b344(0x146,0x3f,0x9f,0xba)+'mage-reque'+'st',_0x49b344(0x103,0x19b,0x143,0x16d)+_0x18000b(0x4f8,0x577,0x52a,0x56f)+'st'];function initializeBananaListener(){const _0x1975a0={'LMmuI':function(_0x564e3a,_0x4d6f46){return _0x564e3a!==_0x4d6f46;},'uqFUB':_0x9cf359(-0xb8,-0x120,-0xf6,-0x5c),'dJKSg':function(_0x51753c,_0x1fe703){return _0x51753c(_0x1fe703);},'Klgjq':'banana\x20生图事'+_0x5045ca(-0xcc,-0xb0,-0x6b,-0x82)};function _0x9cf359(_0x444baa,_0x4d7bf7,_0x11f26f,_0x25dcdc){return _0x49b344(_0x444baa-0xfb,_0x25dcdc,_0x11f26f-0x1c4,_0x444baa- -0x1dc);}eventSource['on'](EventType[_0x5045ca(-0x68,-0x81,-0x4b,-0xa7)+_0x5045ca(-0x1b3,-0x128,-0x1a3,-0x19a)+'ST'],bananaGenerate);function _0x5045ca(_0x3465aa,_0x1d53cb,_0x445c59,_0x3a67ec){return _0x18000b(_0x3465aa-0x4d,_0x445c59,_0x1d53cb- -0x5e7,_0x3a67ec-0xb);}LEGACY_EVENT_NAMES[_0x5045ca(-0x196,-0x151,-0xd7,-0x185)](_0x540ce5=>{function _0x369735(_0x24a880,_0x4a1f9e,_0x571cea,_0x5ab19d){return _0x5045ca(_0x24a880-0x1ec,_0x5ab19d-0x360,_0x24a880,_0x5ab19d-0x1a2);}const _0x55245f={'LtDOD':function(_0x1637b3){return _0x1637b3();}};function _0x5e28fc(_0x4dcb76,_0x1de532,_0x38e4e9,_0x5a0d1d){return _0x9cf359(_0x1de532-0x2a7,_0x1de532-0x1ad,_0x38e4e9-0x49,_0x5a0d1d);}_0x1975a0['LMmuI'](_0x1975a0['uqFUB'],_0x1975a0[_0x5e28fc(0x1dd,0x25f,0x2aa,0x2c4)])?(_0x182ffd[_0x5e28fc(0x124,0x1bc,0x1ee,0x243)+'BananaList'+_0x5e28fc(0x18b,0x1d9,0x14f,0x181)]=!![],_0x55245f['LtDOD'](_0x3b5958)):eventSource['on'](_0x540ce5,bananaGenerate);}),_0x1975a0['dJKSg'](addLog,_0x1975a0['Klgjq']);}export async function replaceWithBanana(){function _0x5ddbbe(_0x250c72,_0x38370e,_0x547089,_0x1f4c01){return _0x18000b(_0x250c72-0x1ed,_0x250c72,_0x1f4c01- -0x7e,_0x1f4c01-0x1d7);}const _0x1fa523={'thWPT':'image_url','YpuDm':'WuJwy','abuUy':function(_0x428011){return _0x428011();},'qGSPo':function(_0x4a304f,_0x2fdbcc){return _0x4a304f===_0x2fdbcc;},'qYfQp':function(_0x83e256,_0x2b17bc){return _0x83e256(_0x2b17bc);},'UwNxu':_0x24db31(0x348,0x2f1,0x2f9,0x2d9)+_0x5ddbbe(0x413,0x454,0x435,0x45d)};function _0x24db31(_0x24e4c9,_0x5e6b21,_0x3ba049,_0x22de4c){return _0x49b344(_0x24e4c9-0x3,_0x24e4c9,_0x3ba049-0x15b,_0x5e6b21-0x220);}if(extension_settings[extensionName][_0x5ddbbe(0x58c,0x4b2,0x4f3,0x52a)]==_0x24db31(0x263,0x2e2,0x301,0x37b)){if(!window['initialize'+_0x5ddbbe(0x424,0x43d,0x3c4,0x431)+'ener']){if(_0x24db31(0x378,0x3a6,0x3ed,0x321)!==_0x1fa523[_0x5ddbbe(0x512,0x517,0x4fa,0x4c8)])window[_0x24db31(0x2d5,0x311,0x330,0x2dc)+_0x5ddbbe(0x40a,0x423,0x470,0x431)+_0x24db31(0x2ec,0x32e,0x37a,0x3b5)]=!![],_0x1fa523[_0x5ddbbe(0x563,0x4cf,0x56e,0x4e0)](initializeBananaListener);else{const _0xacb41a={};_0xacb41a['url']=_0x589145;const _0x38c442={};_0x38c442[_0x24db31(0x35a,0x365,0x2f6,0x335)]=_0x1fa523[_0x5ddbbe(0x44d,0x4d0,0x3c5,0x454)],_0x38c442[_0x5ddbbe(0x47f,0x498,0x43f,0x41d)]=_0xacb41a,_0x13c5dd[_0x24db31(0x373,0x31e,0x340,0x323)](_0x38c442),_0x26e898('[Banana]\x20修'+_0x24db31(0x2b0,0x2bf,0x2f2,0x319)+'的图片');}}_0x1fa523[_0x24db31(0x352,0x396,0x3bd,0x40d)](initializeImageProcessing);}else _0x1fa523[_0x24db31(0x29d,0x2c8,0x314,0x2ef)](_0x5ddbbe(0x4e5,0x4c5,0x487,0x494),_0x24db31(0x388,0x37f,0x3b2,0x3a5))?_0x97aa1f['on'](_0x3ed681,_0x1b7139):window[_0x24db31(0x3a6,0x311,0x336,0x2a9)+_0x24db31(0x264,0x2e7,0x31f,0x277)+_0x24db31(0x2e4,0x32e,0x351,0x2e6)]&&(eventSource[_0x24db31(0x38b,0x3a5,0x312,0x3aa)+_0x5ddbbe(0x4bc,0x417,0x4c6,0x478)](EventType[_0x5ddbbe(0x570,0x536,0x524,0x4e8)+_0x5ddbbe(0x468,0x3d9,0x49d,0x441)+'ST'],bananaGenerate),LEGACY_EVENT_NAMES[_0x24db31(0x25a,0x2ce,0x2d0,0x280)](_0x339f61=>{eventSource['removeList'+'ener'](_0x339f61,bananaGenerate);}),window[_0x24db31(0x2b1,0x311,0x38e,0x2d7)+'BananaList'+'ener']=![],_0x1fa523[_0x5ddbbe(0x480,0x583,0x49a,0x4fa)](addLog,_0x1fa523['UwNxu']));}