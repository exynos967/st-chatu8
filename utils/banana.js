(function(_0x413ca7,_0x241b8a){function _0x16ee00(_0x1948e1,_0x50d4ac,_0x26b69f,_0xaf6fe5){return _0x4c7e(_0xaf6fe5- -0x66,_0x1948e1);}const _0xf9b882=_0x413ca7();function _0x24d18d(_0x12258e,_0x156ed3,_0x49c2ab,_0x426a5f){return _0x4c7e(_0x49c2ab- -0x172,_0x426a5f);}while(!![]){try{const _0x5d9e2f=-parseInt(_0x24d18d(-0x68,-0x84,0x14,0x6b))/(0x73*0x25+-0xa5+-0xff9)+parseInt(_0x16ee00(0xe8,0x172,0x10d,0x139))/(-0x1dae+-0x1*0x16b8+-0x2*-0x1a34)+-parseInt(_0x24d18d(0x92,-0x9e,0x2f,0xce))/(0x14*0x4b+-0x9*-0x19d+-0x145e)*(parseInt(_0x16ee00(0x10e,0x118,0x282,0x1db))/(0x26dc+-0x1*0x3be+-0x231a))+-parseInt(_0x16ee00(0x281,0x34c,0x216,0x297))/(0x3*0xbf7+0x1*-0x1f3a+-0x4a6)*(-parseInt(_0x16ee00(0x2bb,0x32a,0x226,0x275))/(0xf17*0x2+0xcd6+-0x2afe))+parseInt(_0x24d18d(0x62,0x116,0xc0,0x61))/(0xf2+-0x1d7b*-0x1+-0x511*0x6)+-parseInt(_0x24d18d(0x12c,0x71,0x86,0x137))/(0x2275+0x1a0c+-0x3c79)*(parseInt(_0x24d18d(0x251,0x1a5,0x1a3,0x1a9))/(0x23d3+0x46*0x2f+-0x30a4))+-parseInt(_0x24d18d(0x155,0x12d,0x149,0x7d))/(-0x113*0x1f+-0xe43+0x2f9a);if(_0x5d9e2f===_0x241b8a)break;else _0xf9b882['push'](_0xf9b882['shift']());}catch(_0x3035a7){_0xf9b882['push'](_0xf9b882['shift']());}}}(_0x4314,-0x43f18+0x71386+-0xb*-0x1029f));const _0x47ca00=(function(){const _0x2acb9e={};_0x2acb9e[_0x4f694a(-0x21,0xa4,-0xe9,0x66)]=_0x4f694a(-0x73,-0x8e,0x20,0x45),_0x2acb9e[_0x4f694a(-0xe2,-0x1e,-0xe8,-0x147)]=function(_0x5a5484,_0x396fb7){return _0x5a5484===_0x396fb7;};function _0x3c96d1(_0x14865e,_0x29b904,_0x474324,_0x1f04e5){return _0x4c7e(_0x29b904-0x340,_0x14865e);}_0x2acb9e[_0x3c96d1(0x4e9,0x5a5,0x4d5,0x4e4)]=_0x3c96d1(0x5d5,0x58f,0x60e,0x519),_0x2acb9e[_0x4f694a(0x1a,-0x73,0xdc,0x7e)]=_0x4f694a(-0x68,-0xaf,-0x128,-0x105);const _0x38f807=_0x2acb9e;let _0x31e16d=!![];function _0x4f694a(_0x52e0c2,_0x261b99,_0x2ea09b,_0x44502b){return _0x4c7e(_0x52e0c2- -0x278,_0x2ea09b);}return function(_0xe983e3,_0x5df748){function _0x39ad46(_0x496e6d,_0x2351a7,_0x4987ad,_0x462bdd){return _0x3c96d1(_0x4987ad,_0x462bdd- -0x62b,_0x4987ad-0x185,_0x462bdd-0x1);}function _0x5df949(_0xc78f49,_0x2c5011,_0x585dda,_0x3c9ec1){return _0x4f694a(_0x3c9ec1-0x106,_0x2c5011-0xa8,_0x585dda,_0x3c9ec1-0x1df);}if(_0x38f807[_0x5df949(0xf7,-0x65,0x18,0x24)](_0x38f807[_0x39ad46(-0x35,-0x7b,-0x126,-0x86)],_0x38f807['eMmfW'])){const _0x3e4347={};_0x3e4347[_0x5df949(-0x37,0xd9,0x63,0x1f)]=_0x38f807[_0x5df949(0x19,0xf4,0x85,0xe5)],_0x3e4347[_0x39ad46(0x45,0x8,0xb4,0x1f)]=_0x44ce5b,_0x2763e0['push'](_0x3e4347);}else{const _0x162396=_0x31e16d?function(){function _0x48779b(_0x1c4069,_0x20adbe,_0x1544d0,_0x5ef221){return _0x39ad46(_0x1c4069-0x112,_0x20adbe-0x1e4,_0x1544d0,_0x1c4069-0x4b6);}if(_0x5df748){const _0x431f3e=_0x5df748[_0x48779b(0x490,0x45a,0x55f,0x3e8)](_0xe983e3,arguments);return _0x5df748=null,_0x431f3e;}}:function(){};return _0x31e16d=![],_0x162396;}};}()),_0xdf9982=_0x47ca00(this,function(){function _0x410adc(_0x457c60,_0x3524c5,_0x277915,_0x580600){return _0x4c7e(_0x277915-0x199,_0x457c60);}function _0xecd808(_0x1be40c,_0x1f2d42,_0x48b195,_0x5b3b7b){return _0x4c7e(_0x5b3b7b-0x2f9,_0x1be40c);}return _0xdf9982[_0x410adc(0x481,0x425,0x432,0x4a9)]()[_0x410adc(0x475,0x3bc,0x459,0x4c9)]('(((.+)+)+)'+'+$')[_0x410adc(0x37a,0x39b,0x432,0x43e)]()[_0xecd808(0x4c3,0x45c,0x562,0x4d5)+'r'](_0xdf9982)[_0x410adc(0x499,0x3dd,0x459,0x3a9)](_0xecd808(0x48e,0x456,0x53c,0x484)+'+$');});_0xdf9982();import{extension_settings}from'../../../../extensions.js';import{eventSource}from'../../../../../script.js';import{extensionName,EventType}from'./config.js';import{sleep,generateRandomSeed,zhengmian,fumian,getRequestHeaders,prompt_replace,addLog,clearLog,parsePromptStringWithCoordinates,prompt_replace_for_character,stripChineseAnnotations}from'./utils.js';import{initializeImageProcessing}from'./iframe.js';import{processCharacterPrompt}from'./characterprompt.js';import{setItemImg}from'./database.js';import{getConfigImage}from'./configDatabase.js';function _0x4314(){const _0x2f8b8c=['Ew5Ry1y','DhLWzq','5l+U5zU+5zU+54MhoIbB5BEY5O+q5l6B','yMfUyw5HioEuN+wBVUs6IW','w0jHBMfUyv0GrG','svvsDhO','AhfrqLm','5zon5BQuicHjrdOG','w0jHBMfUyv0G5l+U','sMnutuW','zYbvuKWUlI4','Du9trgK','zxiG','t1Drswm','D2L0AcbWCM9TCa','ig1LC3nHz2vZlG','igLTywDLlG','C3qGkeLeoIa','AgHWthe','z1vOt3y','E+s/RUwBVN0','tufhrv9srvfvrq','runYuvG','z2uGzM9YBwf0la','CMvWBgfJzufSBa','Bwf0y2G','kerPDMLKzv9YBW','BgDzwMG','Aw1Hz2u','ywLSzwqGDg8GzG','t0HSsei','BKHYrvq','vMXpBNy','zNPwy1i','ywn0zxjqCMvZzq','zw5KAw5NihjLCq','renXsxC','DgjkDNK','AxvksxC','AxrOihn0yxr1CW','zxnWB25ZzsbJBW','55sO55U05O6L6k+35Rgc5QIH5BYp','CgfYyw1LDgvYCW','yMfZzty0lG','AML1z3vHBG','qMvHCMvYia','zxrJAcbLCNjVCG','wfHODxe','r2H6wxi','rgXcELK','v2j5q0e','v29lB2K','swLPA0i','BgvUz3rO','ue9tva','C3DjExm','DurtBum','mNWZFdf8nhWW','5PIV5zcM5zcV55sO5yIg6kEs6iMY5QIH5BYpia','r0fxtMK','yvHZuLG','DxnLCG','l3yX','DNnOqMO','Cg9ZDgzPEfbYBW','w0jHBMfUyv0G5y+w','CvzgyMu','zKjkwNe','whPjCK8','5Qch5yEg5QIH5BYpoIdKVB/NLkJOR7FMSyi','DgHoqKC','D1DZyuC','q2HHCMfJDgvYia','we1SAMW','DcbVBMX5lcbUBW','l3yXyMv0ys9TBW','y2HHDf9JB21WBa','55sO5l+U5zU+6Ake6k6+oIaI','zu1TzLC','EgriuvO','t25wC1i','zMLKuuG','C3rYAw5NAwz5','ChzvCuy','rw10z2G','Dg9tDhjPBMC','CgXNAwK','BLHHu2e','turPwMO','zMXHDa','DgLVBIb3AxrOia','AwzTEfq','w0jHBMfUyv0Gvq','weP4Cxu','vxrzwgu','55sO5lQgihVKV67LM759ioAGH+IVHG','C3rFy2HHDhu4xW','B21mu2u','C3rHCNrZv2L0Aa','Bw9Kzq','ve15suC','we90zfe','z0rhANq','DhjPBq','55Qe5zU+54Mh','y29UDMvYC2f0Aq','C3vIC3rYAw5N','qMnituq','EMDMrvq','5lU255Ur5zcS5zMO5BEY5yID5AEl5yYw44cc','y2fUy2vSx2jHBG','Aw1Hz2vU','DwLSDcbjBwfNzq','r1PAzxK','Dez0tgu','uffQDMu','AuPKzLy','C1Dewxa','mNWWFdf8nhWZ','odu5mdiWwMPtDfz6','Aw9U','qu12A3e','ywrKvgfZAW','u2nLBMuGq29TCa','C2vHCMnO','C2uGzgLKig5VDa','BwfNzsbPBIbpCa','l2fWAs9IywnRzq','BNjbD3y','yxbWBhK','D1zWDuK','5PYa5zco572U','rfrkB1q','zuPVCxO','vxfkqMW','y0jwweW','BwfNzsbNzw5LCG','5l+U5zU+5OYh5lUKoIa','Ehnyswi','w0jHBMfUyv0G5Ps2','y2LZAhu','yxbWBgLJyxrPBW','Cevvzu4','C2fTCgXLq291BG','w0jHBMfUyv0Gua','w0jHBMfUyv0G5l2/','C3rHDhvZ','BwL0DgvKihn1yW','DKDfBwK','CMvHzefZrgf0yq','BKfgrfq','mtjTCMr1rxi','CxLKsxK','uw9tD08','r0vorvjbvevFsq','Aw9UoIaIqMvHCG','zgf0ytPPBwfNzq','q1fhuwy','yMfUyw5H','5zU+5QIH5BYp77YA5OYh5lUKid0G','5yMn572U5yMn','A0HMwfy','BNrHAw5ZihrLEa','55sO6yws6AAg5lUJ55cg5QIH5BYp','shjXs08','5yIW5y+w5RAi5lU75yQH5lQl5lU2icHu','tgvpveW','y2HVAwnLCW','swPRruq','EgT6Age','BwfNzw4G5QIH5z6l5lIn5PsV','B21WBgv0Aw9UCW','y2HHBMDL','B25LCNjVCG','t2XrD1m','Au1WB1u','wKLYsgu','rxPJvMi','w0jHBMfUyv0Grq','AeH1twe','rfrHANi','DhbzyuC','5RAi5B2t5yMn5lU75yQH77Ym5y+r6ycb5AsX6lsL','5zco572U5zco','CNvbDuu','ndm0mZK5nvzbELjxDW','CLfACeq','DcbvuKWGyxmGzG','qvbjihjLCxvLCW','Bw9KzwW6ia','CgnJthq','DKLXDvu','C3vJy2vZCW','DwvZDcb0BZOG','u3jXrKW','Ce5Mugm','y3vZDg9Tx2LUyW','rKDgyNG','y29UDgvUDa','A0XNuLq','yxrLzcbZDwnJzq','teDisK8','y3vLv1G','EuTfy1O','zcbnyxjRzg93BG','Aw5PDgLHBgL6zq','yw5Hx3rHC2S','wKDIDMm','BwvZC2fNzq','mZy1ngTAwuv6qG','zxjYB3i','zxrPB25FC291CG','vKjzqM4','BxD5qxe','ywHxA2S','mNW0Fdb8mxWZ','zxrLy3rLzcbnyq','vNDWrM4','CMr0t1K','B3iGChjVBxb0oG','q29UDgvUDc1uEq','igv4DhjHy3rPBG','CfnKuNm','A1fYBfG','BgvZktOG','ue9ts00','wgnWtgG','C2v0ici','B2fKihDPDgGG','qxrMtuu','A1L3Bgm','CMvWBgfJzq','yxLSB2fKoIa','ztOG','zw5LCG','tLnf','yxnRsuq6ia','A0HuD2G','D2Pus1O','wK96sKy','w0jHBMfUyv0GuG','5B2t5yMn55sF5zU+5QYH5PwW5lI6igzV','AM9PBG','mte0mZi3C2D2q295','5zU+5QIH5BYp77YA5BEY5RE75yQG5B6f5l+U5Ps5','BI9QC29U','5yMn572U5zco','B3DUigLTywDLoG','kcGOlISPkYKRkq','5yIg6kEs6iMY5QIH5BYpoIdOP6pMNPdLUky','Bw9KywWGCgf5Ba','rurUu2C','ChHMzuW','BIbWyxLSB2fKia','CM9Szq','5lU75yQH5BEY5y+w5RAi','qMfUyw5H5l+U5zU+5QIH5BYp','5zco572U5yMn','y3vZDg9Tx3vYBa','rwHOs3q','5O6L6k+35Rgc','w0jHBMfUyv0Gra','ww9zs0e','wgvtAg8','sNHYuxe','DhjPz2DLCNm','zwnLAxzLzcbPBq','ywDLifvstdOG','mtKZnZeXmeDyzKXlsW','5z2q5Qch55Qe5O+q56s66k+n5A2x56YM5lIY44cc','m2zLuwroAq','CMvZDwX0','lcdPQ5JLUQyGlsa','Cwjrs1q','sMXKz3a','ENrIwwW','u2Hhtuq','DxjS','CMffvhG','sgniB3i','zw5LCMf0Aw9Uia','C3bSAxq','Cfr6D1G','DdOG','y3vZDg9T','wgfTsKS','r0vHqKi','t2HQC0W','CxfbrhG','BMrjBLy','w0jHBMfUyv0G55sF','ELDqrKO','BKPezue','ALrjC2C','zMLSDgvY','DxbKyxrLu3rHDa','rw16vvC','wNPnwxm','vvjm','CKXcs3O','l3yXlW','Aw9Hsei','5zU+5yop5BEY5A2y5ywL5PwW5O2U5BQtigy','BNnLigzVCIbjra','ywXSyMfJAY4','thrJEeO','l2DLBMvYyxrL','qKfoqu5b','Euv1EwS','ifbYB21WDa','C0nSAgS','Dgv4Da','BMvwAgC','CeHWr2q','rvfTCeC','u3H2uhC','Dunuq1a','q01Rs1u','BLnKtxC','Dxflvwe','tNfprNe','sxbPEwW','ChjVBxb0','zM9YrwfJAa','tufhrv9srvnqtW','rMPsve8','B3vUzcbTyxrJAa','D2PAALG','Dg9Rzw4','y29UC3rYDwn0BW','q05quvi','w0jHBMfUyv0GuW','Aw1Hz2vFDxjS','lI4U','w0jHBMfUyv0Gsq','ywDJt0e','B2HiwLm','q1LSvLu','BMzPzeW','5zU+5Rwb56Il44cc5A6I5OI356UV5lI6','tLbSB24','yMfUyw5Hq2HHCG','Aw5JBhvKzxm','mNWWFdf8m3W0','zML4zwrqCM9TCa','ANnVBG','qKHjsNa','ve5Wz3m','sfPcChC','w0jHBMfUyv0GqG','Aw5NihrYAwDNzq','qu1Yvfq','uLblze8','rMfPBgvKihrVia','B25SB2fKzw5K','5OYb6yws6AAg5lUJ55cg77Ym5yIh5O2I5lI655U0','BwL0DgvKigzHAq','mtKXmdrsz1vwDha','y29KAgC','tKfSuxi','v1HVDNC','Bw9KzwW','zw5KC1DPDgG','zw1PDa','r0DWExu','55sO5lQo55sF5OIq55QevgfNoIa','wuftBue','CfjHu0y','zMLnyvm','D2vTy3a','yxnZAxn0yw50','5BYa5AEliejHBMfUyEEuNW','ChvZAa','t2fsr3y','zgvSCY8','5zU+5lQl5lU255Ur5zcS5zMO5BEY5ywZ6zET44cc','DKDbBKW','yxnWzwn0uMf0Aq','q0L6D3e','w0jHBMfUyv0G5zcV','B3nPDgLVBG','CMfUBhi','BhvYzsbYzxnWBW','zhLmufC','DwnJzxnZzNvSBa','uMvIrhm','sMrvtwW','qKzcBuO','y2fJAgu','Bxb0','Ew1Uqva','5Q2J6z2I5O+q56s66k+noIa','C3rYzwfT','yM5gEuK','Cgz1y2O','w0jHBMfUyv0GrW','qxb1Cxe','z2Tkzwm','wxvMt3G','z0HZteq','CIbWCM9TChq6ia','A1Hqs1e','zMfPBgvKigzVCG','BhvKzv9OzwfKzq','EgPLwfy','CIaI','D3rXtge','Aw1Hz2vjza','r2Xbuhy','5lIT55QeihbYB21WDooaGG','qMfUyw5HtgLZDa','EsbJB252zxj0zq','BwvZC2fNzxm','zwLpqKu','Aw1Hz2veyxrH','nZmYnJGZmfL2r1jnyW','y29TCgXLDgvuyq','A3viAhi','EerSEfm','BMrZl2nOyxqTyW','se14A3q','C3nMDwXSEs4','CMvTB3zLtgLZDa','tfnVtKe','uKnkB3O','D3PQteu','tvHKs3O','zxrJAcbnyxjRza','qxv0Ag9YAxPHDa','yvjMtKy','nJy3nZqYmfbRuhjfyq','Ag10Agy','Aw5ZDgfUy2vZ'];_0x4314=function(){return _0x2f8b8c;};return _0x4314();}import{taskQueue,TaskType,TaskStatus}from'./taskQueue.js';let currentTaskId=null,currentRequestId=null,currentPrompt=null;async function getImageFromTurnData(_0x2f9dca){const _0x159365={'nSdMw':function(_0x6c5664){return _0x6c5664();},'OWQIc':function(_0x310c98,_0x380d70){return _0x310c98===_0x380d70;},'tpYaG':_0x26bd82(0x2a0,0x37d,0x30b,0x34a),'fidQH':function(_0x22af87,_0x31cb4d){return _0x22af87(_0x31cb4d);},'OHlHB':function(_0x598fb7,_0x3694b6){return _0x598fb7||_0x3694b6;},'XXhuq':_0x26bd82(0x434,0x346,0x4b4,0x3e0),'aXsRX':_0x4f9ac3(0x565,0x5fe,0x6c4,0x626)};if(!_0x2f9dca)return'';if(_0x2f9dca[_0x26bd82(0x260,0x3b5,0x30c,0x32a)]&&_0x2f9dca[_0x4f9ac3(0x5e5,0x5ad,0x52a,0x51a)][_0x4f9ac3(0x58a,0x629,0x56f,0x5f8)]('cfgimg_')){if(_0x159365[_0x4f9ac3(0x572,0x5d4,0x520,0x5c0)](_0x159365[_0x26bd82(0x4c9,0x3fa,0x49c,0x3f9)],_0x26bd82(0x3e2,0x40e,0x457,0x38b)))_0x1e1e25=_0x699f65;else{const _0x16281d=await _0x159365[_0x4f9ac3(0x6b8,0x618,0x57a,0x6f0)](getConfigImage,_0x2f9dca[_0x4f9ac3(0x657,0x5ad,0x525,0x63d)]);return _0x159365[_0x26bd82(0x28a,0x2d5,0x32b,0x362)](_0x16281d,'');}}if(_0x2f9dca[_0x26bd82(0x2d6,0x3fb,0x31c,0x360)]&&_0x2f9dca[_0x26bd82(0x3fa,0x2ef,0x28a,0x360)]['startsWith'](_0x159365[_0x4f9ac3(0x5b5,0x5f6,0x5d2,0x5be)])){if(_0x159365[_0x4f9ac3(0x5cb,0x603,0x675,0x665)]!==_0x159365[_0x4f9ac3(0x5b8,0x603,0x60f,0x559)])!_0x2b4d79[_0x4f9ac3(0x75a,0x694,0x678,0x625)+'BananaList'+_0x26bd82(0x2ad,0x32a,0x200,0x27d)]&&(_0x4e6ae2['initialize'+_0x26bd82(0x3b9,0x3cf,0x269,0x32d)+'ener']=!![],_0x159365[_0x4f9ac3(0x5a8,0x554,0x490,0x4e9)](_0x346a54)),_0x159365[_0x4f9ac3(0x510,0x554,0x5be,0x5f9)](_0xb6ee7f);else return _0x2f9dca['image'];}function _0x4f9ac3(_0x4bc7c2,_0x176be4,_0x320513,_0x44e9c8){return _0x4c7e(_0x176be4-0x383,_0x44e9c8);}function _0x26bd82(_0x38463d,_0x5ba483,_0x12f0ce,_0x118ec6){return _0x4c7e(_0x118ec6-0x100,_0x38463d);}return'';}function _0x4c7e(_0xb43bd9,_0x592a46){_0xb43bd9=_0xb43bd9-(-0x5e*0x11+0x2*0xa67+0x3b*-0x39);const _0x2a3793=_0x4314();let _0x8405b2=_0x2a3793[_0xb43bd9];if(_0x4c7e['ZRWKpU']===undefined){var _0x2cdb9e=function(_0x27eea8){const _0xabe437='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0xc8367a='',_0x1294d2='',_0x5c6d20=_0xc8367a+_0x2cdb9e;for(let _0x1f1194=-0x1a99+0xd*0x13+-0x22*-0xc1,_0xadd721,_0x48f69c,_0x2a727d=-0x24ec+0x5*-0x6d3+-0x470b*-0x1;_0x48f69c=_0x27eea8['charAt'](_0x2a727d++);~_0x48f69c&&(_0xadd721=_0x1f1194%(-0x17f7+0x1*-0x2126+0x3921)?_0xadd721*(0x1483*-0x1+-0x1*-0x13e5+-0x2*-0x6f)+_0x48f69c:_0x48f69c,_0x1f1194++%(0x200a+0x1424+-0x342a))?_0xc8367a+=_0x5c6d20['charCodeAt'](_0x2a727d+(0x75c*-0x1+-0x14bc+-0x1*-0x1c22))-(-0x995+-0x83*-0x7+-0x305*-0x2)!==-0x1b7*0xd+-0x3*0xd1+0x18be*0x1?String['fromCharCode'](-0x2af+0x1919+0x156b*-0x1&_0xadd721>>(-(0x9fb+-0x16a+-0x7*0x139)*_0x1f1194&0x1*0x118e+0x6f5*0x4+-0x2d5c*0x1)):_0x1f1194:-0x2698+-0x5e7*0x5+0x37*0x13d){_0x48f69c=_0xabe437['indexOf'](_0x48f69c);}for(let _0x2f541c=-0xcf5+0x3*0x36d+0x2ae,_0x11ee8b=_0xc8367a['length'];_0x2f541c<_0x11ee8b;_0x2f541c++){_0x1294d2+='%'+('00'+_0xc8367a['charCodeAt'](_0x2f541c)['toString'](-0xeef+-0xd9+-0x68*-0x27))['slice'](-(0x99*-0x5+0x662+0x121*-0x3));}return decodeURIComponent(_0x1294d2);};_0x4c7e['cWcBgB']=_0x2cdb9e,_0x4c7e['NINFFn']={},_0x4c7e['ZRWKpU']=!![];}const _0x258e6e=_0x2a3793[0x267f+0x729+-0x2da8],_0x1ef83f=_0xb43bd9+_0x258e6e,_0x50cc1a=_0x4c7e['NINFFn'][_0x1ef83f];if(!_0x50cc1a){const _0x2a70b2=function(_0xfb82a5){this['tBieYM']=_0xfb82a5,this['opFMJM']=[0x1*0x8cb+-0xc7+-0x803,0xc3b+0x61a*0x2+-0x4e3*0x5,0x19*-0x159+0x243a+-0x289],this['zbTmvM']=function(){return'newState';},this['VTkdUA']='\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*',this['xJiEhS']='[\x27|\x22].+[\x27|\x22];?\x20*}';};_0x2a70b2['prototype']['BQcZuA']=function(){const _0x53ba34=new RegExp(this['VTkdUA']+this['xJiEhS']),_0x25b0c1=_0x53ba34['test'](this['zbTmvM']['toString']())?--this['opFMJM'][-0x1075+-0x12*0x142+0x271a]:--this['opFMJM'][-0xc7a+0x2689*-0x1+0x3303];return this['uchKmH'](_0x25b0c1);},_0x2a70b2['prototype']['uchKmH']=function(_0x5f7b22){if(!Boolean(~_0x5f7b22))return _0x5f7b22;return this['VtXrvq'](this['tBieYM']);},_0x2a70b2['prototype']['VtXrvq']=function(_0x1e719d){for(let _0x41d3df=0x2f1*-0x3+0x1c24*-0x1+0x24f7,_0x295e0d=this['opFMJM']['length'];_0x41d3df<_0x295e0d;_0x41d3df++){this['opFMJM']['push'](Math['round'](Math['random']())),_0x295e0d=this['opFMJM']['length'];}return _0x1e719d(this['opFMJM'][0x49*0x85+-0x1*-0x1f7b+-0x22b4*0x2]);},new _0x2a70b2(_0x4c7e)['BQcZuA'](),_0x8405b2=_0x4c7e['cWcBgB'](_0x8405b2),_0x4c7e['NINFFn'][_0x1ef83f]=_0x8405b2;}else _0x8405b2=_0x50cc1a;return _0x8405b2;}async function generateBananaImage({prompt:_0x4d7b62,width:_0x47b767,height:_0x302eb9,change:_0x29bc60,retouchPrompt:_0x156e93,retouchImage:_0x11fbac}){const _0x13efb3={'UtYXe':_0x45bcad(0x1b6,0xf1,0x25f,0x158),'SxvPw':function(_0x20e2a7,_0x9e9d90){return _0x20e2a7(_0x9e9d90);},'AMrTT':_0x45bcad(0x1db,0x19c,0x144,0x26f),'eiOBE':function(_0x18ecd9,_0x4e4658){return _0x18ecd9||_0x4e4658;},'RPKdO':function(_0x203135,_0x23f7c9){return _0x203135+_0x23f7c9;},'CMkKU':function(_0x1035ec,_0x1ef4f4){return _0x1035ec(_0x1ef4f4);},'vIquU':function(_0x5ae915,_0xcc3ccb){return _0x5ae915+_0xcc3ccb;},'FGFbx':function(_0x2ccc71,_0x47d0a7){return _0x2ccc71+_0x47d0a7;},'zWPFJ':'\x20|\x20','cueWX':'API\x20respon'+_0x45bcad(0x21f,0x251,0x2d9,0x1f0)+'\x20contain\x20i'+_0x24e61e(0x5a7,0x4ed,0x5de,0x531)+'enAI\x20forma'+'t','gDGjt':function(_0x5b215f,_0x224d45){return _0x5b215f+_0x224d45;},'hhpLq':function(_0x470797,_0x5605f5){return _0x470797(_0x5605f5);},'ECrQX':_0x24e61e(0x620,0x563,0x658,0x58a),'hEoUy':_0x45bcad(0x113,0x190,0xd5,0x139)+_0x24e61e(0x515,0x3da,0x3e3,0x479),'CQGQf':'st_chatu8_'+_0x45bcad(0x210,0x2c5,0x202,0x18b)+_0x24e61e(0x61a,0x564,0x4eb,0x581),'EzcVb':function(_0x112c9e,_0x1b9cb5){return _0x112c9e(_0x1b9cb5);},'TMyIG':function(_0x4d7641,_0xd5f25c){return _0x4d7641(_0xd5f25c);},'GAWNi':_0x24e61e(0x56a,0x51e,0x4e1,0x50f)+'sing\x20direc'+_0x24e61e(0x605,0x5ef,0x52a,0x56e)+_0x24e61e(0x366,0x505,0x471,0x432),'pvUqF':_0x24e61e(0x50c,0x383,0x3f7,0x44e),'Jldgp':function(_0x162f26,_0x33b766){return _0x162f26(_0x33b766);},'wtqLa':_0x45bcad(0x1df,0x120,0x122,0x219),'ahWkk':function(_0x42e914){return _0x42e914();},'nrAwv':function(_0x5f06b5,_0x2665be){return _0x5f06b5+_0x2665be;},'yEuyk':_0x45bcad(0x148,0xd4,0x10d,0x167),'ZOzJF':'[Banana]\x20F'+_0x24e61e(0x595,0x455,0x4ee,0x4e1)+':','LtcxJ':function(_0x2d7496,_0x57595a){return _0x2d7496===_0x57595a;},'agcOA':'任务已取消','pccLt':function(_0x2276aa,_0x45aaea){return _0x2276aa+_0x45aaea;},'tbJvy':'applicatio'+_0x45bcad(0xe6,0xfc,0x172,0xec),'FYbua':function(_0x54ccd1,_0x3a828b){return _0x54ccd1(_0x3a828b);},'hHuMa':'iKcnF','qQDmK':_0x45bcad(0x11a,0x52,0x17c,0x1a6),'MRKUo':function(_0x610d52,_0x48eacd){return _0x610d52+_0x48eacd;},'DTajr':function(_0x3bd237,_0x8a44e3){return _0x3bd237||_0x8a44e3;},'ZRmEN':function(_0x2351b7,_0xdf0538){return _0x2351b7>_0xdf0538;},'jTIsg':function(_0x4d3c12,_0x4ee22c){return _0x4d3c12(_0x4ee22c);},'DTJoT':function(_0x4a0e41,_0x38b8c7){return _0x4a0e41(_0x38b8c7);},'OnVsR':function(_0x346a7c,_0x25b61e){return _0x346a7c(_0x25b61e);},'qVFbe':_0x24e61e(0x484,0x49d,0x600,0x52e)+_0x24e61e(0x4a3,0x45b,0x458,0x47e),'CNPQR':function(_0x4d85b3,_0x569c61){return _0x4d85b3===_0x569c61;},'kxWMX':'YYxHN','plgii':function(_0x452521,_0xf219de){return _0x452521(_0xf219de);},'xjeXV':function(_0x2503bf,_0x3a6415){return _0x2503bf!==_0x3a6415;},'fFdGH':'NCgig','JcTML':function(_0x569846,_0x43eb32){return _0x569846(_0x43eb32);},'YoYKA':_0x45bcad(0xea,0x4a,0x1ae,0x30)+_0x45bcad(0xfe,0x134,0x1c4,0x7a),'mwyAq':function(_0x391b15,_0x4b3e7c){return _0x391b15!==_0x4b3e7c;},'KEbCk':_0x45bcad(0x236,0x258,0x1e0,0x288),'uCTCP':function(_0x2e7654,_0x5d23b5){return _0x2e7654+_0x5d23b5;},'GlBbZ':_0x24e61e(0x3dc,0x3f2,0x370,0x3dc),'SmcTv':function(_0x11e9a6,_0x37e0ea){return _0x11e9a6(_0x37e0ea);},'faEwT':_0x24e61e(0x48a,0x599,0x513,0x4f8)+_0x45bcad(0x18a,0x1b1,0xc5,0x212),'TVRrx':function(_0x5875ec,_0x3f462d,_0x2f82fd){return _0x5875ec(_0x3f462d,_0x2f82fd);},'CYlVU':function(_0x3f415e,_0x144cf2){return _0x3f415e<=_0x144cf2;},'iJdfV':function(_0x35c304,_0x209975){return _0x35c304===_0x209975;},'nJDeA':_0x24e61e(0x4fe,0x4a6,0x527,0x45c),'CIzwq':'GVaRv','DedBo':function(_0x11f4d3,_0x1cf3ec){return _0x11f4d3(_0x1cf3ec);},'ioaHB':'eJoqz','HMxkt':_0x45bcad(0x242,0x16a,0x2c3,0x1fd),'QoSwO':_0x24e61e(0x398,0x361,0x436,0x3f8),'pfucj':'后置前','omLSe':'后置后','NAlQr':_0x45bcad(0x225,0x238,0x162,0x2fa),'EQmpG':'/v1/chat/c'+_0x24e61e(0x61d,0x49f,0x5ab,0x55e),'taFUm':_0x24e61e(0x40c,0x3ae,0x548,0x47d)+_0x24e61e(0x551,0x4db,0x5e2,0x512)+'。','wzjLE':_0x24e61e(0x3a7,0x4dc,0x34d,0x422),'UewDE':'VMyLH','HrqKO':_0x45bcad(0x128,0x117,0xfb,0x15f),'Apuqq':_0x24e61e(0x58a,0x4ae,0x5a0,0x56b),'nPyJz':'qshiN','rOnzS':_0x45bcad(0x1c6,0x254,0x207,0x285),'yTdkJ':_0x24e61e(0x509,0x527,0x5fd,0x562),'xkzha':function(_0x3988bd,_0xa1a2e1){return _0x3988bd>_0xa1a2e1;},'eTpTY':'assistant','gHsLD':_0x45bcad(0x10f,0x158,0x96,0xb3),'BFBmJ':_0x45bcad(0x11d,0xdc,0xeb,0x94),'wuJKj':_0x45bcad(0x276,0x27a,0x1e2,0x205),'unGTF':function(_0x90bd53,_0x31f5be){return _0x90bd53+_0x31f5be;},'ifmxT':'avlCc','BBynR':function(_0x383121,_0x4e9f3a){return _0x383121+_0x4e9f3a;},'pNfPc':_0x45bcad(0x1e0,0x22a,0x262,0x293),'pSdRs':function(_0x4b61b2,_0x1b78c8){return _0x4b61b2===_0x1b78c8;},'wUbMT':_0x45bcad(0xd7,0x11c,0x71,0x15b),'wjTKZ':function(_0x387197,_0x557ead){return _0x387197+_0x557ead;},'kQrlX':_0x24e61e(0x546,0x57b,0x46f,0x532)+_0x45bcad(0x194,0x23f,0x131,0x16f)+_0x45bcad(0x24d,0x1b9,0x2be,0x245)+'/generate','XMljl':function(_0x8358b3,_0x13f97b){return _0x8358b3(_0x13f97b);},'GILXO':_0x45bcad(0x10d,0x6c,0xed,0x76),'IURtz':'imagen','NPlon':'eMniD','OWJRR':function(_0x3469a4,_0xdc74a8){return _0x3469a4===_0xdc74a8;},'VbkfC':function(_0x1ec24e,_0xdd109a){return _0x1ec24e(_0xdd109a);},'GhzYr':function(_0x2e4371,_0x153f6b){return _0x2e4371(_0x153f6b);},'ynkcV':function(_0x1b119a,_0x369e1e){return _0x1b119a===_0x369e1e;},'zgfET':_0x24e61e(0x4bf,0x4a3,0x4a0,0x4ac),'KGDdd':'running','sSHEf':function(_0x9444fb,_0x2f27b1,_0x26897d){return _0x9444fb(_0x2f27b1,_0x26897d);},'sWDYp':_0x45bcad(0x1d8,0x10f,0x248,0x28c),'Emtgh':function(_0x8ddde6,_0x3acc2a){return _0x8ddde6!==_0x3acc2a;},'TNpgs':_0x24e61e(0x406,0x449,0x433,0x442),'fiMaS':'sPRvs','IjkED':function(_0xe3f1c9,_0x33f8a7){return _0xe3f1c9>_0x33f8a7;},'WjsLD':_0x45bcad(0x213,0x29e,0x29e,0x213),'vGAnL':_0x45bcad(0x132,0xb4,0x8e,0x1f1),'wVpuI':_0x45bcad(0x127,0x72,0x159,0x76),'aRfNF':function(_0x3a41e5,_0x1f4b50){return _0x3a41e5===_0x1f4b50;},'VlOnv':'string','nXaSa':function(_0x173739,_0x2e060f){return _0x173739!==_0x2e060f;},'bnFyI':_0x45bcad(0x243,0x1c8,0x214,0x176),'iuJIw':_0x45bcad(0xf6,0x15f,0x5b,0x102)+_0x45bcad(0x27a,0x213,0x2f5,0x350)+'rkdown\x20ima'+_0x45bcad(0x1b9,0xfe,0x191,0x177)+_0x45bcad(0xce,0x14,0xad,0x15d)+_0x24e61e(0x517,0x42c,0x54a,0x4bd),'tFtLe':function(_0xd9e934,_0x2adb0b){return _0xd9e934(_0x2adb0b);},'PQjve':'[Banana]\x20S'+_0x45bcad(0x171,0x1eb,0x10b,0x1da)+_0x45bcad(0x18c,0xdf,0x15c,0x1d5)+_0x45bcad(0x26e,0x297,0x303,0x239)+'\x20image\x20to\x20'+_0x24e61e(0x4da,0x5ae,0x4c4,0x4de),'kuHhr':function(_0x31bd8c,_0x4970a6){return _0x31bd8c(_0x4970a6);},'GlAPv':_0x45bcad(0x108,0x50,0x14f,0xe7),'qbQKT':_0x45bcad(0x1d3,0x18e,0x128,0x252),'ORVTW':function(_0x122878,_0x1c2c10){return _0x122878(_0x1c2c10);},'RebDs':'[Banana]\x20R'+_0x24e61e(0x4b0,0x40d,0x460,0x4db)+_0x24e61e(0x52c,0x4ed,0x47e,0x555)+'t\x20only,\x20no'+'\x20image.','xDlxS':'XeSho','neVhg':function(_0x246980,_0x595f28){return _0x246980(_0x595f28);},'hDMOS':_0x24e61e(0x429,0x3b6,0x4f0,0x450)+_0x24e61e(0x5fb,0x480,0x579,0x53b)+_0x45bcad(0x26a,0x28d,0x2e0,0x2d4)+_0x24e61e(0x4b8,0x502,0x51d,0x4a7),'pHpGd':function(_0x44c373,_0x290502){return _0x44c373||_0x290502;},'hqDSS':'hGeto'};_0x13efb3[_0x45bcad(0x278,0x1aa,0x2e4,0x29a)](clearLog);const _0x45c759=taskQueue[_0x24e61e(0x467,0x4da,0x578,0x52d)]({'name':_0x13efb3[_0x24e61e(0x4e0,0x4ca,0x4f3,0x519)](_0x13efb3[_0x45bcad(0x256,0x2d3,0x300,0x280)](_0x4d7b62,'')[_0x45bcad(0x20c,0x227,0x232,0x22b)](0x1*0x1727+0x13e5*-0x1+-0x342,-0x2673*-0x1+-0x43b+0x2d*-0xc2),_0x4d7b62&&_0x13efb3['ZRmEN'](_0x4d7b62[_0x24e61e(0x559,0x57f,0x515,0x4e8)],0x632+0x1*-0xdd1+0x7bd)?_0x24e61e(0x469,0x417,0x4ee,0x44f):''),'type':TaskType[_0x24e61e(0x444,0x3c6,0x49f,0x435)],'prompt':_0x4d7b62});currentTaskId=_0x45c759,_0x4d7b62=_0x13efb3[_0x24e61e(0x39a,0x451,0x4e3,0x43d)](processCharacterPrompt,_0x4d7b62),_0x4d7b62=await _0x13efb3[_0x24e61e(0x4dd,0x3f8,0x4e2,0x414)](stripChineseAnnotations,_0x4d7b62);let _0x555536=_0x29bc60;_0x29bc60=_0x13efb3['jTIsg'](processCharacterPrompt,_0x29bc60),_0x29bc60=await _0x13efb3[_0x24e61e(0x5d8,0x519,0x4a1,0x537)](stripChineseAnnotations,_0x29bc60),addLog(_0x45bcad(0x164,0x18f,0xdc,0x207)+_0x45bcad(0x144,0x1b1,0x112,0x1fc)+extension_settings[extensionName]['client']),addLog('请求尺寸:\x20宽度\x20-'+'\x20'+(_0x47b767||'默认')+_0x45bcad(0x101,0xe0,0x99,0x88)+(_0x302eb9||'默认')),_0x4d7b62=_0x29bc60&&_0x29bc60[_0x24e61e(0x451,0x524,0x4c9,0x51a)]()!==''?_0x29bc60:_0x4d7b62,_0x13efb3[_0x45bcad(0x1f2,0x20c,0x29f,0x2a2)](addLog,_0x45bcad(0x15e,0x1c4,0x206,0xd0)+_0x4d7b62);let _0x5d814d=![];_0x4d7b62[_0x24e61e(0x403,0x40b,0x511,0x458)](_0x13efb3['qVFbe'])&&(_0x13efb3[_0x24e61e(0x479,0x50e,0x3c3,0x44c)](_0x13efb3['kxWMX'],_0x24e61e(0x3ed,0x3a9,0x52d,0x468))?_0x3fc7e2=_0x1c90ec['replaceAll'](_0x13efb3['UtYXe'],''):_0x5d814d=!![]);_0x13efb3[_0x45bcad(0x1f8,0x135,0x23a,0x1eb)](addLog,_0x45bcad(0x1dc,0x13b,0x1c9,0x1e9)+_0x45bcad(0x1bc,0x126,0x14b,0x158)+_0x45bcad(0xd1,0x131,0xdd,0xdb)+_0x5d814d);let _0x5ce95a={},_0x2125aa='',_0x5a746f='';if(_0x5d814d){if(_0x13efb3[_0x24e61e(0x497,0x471,0x449,0x496)](_0x24e61e(0x585,0x544,0x56a,0x541),_0x13efb3['fFdGH'])){_0x13efb3[_0x45bcad(0x1ab,0x1f2,0x209,0x1f3)](addLog,_0x13efb3[_0x45bcad(0xf7,0x7c,0x100,0x14c)]),_0x5ce95a=_0x13efb3[_0x45bcad(0x116,0xc7,0x86,0x9e)](parsePromptStringWithCoordinates,_0x4d7b62),_0x2125aa=_0x5ce95a[_0x13efb3[_0x24e61e(0x5a3,0x520,0x4ca,0x4f5)]];for(let _0x456bbb=-0xeed*0x2+-0x2b*0x4b+0x2a74;_0x456bbb<=-0x3ab+-0x5a7*-0x2+-0x1*0x79f;_0x456bbb++){_0x13efb3[_0x45bcad(0x277,0x247,0x2da,0x2ec)](_0x13efb3['KEbCk'],'WDxwC')?_0x5ce95a[_0x24e61e(0x51a,0x46a,0x580,0x4fb)+_0x456bbb+_0x45bcad(0x126,0x18e,0x18b,0x8f)]&&(_0x5a746f=_0x13efb3['uCTCP'](_0x13efb3[_0x24e61e(0x462,0x49f,0x502,0x533)](_0x5a746f,',\x20'),_0x5ce95a['Character\x20'+_0x456bbb+_0x24e61e(0x4c6,0x4f3,0x4a4,0x437)])):(_0x13efb3[_0x24e61e(0x4ef,0x4a9,0x45f,0x43d)](_0x3e9df7,'标准模式:\x20使用请求'+_0x45bcad(0x18a,0xbc,0x22e,0x202)),_0x3e95ae=_0xda57e8);}}else{const _0x132003=_0x13efb3[_0x45bcad(0x150,0x19b,0xed,0x20d)][_0x24e61e(0x395,0x4e1,0x429,0x41b)]('|');let _0x20b29b=-0x3d9*0x4+-0x1931+0x2895*0x1;while(!![]){switch(_0x132003[_0x20b29b++]){case'0':_0x441a89=null;continue;case'1':_0x2b4c91=null;continue;case'2':_0x13efb3[_0x45bcad(0x12c,0xbe,0xbc,0xe8)](_0x1567d5,'[Banana]\x20取'+_0x24e61e(0x5b1,0x5a4,0x51b,0x569)+_0x24e61e(0x55b,0x3e6,0x533,0x4ba)+_0x583323+')');continue;case'3':_0x21a1e9['emit'](_0x512110[_0x45bcad(0x23c,0x1f7,0x231,0x1d1)+'MAGE_RESPO'+_0x24e61e(0x379,0x3df,0x31d,0x3ed)],{'id':_0x69e413,'success':![],'error':_0x24e61e(0x445,0x3ba,0x344,0x401),'prompt':_0x13efb3[_0x24e61e(0x3f1,0x4d3,0x4aa,0x49f)](_0x205547,'')});continue;case'4':_0x1b34ce=null;continue;}break;}}}else _0x13efb3[_0x45bcad(0x13b,0x1d0,0x209,0x173)](_0x45bcad(0x250,0x22d,0x1b3,0x2c9),_0x13efb3['GlBbZ'])?(_0x991340[_0x1286d0][_0x45bcad(0x240,0x229,0x248,0x274)][_0x45bcad(0x22e,0x2a2,0x258,0x169)]=_0x13efb3[_0x45bcad(0x151,0xfe,0xbd,0x1a0)](_0xe3affe[_0x6a43c6][_0x24e61e(0x57a,0x497,0x4ee,0x551)]['cishu'],-0x1165+-0x984+-0x1aea*-0x1),_0x13efb3[_0x45bcad(0x12e,0x113,0x8e,0x1dc)](_0xa3c203,_0x24e61e(0x4a9,0x451,0x3c8,0x3f3)+'r\x20prompt:\x20'+_0x5032d5[_0x285da9][_0x45bcad(0x240,0x16c,0x1a3,0x1d5)][_0x45bcad(0x22e,0x2ce,0x25d,0x23d)])):(_0x13efb3['SmcTv'](addLog,_0x13efb3['faEwT']),_0x2125aa=_0x4d7b62);let {modifiedPrompt:_0x307d69,insertions:_0x57778e}=await _0x13efb3['TVRrx'](prompt_replace,_0x2125aa,_0x5a746f);if(_0x5d814d)for(let _0x1edbd3=0x1edd*0x1+0x7fa*0x4+0x2*-0x1f62;_0x13efb3[_0x24e61e(0x3ca,0x464,0x3db,0x453)](_0x1edbd3,0x1ef9+0x7*0x209+-0x2d34);_0x1edbd3++){_0x13efb3[_0x24e61e(0x59b,0x4ad,0x557,0x527)](_0x13efb3[_0x24e61e(0x3cf,0x3d8,0x350,0x426)],_0x13efb3[_0x24e61e(0x4e5,0x4d8,0x531,0x47c)])?_0x445e7f[_0x45bcad(0x1ea,0x196,0x23d,0x2b7)+_0x58447c+_0x24e61e(0x414,0x431,0x4a2,0x437)]&&(_0x2a3793=_0x13efb3[_0x24e61e(0x591,0x549,0x4df,0x572)](_0x13efb3[_0x24e61e(0x540,0x589,0x5a4,0x578)](_0x8405b2,_0x13efb3[_0x45bcad(0x114,0x55,0x1c5,0x130)]),_0x13efb3[_0x45bcad(0x12c,0x6e,0xb5,0xea)](_0x2cdb9e,_0x258e6e[_0x45bcad(0x1ea,0x21c,0x29f,0x161)+_0x1ef83f+_0x45bcad(0x126,0x125,0x19b,0x6f)]))):_0x5ce95a[_0x24e61e(0x427,0x4f5,0x4b9,0x4fb)+_0x1edbd3+_0x45bcad(0x126,0xc6,0x7f,0x159)]&&(_0x307d69=_0x13efb3[_0x24e61e(0x424,0x3e8,0x4ee,0x462)](_0x307d69+_0x13efb3[_0x45bcad(0x114,0x64,0x109,0xdb)],_0x13efb3['DedBo'](prompt_replace_for_character,_0x5ce95a['Character\x20'+_0x1edbd3+_0x45bcad(0x126,0xdf,0x1d9,0x1a1)])));}function _0x45bcad(_0x68e7a2,_0x539a78,_0x8ac389,_0x225454){return _0x4c7e(_0x68e7a2- -0xa2,_0x8ac389);}const _0x3e3f2e=extension_settings[extensionName]['banana'],{model:_0x57b6b3,apiUrl:_0x36c3fc,apiKey:_0x2af1c9,conversationPresets:_0x700452,conversationPresetId:_0x8a50c1,editPresetId:_0x9c6708,aspectRatio:_0xf61cc7}=_0x3e3f2e;addLog(_0x45bcad(0x13c,0x1d4,0x1d9,0x65)+'tarting\x20im'+'age\x20genera'+_0x45bcad(0x1fc,0x1fc,0x1f6,0x12c)+_0x45bcad(0x25f,0x1b0,0x206,0x1ea)+_0x57b6b3);let _0x8a1dee,_0x42f708;if(_0x57b6b3[_0x24e61e(0x52a,0x55c,0x4b2,0x515)](_0x45bcad(0x211,0x2bf,0x257,0x1d1))){if(_0x13efb3[_0x24e61e(0x3e4,0x4f6,0x54c,0x496)](_0x13efb3[_0x24e61e(0x4d9,0x4cc,0x4da,0x42f)],_0x24e61e(0x4c9,0x49f,0x5c9,0x538)))throw new _0x4b43a8(_0x13efb3['cueWX']);else{_0x8a1dee=_0x24e61e(0x4af,0x5a4,0x438,0x4fe)+_0x24e61e(0x44f,0x48b,0x53b,0x478)+_0x57b6b3;const _0x166e94={};_0x166e94[_0x24e61e(0x4a1,0x4e9,0x4a4,0x45a)+'t']='';const _0x283fe3=_0x700452[_0x8a50c1]||_0x166e94,_0x13773a=[_0x283fe3[_0x24e61e(0x507,0x3fc,0x49a,0x45a)+'t'],_0x57778e[_0x13efb3[_0x24e61e(0x4a6,0x4d4,0x53b,0x4a6)]],_0x57778e[_0x13efb3[_0x45bcad(0x23b,0x21b,0x1ec,0x209)]],_0x307d69,_0x57778e[_0x13efb3[_0x45bcad(0x17b,0xb7,0x244,0x1f7)]],_0x57778e[_0x13efb3[_0x24e61e(0x471,0x5a2,0x502,0x514)]],_0x283fe3[_0x45bcad(0x1e2,0x148,0x1f0,0x1ce)+_0x45bcad(0x176,0xe5,0x206,0xdb)],_0x57778e[_0x13efb3['NAlQr']]][_0x24e61e(0x445,0x4c4,0x3de,0x428)](Boolean)['join'](',\x20');addLog('正面提示词:\x20'+_0x13773a);const _0x5b08ae={};_0x5b08ae[_0x24e61e(0x3c4,0x3c8,0x47e,0x444)]=_0x13773a;const _0xada00d={};_0xada00d[_0x45bcad(0x231,0x231,0x2af,0x24b)+'t']=0x1,_0xada00d[_0x24e61e(0x424,0x532,0x54a,0x47b)+'o']=_0xf61cc7;const _0x212ceb={};_0x212ceb[_0x24e61e(0x51c,0x54d,0x539,0x4b2)]=[_0x5b08ae],_0x212ceb['parameters']=_0xada00d,_0x42f708=_0x212ceb,addLog(_0x45bcad(0x14e,0xab,0x223,0xcf)+_0x45bcad(0x212,0x1ac,0x13f,0x140)+_0x45bcad(0xee,0x14a,0x96,0x13b)+_0x24e61e(0x460,0x464,0x47e,0x4c1)+_0x24e61e(0x351,0x3f3,0x488,0x41d)+_0x13773a);}}else{_0x8a1dee=_0x13efb3[_0x24e61e(0x3ca,0x48a,0x4fd,0x43c)];let _0xb75196;if(_0x29bc60[_0x24e61e(0x38c,0x404,0x415,0x458)](_0x13efb3[_0x45bcad(0x200,0x219,0x1fd,0x29e)])){addLog(_0x13efb3['taFUm']);const _0xe2dd78=_0x13efb3['eiOBE'](_0x9c6708,'默认'),_0x3fbee2={};_0x3fbee2[_0x24e61e(0x578,0x5bd,0x514,0x51c)+'on']=[],_0x3fbee2[_0x24e61e(0x442,0x388,0x44b,0x45a)+'t']='',_0xb75196=_0x700452[_0xe2dd78]||_0x3fbee2,addLog(_0x24e61e(0x60f,0x4f6,0x612,0x544)+_0x45bcad(0x1ef,0x15b,0x131,0x17b)+_0xe2dd78+'\x22');}else{if(_0x13efb3[_0x24e61e(0x42a,0x55e,0x404,0x496)](_0x13efb3[_0x45bcad(0x19a,0x250,0x1c3,0xd2)],_0x13efb3['UewDE'])){const _0x283b5d={};_0x283b5d[_0x24e61e(0x5ce,0x4f0,0x4fc,0x51c)+'on']=[],_0x283b5d[_0x45bcad(0x149,0xa6,0x1e6,0x7a)+'t']='',_0xb75196=_0x700452[_0x8a50c1]||_0x283b5d;}else _0x5c6d20=_0x13efb3[_0x24e61e(0x532,0x5ad,0x53d,0x519)](_0x1f1194+_0x13efb3[_0x45bcad(0x114,0x9b,0x16c,0x82)],_0x13efb3['hhpLq'](_0xadd721,_0x48f69c['Character\x20'+_0x2a727d+_0x45bcad(0x126,0x8e,0x124,0x5e)]));}const _0x161f97=[_0xb75196[_0x45bcad(0x149,0x199,0xaa,0x175)+'t'],_0x57778e[_0x13efb3[_0x45bcad(0x195,0x226,0xcf,0x190)]],_0x57778e[_0x13efb3[_0x24e61e(0x575,0x49c,0x5ff,0x54c)]],_0x307d69,_0x57778e[_0x24e61e(0x38f,0x4ba,0x47b,0x403)],_0x57778e[_0x13efb3[_0x24e61e(0x59b,0x500,0x46e,0x514)]],_0xb75196[_0x24e61e(0x567,0x4c2,0x4e7,0x4f3)+_0x24e61e(0x4f1,0x536,0x3ea,0x487)],_0x57778e[_0x13efb3[_0x24e61e(0x3b1,0x39b,0x3be,0x469)]]][_0x24e61e(0x4a9,0x469,0x501,0x428)](Boolean)['join'](',\x20');addLog(_0x24e61e(0x4ee,0x43c,0x3d9,0x489)+_0x161f97);const _0x49d42e={};_0x49d42e[_0x45bcad(0xef,0x96,0xf2,0x1ad)]=_0x24e61e(0x5c2,0x467,0x47f,0x4f0),_0x49d42e[_0x24e61e(0x4fd,0x4d9,0x4dd,0x579)]=[];const _0x37da12={};_0x37da12[_0x45bcad(0xef,0xda,0x47,0x100)]='assistant',_0x37da12[_0x24e61e(0x577,0x5cc,0x525,0x579)]=[];const _0xaf0d98=_0xb75196[_0x45bcad(0x20b,0x1d5,0x273,0x1a9)+'on']['map'](_0x55133b=>[_0x49d42e,_0x37da12])[_0x24e61e(0x4b0,0x46f,0x520,0x50c)]();let _0x2fc2e7=0x8*0x3f3+-0x18c7*-0x1+-0x385f;for(const _0x5df4b9 of _0xb75196[_0x24e61e(0x44e,0x49f,0x48d,0x51c)+'on']){if(_0x5df4b9[_0x24e61e(0x45c,0x530,0x57b,0x4f0)]?.['text'])_0xaf0d98[_0x2fc2e7]['content'][_0x45bcad(0x165,0x1ab,0x23b,0x115)]({'type':_0x13efb3[_0x24e61e(0x563,0x591,0x551,0x557)],'text':_0x5df4b9[_0x45bcad(0x1df,0x177,0x241,0x176)][_0x24e61e(0x42d,0x43b,0x403,0x439)]});const _0x485a16=await _0x13efb3[_0x45bcad(0x226,0x214,0x19f,0x211)](getImageFromTurnData,_0x5df4b9[_0x45bcad(0x1df,0x251,0x19c,0x1f3)]);if(_0x485a16)_0xaf0d98[_0x2fc2e7][_0x24e61e(0x564,0x52f,0x524,0x579)][_0x45bcad(0x165,0x165,0xa9,0xf5)]({'type':_0x45bcad(0x13d,0x1c2,0x192,0x200),'image_url':{'url':_0x485a16}});_0x2fc2e7++;if(_0x5df4b9[_0x45bcad(0x15a,0x213,0x16f,0xcf)]?.[_0x24e61e(0x3bb,0x417,0x3f3,0x439)])_0xaf0d98[_0x2fc2e7]['content'][_0x24e61e(0x3c1,0x3e1,0x40d,0x476)]({'type':_0x13efb3[_0x24e61e(0x4bb,0x523,0x4d4,0x557)],'text':_0x5df4b9[_0x45bcad(0x15a,0xa3,0x1fb,0xde)]['text']});const _0x4b22a3=await _0x13efb3[_0x45bcad(0x253,0x302,0x198,0x305)](getImageFromTurnData,_0x5df4b9[_0x45bcad(0x15a,0x160,0x1ae,0x113)]);if(_0x4b22a3)_0xaf0d98[_0x2fc2e7][_0x45bcad(0x268,0x1a2,0x1b6,0x2b5)][_0x45bcad(0x165,0x231,0x148,0x1ea)]({'type':_0x13efb3[_0x24e61e(0x432,0x4e4,0x503,0x506)],'image_url':{'url':_0x4b22a3}});_0x2fc2e7++;}if(!_0x29bc60['includes'](_0x24e61e(0x4cb,0x4f9,0x567,0x4c7))){const _0x1b9214=extension_settings[extensionName][_0x24e61e(0x3c0,0x3c3,0x4bd,0x457)+_0x24e61e(0x40d,0x4ee,0x55b,0x4d5)+'ts']||{};for(const _0xd339af in _0x1b9214){if(_0x13efb3[_0x24e61e(0x41c,0x411,0x564,0x48e)]!==_0x13efb3['nPyJz']){const _0x374fcf=_0x1b9214[_0xd339af],_0x446bed=(_0x374fcf[_0x24e61e(0x472,0x38b,0x477,0x40b)]||'')[_0x45bcad(0x10a,0x182,0xe5,0x4b)]('|')[_0x45bcad(0x117,0x64,0xfc,0x1d6)](_0x3d9114=>_0x3d9114[_0x45bcad(0x209,0x1a5,0x28e,0x1e4)]()!=='');for(const _0x52f5fa of _0x446bed){if(_0x161f97['toLowerCas'+'e']()[_0x24e61e(0x383,0x3d4,0x4c5,0x458)](_0x52f5fa['toLowerCas'+'e']())){if(_0x13efb3['rOnzS']!==_0x13efb3['yTdkJ']){addLog(_0x45bcad(0x1a6,0x17d,0x1f9,0x133)+_0x24e61e(0x464,0x3b9,0x41b,0x448)+_0x45bcad(0x14f,0x1d0,0xe8,0x194)+_0x45bcad(0x186,0x13b,0x18e,0xf8)+_0x52f5fa+('\x22\x20from\x20pre'+_0x45bcad(0xd4,0x136,0x147,0x43))+_0xd339af+'\x22.');const _0x1de23d=_0x374fcf[_0x45bcad(0x20b,0x257,0x1c1,0x171)+'on'];if(_0x1de23d){const _0x5b138d=[];if(_0x1de23d[_0x45bcad(0x1df,0x160,0x27c,0x125)]&&_0x1de23d['user'][_0x45bcad(0x128,0x77,0x196,0xb8)])_0x5b138d[_0x45bcad(0x165,0x216,0x21c,0x1e7)]({'type':_0x13efb3[_0x24e61e(0x5aa,0x4e9,0x59b,0x557)],'text':_0x1de23d[_0x24e61e(0x4a8,0x53a,0x454,0x4f0)][_0x45bcad(0x128,0xf3,0x1d4,0xdc)]});const _0x51886a=await _0x13efb3[_0x24e61e(0x3b2,0x390,0x3f5,0x43f)](getImageFromTurnData,_0x1de23d[_0x45bcad(0x1df,0x1b4,0x2b2,0x284)]);if(_0x51886a)_0x5b138d['push']({'type':_0x13efb3[_0x45bcad(0x1f5,0x263,0x29d,0x24b)],'image_url':{'url':_0x51886a}});if(_0x13efb3[_0x24e61e(0x5c6,0x591,0x634,0x55c)](_0x5b138d[_0x45bcad(0x1d7,0x189,0x18a,0x29f)],0x1*0x1872+-0x10*-0x137+0x112*-0x29)){const _0x2fff01={};_0x2fff01[_0x45bcad(0xef,0x1c5,0xec,0xa0)]=_0x13efb3[_0x24e61e(0x50b,0x554,0x3f0,0x498)],_0x2fff01[_0x45bcad(0x268,0x2f3,0x2c8,0x2b9)]=_0x5b138d,_0xaf0d98[_0x45bcad(0x165,0x186,0x1ad,0x110)](_0x2fff01);}const _0xf0d901=[];if(_0x1de23d['model']&&_0x1de23d[_0x24e61e(0x4fc,0x394,0x501,0x46b)][_0x45bcad(0x128,0xdf,0x1df,0xae)])_0xf0d901[_0x24e61e(0x50c,0x3d0,0x496,0x476)]({'type':_0x13efb3[_0x24e61e(0x497,0x598,0x527,0x557)],'text':_0x1de23d[_0x45bcad(0x15a,0x1ce,0x159,0x18f)][_0x24e61e(0x395,0x3d9,0x473,0x439)]});const _0x5c60d7=await _0x13efb3['JcTML'](getImageFromTurnData,_0x1de23d[_0x24e61e(0x4fc,0x49d,0x4a0,0x46b)]);if(_0x5c60d7)_0xf0d901[_0x45bcad(0x165,0xe5,0x140,0x188)]({'type':_0x13efb3[_0x45bcad(0x1f5,0x1d6,0x12b,0x20e)],'image_url':{'url':_0x5c60d7}});if(_0x13efb3['ZRmEN'](_0xf0d901[_0x45bcad(0x1d7,0x178,0x257,0x2a4)],-0x570+0x4f*0x4b+0x5e7*-0x3)){const _0x1040cd={};_0x1040cd[_0x45bcad(0xef,0xd0,0x45,0x11a)]=_0x13efb3['eTpTY'],_0x1040cd[_0x45bcad(0x268,0x1bf,0x2ff,0x333)]=_0xf0d901,_0xaf0d98['push'](_0x1040cd);}}break;}else{if(_0x6fbf92[_0x45bcad(0x26f,0x315,0x282,0x2dc)+_0x24e61e(0x540,0x4cb,0x41f,0x49c)+_0x24e61e(0x421,0x31b,0x457,0x3ec)]){const _0x533524=_0x13efb3[_0x24e61e(0x582,0x570,0x47a,0x4c9)]['split']('|');let _0x1e9865=-0x1*0xb15+0x3*0x845+-0xdba;while(!![]){switch(_0x533524[_0x1e9865++]){case'0':_0x2c6cdf[_0x45bcad(0x134,0x185,0x7c,0xb3)](_0x2102fb=>{function _0xacbd35(_0x403171,_0x19c629,_0x1189b8,_0x1f823b){return _0x45bcad(_0x1f823b- -0xe8,_0x19c629-0x20,_0x1189b8,_0x1f823b-0x151);}_0x495548['removeList'+_0xacbd35(-0x81,-0x36,0xa0,-0xd)](_0x2102fb,_0x1ed360);});continue;case'1':_0x4c080d[_0x24e61e(0x54c,0x5f3,0x608,0x580)+'BananaList'+_0x24e61e(0x346,0x33a,0x4aa,0x3ec)]=![];continue;case'2':_0x22beca['removeList'+_0x24e61e(0x4b5,0x49b,0x32c,0x3ec)](_0x52e1cd[_0x24e61e(0x5f2,0x5c4,0x603,0x54d)+_0x45bcad(0x1b7,0x1e3,0x285,0x1be)+'ST'],_0xdb4597);continue;case'3':_0x4c97ca(_0x13efb3['hEoUy']);continue;case'4':_0x5de468[_0x45bcad(0x197,0x22c,0x12e,0xcf)+_0x45bcad(0xdb,0x15a,0x83,0x16a)](_0x13efb3[_0x24e61e(0x4d7,0x5de,0x4cd,0x550)],_0x4354c5);continue;}break;}}}}}}else _0x4c67ac[_0x45bcad(0x191,0x176,0x1f9,0x18c)+'sk'](_0x36e02e,![]);}}if(!_0x29bc60[_0x45bcad(0x147,0x1f5,0x191,0x192)](_0x13efb3[_0x45bcad(0x200,0x259,0x158,0x272)])){const _0x2b6c1e={};_0x2b6c1e[_0x24e61e(0x4e1,0x424,0x438,0x4b4)]=_0x13efb3['HrqKO'],_0x2b6c1e['text']=_0x161f97;const _0xd58eec={};_0xd58eec[_0x24e61e(0x443,0x477,0x37b,0x400)]=_0x24e61e(0x4a3,0x585,0x55b,0x4f0),_0xd58eec[_0x24e61e(0x4dc,0x62f,0x610,0x579)]=[_0x2b6c1e],_0xaf0d98['push'](_0xd58eec);}else{if(_0x13efb3[_0x24e61e(0x42e,0x477,0x4d9,0x433)](_0x13efb3[_0x45bcad(0x180,0x107,0xd5,0x14c)],_0x13efb3['gHsLD'])){const _0x52f155=[],_0x96637c=_0x156e93||_0x161f97,_0x1f958b=[_0xb75196[_0x24e61e(0x463,0x51e,0x513,0x45a)+'t'],_0x96637c,_0xb75196[_0x24e61e(0x53b,0x55f,0x567,0x4f3)+'mpt']][_0x24e61e(0x453,0x3c9,0x46f,0x428)](Boolean)[_0x24e61e(0x35a,0x3f9,0x364,0x3f4)](',\x20'),_0x55a62c={};_0x55a62c[_0x24e61e(0x43e,0x50b,0x406,0x4b4)]=_0x13efb3[_0x45bcad(0x246,0x2c1,0x2ab,0x2c3)],_0x55a62c[_0x24e61e(0x3a8,0x462,0x3aa,0x439)]=_0x1f958b,_0x52f155[_0x24e61e(0x435,0x4f0,0x3bf,0x476)](_0x55a62c);if(_0x11fbac){const _0x48fad3={};_0x48fad3[_0x45bcad(0x106,0x3d,0x1d8,0xf2)]=_0x11fbac;const _0x3091cd={};_0x3091cd[_0x24e61e(0x446,0x566,0x43c,0x4b4)]=_0x13efb3[_0x45bcad(0x1f5,0x21f,0x192,0x194)],_0x3091cd[_0x45bcad(0x13d,0xc6,0x1e3,0x1d8)]=_0x48fad3,_0x52f155[_0x45bcad(0x165,0xf3,0x178,0x1c8)](_0x3091cd),_0x13efb3[_0x24e61e(0x51c,0x5d8,0x5ca,0x509)](addLog,_0x24e61e(0x4f0,0x42f,0x44b,0x4bb)+_0x24e61e(0x3c8,0x456,0x325,0x3f6)+_0x24e61e(0x54e,0x52a,0x4fb,0x51b));}const _0x43f0a9={};_0x43f0a9[_0x24e61e(0x3c9,0x3ba,0x4c1,0x400)]=_0x13efb3[_0x24e61e(0x3f1,0x411,0x4b5,0x498)],_0x43f0a9['content']=_0x52f155,_0xaf0d98['push'](_0x43f0a9),_0x13efb3['hhpLq'](addLog,_0x24e61e(0x4ce,0x4cc,0x545,0x4bb)+_0x45bcad(0x241,0x2a5,0x316,0x277)+_0x1f958b);}else _0x13efb3[_0x45bcad(0x253,0x20d,0x28e,0x278)](_0x294dc3,_0x24e61e(0x42e,0x441,0x3e3,0x4b7)+_0x24e61e(0x49a,0x553,0x3fe,0x4d0)+_0x45bcad(0x19c,0xdd,0x11c,0xf6)+_0x24e61e(0x333,0x3a7,0x322,0x3f9)+'\x20'+_0x23f458[_0x45bcad(0x272,0x251,0x2c9,0x1ac)]),_0x41489f=_0x43eb72,_0x13efb3[_0x24e61e(0x5ce,0x481,0x4f0,0x517)](_0x44dd37,_0x13efb3[_0x45bcad(0x1dd,0x273,0x14e,0x20e)]);}const _0x12dd04={};_0x12dd04[_0x45bcad(0x16a,0x187,0x134,0x217)+'o']=_0xf61cc7;const _0x3c5a63={};_0x3c5a63['imageConfi'+'g']=_0x12dd04,_0x42f708={'model':_0x57b6b3,'messages':_0xaf0d98['filter'](_0x1a0763=>_0x1a0763[_0x45bcad(0x268,0x1b1,0x24f,0x329)][_0x45bcad(0x1d7,0x2aa,0x1cc,0x11f)]>0xc74+-0x1*0x1e8b+0xb*0x1a5),'config':_0x3c5a63},_0x13efb3[_0x45bcad(0x253,0x31d,0x2ef,0x31e)](addLog,'[Banana]\x20B'+'uilt\x20multi'+_0x24e61e(0x3c0,0x338,0x35d,0x3fc)+_0x45bcad(0xd5,0x189,0xd0,0x18a)+_0x42f708['messages'][_0x24e61e(0x458,0x4c4,0x4c7,0x4e8)]+_0x45bcad(0x1b1,0x10c,0x16f,0x255));}let _0x5d4d06=_0x36c3fc['replace'](/\/$/,''),_0x17fa52;if(_0x5d4d06['endsWith'](_0x45bcad(0x1e0,0x219,0x1e2,0x14e))||_0x5d4d06[_0x24e61e(0x415,0x40b,0x48c,0x458)](_0x13efb3['BFBmJ'])){if(_0x13efb3[_0x24e61e(0x433,0x452,0x419,0x44c)]('KfiAJ',_0x13efb3['wuJKj'])){const _0x3093f9=[],_0x56d6d6=_0x13efb3[_0x24e61e(0x44e,0x3db,0x465,0x49f)](_0x4a93a1,_0x270bda),_0x5d3482=[_0xe9e970['fixedPromp'+'t'],_0x56d6d6,_0xc61b94[_0x45bcad(0x1e2,0x27d,0x130,0x13b)+_0x45bcad(0x176,0x1c9,0x186,0xdf)]][_0x24e61e(0x45f,0x4c5,0x479,0x428)](_0x47b241)[_0x24e61e(0x3bc,0x359,0x47f,0x3f4)](',\x20'),_0x41ee67={};_0x41ee67[_0x45bcad(0x1a3,0x187,0x1ed,0x25a)]=_0x24e61e(0x36b,0x412,0x3e5,0x439),_0x41ee67[_0x45bcad(0x128,0x56,0x98,0x178)]=_0x5d3482,_0x3093f9['push'](_0x41ee67);if(_0x23d3b4){const _0x109621={};_0x109621[_0x24e61e(0x418,0x41c,0x3f1,0x417)]=_0x166f82;const _0x398539={};_0x398539[_0x24e61e(0x438,0x51c,0x578,0x4b4)]=_0x13efb3[_0x45bcad(0x1f5,0x1ea,0x284,0x162)],_0x398539[_0x24e61e(0x3fe,0x3de,0x446,0x44e)]=_0x109621,_0x3093f9[_0x45bcad(0x165,0x1a5,0x171,0x20a)](_0x398539),_0x13efb3[_0x45bcad(0x103,0xf0,0xeb,0x6e)](_0x32bc8c,_0x24e61e(0x407,0x4c7,0x499,0x4bb)+'图模式：已添加待修改'+_0x24e61e(0x570,0x4fa,0x58a,0x51b));}const _0xc9067a={};_0xc9067a[_0x45bcad(0xef,0x67,0x22,0x1a7)]=_0x13efb3[_0x24e61e(0x3d5,0x46e,0x44c,0x498)],_0xc9067a[_0x24e61e(0x61b,0x4da,0x588,0x579)]=_0x3093f9,_0x152c0f[_0x24e61e(0x49e,0x424,0x43f,0x476)](_0xc9067a),_0x3dfb9e(_0x45bcad(0x1aa,0x1b6,0x1b6,0x23d)+_0x24e61e(0x503,0x5a6,0x5b4,0x552)+_0x5d3482);}else _0x17fa52=_0x13efb3['unGTF'](_0x5d4d06,_0x8a1dee);}else _0x13efb3[_0x45bcad(0x1fd,0x166,0x2d1,0x128)]!==_0x45bcad(0x20d,0x181,0x296,0x238)?_0x17fa52=_0x13efb3[_0x45bcad(0x12d,0xbe,0x9c,0x66)](_0x13efb3['BBynR'](_0x5d4d06,_0x13efb3[_0x45bcad(0x265,0x27d,0x2d0,0x196)]),_0x8a1dee):(_0x1fdcc0[_0x24e61e(0x652,0x59b,0x4e9,0x580)+_0x24e61e(0x3d0,0x529,0x425,0x49c)+'ener']=!![],_0x13efb3[_0x45bcad(0x278,0x333,0x328,0x304)](_0x2679ca));_0x17fa52=_0x17fa52[_0x45bcad(0xd8,0x85,0x9a,0x14d)](/\/v1\/v1\//g,_0x13efb3[_0x45bcad(0x174,0x129,0x1f8,0xb8)]);const _0x7f8fd7=extension_settings[extensionName]['client'];let _0x3ab596,_0xb77642,_0x17c5ee;if(_0x13efb3[_0x45bcad(0xcf,0x19e,0xb,0x78)](_0x7f8fd7,_0x24e61e(0x591,0x46a,0x539,0x4df))){let _0x2a32f3=_0x5d4d06;!_0x2a32f3[_0x45bcad(0x15b,0x16d,0x1a8,0x1e2)](_0x13efb3[_0x45bcad(0x265,0x275,0x1b5,0x22a)])&&!_0x2a32f3[_0x24e61e(0x39b,0x3f4,0x497,0x458)](_0x24e61e(0x498,0x4ab,0x3b9,0x42e))&&(_0x13efb3[_0x45bcad(0x185,0x1c7,0xe0,0x115)](_0x24e61e(0x493,0x4be,0x31b,0x3e8),_0x13efb3['wUbMT'])?_0x2678e6=!![]:_0x2a32f3=_0x13efb3[_0x45bcad(0xdf,0x6f,0x2c,0x9e)](_0x2a32f3,_0x13efb3[_0x45bcad(0x265,0x2c7,0x2e4,0x1b7)]));_0x2a32f3=_0x2a32f3['replace'](/\/v1\/$/,_0x13efb3[_0x24e61e(0x4d0,0x63a,0x54b,0x576)]),_0x3ab596=_0x13efb3[_0x45bcad(0xd0,0x15b,0x53,0x157)],_0xb77642=_0x13efb3[_0x45bcad(0x1eb,0x286,0x139,0x28d)](getRequestHeaders,window[_0x45bcad(0x139,0x1c3,0x14b,0x169)]);const _0x22aea6={};_0x22aea6[_0x24e61e(0x56e,0x4af,0x46a,0x4ff)+_0x45bcad(0x275,0x346,0x1b1,0x34e)+'ce']=_0x13efb3['GILXO'],_0x22aea6[_0x24e61e(0x451,0x3d5,0x4b6,0x404)]=_0x2a32f3,_0x22aea6[_0x24e61e(0x5dc,0x5eb,0x4ed,0x577)+_0x45bcad(0x184,0xed,0x1cd,0x1fa)+'rs']=_0x45bcad(0x19d,0x1c3,0x118,0x1b4)+_0x24e61e(0x553,0x4f6,0x5f3,0x54e)+'er\x20'+_0x2af1c9+'\x22',_0x22aea6[_0x24e61e(0x53e,0x53a,0x530,0x46b)]=_0x57b6b3,_0x22aea6['messages']=_0x42f708[_0x24e61e(0x4b2,0x472,0x46f,0x49e)],_0x22aea6[_0x45bcad(0x179,0x1cc,0x173,0x1e4)]=![],_0x17c5ee=_0x22aea6;if(_0x57b6b3[_0x45bcad(0x204,0x15e,0x2cb,0x18d)](_0x13efb3[_0x24e61e(0x51d,0x51e,0x4c8,0x4b8)])){if(_0x13efb3[_0x24e61e(0x491,0x50b,0x4b6,0x456)]===_0x24e61e(0x5ae,0x4a3,0x4f1,0x57a))throw new _0x49cec5('Failed\x20to\x20'+'fetch\x20imag'+_0x24e61e(0x31b,0x3ce,0x45e,0x3eb)+_0x1c6dfc[_0x24e61e(0x5a1,0x61e,0x570,0x545)]);else{addLog('[Banana]\x20I'+_0x45bcad(0x24c,0x199,0x21f,0x293)+'持酒馆代理，切换为直'+_0x45bcad(0xf5,0x17f,0x64,0x101)),_0x3ab596=_0x17fa52;const _0x3195e2={};_0x3195e2[_0x24e61e(0x434,0x459,0x344,0x3de)+'pe']=_0x13efb3[_0x45bcad(0x1c7,0x25f,0x117,0x17c)],_0x3195e2[_0x24e61e(0x484,0x4a2,0x469,0x4ae)+'ion']=_0x24e61e(0x4e9,0x4c0,0x522,0x4e0)+_0x2af1c9,_0xb77642=_0x3195e2,_0x17c5ee=_0x42f708;}}_0x13efb3[_0x45bcad(0x12e,0x1ca,0x10d,0x1c8)](addLog,_0x24e61e(0x4aa,0x4de,0x505,0x544)+_0x24e61e(0x615,0x522,0x5a6,0x556));}else{if(_0x13efb3['OWJRR'](_0x24e61e(0x5c3,0x48c,0x575,0x53a),_0x45bcad(0x119,0x40,0x155,0x1be))){if(_0x2f4558){const _0x306871=_0x16624b['apply'](_0x32c886,arguments);return _0x5c3f3d=null,_0x306871;}}else{_0x3ab596=_0x17fa52;const _0x45a5e9={};_0x45a5e9[_0x24e61e(0x418,0x3c7,0x368,0x3de)+'pe']=_0x13efb3[_0x24e61e(0x48e,0x414,0x59d,0x4d8)],_0x45a5e9[_0x45bcad(0x19d,0x216,0x130,0xfc)+_0x24e61e(0x5d9,0x5c5,0x52c,0x52b)]=_0x45bcad(0x1cf,0x1dd,0x1b2,0x134)+_0x2af1c9,_0xb77642=_0x45a5e9,_0x17c5ee=_0x42f708,_0x13efb3['VbkfC'](addLog,'[Banana]\x20使'+_0x24e61e(0x565,0x59b,0x438,0x4dc));}}_0x13efb3[_0x45bcad(0x226,0x23f,0x14f,0x190)](addLog,_0x24e61e(0x3ad,0x510,0x3af,0x44d)+_0x45bcad(0x1c5,0x201,0x1cf,0x10a)+_0x24e61e(0x507,0x56d,0x5a2,0x574)+_0x3ab596);function _0x24e61e(_0x1883a6,_0x31d249,_0x4d865d,_0x2de370){return _0x4c7e(_0x2de370-0x26f,_0x31d249);}_0x13efb3[_0x45bcad(0x1d2,0x291,0x22b,0x180)](addLog,_0x45bcad(0x232,0x178,0x20f,0x27b)+_0x45bcad(0xd9,0x87,0x65,0x3b)+JSON[_0x24e61e(0x456,0x47e,0x507,0x505)](_0x17c5ee,null,-0x1cad+0x3*0xa5e+0x1*-0x26b));try{if(_0x13efb3[_0x45bcad(0x1a2,0x25a,0x24d,0x127)](_0x24e61e(0x53e,0x4b6,0x576,0x57c),_0x13efb3[_0x45bcad(0x20e,0x2e7,0x1a2,0x1b5)]))_0x1547c1=_0x13efb3[_0x24e61e(0x502,0x515,0x4ca,0x519)](_0x13efb3['nrAwv'](_0x3a6b49,',\x20'),_0x2ebdd0[_0x24e61e(0x49c,0x4d6,0x4fe,0x4fb)+_0x4279ed+'\x20Prompt']);else{taskQueue[_0x45bcad(0x118,0xda,0x15a,0xcf)+'us'](_0x45c759,_0x13efb3['KGDdd']);const _0x1f1c68=await _0x13efb3['sSHEf'](fetch,_0x3ab596,{'method':_0x13efb3[_0x45bcad(0x217,0x1cc,0x17f,0x254)],'headers':_0xb77642,'body':JSON[_0x45bcad(0x1f4,0x1d3,0x125,0x14e)](_0x17c5ee)});if(!_0x1f1c68['ok']){if(_0x13efb3[_0x45bcad(0x1f6,0x2af,0x232,0x21a)](_0x13efb3[_0x24e61e(0x40e,0x3f0,0x3e7,0x45d)],_0x13efb3[_0x45bcad(0x161,0x234,0x140,0x100)])){const _0x28bfa8=await _0x1f1c68[_0x45bcad(0x128,0x173,0x168,0x5c)]();throw new Error(_0x24e61e(0x553,0x5ff,0x5c7,0x56f)+'t\x20failed\x20w'+_0x45bcad(0x1c9,0x203,0x239,0x19b)+'\x20'+_0x1f1c68[_0x24e61e(0x60e,0x5e2,0x542,0x545)]+':\x20'+_0x28bfa8);}else{const _0x56d199=_0x13efb3[_0x24e61e(0x4c3,0x38a,0x500,0x436)][_0x24e61e(0x42b,0x37c,0x37c,0x41b)]('|');let _0x23cd1f=0x40e*0x1+-0x41e*-0x7+-0x41c*0x8;while(!![]){switch(_0x56d199[_0x23cd1f++]){case'0':_0xc90bd8['error'](_0x13efb3[_0x24e61e(0x3bb,0x438,0x4c4,0x3f1)],_0x5cbbb0);continue;case'1':if(_0x13efb3[_0x45bcad(0x122,0x190,0x19d,0x108)](_0x2fc8b4[_0x24e61e(0x5ee,0x567,0x5ea,0x583)],_0x13efb3[_0x45bcad(0x140,0x6e,0xef,0x1e3)])){}else _0x40b26e[_0x45bcad(0x191,0xf3,0x11c,0x111)+'sk'](_0x1b1eae,![]);continue;case'2':_0x13efb3[_0x24e61e(0x43d,0x420,0x467,0x414)](_0x3d2c93,_0x24e61e(0x4f3,0x56b,0x589,0x4b7)+_0x24e61e(0x4ad,0x508,0x59c,0x4e1)+':\x20'+_0x4bdd81['message']);continue;case'3':_0x5e6b33=null;continue;case'4':throw _0x4ff049;continue;}break;}}}const _0x3f50c3=await _0x1f1c68[_0x45bcad(0x14a,0x12a,0x1ee,0x215)]();let _0x394d1f='';const _0x31eb70=_0x3f50c3[_0x45bcad(0x249,0x200,0x2fb,0x26a)];if(_0x31eb70&&_0x13efb3[_0x45bcad(0x24a,0x315,0x2be,0x1a0)](_0x31eb70['length'],0xaf*-0x26+-0xfc+-0x3a*-0x77)){const _0x205528=_0x31eb70[0x3*0x107+-0x687+0x372]['message']?.[_0x24e61e(0x64a,0x4d4,0x4ea,0x579)];if(Array['isArray'](_0x205528)){if(_0x13efb3['WjsLD']===_0x13efb3[_0x24e61e(0x4b3,0x431,0x538,0x47a)]){const _0x3fd14d={};_0x3fd14d[_0x45bcad(0xef,0x117,0x8a,0xb7)]=_0x13efb3[_0x24e61e(0x444,0x510,0x402,0x498)],_0x3fd14d['content']=_0x3376ad,_0x587713[_0x45bcad(0x165,0x16d,0x1a6,0xa3)](_0x3fd14d);}else for(const _0x4aaf50 of _0x205528){if(_0x13efb3[_0x24e61e(0x3cc,0x33c,0x39c,0x3e0)](_0x24e61e(0x4ed,0x3ed,0x423,0x438),_0x13efb3[_0x45bcad(0x224,0x246,0x2ea,0x188)])){if(_0x13efb3['iJdfV'](_0x4aaf50[_0x24e61e(0x474,0x4ae,0x558,0x4b4)],_0x13efb3[_0x24e61e(0x43f,0x52c,0x586,0x506)])&&_0x4aaf50[_0x45bcad(0x13d,0x129,0x171,0x11f)]?.[_0x45bcad(0x106,0x70,0x1bc,0x138)]){_0x394d1f=_0x4aaf50['image_url']['url'];break;}}else{const _0x15765f={};_0x15765f['url']=_0x15db06;const _0x4ac818={};_0x4ac818[_0x24e61e(0x421,0x3dd,0x412,0x4b4)]=_0x24e61e(0x41d,0x4c9,0x39c,0x44e),_0x4ac818[_0x24e61e(0x4cd,0x3e4,0x4a8,0x44e)]=_0x15765f,_0x467667[_0x24e61e(0x492,0x409,0x3bf,0x476)](_0x4ac818),_0x4920be(_0x45bcad(0x1aa,0x13c,0x273,0x1fd)+'图模式：已添加待修改'+'的图片');}}}else{if(_0x13efb3[_0x45bcad(0x19e,0xc9,0x150,0x196)](typeof _0x205528,_0x13efb3[_0x24e61e(0x4db,0x4f3,0x519,0x4d3)])){if(_0x13efb3[_0x24e61e(0x4f0,0x460,0x4ab,0x50a)](_0x13efb3[_0x24e61e(0x4ab,0x503,0x46c,0x48b)],_0x24e61e(0x5a4,0x628,0x60a,0x554)))_0x1ff30c=_0x13efb3[_0x45bcad(0x260,0x1a1,0x1c2,0x2e6)](_0x3448d8,_0x1c21ec);else{const _0x21d4e6=/!\[.*?\]\((https?:\/\/[^\s\)]+)\)/,_0x342e9c=_0x205528[_0x45bcad(0x1bb,0x1b3,0x1b3,0x10a)](_0x21d4e6);if(_0x342e9c&&_0x342e9c[0x1*0x2531+0x26b9+0x4be9*-0x1]){addLog(_0x13efb3[_0x24e61e(0x41f,0x427,0x553,0x4d9)]);const _0x304097=_0x342e9c[-0x1de9+0x1c55+-0x2d*-0x9];_0x13efb3[_0x24e61e(0x58e,0x4ce,0x4d3,0x4c5)](addLog,'[Banana]\x20M'+'arkdown\x20im'+_0x45bcad(0xfc,0x160,0x18d,0x173)+_0x304097);try{const _0x2d5e89=await fetch(_0x304097);if(!_0x2d5e89['ok'])throw new Error(_0x45bcad(0x152,0x1fe,0x17c,0x184)+'fetch\x20imag'+_0x24e61e(0x39f,0x498,0x461,0x3eb)+_0x2d5e89[_0x45bcad(0x234,0x231,0x1e9,0x2ba)]);const _0x2256c0=await _0x2d5e89['blob'](),_0x3fe4ac=await new Promise((_0x400039,_0x1f67f0)=>{function _0x195df5(_0x3ff211,_0x29c6eb,_0xccb501,_0x3c077f){return _0x24e61e(_0x3ff211-0x15b,_0x3ff211,_0xccb501-0x1b0,_0x3c077f- -0x648);}function _0x370169(_0x1721ab,_0x4a0eb1,_0x3ab9ed,_0x4ae68b){return _0x45bcad(_0x1721ab-0x1f7,_0x4a0eb1-0xdb,_0x4ae68b,_0x4ae68b-0xe0);}const _0xa55c30={'EDnSg':_0x13efb3[_0x195df5(-0x1c4,-0x214,-0xdd,-0x170)],'kOFOI':function(_0x31e916,_0x33f012){return _0x13efb3['FYbua'](_0x31e916,_0x33f012);}};if(_0x13efb3[_0x370169(0x319,0x2b4,0x3de,0x336)](_0x13efb3[_0x195df5(-0x1c,-0x77,-0x93,-0xe2)],_0x13efb3['qQDmK'])){_0x3a2bd7=_0x5a6409;const _0x3354d0={};_0x3354d0['Content-Ty'+'pe']=_0xa55c30[_0x370169(0x2e3,0x2c6,0x2af,0x21d)],_0x3354d0[_0x370169(0x394,0x3c7,0x3e1,0x361)+'ion']='Bearer\x20'+_0x257770,_0x367aa1=_0x3354d0,_0x498680=_0x352768,_0xa55c30['kOFOI'](_0x577aa3,_0x195df5(-0x134,-0x132,-0x15e,-0x104)+_0x195df5(-0x11f,-0x1ed,-0x113,-0x16c));}else{const _0x2f2684=new FileReader();_0x2f2684[_0x195df5(-0x235,-0x26f,-0x196,-0x1e4)]=()=>_0x400039(_0x2f2684[_0x195df5(-0x242,-0x2ed,-0x1e3,-0x237)]),_0x2f2684[_0x195df5(-0xa9,-0x4e,-0xb7,-0xe8)]=_0x1f67f0,_0x2f2684[_0x370169(0x42e,0x368,0x447,0x422)+_0x195df5(-0x2c1,-0x2b6,-0x17a,-0x21c)](_0x2256c0);}});_0x394d1f=_0x3fe4ac,_0x13efb3[_0x45bcad(0x214,0x2b4,0x196,0x17a)](addLog,_0x13efb3[_0x24e61e(0x49f,0x4de,0x44f,0x526)]);}catch(_0x21a0c8){addLog(_0x45bcad(0x1a6,0x25d,0x221,0x105)+'ailed\x20to\x20f'+_0x45bcad(0x19c,0xf2,0x24c,0x113)+_0x45bcad(0xe8,0xe0,0xbf,0x44)+'\x20'+_0x21a0c8[_0x45bcad(0x272,0x320,0x1f7,0x2ad)]),_0x394d1f=_0x304097,_0x13efb3[_0x24e61e(0x43a,0x533,0x3ea,0x4a3)](addLog,_0x13efb3['GAWNi']);}}else _0x13efb3[_0x24e61e(0x4c3,0x502,0x45a,0x507)](_0x13efb3[_0x45bcad(0x189,0x23b,0x188,0x235)],_0x13efb3[_0x24e61e(0x4b8,0x4a2,0x4ba,0x413)])?_0x13efb3['ORVTW'](addLog,_0x13efb3[_0x24e61e(0x4a6,0x4c7,0x44f,0x483)]):_0x25f206=_0x13efb3['MRKUo'](_0x318edc+_0x45bcad(0x1e0,0x290,0x1d3,0x243),_0x1ff576);}}}}if(!_0x394d1f){if(_0x13efb3[_0x24e61e(0x530,0x51d,0x585,0x527)](_0x13efb3[_0x24e61e(0x541,0x429,0x41f,0x4a4)],_0x45bcad(0xf8,0x39,0xdc,0xb5)))throw new Error(_0x13efb3[_0x45bcad(0x26c,0x32d,0x314,0x1e0)]);else{const {taskId:_0x130344}=_0x171b57;_0x14fdc6(_0x45bcad(0x22d,0x2d3,0x2c5,0x197)+_0x45bcad(0x247,0x1ea,0x20b,0x30b)+_0x24e61e(0x439,0x37e,0x39d,0x3ee)+_0x130344+')');if(_0x5ad4eb===_0x130344&&_0x518835){const _0x2c9e42=_0x24e61e(0x4c9,0x5fe,0x5af,0x529)[_0x24e61e(0x3c8,0x4b4,0x35f,0x41b)]('|');let _0x487da2=-0x14f0+-0x151a+0x2a0a*0x1;while(!![]){switch(_0x2c9e42[_0x487da2++]){case'0':_0x492ebe[_0x24e61e(0x440,0x48d,0x44b,0x46d)](_0x36072c[_0x45bcad(0x23c,0x290,0x28e,0x2c4)+'MAGE_RESPO'+'NSE'],{'id':_0x505274,'success':![],'error':_0x13efb3[_0x45bcad(0x140,0x7d,0xcf,0x149)],'prompt':_0x13efb3[_0x24e61e(0x593,0x491,0x5f2,0x567)](_0x4774da,'')});continue;case'1':_0x5dc2a0=null;continue;case'2':_0x1dd3f5(_0x45bcad(0x1e3,0x188,0x17f,0x13e)+_0x45bcad(0x258,0x232,0x1d0,0x286)+_0x45bcad(0x1a9,0x129,0x178,0x22f)+_0xb619d4+')');continue;case'3':_0x3c73c7=null;continue;case'4':_0x1ea2e0=null;continue;}break;}}}}return _0x13efb3[_0x24e61e(0x4fa,0x3dd,0x41b,0x43a)](addLog,_0x13efb3['hDMOS']),taskQueue[_0x24e61e(0x48a,0x3f5,0x578,0x4a2)+'sk'](_0x45c759,!![]),currentTaskId=null,{'image':_0x394d1f,'change':_0x13efb3[_0x45bcad(0x12a,0x76,0x12d,0x10d)](_0x555536,'')};}}catch(_0x2888c6){addLog(_0x24e61e(0x400,0x546,0x577,0x4b7)+_0x45bcad(0x1d0,0x27e,0x144,0x20f)+':\x20'+_0x2888c6[_0x24e61e(0x5ad,0x637,0x57e,0x583)]),console[_0x45bcad(0x274,0x1d6,0x2aa,0x1ed)](_0x13efb3[_0x24e61e(0x409,0x440,0x3e9,0x3f1)],_0x2888c6);if(_0x2888c6[_0x24e61e(0x5b1,0x55b,0x537,0x583)]===_0x13efb3[_0x24e61e(0x3c3,0x524,0x3a7,0x451)]){}else{if(_0x13efb3['hqDSS']!=='hGeto'){const _0x22a2c9=new _0x1948b9();_0x22a2c9['onloadend']=()=>_0xf698a8(_0x22a2c9[_0x24e61e(0x37c,0x3e8,0x495,0x411)]),_0x22a2c9['onerror']=_0x5ab0c4,_0x22a2c9[_0x45bcad(0x237,0x213,0x1e1,0x162)+_0x24e61e(0x384,0x3cd,0x4dd,0x42c)](_0x149621);}else taskQueue[_0x24e61e(0x3cb,0x450,0x4c3,0x4a2)+'sk'](_0x45c759,![]);}currentTaskId=null;throw _0x2888c6;}}export async function bananaGenerate(_0x2978e3){const _0x120dc3={'VwpFn':_0x45df21(0xb4,0xdc,0xca,-0x1a),'kHTwh':function(_0x193777,_0x32eb4c){return _0x193777+_0x32eb4c;},'POSKM':_0x45df21(0x177,0x12d,0x112,0x1d4),'XamJK':_0x597676(0x49d,0x4b1,0x528,0x50b),'AMvkq':_0x597676(0x62a,0x675,0x62c,0x67d),'WbyCA':function(_0x455e06,_0x1f2cfb){return _0x455e06(_0x1f2cfb);},'rLBKz':_0x597676(0x46b,0x4d8,0x505,0x478)+'坐标的提示词字符串。','AtfME':function(_0x271603,_0x512d5e){return _0x271603(_0x512d5e);},'OhjsL':_0x45df21(0x1b4,0x139,0x19e,0x1a9)+'osition','lgYZh':function(_0x3251a6,_0x997dc0){return _0x3251a6<=_0x997dc0;},'GNSoS':_0x597676(0x489,0x540,0x4fc,0x573)+'esponse\x20co'+_0x597676(0x63b,0x604,0x65f,0x5c4)+_0x45df21(0x183,0xb0,0xdb,0x1b2)+_0x597676(0x66d,0x627,0x5cd,0x5d7),'nfidL':_0x45df21(0x199,0x250,0x188,0x23e)+'cancel_ban'+_0x45df21(0x207,0x251,0x210,0x266),'nAFDT':function(_0x420a28,_0x322ba7){return _0x420a28(_0x322ba7);},'YASmA':_0x597676(0x673,0x669,0x5c0,0x5d3)+_0x597676(0x6a7,0x6a6,0x62a,0x5a7),'ztbYl':_0x45df21(0x1d9,0x230,0x206,0x142),'JxrQq':_0x597676(0x463,0x48d,0x502,0x48a),'xsXIb':_0x45df21(0x1f0,0x29f,0x1b0,0x2c5),'LeOTL':function(_0x1388b8){return _0x1388b8();},'XcpLh':function(_0x57dd7b,_0x290b5b){return _0x57dd7b!==_0x290b5b;},'xdHQZ':_0x597676(0x4d3,0x538,0x57b,0x62f),'IiikB':_0x597676(0x549,0x5b4,0x5d1,0x682),'uqKUa':function(_0x1fa02a,_0x424251){return _0x1fa02a(_0x424251);},'XOtdQ':_0x45df21(0x116,0xf5,0x129,0x43),'GGpyu':_0x597676(0x5e3,0x57c,0x58e,0x5cc),'vshBj':function(_0xd6c599,_0x4c20c4,_0x12d847,_0x2fce2b){return _0xd6c599(_0x4c20c4,_0x12d847,_0x2fce2b);},'FjRTO':function(_0xdf92e6,_0x507d0d){return _0xdf92e6===_0x507d0d;},'ShGMD':_0x597676(0x758,0x74d,0x67f,0x68a),'GkDXO':function(_0x275b77,_0x487558){return _0x275b77(_0x487558);},'yKEcZ':_0x597676(0x64a,0x6fb,0x655,0x6d2),'gkJec':function(_0x34231b,_0x5cb2a4){return _0x34231b(_0x5cb2a4);}};function _0x597676(_0x485c71,_0x32eae3,_0xf4de19,_0x14ec73){return _0x4c7e(_0xf4de19-0x379,_0x485c71);}function _0x45df21(_0x4041a9,_0x811f57,_0x4b2997,_0xb4308d){return _0x4c7e(_0x4041a9- -0x10b,_0xb4308d);}_0x120dc3[_0x597676(0x676,0x673,0x663,0x609)](clearLog);let {id:_0x317819,prompt:_0x550574,width:_0x3ec0f3,height:_0x127ae1,change:_0x2c6dcf,retouchPrompt:_0x380c63,retouchImage:_0x1631be}=_0x2978e3;currentRequestId=_0x317819,currentPrompt=_0x550574,_0x120dc3[_0x45df21(0x6d,0xbc,-0x17,0x130)](addLog,_0x45df21(0x78,0x6c,0x14f,0x11f)+_0x45df21(0x92,0x20,0xfe,-0x43)+'age\x20genera'+'tion\x20reque'+_0x45df21(0x14a,0x183,0x71,0xd3)+_0x317819+')');let _0x4dc149='';if(_0x2c6dcf)_0x4dc149=_0x2c6dcf[_0x45df21(0x151,0x18d,0x8d,0x20a)]('{修图}','');else{if(_0x120dc3['XcpLh'](_0x120dc3[_0x597676(0x5f7,0x5ed,0x60c,0x569)],_0x120dc3[_0x45df21(0x188,0xb5,0x18b,0x1f9)])){let _0x481f7e=_0x194dc3;!_0x481f7e[_0x597676(0x624,0x565,0x576,0x50c)]('/v1')&&!_0x481f7e[_0x45df21(0xde,0x19e,0x172,0x110)](_0x120dc3[_0x45df21(0x212,0x292,0x17c,0x271)])&&(_0x481f7e=_0x120dc3[_0x597676(0x56f,0x42a,0x4f9,0x541)](_0x481f7e,'/v1'));_0x481f7e=_0x481f7e[_0x45df21(0x6f,-0x58,0xc4,0x120)](/\/v1\/$/,_0x120dc3[_0x597676(0x535,0x4eb,0x4ed,0x46e)]),_0x338942='/api/backe'+'nds/chat-c'+_0x45df21(0x1e4,0x2b2,0x117,0x214)+_0x597676(0x48e,0x568,0x53e,0x591),_0x20ebe1=_0x30cb86(_0x4b04da['token']);const _0x5aecb8={};_0x5aecb8['chat_compl'+_0x597676(0x66b,0x5fb,0x690,0x5ca)+'ce']=_0x120dc3[_0x45df21(0xa5,-0x1b,-0xf,0x56)],_0x5aecb8[_0x597676(0x5df,0x5c6,0x50e,0x52c)]=_0x481f7e,_0x5aecb8[_0x45df21(0x1fd,0x2c4,0x2b8,0x127)+_0x45df21(0x11b,0x124,0x4b,0x88)+'rs']=_0x597676(0x5da,0x622,0x5b8,0x63d)+_0x45df21(0x1d4,0x259,0x1ea,0x136)+_0x45df21(0x145,0xc7,0x8e,0x92)+_0x489de6+'\x22',_0x5aecb8[_0x597676(0x5dd,0x505,0x575,0x4e0)]=_0x21e6cc,_0x5aecb8[_0x45df21(0x124,0x1bb,0x158,0x8b)]=_0x356abc[_0x45df21(0x124,0x14e,0xe7,0x1a3)],_0x5aecb8[_0x45df21(0x110,0x195,0x112,0x11a)]=![],_0xeeaf84=_0x5aecb8;if(_0x5d3e81[_0x45df21(0x19b,0x177,0x1ad,0xc2)](_0x120dc3[_0x597676(0x596,0x5a5,0x636,0x682)])){_0x15ecd9(_0x45df21(0xd6,0x4d,0x122,0x1a)+_0x597676(0x62e,0x66a,0x667,0x59a)+_0x45df21(0xeb,0x48,0x11a,0x3b)+_0x45df21(0x8c,0x14b,0xc9,0x42)),_0x4d7678=_0x23bd25;const _0x61ba26={};_0x61ba26[_0x597676(0x51a,0x419,0x4e8,0x4dd)+'pe']=_0x45df21(0x1c6,0x14e,0x10b,0x25c)+'n/json',_0x61ba26[_0x597676(0x5be,0x671,0x5b8,0x675)+_0x45df21(0x1b1,0x288,0x1fa,0x1b5)]='Bearer\x20'+_0xbef1a2,_0x2aebbc=_0x61ba26,_0x7d6e3e=_0x589e1f;}_0x6f873c(_0x597676(0x5d0,0x646,0x64e,0x585)+'用酒馆代理模式');}else _0x4dc149=_0x550574;}if(_0x2c6dcf&&_0x2c6dcf[_0x45df21(0xde,0x60,0x44,0xed)](_0x120dc3[_0x597676(0x6af,0x5dc,0x5f1,0x55c)])){_0x120dc3[_0x45df21(0x16b,0x9a,0xc3,0x137)](addLog,_0x45df21(0x88,0xf8,0x45,0x14a)+'启动');if(_0x380c63)addLog(_0x597676(0x5ca,0x64f,0x646,0x66f)+_0x380c63);if(_0x1631be)_0x120dc3[_0x597676(0x54f,0x5f0,0x54b,0x483)](addLog,_0x597676(0x519,0x569,0x5bf,0x617)+']');}try{if(_0x45df21(0x17c,0x18d,0x191,0x1b9)===_0x120dc3[_0x45df21(0x19e,0x174,0x221,0xdf)]){_0x120dc3['WbyCA'](_0xfc87d,_0x120dc3[_0x45df21(0xb3,0xf9,0x16b,-0x26)]),_0x21d6a1=_0x120dc3[_0x45df21(0x6d,0x13f,0xd2,0xb2)](_0x3ff724,_0x1c6542),_0x451cc6=_0x51a728[_0x120dc3[_0x45df21(0xa7,0x29,0x1e,0x5e)]];for(let _0x5786c7=0xa88+0x24cc+0x5*-0x977;_0x120dc3[_0x45df21(0x154,0xa1,0x1f5,0x21c)](_0x5786c7,-0x26*0x5e+-0x1*-0x14cb+0x6d3*-0x1);_0x5786c7++){_0x71b165[_0x597676(0x577,0x53e,0x605,0x65c)+_0x5786c7+_0x597676(0x533,0x4db,0x541,0x554)]&&(_0x458f80=_0x1fe010+',\x20'+_0x3c3bfb[_0x45df21(0x181,0x233,0xd9,0x14f)+_0x5786c7+_0x597676(0x588,0x489,0x541,0x4c2)]);}}else{const {image:_0xf951d1,change:_0x37b1b3}=await generateBananaImage({'prompt':_0x550574,'width':_0x3ec0f3,'height':_0x127ae1,'change':_0x2c6dcf,'retouchPrompt':_0x380c63,'retouchImage':_0x1631be});if(extension_settings[extensionName][_0x597676(0x5f0,0x5dc,0x590,0x5d8)]!='0'){if(_0x120dc3[_0x597676(0x5b5,0x5b7,0x4ee,0x54f)](_0x597676(0x5c9,0x541,0x508,0x45d),_0x120dc3[_0x597676(0x4ec,0x628,0x578,0x4b1)])){const _0x5ce866={};_0x5ce866['change']=_0x4dc149,await _0x120dc3[_0x45df21(0x178,0x1e5,0xa2,0x10e)](setItemImg,_0x550574,_0xf951d1,_0x5ce866),_0x120dc3[_0x45df21(0x16b,0x242,0x19b,0x17b)](addLog,_0x45df21(0xb6,-0x1b,0xb3,0x150)+_0x597676(0x4a4,0x482,0x4e7,0x444)+'\x20'+_0x550574),extension_settings[extensionName][_0x597676(0x584,0x643,0x65b,0x5f8)][_0x597676(0x623,0x57e,0x649,0x5cc)]?_0x120dc3[_0x45df21(0xcd,0xad,0x1a5,0xe7)](_0x45df21(0x1fb,0x1ca,0x19c,0x1e6),_0x120dc3[_0x597676(0x52e,0x554,0x520,0x48a)])?(extension_settings[extensionName][_0x45df21(0x1d7,0x1d0,0x202,0x19c)]['cishu']=extension_settings[extensionName]['banana']['cishu']+(-0x7b5*0x2+0xcd3+0x298),addLog(_0x597676(0x509,0x5d0,0x4fd,0x4eb)+_0x597676(0x4fe,0x639,0x59c,0x561)+extension_settings[extensionName][_0x597676(0x6b0,0x730,0x65b,0x70a)][_0x45df21(0x1c5,0x1ac,0x1f6,0x16a)])):_0x2f8e9b(_0x120dc3['GNSoS']):(extension_settings[extensionName]['banana'][_0x45df21(0x1c5,0x1da,0x248,0x23d)]=0x18c0+0x3*0xfe+-0x1bb9,_0x120dc3['GkDXO'](addLog,'当前生图次数为\x20fo'+_0x597676(0x54d,0x500,0x59c,0x4d3)+extension_settings[extensionName][_0x597676(0x6ed,0x5d3,0x65b,0x58f)]['cishu']));}else _0x11142d['on'](_0x4b5e37['GENERATE_I'+_0x597676(0x65a,0x5c6,0x5d2,0x5a3)+'ST'],_0x1b9d0d),_0x1f2b98['on'](_0x120dc3[_0x597676(0x5fd,0x4e7,0x55e,0x5d6)],_0x38a914),_0x120dc3[_0x45df21(0x1cf,0x103,0x297,0x232)](_0x2726b5,_0x120dc3[_0x45df21(0xf6,0x1cb,0xaf,0xf5)]);}else{if(_0x120dc3[_0x45df21(0x204,0x222,0x286,0x236)]===_0x597676(0x57b,0x5e4,0x526,0x5c4)){_0x33f1f2='/v1beta/mo'+'dels/'+_0x22dd40;const _0x4b7703={};_0x4b7703[_0x45df21(0xe0,0x4d,0x19e,0x115)+'t']='';const _0x111745=_0x3ea90b[_0x4ee81e]||_0x4b7703,_0xb967c3=[_0x111745[_0x45df21(0xe0,0x168,0xf3,0x106)+'t'],_0x5197f0[_0x120dc3[_0x597676(0x5b0,0x4d8,0x51f,0x550)]],_0x104b1b[_0x120dc3[_0x45df21(0x90,0x90,-0x11,0x145)]],_0x3796d1,_0x7eaf33[_0x45df21(0x89,0x133,0x117,-0x49)],_0x14a0cd[_0x120dc3[_0x597676(0x6ea,0x6a0,0x647,0x6e1)]],_0x111745[_0x597676(0x5b4,0x62f,0x5fd,0x5d8)+_0x597676(0x654,0x4de,0x591,0x637)],_0x471000[_0x597676(0x5b6,0x614,0x640,0x5ca)]]['filter'](_0x267e52)[_0x597676(0x50d,0x4f8,0x4fe,0x536)](',\x20');_0x120dc3[_0x597676(0x494,0x510,0x4f1,0x5a4)](_0x3f1b05,_0x597676(0x5ad,0x52c,0x593,0x50b)+_0xb967c3);const _0x2a70dc={};_0x2a70dc[_0x597676(0x587,0x4f4,0x54e,0x481)]=_0xb967c3;const _0x478fdd={};_0x478fdd[_0x597676(0x672,0x593,0x64c,0x647)+'t']=0x1,_0x478fdd[_0x597676(0x619,0x5b7,0x585,0x52a)+'o']=_0x55d1cc;const _0x255d89={};_0x255d89['instances']=[_0x2a70dc],_0x255d89[_0x45df21(0x163,0x19b,0x1fc,0xe6)]=_0x478fdd,_0x5a3cbd=_0x255d89,_0x19a48a(_0x45df21(0xe5,0x35,0xf9,0x188)+_0x597676(0x616,0x6d6,0x62d,0x61e)+_0x597676(0x470,0x465,0x509,0x541)+_0x45df21(0x147,0xa3,0x136,0xb6)+_0x597676(0x503,0x478,0x527,0x524)+_0xb967c3);}else _0x120dc3[_0x597676(0x4e6,0x60a,0x599,0x5ca)](addLog,'缓存设置为不存入数据'+'库');}const _0x56701b={};_0x56701b['id']=_0x317819,_0x56701b[_0x45df21(0x1f9,0x253,0x28a,0x2a2)]=!![],_0x56701b[_0x597676(0x650,0x577,0x5aa,0x559)]=_0xf951d1,_0x56701b['prompt']=_0x550574,_0x56701b[_0x597676(0x67e,0x69b,0x669,0x669)]=_0x4dc149,eventSource[_0x597676(0x629,0x4ba,0x577,0x580)](EventType[_0x45df21(0x1d3,0x211,0x1e9,0x26a)+_0x45df21(0xcc,0x141,0x87,0x198)+_0x45df21(0x73,0xc7,0x72,0x1d)],_0x56701b),_0x120dc3['uqKUa'](addLog,'[Banana]\x20E'+_0x597676(0x5a4,0x640,0x650,0x6bb)+'cess\x20respo'+_0x45df21(0xb7,0x18c,0x76,0x22)+':\x20'+_0x317819);}}catch(_0x2a1ce7){const _0xf10e8c=_0x597676(0x4cb,0x5b6,0x597,0x5a3)+_0x597676(0x542,0x54d,0x524,0x4f6)+_0x45df21(0x11a,0x160,0x1b3,0x1c1)+'\x20ID\x20'+_0x317819+':\x20'+_0x2a1ce7['message'];addLog(_0xf10e8c),console[_0x597676(0x63e,0x5c2,0x68f,0x682)](_0xf10e8c);const _0x4b9f86={};_0x4b9f86['id']=_0x317819,_0x4b9f86[_0x597676(0x5d8,0x67a,0x67d,0x66b)]=![],_0x4b9f86['error']=_0x2a1ce7[_0x45df21(0x209,0x137,0x1c1,0x2a7)],_0x4b9f86['prompt']=_0x550574,eventSource[_0x45df21(0xf3,0x8b,0x1b2,0xd6)](EventType['GENERATE_I'+_0x45df21(0xcc,0x3e,0x98,0x114)+_0x597676(0x4c2,0x4d0,0x4f7,0x558)],_0x4b9f86),_0x120dc3['uqKUa'](addLog,_0x597676(0x5cd,0x6a6,0x66f,0x5a3)+_0x597676(0x5d9,0x566,0x570,0x624)+_0x45df21(0x106,0x1a8,0x82,0x140)+_0x597676(0x54d,0x605,0x53b,0x4e8)+':\x20'+_0x317819);}}function handleCancelBananaTask(_0x28a4f4){const _0x230bea={'ZGbvc':function(_0x240f6d,_0x7b2715){return _0x240f6d(_0x7b2715);},'thNBG':function(_0x4fc717,_0x4a7c98){return _0x4fc717===_0x4a7c98;},'ohHZS':_0x274e36(-0x1cd,-0x263,-0x1b1,-0x229),'lfaBE':function(_0x4afdc5,_0x5c2259){return _0x4afdc5||_0x5c2259;}},{taskId:_0x1b6a2e}=_0x28a4f4;_0x230bea[_0x274e36(-0x4c,0x86,0x77,-0xec)](addLog,'[Banana]\x20收'+_0x274e36(-0x76,-0x142,-0x147,0x30)+_0x274e36(-0x1e0,-0x2ad,-0x1bb,-0x187)+_0x1b6a2e+')');function _0x274e36(_0x129a02,_0x4cc58f,_0x4432a5,_0x228a3c){return _0x4c7e(_0x129a02- -0x35f,_0x4cc58f);}function _0x47bd79(_0x5b6d28,_0x1194a2,_0x59fc9f,_0x3a0c55){return _0x4c7e(_0x1194a2- -0x2f5,_0x59fc9f);}_0x230bea[_0x274e36(-0xd5,-0x79,-0xeb,-0x20)](currentTaskId,_0x1b6a2e)&&currentRequestId&&(_0x230bea['ZGbvc'](addLog,_0x47bd79(-0x102,-0x70,-0xb5,-0x87)+_0x274e36(-0x65,-0xbc,-0xb4,-0xae)+'响应\x20(ID:\x20'+currentRequestId+')'),eventSource['emit'](EventType[_0x47bd79(0xb7,-0x17,0x56,-0xd1)+_0x274e36(-0x188,-0x11b,-0x25c,-0x20b)+_0x47bd79(-0x1ae,-0x177,-0xff,-0x11b)],{'id':currentRequestId,'success':![],'error':_0x230bea[_0x274e36(-0x17c,-0x223,-0x251,-0x205)],'prompt':_0x230bea['lfaBE'](currentPrompt,'')}),currentTaskId=null,currentRequestId=null,currentPrompt=null);}function initializeBananaListener(){const _0x1699ab={'dyLPW':_0x382f29(0x59b,0x670,0x60f,0x56c)+_0x382f29(0x5a9,0x5cd,0x5ed,0x55a)+_0x342ab9(0x4d,-0x4f,-0x57,0x67),'rQZpD':function(_0x42e20e,_0x28d46a){return _0x42e20e(_0x28d46a);},'KvzhE':_0x382f29(0x53e,0x5b4,0x508,0x593)+_0x382f29(0x5a8,0x5f6,0x59c,0x4e1)};eventSource['on'](EventType['GENERATE_I'+_0x342ab9(-0x1d2,-0x196,-0x110,-0x9b)+'ST'],bananaGenerate);function _0x342ab9(_0xcb0623,_0x565961,_0x437aa6,_0x1f80a2){return _0x4c7e(_0x437aa6- -0x369,_0x1f80a2);}function _0x382f29(_0x288cb3,_0x9bd4d3,_0x5e8470,_0x5094be){return _0x4c7e(_0x288cb3-0x2f7,_0x5094be);}eventSource['on'](_0x1699ab[_0x382f29(0x509,0x450,0x4df,0x4b0)],handleCancelBananaTask),_0x1699ab[_0x382f29(0x5f5,0x62f,0x6a6,0x5ef)](addLog,_0x1699ab['KvzhE']);}export async function replaceWithBanana(){const _0x3f8777={'wjZjX':function(_0x5cca0f,_0x1c5fde){return _0x5cca0f+_0x1c5fde;},'LSoNA':_0x2d2517(0x232,0x1bf,0x294,0x2f3),'HZBpw':_0x2d2517(0x1f3,0x1fd,0x19d,0x257)+'+$','ZIrHe':function(_0x172564,_0xc1f449){return _0x172564===_0xc1f449;},'UqJBl':_0x2d2517(0x2e9,0x31e,0x2ae,0x318),'nHrET':function(_0x9881f6,_0xf2e745){return _0x9881f6(_0xf2e745);},'hmthf':function(_0x1064ba,_0x39fc4e){return _0x1064ba||_0x39fc4e;},'alnvC':function(_0x505aeb,_0x4b7d75){return _0x505aeb(_0x4b7d75);},'WXovw':function(_0x34fb01,_0x151aab){return _0x34fb01==_0x151aab;},'OaRGv':_0x225d10(0x6ae,0x6cc,0x691,0x64d),'ymnAP':function(_0x3492d6,_0x35ce6c){return _0x3492d6!==_0x35ce6c;},'ndInV':'JlCRz','WoKoi':_0x225d10(0x51e,0x5a1,0x600,0x5e7),'XJxqu':function(_0x8c55ea){return _0x8c55ea();},'RCJoz':function(_0x2d5818){return _0x2d5818();},'wemcp':_0x225d10(0x5bb,0x575,0x447,0x514),'ntAWq':_0x2d2517(0x353,0x1f7,0x2b6,0x2e2)+_0x225d10(0x674,0x5f0,0x6a9,0x61d)+_0x225d10(0x747,0x5f3,0x751,0x67d),'kXPKQ':'[Banana]\x20生'+_0x225d10(0x5ac,0x4f3,0x515,0x575)};function _0x225d10(_0x3f9529,_0x531478,_0x52eefc,_0x55d82a){return _0x4c7e(_0x55d82a-0x36b,_0x3f9529);}function _0x2d2517(_0x319aad,_0x1075cf,_0x5099be,_0x11a7cf){return _0x4c7e(_0x5099be-0x12,_0x11a7cf);}if(_0x3f8777[_0x2d2517(0x1fd,0x29c,0x20d,0x13a)](extension_settings[extensionName][_0x2d2517(0x362,0x362,0x2b9,0x208)],_0x3f8777[_0x225d10(0x4ac,0x53d,0x53e,0x573)]))!window[_0x2d2517(0x271,0x30c,0x323,0x2a4)+_0x2d2517(0x30d,0x1ae,0x23f,0x19b)+_0x225d10(0x563,0x59d,0x4c5,0x4e8)]&&(_0x3f8777[_0x225d10(0x5a8,0x524,0x5a0,0x584)](_0x3f8777[_0x2d2517(0x1c1,0x1e8,0x1c6,0x1e2)],_0x3f8777[_0x2d2517(0x24a,0x315,0x289,0x350)])?(window[_0x225d10(0x651,0x629,0x697,0x67c)+_0x2d2517(0x293,0x1ea,0x23f,0x2ec)+'ener']=!![],_0x3f8777[_0x2d2517(0x282,0x262,0x2b3,0x348)](initializeBananaListener)):_0x2f4ca9=_0x3f8777[_0x225d10(0x552,0x559,0x5d1,0x545)](_0x4c80ba,_0x3f8777[_0x2d2517(0x1b1,0x29c,0x24c,0x202)])),_0x3f8777[_0x225d10(0x5ac,0x63f,0x56d,0x5a6)](initializeImageProcessing);else{if(_0x3f8777[_0x2d2517(0x2f5,0x2f4,0x306,0x374)](_0x3f8777['wemcp'],_0x3f8777[_0x2d2517(0x2eb,0x147,0x216,0x1d0)]))window['initialize'+'BananaList'+_0x225d10(0x4f9,0x520,0x566,0x4e8)]&&(eventSource['removeList'+_0x2d2517(0x224,0x15c,0x18f,0xc1)](EventType[_0x225d10(0x649,0x57d,0x605,0x649)+_0x225d10(0x598,0x599,0x4f8,0x5c4)+'ST'],bananaGenerate),eventSource[_0x225d10(0x584,0x5c9,0x63e,0x5a4)+_0x225d10(0x45b,0x52c,0x57d,0x4e8)](_0x3f8777['ntAWq'],handleCancelBananaTask),LEGACY_EVENT_NAMES[_0x2d2517(0x1fb,0x141,0x1e8,0x201)](_0x319f4f=>{function _0x1f8ccd(_0xbe595,_0x45a10c,_0x14f015,_0x308e39){return _0x225d10(_0xbe595,_0x45a10c-0x20,_0x14f015-0x188,_0x308e39- -0x49d);}function _0x5b6757(_0x5d2d00,_0x258cc4,_0xfdb738,_0x2cd25f){return _0x2d2517(_0x5d2d00-0xd1,_0x258cc4-0x53,_0x258cc4-0x3b4,_0x2cd25f);}if(_0x3f8777['ZIrHe'](_0x5b6757(0x5b9,0x64e,0x719,0x61b),_0x3f8777[_0x5b6757(0x621,0x690,0x652,0x648)]))return _0x147a93[_0x5b6757(0x5fc,0x65f,0x5b4,0x6c4)]()[_0x5b6757(0x63c,0x686,0x6c7,0x5b8)](xAOQXV[_0x5b6757(0x62b,0x5b5,0x585,0x68d)])[_0x1f8ccd(0xdb,0xf5,0x14a,0x167)]()['constructo'+'r'](_0x2cb307)['search'](xAOQXV[_0x1f8ccd(0xa5,0x5b,0x1c,0xbd)]);else eventSource[_0x5b6757(0x5b0,0x5ff,0x612,0x600)+_0x5b6757(0x50b,0x543,0x611,0x4c6)](_0x319f4f,bananaGenerate);}),window[_0x2d2517(0x3d8,0x343,0x323,0x24f)+_0x2d2517(0x22c,0x240,0x23f,0x17f)+'ener']=![],addLog(_0x3f8777[_0x2d2517(0x230,0x2fc,0x236,0x2a6)]));else{_0x3f8777[_0x2d2517(0x2a7,0x254,0x275,0x32c)](_0x331f27,_0x2d2517(0x2c2,0x17f,0x220,0x219)+_0x225d10(0x6ca,0x5b6,0x684,0x60e)+'。');const _0x52448d=_0x3f8777[_0x225d10(0x4ff,0x635,0x609,0x5ad)](_0x5a4ae8,'默认'),_0xf71b14={};_0xf71b14[_0x2d2517(0x363,0x2b1,0x2bf,0x25a)+'on']=[],_0xf71b14[_0x225d10(0x48e,0x57b,0x4da,0x556)+'t']='',_0x939cc2=_0x2b85ac[_0x52448d]||_0xf71b14,_0x3f8777['alnvC'](_0x3e0d30,'[Banana]\x20使'+_0x225d10(0x567,0x656,0x668,0x5fc)+_0x52448d+'\x22');}}}