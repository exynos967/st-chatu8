(function(_0x32ab7d,_0x5df68e){const _0x143036=_0x32ab7d();function _0x5106e7(_0x22abfa,_0x13d846,_0x23d61d,_0x2878bc){return _0x2b41(_0x13d846-0x34d,_0x22abfa);}function _0x583c71(_0x2f93d0,_0x3a0592,_0x1cd9be,_0x2ea6d0){return _0x2b41(_0x2ea6d0-0x34c,_0x1cd9be);}while(!![]){try{const _0x14e283=-parseInt(_0x583c71(0x639,0x5d7,0x565,0x5e3))/(-0x20*0x7a+0xb7+0x745*0x2)+-parseInt(_0x583c71(0x4bd,0x528,0x5c7,0x533))/(-0x13*0x107+-0x6*0x2fc+0x559*0x7)+parseInt(_0x5106e7(0x630,0x56c,0x544,0x4ad))/(0x282+0x11fd+-0x1*0x147c)+-parseInt(_0x5106e7(0x4e9,0x4a0,0x43b,0x48f))/(-0x17c0+0x126d+-0x557*-0x1)*(parseInt(_0x583c71(0x47c,0x453,0x497,0x4ec))/(-0x1cdf+-0x1686+0x336a))+-parseInt(_0x5106e7(0x51c,0x51e,0x52f,0x4eb))/(0x20e4+-0x14*-0x1d+-0x2322)+-parseInt(_0x583c71(0x65b,0x539,0x666,0x5f4))/(0xd5f+0x16f9*0x1+-0x2451)*(-parseInt(_0x5106e7(0x41a,0x4be,0x4ec,0x446))/(-0x2522*-0x1+0x2*0x125+-0x4*0x9d9))+parseInt(_0x583c71(0x539,0x56f,0x6ac,0x5f7))/(0x1*-0xffd+-0x19e4+0x29ea);if(_0x14e283===_0x5df68e)break;else _0x143036['push'](_0x143036['shift']());}catch(_0x24f723){_0x143036['push'](_0x143036['shift']());}}}(_0x5a42,-0x156*-0x146+-0x1*0x352ab+0x350ba));const _0x3710f5=(function(){let _0x445d3c=!![];return function(_0x154928,_0x3e3a72){const _0x1edced=_0x445d3c?function(){function _0x278b22(_0x562773,_0x12c974,_0x5a498e,_0x7af330){return _0x2b41(_0x562773-0x134,_0x7af330);}if(_0x3e3a72){const _0x430f76=_0x3e3a72[_0x278b22(0x342,0x3b1,0x37a,0x352)](_0x154928,arguments);return _0x3e3a72=null,_0x430f76;}}:function(){};return _0x445d3c=![],_0x1edced;};}()),_0x2d95fd=_0x3710f5(this,function(){function _0x449c7e(_0x5ea529,_0x5a7acd,_0x22b448,_0x15af4e){return _0x2b41(_0x5ea529- -0x8a,_0x5a7acd);}const _0x3ee544={};_0x3ee544['JaBQk']=_0x449c7e(0xd0,0x15d,0x108,0x5e)+'+$';const _0x236d00=_0x3ee544;function _0x115015(_0x1e8b22,_0x152866,_0x39eaf8,_0x3c013e){return _0x2b41(_0x1e8b22- -0x281,_0x3c013e);}return _0x2d95fd[_0x449c7e(0xc3,0x137,0x18c,0x156)]()[_0x115015(-0x11b,-0x120,-0x83,-0x67)](_0x236d00[_0x115015(-0x8c,-0x89,-0xcd,-0x89)])[_0x449c7e(0xc3,0x13b,0x11a,0xcf)]()['constructo'+'r'](_0x2d95fd)[_0x449c7e(0xdc,0xd6,0xa1,0x198)](_0x236d00[_0x449c7e(0x16b,0x236,0x119,0x103)]);});_0x2d95fd();import{extension_settings}from'../../../../extensions.js';import{eventSource}from'../../../../../script.js';import{extensionName,EventType}from'./config.js';import{sleep,generateRandomSeed,zhengmian,fumian,getRequestHeaders,prompt_replace,addLog,clearLog,parsePromptStringWithCoordinates,prompt_replace_for_character,stripChineseAnnotations,convertImageToJpeg}from'./utils.js';import{initializeImageProcessing}from'./iframe.js';import{processCharacterPrompt}from'./characterprompt.js';import{setItemImg}from'./database.js';import{getConfigImage}from'./configDatabase.js';import{taskQueue,TaskType,TaskStatus}from'./taskQueue.js';function getDirectHeaders(_0x14d2a5=null,_0x34ccf5=null){const _0x1b93b4={};_0x1b93b4[_0x51e25c(-0xdf,-0x1b,-0xb6,-0xe5)]=_0x51e25c(0x21,-0x121,-0x6b,0x37)+_0x51e25c(-0xda,-0x2,-0x74,0x22)+_0x51e25c(-0x52,-0x80,-0x61,-0x51)+_0x223382(0x5f8,0x680,0x59d,0x5f5)+_0x51e25c(-0x62,-0xe9,-0x2d,-0x49)+_0x51e25c(-0x155,-0x151,-0x8e,-0x6b)+_0x51e25c(-0x17,-0x4c,-0xa8,-0x54)+_0x223382(0x5af,0x60b,0x611,0x5a5)+_0x51e25c(-0x17c,-0x97,-0x150,-0x176)+_0x51e25c(0x11,-0x18,-0xb9,-0x11c)+_0x223382(0x5ea,0x5a6,0x644,0x6a4)+'6',_0x1b93b4[_0x51e25c(-0x56,0x9b,-0x2b,0x1f)]=_0x223382(0x644,0x595,0x635,0x5ea)+'pe',_0x1b93b4[_0x51e25c(-0xbc,-0x147,-0x114,-0x67)]=_0x223382(0x570,0x611,0x589,0x572)+_0x51e25c(-0x57,-0x6c,-0x17,-0x40);function _0x51e25c(_0x33c603,_0x277f3a,_0x38a428,_0x21fb40){return _0x2b41(_0x38a428- -0x2a2,_0x21fb40);}const _0x371a63=_0x1b93b4;function _0x223382(_0x3db6bc,_0x126f7f,_0xa74237,_0x15fc26){return _0x2b41(_0x3db6bc-0x36f,_0x126f7f);}const _0x2e2b86={};_0x2e2b86[_0x223382(0x5d1,0x59b,0x5fa,0x508)]=_0x371a63[_0x223382(0x55b,0x611,0x4d1,0x530)],_0x2e2b86[_0x51e25c(0xb7,-0xd8,-0x13,0x9e)]=_0x51e25c(-0x9c,-0x98,-0x142,-0x181);const _0x461ac6=_0x2e2b86;return _0x14d2a5&&(_0x461ac6[_0x371a63['tVtIt']]=_0x14d2a5),_0x34ccf5&&(_0x461ac6[_0x371a63[_0x51e25c(-0xcb,-0x113,-0x114,-0x90)]]=_0x34ccf5),_0x461ac6;}let currentTaskId=null,currentRequestId=null,currentPrompt=null;function _0x5a42(){const _0x4534bb=['55Qe5zU+54Mh','zMnqyMG','BgvUz3rO','zw5LCG','CMTKB3DUigLTyq','DcbVBMX5lcbUBW','DxrHEw8','mti2nJb4Dvjjuum','tufhrv9srvfvrq','y29TCgXLDgvuyq','Aw5NihrYAwDNzq','DgnUrMK','ieLeia','EeH2r1K','l2DLBMvYyxrL','zxrJAcbnyxjRza','DuPmAhm','C3rFy2HHDhu4xW','C2fTCgXLq291BG','qMzdBvu','B1boq0S','ru1pt2u','mcaOv2LUzg93CW','zMLSDgvY','qvbmt0K','BwL0DgvKihn1yW','qMfUyw5HtgLZDa','5l+U5zU+5zU+54MhoIbB5BEY5O+q5l6B','DxnLCG','zLboB0G','vxjys0C','tw96AwXSys81lG','AxDfAuC','CIbWCM9TChq6ia','vxngEMS','Dg9mB3DLCKnHCW','uhPtuwy','B2fKihDPDgGG','C3bSAxq','DcbMywLSzwqGDW','AwTLieDLy2TVkq','ie5uideWlJa7ia','tLnf','y3vZDg9Tx2LUyW','rMfPBgvKihrVia','uuHJq3O','C2XjCeK','CMvZDwX0','y29UDMvYC2f0Aq','zNnxuM4','5B2t5yMn55sF5zU+5QYH5PwW5lI6igzV','rg5KAM8','DgLVBIb3AxrOia','5OYb6yws6AAg5lUJ55cg77Ym5yIh5O2I5lI655U0','nhWZFdb8mNWX','57Yt5A2y6k6+572U5lI65lIn5A2y5ywL5PwW5O2U','vwjRAKi','rgnkD1a','zxiG','w0jHBMfUyv0Gsq','zMfPBgvKigzVCG','AuT6zue','rxnNzxm','AwzbCvq','BwPctfe','yMfUyw5Hq2HHCG','y0r2twK','AvfqC1m','uKHJvM0','BMnHALC','C3nMDwXSEs4','BwL0DgvKigzHAq','s256Agy','y29UDMvYDfrVsG','vxnLCI1bz2vUDa','twfYA2rVD24U','Aw1Hz2u','yxnZAxn0yw50','zKLMyNu','Aw9UoIaIqMvHCG','B3DUigLTywDLoG','yuPwqva','u3LjCNa','ChvZAa','CMvWBgfJzufSBa','rhDbDfC','55sO5l+U5zU+6Ake6k6+oIaI','wNDMz3O','BLLmteu','zxrJAcbLCNjVCG','wKHit1a','wLbsywi','iIbMCM9TihbYzq','ksbbChbSzvDLyG','zw5KC1DPDgG','Dfz0sxq','lcdPQ5JLUQyGlsa','BwfNzsbMCM9Tia','t0DrAhO','zMfYAs81mZCUmW','rKnztMG','AM9PBG','mxWYFdn8nhWW','AMLmCgK','l3yXl2nOyxqVyW','AhLLALq','AMLvv0e','zgf0ytPPBwfNzq','CMvWBgfJzq','t1D4q0K','C3qGkeLeoIa','CgvNu3rVCMfNzq','zxnWB25ZzsbJBW','v2LUnJq7ihG2na','B25SB2fKzw5K','Aw9U','wNPPEeS','rNrUCMO','55sO55U05O6L6k+35Rgc5QIH5BYp','qwnJzxb0','ywLSzwqGDg8GzG','5lU255Ur5zcS5zMO5BEY5yID5AEl5yYw44cc','r29cwNm','5zco572U5yMn','zuPVCNy','uMvnww4','shLRwe4','mtmYote2Cw9QB3nV','y2HHBMDL','CMj4rhm','A3HfCfu','u2nLBMuGq29TCa','yKviu3G','ihWG','teLuDNe','5zU+5lQl5lU255Ur5zcS5zMO5BEY5ywZ6zET44cc','ueX4Axm','BIbWyxLSB2fKia','yvjWB1G','5RAi5B2t5yMn5lU75yQH77Ym5y+r6ycb5AsX6lsL','ve5AsvG','zxrPB25FC291CG','5Q2J6z2I5O+q56s66k+noIa','yMfZzty0lG','odK0ntnnzermrhK','AxP3rLm','qvbjihjLC3bVBG','mJy5mdC5m1noC1vZAG','DhLWzq','vvjm','D2L0AcbWCM9TCa','Aw1Hz2vjza','B25LCNjVCG','Aw1Hz2veyxrH','C3rHCNrZv2L0Aa','zwTmzvq','EK52qva','l3yXyMv0ys9TBW','C3vIC3rYAw5N','r2vVA2u','BwfW','zLbzEem','zwrKzwqGyMfZzq','CMvHzefZrgf0yq','ANnVBG','Aw5PDgLHBgL6zq','ELjpCxC','Ehb0s0m','yxjRzg93BIbPBq','t1Pmv2e','C1PRB2K','B0X1t2K','5zU+5yop5BEY5A2y5ywL5PwW5O2U5BQtigy','y2XPzw50','C1LhCKy','igLTywDLihrVia','r1LhBuK','ignVBNrHAw4GAq','E+s/RUwBVN0','BLPVvMi','qMvkuxG','yxrLzcbZDwnJzq','mhWZFdr8mxWY','5lIT55QeihbYB21WDooaGG','zw5LCMf0Aw9Uia','nJqGAw1Hz2uU','t0nUz1a','rxzoq0G','5yIg6kEs6iMY5QIH5BYpoIdOP6pMNPdLUky','q29UDgvUDc1uEq','swDtBuS','De1QyNm','qxzPre0','zxrqyva','B0v1D08','kerPDMLKzv9YBW','DvjWCwu','C3rHDhvZ','DNf1CLa','zgXdvwu','BNnLigzVCIbjra','w0jHBMfUyv0G5l+U','Dg9tDhjPBMC','y2LZAhu','Dhj1zq','Bw9KzwW','yKnWtwG','ienOCM9Tzs8XmG','mZi0ngnVEMnSEG','uNPit3G','55sO5lQgihVKV67LM759ioAGH+IVHG','uNziBeu','DLHJC3K','s1vozvO','yw5Hx3rHC2S','kcGOlISPkYKRkq','ztOG','Aw1Hz2vFDxjS','svLvD3C','yxfty0W','5yIW5y+w5RAi5lU75yQH5lQl5lU2icHu','kI8Q','yNDusxa','Cgzwu3y','s3nbzMq','DKjqveu','B3vUzcbTyxrJAa','C2vHCMnO','DwDeseG','zM9YrwfJAa','v1bzuLG','zMv0y2GGAw1HzW','w0jHBMfUyv0GuG','DLfUweK','B3nPDgLVBG','uND5DKe','rwLhBKi','ALDewfC','odbhtuLYr3m','D0jHB0C','yMfUyw5H','D0DvzLO','uxj6zxG','zw1PDa','DhjPBq','sgHZrLm','yxnRsuq6ia','Dg9Rzw4','ywDLigDLBMvYyq','yxbWBgLJyxrPBW','z09mrvu','l3yX','y2vZCYbYzxnWBW','qMvHCMvYia','w0jHBMfUyv0Gra','ww9Uz0O','Bw9KywWGCgf5Ba','w0jHBMfUyv0G5zcV','A2jLC0C','teLyzgy','AxrOihn0yxr1CW','mhWYFdr8m3WX','EgHVDLC','s3flzfC','wMDnz2e','CNfOA0i','sM9Vqxy','q0HhqM8','AvPVweG','EwHurNe','sKzcD2u','yMfUyw5HioEuN+wBVUs6IW','y3vZDg9T','55sO5lQo55sF5OIq55QevgfNoIa','BhvKzv9OzwfKzq','BwHxtuq','zcbnyxjRzg93BG','tgLssfK','zML4zwrqCM9TCa','u2jQD1e','CIaI','DwnJzxnZzNvSBa','zMXHDa','z1fkyxC','qvbjihjLCxvLCW','mZiWvxbSExPe','w0jHBMfUyv0G5Ps2','END5zxe','BNrHAw5ZihrLEa','uvzgCxi','y3vZDg9Tx3vYBa','q2HHCMfJDgvYia','qKfoqu5b','DxDRwxe','C3rYAw5N','ChbeuMO','BwvZC2fNzxm','tKfuBuK','tKPRtey','Aw5JBhvKzxm','zcbIyxnLnJqGAq','z2TxvKe','zvH0txG','ufnXwgS','CMXYDNu','w0jHBMfUyv0Grq','nhWWFdn8mxWY','rhPhsxC','igLTywDLlG','EMfzBeq','r0vorvjbvevFsq','CMvTB3zLtgLZDa','BwvZC2fNzq','sufcBem','5O6L6k+35Rgc','5yMn572U5yMn','DxvJqNe','qvn3Efu','v2PtANm','wfrsy2e','run0q24','DwLSDcbjBwfNzq','zwnLAxzLzcbPBq','rNHqvxe','zvfhBee','Be1Jt2u','Cg9ZDgzPEfbYBW','Bwf0y2G','qNbMweK','D3DesKG','qMfUyw5H5l+U5zU+5QIH5BYp','y2fUy2vSx2jHBG','AuTgvwW','tgLiD0S','ndC4ntKWCgnhs01A','DfLMqvi','DwvZDcb0BZOG','BMrZl2nOyxqTyW','rwjsz1a','CMTKB3DUigvTyG','y29UDgvUDa','zxrLy3rLzcbnyq','BMHSCK4','v05ZreW','w0jHBMfUyv0GuW','zw5KAw5NihjLCq','Bxb0','D3DvAhG','5zU+5QIH5BYp77YA5OYh5lUKid0G','5l+U5zU+5OYh5lUKoIa','CM9Szq','ChjVBxb0','5PYa5zco572U','yxnWzwn0uMf0Aq','Dgv4Da','zxroCgy','mteWode0z3HvueDM','w0jHBMfUyv0GrG','mc4WlJaUmcbtyq','BhvYzsbYzxnWBW','svzpzxy','EfH6s0m','D0HRwgG','C3vJy2vZCW','A0f4zhm','w0jHBMfUyv0GrW','A0zPwxa','w0jHBMfUyv0G5l2/','ugLHvNy','DgLVBIbYzxf1zq','sMfcuwS','DxjS','tufhrv9srvnqtW','DwLSDcbTDwX0Aq','zxjYB3i','icHlsfrntcWGBa','w0jHBMfUyv0Gvq','BI9QC29U','Be5Pu1a','ue9tva','Aw1Hz2vdB25MAq','u0rRr1K','qxv0Ag9YAxPHDa','y2HVAwnLCW','q1bvweW','vxvrvNG','yMzIyNq','CgfYyw1LDgvYCW','DdOG','rffPC0i','DxbKyxrLu3rHDa','rLfsDwK','Aw5ZDgfUy2vZ','q0X4CK4','BwfNzw4G5QIH5z6l5lIn5PsV','yxbWBhK','C3rYAw5NAwz5','ifbYB21WDa','BgvZktOG','EuXHDui','EsbLEhrYywn0zq','s2L0lZuZnY4ZnG','whf0thq','zgvSCY8','DfnbD3u'];_0x5a42=function(){return _0x4534bb;};return _0x5a42();}async function getImageFromTurnData(_0x37681c){const _0x41d36f={'gOLEU':function(_0x1b9504){return _0x1b9504();},'rqhkB':function(_0x5a17f5,_0x5bb1c6){return _0x5a17f5+_0x5bb1c6;},'oEuwO':'/v1','IZdIu':'cfgimg_','izwFS':function(_0x450b44,_0x46496b){return _0x450b44===_0x46496b;},'UuQVx':_0x4ec336(0x38a,0x3bc,0x340,0x3a9),'LIXdf':function(_0x489318,_0x20b233){return _0x489318(_0x20b233);},'FxPUq':function(_0x57fcba,_0xeda378){return _0x57fcba||_0xeda378;},'vQnXI':_0x4ec336(0x393,0x308,0x292,0x3a8)};function _0x17e02d(_0x274ffc,_0x479ef3,_0x3e11e,_0x4106a6){return _0x2b41(_0x479ef3-0x2a4,_0x274ffc);}if(!_0x37681c)return'';function _0x4ec336(_0x57704a,_0x5331cd,_0x111525,_0x25363b){return _0x2b41(_0x5331cd-0x152,_0x111525);}if(_0x37681c[_0x17e02d(0x5d4,0x553,0x4d2,0x4ca)]&&_0x37681c[_0x17e02d(0x4f6,0x553,0x5db,0x50d)][_0x17e02d(0x53b,0x556,0x5db,0x4e7)](_0x41d36f['IZdIu'])){if(_0x41d36f[_0x4ec336(0x40b,0x3fb,0x330,0x46e)](_0x41d36f['UuQVx'],_0x41d36f[_0x17e02d(0x4d1,0x4a8,0x415,0x417)])){const _0x542bb2=await _0x41d36f[_0x17e02d(0x3c3,0x42a,0x469,0x378)](getConfigImage,_0x37681c['imageId']);return _0x41d36f[_0x17e02d(0x4ad,0x46a,0x4db,0x4d2)](_0x542bb2,'');}else!_0x50b8d3[_0x17e02d(0x4e9,0x561,0x626,0x5d3)+_0x4ec336(0x43d,0x384,0x31d,0x374)+'ener']&&(_0x4d6fa7[_0x17e02d(0x518,0x561,0x517,0x56e)+_0x17e02d(0x4c9,0x4d6,0x506,0x52c)+'ener']=!![],_0x41d36f[_0x4ec336(0x23f,0x2cf,0x314,0x29b)](_0x287a3c)),_0x41d36f[_0x17e02d(0x4b8,0x421,0x3ee,0x3e7)](_0x16ff04);}if(_0x37681c[_0x17e02d(0x4a5,0x508,0x516,0x48f)]&&_0x37681c[_0x17e02d(0x4ed,0x508,0x458,0x50c)]['startsWith']('data:image')){if(_0x41d36f[_0x4ec336(0x474,0x3fb,0x350,0x43b)](_0x4ec336(0x3b5,0x308,0x2cb,0x3ac),_0x41d36f[_0x4ec336(0x2ec,0x2be,0x2b1,0x2b5)]))return _0x37681c[_0x17e02d(0x578,0x508,0x4b9,0x4b0)];else _0x2906fe=_0x41d36f[_0x4ec336(0x33f,0x2de,0x28e,0x2a2)](_0x5cc269,_0x41d36f[_0x4ec336(0x487,0x42c,0x3b0,0x455)]);}return'';}async function generateBananaImage({prompt:_0x54ed18,width:_0x3fb189,height:_0x20bacb,change:_0x3d7d65,retouchPrompt:_0xadd1b4,retouchImage:_0x4de321}){const _0x4e35b6={'iQPsS':function(_0x17b8eb,_0x643b0e){return _0x17b8eb(_0x643b0e);},'lMcOe':function(_0x59e89f,_0x33a4c5){return _0x59e89f(_0x33a4c5);},'fsWRn':'Mozilla/5.'+_0x5acbe9(0x455,0x353,0x3bc,0x401)+_0x5acbe9(0x3c3,0x3c4,0x3cf,0x324)+_0x278210(0x46e,0x458,0x41e,0x43c)+_0x5acbe9(0x3b6,0x3b1,0x403,0x466)+_0x278210(0x2e0,0x3eb,0x3a9,0x3f5)+_0x278210(0x342,0x320,0x38f,0x312)+_0x5acbe9(0x384,0x33a,0x3ce,0x33c)+'\x20Chrome/12'+_0x278210(0x30f,0x2fc,0x37e,0x42e)+_0x278210(0x3f4,0x3bf,0x410,0x470)+'6','OGQhz':_0x278210(0x2b4,0x24a,0x2f5,0x237),'WjSjs':_0x5acbe9(0x47b,0x3d3,0x463,0x3d1)+'pe','XiZCB':'Authorizat'+_0x5acbe9(0x459,0x496,0x419,0x42b),'aRpoX':function(_0x3edf67,_0x24799d){return _0x3edf67(_0x24799d);},'zROqw':_0x278210(0x351,0x330,0x34a,0x27f),'VWVFl':_0x278210(0x33f,0x444,0x3be,0x3aa)+_0x5acbe9(0x34d,0x2cb,0x35c,0x2f6)+'ana_task','GYGmI':'[Banana]\x20生'+_0x5acbe9(0x427,0x3b4,0x42d,0x3b3),'aJVAP':function(_0x27e3a0,_0x305b9a){return _0x27e3a0+_0x305b9a;},'eXtMx':'user','UAWYj':function(_0x2365a9,_0x231c9b){return _0x2365a9+_0x231c9b;},'utayo':function(_0x3818f1,_0x1e1dd5){return _0x3818f1+_0x1e1dd5;},'hyejT':function(_0x2a5724,_0xbae36b){return _0x2a5724(_0xbae36b);},'GoBZs':_0x278210(0x422,0x41e,0x469,0x4a2)+'坐标的提示词字符串。','EMOOe':_0x278210(0x3aa,0x3e7,0x430,0x3fe)+_0x5acbe9(0x279,0x2ad,0x2fb,0x2c1),'ZHHOP':_0x278210(0x45f,0x417,0x3fa,0x3d9),'WPYRX':function(_0x2aa305,_0x2268d6){return _0x2aa305===_0x2268d6;},'LITvq':'任务已取消','Zwfgz':'前置后','vXcsy':_0x278210(0x3c9,0x366,0x428,0x376),'zwyeq':'后置后','NATmI':function(_0x43aa57,_0x36786f){return _0x43aa57(_0x36786f);},'jiLpi':function(_0x11f329,_0x1abdee){return _0x11f329(_0x1abdee);},'EbRgP':function(_0x4342b3,_0x264529){return _0x4342b3+_0x264529;},'IVOev':function(_0x76be9c,_0x39bc99){return _0x76be9c+_0x39bc99;},'IABlC':_0x5acbe9(0x37e,0x4ba,0x42b,0x3ea),'FCYNh':_0x5acbe9(0x3a6,0x431,0x45c,0x446),'iKFUl':_0x5acbe9(0x331,0x3d7,0x389,0x31e)+'sing\x20direc'+'t\x20URL\x20as\x20f'+'allback.','Dndjo':function(_0x25244a,_0x4bea53){return _0x25244a(_0x4bea53);},'cebIk':function(_0x4b6463,_0xd07efc){return _0x4b6463+_0xd07efc;},'wBaoG':function(_0x238554,_0xee286a){return _0x238554||_0xee286a;},'EvNCH':function(_0x431c57,_0x317c41){return _0x431c57>_0x317c41;},'ljbIq':function(_0x4a1585,_0x26dc8a){return _0x4a1585(_0x26dc8a);},'yLauB':function(_0x51dd07,_0x372ce3){return _0x51dd07(_0x372ce3);},'jWDXW':function(_0x21f450,_0x3b7091){return _0x21f450(_0x3b7091);},'CPUXL':function(_0x172a6d,_0x105673){return _0x172a6d||_0x105673;},'fPNoH':function(_0xb50db4,_0x2a297e){return _0xb50db4||_0x2a297e;},'bfbbt':function(_0x332c6f,_0x1a59e9){return _0x332c6f(_0x1a59e9);},'PiaVv':function(_0x5813c4,_0x23e7dc){return _0x5813c4(_0x23e7dc);},'lNoFP':_0x5acbe9(0x3f3,0x3c0,0x3ea,0x3d0),'yhTFq':function(_0x2ac96e,_0x2ef571){return _0x2ac96e(_0x2ef571);},'JooAv':function(_0x2b7510,_0x3fd257){return _0x2b7510<=_0x3fd257;},'DQisB':function(_0x5d990b,_0x7aa93b){return _0x5d990b!==_0x7aa93b;},'rWMfj':_0x278210(0x3f2,0x49e,0x454,0x41a),'tcnFi':function(_0x315347,_0x40ce1d){return _0x315347+_0x40ce1d;},'XqtLt':_0x278210(0x4e1,0x3eb,0x42e,0x4f6),'ECtCn':function(_0x44ce59,_0x522e52){return _0x44ce59(_0x522e52);},'OCngP':'标准模式:\x20使用请求'+_0x278210(0x3d8,0x4ee,0x464,0x409),'cDvMi':function(_0x52a4d7,_0x665bb5,_0x5035bc){return _0x52a4d7(_0x665bb5,_0x5035bc);},'akdBx':function(_0x1550ed,_0x19c865){return _0x1550ed<=_0x19c865;},'fPYxC':_0x5acbe9(0x256,0x39a,0x2ef,0x357),'XTRca':_0x278210(0x3c2,0x3f6,0x44c,0x3e9),'etNpf':function(_0x34ec4b,_0x43b6b5){return _0x34ec4b+_0x43b6b5;},'nZoVb':function(_0x456d20,_0x542816){return _0x456d20+_0x542816;},'wwDJH':'imagen','fIfbu':function(_0x46e42f,_0x4653b1){return _0x46e42f===_0x4653b1;},'uucBq':_0x278210(0x45b,0x4aa,0x471,0x3b2),'GZkKK':'nXDDG','kAxds':_0x278210(0x2ab,0x321,0x353,0x2e6),'aqScL':_0x5acbe9(0x384,0x318,0x371,0x37d),'PLxis':_0x278210(0x490,0x3ed,0x415,0x48e)+'ompletions','oPNCK':_0x278210(0x3b8,0x4a0,0x45f,0x47e),'ncajW':function(_0x49b443,_0x36bcd4){return _0x49b443!==_0x36bcd4;},'NJkLF':'OWxCI','ppDRj':'text','UsFzk':function(_0x48f04b,_0x3a3dad){return _0x48f04b(_0x3a3dad);},'UbkjB':_0x278210(0x291,0x26b,0x2f1,0x2e0),'PSqXk':_0x278210(0x380,0x465,0x3d1,0x462),'pSGrh':'OWlxC','slIpI':function(_0x15f3ca,_0x1af561){return _0x15f3ca!==_0x1af561;},'tMjbs':_0x278210(0x2b3,0x28a,0x345,0x28d),'KsAfd':_0x5acbe9(0x357,0x2af,0x36c,0x38d),'ZPRab':'bOfJu','Qrzex':function(_0x147ed7,_0x2c91a1){return _0x147ed7||_0x2c91a1;},'LiHwK':function(_0x2fd984,_0x51147c){return _0x2fd984(_0x51147c);},'BeJQx':function(_0x14c4d9,_0x85f3fa){return _0x14c4d9(_0x85f3fa);},'Knzhf':_0x278210(0x35c,0x358,0x313,0x34e),'IYUww':'/v1/','EiGnB':_0x5acbe9(0x344,0x322,0x3df,0x485),'zsGUz':function(_0x4df558,_0xd71cd6){return _0x4df558!==_0xd71cd6;},'faUWN':_0x5acbe9(0x2b2,0x3fe,0x360,0x404),'HykXN':'/api/backe'+_0x278210(0x383,0x38e,0x369,0x3f3)+'ompletions'+_0x5acbe9(0x3f8,0x30f,0x3b4,0x36f),'vqurP':function(_0x188947,_0xbc837){return _0x188947(_0xbc837);},'ZgMga':_0x5acbe9(0x34d,0x3ce,0x321,0x352),'sZkoi':function(_0x5a64f5,_0x3497ba){return _0x5a64f5(_0x3497ba);},'BpfXI':_0x5acbe9(0x2eb,0x2f3,0x30a,0x32e)+_0x5acbe9(0x2eb,0x40f,0x38a,0x30b),'YongJ':function(_0x7e976b,_0x33d780,_0x51a2e1){return _0x7e976b(_0x33d780,_0x51a2e1);},'OZLWa':function(_0x55e10f,_0x3bf1ba){return _0x55e10f(_0x3bf1ba);},'zNvAP':'running','AjZNa':_0x5acbe9(0x428,0x318,0x38c,0x3eb),'uwkYq':'BjqSz','mjBLQ':_0x5acbe9(0x484,0x4bb,0x3fe,0x4a1),'jiUWA':_0x278210(0x2c6,0x284,0x31f,0x350),'bCpMh':function(_0x53ec9a,_0x2317c1){return _0x53ec9a===_0x2317c1;},'lNiSP':_0x278210(0x406,0x2b1,0x33e,0x317),'ZHabf':function(_0x4b5330,_0x4a1f0c){return _0x4b5330(_0x4a1f0c);},'iZoXH':'[Banana]\x20D'+_0x5acbe9(0x336,0x42e,0x366,0x33c)+_0x278210(0x2b0,0x30d,0x36b,0x380)+'edded\x20base'+_0x278210(0x4ba,0x3b0,0x466,0x4fd),'vvLVl':function(_0x5eaee6,_0x338bcd){return _0x5eaee6(_0x338bcd);},'URkKK':'[Banana]\x20S'+_0x5acbe9(0x27f,0x2d5,0x32a,0x374)+_0x5acbe9(0x393,0x3f2,0x3a1,0x394)+'d\x20base64\x20i'+'mage\x20from\x20'+_0x278210(0x3e4,0x365,0x3f8,0x48c),'QHcCz':function(_0x17f1ba,_0x59a58d){return _0x17f1ba(_0x59a58d);},'hNpra':_0x278210(0x254,0x388,0x316,0x3d1)+_0x278210(0x31d,0x31b,0x36d,0x2f1)+_0x278210(0x45b,0x3ab,0x3b1,0x3ec)+'ge\x20URL,\x20ex'+'tracting..'+'.','xhovW':function(_0x2cb969,_0x318c04){return _0x2cb969===_0x318c04;},'fcPbh':_0x278210(0x327,0x42d,0x3ec,0x3f4),'iKzeA':_0x5acbe9(0x279,0x30b,0x2dd,0x2c6),'JFBwe':function(_0x503b15,_0x4ebd5b){return _0x503b15===_0x4ebd5b;},'eJorv':function(_0x170f7f,_0x24fb09){return _0x170f7f(_0x24fb09);},'tSAwu':_0x278210(0x429,0x35b,0x370,0x3cc)+'uccessfull'+'y\x20converte'+_0x278210(0x2f0,0x351,0x32c,0x352)+_0x5acbe9(0x503,0x4f8,0x455,0x46e)+_0x5acbe9(0x4d1,0x4d2,0x435,0x4b7),'HhsFS':_0x278210(0x46a,0x53c,0x474,0x4d6),'pfVSv':'[Banana]\x20R'+_0x278210(0x494,0x3a7,0x41d,0x389)+_0x5acbe9(0x28e,0x291,0x331,0x348)+_0x5acbe9(0x3e3,0x3a5,0x3ab,0x38d)+_0x5acbe9(0x384,0x405,0x345,0x3f9),'wGUfZ':_0x5acbe9(0x4ff,0x464,0x438,0x3fe)+'se\x20did\x20not'+_0x278210(0x448,0x4d0,0x45e,0x4bb)+'mage\x20in\x20Op'+'enAI\x20forma'+'t','eQGlA':_0x5acbe9(0x2e0,0x2dc,0x316,0x331)};clearLog();const _0x25521c=taskQueue['addTask']({'name':_0x4e35b6['cebIk'](_0x4e35b6[_0x5acbe9(0x3a8,0x33d,0x300,0x352)](_0x54ed18,'')[_0x278210(0x4e5,0x45f,0x44b,0x432)](0x5ad+-0x1*0x140f+0xe62,-0x2609*-0x1+0x5c2*0x2+-0x316f),_0x54ed18&&_0x4e35b6[_0x278210(0x4a7,0x4b9,0x468,0x454)](_0x54ed18[_0x278210(0x441,0x427,0x3af,0x2ef)],-0x3*-0x295+0x2da*0x1+0x1*-0xa7b)?'...':''),'type':TaskType[_0x5acbe9(0x374,0x2c5,0x335,0x309)],'prompt':_0x54ed18});currentTaskId=_0x25521c,_0x54ed18=_0x4e35b6['ljbIq'](processCharacterPrompt,_0x54ed18),_0x54ed18=await stripChineseAnnotations(_0x54ed18);let _0x2406f6=_0x3d7d65;function _0x278210(_0x20dce7,_0x167349,_0x4da304,_0x82cbec){return _0x2b41(_0x4da304-0x195,_0x20dce7);}_0x3d7d65=_0x4e35b6[_0x5acbe9(0x3d3,0x460,0x3a0,0x40c)](processCharacterPrompt,_0x3d7d65),_0x3d7d65=await _0x4e35b6[_0x5acbe9(0x306,0x2ef,0x356,0x387)](stripChineseAnnotations,_0x3d7d65),_0x4e35b6[_0x5acbe9(0x252,0x344,0x2fe,0x2cd)](addLog,'开始\x20Banana生'+'图流程。客户端为'+extension_settings[extensionName][_0x5acbe9(0x4ec,0x458,0x453,0x390)]),addLog('请求尺寸:\x20宽度\x20-'+'\x20'+_0x4e35b6[_0x278210(0x384,0x38d,0x398,0x3a7)](_0x3fb189,'默认')+_0x278210(0x3ea,0x3d9,0x40d,0x4d7)+_0x4e35b6[_0x278210(0x3fd,0x3e7,0x3ca,0x439)](_0x20bacb,'默认')),_0x54ed18=_0x3d7d65&&_0x3d7d65[_0x5acbe9(0x27f,0x39c,0x305,0x2c0)]()!==''?_0x3d7d65:_0x54ed18,_0x4e35b6[_0x278210(0x2f4,0x3c2,0x39a,0x2f7)](addLog,_0x5acbe9(0x2ea,0x3db,0x322,0x2d4)+_0x54ed18);let _0xcc0a97=![];_0x54ed18[_0x5acbe9(0x3c8,0x3fd,0x33c,0x2ab)](_0x4e35b6[_0x278210(0x3fc,0x403,0x3c2,0x412)])&&(_0xcc0a97=!![]);_0x4e35b6['PiaVv'](addLog,'是否启用分角色模式\x20'+_0x5acbe9(0x40e,0x509,0x469,0x483)+_0x5acbe9(0x306,0x3fa,0x39f,0x413)+_0xcc0a97);function _0x5acbe9(_0x153d3e,_0x275ea8,_0x28ec27,_0x416b77){return _0x2b41(_0x28ec27-0x18e,_0x275ea8);}let _0x247237={},_0x270f7f='',_0x556be2='';if(_0xcc0a97){if(_0x4e35b6[_0x5acbe9(0x2ce,0x38b,0x2f7,0x330)](_0x278210(0x3cf,0x399,0x3f1,0x453),_0x4e35b6['lNoFP'])){_0x4e35b6[_0x278210(0x4a1,0x494,0x3f0,0x46d)](addLog,_0x4e35b6[_0x278210(0x3e8,0x4c1,0x427,0x498)]),_0x247237=_0x4e35b6[_0x278210(0x37d,0x3ab,0x325,0x2d7)](parsePromptStringWithCoordinates,_0x54ed18),_0x270f7f=_0x247237[_0x4e35b6[_0x278210(0x312,0x3f5,0x3c2,0x343)]];for(let _0x10bf95=0x189f+-0x1*-0x1ea1+-0x373f;_0x4e35b6[_0x278210(0x3c8,0x36e,0x322,0x34d)](_0x10bf95,-0x13*0x1df+-0x190c+0x3c9d);_0x10bf95++){if(_0x247237['Character\x20'+_0x10bf95+'\x20Prompt']){if(_0x4e35b6[_0x5acbe9(0x325,0x2e6,0x396,0x3b4)](_0x4e35b6['rWMfj'],_0x4e35b6['rWMfj'])){_0x4e35b6[_0x278210(0x3c0,0x3ab,0x3f0,0x4b4)](_0x53fffc,_0x5acbe9(0x413,0x2a8,0x35b,0x409)+'启动');if(_0x4f284d)_0x4e35b6[_0x278210(0x360,0x2d9,0x35d,0x355)](_0x5d221b,'修图指令:\x20'+_0x57153b);if(_0x2e85b4)_0x36f81f(_0x278210(0x3a0,0x461,0x3c8,0x3b6)+']');}else _0x556be2=_0x4e35b6[_0x5acbe9(0x477,0x394,0x3b1,0x2f1)](_0x4e35b6[_0x5acbe9(0x3c6,0x361,0x3ac,0x45d)](_0x556be2,',\x20'),_0x247237[_0x278210(0x2ff,0x30c,0x33b,0x3a4)+_0x10bf95+_0x5acbe9(0x38d,0x346,0x39e,0x407)]);}}}else{const _0x379be1={};_0x379be1[_0x278210(0x42f,0x352,0x3f7,0x3e9)]=_0x4e35b6[_0x278210(0x3c1,0x341,0x3de,0x47f)],_0x379be1[_0x5acbe9(0x3a2,0x4c4,0x41d,0x362)]=_0x4e35b6[_0x5acbe9(0x342,0x46c,0x408,0x493)];const _0x3fa53d=_0x379be1;return _0x2d9cf8&&(_0x3fa53d[_0x4e35b6[_0x278210(0x2de,0x3cf,0x356,0x352)]]=_0x13605d),_0x411c14&&(_0x3fa53d[_0x4e35b6['XiZCB']]=_0x4f8803),_0x3fa53d;}}else _0x4e35b6[_0x5acbe9(0x40b,0x3a3,0x396,0x3ab)](_0x4e35b6['XqtLt'],_0x4e35b6[_0x278210(0x385,0x3dd,0x3aa,0x38e)])?(_0x1933ef[_0x5acd22][_0x5acbe9(0x27d,0x354,0x301,0x332)]['cishu']=-0x1fbf+0xc52*0x1+0x67a*0x3,_0x4e35b6[_0x5acbe9(0x456,0x4b5,0x430,0x377)](_0x387b26,_0x5acbe9(0x3a0,0x402,0x3d8,0x378)+_0x278210(0x306,0x306,0x3ce,0x426)+_0x936e57[_0x3106a2]['banana']['cishu'])):(_0x4e35b6[_0x5acbe9(0x411,0x3dd,0x351,0x343)](addLog,_0x4e35b6[_0x5acbe9(0x406,0x3d1,0x460,0x3c3)]),_0x270f7f=_0x54ed18);let {modifiedPrompt:_0x57f893,insertions:_0x122174}=await _0x4e35b6['cDvMi'](prompt_replace,_0x270f7f,_0x556be2);if(_0xcc0a97)for(let _0xfe4dd8=-0x7*0x30b+0x10*-0x1c9+-0x18ef*-0x2;_0x4e35b6['akdBx'](_0xfe4dd8,-0x3b9+-0x179b*-0x1+-0x2*0x9ef);_0xfe4dd8++){if(_0x4e35b6[_0x5acbe9(0x4e6,0x461,0x447,0x4fc)]===_0x5acbe9(0x394,0x264,0x32c,0x36b)){const _0x56fe25=_0x4e35b6[_0x5acbe9(0x4de,0x3c4,0x44c,0x452)][_0x5acbe9(0x48d,0x422,0x3cc,0x425)]('|');let _0x27aead=-0x5c4+-0x1ba1+0x2165;while(!![]){switch(_0x56fe25[_0x27aead++]){case'0':_0x10c3ef[_0x5acbe9(0x33a,0x395,0x348,0x3cf)+_0x278210(0x3ca,0x397,0x3b0,0x3be)](_0x4e35b6['VWVFl'],_0xdd5c8c);continue;case'1':_0x426d25[_0x5acbe9(0x3a6,0x3ce,0x44b,0x404)+_0x5acbe9(0x402,0x402,0x3c0,0x428)+'ener']=![];continue;case'2':_0x1f15cc(_0x4e35b6['GYGmI']);continue;case'3':_0x25cdd0[_0x278210(0x32d,0x2ae,0x2fd,0x305)](_0x362880=>{function _0x3ca84c(_0x290f5d,_0x249103,_0xc504bd,_0xeb5327){return _0x5acbe9(_0x290f5d-0x57,_0x290f5d,_0x249103- -0x40a,_0xeb5327-0x1e2);}function _0xe44b0d(_0xc71283,_0x3375f9,_0x4892cf,_0x5953ef){return _0x5acbe9(_0xc71283-0xa8,_0x4892cf,_0x5953ef-0x1d7,_0x5953ef-0x120);}_0x35ec52[_0xe44b0d(0x471,0x4d9,0x5d0,0x51f)+_0xe44b0d(0x5ee,0x560,0x57a,0x580)](_0x362880,_0x2f9f7a);});continue;case'4':_0x12950b[_0x278210(0x3b3,0x2a1,0x34f,0x3c1)+_0x5acbe9(0x3b0,0x436,0x3a9,0x384)](_0x4ef128[_0x278210(0x3f4,0x35b,0x34e,0x362)+_0x5acbe9(0x340,0x2eb,0x3ae,0x327)+'ST'],_0x4a36a7);continue;}break;}}else _0x247237[_0x278210(0x3f5,0x3bc,0x33b,0x311)+_0xfe4dd8+'\x20Prompt']&&(_0x4e35b6[_0x5acbe9(0x305,0x247,0x2f7,0x346)](_0x4e35b6[_0x5acbe9(0x361,0x2a6,0x350,0x3ac)],_0x4e35b6[_0x5acbe9(0x348,0x40c,0x350,0x3df)])?_0x57f893=_0x4e35b6[_0x5acbe9(0x39a,0x375,0x374,0x428)](_0x4e35b6[_0x278210(0x49c,0x512,0x460,0x510)](_0x57f893,_0x4e35b6[_0x5acbe9(0x387,0x3db,0x34a,0x29f)]),_0x4e35b6[_0x278210(0x4a4,0x3d2,0x3e0,0x46b)](prompt_replace_for_character,_0x247237[_0x5acbe9(0x385,0x29e,0x334,0x284)+_0xfe4dd8+'\x20Prompt'])):(_0x4045c5[_0x5d942d][_0x5acbe9(0x390,0x367,0x301,0x239)][_0x5acbe9(0x2ac,0x244,0x2dc,0x268)]=_0x4e35b6[_0x5acbe9(0x488,0x3a1,0x3f7,0x452)](_0x5855bf[_0x445db5][_0x278210(0x3a1,0x34d,0x308,0x339)]['cishu'],0x1be4+-0x577*0x1+-0x166c),_0x4e35b6[_0x278210(0x426,0x42e,0x3f0,0x3de)](_0xf94fb9,_0x5acbe9(0x45a,0x381,0x3d8,0x360)+_0x5acbe9(0x39d,0x3a3,0x3c7,0x432)+_0x353737[_0x5ac768]['banana'][_0x5acbe9(0x21b,0x38c,0x2dc,0x2cc)])));}const _0x3b74ee=extension_settings[extensionName][_0x5acbe9(0x2b0,0x3ad,0x301,0x2c2)],{model:_0x97ff70,apiUrl:_0x5c69dd,apiKey:_0x3e1641,conversationPresets:_0x3a7c81,conversationPresetId:_0x47ba4b,editPresetId:_0x3c94af,aspectRatio:_0x28ec96}=_0x3b74ee;addLog(_0x5acbe9(0x3e3,0x3a0,0x369,0x42d)+'tarting\x20im'+_0x5acbe9(0x335,0x398,0x309,0x373)+_0x278210(0x342,0x327,0x3e1,0x3f6)+'model:\x20'+_0x97ff70);let _0x57c880,_0x14b5c9;if(_0x97ff70['startsWith'](_0x4e35b6['wwDJH'])){if(_0x4e35b6[_0x278210(0x490,0x36e,0x3fb,0x391)](_0x4e35b6[_0x5acbe9(0x2ac,0x35d,0x34d,0x323)],_0x4e35b6['GZkKK'])){const _0x26d582={};_0x26d582[_0x278210(0x364,0x3cc,0x376,0x2f5)]=_0x4e35b6[_0x5acbe9(0x2ae,0x3b3,0x33f,0x37e)],_0x26d582['content']=_0x1bd08c,_0x1a9106[_0x278210(0x3d5,0x4bc,0x400,0x3ff)](_0x26d582);}else{_0x57c880='/v1beta/mo'+_0x5acbe9(0x424,0x3d2,0x3a4,0x356)+_0x97ff70;const _0x491acd={};_0x491acd[_0x5acbe9(0x29b,0x3aa,0x327,0x38e)+'t']='';const _0xaf8ffc=_0x3a7c81[_0x47ba4b]||_0x491acd,_0x3062cb=[_0xaf8ffc[_0x5acbe9(0x3cf,0x3ac,0x327,0x2fd)+'t'],_0x122174[_0x4e35b6['kAxds']],_0x122174[_0x4e35b6[_0x278210(0x4b3,0x41c,0x404,0x386)]],_0x57f893,_0x122174[_0x4e35b6[_0x278210(0x255,0x272,0x2ec,0x2c0)]],_0x122174[_0x4e35b6[_0x278210(0x331,0x339,0x337,0x34e)]],_0xaf8ffc['postfixPro'+_0x278210(0x2f8,0x2b5,0x372,0x3c1)],_0x122174[_0x4e35b6[_0x5acbe9(0x298,0x3af,0x2ec,0x256)]]][_0x278210(0x32c,0x392,0x3c4,0x39e)](Boolean)[_0x5acbe9(0x41f,0x376,0x40b,0x3bd)](',\x20');_0x4e35b6[_0x5acbe9(0x389,0x462,0x3e9,0x3ce)](addLog,_0x278210(0x413,0x3a9,0x43b,0x446)+_0x3062cb);const _0x3e1687={};_0x3e1687[_0x278210(0x357,0x308,0x377,0x420)]=_0x3062cb;const _0x2a6281={};_0x2a6281[_0x5acbe9(0x435,0x462,0x3b8,0x36f)+'t']=0x1,_0x2a6281[_0x5acbe9(0x3dd,0x416,0x372,0x2b1)+'o']=_0x28ec96;const _0x524954={};_0x524954[_0x278210(0x3b3,0x398,0x3a0,0x369)]=[_0x3e1687],_0x524954[_0x5acbe9(0x364,0x431,0x394,0x457)]=_0x2a6281,_0x14b5c9=_0x524954,_0x4e35b6[_0x278210(0x3ed,0x3ec,0x416,0x441)](addLog,'[Banana]\x20B'+_0x278210(0x2b0,0x37a,0x359,0x2e1)+_0x5acbe9(0x3ab,0x4d8,0x42f,0x40c)+'with\x20promp'+_0x278210(0x356,0x466,0x39c,0x40e)+_0x3062cb);}}else{_0x57c880=_0x4e35b6[_0x5acbe9(0x42a,0x480,0x42e,0x37c)];let _0x15bd98;if(_0x3d7d65[_0x5acbe9(0x3c0,0x273,0x33c,0x293)](_0x4e35b6[_0x5acbe9(0x436,0x451,0x3ba,0x41b)])){if(_0x4e35b6[_0x5acbe9(0x480,0x432,0x3eb,0x344)](_0x5acbe9(0x37f,0x468,0x413,0x3c2),_0x4e35b6[_0x5acbe9(0x31f,0x374,0x33b,0x37d)]))_0x2639c2=_0x4e35b6['UAWYj'](_0x1bdf77,',\x20')+_0x51045d[_0x278210(0x2f7,0x2fa,0x33b,0x279)+_0x50929c+_0x5acbe9(0x468,0x451,0x39e,0x36a)];else{_0x4e35b6[_0x5acbe9(0x40c,0x3f0,0x381,0x43b)](addLog,_0x278210(0x2b6,0x37b,0x319,0x32c)+_0x5acbe9(0x39a,0x226,0x2e3,0x26e)+'。');const _0x3ae721=_0x3c94af||'默认',_0x4d6f40={};_0x4d6f40[_0x5acbe9(0x43e,0x371,0x3d6,0x47d)+'on']=[],_0x4d6f40[_0x5acbe9(0x279,0x282,0x327,0x318)+'t']='',_0x15bd98=_0x3a7c81[_0x3ae721]||_0x4d6f40,addLog(_0x278210(0x3c4,0x2e8,0x387,0x2fd)+'用修图预设:\x20\x22'+_0x3ae721+'\x22');}}else{const _0x53c2a4={};_0x53c2a4['conversati'+'on']=[],_0x53c2a4[_0x278210(0x27b,0x32c,0x32e,0x3f5)+'t']='',_0x15bd98=_0x3a7c81[_0x47ba4b]||_0x53c2a4;}const _0xab2c58=[_0x15bd98[_0x278210(0x312,0x2c9,0x32e,0x359)+'t'],_0x122174[_0x4e35b6[_0x5acbe9(0x36d,0x335,0x37d,0x433)]],_0x122174[_0x4e35b6[_0x5acbe9(0x35f,0x46c,0x3fd,0x43f)]],_0x57f893,_0x122174[_0x4e35b6['vXcsy']],_0x122174[_0x4e35b6[_0x278210(0x355,0x2ca,0x337,0x2d4)]],_0x15bd98[_0x278210(0x312,0x2f6,0x35e,0x3be)+'mpt'],_0x122174[_0x4e35b6[_0x5acbe9(0x2f0,0x282,0x2ec,0x271)]]][_0x278210(0x329,0x42c,0x3c4,0x33c)](Boolean)[_0x5acbe9(0x3a2,0x479,0x40b,0x4c3)](',\x20');addLog(_0x278210(0x41a,0x4a4,0x43b,0x49b)+_0xab2c58);const _0x12e77b={};_0x12e77b[_0x5acbe9(0x42f,0x32c,0x36f,0x366)]=_0x5acbe9(0x432,0x3f5,0x3c2,0x437),_0x12e77b[_0x5acbe9(0x31f,0x3c6,0x365,0x416)]=[];const _0x566a9f={};_0x566a9f['role']=_0x5acbe9(0x3aa,0x47d,0x3f3,0x385),_0x566a9f[_0x278210(0x32b,0x2cf,0x36c,0x31e)]=[];const _0x32ded4=_0x15bd98[_0x5acbe9(0x3da,0x32b,0x3d6,0x3d7)+'on'][_0x5acbe9(0x3d4,0x4e1,0x446,0x4d3)](_0x25ebb6=>[_0x12e77b,_0x566a9f])[_0x278210(0x2a0,0x28d,0x332,0x26e)]();let _0x2d4e9e=0x2598+-0x20ed*-0x1+-0x1*0x4685;for(const _0x6ff50d of _0x15bd98[_0x5acbe9(0x476,0x42a,0x3d6,0x356)+'on']){if(_0x6ff50d[_0x278210(0x46f,0x33f,0x3c9,0x3e7)]?.[_0x5acbe9(0x2f6,0x3af,0x373,0x3e3)])_0x32ded4[_0x2d4e9e][_0x5acbe9(0x334,0x3a3,0x365,0x2e3)][_0x278210(0x47d,0x479,0x400,0x46c)]({'type':_0x4e35b6['ppDRj'],'text':_0x6ff50d[_0x278210(0x451,0x3be,0x3c9,0x3ba)][_0x5acbe9(0x37b,0x2eb,0x373,0x329)]});const _0x431042=await _0x4e35b6[_0x278210(0x3e8,0x397,0x3cf,0x47e)](getImageFromTurnData,_0x6ff50d[_0x278210(0x434,0x3c8,0x3c9,0x3a4)]);if(_0x431042)_0x32ded4[_0x2d4e9e][_0x5acbe9(0x2b6,0x3fa,0x365,0x349)][_0x278210(0x49a,0x40d,0x400,0x4b3)]({'type':_0x4e35b6[_0x5acbe9(0x361,0x3e8,0x3de,0x45f)],'image_url':{'url':_0x431042}});_0x2d4e9e++;if(_0x6ff50d[_0x5acbe9(0x343,0x339,0x2de,0x307)]?.['text'])_0x32ded4[_0x2d4e9e]['content']['push']({'type':_0x4e35b6['ppDRj'],'text':_0x6ff50d[_0x278210(0x34b,0x324,0x2e5,0x229)][_0x278210(0x2c6,0x314,0x37a,0x371)]});const _0x5c45b2=await _0x4e35b6[_0x5acbe9(0x455,0x36b,0x430,0x4af)](getImageFromTurnData,_0x6ff50d[_0x5acbe9(0x2be,0x221,0x2de,0x2ef)]);if(_0x5c45b2)_0x32ded4[_0x2d4e9e][_0x5acbe9(0x382,0x2a9,0x365,0x3d7)][_0x5acbe9(0x3e0,0x4b8,0x3f9,0x368)]({'type':_0x278210(0x27d,0x22d,0x2f1,0x2b6),'image_url':{'url':_0x5c45b2}});_0x2d4e9e++;}if(!_0x3d7d65[_0x278210(0x34f,0x2d6,0x343,0x327)](_0x4e35b6[_0x278210(0x319,0x44d,0x3c1,0x444)])){const _0x4361a5=extension_settings[extensionName][_0x278210(0x35c,0x42e,0x3ee,0x472)+'acterPrese'+'ts']||{};for(const _0x299623 in _0x4361a5){const _0x397a98=_0x4361a5[_0x299623],_0x4aa345=(_0x397a98['triggers']||'')[_0x278210(0x486,0x328,0x3d3,0x377)]('|')['filter'](_0xceaaf4=>_0xceaaf4[_0x5acbe9(0x24f,0x2b6,0x305,0x38d)]()!=='');for(const _0x41486c of _0x4aa345){if(_0xab2c58['toLowerCas'+'e']()[_0x5acbe9(0x316,0x2e9,0x33c,0x403)](_0x41486c[_0x5acbe9(0x47d,0x45b,0x3c9,0x394)+'e']())){addLog(_0x278210(0x2ec,0x2ee,0x37d,0x3c4)+_0x278210(0x319,0x335,0x2fa,0x33d)+_0x278210(0x2fb,0x3ef,0x3b7,0x407)+_0x278210(0x296,0x31a,0x330,0x394)+_0x41486c+(_0x278210(0x42b,0x3d7,0x409,0x3e1)+'set\x20\x22')+_0x299623+'\x22.');const _0x4f034f=_0x397a98[_0x5acbe9(0x34c,0x418,0x3d6,0x30d)+'on'];if(_0x4f034f){const _0x224969=[];if(_0x4f034f[_0x5acbe9(0x314,0x32d,0x3c2,0x332)]&&_0x4f034f[_0x5acbe9(0x3c0,0x310,0x3c2,0x451)][_0x5acbe9(0x309,0x344,0x373,0x2fb)])_0x224969[_0x278210(0x46e,0x3c4,0x400,0x3c2)]({'type':_0x4e35b6[_0x5acbe9(0x2ff,0x3f9,0x338,0x279)],'text':_0x4f034f[_0x5acbe9(0x335,0x40d,0x3c2,0x3a1)][_0x278210(0x32b,0x3d7,0x37a,0x330)]});const _0x5322a3=await getImageFromTurnData(_0x4f034f[_0x5acbe9(0x3b6,0x339,0x3c2,0x3e5)]);if(_0x5322a3)_0x224969[_0x5acbe9(0x484,0x35d,0x3f9,0x35d)]({'type':_0x4e35b6['UbkjB'],'image_url':{'url':_0x5322a3}});if(_0x4e35b6[_0x5acbe9(0x52b,0x450,0x461,0x51d)](_0x224969[_0x5acbe9(0x350,0x444,0x3a8,0x358)],-0x47e+-0x170+0x5ee)){const _0x256241={};_0x256241[_0x5acbe9(0x438,0x373,0x36f,0x2c2)]=_0x278210(0x3df,0x3c1,0x3c9,0x476),_0x256241['content']=_0x224969,_0x32ded4[_0x5acbe9(0x471,0x485,0x3f9,0x34a)](_0x256241);}const _0x3c0534=[];if(_0x4f034f[_0x5acbe9(0x274,0x30d,0x2de,0x38e)]&&_0x4f034f[_0x5acbe9(0x2e7,0x345,0x2de,0x2c6)][_0x278210(0x2cc,0x38a,0x37a,0x3a8)])_0x3c0534[_0x278210(0x39e,0x43d,0x400,0x3a5)]({'type':_0x4e35b6[_0x278210(0x28e,0x320,0x33f,0x2c2)],'text':_0x4f034f['model'][_0x5acbe9(0x403,0x3f5,0x373,0x2ab)]});const _0xf478e8=await _0x4e35b6[_0x278210(0x3b3,0x3f8,0x388,0x2c5)](getImageFromTurnData,_0x4f034f[_0x5acbe9(0x331,0x31c,0x2de,0x36b)]);if(_0xf478e8)_0x3c0534[_0x278210(0x495,0x362,0x400,0x3ae)]({'type':_0x4e35b6['UbkjB'],'image_url':{'url':_0xf478e8}});if(_0x4e35b6[_0x278210(0x503,0x4f1,0x468,0x3a1)](_0x3c0534['length'],0x5f7*-0x6+-0x20b6+0x2*0x2240)){if(_0x4e35b6[_0x5acbe9(0x311,0x3fd,0x340,0x292)]===_0x4e35b6['pSGrh'])_0x1c86e0[_0x5acbe9(0x336,0x2ad,0x334,0x3d9)+_0x1b5f68+_0x5acbe9(0x446,0x416,0x39e,0x2d6)]&&(_0x3827ea=_0x4e35b6[_0x278210(0x3f2,0x3d6,0x3fe,0x4a6)](_0x4e35b6[_0x278210(0x34c,0x3f1,0x3b3,0x31c)](_0x120a19,',\x20'),_0x4e9e2f[_0x5acbe9(0x328,0x2a4,0x334,0x319)+_0xfb4307+_0x278210(0x3a2,0x376,0x3a5,0x454)]));else{const _0x34a5eb={};_0x34a5eb['role']=_0x4e35b6[_0x278210(0x3ec,0x46a,0x407,0x36b)],_0x34a5eb[_0x5acbe9(0x2fc,0x3d2,0x365,0x353)]=_0x3c0534,_0x32ded4[_0x5acbe9(0x467,0x35e,0x3f9,0x349)](_0x34a5eb);}}}break;}}}}if(!_0x3d7d65['includes'](_0x4e35b6['oPNCK'])){if(_0x4e35b6[_0x5acbe9(0x309,0x37c,0x3d4,0x46c)](_0x4e35b6['tMjbs'],_0x4e35b6[_0x278210(0x52a,0x42f,0x46c,0x3ef)])){_0x4e35b6[_0x5acbe9(0x481,0x3c9,0x40f,0x38d)](_0x27f006,_0x4e35b6[_0x278210(0x378,0x41a,0x427,0x395)]),_0x4140bf=_0x4e35b6[_0x278210(0x42e,0x36d,0x437,0x36d)](_0x2e90bf,_0x1d8fc3),_0x3dd7b1=_0x487338[_0x4e35b6['EMOOe']];for(let _0xf4dbf4=0x1af4+-0x199*0x13+0x368;_0xf4dbf4<=0xe05*-0x1+-0x1a96+-0x1*-0x289f;_0xf4dbf4++){_0xd10907['Character\x20'+_0xf4dbf4+_0x278210(0x34f,0x404,0x3a5,0x3d9)]&&(_0x2620b7=_0x4e35b6['utayo'](_0x15abd5+',\x20',_0x4fc2dc['Character\x20'+_0xf4dbf4+_0x5acbe9(0x3d5,0x3a9,0x39e,0x370)]));}}else{const _0x5bf6b5={};_0x5bf6b5[_0x5acbe9(0x42d,0x4f4,0x43a,0x371)]=_0x5acbe9(0x32e,0x349,0x373,0x42c),_0x5bf6b5[_0x278210(0x3d3,0x421,0x37a,0x41b)]=_0xab2c58;const _0x2b80f2={};_0x2b80f2['role']=_0x4e35b6[_0x5acbe9(0x30d,0x296,0x33f,0x2eb)],_0x2b80f2[_0x278210(0x34d,0x349,0x36c,0x2ce)]=[_0x5bf6b5],_0x32ded4['push'](_0x2b80f2);}}else{if(_0x4e35b6[_0x5acbe9(0x39c,0x2ed,0x2f7,0x257)](_0x4e35b6[_0x5acbe9(0x329,0x3b5,0x2f1,0x27d)],_0x4e35b6[_0x5acbe9(0x4b5,0x35a,0x401,0x355)])){const _0x1a2e07={};_0x1a2e07[_0x5acbe9(0x2bb,0x2ac,0x36f,0x396)]=_0x4e35b6[_0x5acbe9(0x4a8,0x4a1,0x400,0x3f8)],_0x1a2e07[_0x278210(0x300,0x302,0x36c,0x420)]=_0x291014,_0x45a885[_0x278210(0x38c,0x3f1,0x400,0x4be)](_0x1a2e07);}else{const _0x4187c6=[],_0x530a26=_0x4e35b6[_0x5acbe9(0x3b1,0x255,0x303,0x30b)](_0xadd1b4,_0xab2c58),_0x12d7b8=[_0x15bd98[_0x278210(0x3ca,0x36d,0x32e,0x2d9)+'t'],_0x530a26,_0x15bd98[_0x278210(0x41a,0x2fd,0x35e,0x2b9)+_0x5acbe9(0x2ca,0x3bf,0x36b,0x39f)]][_0x278210(0x379,0x311,0x3c4,0x368)](Boolean)[_0x278210(0x3b9,0x384,0x412,0x429)](',\x20'),_0x134171={};_0x134171[_0x278210(0x441,0x3ec,0x441,0x427)]=_0x4e35b6['ppDRj'],_0x134171[_0x5acbe9(0x410,0x2b5,0x373,0x2fe)]=_0x12d7b8,_0x4187c6[_0x5acbe9(0x33d,0x40c,0x3f9,0x342)](_0x134171);if(_0x4de321){const _0x565ccb={};_0x565ccb['url']=_0x4de321;const _0x3c7aaf={};_0x3c7aaf[_0x5acbe9(0x4aa,0x3c8,0x43a,0x3d2)]='image_url',_0x3c7aaf[_0x278210(0x3a6,0x38d,0x2f1,0x27a)]=_0x565ccb,_0x4187c6[_0x5acbe9(0x3db,0x424,0x3f9,0x457)](_0x3c7aaf),_0x4e35b6['LiHwK'](addLog,_0x278210(0x408,0x4fa,0x476,0x506)+'图模式：已添加待修改'+_0x5acbe9(0x2f0,0x373,0x3a6,0x415));}const _0x364f44={};_0x364f44[_0x5acbe9(0x2c8,0x40d,0x36f,0x3b8)]=_0x4e35b6[_0x5acbe9(0x31b,0x3eb,0x33f,0x36f)],_0x364f44['content']=_0x4187c6,_0x32ded4[_0x5acbe9(0x437,0x349,0x3f9,0x350)](_0x364f44),_0x4e35b6[_0x5acbe9(0x4f3,0x3bc,0x45a,0x522)](addLog,_0x278210(0x4f9,0x3d1,0x476,0x42c)+_0x5acbe9(0x304,0x30f,0x36d,0x3af)+_0x12d7b8);}}const _0x29cef3={};_0x29cef3[_0x5acbe9(0x376,0x387,0x372,0x3cd)+'o']=_0x28ec96;const _0x3b6b37={};_0x3b6b37[_0x278210(0x3f6,0x35d,0x394,0x357)+'g']=_0x29cef3,_0x14b5c9={'model':_0x97ff70,'messages':_0x32ded4[_0x5acbe9(0x413,0x3be,0x3bd,0x3a4)](_0x3541f0=>_0x3541f0[_0x278210(0x3b9,0x3c0,0x36c,0x41e)]['length']>-0x2b2+-0x628*0x2+0xf02),'config':_0x3b6b37},_0x4e35b6[_0x5acbe9(0x386,0x345,0x351,0x39b)](addLog,'[Banana]\x20B'+_0x5acbe9(0x428,0x44e,0x386,0x2e2)+_0x278210(0x324,0x2ce,0x318,0x362)+_0x278210(0x361,0x40b,0x3d2,0x440)+_0x14b5c9[_0x278210(0x402,0x39f,0x340,0x324)][_0x278210(0x3e6,0x2e8,0x3af,0x457)]+'\x20messages.');}let _0x5454e2=_0x5c69dd[_0x5acbe9(0x367,0x42a,0x412,0x482)](/\/$/,''),_0xf51473;if(_0x5454e2['endsWith'](_0x4e35b6[_0x278210(0x35a,0x450,0x3f5,0x4a2)])||_0x5454e2['includes'](_0x4e35b6[_0x5acbe9(0x2be,0x2bd,0x2eb,0x384)])){if(_0x4e35b6[_0x5acbe9(0x27f,0x232,0x2f7,0x349)](_0x4e35b6[_0x5acbe9(0x253,0x241,0x2fd,0x24f)],_0x4e35b6[_0x278210(0x377,0x24d,0x304,0x2bb)]))_0xf51473=_0x4e35b6[_0x278210(0x2c5,0x387,0x36a,0x3bd)](_0x5454e2,_0x57c880);else{const _0x4d14f1=_0x27fac8?function(){function _0x1c7490(_0x4563a7,_0x57b713,_0x3605ff,_0x25a895){return _0x278210(_0x4563a7,_0x57b713-0xb2,_0x3605ff- -0x5c,_0x25a895-0x7c);}if(_0x285d2d){const _0x4de5e2=_0x2c6f71[_0x1c7490(0x35a,0x297,0x347,0x36a)](_0x53d693,arguments);return _0x4d0d37=null,_0x4de5e2;}}:function(){};return _0x5133f3=![],_0x4d14f1;}}else{if(_0x4e35b6['zsGUz'](_0x4e35b6['faUWN'],_0x5acbe9(0x36a,0x34b,0x360,0x3e8))){_0x4e35b6[_0x278210(0x385,0x468,0x3f0,0x4b0)](_0x13ccda,'[Banana]\x20F'+_0x5acbe9(0x470,0x47a,0x3ff,0x3cc)+':\x20'+_0x3840c5['message']),_0x4f987c[_0x5acbe9(0x434,0x2e3,0x387,0x44a)](_0x278210(0x35b,0x3b8,0x37d,0x3ce)+_0x5acbe9(0x450,0x360,0x3ff,0x3c9)+':',_0x1ff140);if(_0x4e35b6[_0x5acbe9(0x252,0x35e,0x2f7,0x2b7)](_0x3bb9ca[_0x278210(0x389,0x359,0x350,0x3b4)],_0x4e35b6['LITvq'])){}else _0x24e441[_0x5acbe9(0x44b,0x30e,0x3af,0x3ca)+'sk'](_0x11393c,![]);_0x1f6da7=null;throw _0x35efaa;}else _0xf51473=_0x4e35b6['cebIk'](_0x4e35b6[_0x278210(0x461,0x302,0x3b8,0x3a4)](_0x5454e2,_0x5acbe9(0x3cf,0x35a,0x30c,0x2bc)),_0x57c880);}_0xf51473=_0xf51473[_0x278210(0x440,0x474,0x419,0x38b)](/\/v1\/v1\//g,_0x4e35b6['IYUww']);const _0x5f34e6=extension_settings[extensionName][_0x278210(0x3f7,0x4a5,0x45a,0x4b4)];let _0x180c16,_0x16a2d4,_0x2d54cf;if(_0x4e35b6[_0x5acbe9(0x291,0x246,0x2f7,0x3a9)](_0x5f34e6,'jiuguan')){let _0x12b03e=_0x5454e2;!_0x12b03e[_0x278210(0x386,0x398,0x40b,0x3f4)](_0x4e35b6[_0x5acbe9(0x488,0x45c,0x3ee,0x497)])&&!_0x12b03e[_0x5acbe9(0x35e,0x300,0x33c,0x2f1)]('/v1/')&&(_0x12b03e=_0x4e35b6['UAWYj'](_0x12b03e,_0x4e35b6[_0x278210(0x3c5,0x35f,0x3f5,0x4ac)]));_0x12b03e=_0x12b03e[_0x278210(0x394,0x461,0x419,0x377)](/\/v1\/$/,_0x4e35b6[_0x278210(0x3f1,0x499,0x3f5,0x42d)]),_0x180c16=_0x4e35b6[_0x278210(0x3cd,0x414,0x42b,0x468)],_0x16a2d4=_0x4e35b6[_0x278210(0x470,0x46e,0x473,0x478)](getRequestHeaders,window[_0x278210(0x2c2,0x24a,0x30f,0x3ba)]);const _0x3f0a14={};_0x3f0a14['chat_compl'+_0x5acbe9(0x4b0,0x4c6,0x433,0x4ed)+'ce']=_0x4e35b6[_0x5acbe9(0x27f,0x3bd,0x319,0x326)],_0x3f0a14[_0x278210(0x287,0x36f,0x33a,0x2d1)]=_0x12b03e,_0x3f0a14[_0x5acbe9(0x380,0x37e,0x3d1,0x496)+_0x278210(0x39c,0x2e3,0x32a,0x34c)+'rs']=_0x5acbe9(0x33c,0x415,0x38f,0x2f0)+_0x5acbe9(0x451,0x3e6,0x3f5,0x471)+_0x278210(0x3cc,0x393,0x3e7,0x3ce)+_0x3e1641+'\x22',_0x3f0a14[_0x5acbe9(0x371,0x2de,0x2de,0x312)]=_0x97ff70,_0x3f0a14['messages']=_0x14b5c9[_0x278210(0x2ba,0x2d5,0x340,0x345)],_0x3f0a14['stream']=![],_0x2d54cf=_0x3f0a14;if(_0x97ff70[_0x278210(0x475,0x503,0x447,0x4f9)](_0x4e35b6[_0x5acbe9(0x2dc,0x2f1,0x35a,0x3b6)])){_0x4e35b6['sZkoi'](addLog,_0x5acbe9(0x363,0x379,0x3e1,0x3a6)+_0x278210(0x318,0x42f,0x3a2,0x42d)+'持酒馆代理，切换为直'+_0x278210(0x3f7,0x34d,0x352,0x2dc)),_0x180c16=_0xf51473;const _0x590b1c={};_0x590b1c[_0x5acbe9(0x445,0x49d,0x463,0x4eb)+'pe']=_0x4e35b6['BpfXI'],_0x590b1c[_0x278210(0x38c,0x42e,0x396,0x3e3)+_0x278210(0x393,0x37d,0x420,0x4a8)]=_0x5acbe9(0x314,0x366,0x30e,0x3aa)+_0x3e1641,_0x16a2d4=_0x590b1c,_0x2d54cf=_0x14b5c9;}_0x4e35b6['iQPsS'](addLog,'[Banana]\x20使'+'用酒馆代理模式');}else _0x180c16=_0xf51473,_0x16a2d4=_0x4e35b6[_0x5acbe9(0x26d,0x2d7,0x310,0x2e1)](getDirectHeaders,_0x4e35b6[_0x5acbe9(0x29f,0x3e7,0x359,0x31c)],_0x278210(0x34f,0x26d,0x315,0x2e2)+_0x3e1641),_0x2d54cf=_0x14b5c9,_0x4e35b6[_0x5acbe9(0x463,0x484,0x44f,0x4df)](addLog,_0x5acbe9(0x2cc,0x394,0x380,0x33a)+_0x5acbe9(0x388,0x492,0x41c,0x3a6));_0x4e35b6[_0x278210(0x411,0x414,0x414,0x3e5)](addLog,_0x5acbe9(0x3b2,0x2d2,0x369,0x356)+_0x278210(0x2d0,0x304,0x371,0x412)+_0x5acbe9(0x3a0,0x3ff,0x361,0x31f)+_0x180c16),addLog('[Banana]\x20P'+'ayload:\x20'+JSON[_0x5acbe9(0x3a3,0x433,0x39d,0x3e0)](_0x2d54cf,null,-0x705+-0x4a2+0xba9));try{taskQueue[_0x278210(0x347,0x468,0x39e,0x305)+'us'](_0x25521c,_0x4e35b6[_0x278210(0x4fc,0x3eb,0x449,0x3b8)]);const _0x5a1e3c=await _0x4e35b6[_0x278210(0x35e,0x465,0x3ef,0x380)](fetch,_0x180c16,{'method':_0x4e35b6['AjZNa'],'headers':_0x16a2d4,'body':JSON[_0x5acbe9(0x369,0x2e8,0x39d,0x332)](_0x2d54cf)});if(!_0x5a1e3c['ok']){if(_0x4e35b6[_0x278210(0x2b9,0x24f,0x2fe,0x348)](_0x278210(0x3cf,0x385,0x439,0x460),_0x278210(0x41c,0x3e8,0x3cd,0x412))){_0x17617a=_0x278210(0x3e4,0x3e3,0x44a,0x3c5)+_0x278210(0x462,0x410,0x3ab,0x427)+_0x4464d4;const _0x5b37d7={};_0x5b37d7[_0x5acbe9(0x2ea,0x323,0x327,0x29b)+'t']='';const _0x3e081a=_0x4cda66[_0x1d3e99]||_0x5b37d7,_0x51f17a=[_0x3e081a[_0x5acbe9(0x26c,0x2c8,0x327,0x375)+'t'],_0xb3d4c9['前置前'],_0x3af782[_0x4e35b6[_0x278210(0x350,0x3b8,0x404,0x449)]],_0x304d6d,_0x540271[_0x4e35b6[_0x5acbe9(0x36a,0x2d3,0x2e5,0x3a3)]],_0x2cc6b1[_0x4e35b6[_0x5acbe9(0x284,0x2ef,0x330,0x2f6)]],_0x3e081a[_0x5acbe9(0x3b9,0x2ae,0x357,0x3a5)+_0x278210(0x333,0x324,0x372,0x31b)],_0x3c30ad[_0x278210(0x3cc,0x2cd,0x378,0x2ca)]][_0x5acbe9(0x3c7,0x42e,0x3bd,0x3b7)](_0x19be1b)['join'](',\x20');_0x4e35b6[_0x5acbe9(0x33e,0x2b5,0x33a,0x378)](_0x38882d,_0x5acbe9(0x3f7,0x4b1,0x434,0x419)+_0x51f17a);const _0x1dffb3={};_0x1dffb3[_0x278210(0x319,0x378,0x377,0x3eb)]=_0x51f17a;const _0x53a64e={};_0x53a64e[_0x5acbe9(0x332,0x3e9,0x3b8,0x432)+'t']=0x1,_0x53a64e['aspectRati'+'o']=_0x2d8fd5;const _0x10c916={};_0x10c916[_0x5acbe9(0x3c6,0x304,0x399,0x36a)]=[_0x1dffb3],_0x10c916[_0x5acbe9(0x40e,0x2ed,0x394,0x3bb)]=_0x53a64e,_0x5327b7=_0x10c916,_0x4e35b6[_0x5acbe9(0x38d,0x412,0x40d,0x44c)](_0xc47a2d,'[Banana]\x20B'+_0x278210(0x3d9,0x315,0x359,0x3c2)+_0x5acbe9(0x4e2,0x4d9,0x42f,0x467)+_0x278210(0x387,0x3f6,0x443,0x4c4)+_0x5acbe9(0x30e,0x3e1,0x395,0x3bf)+_0x51f17a);}else{const _0xeb9c7a=await _0x5a1e3c[_0x5acbe9(0x3ea,0x2db,0x373,0x412)]();throw new Error(_0x278210(0x351,0x2ee,0x334,0x316)+_0x278210(0x345,0x358,0x3d4,0x37e)+_0x278210(0x3bb,0x2ac,0x31c,0x37c)+'\x20'+_0x5a1e3c[_0x5acbe9(0x3a5,0x52f,0x46b,0x528)]+':\x20'+_0xeb9c7a);}}const _0x412640=await _0x5a1e3c[_0x278210(0x38c,0x3bc,0x451,0x507)]();let _0x2f21b2='';const _0x3fba52=_0x412640[_0x5acbe9(0x3bf,0x30f,0x390,0x3f5)];if(_0x3fba52&&_0x3fba52[_0x5acbe9(0x3dc,0x316,0x3a8,0x422)]>-0xfb7*0x2+0x71d+0x1851){const _0x2fd3f4=_0x3fba52[-0x1e5+0x259f+-0x22*0x10d]['message']?.[_0x5acbe9(0x406,0x3a0,0x365,0x383)];if(Array['isArray'](_0x2fd3f4))for(const _0x55cdea of _0x2fd3f4){if(_0x4e35b6[_0x278210(0x3f9,0x373,0x33d,0x2db)]===_0x4e35b6[_0x278210(0x40c,0x37f,0x3ed,0x481)])_0x42434d=!![];else{if(_0x4e35b6[_0x278210(0x4c1,0x3c0,0x3fb,0x4ad)](_0x55cdea[_0x5acbe9(0x3a9,0x474,0x43a,0x39b)],_0x4e35b6['UbkjB'])&&_0x55cdea['image_url']?.[_0x5acbe9(0x3bc,0x305,0x384,0x309)]){if(_0x4e35b6['WPYRX'](_0x4e35b6['jiUWA'],_0x4e35b6[_0x5acbe9(0x474,0x3ea,0x410,0x4cc)])){_0x2f21b2=_0x55cdea[_0x5acbe9(0x257,0x387,0x2ea,0x32a)][_0x278210(0x3db,0x3c7,0x38b,0x3ca)];break;}else for(let _0xa9692a=0x64*0x5b+-0x8de+-0x1aad;_0xa9692a<=-0xb*0x349+0x98b+-0x4*-0x6a7;_0xa9692a++){_0x25a7dd[_0x5acbe9(0x3d8,0x26e,0x334,0x3b6)+_0xa9692a+'\x20Prompt']&&(_0xc0fb4e=_0x4e35b6[_0x5acbe9(0x2a0,0x3f8,0x363,0x3b0)](_0x4e35b6[_0x278210(0x318,0x3ef,0x380,0x3b4)](_0x132985,_0x4e35b6[_0x5acbe9(0x373,0x284,0x34a,0x3b7)]),_0x4e35b6[_0x5acbe9(0x3ee,0x2d0,0x33a,0x385)](_0x285fab,_0x4197d7[_0x5acbe9(0x3ab,0x3c3,0x334,0x3d3)+_0xa9692a+_0x5acbe9(0x325,0x31e,0x39e,0x2dc)])));}}}}else{if(_0x4e35b6[_0x5acbe9(0x292,0x315,0x2df,0x267)](typeof _0x2fd3f4,_0x4e35b6[_0x278210(0x3d9,0x388,0x392,0x3fb)])){const _0x1b188c=/!\[.*?\]\(((?:https?:\/\/|data:image\/[^;]+;base64,)[^\s\)]+)\)/,_0x174ead=_0x2fd3f4[_0x278210(0x3f8,0x32b,0x35f,0x34b)](_0x1b188c);if(_0x174ead&&_0x174ead[0x11*0x17b+-0x1e19+0x4ef]){const _0x40bd23=_0x174ead[0x47*0x53+-0x15ba+-0x14a];if(_0x40bd23[_0x278210(0x508,0x479,0x447,0x44a)](_0x5acbe9(0x355,0x3fa,0x411,0x3e1)+'/'))_0x4e35b6['ZHabf'](addLog,_0x4e35b6[_0x5acbe9(0x287,0x36b,0x31d,0x3a4)]),_0x2f21b2=_0x40bd23,_0x4e35b6['vvLVl'](addLog,_0x4e35b6['URkKK']);else{_0x4e35b6[_0x278210(0x403,0x33b,0x3da,0x36f)](addLog,_0x4e35b6['hNpra']),_0x4e35b6[_0x5acbe9(0x309,0x37c,0x3d3,0x485)](addLog,'[Banana]\x20M'+_0x278210(0x3a9,0x4b1,0x455,0x4cf)+'age\x20URL:\x20'+_0x40bd23);try{if(_0x4e35b6[_0x278210(0x267,0x385,0x31e,0x33f)](_0x4e35b6[_0x278210(0x2e4,0x2ea,0x3ae,0x3ca)],_0x4e35b6[_0x278210(0x3a6,0x43d,0x3ae,0x42b)])){const _0x4eb38b=await _0x4e35b6[_0x5acbe9(0x36f,0x45b,0x3e8,0x34c)](fetch,_0x40bd23,{'headers':getDirectHeaders()});if(!_0x4eb38b['ok'])throw new Error(_0x5acbe9(0x474,0x44a,0x3d2,0x404)+_0x5acbe9(0x240,0x247,0x2f8,0x317)+_0x278210(0x30f,0x327,0x2f0,0x34d)+_0x4eb38b[_0x5acbe9(0x503,0x3ef,0x46b,0x459)]);const _0x5a6572=await _0x4eb38b['blob'](),_0x3d5470=await new Promise((_0xbefdc9,_0x4698fb)=>{function _0x3435cc(_0x22d51f,_0x3a83bf,_0x4f56c8,_0x12661b){return _0x5acbe9(_0x22d51f-0xc8,_0x22d51f,_0x3a83bf-0x1cc,_0x12661b-0xe5);}const _0x4af082={'JMrMQ':_0x4e35b6[_0x46a7e6(0x12f,0x10d,0xa1,0x1c2)],'tmQDl':function(_0x42dbb5,_0x3e34ee){function _0x3e4d27(_0xc304e3,_0x13a277,_0x23bf2b,_0x3509c9){return _0x46a7e6(_0xc304e3,_0x23bf2b- -0x274,_0x23bf2b-0x135,_0x3509c9-0x7b);}return _0x4e35b6[_0x3e4d27(-0x15d,-0x16b,-0x141,-0x147)](_0x42dbb5,_0x3e34ee);},'ASwxU':_0x4e35b6[_0x3435cc(0x59d,0x622,0x587,0x6d5)],'bEHSx':_0x4e35b6['VWVFl']};function _0x46a7e6(_0x446557,_0x5d8c3a,_0x11712d,_0x1ab6ea){return _0x5acbe9(_0x446557-0x10f,_0x446557,_0x5d8c3a- -0x2fd,_0x1ab6ea-0x38);}if('Esges'===_0x3435cc(0x55d,0x5b0,0x64d,0x527)){const _0x3440c0=new FileReader();_0x3440c0['onloadend']=()=>_0xbefdc9(_0x3440c0[_0x46a7e6(0x1c,0xd8,0x68,0xb0)]),_0x3440c0[_0x3435cc(0x63b,0x60a,0x664,0x6ce)]=_0x4698fb,_0x3440c0[_0x46a7e6(0x14e,0x14c,0x119,0x199)+_0x3435cc(0x675,0x607,0x5b6,0x5b5)](_0x5a6572);}else{if(_0x4df364['initialize'+_0x46a7e6(0xa9,0xc3,0x154,0x93)+_0x46a7e6(0x7a,0xac,0x9b,0xed)]){const _0x2a779c=_0x4af082['JMrMQ']['split']('|');let _0x347aec=-0x1fd5+-0xa*-0x202+0x11*0xb1;while(!![]){switch(_0x2a779c[_0x347aec++]){case'0':_0x3f739d[_0x46a7e6(-0x4f,0x4b,0x71,-0x2d)+_0x46a7e6(0xe3,0xac,-0x3,0xfd)](_0x217109['GENERATE_I'+_0x3435cc(0x566,0x57a,0x5b9,0x53b)+'ST'],_0x345e63);continue;case'1':_0x41254b[_0x46a7e6(0x101,0x14e,0x126,0x172)+_0x46a7e6(0x11c,0xc3,0x130,0x15f)+_0x46a7e6(0xd7,0xac,0x2a,0x149)]=![];continue;case'2':_0x4af082['tmQDl'](_0x4b5c09,_0x4af082[_0x3435cc(0x596,0x51a,0x5ae,0x4d4)]);continue;case'3':_0x4241b8[_0x46a7e6(-0x5d,0x4b,-0x30,-0x21)+_0x46a7e6(0x2,0xac,0x67,0x1a)](_0x4af082[_0x46a7e6(0x1d6,0x12d,0x178,0xcb)],_0x325f88);continue;case'4':_0x29690c['forEach'](_0x1e6098=>{function _0x167e06(_0x17dea5,_0x44cabb,_0x2e5aed,_0x4c9a5e){return _0x3435cc(_0x17dea5,_0x4c9a5e- -0x37e,_0x2e5aed-0x88,_0x4c9a5e-0x73);}function _0x3a1ce7(_0x419315,_0x2cb864,_0x148e8c,_0x78fa28){return _0x46a7e6(_0x2cb864,_0x419315- -0xab,_0x148e8c-0x19b,_0x78fa28-0xd9);}_0x18f0d4[_0x167e06(0x1bd,0x129,0x1ca,0x196)+_0x167e06(0x269,0x1c8,0x253,0x1f7)](_0x1e6098,_0x9dd383);});continue;}break;}}}});_0x2f21b2=_0x3d5470,_0x4e35b6[_0x5acbe9(0x299,0x3d0,0x35e,0x387)](String,extension_settings[extensionName][_0x5acbe9(0x499,0x397,0x3ef,0x373)+_0x278210(0x44c,0x384,0x41c,0x405)])===_0x4e35b6[_0x5acbe9(0x45d,0x325,0x3e3,0x3fb)]&&(_0x4e35b6[_0x5acbe9(0x2c6,0x2c0,0x31f,0x282)]('XfDCt',_0x278210(0x43e,0x421,0x422,0x476))?_0x3c2c27[_0x4e35b6['WjSjs']]=_0x24b6fc:_0x2f21b2=await _0x4e35b6[_0x5acbe9(0x45a,0x3fb,0x40d,0x4cc)](convertImageToJpeg,_0x2f21b2)),_0x4e35b6[_0x5acbe9(0x45b,0x466,0x422,0x3a1)](addLog,_0x4e35b6[_0x278210(0x3d0,0x436,0x3ac,0x38f)]);}else _0x4e35b6[_0x5acbe9(0x47f,0x45f,0x40d,0x3c1)](_0x563f98,_0x5acbe9(0x420,0x2ce,0x376,0x318)+_0x5acbe9(0x3e3,0x38a,0x41e,0x48a)+'etch\x20Markd'+'own\x20image:'+'\x20'+_0x33c0e9[_0x278210(0x29f,0x2b3,0x350,0x2fa)]),_0x27f77d=_0x196d7,_0xef444b(_0x4e35b6[_0x5acbe9(0x2ab,0x323,0x35d,0x347)]);}catch(_0x32bca1){if(_0x4e35b6[_0x5acbe9(0x386,0x2a0,0x2df,0x240)](_0x4e35b6[_0x5acbe9(0x329,0x258,0x306,0x25d)],'ulLkr')){_0x4e35b6[_0x5acbe9(0x335,0x33f,0x3d9,0x363)](_0x39ffb2,_0x278210(0x49e,0x45d,0x3e8,0x454)+_0x5acbe9(0x381,0x408,0x39b,0x37e)+_0x278210(0x3ab,0x357,0x3e2,0x3bc)+_0x278210(0x295,0x2ba,0x352,0x3a6)),_0x50e743=_0x21e10d;const _0x2b9c23={};_0x2b9c23[_0x278210(0x4ba,0x50c,0x46a,0x42d)+'pe']=_0x5acbe9(0x338,0x381,0x30a,0x300)+'n/json',_0x2b9c23[_0x278210(0x33f,0x40a,0x396,0x3ca)+'ion']=_0x5acbe9(0x3ab,0x263,0x30e,0x2d9)+_0x44c21e,_0x416d8a=_0x2b9c23,_0x4f58cb=_0x12810c;}else addLog('[Banana]\x20F'+_0x278210(0x443,0x419,0x425,0x3cc)+_0x278210(0x407,0x365,0x3bc,0x42f)+_0x278210(0x489,0x4c7,0x3fd,0x40b)+'\x20'+_0x32bca1['message']),_0x2f21b2=_0x40bd23,_0x4e35b6[_0x278210(0x416,0x399,0x3e0,0x468)](addLog,_0x4e35b6['iKFUl']);}}}else _0x4e35b6[_0x5acbe9(0x374,0x461,0x3e9,0x39c)](addLog,_0x4e35b6[_0x5acbe9(0x38d,0x3a0,0x2f0,0x252)]);}}}if(!_0x2f21b2)throw new Error(_0x4e35b6[_0x278210(0x264,0x30d,0x309,0x2eb)]);return addLog(_0x5acbe9(0x468,0x34f,0x3e1,0x38e)+'mage\x20gener'+_0x5acbe9(0x48f,0x404,0x45b,0x4a8)+_0x5acbe9(0x360,0x3d9,0x3ec,0x45c)),taskQueue[_0x278210(0x414,0x437,0x3b6,0x3f8)+'sk'](_0x25521c,!![]),currentTaskId=null,{'image':_0x2f21b2,'change':_0x4e35b6[_0x5acbe9(0x31b,0x47a,0x3c3,0x44f)](_0x2406f6,'')};}catch(_0x59ac30){const _0xac112=_0x4e35b6[_0x5acbe9(0x36e,0x2b6,0x355,0x40c)][_0x5acbe9(0x48c,0x334,0x3cc,0x488)]('|');let _0x1af50c=-0x12c+0x1*-0x1f9a+0x2*0x1063;while(!![]){switch(_0xac112[_0x1af50c++]){case'0':_0x4e35b6[_0x5acbe9(0x466,0x488,0x450,0x4d6)](addLog,_0x5acbe9(0x3ed,0x2c5,0x376,0x3e3)+_0x278210(0x406,0x410,0x406,0x42e)+':\x20'+_0x59ac30[_0x278210(0x2f8,0x2d7,0x350,0x329)]);continue;case'1':throw _0x59ac30;continue;case'2':console[_0x278210(0x395,0x42a,0x38e,0x2f1)](_0x278210(0x385,0x311,0x37d,0x32a)+_0x5acbe9(0x339,0x427,0x3ff,0x4b2)+':',_0x59ac30);continue;case'3':currentTaskId=null;continue;case'4':if(_0x4e35b6[_0x278210(0x2ae,0x26d,0x326,0x32f)](_0x59ac30[_0x5acbe9(0x322,0x349,0x349,0x2ee)],_0x4e35b6[_0x5acbe9(0x486,0x3f3,0x42c,0x3fa)])){}else taskQueue['completeTa'+'sk'](_0x25521c,![]);continue;}break;}}}export async function bananaGenerate(_0x47b8c8){const _0x5ba1c8={'skqkC':function(_0x45bf88,_0x550299){return _0x45bf88(_0x550299);},'rlrvu':function(_0x5dde1c,_0x35da33){return _0x5dde1c||_0x35da33;},'uJLhs':function(_0x951609,_0x1f8c49){return _0x951609(_0x1f8c49);},'LiRHY':_0x520cfa(0x454,0x4cf,0x519,0x3ad)+_0x520cfa(0x571,0x5b8,0x5e9,0x5a0)+'ntains\x20tex'+_0x520cfa(0x506,0x466,0x547,0x43c)+_0xf98c9(0x31b,0x360,0x3d6,0x32f),'ekLeT':function(_0x13bae9){return _0x13bae9();},'RvHlE':function(_0x55686c,_0xb0404){return _0x55686c(_0xb0404);},'wHkXh':_0xf98c9(0x42e,0x4ec,0x450,0x4f4),'AviDM':function(_0xfb7a0d,_0x1380e1){return _0xfb7a0d(_0x1380e1);},'oLuOi':function(_0x1259bf,_0x1ecadd){return _0x1259bf!=_0x1ecadd;},'RwyvA':function(_0x10905a,_0x301402){return _0x10905a!==_0x301402;},'FQRui':function(_0x1c0d26,_0x337455){return _0x1c0d26(_0x337455);},'WNsDL':function(_0x1a6692,_0x28d789){return _0x1a6692!==_0x28d789;},'DwAtW':'rflYV','UrXKG':function(_0x262049,_0x1cabf2){return _0x262049+_0x1cabf2;},'vBPTE':_0x520cfa(0x46e,0x4b4,0x43e,0x462),'SDkGY':function(_0x18dab6,_0x145ae3){return _0x18dab6(_0x145ae3);}};_0x5ba1c8[_0xf98c9(0x417,0x4c9,0x37b,0x3b4)](clearLog);let {id:_0xea2ee4,prompt:_0x111a56,width:_0x16a612,height:_0x2e5ec9,change:_0x76c9c2,retouchPrompt:_0x5611d1,retouchImage:_0xfb97a8}=_0x47b8c8;function _0xf98c9(_0x13ca77,_0x609ef6,_0x211f5d,_0x52a503){return _0x2b41(_0x13ca77-0x164,_0x211f5d);}currentRequestId=_0xea2ee4,currentPrompt=_0x111a56;function _0x520cfa(_0x486dc2,_0x811664,_0x1ccf63,_0xa1cb90){return _0x2b41(_0x486dc2-0x2e9,_0x811664);}_0x5ba1c8[_0xf98c9(0x2ba,0x380,0x216,0x20d)](addLog,_0x520cfa(0x454,0x461,0x3f5,0x38c)+_0xf98c9(0x329,0x346,0x39f,0x3d7)+_0xf98c9(0x2df,0x284,0x390,0x2af)+_0xf98c9(0x358,0x405,0x29f,0x382)+_0x520cfa(0x56f,0x596,0x5ba,0x5f7)+_0xea2ee4+')');let _0x4878d7='';_0x76c9c2?_0x4878d7=_0x76c9c2[_0xf98c9(0x3d0,0x482,0x475,0x401)](_0x5ba1c8[_0xf98c9(0x351,0x3bf,0x3a7,0x2f9)],''):_0x4878d7=_0x111a56;if(_0x76c9c2&&_0x76c9c2[_0xf98c9(0x312,0x289,0x3ca,0x25d)](_0xf98c9(0x42e,0x3ca,0x40c,0x376))){_0x5ba1c8['AviDM'](addLog,_0xf98c9(0x331,0x329,0x38f,0x2ad)+'启动');if(_0x5611d1)addLog(_0x520cfa(0x4c9,0x4f2,0x3fe,0x432)+_0x5611d1);if(_0xfb97a8)addLog(_0xf98c9(0x397,0x37d,0x42d,0x447)+']');}try{const {image:_0x41b1b9,change:_0x6b3554}=await generateBananaImage({'prompt':_0x111a56,'width':_0x16a612,'height':_0x2e5ec9,'change':_0x76c9c2,'retouchPrompt':_0x5611d1,'retouchImage':_0xfb97a8});if(_0x5ba1c8[_0x520cfa(0x5ac,0x56e,0x5a3,0x513)](extension_settings[extensionName]['cache'],'0')){if(_0x5ba1c8[_0xf98c9(0x2d2,0x2d7,0x33f,0x32e)]('QVFqr',_0x520cfa(0x48d,0x479,0x3c5,0x4e6))){_0x5ba1c8['skqkC'](_0xf2f502,_0x520cfa(0x46d,0x4c8,0x499,0x45b)+_0x520cfa(0x43e,0x4d0,0x447,0x415)+'。');const _0x16c4cf=_0x5ba1c8[_0x520cfa(0x49c,0x517,0x3e6,0x4d4)](_0x332de4,'默认'),_0x102acb={};_0x102acb[_0x520cfa(0x531,0x5df,0x4bf,0x52e)+'on']=[],_0x102acb['fixedPromp'+'t']='',_0x1f30ed=_0x925594[_0x16c4cf]||_0x102acb,_0x5ba1c8['skqkC'](_0x138a7f,_0xf98c9(0x356,0x390,0x312,0x2d9)+_0x520cfa(0x557,0x4bc,0x5f8,0x5af)+_0x16c4cf+'\x22');}else{const _0x36d480={};_0x36d480[_0x520cfa(0x581,0x4e0,0x4bd,0x58f)]=_0x4878d7,await setItemImg(_0x111a56,_0x41b1b9,_0x36d480),_0x5ba1c8[_0xf98c9(0x36e,0x2bb,0x435,0x31e)](addLog,_0x520cfa(0x5ad,0x611,0x54e,0x5b0)+'or\x20prompt:'+'\x20'+_0x111a56),extension_settings[extensionName]['banana']['cishu']?_0x5ba1c8['WNsDL'](_0x5ba1c8[_0xf98c9(0x3d1,0x48a,0x31e,0x422)],_0x5ba1c8[_0x520cfa(0x556,0x535,0x574,0x4c5)])?_0x5ba1c8['uJLhs'](_0x548c29,_0x5ba1c8[_0xf98c9(0x2fc,0x312,0x397,0x3c5)]):(extension_settings[extensionName][_0x520cfa(0x45c,0x3d4,0x498,0x3a6)][_0x520cfa(0x437,0x3d1,0x4b2,0x3c6)]=_0x5ba1c8[_0x520cfa(0x51f,0x4bd,0x5dd,0x587)](extension_settings[extensionName][_0xf98c9(0x2d7,0x248,0x36c,0x29a)][_0xf98c9(0x2b2,0x299,0x27d,0x312)],-0x16b8+-0x1*0x491+0x1b4a),_0x5ba1c8[_0x520cfa(0x511,0x5ab,0x45a,0x56c)](addLog,'当前生图次数为\x20fo'+'r\x20prompt:\x20'+extension_settings[extensionName]['banana'][_0xf98c9(0x2b2,0x2db,0x30f,0x2b5)])):(extension_settings[extensionName][_0x520cfa(0x45c,0x3e5,0x46e,0x46f)][_0xf98c9(0x2b2,0x205,0x264,0x2fa)]=0x1176+-0x33c+-0xe39,_0x5ba1c8['FQRui'](addLog,_0xf98c9(0x3ae,0x36b,0x38f,0x3ef)+_0xf98c9(0x39d,0x423,0x350,0x3af)+extension_settings[extensionName][_0x520cfa(0x45c,0x3f4,0x392,0x4db)][_0x520cfa(0x437,0x416,0x397,0x3be)]));}}else _0x5ba1c8['FQRui'](addLog,_0xf98c9(0x3b3,0x356,0x3ae,0x3a2)+'库');const _0x36c053={};_0x36c053['id']=_0xea2ee4,_0x36c053['success']=!![],_0x36c053[_0x520cfa(0x59a,0x631,0x521,0x594)]=_0x41b1b9,_0x36c053[_0xf98c9(0x346,0x2d8,0x338,0x325)]=_0x111a56,_0x36c053['change']=_0x4878d7,eventSource[_0xf98c9(0x2da,0x39a,0x273,0x22e)](EventType[_0xf98c9(0x31d,0x2e8,0x3a5,0x305)+_0x520cfa(0x4e0,0x430,0x51e,0x552)+_0x520cfa(0x52b,0x566,0x514,0x4f9)],_0x36c053),addLog(_0xf98c9(0x318,0x374,0x365,0x2cb)+_0x520cfa(0x51a,0x4bf,0x49e,0x49e)+_0xf98c9(0x2e3,0x369,0x299,0x347)+_0x520cfa(0x5c9,0x68e,0x673,0x550)+':\x20'+_0xea2ee4);}catch(_0x2a9a22){if(_0x5ba1c8[_0x520cfa(0x4c3,0x468,0x465,0x553)](_0x5ba1c8[_0xf98c9(0x2c8,0x378,0x351,0x36d)],_0x5ba1c8[_0x520cfa(0x44d,0x423,0x3ce,0x48f)]))_0x1b9574['completeTa'+'sk'](_0x52ad05,![]);else{const _0x153170=_0xf98c9(0x354,0x39e,0x3da,0x406)+_0x520cfa(0x5b9,0x671,0x5c9,0x524)+_0x520cfa(0x53d,0x4e3,0x54b,0x486)+_0xf98c9(0x388,0x31e,0x343,0x36b)+_0xea2ee4+':\x20'+_0x2a9a22['message'];_0x5ba1c8[_0xf98c9(0x364,0x30e,0x2ea,0x2b4)](addLog,_0x153170),console[_0xf98c9(0x35d,0x36f,0x2ac,0x2fc)](_0x153170);const _0x424ddb={};_0x424ddb['id']=_0xea2ee4,_0x424ddb[_0xf98c9(0x352,0x386,0x398,0x404)]=![],_0x424ddb[_0xf98c9(0x35d,0x34f,0x31f,0x40e)]=_0x2a9a22[_0xf98c9(0x31f,0x2cf,0x34f,0x2e8)],_0x424ddb[_0xf98c9(0x346,0x327,0x30d,0x32d)]=_0x111a56,eventSource[_0xf98c9(0x2da,0x31c,0x213,0x257)](EventType[_0xf98c9(0x31d,0x25e,0x299,0x382)+'MAGE_RESPO'+'NSE'],_0x424ddb),_0x5ba1c8[_0xf98c9(0x43c,0x4f6,0x409,0x4c1)](addLog,'[Banana]\x20E'+_0xf98c9(0x3c3,0x44a,0x326,0x3e8)+_0x520cfa(0x4d3,0x4a5,0x49f,0x555)+'nse\x20for\x20ID'+':\x20'+_0xea2ee4);}}}function handleCancelBananaTask(_0x256673){const _0x2a3f0e={'mhWMD':function(_0x5a642e,_0x3445f9){return _0x5a642e(_0x3445f9);},'ErEbK':_0x22f426(0x2aa,0x256,0x226,0x1e7),'kxEpU':function(_0x1ab107,_0x2cc8cc){return _0x1ab107||_0x2cc8cc;}},{taskId:_0x21d56d}=_0x256673;function _0x5d8fad(_0x26d031,_0x37358c,_0x1dae24,_0x4350f1){return _0x2b41(_0x1dae24- -0x9c,_0x37358c);}function _0x22f426(_0x53435e,_0x158cbe,_0x398053,_0xc600e0){return _0x2b41(_0x398053- -0x58,_0xc600e0);}_0x2a3f0e[_0x22f426(0x1b2,0xf9,0x13e,0x188)](addLog,_0x22f426(0x132,0x84,0x149,0x18d)+_0x22f426(0x159,0xdb,0x107,0x1a5)+_0x5d8fad(0x26,0x109,0xdd,0x5e)+_0x21d56d+')');if(currentTaskId===_0x21d56d&&currentRequestId){const _0x35a380=_0x2a3f0e['ErEbK'][_0x5d8fad(0x108,0x1f7,0x1a2,0x147)]('|');let _0x2c8f26=-0xe92+0x999+0x4f9;while(!![]){switch(_0x35a380[_0x2c8f26++]){case'0':currentPrompt=null;continue;case'1':addLog('[Banana]\x20取'+_0x22f426(0x2dd,0x2ee,0x24b,0x297)+'响应\x20(ID:\x20'+currentRequestId+')');continue;case'2':eventSource[_0x22f426(0xf2,0x5e,0x11e,0x162)](EventType['GENERATE_I'+_0x22f426(0x243,0x249,0x19f,0x20f)+_0x22f426(0x1f9,0x1a6,0x1ea,0x12f)],{'id':currentRequestId,'success':![],'error':'任务已取消','prompt':_0x2a3f0e[_0x5d8fad(0x279,0x213,0x1fe,0x1aa)](currentPrompt,'')});continue;case'3':currentTaskId=null;continue;case'4':currentRequestId=null;continue;}break;}}}function initializeBananaListener(){const _0x4158af={'etPaP':_0x59e187(0x1ff,0x1b4,0x12b,0x149)+'cancel_ban'+_0x1e593c(0x310,0x2cb,0x37a,0x366),'ReMYn':function(_0x300a1e,_0x5b9ba0){return _0x300a1e(_0x5b9ba0);},'APLOI':_0x59e187(0x1a0,0x11d,0xcc,0x1cc)+_0x59e187(0x25c,0x21c,0x229,0x189)};function _0x1e593c(_0x169d3b,_0x1a9cad,_0x3a18dc,_0x3da497){return _0x2b41(_0x169d3b-0x1b7,_0x1a9cad);}eventSource['on'](EventType['GENERATE_I'+'MAGE_REQUE'+'ST'],bananaGenerate);function _0x59e187(_0x48a946,_0x18f452,_0x533e8b,_0x328828){return _0x2b41(_0x18f452- -0x75,_0x533e8b);}eventSource['on'](_0x4158af[_0x59e187(0x1df,0x264,0x1bc,0x220)],handleCancelBananaTask),_0x4158af[_0x1e593c(0x44c,0x4b0,0x3d4,0x490)](addLog,_0x4158af[_0x59e187(0x1ad,0x1bb,0x264,0x160)]);}function _0x2b41(_0x1eb2c0,_0x37a8d3){_0x1eb2c0=_0x1eb2c0-(-0x1*0x819+0x23f2+-0x1*0x1a8c);const _0x25b6d1=_0x5a42();let _0x25a7dd=_0x25b6d1[_0x1eb2c0];if(_0x2b41['Myifun']===undefined){var _0x733fde=function(_0xc0fb4e){const _0x132985='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x285fab='',_0x4197d7='',_0x25b675=_0x285fab+_0x733fde;for(let _0x357b18=0xa21*-0x3+0x148c+-0x1*-0x9d7,_0x5337e3,_0x3686d0,_0x3cc9d6=-0x515+0xe2a+-0x3*0x307;_0x3686d0=_0xc0fb4e['charAt'](_0x3cc9d6++);~_0x3686d0&&(_0x5337e3=_0x357b18%(-0x19f9+0x2b4*-0x4+0x24cd)?_0x5337e3*(0x2021+-0x1962+0x67f*-0x1)+_0x3686d0:_0x3686d0,_0x357b18++%(-0x6*0x61b+0xd08+-0x179e*-0x1))?_0x285fab+=_0x25b675['charCodeAt'](_0x3cc9d6+(0x1ee1+0x1a10*-0x1+-0x4c7))-(-0xe5*0x7+-0x5c2*-0x3+-0xaf9)!==0x1*-0x22e8+-0x21*0xbb+0x3b03?String['fromCharCode'](0x1335+0x25ad+-0x39*0xfb&_0x5337e3>>(-(-0x2*0xb99+0x1*0x1a17+-0x2e3)*_0x357b18&0x11ae+0x1608+-0x27b0)):_0x357b18:-0x1e1*-0x7+0x52d+-0x33*0x5c){_0x3686d0=_0x132985['indexOf'](_0x3686d0);}for(let _0x3101ee=0x240*-0xc+-0x541*0x5+0x3545,_0x5a2282=_0x285fab['length'];_0x3101ee<_0x5a2282;_0x3101ee++){_0x4197d7+='%'+('00'+_0x285fab['charCodeAt'](_0x3101ee)['toString'](0xe64+-0xec+0x2c*-0x4e))['slice'](-(0x67a+-0x1*-0x238d+-0x2a05));}return decodeURIComponent(_0x4197d7);};_0x2b41['rGXKEG']=_0x733fde,_0x2b41['QcWrps']={},_0x2b41['Myifun']=!![];}const _0x35adea=_0x25b6d1[0x215*-0xb+-0x1c5e+0x3345],_0x327b75=_0x1eb2c0+_0x35adea,_0x54ca77=_0x2b41['QcWrps'][_0x327b75];if(!_0x54ca77){const _0x3b4e69=function(_0x3e9dc7){this['ylDoDq']=_0x3e9dc7,this['viAsvm']=[-0x1551+0x1*0x1a47+-0x4f5,-0xa*-0x1e2+0x15fa+-0x28ce,0x163f+-0x25ab*-0x1+-0x1df5*0x2],this['ilVMAo']=function(){return'newState';},this['ejmMan']='\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*',this['uBpReE']='[\x27|\x22].+[\x27|\x22];?\x20*}';};_0x3b4e69['prototype']['vcHwGP']=function(){const _0x5de4f1=new RegExp(this['ejmMan']+this['uBpReE']),_0x241a95=_0x5de4f1['test'](this['ilVMAo']['toString']())?--this['viAsvm'][0x685*0x1+0xa78+-0x10fc]:--this['viAsvm'][0x1b4f+0x1af1+-0xf8*0x38];return this['WSjNhB'](_0x241a95);},_0x3b4e69['prototype']['WSjNhB']=function(_0x48a26b){if(!Boolean(~_0x48a26b))return _0x48a26b;return this['BUwkgo'](this['ylDoDq']);},_0x3b4e69['prototype']['BUwkgo']=function(_0x35211f){for(let _0x1ba39e=0x8db+-0x2*-0x62+0x99f*-0x1,_0x48894d=this['viAsvm']['length'];_0x1ba39e<_0x48894d;_0x1ba39e++){this['viAsvm']['push'](Math['round'](Math['random']())),_0x48894d=this['viAsvm']['length'];}return _0x35211f(this['viAsvm'][-0x41*0x71+-0x1*0x4ff+0x21b0]);},new _0x3b4e69(_0x2b41)['vcHwGP'](),_0x25a7dd=_0x2b41['rGXKEG'](_0x25a7dd),_0x2b41['QcWrps'][_0x327b75]=_0x25a7dd;}else _0x25a7dd=_0x54ca77;return _0x25a7dd;}export async function replaceWithBanana(){function _0x245142(_0x50a0de,_0x439e0c,_0x69dffc,_0x6ab0e9){return _0x2b41(_0x69dffc- -0x18b,_0x50a0de);}const _0xd15ca4={'kFiYp':function(_0x138335,_0x25ccaf){return _0x138335(_0x25ccaf);},'ZzixK':'[Banana]\x20S'+_0x5b0969(0x3ff,0x3fd,0x3b8,0x342)+'y\x20extracte'+_0x5b0969(0x493,0x410,0x3aa,0x43a)+_0x245142(0x18b,0x10a,0xee,0xbc)+_0x5b0969(0x44a,0x4c4,0x540,0x56f),'IgSmK':function(_0x964fbb,_0x85fd2f){return _0x964fbb==_0x85fd2f;},'ugDHH':_0x5b0969(0x3b2,0x3d4,0x49f,0x46f),'UiUSZ':function(_0x702f1c,_0x4283c8){return _0x702f1c===_0x4283c8;},'KUNeZ':_0x5b0969(0x490,0x43a,0x48b,0x3dd),'sYGrF':_0x245142(0x5f,-0x1,0xf,-0xb9),'GzkQC':function(_0x2f9996){return _0x2f9996();},'UanUA':function(_0x1e9b54,_0x2147ed){return _0x1e9b54!==_0x2147ed;},'BfCmU':_0x245142(0x37,0x22,-0x37,-0xc3),'zaYlD':_0x245142(0xb,0x137,0xc3,0x10b),'CLxrN':'[Banana]\x20生'+_0x5b0969(0x574,0x500,0x489,0x5ad),'xHvGY':_0x5b0969(0x512,0x48a,0x487,0x544)+_0x5b0969(0x440,0x42f,0x4d8,0x452)+_0x245142(0x5f,-0x7d,-0x32,0x47)};function _0x5b0969(_0x587839,_0x19e06a,_0xb82d9c,_0xdd4618){return _0x2b41(_0x19e06a-0x261,_0xdd4618);}if(_0xd15ca4[_0x245142(0xd7,0xe4,0x14b,0x14b)](extension_settings[extensionName]['mode'],_0xd15ca4[_0x245142(-0x60,-0x1b,-0x24,-0xdb)])){if(!window[_0x5b0969(0x4f7,0x51e,0x5a4,0x46e)+_0x245142(0xbc,0xa1,0xa7,0x3a)+_0x5b0969(0x4a2,0x47c,0x3fb,0x4d6)]){if(_0xd15ca4['UiUSZ'](_0xd15ca4[_0x245142(-0x57,-0x87,-0x33,0x20)],_0xd15ca4[_0x245142(0x10a,0x1bc,0x13b,0xd6)])){const _0x10210f=new _0x7c99a();_0x10210f[_0x5b0969(0x441,0x4eb,0x4e8,0x451)]=()=>_0x49df59(_0x10210f[_0x5b0969(0x4eb,0x4a8,0x404,0x4fa)]),_0x10210f[_0x5b0969(0x512,0x511,0x4eb,0x4db)]=_0x4988a0,_0x10210f[_0x245142(0x71,0xc5,0x130,0x11c)+_0x5b0969(0x44d,0x50e,0x449,0x4f9)](_0x1e7b79);}else window['initialize'+_0x5b0969(0x47a,0x493,0x55b,0x465)+_0x245142(0x13b,0x155,0x90,0x11e)]=!![],_0xd15ca4['GzkQC'](initializeBananaListener);}_0xd15ca4['GzkQC'](initializeImageProcessing);}else{if(window['initialize'+'BananaList'+_0x245142(0x5b,0xfa,0x90,0xd3)]){if(_0xd15ca4['UanUA'](_0xd15ca4[_0x5b0969(0x3ca,0x48c,0x521,0x3eb)],_0xd15ca4[_0x5b0969(0x545,0x48c,0x436,0x3d4)]))_0xd15ca4['kFiYp'](_0x495209,_0x5b0969(0x329,0x3e2,0x436,0x38a)+'etected\x20Ma'+_0x245142(-0x77,0xd4,0x4b,0x4d)+_0x5b0969(0x5a5,0x51b,0x50c,0x47f)+_0x5b0969(0x59e,0x532,0x56d,0x53d)),_0x261ecb=_0x43a81b,_0xd15ca4[_0x5b0969(0x516,0x452,0x47f,0x51b)](_0x513f8c,_0xd15ca4[_0x245142(0xbf,0x43,0x101,0x154)]);else{const _0x3803a5=_0xd15ca4[_0x5b0969(0x424,0x419,0x430,0x361)]['split']('|');let _0x46dd0d=-0x238b+-0x2680+0x4a0b;while(!![]){switch(_0x3803a5[_0x46dd0d++]){case'0':LEGACY_EVENT_NAMES['forEach'](_0x1cb0ed=>{function _0x2be471(_0x54f06e,_0x4cdb3e,_0x3dad95,_0x1c6ab4){return _0x245142(_0x4cdb3e,_0x4cdb3e-0x1b4,_0x3dad95-0x486,_0x1c6ab4-0xac);}function _0x41d54b(_0x445146,_0xe0d777,_0x379eda,_0x1c941e){return _0x245142(_0x379eda,_0xe0d777-0x22,_0xe0d777-0x296,_0x1c941e-0x29);}eventSource[_0x2be471(0x55d,0x44e,0x4b5,0x505)+_0x41d54b(0x382,0x326,0x2cb,0x274)](_0x1cb0ed,bananaGenerate);});continue;case'1':_0xd15ca4[_0x245142(0x7,0x4c,0x66,0x6c)](addLog,_0xd15ca4[_0x5b0969(0x467,0x46d,0x48f,0x491)]);continue;case'2':window[_0x245142(0x176,0xe8,0x132,0x1ed)+_0x5b0969(0x4fb,0x493,0x414,0x42c)+_0x245142(0xc8,0x6c,0x90,0x37)]=![];continue;case'3':eventSource[_0x5b0969(0x4ab,0x41b,0x392,0x46d)+_0x245142(0x75,0x107,0x90,-0x23)](_0xd15ca4[_0x5b0969(0x4ad,0x486,0x529,0x4aa)],handleCancelBananaTask);continue;case'4':eventSource[_0x245142(0x7b,0xd2,0x2f,-0x13)+_0x245142(0x121,0x47,0x90,0x134)](EventType['GENERATE_I'+_0x5b0969(0x522,0x481,0x3c5,0x516)+'ST'],bananaGenerate);continue;}break;}}}}}