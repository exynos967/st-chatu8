(function(_0x3cd5a6,_0x25af6d){function _0x2a3996(_0x4ae26d,_0x5e2d1b,_0x2cb8f1,_0x5642cb){return _0x2e6b(_0x5e2d1b- -0x108,_0x4ae26d);}function _0x22954f(_0x142358,_0x4c9123,_0x2d9e61,_0x19d1a6){return _0x2e6b(_0x142358-0x144,_0x4c9123);}const _0x2f1a0b=_0x3cd5a6();while(!![]){try{const _0x5b377c=-parseInt(_0x22954f(0x2ff,0x27e,0x293,0x351))/(0xba8+-0x29*0xe5+0x1906)*(-parseInt(_0x22954f(0x35c,0x2e7,0x376,0x2f2))/(0x127c*0x2+-0x4ce*-0x1+-0x4a4*0x9))+parseInt(_0x22954f(0x2c8,0x246,0x278,0x338))/(-0x3ba*-0x1+-0xf7f+0xbc8)*(parseInt(_0x2a3996(0x17b,0x121,0xa2,0xd7))/(0x6bc+0x1*0x2f9+-0x9b1))+parseInt(_0x22954f(0x379,0x389,0x382,0x372))/(0x20ca+-0x82b+-0x189a)+parseInt(_0x2a3996(0x57,0x85,0x6a,0xbe))/(0x7c9*0x3+0x1aad+0x1*-0x3202)+parseInt(_0x2a3996(0x11a,0x136,0x175,0x177))/(-0x5d*0x17+0x1bc3+-0x1361)*(parseInt(_0x22954f(0x2d9,0x2ae,0x2d1,0x352))/(0x1*-0x1f24+-0x3a6+-0x1*-0x22d2))+parseInt(_0x22954f(0x3ce,0x3a5,0x34c,0x39d))/(-0x73c+-0x2709+0x2*0x1727)*(-parseInt(_0x22954f(0x371,0x377,0x390,0x368))/(-0x1fb3+-0x1a6c+0x3a29*0x1))+-parseInt(_0x2a3996(0x58,0x83,0xa0,0xc1))/(-0x10f3+-0x2115+0x3213)*(parseInt(_0x2a3996(0x10d,0xfc,0x131,0x172))/(0x1aa6+-0x2*0xdaf+0xc4));if(_0x5b377c===_0x25af6d)break;else _0x2f1a0b['push'](_0x2f1a0b['shift']());}catch(_0x170422){_0x2f1a0b['push'](_0x2f1a0b['shift']());}}}(_0x420e,0x63d3f+0x395ba+0x5e7ad*-0x1));const _0x30161b=(function(){let _0x1fe248=!![];return function(_0x49938c,_0x5d7a1a){const _0x4c0ca6=_0x1fe248?function(){if(_0x5d7a1a){const _0x227d8e=_0x5d7a1a['apply'](_0x49938c,arguments);return _0x5d7a1a=null,_0x227d8e;}}:function(){};return _0x1fe248=![],_0x4c0ca6;};}()),_0x4d9b30=_0x30161b(this,function(){function _0x42c7bd(_0xa720da,_0x3dd417,_0x2f4a7f,_0x3c41dd){return _0x2e6b(_0xa720da-0x145,_0x3c41dd);}const _0x20e344={};function _0x49eb5d(_0x3e5e26,_0x5587d7,_0x48559f,_0x2d9f0d){return _0x2e6b(_0x3e5e26- -0x32c,_0x2d9f0d);}_0x20e344[_0x42c7bd(0x30c,0x2fe,0x374,0x281)]='(((.+)+)+)'+'+$';const _0x5a3eab=_0x20e344;return _0x4d9b30[_0x42c7bd(0x33c,0x38b,0x2f1,0x37d)]()[_0x49eb5d(-0x1aa,-0x202,-0x197,-0x198)](_0x5a3eab[_0x42c7bd(0x30c,0x2aa,0x2dd,0x30d)])['toString']()[_0x49eb5d(-0x158,-0x1cd,-0x137,-0x1cf)+'r'](_0x4d9b30)[_0x49eb5d(-0x1aa,-0x205,-0x1d7,-0x20c)](_0x5a3eab[_0x42c7bd(0x30c,0x2a5,0x379,0x2d6)]);});_0x4d9b30();import{extension_settings}from'../../../../extensions.js';import{eventSource}from'../../../../../script.js';import{extensionName,EventType}from'./config.js';import{sleep,generateRandomSeed,zhengmian,fumian,getRequestHeaders,prompt_replace,addLog,clearLog,parsePromptStringWithCoordinates,prompt_replace_for_character,stripChineseAnnotations}from'./utils.js';import{initializeImageProcessing}from'./iframe.js';function _0x420e(){const _0x9b3b3a=['vvzit3e','C2fTCgXLq291BG','B2fKihDPDgGG','AKPnwhm','qxv0Ag9YAxPHDa','rwzvCLi','rhb1vhC','t0fbAKS','DK5lsuS','svfwCe4','tKXOrvC','q29UDgvUDc1uEq','DcbMywLSzwqGDW','zMfPBgvKigzVCG','qMfUyw5H5l+U5zU+5QIH5BYp','BhvYzsbYzxnWBW','y29UDMvYC2f0Aq','DwLSDcbTDwX0Aq','Cg9ZDgzPEfbYBW','C2uGzgLKig5VDa','Bw9KzwW','Aw1Hz2vFDxjS','v3jAqvq','5zU+5lQl5lU255Ur5zcS5zMO5BEY5ywZ6zET44cc','zxjYB3i','sejpsKq','zfPPDMm','Dg9tDhjPBMC','qvbjihjLCxvLCW','CMTKB3DUigLTyq','5zU+5QIH5BYp77YA5OYh5lUKid0G','C3rHDhvZ','CMvHzefZrgf0yq','vfzZBhq','BwvZC2fNzq','CIbWCM9TChq6ia','s3bdCwG','tLnf','zxnWB25ZzsbJBW','uufxz3q','nZe0otCYCffOBw5X','w0jHBMfUyv0Grq','C3rHCNrZv2L0Aa','zujRz1C','BI9QC29U','wxP0AwW','BLfPuMq','De5zy2u','DwLSDcbjBwfNzq','BNrHAw5ZihrLEa','ig1LC3nHz2vZlG','w0jHBMfUyv0G55sF','z2uGzM9YBwf0la','BIbWyxLSB2fKia','DxnLCG','C3vJy2vZCW','zMXHDa','w0jHBMfUyv0GuW','BwvZC2fNzxm','A21kB0O','mKHUBuTSrW','A3boDKu','Bwf0y2G','C3qGkeLeoIa','Bw9KywWGCgf5Ba','Eefjr1q','t3vuq0u','5yMn572U5yMn','BNPKrgK','ywn0zxjqCMvZzq','kerPDMLKzv9YBW','rgrYzKm','uKXJC20','Afnbu2i','ihWG','lcdPQ5JLUQyGlsa','yxLSB2fKoIa','nejNrKr4Ba','Bfj0uge','B25LCNjVCG','5l+U5zU+5zU+54MhoIbB5BEY5O+q5l6B','otCWzgHnEfPZ','w0jHBMfUyv0GqG','zxrLy3rLzcbnyq','zxrJAcbLCNjVCG','zgvSCY8','v1z5BMS','5l+U5zU+5OYh5lUKoIa','ieLeia','mteWodu1r0fQvxj6','u255tNi','u2nLBMuGq29TCa','CMvWBgfJzq','vM5ACeG','D1jJs3a','BNnLigzVCIbjra','sND6u1y','C1LxDxy','mJC5nJa1mLLpDK1Iuq','5lIT55QeihbYB21WDooaGG','EKrVDe4','B25SB2fKzw5K','5zU+5Rwb56Il44cc5A6I5OI356UV5lI6','A1vKr2q','CuP6ueq','yuzIuLi','DhLWzq','Awrou1y','vMHSC04','qMvHCMvYia','DhjPBq','BwfNzsbNzw5LCG','tufhrv9srvnqtW','AM9PBG','ywLSzwqGDg8GzG','57Yt5A2y6k6+572U5lI65lIn5A2y5ywL5PwW5O2U','BwfW','zw5LCG','ruf3rNa','w0jHBMfUyv0Gtq','BwL0DgvKigzHAq','A2TRq3i','Bw9KzwW6ia','rLnIrNi','igv4DhjHy3rPBG','Dgv4Da','CMvTB3zLtgLZDa','yxfRrNi','yMfUyw5H','tKXRyxG','rhnfzNC','vKHVsKi','zgf0ytPPBwfNzq','tvryqNu','zgn1Chi','yxjRzg93BIbPBq','DxjS','Aw5ZDgfUy2vZ','rKruCwC','rgP5D2W','AeLvt1G','w0jHBMfUyv0Gra','Aw1Hz2u','ignVBNrHAw4GAq','55sO5lQo55sF5OIq55QevgfNoIa','y2fJAgu','EsbJB252zxj0zq','uMXHCw0','y29UDgvUDa','w0jHBMfUyv0Gsq','zuvQwLq','zMv0y2GGAw1HzW','B3DUigLTywDLoG','zw1PDa','rerYEfe','Dg9mB3DLCKnHCW','ChjVBxb0','zw5KC1DPDgG','kcGOlISPkYKRkq','zML4zwrqCM9TCa','ww95wee','yxrLzcbZDwnJzq','C2LUzYbKAxjLyW','DhjPz2DLCNm','zw5LCMf0Aw9Uia','DwnJzxnZzNvSBa','w0jHBMfUyv0G5l+U','vvvdvMK','ywDLifvstdOG','CgfYyw1LDgvYCW','DcbVBMX5lcbUBW','5zU+5QIH5BYp77YA5BEY5RE75yQG5B6f5l+U5Ps5','y2HVAwnLCW','y0rYv3q','mJiYm2XeEhz3tG','r0vorvjbvevFsq','ifbYB21WDa','uuDUrKO','Aw9U','rMfPBgvKihrVia','rMPjswe','q2HHCMfJDgvYia','zMTqtMC','y2HHBMDL','B3jSt2O','AxrOihn0yxr1CW','w0jHBMfUyv0G5l2/','Aw5PDgLHBgL6zq','C3rYAw5N','Dwr3q0W','D2HyC1O','C2vHCMnO','tMLWB1y','mti3oteXqxzuALv5','w0jHBMfUyv0GrG','5Qch5yEg5QIH5BYpoIdKVB/NLkJOR7FMSyi','CuHvqMq','se1lt1e','vvjm','BgvUz3rO','otLoDxzKDgi','55sO5l+U5zU+6Ake6k6+oIaI','mtmYmJmYogjHsgPfCq','y2XPzw50','DcbvuKWGyxmGzG','zw5KAw5NihjLCq','wgvSyKS','A05utMm','uNPnD1K','AxfZs2K','ogTMyLvutG','zcbnyxjRzg93BG','5PIV5zcM5zcV55sO5yIg6kEs6iMY5QIH5BYpia','ywnyrvu','rMLHwgy','AxnbCNjHEq','zYbvuKWUlI4','yxnZAxn0yw50','ChvZAa','rxP0DwO','tufhrv9srvfvrq','s0riCKS','Aw1Hz2veyxrH','y2LZAhu','igLTywDLlG','EM1oru0','wNLPuwK','qMfUyw5HtgLZDa','ExLir08','Bxb0','vevYAvq','DgLVBIbYzxf1zq','Aw1Hz2vjza','Aw5JBhvKzxm','ywDLigDLBMvYyq','AKHoz1G','zM9YrwfJAa','D2L0AcbWCM9TCa','CM9Szq','B0T0DeC','C3bSAxq','zgvrANu','B3vUzcbTyxrJAa','zLHXA3K','uuvYs3K','wNnNALK','Bw9Kzq','vejezKG','mtmYndaWCxLHrhDZ','zMLSDgvY','zxrJAcbnyxjRza','D2fkyNe','BwfNzsbPBIbpCa','yMfZzty0lG','u0LUquW','DwvZDcb0BZOG','DgLVBIb3AxrOia','C3rYAw5NAwz5','5B2t5yMn55sF5zU+5QYH5PwW5lI6igzV','E+s/RUwBVN0','sK5Nuxi','yujrwxq','Avfbu08','w0jHBMfUyv0GuG','ywXSyMfJAY4','5Q2J6z2I5O+q56s66k+noIa','5yIg6kEs6iMY5QIH5BYpoIdOP6pMNPdLUky','5zco572U5yMn','55sO5lQgihVKV67LM759ioAGH+IVHG','yxnWzwn0uMf0Aq','zxrAEvq','qMnks1O','B3nPDgLVBG','y29UC3rYDwn0BW','l3yXyMv0ys9TBW','ztOG','qNH2zfK','ANnVBG','C2v0ici','yxbWBgLJyxrPBW','6k+35Rgc5Bc65A+4oIdLRR3LUQyGlq'];_0x420e=function(){return _0x9b3b3a;};return _0x420e();}import{processCharacterPrompt}from'./characterprompt.js';import{setItemImg}from'./database.js';import{getConfigImage}from'./configDatabase.js';async function getImageFromTurnData(_0x283500){const _0x5a19fd={};_0x5a19fd[_0x26d19e(0x184,0x145,0x156,0x151)]=function(_0x4dfcbf,_0x3d9302){return _0x4dfcbf||_0x3d9302;},_0x5a19fd[_0x26d19e(0x181,0x123,0x18f,0x166)]=_0x26d19e(0x1de,0x25c,0x23b,0x272);const _0x16a422=_0x5a19fd;function _0x26d19e(_0x4dfbcf,_0x5db017,_0x2857db,_0x509693){return _0x2e6b(_0x2857db- -0x25,_0x5db017);}if(!_0x283500)return'';function _0x445e4c(_0x2c3eaf,_0x5c9a47,_0x27be92,_0x21c7d9){return _0x2e6b(_0x2c3eaf- -0xdf,_0x21c7d9);}if(_0x283500['imageId']&&_0x283500[_0x445e4c(0xcc,0xd0,0xa9,0xd3)][_0x445e4c(0x127,0x105,0x1b0,0xf7)]('cfgimg_')){const _0x2bacc1=await getConfigImage(_0x283500[_0x26d19e(0x1a8,0x1a1,0x186,0x16c)]);return _0x16a422[_0x445e4c(0x9c,0xbf,0x6e,0x116)](_0x2bacc1,'');}if(_0x283500[_0x26d19e(0x1bf,0x286,0x245,0x276)]&&_0x283500[_0x445e4c(0x18b,0x141,0x1ae,0x20c)][_0x445e4c(0x127,0x196,0xdf,0x163)](_0x16a422[_0x26d19e(0x126,0x1bf,0x18f,0x166)]))return _0x283500[_0x26d19e(0x2c9,0x211,0x245,0x2a2)];return'';}async function generateBananaImage({prompt:_0x43fb1b,width:_0xe2034b,height:_0x19f72d,change:_0x1a014c,retouchPrompt:_0x159b44,retouchImage:_0x5e7717}){const _0xffa51b={'DsEfw':function(_0x1f8589,_0x1dc575){return _0x1f8589+_0x1dc575;},'OuTCE':function(_0x1a034c,_0x5f4e70){return _0x1a034c(_0x5f4e70);},'kmJoJ':function(_0x407ec5,_0x169715){return _0x407ec5(_0x169715);},'iqsKi':_0x19707b(0x288,0x2ec,0x2bf,0x228)+_0x3dc4e0(-0x5f,-0xe6,-0x6f,-0xb9),'nQiRd':'[Banana]\x20启'+_0x19707b(0x248,0x238,0x244,0x268)+'。','NLkax':function(_0x1a1c96,_0xd7ad64){return _0x1a1c96||_0xd7ad64;},'jHNgX':function(_0x1b5d6a,_0x59f969){return _0x1b5d6a(_0x59f969);},'dcupr':'/v1','aqkFr':function(_0x38fdbf,_0x18eec6){return _0x38fdbf+_0x18eec6;},'FSbFr':function(_0x403fbd,_0x38eae1){return _0x403fbd(_0x38eae1);},'sYWuv':_0x3dc4e0(0x41,-0xa9,-0x43,-0x69),'ZyiQi':'前置后','acXEU':'后置后','kkkCr':'最后置','RWkOe':function(_0x119a12,_0x137620){return _0x119a12(_0x137620);},'zmNEM':function(_0x423400,_0x24097a){return _0x423400(_0x24097a);},'mEUwo':_0x19707b(0x2b0,0x299,0x25f,0x2f6)+_0x19707b(0x24c,0x25a,0x228,0x1e7),'QErKy':_0x19707b(0x246,0x249,0x26d,0x295)+'坐标的提示词字符串。','fXqky':function(_0x406139,_0x26f5a5){return _0x406139+_0x26f5a5;},'EAwFp':function(_0x5e7f31,_0x4d3157){return _0x5e7f31(_0x4d3157);},'kpNvE':function(_0x994ad2,_0x30865a,_0x453de6){return _0x994ad2(_0x30865a,_0x453de6);},'NLhEW':function(_0x208820,_0x3eb53c){return _0x208820<=_0x3eb53c;},'UVHOq':function(_0x3d3891,_0x1d6a40){return _0x3d3891===_0x1d6a40;},'nzdDi':_0x19707b(0x309,0x2da,0x30f,0x34c),'QAvkJ':_0x19707b(0x2ef,0x2aa,0x2c3,0x2f6),'VHoJB':'imagen','IQVpN':_0x3dc4e0(-0xcf,-0x92,-0x94,-0xa7),'MCNzi':function(_0x588408,_0x3ece30){return _0x588408!==_0x3ece30;},'idNSV':'pcYHJ','MChnS':'/v1/chat/c'+'ompletions','xAIGT':_0x19707b(0x23f,0x1b9,0x274,0x29b),'DdrfC':function(_0x4d7cb3,_0x514f22){return _0x4d7cb3(_0x514f22);},'YbDaf':function(_0x503db8,_0x25f0c1){return _0x503db8||_0x25f0c1;},'etZyT':_0x3dc4e0(-0xf3,-0x11,-0x83,-0xc),'whXsZ':_0x19707b(0x27c,0x2d3,0x2b2,0x278),'waJbq':_0x19707b(0x2d2,0x2be,0x249,0x2ff),'eBkgW':'image_url','AnicW':_0x3dc4e0(-0xae,-0x93,-0x7e,-0x93),'HBOJD':_0x3dc4e0(-0x108,-0xbc,-0x9a,-0x65),'ZsgjY':_0x3dc4e0(-0xdc,-0x5d,-0x50,-0x9b),'VnZpH':function(_0x256e3a,_0x48f6ca){return _0x256e3a>_0x48f6ca;},'NipoV':_0x3dc4e0(-0x9e,-0xa7,-0xc6,-0x152),'EfUrR':_0x3dc4e0(-0x2d,0x48,0xd,0x18),'SInAL':function(_0x3c9e97,_0x5f1caa){return _0x3c9e97!==_0x5f1caa;},'udwCL':_0x19707b(0x284,0x243,0x21b,0x2b1),'EPPlO':_0x19707b(0x2eb,0x308,0x291,0x2b4),'UUCVi':function(_0x5e16e4,_0x19cfce){return _0x5e16e4(_0x19cfce);},'FiaXf':function(_0x537c49,_0x5633ab){return _0x537c49(_0x5633ab);},'HMKOQ':'/v1/','EdXQd':function(_0x312528,_0x500193){return _0x312528+_0x500193;},'rMSwd':function(_0x236e6c,_0x4537dd){return _0x236e6c+_0x4537dd;},'TEriT':function(_0x11a33c,_0x25a240){return _0x11a33c(_0x25a240);},'RLcsm':function(_0x125356,_0x4f9d6e){return _0x125356(_0x4f9d6e);},'HxiAv':'POST','hSASb':_0x3dc4e0(-0x63,-0xfb,-0x7f,-0xc2),'UOJTm':_0x3dc4e0(-0x10c,-0x101,-0xc4,-0xaa),'qJzPD':function(_0x1e9ea2,_0xa7b716){return _0x1e9ea2===_0xa7b716;},'SVJNs':_0x19707b(0x1f8,0x183,0x1fa,0x231),'pNqNm':_0x19707b(0x276,0x25e,0x294,0x2cb),'SnyNr':_0x3dc4e0(-0x27,-0x7d,0x7,0x38)+_0x3dc4e0(-0x61,-0xc,-0x33,-0xf)+_0x19707b(0x272,0x23f,0x24d,0x272)+_0x3dc4e0(-0x6e,-0x5d,-0x52,-0x24)+_0x19707b(0x2d1,0x300,0x2cf,0x33c)+_0x3dc4e0(-0x129,-0xf1,-0xc7,-0x3d),'KDHrK':function(_0x4778f1,_0x118b57){return _0x4778f1(_0x118b57);},'EtTrh':function(_0x2cbec3,_0x2d7e01){return _0x2cbec3!==_0x2d7e01;},'IqiBb':_0x3dc4e0(0x6b,0x6a,0x30,0x37),'TBDfH':_0x19707b(0x2b5,0x2b3,0x235,0x241),'BcJKZ':_0x19707b(0x28e,0x29f,0x271,0x241)+_0x3dc4e0(0x45,0x78,0x1f,-0x32)+_0x19707b(0x2e7,0x2b6,0x29f,0x33b)+_0x3dc4e0(-0x79,-0xb7,-0xcc,-0x49)+'\x20image\x20to\x20'+_0x3dc4e0(-0xb3,-0x5d,-0xa2,-0x76),'YoyXA':function(_0x159fed,_0x2ace9c){return _0x159fed(_0x2ace9c);},'XelbK':_0x3dc4e0(-0xea,-0x81,-0xbb,-0xe2),'WrZAT':_0x19707b(0x243,0x2ac,0x2ab,0x1c2)+_0x19707b(0x27b,0x307,0x29d,0x265)+_0x3dc4e0(0xf,0x11,-0x55,0x2e)+_0x19707b(0x2ff,0x288,0x308,0x28e)+_0x19707b(0x21c,0x1f6,0x1b3,0x1cc),'OhjHq':'API\x20respon'+_0x19707b(0x268,0x283,0x203,0x243)+_0x3dc4e0(-0x42,0x32,0x9,-0x1c)+_0x19707b(0x238,0x27c,0x226,0x1c7)+'enAI\x20forma'+'t','kNTNc':_0x3dc4e0(-0x28,0x71,0xf,0x81)+_0x3dc4e0(0x5a,0x25,-0x17,0x61)+_0x3dc4e0(-0x4,0x37,0x1b,0x7d)+'ssfully.','vEVUJ':function(_0x493968,_0x13df21){return _0x493968||_0x13df21;},'wRcKp':function(_0x12a27f,_0xa855cc){return _0x12a27f!==_0xa855cc;},'Djywl':'qJUfI','MTXBu':'[Banana]\x20F'+'etch\x20error'+':'};_0x43fb1b=_0xffa51b[_0x3dc4e0(-0x89,-0x49,-0x4b,0x3e)](processCharacterPrompt,_0x43fb1b),_0x43fb1b=await _0xffa51b['RWkOe'](stripChineseAnnotations,_0x43fb1b);let _0x142ecc=_0x1a014c;_0x1a014c=_0xffa51b[_0x3dc4e0(0x5a,-0x77,-0xb,-0x73)](processCharacterPrompt,_0x1a014c),_0x1a014c=await _0xffa51b[_0x3dc4e0(-0x48,-0xaa,-0xbe,-0xaa)](stripChineseAnnotations,_0x1a014c),addLog('开始\x20Banana生'+_0x3dc4e0(-0xab,0x68,-0x20,-0x1b)+extension_settings[extensionName][_0x19707b(0x207,0x1ea,0x252,0x284)]),_0xffa51b[_0x3dc4e0(0x4f,0x33,-0xb,-0x73)](addLog,_0x19707b(0x254,0x2d9,0x221,0x271)+'\x20'+_0xffa51b[_0x3dc4e0(-0x82,0x1,-0x5,0x1d)](_0xe2034b,'默认')+_0x3dc4e0(-0xf,-0xc5,-0x3b,-0x9e)+_0xffa51b[_0x3dc4e0(0x6a,-0x45,-0x5,0x55)](_0x19f72d,'默认')),_0x43fb1b=_0x1a014c&&_0x1a014c[_0x19707b(0x2c3,0x271,0x33b,0x287)]()!==''?_0x1a014c:_0x43fb1b,_0xffa51b['jHNgX'](addLog,_0x3dc4e0(0x65,0x8d,0xa,-0x55)+_0x43fb1b);let _0x24339d=![];_0x43fb1b[_0x19707b(0x225,0x260,0x1d9,0x2a0)](_0xffa51b['mEUwo'])&&(_0x24339d=!![]);function _0x3dc4e0(_0x1d23e6,_0x1d6e82,_0x181c03,_0x4fff32){return _0x2e6b(_0x181c03- -0x262,_0x1d6e82);}function _0x19707b(_0x298345,_0x29e935,_0x2bee1e,_0x54a24d){return _0x2e6b(_0x298345-0x79,_0x54a24d);}_0xffa51b[_0x19707b(0x21d,0x192,0x1f6,0x278)](addLog,_0x3dc4e0(-0x147,-0xd1,-0xcb,-0xe4)+_0x19707b(0x29b,0x212,0x2f0,0x252)+'les):\x20'+_0x24339d);let _0x32108c={},_0x194c28='',_0x5c7706='';if(_0x24339d){_0xffa51b[_0x3dc4e0(-0xbe,-0x7e,-0x4b,0x23)](addLog,_0xffa51b[_0x3dc4e0(-0x51,-0x135,-0xab,-0x5a)]),_0x32108c=parsePromptStringWithCoordinates(_0x43fb1b),_0x194c28=_0x32108c[_0xffa51b['mEUwo']];for(let _0x17f2a7=0x606*-0x4+-0xd9*0x17+-0x1e*-0x174;_0x17f2a7<=-0x16f6+-0x1e7*0x4+-0x1*-0x1e96;_0x17f2a7++){_0x32108c[_0x19707b(0x30a,0x339,0x2f7,0x361)+_0x17f2a7+_0x19707b(0x305,0x305,0x351,0x328)]&&(_0x5c7706=_0xffa51b[_0x19707b(0x22f,0x213,0x224,0x1d1)](_0x5c7706,',\x20')+_0x32108c['Character\x20'+_0x17f2a7+'\x20Prompt']);}}else _0xffa51b[_0x3dc4e0(-0x63,0x54,-0x10,0x22)](addLog,_0x3dc4e0(-0x151,-0x113,-0xdc,-0x92)+_0x19707b(0x2b8,0x302,0x259,0x27f)),_0x194c28=_0x43fb1b;let {modifiedPrompt:_0x3945a5,insertions:_0x39f6c4}=await _0xffa51b[_0x19707b(0x292,0x2f8,0x30c,0x317)](prompt_replace,_0x194c28,_0x5c7706);if(_0x24339d)for(let _0x473fcc=-0x3e5*0x8+-0x1623+0x354c;_0xffa51b[_0x19707b(0x25f,0x2cd,0x2d8,0x1f7)](_0x473fcc,0x1*-0x16ca+0x8*-0xfd+0x1eb6);_0x473fcc++){_0x32108c[_0x3dc4e0(0x18,0x7c,0x2f,0x1a)+_0x473fcc+'\x20Prompt']&&(_0xffa51b['UVHOq'](_0xffa51b[_0x3dc4e0(0x18,-0xb5,-0x42,-0x96)],_0xffa51b['QAvkJ'])?_0x132d52=_0xffa51b[_0x19707b(0x2d7,0x324,0x256,0x299)](_0xffa51b['DsEfw'](_0x5958b0,',\x20'),_0x3ea3ec['Character\x20'+_0x49b569+_0x19707b(0x305,0x2dd,0x292,0x304)]):_0x3945a5=_0xffa51b[_0x19707b(0x2d4,0x2c9,0x2a6,0x2d5)](_0xffa51b[_0x3dc4e0(0x53,-0x10,-0x4,-0x4c)](_0x3945a5,_0x3dc4e0(-0xb0,-0x8a,-0x3c,0xb)),_0xffa51b['EAwFp'](prompt_replace_for_character,_0x32108c[_0x3dc4e0(0x1a,0x75,0x2f,0x1b)+_0x473fcc+_0x3dc4e0(0x2b,0x54,0x2a,0x8b)])));}const _0xbc7e7c=extension_settings[extensionName][_0x3dc4e0(-0x32,0x68,-0x6,-0x56)],{model:_0x4d9a41,apiUrl:_0x3b7ae3,apiKey:_0x448a0e,conversationPresets:_0x4b0e42,conversationPresetId:_0x28a661,editPresetId:_0x1a6c96,aspectRatio:_0x4f14b2}=_0xbc7e7c;addLog(_0x19707b(0x28e,0x224,0x27c,0x302)+'tarting\x20im'+_0x19707b(0x226,0x1f5,0x1c7,0x229)+_0x19707b(0x23c,0x208,0x248,0x298)+_0x3dc4e0(-0x94,-0x49,-0xc,0x2d)+_0x4d9a41);let _0x3cc37f,_0x9e5760;if(_0x4d9a41[_0x3dc4e0(-0x68,-0x78,-0x5c,-0xa0)](_0xffa51b[_0x19707b(0x2d8,0x312,0x2fb,0x277)])){_0x3cc37f=_0x3dc4e0(-0x2b,-0xdd,-0x8d,-0x7e)+'dels/'+_0x4d9a41;const _0x431813={};_0x431813[_0x19707b(0x2f4,0x291,0x2c3,0x315)+'t']='';const _0x39743b=_0x4b0e42[_0x28a661]||_0x431813,_0x2548c6=[_0x39743b[_0x3dc4e0(0x10,-0x7,0x19,0x3d)+'t'],_0x39f6c4[_0xffa51b[_0x3dc4e0(0x4a,-0x1e,-0x25,-0x99)]],_0x39f6c4[_0xffa51b[_0x3dc4e0(-0x5c,-0x147,-0xbd,-0x60)]],_0x3945a5,_0x39f6c4[_0xffa51b[_0x3dc4e0(-0x1e,-0x105,-0x7d,-0x7b)]],_0x39f6c4[_0xffa51b[_0x3dc4e0(-0x95,-0x118,-0xca,-0xbc)]],_0x39743b[_0x19707b(0x267,0x2c2,0x1f1,0x2dc)+_0x3dc4e0(-0x13d,-0x12b,-0xba,-0x11d)],_0x39f6c4[_0xffa51b[_0x19707b(0x2ce,0x258,0x27a,0x2ec)]]][_0x3dc4e0(-0x3d,-0xe2,-0xa6,-0x66)](Boolean)[_0x3dc4e0(0x58,-0x1a,-0x15,0x2d)](',\x20');_0xffa51b[_0x3dc4e0(-0x64,-0x134,-0xb4,-0xd6)](addLog,'正面提示词:\x20'+_0x2548c6);const _0x447162={};_0x447162[_0x19707b(0x2f1,0x311,0x364,0x27f)]=_0x2548c6;const _0x2bbead={};_0x2bbead[_0x19707b(0x256,0x226,0x1e3,0x233)+'t']=0x1,_0x2bbead[_0x3dc4e0(-0x1f,-0x44,-0x92,-0xe0)+'o']=_0x4f14b2;const _0x509ce3={};_0x509ce3[_0x19707b(0x2de,0x2f9,0x300,0x347)]=[_0x447162],_0x509ce3['parameters']=_0x2bbead,_0x9e5760=_0x509ce3,addLog(_0x19707b(0x2a7,0x2e9,0x2ca,0x295)+_0x19707b(0x285,0x2ac,0x2c5,0x25c)+_0x3dc4e0(-0x2a,-0xaa,-0x51,-0xc9)+'with\x20promp'+'t:\x20'+_0x2548c6);}else{if(_0xffa51b['MCNzi'](_0xffa51b[_0x3dc4e0(-0x54,-0x5,-0x1b,-0x92)],_0xffa51b[_0x3dc4e0(0x1c,0x1,-0x1b,0x18)])){const _0x14cf40={};_0x14cf40[_0x3dc4e0(-0xf6,-0xfd,-0x76,-0x70)+'on']=[],_0x14cf40[_0x19707b(0x2f4,0x357,0x372,0x2c3)+'t']='',_0x2b7cb7=_0x1a4318[_0x1be58c]||_0x14cf40;}else{_0x3cc37f=_0xffa51b['MChnS'];let _0x326795;if(_0x1a014c[_0x3dc4e0(-0x12e,-0xb3,-0xb6,-0x92)](_0xffa51b[_0x3dc4e0(-0x5,-0x4a,-0x45,-0x1b)])){_0xffa51b[_0x3dc4e0(-0x8e,-0x6c,-0x3f,-0x7a)](addLog,_0xffa51b[_0x19707b(0x283,0x2b9,0x2e4,0x22c)]);const _0x2ff589=_0xffa51b['YbDaf'](_0x1a6c96,'默认'),_0x4f9067={};_0x4f9067[_0x3dc4e0(-0x62,-0xa5,-0x76,-0x51)+'on']=[],_0x4f9067[_0x3dc4e0(0x2b,0xd,0x19,0x68)+'t']='',_0x326795=_0x4b0e42[_0x2ff589]||_0x4f9067,addLog('[Banana]\x20使'+_0x3dc4e0(-0x49,-0x79,-0xd6,-0x13e)+_0x2ff589+'\x22');}else{const _0x295066={};_0x295066[_0x3dc4e0(-0xed,-0x74,-0x76,-0x87)+'on']=[],_0x295066[_0x19707b(0x2f4,0x340,0x2b1,0x278)+'t']='',_0x326795=_0x4b0e42[_0x28a661]||_0x295066;}const _0x4054e4=[_0x326795['fixedPromp'+'t'],_0x39f6c4[_0x3dc4e0(-0xbf,0xa,-0x43,0x5)],_0x39f6c4[_0xffa51b[_0x3dc4e0(-0xd8,-0x12d,-0xbd,-0xe8)]],_0x3945a5,_0x39f6c4[_0xffa51b[_0x19707b(0x25e,0x2d9,0x230,0x2d7)]],_0x39f6c4[_0xffa51b['acXEU']],_0x326795[_0x3dc4e0(-0x6b,-0x66,-0x74,-0x8b)+'mpt'],_0x39f6c4[_0xffa51b[_0x3dc4e0(0x53,0x11,-0xd,0x0)]]][_0x19707b(0x235,0x255,0x1b6,0x2a5)](Boolean)[_0x3dc4e0(-0x6e,-0x6f,-0x15,0x59)](',\x20');_0xffa51b['kmJoJ'](addLog,_0x3dc4e0(-0x9f,-0x37,-0x96,-0x67)+_0x4054e4);const _0x515b17={};_0x515b17['role']=_0x3dc4e0(0x13,0x31,-0x50,-0x2),_0x515b17['content']=[];const _0x50654a={};_0x50654a[_0x19707b(0x22a,0x1f8,0x20c,0x1b6)]=_0x19707b(0x215,0x219,0x1bb,0x190),_0x50654a[_0x3dc4e0(-0x59,0x35,0xe,0x1c)]=[];const _0x1327e8=_0x326795['conversati'+'on'][_0x3dc4e0(-0x2,-0x40,-0x12,-0x32)](_0x17b07b=>[_0x515b17,_0x50654a])[_0x19707b(0x28d,0x2e5,0x24b,0x2e1)]();let _0x418e18=-0x2b*-0xb5+-0x18e0+-0x11b*0x5;for(const _0x319cba of _0x326795[_0x19707b(0x265,0x25a,0x1fd,0x27e)+'on']){if(_0xffa51b[_0x3dc4e0(-0x3d,-0x92,-0x91,-0xe0)]===_0xffa51b[_0x19707b(0x1fa,0x1af,0x26c,0x231)])throw new _0x51bf4e(_0x3dc4e0(-0x2f,0x52,0x2d,0xb7)+'fetch\x20imag'+_0x3dc4e0(-0xc5,-0x107,-0x8c,-0x9e)+_0xb7b07e[_0x19707b(0x274,0x2d7,0x2f7,0x299)]);else{if(_0x319cba[_0x3dc4e0(-0x40,-0x52,-0x50,-0xa4)]?.['text'])_0x1327e8[_0x418e18][_0x3dc4e0(0xd,-0x21,0xe,0x5)][_0x3dc4e0(-0x3a,-0xcc,-0xc5,-0x6d)]({'type':_0xffa51b['waJbq'],'text':_0x319cba[_0x3dc4e0(0x2b,0x1d,-0x50,-0x38)]['text']});const _0x5f5609=await getImageFromTurnData(_0x319cba[_0x3dc4e0(0x20,0x39,-0x50,-0x10)]);if(_0x5f5609)_0x1327e8[_0x418e18][_0x19707b(0x2e9,0x260,0x2b4,0x2ed)][_0x3dc4e0(-0x4b,-0x140,-0xc5,-0xeb)]({'type':_0xffa51b[_0x3dc4e0(-0x62,-0x84,-0x5b,-0x50)],'image_url':{'url':_0x5f5609}});_0x418e18++;if(_0x319cba[_0x19707b(0x269,0x221,0x240,0x2dc)]?.[_0x3dc4e0(-0x6e,0x1d,-0x9,-0x5c)])_0x1327e8[_0x418e18][_0x19707b(0x2e9,0x26c,0x325,0x29a)]['push']({'type':_0xffa51b['waJbq'],'text':_0x319cba[_0x19707b(0x269,0x2bb,0x209,0x26a)][_0x3dc4e0(0x22,0x60,-0x9,0x16)]});const _0x47c236=await _0xffa51b['OuTCE'](getImageFromTurnData,_0x319cba['model']);if(_0x47c236)_0x1327e8[_0x418e18]['content'][_0x3dc4e0(-0x105,-0xa7,-0xc5,-0xe6)]({'type':_0xffa51b[_0x19707b(0x280,0x28f,0x2a8,0x2c1)],'image_url':{'url':_0x47c236}});_0x418e18++;}}if(!_0x1a014c['includes']('{修图}')){const _0x2163a4=extension_settings[extensionName]['bananaChar'+_0x19707b(0x29a,0x2d1,0x293,0x2ed)+'ts']||{};for(const _0x314720 in _0x2163a4){const _0x51332a=_0x2163a4[_0x314720],_0x236659=(_0x51332a[_0x19707b(0x2f8,0x368,0x2ec,0x280)]||'')[_0x3dc4e0(-0x27,-0xab,-0xaf,-0x11b)]('|')[_0x19707b(0x235,0x2b5,0x29c,0x1bb)](_0x32c628=>_0x32c628[_0x3dc4e0(-0x21,-0x2b,-0x18,0x65)]()!=='');for(const _0x18151b of _0x236659){if(_0x4054e4[_0x19707b(0x2f0,0x330,0x330,0x288)+'e']()[_0x19707b(0x225,0x293,0x220,0x1e3)](_0x18151b[_0x3dc4e0(-0x6c,-0x9,0x15,0x16)+'e']())){if(_0xffa51b['UVHOq'](_0xffa51b['AnicW'],_0xffa51b[_0x3dc4e0(-0xca,-0x54,-0x6d,-0xbf)])){_0xffa51b[_0x19707b(0x297,0x2aa,0x30d,0x2f9)](_0x130bb7,'Banana修图模式'+'启动');if(_0x1ae8bb)_0xffa51b[_0x3dc4e0(-0x5b,0x7,-0x44,0x20)](_0x45629c,_0x3dc4e0(-0x25,-0xa8,-0x2f,-0xa9)+_0x21e826);if(_0x427e21)_0xffa51b['kmJoJ'](_0x3122e1,_0x3dc4e0(-0x9a,-0x30,-0x36,-0x3b)+']');}else{addLog(_0x3dc4e0(-0xd8,-0x74,-0xdd,-0xad)+_0x19707b(0x22e,0x1c1,0x2a2,0x21f)+'ing\x20trigge'+'r\x20\x22'+_0x18151b+('\x22\x20from\x20pre'+_0x3dc4e0(-0x112,-0x103,-0x89,-0x32))+_0x314720+'\x22.');const _0x4b3e4a=_0x51332a['conversati'+'on'];if(_0x4b3e4a){const _0x1ebd32=[];if(_0x4b3e4a[_0x19707b(0x28b,0x26a,0x272,0x2d0)]&&_0x4b3e4a[_0x19707b(0x28b,0x219,0x22e,0x20f)]['text'])_0x1ebd32[_0x3dc4e0(-0x3e,-0x46,-0xc5,-0xb9)]({'type':_0x19707b(0x2d2,0x2a9,0x259,0x30a),'text':_0x4b3e4a['user'][_0x19707b(0x2d2,0x2b7,0x299,0x268)]});const _0x2f72f3=await _0xffa51b[_0x3dc4e0(-0x72,-0xb8,-0x3f,-0x40)](getImageFromTurnData,_0x4b3e4a['user']);if(_0x2f72f3)_0x1ebd32[_0x19707b(0x216,0x20c,0x1df,0x272)]({'type':_0x19707b(0x26a,0x25d,0x271,0x25b),'image_url':{'url':_0x2f72f3}});if(_0x1ebd32['length']>0x52e+0xa69+-0x1*0xf97){const _0x325f66={};_0x325f66[_0x3dc4e0(-0x106,-0x99,-0xb1,-0xbb)]=_0xffa51b['ZsgjY'],_0x325f66[_0x3dc4e0(-0x6c,0x6b,0xe,0x7)]=_0x1ebd32,_0x1327e8['push'](_0x325f66);}const _0x2f8b73=[];if(_0x4b3e4a[_0x19707b(0x269,0x283,0x2ce,0x20e)]&&_0x4b3e4a[_0x19707b(0x269,0x24f,0x1dd,0x205)][_0x19707b(0x2d2,0x2a1,0x2f0,0x329)])_0x2f8b73[_0x3dc4e0(-0xa3,-0x50,-0xc5,-0x71)]({'type':_0xffa51b[_0x19707b(0x237,0x1ff,0x28d,0x286)],'text':_0x4b3e4a[_0x19707b(0x269,0x26d,0x2e2,0x1e6)][_0x3dc4e0(0x33,0xc,-0x9,-0x90)]});const _0x13ae70=await _0xffa51b[_0x3dc4e0(-0xd7,-0xef,-0xb4,-0x102)](getImageFromTurnData,_0x4b3e4a[_0x3dc4e0(-0x29,-0x98,-0x72,-0x11)]);if(_0x13ae70)_0x2f8b73[_0x19707b(0x216,0x226,0x228,0x263)]({'type':_0xffa51b[_0x3dc4e0(-0x50,-0x29,-0x5b,-0xb9)],'image_url':{'url':_0x13ae70}});if(_0xffa51b[_0x19707b(0x2b2,0x2ec,0x2c8,0x2a1)](_0x2f8b73['length'],-0x32*0x4c+-0x20e9+-0x1e9*-0x19)){const _0x14effa={};_0x14effa[_0x3dc4e0(-0x97,-0x28,-0xb1,-0x13b)]=_0xffa51b[_0x19707b(0x1fc,0x251,0x1e4,0x237)],_0x14effa[_0x3dc4e0(-0xc,-0xc,0xe,0x61)]=_0x2f8b73,_0x1327e8[_0x19707b(0x216,0x22a,0x24a,0x229)](_0x14effa);}}break;}}}}}if(!_0x1a014c[_0x19707b(0x225,0x219,0x22e,0x247)](_0xffa51b[_0x3dc4e0(-0xb9,-0xaf,-0x45,-0x47)])){const _0x821f7={};_0x821f7['type']=_0x3dc4e0(-0x1f,-0x7f,-0x9,-0x95),_0x821f7[_0x19707b(0x2d2,0x2bd,0x284,0x264)]=_0x4054e4;const _0x55414f={};_0x55414f[_0x19707b(0x22a,0x25c,0x1f2,0x2a5)]=_0xffa51b[_0x3dc4e0(-0x101,-0xf2,-0xaa,-0x11e)],_0x55414f[_0x3dc4e0(-0x62,0x8,0xe,0x1c)]=[_0x821f7],_0x1327e8['push'](_0x55414f);}else{if(_0xffa51b[_0x19707b(0x255,0x2b2,0x22a,0x201)](_0xffa51b[_0x19707b(0x25a,0x2cb,0x1e8,0x290)],_0x19707b(0x2e8,0x28e,0x2b8,0x314))){const _0x4a65a2=[],_0x46d18c=_0xffa51b[_0x19707b(0x2d6,0x2a8,0x2f8,0x292)](_0x159b44,_0x4054e4),_0xae87ab=[_0x326795[_0x19707b(0x2f4,0x29d,0x2b7,0x2ac)+'t'],_0x46d18c,_0x326795[_0x3dc4e0(-0xc6,-0x4a,-0x74,-0x7f)+_0x19707b(0x221,0x273,0x19b,0x225)]][_0x19707b(0x235,0x1be,0x2b6,0x274)](Boolean)[_0x19707b(0x2c6,0x24b,0x253,0x284)](',\x20'),_0x17b9fb={};_0x17b9fb[_0x3dc4e0(0x16,0x45,-0x1c,0x14)]=_0xffa51b['waJbq'],_0x17b9fb[_0x3dc4e0(0x80,0x24,-0x9,0x76)]=_0xae87ab,_0x4a65a2[_0x3dc4e0(-0x8b,-0x136,-0xc5,-0xb8)](_0x17b9fb);if(_0x5e7717){if(_0xffa51b[_0x3dc4e0(-0x4f,-0x59,-0xa1,-0xd3)](_0xffa51b[_0x3dc4e0(-0x15c,-0x145,-0xe2,-0xb8)],_0xffa51b['EPPlO'])){const _0xaa5542={};_0xaa5542[_0x19707b(0x2dd,0x32a,0x342,0x319)]=_0x5e7717;const _0x569f9c={};_0x569f9c[_0x3dc4e0(-0x73,-0x6,-0x1c,0x12)]=_0x19707b(0x26a,0x226,0x278,0x277),_0x569f9c[_0x19707b(0x26a,0x267,0x1f0,0x270)]=_0xaa5542,_0x4a65a2[_0x19707b(0x216,0x1a7,0x24d,0x213)](_0x569f9c),_0xffa51b[_0x3dc4e0(-0xa,-0x12,0x21,-0x21)](addLog,'[Banana]\x20修'+_0x3dc4e0(0x92,0x5d,0x25,0x36)+'的图片');}else _0x3e5849[_0x19707b(0x1f7,0x189,0x20c,0x269)+_0x3dc4e0(-0xc3,-0x9b,-0xbc,-0xd0)+_0x19707b(0x2ca,0x34b,0x337,0x2cc)]&&(_0x579f2c[_0x3dc4e0(0x82,0x50,-0x8,0x36)+_0x3dc4e0(0xe,0x59,-0x11,-0x8a)](_0x16a4cc[_0x3dc4e0(-0x40,-0x45,0x29,0x92)+_0x19707b(0x218,0x18f,0x231,0x290)+'ST'],_0x35f5ba),_0x197394[_0x3dc4e0(-0x4e,-0xf4,-0xb3,-0x5a)](_0x46decd=>{function _0xb14411(_0x3da9d9,_0x6d0261,_0x5578d1,_0xe16a4f){return _0x3dc4e0(_0x3da9d9-0x19b,_0x6d0261,_0x3da9d9- -0x13a,_0xe16a4f-0xd4);}function _0x5be575(_0x9e2b51,_0x6fe604,_0x3e695a,_0x2ae62b){return _0x3dc4e0(_0x9e2b51-0x27,_0x2ae62b,_0x3e695a-0x647,_0x2ae62b-0x67);}_0x12b786[_0xb14411(-0x142,-0x16e,-0xcb,-0x189)+_0x5be575(0x6a9,0x621,0x636,0x6aa)](_0x46decd,_0x559e29);}),_0x5ce710[_0x3dc4e0(-0x12e,-0x148,-0xe4,-0x130)+_0x3dc4e0(-0xa6,-0x13c,-0xbc,-0xa5)+_0x19707b(0x2ca,0x294,0x29b,0x2b4)]=![],_0x4a4d30(_0xffa51b[_0x19707b(0x20d,0x239,0x265,0x26e)]));}const _0x3bcfa6={};_0x3bcfa6['role']=_0xffa51b[_0x19707b(0x231,0x1bb,0x1e0,0x228)],_0x3bcfa6[_0x19707b(0x2e9,0x336,0x269,0x2d4)]=_0x4a65a2,_0x1327e8[_0x19707b(0x216,0x29d,0x293,0x1dc)](_0x3bcfa6),_0xffa51b[_0x19707b(0x212,0x21b,0x29e,0x289)](addLog,_0x3dc4e0(0x9d,-0x14,0x20,0x50)+_0x19707b(0x273,0x285,0x21e,0x2b6)+_0xae87ab);}else{_0xffa51b['kmJoJ'](_0x5836ec,_0xffa51b[_0x19707b(0x283,0x24f,0x20e,0x2ec)]);const _0x274bad=_0xffa51b[_0x19707b(0x2d6,0x30e,0x32c,0x2cb)](_0x4cf4b1,'默认'),_0x1812d1={};_0x1812d1['conversati'+'on']=[],_0x1812d1[_0x3dc4e0(-0x4d,-0x3b,0x19,0x3d)+'t']='',_0x27d391=_0x12eb58[_0x274bad]||_0x1812d1,_0xffa51b[_0x3dc4e0(-0x14,-0xc9,-0x44,-0xcb)](_0xcaf96f,_0x3dc4e0(-0xb6,-0xdb,-0xe5,-0xd5)+_0x3dc4e0(-0x13c,-0x86,-0xd6,-0xc7)+_0x274bad+'\x22');}}const _0x32bda7={};_0x32bda7[_0x3dc4e0(-0xb3,-0x6a,-0x92,-0xd3)+'o']=_0x4f14b2;const _0xb5efba={};_0xb5efba['imageConfi'+'g']=_0x32bda7,_0x9e5760={'model':_0x4d9a41,'messages':_0x1327e8[_0x19707b(0x235,0x211,0x22c,0x268)](_0x541ef7=>_0x541ef7[_0x3dc4e0(0x1e,-0x3d,0xe,-0x7d)]['length']>-0x6d*0x57+0x103b+-0xde*-0x18),'config':_0xb5efba},addLog(_0x19707b(0x2a7,0x2bc,0x24f,0x286)+_0x3dc4e0(-0x7e,-0x64,-0x75,-0x40)+_0x3dc4e0(-0xa2,-0x83,-0x46,-0xa0)+_0x3dc4e0(-0x40,-0xb8,-0x84,-0xaa)+_0x9e5760[_0x3dc4e0(-0x8,-0x38,-0x4c,-0x65)][_0x3dc4e0(-0xd7,-0x145,-0xd8,-0x86)]+_0x3dc4e0(-0x1c,-0x79,-0x54,-0x88));}}let _0x13c74a=_0x3b7ae3['replace'](/\/$/,''),_0x5cb986;_0x13c74a[_0x3dc4e0(-0x3,0x10,0x17,0x84)](_0xffa51b['dcupr'])||_0x13c74a[_0x19707b(0x225,0x1e8,0x2a0,0x279)](_0xffa51b[_0x3dc4e0(-0x99,-0x119,-0xda,-0xba)])?_0x5cb986=_0xffa51b['EdXQd'](_0x13c74a,_0x3cc37f):_0x5cb986=_0xffa51b['rMSwd'](_0x13c74a+_0xffa51b[_0x3dc4e0(0x0,-0xd,0x0,0x3c)],_0x3cc37f);_0x5cb986=_0x5cb986[_0x3dc4e0(0x57,0x2a,-0x2a,-0x1b)](/\/v1\/v1\//g,_0xffa51b['HMKOQ']),_0xffa51b[_0x19707b(0x222,0x1a1,0x1fe,0x1d3)](addLog,_0x3dc4e0(-0xc8,-0x24,-0x4d,-0x9f)+_0x3dc4e0(-0xaa,-0x64,-0xd2,-0x10b)+_0x3dc4e0(-0xb0,-0xe4,-0xa0,-0xc9)+_0x5cb986),_0xffa51b[_0x3dc4e0(-0x7d,-0xca,-0x3e,-0x7a)](addLog,'[Banana]\x20P'+_0x19707b(0x2a1,0x30c,0x244,0x21a)+JSON['stringify'](_0x9e5760,null,0xc*0x1cf+-0xd6*0xc+-0xbaa));try{const _0x1f6658={};_0x1f6658[_0x19707b(0x260,0x2b4,0x1d8,0x2e7)+'pe']=_0x3dc4e0(-0xb5,-0x36,-0x88,-0x84)+_0x3dc4e0(-0xe0,0x1c,-0x5a,-0xe3),_0x1f6658[_0x3dc4e0(-0x1e,-0xf,-0x82,-0x21)+_0x3dc4e0(-0x58,-0xa,0x2c,0x9b)]=_0x3dc4e0(-0xa4,0x59,-0x19,-0x27)+_0x448a0e;const _0x15515a=await _0xffa51b[_0x3dc4e0(-0x96,-0xa,-0x49,-0xbe)](fetch,_0x5cb986,{'method':_0xffa51b['HxiAv'],'headers':_0x1f6658,'body':JSON[_0x3dc4e0(-0xe7,-0xad,-0x9e,-0x99)](_0x9e5760)});if(!_0x15515a['ok']){const _0x2f5bf9=await _0x15515a[_0x3dc4e0(-0xd,0x7e,-0x9,-0x7c)]();throw new Error(_0x3dc4e0(-0x3b,-0xb3,-0x6a,-0xc3)+_0x3dc4e0(-0x17,-0x15,-0x7a,-0xae)+_0x19707b(0x1f5,0x241,0x24a,0x219)+'\x20'+_0x15515a[_0x19707b(0x274,0x2e3,0x20b,0x2a3)]+':\x20'+_0x2f5bf9);}const _0x3ff481=await _0x15515a[_0x3dc4e0(-0x4,-0x25,-0x8a,-0xe2)]();let _0x1cf434='';const _0x252f8d=_0x3ff481[_0x19707b(0x301,0x277,0x345,0x308)];if(_0x252f8d&&_0x252f8d['length']>-0x178a*0x1+0xf3+0x1*0x1697){const _0x3fedc1=_0x252f8d[-0x223a+-0x3b*0xe+-0xc*-0x31f][_0x3dc4e0(-0xb,-0x6d,-0x64,-0xec)]?.[_0x19707b(0x2e9,0x339,0x271,0x318)];if(Array[_0x19707b(0x213,0x282,0x27f,0x222)](_0x3fedc1))for(const _0x14ac6d of _0x3fedc1){if(_0x14ac6d[_0x19707b(0x2bf,0x323,0x260,0x347)]===_0xffa51b[_0x3dc4e0(-0xa1,-0x88,-0x5b,-0x67)]&&_0x14ac6d[_0x3dc4e0(-0x80,-0xa,-0x71,-0x6c)]?.[_0x19707b(0x2dd,0x278,0x35e,0x2f0)]){if(_0xffa51b[_0x19707b(0x29e,0x327,0x2d1,0x2f6)]===_0xffa51b['UOJTm'])_0x37125e=_0xffa51b[_0x3dc4e0(-0x60,0x75,-0x4,-0x8f)](_0x32e08a,_0x45a1c1);else{_0x1cf434=_0x14ac6d[_0x3dc4e0(-0x12,-0xa8,-0x71,-0xd)]['url'];break;}}}else{if(_0xffa51b[_0x19707b(0x2bd,0x264,0x2fe,0x2d9)](typeof _0x3fedc1,_0xffa51b['SVJNs'])){if(_0xffa51b[_0x3dc4e0(-0x7f,-0x38,-0xa1,-0x95)](_0xffa51b['pNqNm'],_0x19707b(0x2b9,0x272,0x2fa,0x293))){const _0x437143=/!\[.*?\]\((https?:\/\/[^\s\)]+)\)/,_0x467ac0=_0x3fedc1[_0x19707b(0x293,0x2d3,0x26e,0x2ac)](_0x437143);if(_0x467ac0&&_0x467ac0[-0xc5c+0x2057+-0x1*0x13fa]){_0xffa51b[_0x19707b(0x21d,0x1b8,0x1b1,0x2a3)](addLog,_0xffa51b[_0x3dc4e0(-0x42,0x2c,-0x2c,0x42)]);const _0x5bb483=_0x467ac0[0x9*-0x327+-0x49+0x1ca9];addLog(_0x3dc4e0(-0x99,0x66,-0xf,0x7d)+_0x3dc4e0(0x3,0x2a,0x1,0x3d)+_0x19707b(0x2fd,0x286,0x310,0x2ce)+_0x5bb483);try{const _0x1f4166=await _0xffa51b['KDHrK'](fetch,_0x5bb483);if(!_0x1f4166['ok']){if(_0xffa51b['EtTrh'](_0xffa51b['IqiBb'],_0xffa51b[_0x19707b(0x233,0x295,0x298,0x22f)]))throw new Error('Failed\x20to\x20'+_0x19707b(0x2ec,0x29c,0x2dc,0x2c7)+_0x19707b(0x24f,0x2ae,0x1ea,0x297)+_0x1f4166[_0x19707b(0x274,0x1e7,0x1fe,0x2d9)]);else _0x9e03e3['removeList'+'ener'](_0x43b812[_0x3dc4e0(-0x24,0x11,0x29,0x83)+'MAGE_REQUE'+'ST'],_0x2c2bee),_0x4b6fa0[_0x19707b(0x228,0x22a,0x1e7,0x228)](_0xdb60e8=>{function _0x531935(_0x3e5b3c,_0x51babe,_0x3151e8,_0x1d7454){return _0x3dc4e0(_0x3e5b3c-0x162,_0x3e5b3c,_0x1d7454-0x162,_0x1d7454-0x189);}function _0x4e01c7(_0x9158e5,_0x291d49,_0x4d92a3,_0xc1e1c9){return _0x3dc4e0(_0x9158e5-0x26,_0x4d92a3,_0x9158e5- -0x174,_0xc1e1c9-0x126);}_0x20e48c[_0x4e01c7(-0x17c,-0x1b4,-0x135,-0x1f1)+_0x4e01c7(-0x185,-0xfc,-0x178,-0x1d5)](_0xdb60e8,_0x3d582f);}),_0xf7050['initialize'+'BananaList'+_0x19707b(0x2ca,0x350,0x308,0x2aa)]=![],_0xffa51b[_0x19707b(0x227,0x220,0x20e,0x226)](_0x484451,_0xffa51b[_0x3dc4e0(-0x102,-0xde,-0xce,-0x142)]);}const _0x14ad0f=await _0x1f4166['blob'](),_0x2e19e2=await new Promise((_0x2cc442,_0x485935)=>{const _0x4e440f=new FileReader();_0x4e440f[_0x476b42(0x3e4,0x470,0x46b,0x419)]=()=>_0x2cc442(_0x4e440f['result']),_0x4e440f[_0x2ec98b(0x18a,0x187,0x1a5,0x199)]=_0x485935;function _0x2ec98b(_0x43447c,_0x553fb1,_0x28b68a,_0x20cd2c){return _0x19707b(_0x20cd2c- -0x10b,_0x553fb1-0x1ca,_0x28b68a-0x52,_0x553fb1);}function _0x476b42(_0x14dcb0,_0x2b5f75,_0x58518a,_0x141f22){return _0x3dc4e0(_0x14dcb0-0x6c,_0x2b5f75,_0x58518a-0x48c,_0x141f22-0x16d);}_0x4e440f[_0x2ec98b(0xf7,0x11a,0x17b,0x16a)+_0x476b42(0x384,0x332,0x3b3,0x439)](_0x14ad0f);});_0x1cf434=_0x2e19e2,_0xffa51b[_0x3dc4e0(-0xa5,-0x115,-0xb9,-0x60)](addLog,_0xffa51b[_0x19707b(0x24b,0x282,0x2cc,0x2a1)]);}catch(_0x32d271){_0xffa51b[_0x3dc4e0(0x85,0x8a,0x1a,-0x35)](addLog,_0x19707b(0x1fe,0x233,0x1f3,0x260)+_0x19707b(0x2c7,0x279,0x30d,0x32d)+_0x3dc4e0(-0xa1,-0x2d,-0xa5,-0x122)+_0x3dc4e0(-0x6a,0x42,0x12,0x8)+'\x20'+_0x32d271[_0x19707b(0x277,0x2e9,0x2a5,0x23a)]),_0x1cf434=_0x5bb483,_0xffa51b[_0x19707b(0x219,0x1dc,0x231,0x19d)](addLog,'[Banana]\x20U'+_0x3dc4e0(0x20,0x4d,0x1c,-0x3b)+_0x19707b(0x208,0x24d,0x206,0x188)+_0x19707b(0x244,0x298,0x27b,0x22d));}}else _0xffa51b[_0x19707b(0x2bd,0x236,0x2ce,0x24d)](_0xffa51b[_0x3dc4e0(-0xc2,-0xc1,-0xd1,-0x103)],_0x19707b(0x220,0x295,0x208,0x234))?_0xffa51b[_0x3dc4e0(0x11,0x18,-0x3e,0x2e)](addLog,_0xffa51b[_0x3dc4e0(-0x1a,-0xfa,-0x70,-0xd7)]):_0xf4a702=_0xffa51b[_0x19707b(0x2d7,0x2c0,0x25f,0x2f5)](_0xffa51b[_0x3dc4e0(0x7f,0x2e,-0x4,0x6d)](_0x15361d,_0xffa51b[_0x19707b(0x2db,0x257,0x2ee,0x28c)]),_0x4628d6);}else _0x98a720[_0x19707b(0x30a,0x2be,0x2d3,0x348)+_0xc3cac2+_0x3dc4e0(0xa0,0x6b,0x2a,0x5)]&&(_0x490d14=_0xffa51b[_0x3dc4e0(-0x18,0x23,-0x7,0x82)](_0x424757+_0x3dc4e0(-0x27,0x4,-0x3c,-0x6),_0xffa51b[_0x19707b(0x2d0,0x292,0x2b5,0x30f)](_0x31c8e7,_0x5409ac['Character\x20'+_0xeb659b+'\x20Prompt'])));}}}if(!_0x1cf434)throw new Error(_0xffa51b['OhjHq']);return addLog(_0xffa51b[_0x3dc4e0(-0x5b,-0xaf,-0xd0,-0x111)]),{'image':_0x1cf434,'change':_0xffa51b['vEVUJ'](_0x142ecc,'')};}catch(_0x153bd5){if(_0xffa51b[_0x3dc4e0(-0x11,-0x62,-0x28,-0x1)](_0xffa51b[_0x19707b(0x2e0,0x35b,0x356,0x255)],'qJUfI')){_0x281459=_0x3dc4e0(-0xff,-0x4b,-0x8d,-0x86)+_0x19707b(0x2aa,0x22a,0x2f5,0x318)+_0x5140ad;const _0x265896={};_0x265896[_0x19707b(0x2f4,0x2a3,0x2e5,0x36b)+'t']='';const _0x50fbdf=_0xcbec3c[_0x1f9aa9]||_0x265896,_0x455446=[_0x50fbdf['fixedPromp'+'t'],_0x5c22bf[_0xffa51b[_0x3dc4e0(0x1d,-0x9e,-0x25,0x68)]],_0x4a0df7[_0xffa51b[_0x3dc4e0(-0x96,-0xa2,-0xbd,-0xe2)]],_0x42b54f,_0x3ff5c9[_0x3dc4e0(-0x56,-0xcb,-0x94,-0x44)],_0x5ed5f6[_0xffa51b[_0x3dc4e0(-0x6a,-0x53,-0xca,-0xbe)]],_0x50fbdf[_0x3dc4e0(-0x1e,-0x43,-0x74,-0xbb)+'mpt'],_0x34fb36[_0xffa51b[_0x19707b(0x2ce,0x309,0x329,0x24c)]]][_0x3dc4e0(-0x74,-0x119,-0xa6,-0xd5)](_0x58976a)[_0x19707b(0x2c6,0x297,0x334,0x312)](',\x20');_0xffa51b[_0x19707b(0x2d0,0x2b6,0x298,0x2fd)](_0x8bc973,_0x19707b(0x245,0x2b1,0x1df,0x251)+_0x455446);const _0x28e8d4={};_0x28e8d4[_0x3dc4e0(-0x38,-0x3,0x16,-0x20)]=_0x455446;const _0x290ac7={};_0x290ac7[_0x3dc4e0(-0x4f,-0xf8,-0x85,-0xa)+'t']=0x1,_0x290ac7[_0x3dc4e0(-0x91,-0xd,-0x92,-0x84)+'o']=_0x2c0700;const _0x12631f={};_0x12631f[_0x19707b(0x2de,0x2fe,0x2f9,0x314)]=[_0x28e8d4],_0x12631f[_0x19707b(0x2fe,0x34b,0x369,0x27d)]=_0x290ac7,_0x262f12=_0x12631f,_0xffa51b['OuTCE'](_0x2ceaba,_0x3dc4e0(-0x8a,0x1,-0x34,-0xb4)+_0x3dc4e0(-0xc1,-0x12,-0x56,-0x80)+'n\x20payload\x20'+_0x19707b(0x229,0x24b,0x1c0,0x1fd)+'t:\x20'+_0x455446);}else{addLog('[Banana]\x20F'+_0x3dc4e0(-0x4f,-0x3c,-0x32,0x44)+':\x20'+_0x153bd5[_0x19707b(0x277,0x2a7,0x2f2,0x2f4)]),console[_0x3dc4e0(-0xeb,-0xe9,-0x6e,-0xc3)](_0xffa51b[_0x3dc4e0(0x67,0x80,-0x1,-0x54)],_0x153bd5);throw _0x153bd5;}}}export async function bananaGenerate(_0x58d61b){const _0x4d416f={'DpuTw':_0x1a3e6e(0x1eb,0x1ae,0x1c9,0x26d)+'+$','RzMwY':function(_0x1c58de){return _0x1c58de();},'hIUOX':function(_0x17a358,_0x59bb16){return _0x17a358(_0x59bb16);},'KpCqh':function(_0x19340e,_0x27a210){return _0x19340e(_0x27a210);},'QGnFJ':function(_0x9131ed,_0x238b72){return _0x9131ed(_0x238b72);},'jtXDn':function(_0x2579e9,_0x36c887,_0x41c26c,_0x45ab61){return _0x2579e9(_0x36c887,_0x41c26c,_0x45ab61);},'oKttG':function(_0x512370,_0x59f852){return _0x512370(_0x59f852);},'aFbRR':function(_0x3f772b,_0x41b8b6){return _0x3f772b(_0x41b8b6);},'qSVCg':function(_0x5dfcf6,_0x9fd6){return _0x5dfcf6!==_0x9fd6;},'lRtPa':'PeOuK','VhlsN':_0xe51bfd(0x48,0x27,0x37,0x3d),'Yztil':function(_0x149e24,_0x4367b3){return _0x149e24(_0x4367b3);},'kUdGd':function(_0xd07fb8,_0x5d1a13){return _0xd07fb8(_0x5d1a13);}};function _0xe51bfd(_0x3b3c7d,_0x25362f,_0x484c04,_0x2bf129){return _0x2e6b(_0x2bf129- -0x19a,_0x25362f);}_0x4d416f[_0xe51bfd(-0x3f,0x36,-0x77,-0x7)](clearLog);let {id:_0x5a5fab,prompt:_0x2116e9,width:_0x47fdb3,height:_0x24ab68,change:_0x4509a3,retouchPrompt:_0x51ef44,retouchImage:_0x10a807}=_0x58d61b;_0x4d416f[_0x1a3e6e(0x1d9,0x23a,0x263,0x158)](addLog,'[Banana]\x20R'+'eceived\x20im'+'age\x20genera'+_0x1a3e6e(0x11b,0x119,0xe9,0x172)+_0x1a3e6e(0x18c,0x161,0x1d5,0x17a)+_0x5a5fab+')');let _0x573cc4='';_0x4509a3?_0x573cc4=_0x4509a3['replaceAll'](_0xe51bfd(0x2b,0x6,-0x10,0x2c),''):_0x573cc4=_0x2116e9;if(_0x4509a3&&_0x4509a3[_0x1a3e6e(0x11d,0x100,0x116,0x15f)](_0xe51bfd(-0xc,0x46,0x95,0x2c))){addLog(_0xe51bfd(0x92,0xb6,0xb5,0x50)+'启动');if(_0x51ef44)addLog('修图指令:\x20'+_0x51ef44);if(_0x10a807)_0x4d416f[_0xe51bfd(-0x1,-0x17,-0x19,0x66)](addLog,_0x1a3e6e(0x19d,0x1ba,0x1cf,0x1fd)+']');}function _0x1a3e6e(_0x4dd487,_0x17bac2,_0x7f86a8,_0x4d2c69){return _0x2e6b(_0x4dd487- -0x8f,_0x7f86a8);}try{const {image:_0x311814,change:_0x2aa27a}=await _0x4d416f[_0xe51bfd(0xe3,0x117,0x10e,0xf3)](generateBananaImage,{'prompt':_0x2116e9,'width':_0x47fdb3,'height':_0x24ab68,'change':_0x4509a3,'retouchPrompt':_0x51ef44,'retouchImage':_0x10a807});if(extension_settings[extensionName][_0x1a3e6e(0x1de,0x1d7,0x18a,0x20b)]!='0'){const _0x139dbd={};_0x139dbd[_0xe51bfd(0x13e,0x8a,0x96,0xf9)]=_0x573cc4,await _0x4d416f['jtXDn'](setItemImg,_0x2116e9,_0x311814,_0x139dbd),_0x4d416f['KpCqh'](addLog,'图像已存入数据库\x20f'+'or\x20prompt:'+'\x20'+_0x2116e9),extension_settings[extensionName][_0x1a3e6e(0x1cd,0x24a,0x237,0x1d7)][_0xe51bfd(0x3b,0x94,0x92,0x8)]?(extension_settings[extensionName]['banana'][_0x1a3e6e(0x113,0x111,0xbe,0xe3)]=extension_settings[extensionName][_0xe51bfd(0xea,0xb6,0x118,0xc2)]['cishu']+(0x24d2+0xbc4+-0x3095*0x1),_0x4d416f[_0xe51bfd(0x55,-0xc,-0x38,0x18)](addLog,_0xe51bfd(-0x5a,-0x32,0x58,0x2b)+_0xe51bfd(0x1,-0x1a,0x73,0x65)+extension_settings[extensionName]['banana'][_0xe51bfd(0x5b,-0x11,-0x3,0x8)])):(extension_settings[extensionName][_0x1a3e6e(0x1cd,0x1d3,0x16e,0x1c7)]['cishu']=-0xa2*-0x31+0x1f90+-0x3e91*0x1,_0x4d416f[_0x1a3e6e(0x171,0x11e,0x188,0x119)](addLog,_0xe51bfd(0x68,0x9a,-0x16,0x2b)+_0x1a3e6e(0x170,0x190,0x1e0,0x1d0)+extension_settings[extensionName]['banana'][_0xe51bfd(0x73,0x3d,0x1f,0x8)]));}else _0x4d416f[_0x1a3e6e(0x1b6,0x1f3,0x14b,0x17b)](addLog,_0x1a3e6e(0x1c0,0x140,0x1f1,0x157)+'库');const _0xef999d={};_0xef999d['id']=_0x5a5fab,_0xef999d['success']=!![],_0xef999d[_0x1a3e6e(0x112,0xf1,0x111,0xe1)]=_0x311814,_0xef999d['prompt']=_0x2116e9,_0xef999d[_0xe51bfd(0x149,0xd9,0x73,0xf9)]=_0x573cc4,eventSource[_0x1a3e6e(0x1e6,0x231,0x210,0x224)](EventType[_0x1a3e6e(0x1fc,0x1d3,0x21c,0x1c5)+_0xe51bfd(0xe8,0xfd,0xb1,0xb2)+_0xe51bfd(0x6b,0x42,0x27,0x67)],_0xef999d),_0x4d416f[_0xe51bfd(-0x14,0x19,0x50,0x66)](addLog,_0xe51bfd(0x9,0x71,0x69,0x6b)+'mitted\x20suc'+'cess\x20respo'+_0x1a3e6e(0x1ac,0x20f,0x1a5,0x22a)+':\x20'+_0x5a5fab);}catch(_0x46b692){if(_0x4d416f['qSVCg'](_0x4d416f[_0xe51bfd(0x4a,0x9e,0xc0,0x90)],_0x4d416f[_0x1a3e6e(0x1b9,0x1ad,0x140,0x1e0)])){const _0x2089aa='[Banana]\x20G'+_0x1a3e6e(0x1f1,0x1e6,0x279,0x27b)+_0x1a3e6e(0x15a,0xed,0xd8,0x1c0)+_0x1a3e6e(0x1a5,0x1ee,0x1a6,0x197)+_0x5a5fab+':\x20'+_0x46b692[_0x1a3e6e(0x16f,0x15e,0x120,0x109)];_0x4d416f[_0xe51bfd(0xce,0xd5,-0x9,0x6f)](addLog,_0x2089aa),console[_0xe51bfd(0xb7,-0x21,0x5d,0x5a)](_0x2089aa);const _0x418d54={};_0x418d54['id']=_0x5a5fab,_0x418d54[_0x1a3e6e(0x184,0x164,0x1ac,0x20a)]=![],_0x418d54[_0xe51bfd(0xbc,0xbf,0x47,0x5a)]=_0x46b692[_0x1a3e6e(0x16f,0x133,0x1a0,0x155)],_0x418d54[_0xe51bfd(0xae,0x151,0xfa,0xde)]=_0x2116e9,eventSource[_0xe51bfd(0xcc,0xac,0x95,0xdb)](EventType[_0x1a3e6e(0x1fc,0x205,0x1a6,0x23e)+'MAGE_RESPO'+_0x1a3e6e(0x172,0x1d9,0xed,0x1cf)],_0x418d54),_0x4d416f[_0xe51bfd(0x7f,0x57,0x33,0xa9)](addLog,_0xe51bfd(0xd9,0x57,0x46,0x6b)+_0xe51bfd(0x46,0x119,0x42,0xba)+_0xe51bfd(0xb1,-0x2d,0x26,0x51)+'nse\x20for\x20ID'+':\x20'+_0x5a5fab);}else return _0x6489cc[_0xe51bfd(-0x11,-0x8,0x6f,0x5d)]()['search'](dkDGiJ[_0x1a3e6e(0x153,0x12d,0xd6,0x108)])['toString']()[_0x1a3e6e(0x145,0x154,0xd4,0x18a)+'r'](_0x2597ff)[_0xe51bfd(0x0,-0x13,0x33,-0x18)](dkDGiJ[_0xe51bfd(0x8e,-0x32,-0x25,0x48)]);}}function initializeBananaListener(){function _0x597a2c(_0x5c552f,_0x249126,_0x219fba,_0x226a4b){return _0x2e6b(_0x5c552f-0x14c,_0x219fba);}const _0x2cd426={'FDTqg':function(_0x4c7f7c,_0x1bc3f0){return _0x4c7f7c(_0x1bc3f0);}};function _0x48b7e7(_0x50af92,_0xed4296,_0x16d15e,_0x3dbd96){return _0x2e6b(_0x3dbd96- -0x27,_0xed4296);}eventSource['on'](EventType['GENERATE_I'+_0x597a2c(0x2eb,0x29f,0x312,0x283)+'ST'],bananaGenerate),_0x2cd426[_0x48b7e7(0x2ba,0x1c8,0x211,0x23f)](addLog,'banana\x20生图事'+'件监听器已初始化。');}function _0x2e6b(_0xc3cac2,_0x391106){_0xc3cac2=_0xc3cac2-(0x91*-0xb+0x2f*0x99+-0x1461);const _0x528456=_0x420e();let _0x12a062=_0x528456[_0xc3cac2];if(_0x2e6b['wsFeNy']===undefined){var _0x5609ab=function(_0x31c8e7){const _0x5409ac='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0xeb659b='',_0x195b31='',_0x23459d=_0xeb659b+_0x5609ab;for(let _0x4c63f6=0x14c3+-0x733*0x2+-0x65d,_0x599fc5,_0xb5306,_0x1f6a20=-0x14*-0x67+0x41b*0x5+-0x1c93;_0xb5306=_0x31c8e7['charAt'](_0x1f6a20++);~_0xb5306&&(_0x599fc5=_0x4c63f6%(0x1*-0x79d+0x1f32+-0x7db*0x3)?_0x599fc5*(-0x54f*0x7+-0x1*-0xbe4+0x1985)+_0xb5306:_0xb5306,_0x4c63f6++%(-0x1ab4+0x830*0x1+0x1288))?_0xeb659b+=_0x23459d['charCodeAt'](_0x1f6a20+(-0x19dc+0x1*0x254b+-0xb65))-(0x4f*-0x37+0x5*-0x5e+0x12d9)!==0x5b4+0x2706+-0x2cba?String['fromCharCode'](0x244b+0x1cb+0x3*-0xc5d&_0x599fc5>>(-(0x1996*-0x1+0xf1*0x1+0x18a7)*_0x4c63f6&-0x2*0x2d3+0xde0+-0x834)):_0x4c63f6:0xc11+-0x1*-0x75d+-0x136e){_0xb5306=_0x5409ac['indexOf'](_0xb5306);}for(let _0x33f476=-0x1*-0x1147+0x2*-0x10ca+0x104d,_0x1a32a7=_0xeb659b['length'];_0x33f476<_0x1a32a7;_0x33f476++){_0x195b31+='%'+('00'+_0xeb659b['charCodeAt'](_0x33f476)['toString'](0x2cd+0x26a9+-0x1*0x2966))['slice'](-(0xa*0x7b+-0x1404+0xf38));}return decodeURIComponent(_0x195b31);};_0x2e6b['Fvrgqc']=_0x5609ab,_0x2e6b['PIXbnN']={},_0x2e6b['wsFeNy']=!![];}const _0xa7a2ae=_0x528456[-0x724*0x2+0x13c7+-0x57f],_0x490d14=_0xc3cac2+_0xa7a2ae,_0x424757=_0x2e6b['PIXbnN'][_0x490d14];if(!_0x424757){const _0x3f0a57=function(_0x2c0a82){this['XbhxCx']=_0x2c0a82,this['NwluEo']=[0x247*0x7+-0xaa*0x2c+0x14*0xaa,-0x2*-0xaa9+-0xd93+0x7bf*-0x1,-0x3a+0x201b+-0x1fe1],this['VepuLp']=function(){return'newState';},this['YELOjA']='\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*',this['PlLhpm']='[\x27|\x22].+[\x27|\x22];?\x20*}';};_0x3f0a57['prototype']['TexRNY']=function(){const _0xc0bfed=new RegExp(this['YELOjA']+this['PlLhpm']),_0x51a0d8=_0xc0bfed['test'](this['VepuLp']['toString']())?--this['NwluEo'][-0x4b5*0x3+-0x2c*-0xc5+0x694*-0x3]:--this['NwluEo'][0x68e+-0x14*0x140+0x2*0x939];return this['DLTUWT'](_0x51a0d8);},_0x3f0a57['prototype']['DLTUWT']=function(_0x2fb12f){if(!Boolean(~_0x2fb12f))return _0x2fb12f;return this['jhjffG'](this['XbhxCx']);},_0x3f0a57['prototype']['jhjffG']=function(_0x12bc6c){for(let _0x91d58c=-0x1e0c+0x1*-0x84d+-0x1*-0x2659,_0x5c834a=this['NwluEo']['length'];_0x91d58c<_0x5c834a;_0x91d58c++){this['NwluEo']['push'](Math['round'](Math['random']())),_0x5c834a=this['NwluEo']['length'];}return _0x12bc6c(this['NwluEo'][0x67*0x9+-0x109b+0xcfc]);},new _0x3f0a57(_0x2e6b)['TexRNY'](),_0x12a062=_0x2e6b['Fvrgqc'](_0x12a062),_0x2e6b['PIXbnN'][_0x490d14]=_0x12a062;}else _0x12a062=_0x424757;return _0x12a062;}export async function replaceWithBanana(){function _0x28429c(_0x1a8564,_0x388bf1,_0x71e022,_0x5b0ed6){return _0x2e6b(_0x388bf1-0x5c,_0x5b0ed6);}const _0x426539={};_0x426539[_0x2d30a6(0x1b0,0x162,0xe3,0x165)]=function(_0xec5690,_0x43a904){return _0xec5690!==_0x43a904;};function _0x2d30a6(_0x465dd7,_0x3875fd,_0x500001,_0x46c300){return _0x2e6b(_0x3875fd- -0x25,_0x500001);}_0x426539[_0x28429c(0x223,0x252,0x2b6,0x2ad)]=_0x2d30a6(0x282,0x264,0x217,0x2ea),_0x426539[_0x2d30a6(0x143,0x1a4,0x1d1,0x225)]=_0x28429c(0x2ed,0x2b8,0x266,0x230),_0x426539[_0x28429c(0x26c,0x28e,0x2b3,0x2a5)]='[Banana]\x20生'+'图事件监听器已关闭。';const _0x3af2dd=_0x426539;extension_settings[extensionName][_0x2d30a6(0x1f6,0x194,0x148,0x1e6)]==_0x3af2dd['iQASO']?(!window[_0x2d30a6(0x140,0x159,0xea,0x1af)+_0x28429c(0x1cc,0x202,0x202,0x1ca)+_0x28429c(0x24d,0x2ad,0x2b8,0x329)]&&(window['initialize'+_0x2d30a6(0x1e2,0x181,0x201,0x1ba)+_0x28429c(0x31e,0x2ad,0x223,0x294)]=!![],initializeBananaListener()),initializeImageProcessing()):window[_0x28429c(0x1fb,0x1da,0x18f,0x158)+_0x28429c(0x22e,0x202,0x1a7,0x272)+_0x28429c(0x318,0x2ad,0x252,0x2fc)]&&(eventSource[_0x28429c(0x23b,0x2b6,0x259,0x28d)+'ener'](EventType['GENERATE_I'+_0x28429c(0x1d6,0x1fb,0x1c3,0x1c0)+'ST'],bananaGenerate),LEGACY_EVENT_NAMES[_0x28429c(0x220,0x20b,0x28a,0x28f)](_0x15ac4c=>{function _0xf5ae45(_0x42f2b0,_0x1e3974,_0x1dfc4d,_0x55c748){return _0x2d30a6(_0x42f2b0-0xa7,_0x42f2b0-0x227,_0x1dfc4d,_0x55c748-0x60);}function _0xcf5fa6(_0x2b3a49,_0x38dda3,_0x1169cd,_0x175806){return _0x28429c(_0x2b3a49-0x123,_0x38dda3-0x163,_0x1169cd-0x16c,_0x175806);}_0x3af2dd[_0xcf5fa6(0x398,0x346,0x32c,0x3c2)](_0x3af2dd[_0xcf5fa6(0x3e4,0x3b5,0x369,0x333)],_0x3af2dd[_0xcf5fa6(0x32c,0x3b5,0x3ce,0x35a)])?_0xaee097=_0x24ee37:eventSource['removeList'+_0xcf5fa6(0x447,0x410,0x45e,0x416)](_0x15ac4c,bananaGenerate);}),window[_0x28429c(0x18a,0x1da,0x213,0x193)+_0x2d30a6(0x20c,0x181,0x109,0x172)+_0x2d30a6(0x26b,0x22c,0x1c1,0x224)]=![],addLog(_0x3af2dd[_0x2d30a6(0x1d8,0x20d,0x24a,0x247)]));}