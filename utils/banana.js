(function(_0x2cba74,_0x27324d){function _0x4006b7(_0x3cbfda,_0x16d07c,_0x489548,_0x8548ff){return _0x11d3(_0x16d07c- -0x311,_0x3cbfda);}function _0x2039f2(_0x40bd8d,_0x4aab43,_0x295159,_0x53cd1d){return _0x11d3(_0x53cd1d-0x348,_0x4aab43);}const _0x28a088=_0x2cba74();while(!![]){try{const _0xaa929=parseInt(_0x2039f2(0x543,0x563,0x624,0x598))/(0x143e+-0xd06+-0x737)+parseInt(_0x2039f2(0x479,0x465,0x535,0x4a5))/(0x1aa1+-0xf62*-0x1+-0x2a01)*(parseInt(_0x4006b7(-0x166,-0x14a,-0x109,-0x18f))/(-0x21e9+-0x13*-0x18e+0x16*0x33))+parseInt(_0x4006b7(-0x69,-0x84,-0xdf,-0xb5))/(-0xc5e+-0x2bf*-0xe+-0x1a10)*(parseInt(_0x2039f2(0x58e,0x538,0x4a4,0x52a))/(-0x16*-0xed+-0x5*-0x417+0x175*-0x1c))+-parseInt(_0x4006b7(-0x12e,-0xd8,-0x3e,-0x120))/(-0x3*-0x489+0x1d50+0x1*-0x2ae5)+-parseInt(_0x2039f2(0x5c1,0x602,0x568,0x5bc))/(0x8fa+0x8db+-0x2b*0x6a)*(parseInt(_0x4006b7(-0xa2,-0x7b,-0x123,-0xe7))/(0x1435+0x1fcd+0x19fd*-0x2))+parseInt(_0x4006b7(-0x14f,-0xa6,-0x11a,-0x10f))/(-0x1c6f+-0x7*0x37+0x1df9)*(-parseInt(_0x4006b7(-0xc4,-0x167,-0x1a1,-0x1cd))/(-0x15d3+-0x55c+0x1b39))+parseInt(_0x2039f2(0x4fd,0x5cd,0x54e,0x5a2))/(0xf2d+-0x27a+0x1e*-0x6c)*(-parseInt(_0x2039f2(0x506,0x55b,0x4d7,0x4b7))/(0x4*0x5ec+0x520*-0x3+0x422*-0x2));if(_0xaa929===_0x27324d)break;else _0x28a088['push'](_0x28a088['shift']());}catch(_0x5631e1){_0x28a088['push'](_0x28a088['shift']());}}}(_0x2f4e,0x6ec27+0x80295*-0x1+0x2dbf*0x1f));const _0x45064f=(function(){let _0x2a8fe2=!![];return function(_0xd617f5,_0x421f44){const _0x14125a=_0x2a8fe2?function(){function _0x2fac23(_0x33833b,_0x151778,_0x2e60e6,_0x52d9cf){return _0x11d3(_0x2e60e6- -0x13,_0x151778);}if(_0x421f44){const _0x4ff691=_0x421f44[_0x2fac23(0xc2,0xc7,0x159,0x17e)](_0xd617f5,arguments);return _0x421f44=null,_0x4ff691;}}:function(){};return _0x2a8fe2=![],_0x14125a;};}()),_0x1394e5=_0x45064f(this,function(){const _0x43fa94={};_0x43fa94[_0x10298b(-0x182,-0x198,-0x16b,-0x11e)]=_0x10298b(-0x170,-0x1dd,-0x18b,-0x141)+'+$';function _0x8faf39(_0x2ec98a,_0x556ea4,_0x38e1ce,_0x43cc94){return _0x11d3(_0x2ec98a-0x3a4,_0x556ea4);}const _0x5ef594=_0x43fa94;function _0x10298b(_0x26f107,_0x518ec4,_0x4cc2e1,_0x8bc6f1){return _0x11d3(_0x4cc2e1- -0x2ff,_0x518ec4);}return _0x1394e5[_0x8faf39(0x5cb,0x655,0x5b4,0x600)]()[_0x8faf39(0x5a4,0x543,0x58c,0x554)](_0x5ef594['UFnRn'])[_0x10298b(-0x180,-0x137,-0xd8,-0x14b)]()['constructo'+'r'](_0x1394e5)[_0x10298b(-0x191,-0x12e,-0xff,-0xf1)](_0x5ef594['UFnRn']);});_0x1394e5();import{extension_settings}from'../../../../extensions.js';import{eventSource}from'../../../../../script.js';import{extensionName,EventType}from'./config.js';import{sleep,generateRandomSeed,zhengmian,fumian,getRequestHeaders,prompt_replace,addLog,clearLog,parsePromptStringWithCoordinates,prompt_replace_for_character,stripChineseAnnotations}from'./utils.js';function _0x2f4e(){const _0x3dc431=['ENrNtNy','Bxvhsu4','ChjVBxb0','u09iDva','tg9rsve','BIbWyxLSB2fKia','Dg9mB3DLCKnHCW','z3jJqxC','CMTKB3DUigLTyq','zM9YrwfJAa','r2zYzLG','CMvTB3zLtgLZDa','AgLyr3y','zMv0y2GGAw1HzW','w0jHBMfUyv0G5l2/','yMnzuxC','ntCXmfPMyLnKtG','qMjHBK8','yxnZAxn0yw50','Dgv4Da','DhjPBq','yuXgwMq','DwLSDcbjBwfNzq','w0jHBMfUyv0Gua','Bxb0','ignVBNrHAw4GAq','tKn3tvC','EKTdrfq','Cg9ZDgzPEfbYBW','55sO5l+U5zU+6Ake6k6+oIaI','l3yXlW','vwTYs3K','6k+35Rgc5Bc65A+4oIdLRR3LUQyGlq','BhvYzsbYzxnWBW','Aw1Hz2vFDxjS','B21WBgv0Aw9UCW','Ce9mufO','Bw9KzwW','B3iGChjVBxb0oG','tefcB0C','ifbYB21WDa','v09mwLK','q05KqMy','rgXXExy','r0vorvjbvevFsq','mJG1txnytLP4','t1PUtNu','yKPWzfm','B3nPDgLVBG','DxnLCG','w0jHBMfUyv0Gra','zK96qui','DwnJzxnZzNvSBa','B0TYyKS','w0jHBMfUyv0Gtq','C3rYAw5NAwz5','y29UDMvYC2f0Aq','A0nos1a','5lU255Ur5zcS5zMO5BEY5yID5AEl5yYw44cc','yxbWBgLJyxrPBW','5zU+5Rwb56Il44cc5A6I5OI356UV5lI6','CIbWCM9TChq6ia','CeLNtK8','ChvZAa','DePLt04','zxrJAcbLCNjVCG','5yMn572U5yMn','C3rHCNrZv2L0Aa','Der1suG','qMvHCMvYia','yMfUyw5H','y2HHBMDL','ndCZnxLit0XbvW','quPWreq','ig1LC3nHz2vZlG','A1nKwMu','zxjYB3i','yMfUyw5Hq2HHCG','Aw5JBhvKzxm','yxLSB2fKoIa','57Yt5A2y6k6+572U5lI65lIn5A2y5ywL5PwW5O2U','CMvWBgfJzufSBa','zLjStMS','w0jHBMfUyv0G5zcV','ywXSyMfJAY4','CMvHzefZrgf0yq','AKPstNO','rg5lA2W','5PIV5zcM5zcV55sO5yIg6kEs6iMY5QIH5BYpia','igLTywDLihrVia','uuXmCgK','w0jHBMfUyv0GrW','z0LoueK','AgfrEeq','qvbjihjLCxvLCW','t3P6weq','CgfYyw1LDgvYCW','C2uGzgLKig5VDa','BwvZC2fNzq','CMvWBgfJzq','EwX3rK8','vKPVufy','C2vHCMnO','5Qch5yEg5QIH5BYpoIdKVB/NLkJOR7FMSyi','tvfUv2C','CM9Szq','DgLVBIb3AxrOia','igv4DhjHy3rPBG','sxzwzuC','EMTcruW','C2LUzYbKAxjLyW','DeDxENe','y1vNDK8','5B2t5yMn55sF5zU+5QYH5PwW5lI6igzV','yMfZzty0lG','ztOG','swrdDvC','uxHPzKO','w0jHBMfUyv0G55sF','zMLSDgvY','C3rYAw5N','BNrHAw5ZihrLEa','ihWG','CeHRr00','zw5KC1DPDgG','y2vZCYbYzxnWBW','vvjm','Cuzrr1e','DhLWzq','EsbJB252zxj0zq','zuzqBgy','B3DUigLTywDLoG','5yMn572U5zco','zw5LCMf0Aw9Uia','z21xtwm','C2v0ici','EvzAD2G','tLzWu0K','r3L2Agq','z2uGzM9YBwf0la','yLDwDha','Dg9tDhjPBMC','DcbvuKWGyxmGzG','AKvWu3i','v1j0sNe','DdOG','zLngCMG','vuLiBLy','ALHADKO','ieLeia','BKzltLO','sLnbr04','qNrSr2W','l3yXl2nOyxqVyW','y2rAt2u','yLrtywO','s1vns0W','y2fJAgu','DLv1uuW','nJmYotGYDNLYCK56','D1blB08','5zU+5QIH5BYp77YA5BEY5RE75yQG5B6f5l+U5Ps5','5zU+5QIH5BYp77YA5OYh5lUKid0G','BwfW','5z2q5Qch55Qe5O+q56s66k+n5A2x56YM5lIY44cc','y2HVAwnLCW','5zco572U5yMn','B25LCNjVCG','sLz6yNa','5lIT55QeihbYB21WDooaGG','DgfYDgLUzYbPBq','BNnLigzVCIbjra','y2zNAw1NxW','BgvUz3rO','quzwyLu','weTyqxi','Bw9Kzq','t1jvvfi','r1rTCMG','yxrLzcbZDwnJzq','C3rHDhvZ','DKTzExa','mZm5odaWrfviq2v0','sejKqvq','kerPDMLKzv9YBW','zML4zwrqCM9TCa','BwvZC2fNzxm','zMfPBgvKigzVCG','y2LZAhu','uNHgv3y','C3nMDwXSEs4','C2fTCgXLq291BG','nJu2mtyXyNLbwM5O','zurVsvK','CMDIveG','55sO5lQo55sF5OIq55QevgfNoIa','tMzHshO','Bw9KywWGCgf5Ba','B25SB2fKzw5K','lcdPQ5JLUQyGlsa','5PYa5zco572U','iIbMCM9TihbYzq','B3vUzcbTyxrJAa','zxrJAcbnyxjRza','C3qGkeLeoIa','CKrOsvG','v2rbEgm','z0LlvMe','rNfYtNm','ntiZoe9OEe9tEq','DKXmzfm','Aw1Hz2vU','Evn6tfu','B0Hyrxi','5l+U5zU+5zU+54MhoIbB5BEY5O+q5l6B','BI9QC29U','CwfKDxK','w0jHBMfUyv0GrG','mti3ndyZn254DuP2rW','teDmy2q','yxPLDum','AKjOAeC','C3PQzvm','igLTywDLlG','yxDoAM8','runZu0u','z2fXue0','yMfQvue','ywDLigDLBMvYyq','vxflq3a','zw5bssbMB3jTyq','ue9tva','EKfHA0W','y2XyB3e','uMvVDve','Aw1Hz2u','zw5LCG','zezVywq','C1jxA2y','BuH1sMe','u1Dvv20','qMfUyw5H5l+U5zU+5QIH5BYp','DMXzt3a','mtiZnLPABurxwG','5yIg6kEs6iMY5QIH5BYpoIdOP6pMNPdLUky','BMLZteO','zwnLAxzLzcbPBq','y29UC3rYDwn0BW','wfHMvfi','zxnWB25ZzsbJBW','DwvZDcb0BZOG','weDyzhG','ogr4B1PkzG','yxjRzg93BIbPBq','w0jHBMfUyv0GuW','AM9PBG','E+s/RUwBVN0','vgTsAwe','u2XbsK8','5zU+5lQl5lU255Ur5zcS5zMO5BEY5ywZ6zET44cc','BwfNzsbNzw5LCG','Aw1Hz2vjza','5Q2J6z2I5O+q56s66k+noIa','tufhrv9srvfvrq','Dvr4vLC','zMXHDa','yMHoCMq','C3bSAxq','AuvLsgW','w0jHBMfUyv0Gvq','Bg5duu8','t21Uzue','s3P3vvO','EvfVy08','yLvpu0S','w0jHBMfUyv0Grq','w0jHBMfUyv0GqG','mtiXntHvuerAAeS','yunXDKO','DKXLwLa','rxHYtwO','Aw5ZDgfUy2vZ','Bgzvzei','zw5KAw5NihjLCq','BgvZktOG','wLHiy2q','EKLwuxi','DcbVBMX5lcbUBW','l3yXyMv0ys9TBW','zcbnyxjRzg93BG','w0jHBMfUyv0GuG','yMfUyw5HioEuN+wBVUs6IW','yxbWBhK','zgvSCY8','yxnWzwn0uMf0Aq','nJbNwfrut0S','tufhrv9srvnqtW','5BYa5AEliejHBMfUyEEuNW','BwfNzsbPBIbpCa','A2vdsg4','kcGOlISPkYKRkq','DxjS','w0jHBMfUyv0G5l+U','zw1PDa','Bw9KzwW6ia','y29UDgvUDa','BLPdExa','wK5VAw4','DujYrMm','u2nLBMuGq29TCa','tNfPzMW','ywn0zxjqCMvZzq','C3vJy2vZCW','qMfUyw5HtgLZDa','DgLVBIbYzxf1zq','rufwwfu','uLrTuxa','q2HHCMfJDgvYia','zxrLy3rLzcbnyq','uMDSEeO','55Qe5zU+54Mh','DKjZtMO','DwLSDcbTDwX0Aq','Aw5NihrYAwDNzq','v2TMC3u','ywLSzwqGDg8GzG','Aw5PDgLHBgL6zq','zYbvuKWUlI4','5l+U5zU+5OYh5lUKoIa','rMfPBgvKihrVia','vvrJy0O','r0THt0y','vuzUuM4','rwfVqKm','vNPvDfC','AxrOihn0yxr1CW','BwL0DgvKihn1yW','t0zuAfu'];_0x2f4e=function(){return _0x3dc431;};return _0x2f4e();}import{initializeImageProcessing}from'./iframe.js';import{processCharacterPrompt}from'./characterprompt.js';import{setItemImg}from'./database.js';import{getConfigImage}from'./configDatabase.js';function _0x11d3(_0x445c0d,_0x11636b){_0x445c0d=_0x445c0d-(-0x2417*-0x1+-0x1*0x1110+-0x11be);const _0x3613d=_0x2f4e();let _0xc9c78c=_0x3613d[_0x445c0d];if(_0x11d3['OcSMXu']===undefined){var _0x3ef7c0=function(_0x5a479d){const _0x1eb335='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x2751ff='',_0x3adbda='',_0x120cac=_0x2751ff+_0x3ef7c0;for(let _0x217318=0x16b6+0xeb1+-0x2567,_0x2c4e41,_0x1c689d,_0x355d2c=0xf5d+0x7*-0x55f+0x163c;_0x1c689d=_0x5a479d['charAt'](_0x355d2c++);~_0x1c689d&&(_0x2c4e41=_0x217318%(0x1b94+0x1f*-0x91+0xc5*-0xd)?_0x2c4e41*(0xca4+0x205f+-0x2cc3)+_0x1c689d:_0x1c689d,_0x217318++%(0x9*0x23b+-0x1c33+0x824))?_0x2751ff+=_0x120cac['charCodeAt'](_0x355d2c+(0x1*0x1c55+0x1e4b+-0x3a96))-(0x258c+0x1*0x1ec2+-0x22*0x202)!==-0x29*0x26+0x10b7*-0x1+-0x1c1*-0xd?String['fromCharCode'](-0x1cac+-0x23aa+0x1*0x4155&_0x2c4e41>>(-(-0x7a*-0x3b+0x25be*-0x1+-0x9a2*-0x1)*_0x217318&-0x211*0x3+-0x26ca+0x2d03)):_0x217318:0x786+-0x9c3+0x23d*0x1){_0x1c689d=_0x1eb335['indexOf'](_0x1c689d);}for(let _0x1c2ff0=0x2117+-0x3*0x76d+-0x8*0x15a,_0x5846f8=_0x2751ff['length'];_0x1c2ff0<_0x5846f8;_0x1c2ff0++){_0x3adbda+='%'+('00'+_0x2751ff['charCodeAt'](_0x1c2ff0)['toString'](-0x5c6*0x5+0x965*0x2+-0x2*-0x512))['slice'](-(-0x2*0x3f9+0x8*-0x16e+-0x1*-0x1364));}return decodeURIComponent(_0x3adbda);};_0x11d3['CxzYXx']=_0x3ef7c0,_0x11d3['EyWhpD']={},_0x11d3['OcSMXu']=!![];}const _0x17a6ed=_0x3613d[0xbbc+0x45*0x6f+-0x29a7],_0x3b6faa=_0x445c0d+_0x17a6ed,_0x12fd30=_0x11d3['EyWhpD'][_0x3b6faa];if(!_0x12fd30){const _0x4b3af2=function(_0x242ada){this['fWgBuv']=_0x242ada,this['DMWuht']=[-0x1762*-0x1+-0x177c+0x1b,0x457+-0x12b4+0xe5d,0xe08+-0x5ea*-0x2+-0x296*0xa],this['yykHrS']=function(){return'newState';},this['ywSwFH']='\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*',this['hNmIGk']='[\x27|\x22].+[\x27|\x22];?\x20*}';};_0x4b3af2['prototype']['qbzoDY']=function(){const _0x3d3c5a=new RegExp(this['ywSwFH']+this['hNmIGk']),_0x1c1054=_0x3d3c5a['test'](this['yykHrS']['toString']())?--this['DMWuht'][-0x1*-0x13ff+0x189b+-0x2c99]:--this['DMWuht'][0x141*-0xc+-0x6b9*0x3+0x2337];return this['ndIQiY'](_0x1c1054);},_0x4b3af2['prototype']['ndIQiY']=function(_0x54b7ce){if(!Boolean(~_0x54b7ce))return _0x54b7ce;return this['ExoWBD'](this['fWgBuv']);},_0x4b3af2['prototype']['ExoWBD']=function(_0x415374){for(let _0xdc0d84=0x700+0x1*0x22bd+-0x29bd*0x1,_0x1d4484=this['DMWuht']['length'];_0xdc0d84<_0x1d4484;_0xdc0d84++){this['DMWuht']['push'](Math['round'](Math['random']())),_0x1d4484=this['DMWuht']['length'];}return _0x415374(this['DMWuht'][0x3dc+0xcb7+-0x1093]);},new _0x4b3af2(_0x11d3)['qbzoDY'](),_0xc9c78c=_0x11d3['CxzYXx'](_0xc9c78c),_0x11d3['EyWhpD'][_0x3b6faa]=_0xc9c78c;}else _0xc9c78c=_0x12fd30;return _0xc9c78c;}async function getImageFromTurnData(_0xbb758e){const _0x23b311={};_0x23b311['iEeHl']=_0x2f9f04(0x2c3,0x27c,0x284,0x280);function _0x34a922(_0xf58bcf,_0x1802e1,_0x36cd39,_0x1b70e6){return _0x11d3(_0xf58bcf- -0x25b,_0x36cd39);}_0x23b311['zKCDT']=function(_0x4d894a,_0x28f024){return _0x4d894a||_0x28f024;},_0x23b311[_0x34a922(-0x104,-0x181,-0x141,-0x1aa)]='data:image',_0x23b311['lnCQO']=function(_0x17dcc6,_0x248e0f){return _0x17dcc6===_0x248e0f;},_0x23b311['rDhIX']='oGpFT',_0x23b311[_0x2f9f04(0x26e,0x255,0x1c5,0x1d4)]=_0x34a922(0xe,-0x7b,0x86,-0x6b);const _0x317925=_0x23b311;if(!_0xbb758e)return'';if(_0xbb758e[_0x34a922(-0x10e,-0x195,-0x179,-0xc4)]&&_0xbb758e[_0x2f9f04(0x193,0x1b7,0x18b,0x187)]['startsWith'](_0x317925[_0x34a922(-0x107,-0x198,-0x169,-0x1a9)])){const _0x2c7d00=await getConfigImage(_0xbb758e[_0x34a922(-0x10e,-0x10d,-0x8f,-0x177)]);return _0x317925[_0x34a922(-0xa6,-0x104,-0x133,-0x69)](_0x2c7d00,'');}function _0x2f9f04(_0x90a5f9,_0x4771a7,_0x49aef9,_0x214f8c){return _0x11d3(_0x49aef9-0x3e,_0x214f8c);}if(_0xbb758e[_0x2f9f04(0x304,0x263,0x2c3,0x2c9)]&&_0xbb758e[_0x34a922(0x2a,-0x64,0x68,-0xa)][_0x2f9f04(0x185,0x296,0x21b,0x1f9)](_0x317925[_0x34a922(-0x104,-0x147,-0xde,-0x15f)])){if(_0x317925[_0x2f9f04(0x105,0x15c,0x194,0x1ab)](_0x317925[_0x34a922(0xc,-0x26,-0x7c,-0x95)],_0x317925[_0x34a922(-0xd4,-0x154,-0xf4,-0xa1)])){if(_0x389c9d){const _0x491854=_0x5d8441[_0x34a922(-0xef,-0x107,-0x55,-0x128)](_0x553a9d,arguments);return _0xf2bb9=null,_0x491854;}}else return _0xbb758e[_0x34a922(0x2a,-0x33,0x86,0x3d)];}return'';}async function generateBananaImage({prompt:_0x296491,width:_0x432aba,height:_0x28d952,change:_0x53f0cc,retouchPrompt:_0x1e6bc2,retouchImage:_0x284ecb}){const _0xdb21aa={'muGIN':'assistant','tDuIH':'(((.+)+)+)'+'+$','clXoq':function(_0x4bc97c,_0x2dbfd4){return _0x4bc97c(_0x2dbfd4);},'UkrKy':function(_0x39fb55,_0x5be528){return _0x39fb55(_0x5be528);},'OZnNu':_0x47ebb3(0x16,0x27,0x80,-0x7b),'hiXGv':function(_0x27deec,_0x42ac92){return _0x27deec+_0x42ac92;},'gkVQp':function(_0x106878,_0x222bfc){return _0x106878+_0x222bfc;},'jJRNz':function(_0x12ae50,_0x450854){return _0x12ae50+_0x450854;},'XKXAr':function(_0x1c8fcb,_0x363411){return _0x1c8fcb(_0x363411);},'bUOSK':function(_0x25155b,_0x5de24a){return _0x25155b(_0x5de24a);},'zIVQr':_0x6fefd7(0x56,0x7f,0xcd,0xd8),'vUuQL':_0x6fefd7(0xc1,0x13c,0x10f,0xb0),'Gyvhd':_0x6fefd7(0x15c,0xd6,0x131,0xb6),'uBrFc':'后置后','zkBEL':_0x6fefd7(0x14f,0x1cf,0x153,0x1a3),'szjeS':function(_0x5a0bad,_0xaf1f93){return _0x5a0bad(_0xaf1f93);},'QLLpi':'user','uTxVW':function(_0x136fc9,_0x54d49f){return _0x136fc9(_0x54d49f);},'wPKoO':function(_0x5c3e47,_0x29cf0d){return _0x5c3e47(_0x29cf0d);},'ySzLU':function(_0x5be7ac,_0x1e698d){return _0x5be7ac||_0x1e698d;},'cdZOe':function(_0x44e384,_0x58822c){return _0x44e384||_0x58822c;},'bhNrd':function(_0x41e17a,_0x3bdbdb){return _0x41e17a!==_0x3bdbdb;},'TkRia':function(_0x554f00,_0x63a9cc){return _0x554f00(_0x63a9cc);},'nZCyp':_0x6fefd7(0x94,0x2,0x6e,0x54)+_0x6fefd7(0xc3,0xc9,0xbb,0x14e),'yQocO':function(_0x595bc6,_0x5cb880){return _0x595bc6===_0x5cb880;},'WOLZY':_0x6fefd7(0x101,0x17,0x7d,0xe),'GKaOF':_0x6fefd7(0x14c,0x197,0x17f,0x1e3)+_0x6fefd7(0x14f,0x1a3,0x12f,0x18f),'kSdZe':function(_0x447161,_0x576c11){return _0x447161(_0x576c11);},'EaoBC':function(_0x5bec1b,_0x1487fb){return _0x5bec1b<=_0x1487fb;},'fOzAB':function(_0x174387,_0x5e9d40){return _0x174387===_0x5e9d40;},'aLFZd':_0x6fefd7(0x117,0x5b,0xea,0x50),'KzwUZ':function(_0x432845,_0x3f09b0){return _0x432845+_0x3f09b0;},'wfsCv':function(_0x132850,_0x185fe0){return _0x132850+_0x185fe0;},'bcYQw':function(_0x1a2f48,_0x4a466e){return _0x1a2f48(_0x4a466e);},'VgzPz':_0x6fefd7(0x13a,0x12a,0xf2,0x62)+_0x6fefd7(0x1dc,0x160,0x134,0xd8),'jEpSr':function(_0x4b5dbc,_0x1834c2,_0x345c2b){return _0x4b5dbc(_0x1834c2,_0x345c2b);},'IdCuW':function(_0x379b55,_0x3b437b){return _0x379b55===_0x3b437b;},'ztgNv':_0x47ebb3(-0x40,-0xd5,-0x105,-0xb2),'mHuJa':_0x47ebb3(0x7a,0xa,0x6a,0x3a),'kUAOV':function(_0x4ceeb6,_0x52c340){return _0x4ceeb6+_0x52c340;},'pOLPZ':_0x6fefd7(0xf0,0x96,0x105,0x5e),'yVZwh':function(_0xcb419d,_0x324595){return _0xcb419d(_0x324595);},'kCNKP':_0x47ebb3(0x2d,-0x6,-0x27,0x20),'awNjo':function(_0x384839,_0x2bf930){return _0x384839!==_0x2bf930;},'eDoIY':_0x6fefd7(0x1d9,0xec,0x133,0x124),'nisLJ':function(_0x1daead,_0x519dbf){return _0x1daead(_0x519dbf);},'BtlGl':function(_0x5e0f8d,_0x45e7fc){return _0x5e0f8d(_0x45e7fc);},'zNYQR':_0x47ebb3(-0x87,-0x15,-0x93,-0x53),'UIHnV':function(_0x3285b5,_0x17b6aa){return _0x3285b5(_0x17b6aa);},'UTccJ':function(_0x4b99fa,_0x4ed912){return _0x4b99fa(_0x4ed912);},'DfZgQ':function(_0x53d7a5,_0x2728d6){return _0x53d7a5(_0x2728d6);},'ylwFO':_0x47ebb3(-0x67,-0xc6,-0x157,-0x6b),'NCwMW':'image_url','lfUdB':function(_0x48161e,_0x1c1043){return _0x48161e===_0x1c1043;},'ZNoin':'SWUWm','sRWkf':function(_0x268636,_0xefa039){return _0x268636(_0xefa039);},'BbanO':_0x6fefd7(0x198,0x1a0,0x183,0x114),'SOHuP':'Nixik','ZXHcd':function(_0x881503,_0x461629){return _0x881503>_0x461629;},'dFoad':_0x6fefd7(0x19a,0xc4,0x122,0xcd),'keCHn':function(_0x43bc25,_0x19e341){return _0x43bc25!==_0x19e341;},'oHXEr':_0x6fefd7(0xdf,0x80,0x74,0xb9),'VzUtW':_0x47ebb3(0x1c,0x3,0x5e,-0x11),'pIgNO':function(_0x3a37c6,_0x7df2e4){return _0x3a37c6(_0x7df2e4);},'vKYyp':'/v1','VJoPV':_0x6fefd7(0x11e,0x193,0x10a,0x178),'bTSaj':function(_0x22f70b,_0x37da45){return _0x22f70b+_0x37da45;},'UuFff':'/v1/','YqYGE':function(_0x13274d,_0x464f13){return _0x13274d(_0x464f13);},'ZKUdN':function(_0x442cbb,_0xb3fd19){return _0x442cbb(_0xb3fd19);},'cUgvO':_0x47ebb3(0x38,-0x28,-0xa3,-0x58),'HBdAT':function(_0x85a739,_0x466ba3,_0x53904a){return _0x85a739(_0x466ba3,_0x53904a);},'Nqifl':_0x6fefd7(0x14c,0x1e7,0x172,0x132),'AkUVd':_0x6fefd7(0x11c,0xda,0xc6,0x8d)+_0x47ebb3(-0x2b,-0x2,-0x45,-0x1d),'aCqvJ':_0x6fefd7(0x10d,0x100,0x139,0x187),'WdAxc':'OIQWk','beSRy':_0x47ebb3(-0x137,-0x90,-0x12e,-0x139),'CNdBf':function(_0x47000b,_0x1149dd){return _0x47000b===_0x1149dd;},'AhhWD':_0x47ebb3(-0x8e,-0x61,-0x82,0x1f),'yZHGj':_0x47ebb3(-0xd3,-0xa7,-0xeb,-0x129)+_0x6fefd7(0x9d,0xde,0x77,0x112)+_0x6fefd7(0x10,0xbd,0x93,0x125)+_0x47ebb3(-0xd5,-0x4e,-0x3e,0x11)+_0x6fefd7(0x110,0x9e,0xf6,0x9f)+_0x6fefd7(0x82,0x88,0x80,0xea),'XphXp':function(_0x344c7b,_0x17ef4b){return _0x344c7b(_0x17ef4b);},'SlAJO':_0x6fefd7(-0x3d,0x4a,0x46,0x18)+'sing\x20direc'+_0x47ebb3(0x5d,-0x4b,-0x64,-0xf4)+_0x6fefd7(0x76,0x13c,0xdf,0x6b),'MQnWg':function(_0x47345c,_0x49b3c1){return _0x47345c(_0x49b3c1);},'gmWMc':function(_0x4e9522,_0x1d656c){return _0x4e9522!==_0x1d656c;},'bJpdS':_0x6fefd7(0xb2,0xe8,0x11d,0x19d),'GTmrh':function(_0x5e7576,_0x465e08){return _0x5e7576(_0x465e08);}};_0x296491=_0xdb21aa['uTxVW'](processCharacterPrompt,_0x296491),_0x296491=await _0xdb21aa[_0x47ebb3(0x21,-0x39,-0x10,-0xad)](stripChineseAnnotations,_0x296491);let _0x39e735=_0x53f0cc;_0x53f0cc=processCharacterPrompt(_0x53f0cc),_0x53f0cc=await _0xdb21aa[_0x47ebb3(0x25,-0x2a,0x40,0x69)](stripChineseAnnotations,_0x53f0cc),_0xdb21aa[_0x47ebb3(0x2a,-0x2a,-0x7a,-0x55)](addLog,_0x6fefd7(0x46,0xe1,0x62,0x7)+_0x6fefd7(0xab,0xf9,0xc7,0x115)+extension_settings[extensionName]['client']),_0xdb21aa[_0x47ebb3(-0xe8,-0x123,-0xa2,-0x191)](addLog,_0x6fefd7(0xda,0x58,0xab,0x147)+'\x20'+_0xdb21aa[_0x47ebb3(0x13,-0x5,0x55,-0x14)](_0x432aba,'默认')+_0x47ebb3(0x51,-0x12,0x7b,0x82)+_0xdb21aa[_0x6fefd7(0x99,0x196,0x125,0x117)](_0x28d952,'默认')),_0x296491=_0x53f0cc&&_0xdb21aa[_0x6fefd7(-0x1a,-0x66,0x43,0x97)](_0x53f0cc[_0x47ebb3(-0x67,-0xc5,-0x120,-0xb0)](),'')?_0x53f0cc:_0x296491,_0xdb21aa[_0x6fefd7(0x55,0x3c,0x3a,0xb9)](addLog,_0x6fefd7(0x1de,0xd5,0x14e,0x185)+_0x296491);let _0x832f69=![];if(_0x296491[_0x6fefd7(0x156,0xcc,0xd9,0x96)](_0xdb21aa[_0x6fefd7(-0x1a,0xa4,0x6b,0x30)])){if(_0xdb21aa['yQocO'](_0x47ebb3(0xad,0x22,0xb8,-0x5c),_0xdb21aa[_0x47ebb3(-0x103,-0xb0,-0x7d,-0x98)])){const _0x193532=new _0x5e6058();_0x193532[_0x6fefd7(0x1f4,0xef,0x151,0x1d0)]=()=>_0x11f52b(_0x193532['result']),_0x193532[_0x47ebb3(-0x34,-0x32,-0x91,-0xc9)]=_0x2a10a3,_0x193532[_0x6fefd7(0x107,0xff,0xe0,0x15a)+'URL'](_0x5564cf);}else _0x832f69=!![];}addLog(_0x6fefd7(0xbd,0x97,0xe3,0x154)+_0x47ebb3(-0x77,-0x21,-0x10,-0x84)+_0x6fefd7(0xc3,-0x7,0x55,0xe1)+_0x832f69);function _0x47ebb3(_0x906cbd,_0x4b7269,_0x2746e0,_0x1a1424){return _0x11d3(_0x4b7269- -0x273,_0x906cbd);}function _0x6fefd7(_0xa34db7,_0x10c26a,_0x29d855,_0x376f95){return _0x11d3(_0x29d855- -0x10f,_0x376f95);}let _0x3a0f10={},_0x528aad='',_0x3e98f5='';if(_0x832f69){addLog(_0xdb21aa[_0x47ebb3(-0x8e,-0xe0,-0xbd,-0x154)]),_0x3a0f10=_0xdb21aa[_0x47ebb3(-0x8e,-0x8e,-0xc5,-0x73)](parsePromptStringWithCoordinates,_0x296491),_0x528aad=_0x3a0f10[_0xdb21aa[_0x47ebb3(-0xbd,-0xf9,-0x158,-0x129)]];for(let _0x2b5756=-0x2*0x216+0x2*-0x65b+-0x83*-0x21;_0xdb21aa[_0x47ebb3(-0x10f,-0xde,-0xa4,-0x115)](_0x2b5756,-0x6db+0x1*0x1a0b+-0x132c);_0x2b5756++){if(_0xdb21aa['fOzAB'](_0x6fefd7(0xe7,0xe9,0x170,0x1dc),_0xdb21aa[_0x47ebb3(-0xaa,-0xc4,-0xa2,-0xc6)])){const _0x1e6086={};_0x1e6086[_0x6fefd7(0x15a,0x11c,0xf4,0xfe)]=_0xdb21aa[_0x6fefd7(0xb9,0xf,0x8c,0x4e)],_0x1e6086[_0x47ebb3(-0xd7,-0xfa,-0x73,-0x9b)]=_0xcde86c,_0x5f3eff[_0x6fefd7(0x141,0xbe,0xca,0xf1)](_0x1e6086);}else _0x3a0f10[_0x6fefd7(0x77,0x1c,0x76,0xc3)+_0x2b5756+_0x6fefd7(0x12f,0xf4,0xb3,0xe)]&&(_0x3e98f5=_0xdb21aa[_0x47ebb3(-0x18b,-0x11b,-0x155,-0xcf)](_0xdb21aa['wfsCv'](_0x3e98f5,',\x20'),_0x3a0f10[_0x47ebb3(-0x4e,-0xee,-0x126,-0x150)+_0x2b5756+_0x6fefd7(0x144,0xcf,0xb3,0x114)]));}}else _0xdb21aa[_0x47ebb3(-0x4f,-0xca,-0xd4,-0x127)](addLog,_0xdb21aa['VgzPz']),_0x528aad=_0x296491;let {modifiedPrompt:_0x47a767,insertions:_0x592caa}=await _0xdb21aa[_0x6fefd7(0xff,0x141,0x11a,0xaa)](prompt_replace,_0x528aad,_0x3e98f5);if(_0x832f69){if(_0xdb21aa[_0x47ebb3(-0xf3,-0x65,-0x14,-0xd1)](_0xdb21aa[_0x6fefd7(0x123,0x4a,0x8b,0x68)],_0xdb21aa[_0x47ebb3(-0x31,0x16,0xad,-0x6e)]))return _0x5d6f10[_0x6fefd7(0x158,0x75,0x118,0x75)]()[_0x6fefd7(0x107,0x68,0xf1,0x15e)](fBuamE[_0x6fefd7(0xef,0x71,0xcf,0x9a)])['toString']()[_0x47ebb3(-0x3a,0x1e,-0x3c,-0x53)+'r'](_0x170c8f)['search'](fBuamE[_0x47ebb3(-0xaa,-0x95,-0x28,-0x25)]);else for(let _0x54c082=-0x12af+0xfe9+0x2c7;_0xdb21aa[_0x47ebb3(-0x40,-0xde,-0x165,-0x52)](_0x54c082,-0x71d+0x261a+0x9*-0x371);_0x54c082++){_0x3a0f10['Character\x20'+_0x54c082+_0x6fefd7(0xe8,0x15b,0xb3,0x54)]&&(_0x47a767=_0xdb21aa['kUAOV'](_0x47a767,_0xdb21aa[_0x47ebb3(-0x136,-0xb5,-0x11c,-0xab)])+_0xdb21aa[_0x47ebb3(-0x5a,-0x51,-0x6b,-0x4f)](prompt_replace_for_character,_0x3a0f10[_0x6fefd7(-0x15,0xaa,0x76,0xcd)+_0x54c082+_0x6fefd7(0x76,0x86,0xb3,0xe1)]));}}const _0x2cea64=extension_settings[extensionName][_0x6fefd7(0x11a,0xe3,0xd1,0xd6)],{model:_0x15d904,apiUrl:_0xf22fff,apiKey:_0x593dfd,conversationPresets:_0x5a9fe8,conversationPresetId:_0x6138a5,editPresetId:_0x59f2f3,aspectRatio:_0x72a5ac}=_0x2cea64;_0xdb21aa[_0x6fefd7(0xbc,0x2d,0x41,0x27)](addLog,_0x6fefd7(0x1c3,0x1f2,0x189,0x1de)+_0x6fefd7(0x149,0x8e,0x135,0x1ca)+_0x6fefd7(0x1c6,0xf0,0x16f,0x1ce)+_0x6fefd7(0x67,0xde,0xf5,0x124)+_0x47ebb3(-0x15f,-0xfb,-0xda,-0xcf)+_0x15d904);let _0x1493cc,_0x59f24a;if(_0x15d904[_0x47ebb3(0x5,-0x96,0x7,-0x92)](_0xdb21aa[_0x6fefd7(0xab,0x51,0xc4,0x79)])){if(_0xdb21aa[_0x6fefd7(0xcb,0x1d4,0x16b,0x1f5)](_0xdb21aa[_0x6fefd7(0x117,0x1a1,0x14c,0x15d)],_0xdb21aa[_0x47ebb3(0x79,-0x18,0x17,0x53)]))return _0x429618[_0x47ebb3(-0x2e,0x12,0x5d,0x5f)];else{_0x1493cc=_0x47ebb3(-0x130,-0x10b,-0x158,-0x175)+_0x47ebb3(-0x19a,-0x106,-0x12b,-0x96)+_0x15d904;const _0x779f54={};_0x779f54[_0x6fefd7(0x1eb,0x1b8,0x144,0x1d2)+'t']='';const _0x288c5e=_0x5a9fe8[_0x6138a5]||_0x779f54,_0x509530=[_0x288c5e['fixedPromp'+'t'],_0x592caa[_0xdb21aa['zIVQr']],_0x592caa[_0xdb21aa[_0x6fefd7(0xe9,0xd9,0x129,0xf3)]],_0x47a767,_0x592caa[_0xdb21aa[_0x6fefd7(0x93,0x17c,0x115,0x11b)]],_0x592caa[_0xdb21aa['uBrFc']],_0x288c5e['postfixPro'+_0x47ebb3(-0xd3,-0xc1,-0x146,-0xa0)],_0x592caa[_0xdb21aa[_0x47ebb3(-0xd5,-0x6c,-0x43,-0x49)]]]['filter'](Boolean)['join'](',\x20');_0xdb21aa[_0x47ebb3(-0xa,0x1c,-0x43,0x16)](addLog,_0x6fefd7(0x41,0x6a,0x3f,0x77)+_0x509530);const _0x347004={};_0x347004['prompt']=_0x509530;const _0x2d76c3={};_0x2d76c3['sampleCoun'+'t']=0x1,_0x2d76c3[_0x6fefd7(0xfc,0xbc,0x5f,0x16)+'o']=_0x72a5ac;const _0x3ac2df={};_0x3ac2df[_0x6fefd7(-0x20,-0x15,0x52,0x42)]=[_0x347004],_0x3ac2df['parameters']=_0x2d76c3,_0x59f24a=_0x3ac2df,_0xdb21aa[_0x6fefd7(0x19c,0x86,0x123,0xff)](addLog,_0x6fefd7(0x18,0x5d,0x4d,-0x34)+_0x47ebb3(-0x130,-0xc3,-0xc9,-0x20)+'n\x20payload\x20'+'with\x20promp'+_0x6fefd7(0x17b,0x16e,0x11c,0x137)+_0x509530);}}else{_0x1493cc=_0x6fefd7(0x82,0xd0,0x124,0x10b)+_0x47ebb3(-0xfd,-0xb6,-0xec,-0x136);let _0x176793;if(_0x53f0cc[_0x47ebb3(-0xb5,-0x8b,-0x110,-0xe2)](_0xdb21aa['OZnNu'])){if(_0xdb21aa['zNYQR']===_0x47ebb3(-0x68,-0x15,0x35,0x43)){_0xdb21aa['UIHnV'](addLog,_0x47ebb3(-0xe2,-0x86,-0xdf,0x17)+'用了\x20{修图}\x20标识'+'。');const _0x283bb2=_0xdb21aa[_0x47ebb3(-0x91,-0x5,-0x4d,0x96)](_0x59f2f3,'默认'),_0x9a037c={};_0x9a037c[_0x47ebb3(-0x6d,-0xa1,-0xb0,-0x129)+'on']=[],_0x9a037c[_0x6fefd7(0x148,0x163,0x144,0xc7)+'t']='',_0x176793=_0x5a9fe8[_0x283bb2]||_0x9a037c,_0xdb21aa[_0x47ebb3(-0x7e,-0xe1,-0x156,-0xb5)](addLog,_0x6fefd7(0xb7,0x6f,0x99,0x111)+_0x6fefd7(0xf1,0x7a,0xa8,0x8b)+_0x283bb2+'\x22');}else _0xdb21aa['clXoq'](_0x12e7c3,'[Banana]\x20F'+_0x47ebb3(-0x171,-0xe6,-0x51,-0xa8)+'etch\x20Markd'+_0x47ebb3(0x33,-0x56,-0xda,-0xab)+'\x20'+_0x30763e[_0x47ebb3(-0xc5,-0x77,-0x5a,-0x2)]),_0x55a8e4=_0x2e905c,_0xdb21aa['UkrKy'](_0x3ff2d3,_0x6fefd7(0xc9,-0x1d,0x46,0xb1)+_0x47ebb3(-0x11,-0x6b,-0x8e,0x1d)+_0x47ebb3(-0xb6,-0x4b,-0x3e,-0x15)+_0x47ebb3(-0x115,-0x85,-0x107,-0x29));}else{const _0x341eb1={};_0x341eb1[_0x6fefd7(0x163,0xf9,0xc3,0x115)+'on']=[],_0x341eb1[_0x47ebb3(0x44,-0x20,-0x29,-0x43)+'t']='',_0x176793=_0x5a9fe8[_0x6138a5]||_0x341eb1;}const _0x23062a=[_0x176793[_0x47ebb3(-0xa3,-0x20,-0x48,-0x9d)+'t'],_0x592caa[_0xdb21aa[_0x47ebb3(-0x6f,-0x10d,-0x14b,-0x133)]],_0x592caa[_0x47ebb3(-0x74,-0x55,-0xac,-0x8c)],_0x47a767,_0x592caa[_0xdb21aa[_0x6fefd7(0xfe,0x114,0x115,0xf7)]],_0x592caa[_0xdb21aa[_0x47ebb3(-0x199,-0xf7,-0xc3,-0x196)]],_0x176793[_0x47ebb3(-0x151,-0xbd,-0xf1,-0x109)+_0x6fefd7(0x90,0x1b,0xa3,0xc3)],_0x592caa[_0xdb21aa[_0x6fefd7(0x74,0x160,0xf8,0x16f)]]][_0x47ebb3(-0xd,-0x62,-0xf2,-0x58)](Boolean)[_0x6fefd7(0xe2,0x1c6,0x18a,0x177)](',\x20');_0xdb21aa['DfZgQ'](addLog,_0x6fefd7(0x9d,0x3f,0x3f,-0x40)+_0x23062a);const _0x57f265={};_0x57f265[_0x47ebb3(-0xb8,-0x70,-0x9d,0x2e)]=_0x6fefd7(0xd3,0xb5,0xbc,0x6d),_0x57f265[_0x47ebb3(-0x65,-0xfa,-0x11e,-0xae)]=[];const _0x525ba4={};_0x525ba4['role']=_0x6fefd7(0x4b,0x38,0x9d,0xe2),_0x525ba4[_0x6fefd7(0x4b,-0x3e,0x6a,0x32)]=[];const _0x33141a=_0x176793[_0x6fefd7(0x84,0x9a,0xc3,0xe5)+'on'][_0x6fefd7(0x190,0xef,0x12e,0x15b)](_0x18f0b9=>[_0x57f265,_0x525ba4])[_0x6fefd7(0x82,0x32,0x42,0x2d)]();let _0x45f652=-0xf8e+-0x2427+0x33b5;for(const _0x2c4b0c of _0x176793[_0x6fefd7(0xb8,0x1c,0xc3,0x118)+'on']){if(_0x2c4b0c[_0x47ebb3(-0xf7,-0xa8,-0xbb,-0xa1)]?.[_0x47ebb3(-0x8c,-0xc6,-0x48,-0x11c)])_0x33141a[_0x45f652]['content'][_0x6fefd7(0x125,0x25,0xca,0x12d)]({'type':_0xdb21aa[_0x47ebb3(-0x1b,-0x75,-0x116,-0x76)],'text':_0x2c4b0c[_0x47ebb3(-0x94,-0xa8,-0x14f,-0x55)][_0x47ebb3(-0x22,-0xc6,-0x1f,-0x100)]});const _0x407477=await _0xdb21aa[_0x47ebb3(0x46,-0x46,-0x69,-0xdc)](getImageFromTurnData,_0x2c4b0c[_0x6fefd7(0x96,0x145,0xbc,0x11a)]);if(_0x407477)_0x33141a[_0x45f652][_0x47ebb3(-0x182,-0xfa,-0x133,-0xa9)]['push']({'type':_0xdb21aa[_0x47ebb3(-0xcd,-0xbf,-0x6a,-0xbf)],'image_url':{'url':_0x407477}});_0x45f652++;if(_0x2c4b0c[_0x6fefd7(0x14c,0xc3,0xb0,0x108)]?.['text'])_0x33141a[_0x45f652][_0x47ebb3(-0x161,-0xfa,-0x103,-0x16d)]['push']({'type':_0xdb21aa[_0x6fefd7(0x184,0x15c,0xef,0xc5)],'text':_0x2c4b0c[_0x6fefd7(0x3a,0x68,0xb0,0x80)][_0x6fefd7(0xc3,0x4,0x9e,0x5)]});const _0x176a02=await getImageFromTurnData(_0x2c4b0c[_0x47ebb3(-0x73,-0xb4,-0xa2,-0x4c)]);if(_0x176a02)_0x33141a[_0x45f652][_0x6fefd7(0x96,0x4e,0x6a,0x51)][_0x47ebb3(-0x20,-0x9a,-0x12b,-0xdc)]({'type':_0x47ebb3(-0xa1,-0xb7,-0x119,-0x33),'image_url':{'url':_0x176a02}});_0x45f652++;}if(!_0x53f0cc[_0x47ebb3(-0x8c,-0x8b,-0xa6,-0xb1)](_0xdb21aa['OZnNu'])){const _0x4a9029=extension_settings[extensionName][_0x6fefd7(0xad,0x3c,0xd8,0x94)+_0x47ebb3(-0x5d,-0xf4,-0x161,-0xdf)+'ts']||{};for(const _0x374e5e in _0x4a9029){if(_0xdb21aa[_0x6fefd7(-0x32,0xf5,0x53,-0x3d)](_0x6fefd7(0x92,0x29,0xc0,0x46),_0x6fefd7(0x115,0x10e,0xf7,0x5e)))_0x36e33a=_0x1bf69[_0x6fefd7(0x131,0x156,0xdc,0x138)](_0xdb21aa['OZnNu'],'');else{const _0x328bac=_0x4a9029[_0x374e5e],_0x47f144=(_0x328bac['triggers']||'')[_0x6fefd7(0x28,-0x50,0x44,0xbe)]('|')[_0x47ebb3(-0x53,-0x62,-0x67,-0xc3)](_0x4926ae=>_0x4926ae[_0x47ebb3(-0x147,-0xc5,-0x45,-0x15c)]()!=='');for(const _0x561894 of _0x47f144){if(_0x47ebb3(-0x1c,0x17,0x82,0xaa)===_0xdb21aa[_0x47ebb3(-0xc1,-0xf8,-0x9d,-0xc9)]){if(_0x23062a['toLowerCas'+'e']()[_0x47ebb3(-0x85,-0x8b,-0x134,-0x7b)](_0x561894[_0x6fefd7(0x8e,0xdf,0x91,0x11b)+'e']())){_0xdb21aa[_0x6fefd7(0x19,0x3a,0x4b,0x4)](addLog,'[Banana]\x20F'+_0x6fefd7(0x179,0xbc,0x155,0x116)+_0x47ebb3(-0x51,-0xe8,-0x54,-0x4c)+'r\x20\x22'+_0x561894+(_0x47ebb3(-0x8,-0x10,-0x72,-0x7b)+_0x47ebb3(-0xd,-0x52,-0x39,-0xf3))+_0x374e5e+'\x22.');const _0x307b1a=_0x328bac['conversati'+'on'];if(_0x307b1a){const _0x22c3b3=[];if(_0x307b1a[_0x47ebb3(-0xed,-0xa8,-0xf2,-0x1c)]&&_0x307b1a[_0x47ebb3(-0x57,-0xa8,-0x9f,-0x25)][_0x6fefd7(0x86,0x26,0x9e,0x133)])_0x22c3b3[_0x47ebb3(-0x10f,-0x9a,-0x7f,-0x104)]({'type':_0xdb21aa[_0x47ebb3(-0xfc,-0x75,-0x1c,-0xf5)],'text':_0x307b1a['user'][_0x6fefd7(0xe7,0xcf,0x9e,0x4c)]});const _0x469d0b=await _0xdb21aa[_0x6fefd7(0x1e7,0x150,0x179,0x170)](getImageFromTurnData,_0x307b1a[_0x47ebb3(-0x11d,-0xa8,-0x133,-0x78)]);if(_0x469d0b)_0x22c3b3[_0x47ebb3(-0xbc,-0x9a,-0xc4,-0xa8)]({'type':_0x6fefd7(0x76,0xa6,0xad,0x12b),'image_url':{'url':_0x469d0b}});if(_0x22c3b3['length']>0x1ccb+0x2b*0xca+0x3eb9*-0x1){if(_0xdb21aa[_0x6fefd7(0x6b,0x126,0xbe,0x65)](_0xdb21aa[_0x6fefd7(0x2a,0x56,0x9c,-0x7)],_0xdb21aa[_0x47ebb3(-0x3b,-0xd6,-0x161,-0x158)]))_0x21bae4[_0x47ebb3(-0x191,-0xee,-0xe6,-0x10f)+_0x332424+'\x20Prompt']&&(_0x2edd48=_0xdb21aa[_0x6fefd7(0x20,0x77,0x97,0x8c)](_0xdb21aa['gkVQp'](_0x3e02f4,',\x20'),_0x5434a6[_0x47ebb3(-0x89,-0xee,-0x48,-0x18d)+_0x1ed1fe+_0x47ebb3(-0xd4,-0xb1,-0x156,-0x65)]));else{const _0xb28847={};_0xb28847[_0x47ebb3(-0xf8,-0x70,-0x112,-0x119)]=_0xdb21aa['QLLpi'],_0xb28847[_0x6fefd7(0xc7,0x3f,0x6a,0xfc)]=_0x22c3b3,_0x33141a[_0x47ebb3(-0xda,-0x9a,-0xfe,-0x1c)](_0xb28847);}}const _0x1f4e60=[];if(_0x307b1a['model']&&_0x307b1a[_0x47ebb3(-0x87,-0xb4,-0xcd,-0x108)][_0x47ebb3(-0xb5,-0xc6,-0xa7,-0xc7)])_0x1f4e60[_0x6fefd7(0x57,0x9d,0xca,0x103)]({'type':_0x47ebb3(-0x32,-0xc6,-0x16e,-0x5b),'text':_0x307b1a[_0x47ebb3(-0x1d,-0xb4,-0xf4,-0x23)][_0x6fefd7(0xc2,-0x6,0x9e,0x124)]});const _0x3dc24d=await _0xdb21aa[_0x6fefd7(0x99,0x45,0x83,0xc2)](getImageFromTurnData,_0x307b1a[_0x6fefd7(0xb2,0x31,0xb0,0xb1)]);if(_0x3dc24d)_0x1f4e60[_0x6fefd7(0xfb,0xe3,0xca,0x172)]({'type':_0xdb21aa[_0x47ebb3(-0x78,-0xbf,-0x128,-0xdb)],'image_url':{'url':_0x3dc24d}});if(_0xdb21aa[_0x47ebb3(-0xd1,-0x10e,-0x6d,-0x99)](_0x1f4e60[_0x6fefd7(0x94,0x19a,0x138,0x155)],-0x1*-0xdc+-0x2302+-0x6*-0x5b1)){if(_0xdb21aa[_0x6fefd7(0x103,0x188,0x16b,0x1a9)](_0xdb21aa[_0x6fefd7(0x1ad,0x220,0x178,0xe3)],_0x6fefd7(0x87,0x89,0xe2,0xdc))){const _0x40535d={};_0x40535d[_0x47ebb3(-0x13,-0x70,-0x73,-0xa6)]=_0xdb21aa[_0x6fefd7(0x86,0xf9,0x8c,-0x3)],_0x40535d[_0x6fefd7(0xdc,0x1d,0x6a,0x9d)]=_0x1f4e60,_0x33141a[_0x47ebb3(-0x134,-0x9a,-0x5,-0x31)](_0x40535d);}else{const _0x4535db=_0x1a4213?function(){function _0x1a3a65(_0x564495,_0x3ef7fc,_0x1518e9,_0x1592f8){return _0x47ebb3(_0x3ef7fc,_0x1592f8-0x432,_0x1518e9-0x3a,_0x1592f8-0x22);}if(_0x3f1e3d){const _0x3ac1e3=_0x2cfc63[_0x1a3a65(0x3d1,0x2cb,0x2c7,0x32b)](_0x483017,arguments);return _0xd44e08=null,_0x3ac1e3;}}:function(){};return _0x5132ab=![],_0x4535db;}}}break;}}else{_0xdb21aa[_0x47ebb3(-0x9,0x10,-0x28,-0x7b)](_0x18f170,_0x6fefd7(0x148,0x208,0x164,0xc8)+_0x6fefd7(0xf7,0x46,0xcc,0x85)+':\x20'+_0x1a0648['message']),_0x4f5f3e[_0x47ebb3(-0x43,-0x8d,0xb,-0x11)](_0x47ebb3(0xa8,0x0,-0x2d,0x5a)+_0x47ebb3(-0xf2,-0x98,-0xb5,-0xa8)+':',_0x41bce4);throw _0x2d373e;}}}}}if(!_0x53f0cc[_0x47ebb3(-0x121,-0x8b,-0xb1,-0xc4)](_0xdb21aa[_0x47ebb3(-0x86,-0xab,-0x23,-0x119)])){if(_0xdb21aa[_0x47ebb3(-0x10c,-0x100,-0x84,-0x12b)](_0xdb21aa[_0x47ebb3(0x86,-0x4,-0x1f,0x3c)],_0xdb21aa[_0x6fefd7(0xd6,0xb6,0x87,0x61)])){const _0x48fc8b={};_0x48fc8b['role']=_0xdb21aa[_0x6fefd7(0x17e,0x40,0xe5,0x10c)],_0x48fc8b[_0x47ebb3(-0xb5,-0xfa,-0x6d,-0xb6)]=[{'type':_0xdb21aa['ylwFO'],'text':_0x23062a}],_0x33141a[_0x47ebb3(-0x69,-0x9a,-0x3d,-0xba)](_0x48fc8b);}else _0x2abb0e[_0x490e30][_0x6fefd7(0x67,0x90,0xd1,0x88)][_0x47ebb3(-0x19,-0x1d,-0x1a,-0xa0)]=_0xdb21aa[_0x6fefd7(0xd7,0x178,0xe1,0x15a)](_0x2f4616[_0x37c509][_0x6fefd7(0xd5,0x5d,0xd1,0x82)][_0x6fefd7(0x138,0xdd,0x147,0xa5)],0x3*-0x14d+0x1a66+-0x1*0x167e),_0xdb21aa[_0x47ebb3(-0x95,-0x2a,-0x5c,0x7a)](_0x39175a,_0x6fefd7(0xb3,0xac,0xfc,0xee)+'r\x20prompt:\x20'+_0x51def0[_0x541c71][_0x47ebb3(-0xb3,-0x93,-0x8a,-0x64)]['cishu']);}else{const _0x152ac0=[],_0x598dfc=_0xdb21aa[_0x47ebb3(0x29,-0x3f,0x32,-0xd2)](_0x1e6bc2,_0x23062a),_0x3afc4a=[_0x176793[_0x47ebb3(-0x4d,-0x20,-0xa0,0x65)+'t'],_0x598dfc,_0x176793[_0x47ebb3(-0x2a,-0xbd,-0x1b,-0x139)+_0x47ebb3(-0x13b,-0xc1,-0xbf,-0x135)]]['filter'](Boolean)[_0x47ebb3(0x3f,0x26,-0x6c,0x90)](',\x20'),_0x117c37={};_0x117c37[_0x47ebb3(0x3f,-0x59,-0xc4,-0x1)]=_0xdb21aa[_0x47ebb3(0x30,-0x75,-0x2e,-0x11c)],_0x117c37[_0x47ebb3(-0xdb,-0xc6,-0x1d,-0x74)]=_0x3afc4a,_0x152ac0[_0x47ebb3(-0xde,-0x9a,-0xc5,-0xdf)](_0x117c37);if(_0x284ecb){const _0x4e11c2={};_0x4e11c2[_0x6fefd7(0x25,0x22,0x66,0x106)]=_0x284ecb;const _0x404865={};_0x404865['type']=_0xdb21aa[_0x6fefd7(0x5b,0xfb,0xa5,0x50)],_0x404865[_0x47ebb3(-0x112,-0xb7,-0x32,-0x68)]=_0x4e11c2,_0x152ac0[_0x6fefd7(0x12b,0x15b,0xca,0x6f)](_0x404865),_0xdb21aa[_0x47ebb3(-0xc5,-0xca,-0x127,-0x6a)](addLog,_0x6fefd7(0x61,0x66,0x67,0x55)+_0x6fefd7(0x1a3,0x153,0x12c,0x14f)+_0x6fefd7(0x92,0xf1,0x79,0x8c));}const _0x27076a={};_0x27076a[_0x6fefd7(0xd0,0x134,0xf4,0xa5)]=_0xdb21aa[_0x6fefd7(0x6e,0x5c,0xe5,0x18c)],_0x27076a[_0x6fefd7(-0x1a,0xce,0x6a,0xc3)]=_0x152ac0,_0x33141a[_0x47ebb3(-0xd7,-0x9a,-0x89,-0x13f)](_0x27076a),_0xdb21aa[_0x47ebb3(-0x159,-0x12a,-0xc8,-0x17f)](addLog,'[Banana]\x20修'+_0x47ebb3(-0xda,-0x37,-0x73,-0x88)+_0x3afc4a);}const _0x4ff4b1={};_0x4ff4b1[_0x6fefd7(0x22,-0xc,0x5f,0x106)+'o']=_0x72a5ac;const _0x5b0a68={};_0x5b0a68['imageConfi'+'g']=_0x4ff4b1,_0x59f24a={'model':_0x15d904,'messages':_0x33141a[_0x47ebb3(-0xfc,-0x62,-0x4d,-0x96)](_0x20515a=>_0x20515a[_0x47ebb3(-0x12f,-0xfa,-0xba,-0xbf)][_0x6fefd7(0x123,0xab,0x138,0xfa)]>-0xc1c+-0xbf*0x1d+0x21bf*0x1),'config':_0x5b0a68},_0xdb21aa[_0x6fefd7(0xf7,0x111,0xc9,0x82)](addLog,'[Banana]\x20B'+_0x47ebb3(-0xbd,-0xe9,-0x137,-0x6c)+_0x6fefd7(0x19d,0x1af,0x150,0x1b4)+'oad\x20with\x20'+_0x59f24a[_0x6fefd7(0xa4,0x123,0x145,0xa7)][_0x47ebb3(0x5e,-0x2c,0xd,-0x5a)]+_0x6fefd7(0x12e,0x4d,0xd5,0xb5));}let _0xe96372=_0xf22fff[_0x6fefd7(0xa2,0x75,0xee,0x152)](/\/$/,''),_0x3b636a;if(_0xe96372[_0x6fefd7(0xc6,0x84,0x107,0x153)](_0xdb21aa[_0x47ebb3(-0x43,-0x24,0x7b,-0xba)])||_0xe96372[_0x6fefd7(0xc9,0xab,0xd9,0x136)](_0x6fefd7(0x41,0xc6,0xa9,0x7f)))_0x3b636a=_0xdb21aa[_0x6fefd7(0x73,0x8d,0x97,0xac)](_0xe96372,_0x1493cc);else{if(_0xdb21aa[_0x47ebb3(-0x163,-0x11a,-0xb4,-0xb7)](_0xdb21aa[_0x6fefd7(0x130,0x9a,0xf0,0x14b)],_0xdb21aa[_0x6fefd7(0x127,0x7a,0xf0,0xc2)]))_0x3b636a=_0xdb21aa[_0x47ebb3(0x31,-0x3e,0x35,-0x1a)](_0xe96372+_0xdb21aa[_0x47ebb3(0x4c,-0x24,-0x87,0x23)],_0x1493cc);else{_0xdb21aa['XKXAr'](_0x4d094a,_0x6fefd7(0xf3,0x1a3,0x17c,0x139)+'启动');if(_0x28338a)_0xdb21aa[_0x47ebb3(-0x75,-0xba,-0xa9,-0x73)](_0x325819,'修图指令:\x20'+_0x4bac58);if(_0x24288f)_0xdb21aa[_0x6fefd7(0x97,0xb2,0x4b,0xf1)](_0x20212a,_0x6fefd7(0x1d6,0xbd,0x161,0x164)+']');}}_0x3b636a=_0x3b636a['replace'](/\/v1\/v1\//g,_0xdb21aa['UuFff']),_0xdb21aa['YqYGE'](addLog,_0x47ebb3(-0x1e,0x25,0xac,0x70)+_0x47ebb3(-0x129,-0x110,-0x70,-0x9b)+_0x6fefd7(0x1ac,0x145,0x185,0x107)+_0x3b636a),_0xdb21aa['ZKUdN'](addLog,_0x6fefd7(0x80,0x14b,0xa2,0x58)+_0x47ebb3(-0x2a,-0x8a,-0x3e,-0x12c)+JSON[_0x6fefd7(0x2f,0x155,0xc2,0x10a)](_0x59f24a,null,-0x1*-0x4db+0x1*0x25d9+-0x1*0x2ab2));try{if(_0xdb21aa['keCHn'](_0xdb21aa[_0x6fefd7(0x87,0xf9,0xfb,0x61)],_0x6fefd7(0x1,0x101,0x92,0x135))){const _0x193ce1=await _0xdb21aa[_0x47ebb3(0x68,-0x22,-0xc3,-0x57)](fetch,_0x3b636a,{'method':_0xdb21aa[_0x47ebb3(-0x65,-0xf5,-0x19e,-0xfd)],'headers':{'Content-Type':_0xdb21aa['AkUVd'],'Authorization':_0x47ebb3(-0x103,-0x94,-0xda,-0x95)+_0x593dfd},'body':JSON[_0x47ebb3(0x1,-0xa2,-0xd5,-0x2)](_0x59f24a)});if(!_0x193ce1['ok']){if(_0xdb21aa[_0x6fefd7(0xc2,0x21,0x43,0x86)](_0x47ebb3(-0xbf,-0x2b,-0x2a,-0xc0),_0xdb21aa[_0x47ebb3(-0x168,-0x115,-0x15e,-0x1be)])){const _0x28f706=_0x2842a9['apply'](_0x1b491f,arguments);return _0x57a3db=null,_0x28f706;}else{const _0x5765cb=await _0x193ce1[_0x47ebb3(-0x61,-0xc6,-0xe3,-0x5f)]();throw new Error(_0x6fefd7(0xef,0x68,0xe9,0xdb)+'t\x20failed\x20w'+_0x47ebb3(-0xe7,-0xdc,-0xa3,-0x100)+'\x20'+_0x193ce1[_0x47ebb3(-0x27,-0x25,0x7,-0x77)]+':\x20'+_0x5765cb);}}const _0x544bcd=await _0x193ce1['json']();let _0x403b44='';const _0xd20386=_0x544bcd[_0x6fefd7(0x1c4,0x149,0x130,0x19b)];if(_0xd20386&&_0xdb21aa[_0x47ebb3(-0x1b3,-0x10e,-0xfc,-0xfb)](_0xd20386[_0x47ebb3(0x10,-0x2c,-0x70,-0x4b)],-0x25cc+0xa8f+0x1b3d)){if(_0xdb21aa[_0x47ebb3(-0x6a,-0xb,-0x6c,-0x99)]!==_0xdb21aa['beSRy']){const _0x4c8505=_0xd20386[0x5e*-0x50+0x95d+0x1403][_0x6fefd7(0x178,0x135,0xed,0x9d)]?.[_0x6fefd7(0xef,0xd4,0x6a,0x94)];if(Array['isArray'](_0x4c8505))for(const _0x1bbf60 of _0x4c8505){if(_0xdb21aa[_0x47ebb3(-0xcd,-0xaf,-0xaf,-0x80)](_0x1bbf60[_0x6fefd7(0x111,0x13b,0x10b,0xfa)],_0xdb21aa['NCwMW'])&&_0x1bbf60[_0x47ebb3(-0x108,-0xb7,-0x8e,-0x6d)]?.[_0x47ebb3(-0x197,-0xfe,-0xde,-0x129)]){_0x403b44=_0x1bbf60[_0x6fefd7(0x148,0xee,0xad,0x86)][_0x47ebb3(-0xc6,-0xfe,-0xd0,-0x11e)];break;}}else{if(_0xdb21aa[_0x6fefd7(0xd7,0x47,0xb5,0x70)](typeof _0x4c8505,_0xdb21aa['AhhWD'])){const _0x374bd2=/!\[.*?\]\((https?:\/\/[^\s\)]+)\)/,_0x17665d=_0x4c8505['match'](_0x374bd2);if(_0x17665d&&_0x17665d[0x2*0xf4+0x1*0x18f2+-0x8f3*0x3]){_0xdb21aa['bcYQw'](addLog,_0xdb21aa['yZHGj']);const _0xe5bb0d=_0x17665d[0x1369+0x9ba+0x6*-0x4db];_0xdb21aa[_0x6fefd7(0x5,0x42,0x4b,0x2b)](addLog,_0x47ebb3(-0xba,-0xa3,-0xf8,-0x123)+_0x6fefd7(0x1c0,0x1d9,0x188,0x130)+'age\x20URL:\x20'+_0xe5bb0d);try{const _0x28401f=await _0xdb21aa['XphXp'](fetch,_0xe5bb0d);if(!_0x28401f['ok'])throw new Error(_0x6fefd7(0x9f,0x6c,0x82,0xe1)+_0x47ebb3(-0x144,-0xcc,-0x16b,-0x11a)+_0x47ebb3(-0x11,-0x66,0x38,-0x5e)+_0x28401f[_0x6fefd7(0x9f,0x17a,0x13f,0xb0)]);const _0x229732=await _0x28401f['blob'](),_0x4d1ba8=await new Promise((_0x5796e5,_0x5de09d)=>{const _0x1f26f4=new FileReader();_0x1f26f4[_0x396de5(-0x176,-0x1d6,-0x12f,-0x1f0)]=()=>_0x5796e5(_0x1f26f4['result']);function _0x5dce9f(_0x2fb365,_0x572cf2,_0x230c5b,_0x5045a2){return _0x47ebb3(_0x2fb365,_0x230c5b-0x361,_0x230c5b-0x139,_0x5045a2-0x7d);}_0x1f26f4['onerror']=_0x5de09d;function _0x396de5(_0x4f4be5,_0x22af87,_0x701728,_0x383fef){return _0x6fefd7(_0x4f4be5-0x9f,_0x22af87-0xd1,_0x4f4be5- -0x2c7,_0x701728);}_0x1f26f4[_0x396de5(-0x1e7,-0x1ea,-0x1d3,-0x232)+_0x5dce9f(0x358,0x2da,0x306,0x2dc)](_0x229732);});_0x403b44=_0x4d1ba8,addLog('[Banana]\x20S'+_0x6fefd7(0x11f,0xa0,0xbf,0x8a)+_0x47ebb3(0xd,-0x58,-0x4,-0x95)+_0x47ebb3(-0xca,-0x10a,-0x19b,-0x136)+_0x6fefd7(0x94,0xce,0xe4,0xe2)+_0x47ebb3(-0x6d,-0x67,-0xa4,0x3d));}catch(_0x377741){_0xdb21aa[_0x6fefd7(0xac,0x1cf,0x12b,0x1a8)](addLog,_0x47ebb3(0x3b,0x0,-0x14,-0x65)+_0x6fefd7(0x11f,-0x12,0x7e,0x77)+_0x6fefd7(0xe9,0x14b,0x156,0x1e8)+_0x6fefd7(0x116,0x179,0x10e,0x157)+'\x20'+_0x377741['message']),_0x403b44=_0xe5bb0d,_0xdb21aa[_0x47ebb3(-0x11b,-0x8e,-0x114,0x8)](addLog,_0xdb21aa[_0x6fefd7(0x8d,0xc4,0x3b,0xe0)]);}}else _0xdb21aa[_0x47ebb3(0x19,-0x71,-0x119,0x25)](addLog,_0x47ebb3(-0x99,-0x109,-0x1ad,-0x15f)+_0x6fefd7(0x1e0,0x1bb,0x184,0x1a8)+_0x6fefd7(0x191,0x13d,0x104,0xf9)+_0x6fefd7(-0x50,-0x2,0x58,0xf9)+_0x6fefd7(0x1de,0x11e,0x16a,0x124));}}}else{_0x52e3b0='/v1beta/mo'+_0x47ebb3(-0x96,-0x106,-0x154,-0x17b)+_0x1cad26;const _0x52eaf8={};_0x52eaf8['fixedPromp'+'t']='';const _0x4eb6b0=_0xa2956d[_0x35ae28]||_0x52eaf8,_0x3a9860=[_0x4eb6b0[_0x6fefd7(0xfa,0xf8,0x144,0x16d)+'t'],_0xe86bf9[_0xdb21aa[_0x6fefd7(0x55,0xe2,0x57,0xe3)]],_0x41fe7d[_0xdb21aa[_0x47ebb3(0x5c,-0x3b,0x1a,-0x82)]],_0x349e30,_0x475353[_0xdb21aa[_0x6fefd7(0xcd,0x14e,0x115,0x10a)]],_0x46e553[_0xdb21aa[_0x47ebb3(-0x84,-0xf7,-0x173,-0xaa)]],_0x4eb6b0[_0x47ebb3(-0xb2,-0xbd,-0x6b,-0xe5)+_0x6fefd7(0xfa,0x102,0xa3,0x92)],_0x267d02[_0xdb21aa[_0x47ebb3(-0xa4,-0x6c,0x38,0x37)]]][_0x47ebb3(-0x15,-0x62,-0x6f,-0x48)](_0x131186)[_0x6fefd7(0x114,0x11d,0x18a,0x193)](',\x20');_0xdb21aa['clXoq'](_0x4a9522,_0x6fefd7(0x6d,-0x4a,0x3f,0xa2)+_0x3a9860);const _0x367c11={};_0x367c11[_0x47ebb3(-0x11b,-0xd7,-0x13a,-0x15f)]=_0x3a9860;const _0x484b90={};_0x484b90[_0x6fefd7(0x187,0xe5,0x14a,0x1d3)+'t']=0x1,_0x484b90[_0x6fefd7(0xb5,0x4a,0x5f,-0x19)+'o']=_0x452605;const _0x46b0eb={};_0x46b0eb['instances']=[_0x367c11],_0x46b0eb[_0x47ebb3(-0x21,-0x79,-0x9,-0x4f)]=_0x484b90,_0xde1aa2=_0x46b0eb,_0xdb21aa[_0x47ebb3(0x30,0x5,0x8,0x35)](_0x1d87f7,'[Banana]\x20B'+_0x47ebb3(-0x11b,-0xc3,-0x2d,-0x137)+_0x6fefd7(0x1d,-0x9,0x90,0xf2)+'with\x20promp'+'t:\x20'+_0x3a9860);}}if(!_0x403b44){if(_0xdb21aa[_0x47ebb3(0x12,-0x53,-0x66,-0x9b)](_0xdb21aa[_0x47ebb3(-0xbd,-0xaa,-0x89,-0x4b)],'fSFrh')){const _0x111a81={};_0x111a81[_0x47ebb3(-0xda,-0x59,0x19,-0xc3)]='text',_0x111a81['text']=_0x469560;const _0x40cbe2={};_0x40cbe2['role']=_0xdb21aa['QLLpi'],_0x40cbe2[_0x6fefd7(0x71,0x31,0x6a,0x81)]=[_0x111a81],_0x3f2045['push'](_0x40cbe2);}else throw new Error('API\x20respon'+_0x47ebb3(0x2f,-0x78,-0x107,-0xd)+_0x6fefd7(0xf8,0x148,0xa4,0xf5)+_0x47ebb3(-0x9b,-0x101,-0xc2,-0x15a)+_0x47ebb3(-0x91,0xd,-0x23,0x6b)+'t');}_0xdb21aa[_0x47ebb3(0x17,0x10,-0x48,0x93)](addLog,'[Banana]\x20I'+_0x47ebb3(-0x117,-0x127,-0x118,-0x115)+_0x47ebb3(-0xc5,-0x26,0x37,0x57)+_0x47ebb3(-0x86,-0x1b,-0x8d,-0xb5));const _0x3de5d8={};return _0x3de5d8[_0x6fefd7(0x11e,0xfb,0x176,0x199)]=_0x403b44,_0x3de5d8[_0x47ebb3(-0x47,-0x92,-0x55,-0x54)]=_0x39e735||'',_0x3de5d8;}else _0xdb21aa[_0x47ebb3(-0xe5,-0x119,-0x141,-0x91)](_0x23bcac,_0x47ebb3(0xa,-0x72,0x2e,-0x8a)+'中的\x20prompt。'),_0xde0c7=_0x171de5;}catch(_0xe7bb9f){_0xdb21aa[_0x47ebb3(-0x60,-0x27,-0x51,-0xc6)](addLog,'[Banana]\x20F'+_0x47ebb3(-0x116,-0x98,-0x111,-0xc1)+':\x20'+_0xe7bb9f[_0x6fefd7(0x7a,0x159,0xed,0x14b)]),console[_0x47ebb3(-0xdb,-0x8d,0x10,-0x7b)](_0x47ebb3(-0x85,0x0,-0x60,0x66)+_0x6fefd7(0xf8,0xa8,0xcc,0xf1)+':',_0xe7bb9f);throw _0xe7bb9f;}}export async function bananaGenerate(_0x75cfac){const _0x39e13a={'vBsNj':function(_0x44f772,_0x1fc8fd){return _0x44f772+_0x1fc8fd;},'Dlqyv':function(_0x957cb4,_0x23775b){return _0x957cb4(_0x23775b);},'afVqP':_0x5a060c(0x49a,0x4f5,0x480,0x4b7)+_0x2cdb05(0x5d8,0x505,0x637,0x594),'LGLcd':_0x2cdb05(0x4c6,0x525,0x527,0x4d3)+_0x5a060c(0x3a7,0x360,0x42c,0x3f3),'tJeON':function(_0x26f924,_0x202dc2){return _0x26f924<=_0x202dc2;},'GfrfX':function(_0x3113dc,_0x1395c9){return _0x3113dc+_0x1395c9;},'gINPI':function(_0x553862){return _0x553862();},'qaduy':function(_0x4e7b2e,_0x5443cc){return _0x4e7b2e(_0x5443cc);},'vLLdS':function(_0x4182fb,_0x35ecdd){return _0x4182fb===_0x35ecdd;},'vlYOp':_0x5a060c(0x4b3,0x4c4,0x4fc,0x4ab),'RYhbY':_0x2cdb05(0x516,0x552,0x481,0x4b6),'jBhhG':_0x5a060c(0x4cd,0x4d7,0x502,0x4c3),'RxFWv':function(_0x5f75c8,_0x102eb2){return _0x5f75c8!=_0x102eb2;},'eFPlf':function(_0x2adad0,_0x381685,_0x1597af,_0x18cb34){return _0x2adad0(_0x381685,_0x1597af,_0x18cb34);},'fMZpr':function(_0x4893fe,_0x5ed1e7){return _0x4893fe!==_0x5ed1e7;},'ECsSE':_0x5a060c(0x33d,0x335,0x32e,0x388),'haQxD':function(_0x5328be,_0x5a7101){return _0x5328be+_0x5a7101;},'YJoOS':function(_0x28ba5e,_0x4a757e){return _0x28ba5e(_0x4a757e);},'pHkGM':function(_0xb67799,_0x3d5de0){return _0xb67799(_0x3d5de0);}};_0x39e13a[_0x2cdb05(0x5d9,0x521,0x4e1,0x54c)](clearLog);let {id:_0x55c1,prompt:_0x54ca05,width:_0xc84a10,height:_0x325bee,change:_0x58dedc,retouchPrompt:_0x25788e,retouchImage:_0x5dc689}=_0x75cfac;function _0x2cdb05(_0x15ed5a,_0x1733ab,_0x1e4e48,_0x475e58){return _0x11d3(_0x475e58-0x356,_0x1e4e48);}_0x39e13a[_0x2cdb05(0x5aa,0x5cc,0x65f,0x5c8)](addLog,_0x5a060c(0x3ff,0x3f8,0x3f8,0x393)+_0x5a060c(0x4b1,0x561,0x4d6,0x4b9)+_0x5a060c(0x548,0x538,0x4e3,0x4a7)+_0x5a060c(0x37b,0x3b6,0x367,0x3ab)+_0x5a060c(0x506,0x468,0x41b,0x48f)+_0x55c1+')');let _0x528408='';_0x58dedc?_0x39e13a[_0x2cdb05(0x53d,0x652,0x667,0x5c2)](_0x39e13a[_0x2cdb05(0x5df,0x64d,0x5a9,0x5e2)],_0x39e13a['RYhbY'])?_0x14cd76=_0x39e13a[_0x2cdb05(0x473,0x4dc,0x460,0x4df)](_0x29be4a,_0x921492):_0x528408=_0x58dedc[_0x2cdb05(0x56d,0x533,0x552,0x541)](_0x39e13a[_0x2cdb05(0x5e7,0x604,0x558,0x5cd)],''):_0x528408=_0x54ca05;function _0x5a060c(_0x36b6d7,_0x48cf30,_0x520bbc,_0x12291e){return _0x11d3(_0x12291e-0x229,_0x520bbc);}if(_0x58dedc&&_0x58dedc[_0x5a060c(0x475,0x3a3,0x493,0x411)](_0x2cdb05(0x5fd,0x5ce,0x58f,0x5f0))){addLog(_0x2cdb05(0x566,0x616,0x66d,0x5e1)+'启动');if(_0x25788e)_0x39e13a[_0x5a060c(0x460,0x42a,0x3e6,0x3ee)](addLog,_0x5a060c(0x454,0x340,0x322,0x3b9)+_0x25788e);if(_0x5dc689)_0x39e13a[_0x2cdb05(0x594,0x58e,0x543,0x51b)](addLog,_0x2cdb05(0x625,0x61c,0x666,0x5c6)+']');}try{const {image:_0x5e70d0,change:_0x4b8081}=await _0x39e13a[_0x2cdb05(0x57b,0x63a,0x5d6,0x5c8)](generateBananaImage,{'prompt':_0x54ca05,'width':_0xc84a10,'height':_0x325bee,'change':_0x58dedc,'retouchPrompt':_0x25788e,'retouchImage':_0x5dc689});if(_0x39e13a[_0x5a060c(0x466,0x40f,0x40e,0x480)](extension_settings[extensionName][_0x5a060c(0x3e0,0x488,0x4eb,0x460)],'0')){const _0x9eb73f={};_0x9eb73f[_0x2cdb05(0x510,0x540,0x5c4,0x537)]=_0x528408,await _0x39e13a[_0x2cdb05(0x594,0x4f0,0x4cb,0x572)](setItemImg,_0x54ca05,_0x5e70d0,_0x9eb73f),addLog('图像已存入数据库\x20f'+_0x2cdb05(0x54c,0x535,0x581,0x516)+'\x20'+_0x54ca05);if(extension_settings[extensionName][_0x5a060c(0x448,0x42c,0x414,0x409)]['cishu']){if(_0x39e13a['fMZpr'](_0x39e13a[_0x5a060c(0x41f,0x418,0x4ea,0x4a4)],_0x39e13a[_0x5a060c(0x4c9,0x451,0x4e0,0x4a4)])){_0x39e13a['Dlqyv'](_0x281f92,_0x39e13a['afVqP']),_0x58049=_0x39e13a[_0x5a060c(0x3fd,0x3ac,0x45f,0x3ee)](_0x406b0d,_0xcfafae),_0x250f96=_0x13b233[_0x39e13a[_0x2cdb05(0x5ff,0x5c8,0x546,0x5cb)]];for(let _0x4926c4=0xef8+-0xcf9+-0x1*0x1fe;_0x39e13a[_0x2cdb05(0x525,0x516,0x56e,0x530)](_0x4926c4,0x4*-0x58a+0x1b89+0x55d*-0x1);_0x4926c4++){_0x15be76[_0x2cdb05(0x4e4,0x506,0x53f,0x4db)+_0x4926c4+_0x5a060c(0x403,0x404,0x43a,0x3eb)]&&(_0x1d2227=_0x39e13a[_0x5a060c(0x3f8,0x42d,0x453,0x3b2)](_0x39e13a[_0x5a060c(0x42e,0x3c3,0x45f,0x3cd)](_0xc74067,',\x20'),_0x469f2b[_0x5a060c(0x35f,0x353,0x399,0x3ae)+_0x4926c4+'\x20Prompt']));}}else extension_settings[extensionName][_0x5a060c(0x3f9,0x3cb,0x415,0x409)]['cishu']=_0x39e13a[_0x5a060c(0x3fa,0x47a,0x47d,0x420)](extension_settings[extensionName][_0x5a060c(0x3d2,0x4a0,0x3b2,0x409)][_0x5a060c(0x3e6,0x466,0x4c1,0x47f)],0x18b4+-0x223*0x1+-0x1690),_0x39e13a['YJoOS'](addLog,_0x5a060c(0x470,0x42c,0x4d8,0x434)+_0x5a060c(0x3f4,0x36b,0x407,0x400)+extension_settings[extensionName]['banana'][_0x2cdb05(0x576,0x577,0x600,0x5ac)]);}else extension_settings[extensionName][_0x2cdb05(0x48f,0x540,0x57a,0x536)][_0x2cdb05(0x5de,0x652,0x63d,0x5ac)]=-0x7a*0x16+0x17f2+-0xd75,_0x39e13a[_0x5a060c(0x3e3,0x489,0x457,0x43e)](addLog,_0x2cdb05(0x54e,0x526,0x5f2,0x561)+'r\x20prompt:\x20'+extension_settings[extensionName][_0x5a060c(0x389,0x3c1,0x43d,0x409)][_0x5a060c(0x45b,0x508,0x47a,0x47f)]);}else _0x39e13a['pHkGM'](addLog,_0x2cdb05(0x528,0x4d3,0x4a8,0x540)+'库');const _0x1d936e={};_0x1d936e['id']=_0x55c1,_0x1d936e[_0x5a060c(0x3c2,0x38f,0x3f4,0x3a9)]=!![],_0x1d936e['imageData']=_0x5e70d0,_0x1d936e[_0x2cdb05(0x459,0x594,0x537,0x4f2)]=_0x54ca05,_0x1d936e[_0x2cdb05(0x497,0x5ca,0x4af,0x537)]=_0x528408,eventSource[_0x2cdb05(0x518,0x508,0x463,0x4cd)](EventType[_0x5a060c(0x3bb,0x492,0x3e0,0x3ef)+'MAGE_RESPO'+'NSE'],_0x1d936e),_0x39e13a['qaduy'](addLog,_0x5a060c(0x34e,0x3eb,0x3fd,0x384)+_0x5a060c(0x362,0x3be,0x345,0x3c1)+_0x2cdb05(0x5a0,0x4fe,0x4fb,0x56d)+_0x5a060c(0x432,0x50f,0x4e2,0x46e)+':\x20'+_0x55c1);}catch(_0x175cde){const _0x546d64=_0x5a060c(0x4ba,0x3e6,0x398,0x41e)+_0x5a060c(0x3b3,0x4a4,0x48f,0x448)+_0x5a060c(0x3ec,0x404,0x4da,0x47e)+_0x2cdb05(0x555,0x624,0x521,0x585)+_0x55c1+':\x20'+_0x175cde[_0x5a060c(0x47f,0x4ce,0x4c5,0x425)];_0x39e13a['YJoOS'](addLog,_0x546d64),console[_0x2cdb05(0x4eb,0x57a,0x4bf,0x53c)](_0x546d64);const _0x2d6c43={};_0x2d6c43['id']=_0x55c1,_0x2d6c43['success']=![],_0x2d6c43[_0x5a060c(0x3d0,0x407,0x445,0x40f)]=_0x175cde[_0x5a060c(0x48e,0x46a,0x4a2,0x425)],_0x2d6c43['prompt']=_0x54ca05,eventSource[_0x2cdb05(0x451,0x516,0x515,0x4cd)](EventType['GENERATE_I'+_0x2cdb05(0x4c3,0x4bc,0x490,0x4c6)+'NSE'],_0x2d6c43),addLog(_0x5a060c(0x3f0,0x3cd,0x3a8,0x384)+'mitted\x20fai'+_0x5a060c(0x350,0x3e2,0x3a5,0x3e4)+_0x5a060c(0x3ec,0x40e,0x449,0x46e)+':\x20'+_0x55c1);}}function initializeBananaListener(){function _0x5b5a88(_0x30bbb2,_0x1a6629,_0x2829de,_0x174e3f){return _0x11d3(_0x1a6629- -0x1e2,_0x174e3f);}const _0x5e4773={'RTmQp':function(_0x4752ec,_0x416683){return _0x4752ec(_0x416683);},'KUMKL':_0x34a6f1(0x8e,0xca,0x65,0x167)+_0x5b5a88(-0x60,-0xe,-0xa9,0x11)};function _0x34a6f1(_0x263e90,_0x51a2c7,_0x531e2c,_0x43e22e){return _0x11d3(_0x51a2c7- -0xa1,_0x263e90);}eventSource['on'](EventType[_0x34a6f1(0x19d,0x125,0xb9,0x1a8)+_0x5b5a88(-0x77,-0x93,-0x18,-0xfc)+'ST'],bananaGenerate),_0x5e4773[_0x34a6f1(0x168,0xe3,0x14d,0x72)](addLog,_0x5e4773[_0x5b5a88(0x70,0x54,-0x30,0x35)]);}export async function replaceWithBanana(){const _0x2c847a={'LABoG':function(_0x280402,_0x348af0){return _0x280402(_0x348af0);},'OFThU':'[Banana]\x20生'+_0x1b8af7(0x1b5,0x173,0x137,0x11e),'WRtJq':_0x1b8af7(0x2be,0x27d,0x29f,0x22f),'Jpkxu':function(_0x4a8a6b,_0x47bb0d){return _0x4a8a6b==_0x47bb0d;},'tGWzq':_0x1b8af7(0x23a,0x24b,0x20f,0x1b3),'ReouQ':function(_0x53db7a,_0x64bd72){return _0x53db7a===_0x64bd72;},'FqrNs':_0x1b8af7(0x200,0x1ea,0x187,0x201),'nyTdX':_0x33caa7(0x479,0x3f8,0x439,0x46c),'bWVtp':function(_0x59a44e){return _0x59a44e();},'gaqPM':function(_0x2b7f2f){return _0x2b7f2f();}};function _0x33caa7(_0x342a1b,_0x41cd98,_0x504686,_0x898da8){return _0x11d3(_0x504686-0x209,_0x898da8);}function _0x1b8af7(_0x2e16df,_0xb7e9b3,_0x224596,_0x22e51f){return _0x11d3(_0x22e51f- -0x2d,_0x224596);}_0x2c847a['Jpkxu'](extension_settings[extensionName][_0x1b8af7(0x279,0x2bf,0x1f8,0x21d)],_0x2c847a[_0x1b8af7(0x264,0x135,0x13c,0x1dc)])?_0x2c847a[_0x1b8af7(0x282,0x277,0x229,0x257)](_0x2c847a[_0x1b8af7(0x1da,0x2bc,0x196,0x23d)],_0x2c847a['nyTdX'])?_0x1f3e60[_0x33caa7(0x301,0x348,0x397,0x331)+_0x1b8af7(0xb6,0x1cb,0x14e,0x154)+_0x1b8af7(0x22e,0x284,0x221,0x259)]&&(_0x348b64[_0x33caa7(0x36e,0x441,0x3ae,0x3f4)+'ener'](_0x515db7['GENERATE_I'+_0x1b8af7(0x11e,0x14a,0x155,0x122)+'ST'],_0x4d2222),_0x14df43['forEach'](_0x10a130=>{function _0x3369ee(_0x2b8c6b,_0x56a04f,_0x2d1a5f,_0x200ca3){return _0x33caa7(_0x2b8c6b-0x1e7,_0x56a04f-0x168,_0x2b8c6b- -0x2d5,_0x200ca3);}function _0x4dbd81(_0x327277,_0x20d380,_0x313047,_0x1ad00d){return _0x1b8af7(_0x327277-0x3e,_0x20d380-0x97,_0x313047,_0x1ad00d- -0x27c);}_0x17cec0[_0x3369ee(0xd9,0x162,0x8a,0x12d)+_0x3369ee(0x1ba,0x1a2,0x1e0,0x224)](_0x10a130,_0x1c6f20);}),_0x559755[_0x1b8af7(0x1b5,0x174,0x10e,0x161)+_0x33caa7(0x2e2,0x3cf,0x38a,0x406)+'ener']=![],_0x2c847a[_0x1b8af7(0x1c7,0x19e,0x106,0x194)](_0x3fe10c,_0x2c847a[_0x33caa7(0x3fb,0x3ed,0x3a2,0x326)])):(!window[_0x33caa7(0x33b,0x3df,0x397,0x396)+_0x1b8af7(0x107,0xc0,0x107,0x154)+_0x33caa7(0x516,0x4f0,0x48f,0x4ad)]&&(window['initialize'+_0x1b8af7(0x12a,0x171,0x1f7,0x154)+'ener']=!![],_0x2c847a[_0x1b8af7(0x23f,0x1e7,0x20d,0x1f9)](initializeBananaListener)),_0x2c847a[_0x33caa7(0x3e8,0x51b,0x485,0x431)](initializeImageProcessing)):window[_0x33caa7(0x3c1,0x424,0x397,0x301)+_0x1b8af7(0xe7,0x1db,0x15d,0x154)+_0x33caa7(0x485,0x478,0x48f,0x450)]&&(eventSource[_0x1b8af7(0x199,0xcf,0x106,0x178)+_0x33caa7(0x51f,0x4e1,0x48f,0x4ad)](EventType[_0x33caa7(0x402,0x40b,0x3cf,0x330)+_0x33caa7(0x3b5,0x3bc,0x358,0x3df)+'ST'],bananaGenerate),LEGACY_EVENT_NAMES[_0x33caa7(0x44f,0x3c7,0x3ac,0x3c8)](_0x3f827a=>{function _0x180330(_0x651dc0,_0x2ce857,_0x356b10,_0x3d2bea){return _0x33caa7(_0x651dc0-0x72,_0x2ce857-0x175,_0x356b10- -0x263,_0x651dc0);}function _0x3b1dd0(_0x246628,_0x3fc6f1,_0x2792e7,_0x305cdb){return _0x1b8af7(_0x246628-0xc5,_0x3fc6f1-0x175,_0x305cdb,_0x246628-0x389);}const _0x294956={'fRlNk':function(_0x52b2fc,_0x595101){function _0x1e0d73(_0x282185,_0x530c97,_0x3e0d93,_0x1496f4){return _0x11d3(_0x530c97- -0x6a,_0x282185);}return _0x2c847a[_0x1e0d73(0x1bf,0x157,0x1d8,0x1db)](_0x52b2fc,_0x595101);},'NVpSI':_0x3b1dd0(0x4c7,0x46e,0x488,0x4ff)+_0x180330(0x101,0x202,0x17a,0xee)};_0x3b1dd0(0x56b,0x56e,0x543,0x4d0)===_0x2c847a[_0x180330(0x1d8,0x272,0x1d0,0x1ee)]?(_0x163a14['on'](_0x18469c[_0x3b1dd0(0x522,0x494,0x591,0x54c)+_0x3b1dd0(0x4ab,0x51b,0x4f7,0x45d)+'ST'],_0x87ca97),_0x294956[_0x3b1dd0(0x548,0x53a,0x501,0x566)](_0x88dcdc,_0x294956[_0x180330(0x164,0x1fa,0x1c9,0x20b)])):eventSource[_0x3b1dd0(0x501,0x56f,0x499,0x493)+'ener'](_0x3f827a,bananaGenerate);}),window[_0x33caa7(0x416,0x3fe,0x397,0x38c)+_0x33caa7(0x3ad,0x408,0x38a,0x3ff)+_0x1b8af7(0x301,0x266,0x241,0x259)]=![],_0x2c847a[_0x33caa7(0x327,0x3ec,0x3ca,0x3cc)](addLog,_0x33caa7(0x3f6,0x3c6,0x419,0x37b)+_0x1b8af7(0xb5,0x18c,0xda,0x11e)));}