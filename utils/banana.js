(function(_0x26750b,_0x255af7){function _0x131bc0(_0x536437,_0xab4f5f,_0x3d855a,_0xa6ccae){return _0x344f(_0x536437-0x2d1,_0xa6ccae);}const _0x895c1f=_0x26750b();function _0x1a8f30(_0x109b86,_0x59f4de,_0x128982,_0x1016d6){return _0x344f(_0x128982-0x239,_0x59f4de);}while(!![]){try{const _0x428ab9=parseInt(_0x131bc0(0x4cf,0x54e,0x489,0x47d))/(0x37*0x59+-0x8*0x53+-0x1086)+parseInt(_0x131bc0(0x4b8,0x520,0x521,0x520))/(-0x76a+0x3fa+0x12*0x31)+-parseInt(_0x1a8f30(0x494,0x49f,0x4b4,0x504))/(-0x190f+-0x1f44+0x3856)*(-parseInt(_0x131bc0(0x578,0x5f5,0x5ba,0x5a2))/(-0x10e*-0x19+0xf*0x1bc+-0x2*0x1a2f))+-parseInt(_0x1a8f30(0x423,0x47f,0x477,0x3f4))/(0x1*-0xdf9+0x1*-0x1d67+0x211*0x15)+parseInt(_0x1a8f30(0x42d,0x4c7,0x441,0x40f))/(0x1d67+-0x1*0x1e16+0x1*0xb5)*(parseInt(_0x131bc0(0x4c7,0x50a,0x4d4,0x44d))/(0xa38+-0x1f27+0x14f6))+-parseInt(_0x131bc0(0x540,0x592,0x51e,0x54b))/(-0x2478+0x3a*0x5d+0xf6e)*(-parseInt(_0x1a8f30(0x3d0,0x3e6,0x3ce,0x3a5))/(-0xd1*-0x10+0x197*0x1+-0xe9e))+-parseInt(_0x1a8f30(0x3d8,0x4ab,0x43f,0x3da))/(-0x74b+-0x1*0xe15+-0xab5*-0x2)*(parseInt(_0x131bc0(0x528,0x553,0x4f1,0x4b2))/(-0x599*-0x3+0x1e9d+-0x2f5d*0x1));if(_0x428ab9===_0x255af7)break;else _0x895c1f['push'](_0x895c1f['shift']());}catch(_0x57f496){_0x895c1f['push'](_0x895c1f['shift']());}}}(_0x25f0,0xf86ef+0x1*0xe44d9+-0x158bcd));const _0x484812=(function(){const _0x34173f={};_0x34173f['PCpLH']=_0x400b55(0xb0,0x4c,0xba,0x6b);function _0x400b55(_0x2087f0,_0x46ca5d,_0x52a5b8,_0x56a4f6){return _0x344f(_0x46ca5d- -0x18f,_0x52a5b8);}const _0x7e718=_0x34173f;let _0x42b2d1=!![];return function(_0xf63143,_0x210b57){const _0x2ccc76=_0x42b2d1?function(){function _0x3b8633(_0x32f6d0,_0xe63978,_0x47c12c,_0x5dad50){return _0x344f(_0x47c12c-0x1ce,_0xe63978);}function _0x28bc1d(_0xe234c6,_0x86ebc7,_0xb02cd3,_0xad1796){return _0x344f(_0x86ebc7- -0x2f3,_0xad1796);}if(_0x28bc1d(-0x145,-0x112,-0x13a,-0x141)===_0x7e718[_0x28bc1d(-0x92,-0xdd,-0xfc,-0xf5)]){const _0xe00644={};_0xe00644[_0x28bc1d(-0xa6,-0x113,-0xa9,-0xc9)]=_0x28bc1d(-0xad,-0x88,-0x3d,-0x5f),_0xe00644[_0x3b8633(0x378,0x366,0x37c,0x3ed)]=_0x7ccd7e,_0x2a107a[_0x3b8633(0x463,0x471,0x468,0x45e)](_0xe00644);}else{if(_0x210b57){const _0x1626a5=_0x210b57[_0x3b8633(0x406,0x3f1,0x3c7,0x411)](_0xf63143,arguments);return _0x210b57=null,_0x1626a5;}}}:function(){};return _0x42b2d1=![],_0x2ccc76;};}()),_0x9816f4=_0x484812(this,function(){const _0x521037={};_0x521037[_0xf8a8d2(0x4f8,0x47c,0x48b,0x45c)]='(((.+)+)+)'+'+$';const _0xb4ecd8=_0x521037;function _0x24d8d1(_0x28c3c3,_0x5980fe,_0x8e2fb5,_0x5e8ce1){return _0x344f(_0x28c3c3-0x201,_0x5980fe);}function _0xf8a8d2(_0x21dcac,_0xc05b43,_0x595675,_0x53880e){return _0x344f(_0xc05b43-0x21a,_0x595675);}return _0x9816f4[_0xf8a8d2(0x37f,0x3ba,0x434,0x3b1)]()[_0xf8a8d2(0x499,0x4c0,0x4a2,0x4f2)](_0xb4ecd8[_0xf8a8d2(0x49b,0x47c,0x46c,0x500)])[_0xf8a8d2(0x35b,0x3ba,0x37e,0x433)]()[_0x24d8d1(0x426,0x420,0x48e,0x3cd)+'r'](_0x9816f4)[_0x24d8d1(0x4a7,0x526,0x526,0x500)](_0xb4ecd8[_0xf8a8d2(0x4f5,0x47c,0x4e8,0x41e)]);});_0x9816f4();function _0x25f0(){const _0x8f9491=['Bxb0','w0jHBMfUyv0G55sF','qMfUyw5HtgLZDa','mJyWmZyYs0HhsgHk','C3rHDhvZ','Bw9KzwW','5l+U5zU+5zU+54MhoIbB5BEY5O+q5l6B','rLDAu0W','Bg1TvuG','zML4zwrqCM9TCa','DuLPv1K','Aw9U','Agr3whe','zMfPBgvKigzVCG','DwvZDcb0BZOG','DgLVBIbYzxf1zq','BwvZC2fNzq','uKz1BM4','mtu3nxngsKznwa','lcdPQ5JLUQyGlsa','DgLVBIb3AxrOia','yxbWBhK','zwnLAxzLzcbPBq','C3vJy2vZCW','BwL0DgvKigzHAq','yxnZAxn0yw50','nJGYnJKYsM52A29i','vfnYtMy','ignVBNrHAw4GAq','B3bPtwS','Aw1Hz2vFDxjS','tgn5C0G','BwfNzsbNzw5LCG','zw5KAw5NihjLCq','nZq5mfPYDM9WzG','u2PnquC','mJm0ndHss2Lfsuq','qvbjihjLCxvLCW','tgrMzei','AxrOihn0yxr1CW','qMHyqw0','sKvhu2y','w0jHBMfUyv0GuW','zgf0ytPPBwfNzq','y0nkrvK','yMfUyw5H','DdOG','w0jHBMfUyv0G5zcV','55sO5lQgihVKV67LM759ioAGH+IVHG','5yMn572U5yMn','uenWteG','DuHozu0','teHptxi','v2LMsxO','EfLIwKW','AKvfyLm','ue9tva','5zco572U5zco','EfbAsgO','AfLgtee','Aw5ZDgfUy2vZ','z2vZq2q','BhvYzsbYzxnWBW','CeDjALe','yMrmALO','y29UC3rYDwn0BW','E+s/RUwBVN0','q2PAsKy','DxjS','zfHIsLu','Ce5qruy','t1DcwgO','w0jHBMfUyv0GrG','uLHgCxG','55sO5l+U5zU+6Ake6k6+oIaI','u1zIA1e','uezxB3C','vKfkCuS','C2uGzgLKig5VDa','tvDkEg4','tufhrv9srvfvrq','AxnbCNjHEq','ywn0zxjqCMvZzq','y2fJAgu','vuTzs2i','qxv0Ag9YAxPHDa','s0zguLi','AeDHrNa','BNnL','y2LZAhu','ndmZmti4nxHjvhPNtG','ieLeia','zxrJAcbLCNjVCG','5l+U5zU+5OYh5lUKoIa','qvbjihjLC3bVBG','y2zNAw1NxW','BKjLC1y','zMLSDgvY','qMfUyw5H5l+U5zU+5QIH5BYp','C2zTCMm','C3rYAw5N','BvH6wM0','zvrlt3m','BNrHAw5ZihrLEa','qMHzz0y','u0Dhwey','w0jHBMfUyv0GqG','Dg9mB3DLCKnHCW','w0jHBMfUyv0G5l2/','z2vUzxjHDgvFAq','Aw5JBhvKzxm','Aw1Hz2vjza','vujhDuO','shfeAK8','qwj2CgS','oty0n05cu01UsG','5B2t5yMn55sF5zU+5QYH5PwW5lI6igzV','D2L0AcbWCM9TCa','CIaI','yMfUyw5HioEuN+wBVUs6IW','5zco572U5yMn','AuzjzLy','57Yt5A2y6k6+572U5lI65lIn5A2y5ywL5PwW5O2U','r0zAvNa','w0jHBMfUyv0GuG','ywDLigDLBMvYyq','CMv2s1y','zw1PDa','CIbWCM9TChq6ia','C3nMDwXSEs4','AxfVAxq','tw1myMq','BwfNzs1Yzxf1zq','rMf0AeC','rwrKugC','DxnLCG','q2HHCMfJDgvYia','Du1xtMy','BgvUz3rO','mZKZnZC2vM5sy2rI','DwLSDcbjBwfNzq','rwjVs3y','C2v0ici','y2vZCYbYzxnWBW','55Qe5zU+54Mh','ihWG','t3jms2W','5Qch5yEg5QIH5BYpoIdKVB/NLkJOR7FMSyi','DNnLzhq','B2fKihDPDgGG','BwfNzs1YzxnWBW','ntCYmtLfC0Lny2u','EeHJwu4','uhfoDhO','Aw1Hz2u','BNfKvLG','DhjPz2DLCNm','5Q2J6z2I5O+q56s66k+noIa','BgnftNO','w0jHBMfUyv0Gsq','CwjruKy','Bw9Kzq','Au9TqMm','zxjpDMq','AM9PBG','DcbVBMX5lcbUBW','tLnf','qKLwELC','zxLmse8','Aw1Hz2vU','rgLuBvm','rKjlDwi','u1PZsu4','u2nLBMuGq29TCa','z2vUzxjHDguTAq','BNrkq0S','vgvxuxy','EvfQB3q','w0jHBMfUyv0G5l+U','ig1LC3nHz2vZlG','zxnWB25ZzsbJBW','yxbWBgLJyxrPBW','ChvZAa','w0jHBMfUyv0GrW','zxjYB3i','AuPJrKK','Bw9KzwW6ia','DKLsBgW','DhLWzq','CfjbDxu','CMvWBgfJzufSBa','BI9QC29U','tMjoy0O','kerPDMLKzv9YBW','C2vHCMnO','mtzzD1nJCum','zw5LCG','BwvZC2fNzxm','q1HrCuu','vfjWwLO','uvf4yLG','Aw5PDgLHBgL6zq','zgvSCY8','y29UDMvYC2f0Aq','uNbRqvi','C3bSAxq','B21WBgv0Aw9UCW','5zU+5yop5BEY5A2y5ywL5PwW5O2U5BQtigy','BgPtD24','w0jHBMfUyv0Grq','zw5KC1DPDgG','ntreCLzVvu4','CMvTB3zLtgLZDa','twTgC1u','l3yX','wM1zseW','vgDzDhe','yxnWzwn0uMf0Aq','BNnLigzVCIbjra','u0j5yui','svzXseC','5zU+5lQl5lU255Ur5zcS5zMO5BEY5ywZ6zET44cc','Dg9tDhjPBMC','Be5wq3G','Dfbuz0W','v21wvuS','iIbMCM9TihbYzq','s3rQDeC','6k+35Rgc5Bc65A+4oIdLRR3LUQyGlq','Aw5NihrYAwDNzq','BwTKDha','C3rHCNrZv2L0Aa','yxrLzcbZDwnJzq','5yMn572U5zco','ChjVBxb0','5lIT55QeihbYB21WDooaGG','y29UDgvUDa','CfPnrgu','zM9YrwfJAa','5PYa5zco572U','zwzcwNG','yMfUyw5Hq2HHCG','wMXMCLu','Cg9ZDgzPEfbYBW','BIbWyxLSB2fKia','wvPZzMm','5yIg6kEs6iMY5QIH5BYpoIdOP6pMNPdLUky','ifbYB21WDa','Egfmv0q','ExrQu2G','Aw1Hz2veyxrH','s3PRrwi','l3yXyMv0ys9TBW','su9rwxa','5zU+5QIH5BYp77YA5OYh5lUKid0G','DgfYDgLUzYbPBq','BMnNy1m','y1bOtKW','qNvvDg0','t2Prvfu','DhjPBq','vK9Vr3a','u2LhrM4','AfL5rgG','r3jhDxy','BgvZktOG','q29UDgvUDc1uEq','C2fTCgXLq291BG','vLfxDwC','tufhrv9srvnqtW','C3zVr1u','l3yXl2nOyxqVyW','zw5LCMf0Aw9Uia','BwfNzv9Yzxf1zq','qwXvDue','z3vowvG','zg9LveO','y2HHBMDL','Dgv4Da','DeXXv2i','l3yXlW','CKrcy2W','zMXHDa','u2vzEMK','zNvgwvC','AeTPr2C','CM9Szq','BK5hr1a','5zU+5QIH5BYp77YA5BEY5RE75yQG5B6f5l+U5Ps5','r0vorvjbvevFsq'];_0x25f0=function(){return _0x8f9491;};return _0x25f0();}import{extension_settings}from'../../../../extensions.js';import{eventSource}from'../../../../../script.js';function _0x344f(_0x2d32aa,_0x32afcd){_0x2d32aa=_0x2d32aa-(-0x23e*0x7+-0x4*-0x7f0+0x3a1*-0x4);const _0x22b02c=_0x25f0();let _0x1954f6=_0x22b02c[_0x2d32aa];if(_0x344f['JvdwcH']===undefined){var _0x5986e4=function(_0x58dbb6){const _0x23dbec='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x532877='',_0x45aae7='',_0x36d3e7=_0x532877+_0x5986e4;for(let _0x31df1f=0x412*-0x6+0x929+-0x1*-0xf43,_0x2cb5b1,_0x19ea57,_0x39be4e=0x23d1+-0xb57*-0x1+0xc*-0x3ee;_0x19ea57=_0x58dbb6['charAt'](_0x39be4e++);~_0x19ea57&&(_0x2cb5b1=_0x31df1f%(-0x5f3+0x57*0xd+0x18c*0x1)?_0x2cb5b1*(-0xa0*-0x22+-0x1e2e+0x497*0x2)+_0x19ea57:_0x19ea57,_0x31df1f++%(-0x1218+-0xb46+0x1d62))?_0x532877+=_0x36d3e7['charCodeAt'](_0x39be4e+(0x9cd+0x1*-0x88f+-0x134))-(0x1*-0x7d5+0xf76+-0x797)!==-0x22f5+-0xd89+0x307e*0x1?String['fromCharCode'](-0x1c2*-0x1+0x33a+-0x3fd&_0x2cb5b1>>(-(-0x19b8+-0x26df+0x4099)*_0x31df1f&0x3*0xaac+0x38*0x14+-0x122f*0x2)):_0x31df1f:-0x22d+0x233d+-0x2110){_0x19ea57=_0x23dbec['indexOf'](_0x19ea57);}for(let _0x12a57c=0x1*-0x16e2+-0x11f+0x1801,_0x3ac109=_0x532877['length'];_0x12a57c<_0x3ac109;_0x12a57c++){_0x45aae7+='%'+('00'+_0x532877['charCodeAt'](_0x12a57c)['toString'](0xb2f+0xb04+0x3*-0x761))['slice'](-(0x18d*0x1+0x1fcd*-0x1+0x1e42));}return decodeURIComponent(_0x45aae7);};_0x344f['dIakMb']=_0x5986e4,_0x344f['efoaiG']={},_0x344f['JvdwcH']=!![];}const _0x473b04=_0x22b02c[0x719+0x2dc*0x1+-0x9f5],_0x4614a2=_0x2d32aa+_0x473b04,_0x2a6eb6=_0x344f['efoaiG'][_0x4614a2];if(!_0x2a6eb6){const _0x281744=function(_0x49f017){this['boWLkP']=_0x49f017,this['TYqZQv']=[-0x1*0x26b9+0x401+0x22b9,-0x436*0x1+-0x3*-0x595+-0xc89*0x1,-0x6c+-0xd7c+-0x5*-0x2c8],this['fBhpWJ']=function(){return'newState';},this['QTybEe']='\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*',this['iajcaN']='[\x27|\x22].+[\x27|\x22];?\x20*}';};_0x281744['prototype']['kiySxZ']=function(){const _0x2ac0a0=new RegExp(this['QTybEe']+this['iajcaN']),_0x656834=_0x2ac0a0['test'](this['fBhpWJ']['toString']())?--this['TYqZQv'][-0x1*0x2482+0x39*0x5e+-0x1*-0xf95]:--this['TYqZQv'][-0xa15+0x26fc+-0x1ce7];return this['kWDtxt'](_0x656834);},_0x281744['prototype']['kWDtxt']=function(_0x7261e4){if(!Boolean(~_0x7261e4))return _0x7261e4;return this['zbrUmc'](this['boWLkP']);},_0x281744['prototype']['zbrUmc']=function(_0xee3942){for(let _0x4a4734=0x50a+0xf47*-0x2+0xcc2*0x2,_0x592ea6=this['TYqZQv']['length'];_0x4a4734<_0x592ea6;_0x4a4734++){this['TYqZQv']['push'](Math['round'](Math['random']())),_0x592ea6=this['TYqZQv']['length'];}return _0xee3942(this['TYqZQv'][-0x1*-0x317+0x241b+-0x15a*0x1d]);},new _0x281744(_0x344f)['kiySxZ'](),_0x1954f6=_0x344f['dIakMb'](_0x1954f6),_0x344f['efoaiG'][_0x4614a2]=_0x1954f6;}else _0x1954f6=_0x2a6eb6;return _0x1954f6;}import{extensionName,EventType}from'./config.js';import{sleep,generateRandomSeed,zhengmian,fumian,getRequestHeaders,prompt_replace,addLog,clearLog,parsePromptStringWithCoordinates,prompt_replace_for_character,stripChineseAnnotations}from'./utils.js';import{initializeImageProcessing}from'./iframe.js';import{processCharacterPrompt}from'./characterprompt.js';import{setItemImg}from'./database.js';import{getConfigImage}from'./configDatabase.js';function _0x1b7b7b(_0x3cba9d,_0x17e586,_0x536479,_0x520907){return _0x344f(_0x536479- -0x193,_0x3cba9d);}async function getImageFromTurnData(_0x19566c){const _0x3fa85f={'wdGMh':_0x5da9d1(0x42c,0x439,0x4b7,0x482),'AlUuA':_0x39948a(-0x8f,-0x78,-0x6d,-0xc0),'SVbkQ':function(_0x1bf6c6,_0x4da0a0){return _0x1bf6c6(_0x4da0a0);},'eyLHO':function(_0x20c1ad,_0x154c11){return _0x20c1ad||_0x154c11;},'PFWow':_0x39948a(-0xa6,-0x63,-0x15c,-0xf4),'crHSe':function(_0x1aae79,_0x455fac){return _0x1aae79===_0x455fac;},'vsedt':_0x39948a(-0x19a,-0x14e,-0x126,-0x146)};if(!_0x19566c)return'';function _0x39948a(_0x20ffa5,_0x1fbfce,_0x101aa8,_0x36fc21){return _0x344f(_0x36fc21- -0x303,_0x101aa8);}if(_0x19566c[_0x5da9d1(0x448,0x51d,0x4a0,0x4af)]&&_0x19566c['imageId'][_0x39948a(-0x17e,-0x133,-0xf7,-0x15a)](_0x3fa85f[_0x39948a(-0x14b,-0xce,-0x18e,-0x12f)])){const _0x3df30a=await _0x3fa85f[_0x39948a(-0x87,-0x103,-0x6d,-0xd4)](getConfigImage,_0x19566c['imageId']);return _0x3fa85f[_0x39948a(-0x1b,0x13,-0xd4,-0x77)](_0x3df30a,'');}function _0x5da9d1(_0x4c36db,_0x4399f,_0x3dec21,_0x333862){return _0x344f(_0x333862-0x25c,_0x3dec21);}if(_0x19566c[_0x5da9d1(0x562,0x44e,0x4f9,0x4da)]&&_0x19566c[_0x5da9d1(0x55d,0x483,0x51c,0x4da)][_0x5da9d1(0x38e,0x3a6,0x494,0x405)](_0x3fa85f[_0x5da9d1(0x47a,0x49b,0x464,0x48c)])){if(_0x3fa85f['crHSe'](_0x3fa85f[_0x5da9d1(0x45b,0x466,0x500,0x4d4)],_0x3fa85f[_0x39948a(-0x38,-0x7a,-0xe1,-0x8b)]))return _0x19566c['image'];else _0x1a0542=_0x40a9fe[_0x5da9d1(0x490,0x4ed,0x52d,0x4fe)](_0x3fa85f['wdGMh'],'');}return'';}function _0x9426dc(_0x1cb2e5,_0x3e0c83,_0x213e68,_0xe32463){return _0x344f(_0x213e68- -0x65,_0x1cb2e5);}async function generateBananaImage({prompt:_0x1d3038,width:_0x390240,height:_0x4e5f48,change:_0x3ac563,retouchPrompt:_0x4e6b0d,retouchImage:_0x53eaaf}){const _0x17babc={'ncgcS':function(_0x4c5d16,_0x2afb4b){return _0x4c5d16+_0x2afb4b;},'NbNcJ':function(_0x34ae6d,_0x43a28f){return _0x34ae6d+_0x43a28f;},'pGIjQ':function(_0x363416,_0x1990b2){return _0x363416(_0x1990b2);},'QQxbX':function(_0x1d5f9a,_0x3114a2){return _0x1d5f9a+_0x3114a2;},'vIRll':function(_0x484d83,_0x10ba52){return _0x484d83(_0x10ba52);},'OjQTU':_0x23387e(0x3e4,0x42c,0x40e,0x42d)+'用了\x20{修图}\x20标识'+'。','YZsfc':function(_0x5ad3b3,_0x541f1b){return _0x5ad3b3||_0x541f1b;},'pNPEF':function(_0x2dbc98,_0x2c6204){return _0x2dbc98(_0x2c6204);},'iqoit':_0x23387e(0x3b7,0x3d1,0x369,0x354)+'坐标的提示词字符串。','uMWNf':_0x2c48bb(0x394,0x36f,0x45b,0x3e3)+'osition','hGaFp':function(_0x19bfa4,_0x476db6){return _0x19bfa4<=_0x476db6;},'nUyjy':function(_0x5d1b20,_0x1473d3){return _0x5d1b20+_0x1473d3;},'vQsyy':function(_0x535901){return _0x535901();},'mANny':'generate-i'+_0x2c48bb(0x416,0x3d4,0x353,0x3cc)+_0x2c48bb(0x3c2,0x346,0x381,0x38e),'LcysH':function(_0x2f2ff1,_0x286069){return _0x2f2ff1(_0x286069);},'CXQqE':function(_0x42132e,_0x423a94){return _0x42132e(_0x423a94);},'iOmBc':function(_0x352f51,_0x2292bc){return _0x352f51(_0x2292bc);},'IVqHG':function(_0x4de63a,_0x4b414f){return _0x4de63a(_0x4b414f);},'BuUtm':function(_0x52178d,_0x4f792a){return _0x52178d||_0x4f792a;},'SiGFn':function(_0x26c7ed,_0x3b4d7a){return _0x26c7ed!==_0x3b4d7a;},'opiMk':function(_0x56c5e4,_0x153c32){return _0x56c5e4(_0x153c32);},'xaLWD':function(_0x40b6f9,_0xf92b21){return _0x40b6f9(_0xf92b21);},'lmmUH':function(_0x4c7c56,_0x3ce5bb){return _0x4c7c56(_0x3ce5bb);},'ylSQw':function(_0x5cac45,_0xd015a2){return _0x5cac45===_0xd015a2;},'BIVzW':'zdacb','EddPg':function(_0x272039,_0x126af5){return _0x272039+_0x126af5;},'lNVCx':function(_0x35259e,_0x3e0a53,_0x2c8e57){return _0x35259e(_0x3e0a53,_0x2c8e57);},'erOvd':function(_0x418e17,_0x2fbd37){return _0x418e17===_0x2fbd37;},'WmVUK':'aFSkD','rKmQf':_0x23387e(0x3ef,0x453,0x47a,0x446),'iJcFI':function(_0x337be0,_0xd4b2dd){return _0x337be0+_0xd4b2dd;},'qbQRF':'\x20|\x20','fuFYW':_0x2c48bb(0x3d0,0x440,0x3cc,0x3b1),'PqNtz':_0x2c48bb(0x369,0x2a7,0x3a0,0x331),'bdLjZ':_0x23387e(0x43e,0x42e,0x409,0x466),'xHcYN':'最后置','HqDjO':function(_0x36d11d,_0x5c2e42){return _0x36d11d(_0x5c2e42);},'psZMw':function(_0x32fc01,_0x1cb080){return _0x32fc01(_0x1cb080);},'doeTJ':_0x23387e(0x3ea,0x3b0,0x382,0x36e),'EboKv':'oTLpf','UKYKb':_0x23387e(0x46e,0x43f,0x404,0x3e0),'dXbJU':_0x23387e(0x42b,0x4a7,0x4f5,0x523),'UBGuJ':function(_0x5b1e8a,_0x5ca203){return _0x5b1e8a(_0x5ca203);},'uHNeM':_0x2c48bb(0x2e7,0x27c,0x27b,0x2fd),'lcENz':'后置前','veccn':_0x23387e(0x45a,0x436,0x456,0x465),'BhXAm':_0x2c48bb(0x29e,0x2ab,0x33a,0x32a),'BhYgF':_0x23387e(0x474,0x41b,0x394,0x3b1),'hYFLA':_0x23387e(0x48d,0x423,0x457,0x426),'gZNnP':_0x2c48bb(0x3f9,0x42d,0x432,0x3af),'xYbZL':function(_0x31bacb,_0x5377aa){return _0x31bacb===_0x5377aa;},'SGGXF':'OnPTC','ytjSh':function(_0x16e822,_0x4cb83c){return _0x16e822>_0x4cb83c;},'KgIsp':_0x2c48bb(0x3af,0x335,0x2d1,0x362),'RpkAR':_0x23387e(0x409,0x484,0x43a,0x426),'WnVSf':function(_0x1e31b5,_0x4426e3){return _0x1e31b5>_0x4426e3;},'ZlfrU':_0x23387e(0x470,0x416,0x3b0,0x495),'JEGSf':function(_0x15d02a,_0x1e754d){return _0x15d02a||_0x1e754d;},'uIiWY':function(_0x3997b8,_0x20b2d9){return _0x3997b8+_0x20b2d9;},'nqdVX':_0x2c48bb(0x2e5,0x293,0x374,0x2ea),'SByaB':'/v1/','guNYX':_0x2c48bb(0x406,0x3ce,0x3a4,0x3eb)+_0x2c48bb(0x366,0x370,0x3dc,0x3f5),'oIYRy':function(_0xced1ce,_0x444467){return _0xced1ce===_0x444467;},'WifIz':_0x23387e(0x37b,0x3c8,0x33c,0x3e9),'ljSwn':function(_0x5f36ce,_0x29387c){return _0x5f36ce!==_0x29387c;},'CAYNW':function(_0x28ef48,_0x4c3461){return _0x28ef48===_0x4c3461;},'CWhbb':_0x2c48bb(0x41f,0x3ec,0x3e7,0x39a),'IOQYp':function(_0x29899a,_0x1c22ec){return _0x29899a(_0x1c22ec);},'VQWug':'[Banana]\x20R'+_0x23387e(0x44c,0x4b1,0x425,0x49b)+_0x2c48bb(0x345,0x369,0x31b,0x39d)+_0x2c48bb(0x3b0,0x438,0x3a2,0x3db)+'\x20image.','pRAuu':_0x2c48bb(0x40a,0x3ae,0x420,0x394)+_0x2c48bb(0x3ee,0x3a3,0x34b,0x384)+_0x23387e(0x3e5,0x419,0x49b,0x3e8)+'mage\x20in\x20Op'+'enAI\x20forma'+'t','xPZHj':function(_0x5bcb32,_0x4eaf82){return _0x5bcb32(_0x4eaf82);},'SeYzi':_0x2c48bb(0x44e,0x395,0x369,0x3d5)+_0x23387e(0x4a5,0x41d,0x432,0x479)+_0x23387e(0x3d8,0x3c3,0x44c,0x3a4)+_0x2c48bb(0x353,0x3f4,0x32d,0x3b7),'OWBXj':_0x2c48bb(0x3c2,0x37d,0x36c,0x37e)+_0x23387e(0x443,0x459,0x3fd,0x444)+':'};_0x1d3038=processCharacterPrompt(_0x1d3038),_0x1d3038=await _0x17babc['CXQqE'](stripChineseAnnotations,_0x1d3038);let _0x1cfc20=_0x3ac563;_0x3ac563=processCharacterPrompt(_0x3ac563),_0x3ac563=await _0x17babc[_0x2c48bb(0x439,0x45d,0x35b,0x3d8)](stripChineseAnnotations,_0x3ac563),_0x17babc[_0x23387e(0x3e1,0x3b7,0x39e,0x3aa)](addLog,'开始\x20Banana生'+'图流程。客户端为'+extension_settings[extensionName]['client']),addLog(_0x2c48bb(0x271,0x275,0x364,0x2f8)+'\x20'+_0x17babc[_0x23387e(0x355,0x3d0,0x436,0x3e1)](_0x390240,'默认')+_0x23387e(0x41f,0x410,0x3da,0x419)+_0x17babc[_0x23387e(0x44a,0x3dd,0x42b,0x3a3)](_0x4e5f48,'默认')),_0x1d3038=_0x3ac563&&_0x17babc[_0x23387e(0x3cd,0x3e1,0x456,0x367)](_0x3ac563['trim'](),'')?_0x3ac563:_0x1d3038,_0x17babc[_0x2c48bb(0x330,0x393,0x360,0x353)](addLog,'用于生成的Tag:\x20'+_0x1d3038);let _0x4c479b=![];_0x1d3038[_0x23387e(0x439,0x46b,0x428,0x4bf)](_0x17babc['uMWNf'])&&(_0x4c479b=!![]);_0x17babc[_0x2c48bb(0x2da,0x397,0x360,0x30c)](addLog,'是否启用分角色模式\x20'+_0x23387e(0x4f6,0x4be,0x43f,0x481)+_0x2c48bb(0x2c8,0x386,0x2ee,0x31d)+_0x4c479b);let _0x577746={};function _0x23387e(_0x3df03e,_0x4cbffd,_0x215d00,_0x59b5dc){return _0x344f(_0x4cbffd-0x219,_0x215d00);}let _0x5bfc3a='',_0x46df08='';if(_0x4c479b){_0x17babc[_0x2c48bb(0x2d0,0x340,0x30a,0x33e)](addLog,_0x17babc[_0x23387e(0x434,0x47f,0x50a,0x510)]),_0x577746=parsePromptStringWithCoordinates(_0x1d3038),_0x5bfc3a=_0x577746[_0x17babc[_0x23387e(0x41d,0x486,0x515,0x4ea)]];for(let _0x3d1dcd=0xd76+0xb*-0x277+0xda8;_0x3d1dcd<=0x55b*-0x2+-0x1e76+0x2930;_0x3d1dcd++){_0x17babc['ylSQw'](_0x17babc['BIVzW'],_0x17babc[_0x23387e(0x4fc,0x4a4,0x485,0x515)])?_0x577746[_0x2c48bb(0x34d,0x439,0x3f9,0x3be)+_0x3d1dcd+_0x23387e(0x3ea,0x3d2,0x40c,0x3de)]&&(_0x46df08=_0x17babc['NbNcJ'](_0x17babc[_0x23387e(0x44d,0x483,0x4cb,0x4b9)](_0x46df08,',\x20'),_0x577746[_0x23387e(0x433,0x485,0x4f3,0x40e)+_0x3d1dcd+'\x20Prompt'])):_0x4c975c[_0x2c48bb(0x41b,0x3de,0x409,0x3be)+_0x547ffe+_0x23387e(0x350,0x3d2,0x3ad,0x42d)]&&(_0x378a9a=_0x17babc['ncgcS'](_0x5ba165,',\x20')+_0x2b22fb[_0x2c48bb(0x3e1,0x3b0,0x355,0x3be)+_0x6cb99+'\x20Prompt']);}}else _0x17babc[_0x23387e(0x429,0x443,0x49f,0x3bb)](addLog,'标准模式:\x20使用请求'+'中的\x20prompt。'),_0x5bfc3a=_0x1d3038;let {modifiedPrompt:_0x21fdce,insertions:_0x398a1f}=await _0x17babc[_0x23387e(0x413,0x3ba,0x353,0x3d7)](prompt_replace,_0x5bfc3a,_0x46df08);if(_0x4c479b){if(_0x17babc['erOvd'](_0x17babc[_0x2c48bb(0x294,0x385,0x2fa,0x2f5)],_0x17babc['rKmQf']))for(let _0x169585=0x35+0x192e+-0x876*0x3;_0x169585<=0x1*0x2359+0x2d3*-0x3+-0x1adc;_0x169585++){_0x1baf25[_0x2c48bb(0x3e3,0x39c,0x348,0x3be)+_0x169585+_0x2c48bb(0x357,0x330,0x2dd,0x30b)]&&(_0x2f459f=_0x17babc['ncgcS'](_0x17babc['NbNcJ'](_0x5b85b8,_0x2c48bb(0x3c2,0x398,0x3c2,0x3c7)),_0x17babc[_0x23387e(0x45e,0x43c,0x408,0x41f)](_0x4b7d03,_0x4ccfb7[_0x23387e(0x4bd,0x485,0x509,0x408)+_0x169585+_0x23387e(0x392,0x3d2,0x3aa,0x3db)])));}else for(let _0x2be48e=0x21e*0xd+-0x654+-0x1531;_0x17babc[_0x23387e(0x45d,0x454,0x4ba,0x41e)](_0x2be48e,-0x1*-0x2345+0x1*-0x251a+0x1d9);_0x2be48e++){_0x577746[_0x2c48bb(0x3c3,0x353,0x381,0x3be)+_0x2be48e+'\x20Prompt']&&(_0x21fdce=_0x17babc[_0x23387e(0x4d9,0x4b6,0x495,0x4b4)](_0x21fdce,_0x17babc[_0x23387e(0x50d,0x49d,0x496,0x4ca)])+_0x17babc[_0x2c48bb(0x3cf,0x3da,0x312,0x353)](prompt_replace_for_character,_0x577746['Character\x20'+_0x2be48e+'\x20Prompt']));}}const _0x23fa66=extension_settings[extensionName][_0x2c48bb(0x3cd,0x385,0x3ca,0x363)],{model:_0x30f89f,apiUrl:_0x3735f3,apiKey:_0x5c9f6a,conversationPresets:_0x258c94,conversationPresetId:_0x55524c,editPresetId:_0x545597,aspectRatio:_0x131148}=_0x23fa66;addLog(_0x23387e(0x3e3,0x427,0x42d,0x39e)+_0x23387e(0x398,0x3da,0x360,0x449)+_0x23387e(0x4d8,0x47a,0x3ff,0x44a)+_0x23387e(0x3eb,0x411,0x3e8,0x3cd)+_0x2c48bb(0x3ee,0x3b2,0x390,0x3f0)+_0x30f89f);let _0x3bf070,_0x185879;if(_0x30f89f[_0x2c48bb(0x374,0x2c1,0x2c5,0x2fb)](_0x23387e(0x4b9,0x4a6,0x534,0x4a8))){if(_0x17babc['SiGFn'](_0x17babc[_0x2c48bb(0x2f1,0x318,0x2ff,0x330)],_0x17babc[_0x2c48bb(0x370,0x3d7,0x3ff,0x3cf)])){_0x3bf070=_0x2c48bb(0x33d,0x2c3,0x328,0x310)+_0x23387e(0x345,0x3a5,0x409,0x392)+_0x30f89f;const _0x58ca3c={};_0x58ca3c['fixedPromp'+'t']='';const _0x351829=_0x258c94[_0x55524c]||_0x58ca3c,_0x460bbf=[_0x351829['fixedPromp'+'t'],_0x398a1f[_0x17babc['bdLjZ']],_0x398a1f[_0x23387e(0x35b,0x3c4,0x3f0,0x3b6)],_0x21fdce,_0x398a1f[_0x2c48bb(0x43c,0x328,0x322,0x3ae)],_0x398a1f['后置后'],_0x351829[_0x2c48bb(0x346,0x372,0x2c7,0x307)+_0x2c48bb(0x2c2,0x345,0x375,0x336)],_0x398a1f[_0x17babc[_0x23387e(0x4aa,0x495,0x4a0,0x473)]]][_0x2c48bb(0x3b1,0x3ce,0x417,0x397)](Boolean)[_0x23387e(0x48e,0x4a1,0x4ec,0x44b)](',\x20');_0x17babc['HqDjO'](addLog,_0x2c48bb(0x3dd,0x456,0x3af,0x3d3)+_0x460bbf);const _0x294bce={};_0x294bce[_0x2c48bb(0x37e,0x2ba,0x2ce,0x2fe)]=_0x460bbf;const _0xbaf2e9={};_0xbaf2e9[_0x2c48bb(0x2eb,0x353,0x354,0x31f)+'t']=0x1,_0xbaf2e9[_0x23387e(0x3b9,0x3b4,0x35c,0x39e)+'o']=_0x131148;const _0x50462a={};_0x50462a[_0x2c48bb(0x378,0x3e7,0x348,0x372)]=[_0x294bce],_0x50462a['parameters']=_0xbaf2e9,_0x185879=_0x50462a,_0x17babc['psZMw'](addLog,_0x2c48bb(0x3a9,0x3b9,0x314,0x3a0)+_0x2c48bb(0x357,0x3d8,0x44e,0x3c2)+_0x2c48bb(0x382,0x27c,0x2c7,0x308)+_0x2c48bb(0x3e8,0x3fb,0x41b,0x3ab)+_0x23387e(0x48e,0x42b,0x40f,0x4ab)+_0x460bbf);}else _0x5d5f3f['on'](_0x932c98,_0x10baf7);}else{if(_0x17babc[_0x2c48bb(0x352,0x39a,0x328,0x31a)](_0x17babc[_0x2c48bb(0x2e5,0x32f,0x300,0x328)],_0x17babc[_0x2c48bb(0x336,0x333,0x41b,0x3c3)])){_0x3bf070=_0x2c48bb(0x2f6,0x2c0,0x371,0x323)+_0x2c48bb(0x362,0x2ca,0x300,0x2e2);let _0x147ea4;if(_0x3ac563['includes'](_0x17babc[_0x2c48bb(0x312,0x3eb,0x3ea,0x38a)])){if(_0x23387e(0x433,0x45d,0x427,0x3f4)===_0x17babc[_0x23387e(0x4ba,0x442,0x49b,0x4a2)])_0x21f27e=_0x17babc[_0x2c48bb(0x253,0x368,0x258,0x2dc)](_0x17babc[_0x2c48bb(0x2a0,0x35e,0x279,0x2dc)](_0x2a8d0b,',\x20'),_0x442076[_0x23387e(0x462,0x485,0x46a,0x421)+_0x3f7157+'\x20Prompt']);else{_0x17babc[_0x23387e(0x4ce,0x46d,0x4bf,0x499)](addLog,'[Banana]\x20启'+_0x2c48bb(0x2fd,0x393,0x351,0x366)+'。');const _0x5df087=_0x545597||'默认',_0x4f020a={};_0x4f020a[_0x2c48bb(0x2af,0x280,0x310,0x2df)+'on']=[],_0x4f020a['fixedPromp'+'t']='',_0x147ea4=_0x258c94[_0x5df087]||_0x4f020a,_0x17babc['UBGuJ'](addLog,_0x23387e(0x485,0x469,0x4aa,0x478)+_0x2c48bb(0x361,0x375,0x355,0x380)+_0x5df087+'\x22');}}else{const _0xafe91c={};_0xafe91c[_0x2c48bb(0x317,0x2d4,0x2ca,0x2df)+'on']=[],_0xafe91c[_0x23387e(0x3d9,0x406,0x434,0x497)+'t']='',_0x147ea4=_0x258c94[_0x55524c]||_0xafe91c;}const _0x8db38d=[_0x147ea4['fixedPromp'+'t'],_0x398a1f[_0x17babc[_0x23387e(0x3b7,0x43d,0x3b4,0x453)]],_0x398a1f[_0x17babc[_0x23387e(0x442,0x430,0x47e,0x3c7)]],_0x21fdce,_0x398a1f[_0x17babc[_0x2c48bb(0x38d,0x462,0x460,0x3d4)]],_0x398a1f[_0x17babc['veccn']],_0x147ea4[_0x23387e(0x459,0x3ce,0x3a1,0x447)+_0x23387e(0x39a,0x3fd,0x3bb,0x43d)],_0x398a1f[_0x23387e(0x379,0x3ca,0x362,0x37a)]][_0x23387e(0x416,0x45e,0x3d8,0x4e4)](Boolean)[_0x2c48bb(0x40e,0x42d,0x454,0x3da)](',\x20');_0x17babc[_0x23387e(0x41e,0x3b7,0x3ba,0x34f)](addLog,_0x23387e(0x468,0x49a,0x4bc,0x4dc)+_0x8db38d);const _0x2b41c0={};_0x2b41c0[_0x2c48bb(0x2e9,0x385,0x2e6,0x332)]=_0x23387e(0x496,0x484,0x4cb,0x442),_0x2b41c0[_0x23387e(0x446,0x3c7,0x39b,0x39d)]=[];const _0x34701a={};_0x34701a[_0x23387e(0x3c6,0x3f9,0x3e2,0x3a7)]=_0x2c48bb(0x31d,0x35f,0x377,0x34f),_0x34701a[_0x2c48bb(0x27f,0x2d8,0x352,0x300)]=[];const _0x541901=_0x147ea4[_0x23387e(0x389,0x3a6,0x357,0x430)+'on']['map'](_0x1b5948=>[_0x2b41c0,_0x34701a])[_0x2c48bb(0x328,0x2f9,0x372,0x32e)]();let _0x2dcaf1=-0x70*0x15+-0x7cd*-0x3+0x1*-0xe37;for(const _0x56b7e4 of _0x147ea4[_0x23387e(0x3a1,0x3a6,0x31b,0x332)+'on']){if(_0x56b7e4['user']?.[_0x23387e(0x3df,0x3f1,0x3dc,0x420)])_0x541901[_0x2dcaf1][_0x23387e(0x386,0x3c7,0x3f2,0x3c1)][_0x23387e(0x471,0x4b3,0x42f,0x4d4)]({'type':_0x17babc[_0x23387e(0x39b,0x425,0x486,0x442)],'text':_0x56b7e4['user'][_0x23387e(0x3db,0x3f1,0x3fd,0x39a)]});const _0x134263=await _0x17babc[_0x23387e(0x4be,0x46e,0x441,0x40a)](getImageFromTurnData,_0x56b7e4[_0x23387e(0x4de,0x484,0x4a2,0x47b)]);if(_0x134263)_0x541901[_0x2dcaf1][_0x2c48bb(0x301,0x282,0x2ac,0x300)]['push']({'type':_0x23387e(0x396,0x41b,0x475,0x3a6),'image_url':{'url':_0x134263}});_0x2dcaf1++;if(_0x56b7e4[_0x23387e(0x443,0x402,0x392,0x432)]?.[_0x2c48bb(0x3af,0x374,0x307,0x32a)])_0x541901[_0x2dcaf1][_0x23387e(0x34e,0x3c7,0x342,0x3f3)][_0x2c48bb(0x418,0x3b6,0x420,0x3ec)]({'type':_0x17babc['BhXAm'],'text':_0x56b7e4[_0x2c48bb(0x388,0x308,0x320,0x33b)][_0x23387e(0x38a,0x3f1,0x3ff,0x394)]});const _0x34119e=await _0x17babc[_0x23387e(0x4be,0x4c3,0x50f,0x51e)](getImageFromTurnData,_0x56b7e4[_0x2c48bb(0x3bc,0x3c6,0x2c2,0x33b)]);if(_0x34119e)_0x541901[_0x2dcaf1][_0x2c48bb(0x351,0x2ed,0x38d,0x300)][_0x2c48bb(0x419,0x411,0x426,0x3ec)]({'type':_0x17babc[_0x23387e(0x47d,0x465,0x3d8,0x49f)],'image_url':{'url':_0x34119e}});_0x2dcaf1++;}if(!_0x3ac563[_0x23387e(0x4cc,0x46b,0x3ef,0x4f7)](_0x2c48bb(0x34d,0x39b,0x366,0x378))){if(_0x17babc[_0x2c48bb(0x34b,0x32c,0x2e6,0x371)]!==_0x17babc['gZNnP']){const _0x1de94a=extension_settings[extensionName][_0x2c48bb(0x367,0x284,0x29a,0x305)+_0x23387e(0x45e,0x44f,0x488,0x41b)+'ts']||{};for(const _0xd0d0d1 in _0x1de94a){const _0x3de473=_0x1de94a[_0xd0d0d1],_0x3ed711=(_0x3de473[_0x23387e(0x50f,0x499,0x425,0x436)]||'')[_0x2c48bb(0x332,0x2d7,0x370,0x2e1)]('|')['filter'](_0x5114e1=>_0x5114e1[_0x2c48bb(0x366,0x303,0x2b4,0x318)]()!=='');for(const _0x418484 of _0x3ed711){if(_0x17babc[_0x2c48bb(0x328,0x31c,0x358,0x36c)](_0x23387e(0x4bc,0x431,0x446,0x3e8),_0x23387e(0x352,0x3b3,0x409,0x340)))_0x17babc[_0x23387e(0x42f,0x43c,0x3b3,0x47c)](_0x396e47,_0x23387e(0x3ee,0x477,0x434,0x43f)+'库');else{if(_0x8db38d[_0x2c48bb(0x361,0x3ce,0x42a,0x3a1)+'e']()[_0x23387e(0x448,0x46b,0x42c,0x406)](_0x418484[_0x23387e(0x467,0x468,0x3f2,0x41e)+'e']())){if(_0x17babc[_0x23387e(0x4a1,0x4a0,0x45a,0x41a)](_0x17babc[_0x23387e(0x45f,0x466,0x4d1,0x489)],_0x17babc[_0x2c48bb(0x33a,0x37a,0x3d3,0x39f)])){_0x17babc['xaLWD'](addLog,'[Banana]\x20F'+'ound\x20match'+_0x2c48bb(0x32d,0x2a6,0x279,0x2f9)+_0x2c48bb(0x3d3,0x3fc,0x3da,0x3ac)+_0x418484+(_0x2c48bb(0x358,0x359,0x366,0x2f6)+_0x23387e(0x4ad,0x48b,0x48e,0x50a))+_0xd0d0d1+'\x22.');const _0x3f0f7b=_0x3de473[_0x2c48bb(0x283,0x257,0x32b,0x2df)+'on'];if(_0x3f0f7b){const _0x120004=[];if(_0x3f0f7b[_0x23387e(0x4cb,0x484,0x418,0x443)]&&_0x3f0f7b[_0x23387e(0x513,0x484,0x410,0x3f4)][_0x2c48bb(0x2bd,0x35b,0x38a,0x32a)])_0x120004[_0x23387e(0x50c,0x4b3,0x456,0x4b0)]({'type':_0x17babc[_0x2c48bb(0x3ee,0x32f,0x33c,0x35e)],'text':_0x3f0f7b['user'][_0x2c48bb(0x2ef,0x2a7,0x3ad,0x32a)]});const _0x57e6ff=await _0x17babc[_0x2c48bb(0x3bc,0x3a6,0x33d,0x353)](getImageFromTurnData,_0x3f0f7b[_0x2c48bb(0x39a,0x355,0x372,0x3bd)]);if(_0x57e6ff)_0x120004[_0x2c48bb(0x363,0x444,0x35f,0x3ec)]({'type':_0x23387e(0x40a,0x41b,0x465,0x435),'image_url':{'url':_0x57e6ff}});if(_0x17babc[_0x23387e(0x3c8,0x3d4,0x362,0x381)](_0x120004['length'],0x2437*0x1+0x10ae*-0x1+0x1*-0x1389)){if(_0x17babc[_0x23387e(0x4b8,0x4a0,0x442,0x4a6)](_0x17babc['KgIsp'],_0x2c48bb(0x38f,0x3e3,0x335,0x362))){const _0x14db54={};_0x14db54[_0x2c48bb(0x30f,0x2ec,0x3c1,0x332)]=_0x17babc[_0x2c48bb(0x24f,0x346,0x268,0x2e0)],_0x14db54[_0x23387e(0x42e,0x3c7,0x3fd,0x401)]=_0x120004,_0x541901['push'](_0x14db54);}else{_0x17babc[_0x23387e(0x4d4,0x4b8,0x471,0x4a6)](_0x28d66a,_0x17babc[_0x23387e(0x407,0x3de,0x363,0x41a)]);const _0x52741f=_0x17babc[_0x23387e(0x391,0x3d0,0x38c,0x36d)](_0xcf5ad7,'默认'),_0x39a9aa={};_0x39a9aa[_0x2c48bb(0x34f,0x317,0x2a0,0x2df)+'on']=[],_0x39a9aa[_0x23387e(0x3e4,0x406,0x435,0x448)+'t']='',_0x2bd38e=_0x18888c[_0x52741f]||_0x39a9aa,_0x17babc[_0x2c48bb(0x3e1,0x313,0x383,0x37c)](_0x1c8376,_0x23387e(0x49f,0x469,0x491,0x407)+_0x23387e(0x3d3,0x447,0x3e5,0x3d6)+_0x52741f+'\x22');}}const _0x2ac562=[];if(_0x3f0f7b[_0x2c48bb(0x2d2,0x2b9,0x2f4,0x33b)]&&_0x3f0f7b[_0x2c48bb(0x3a8,0x368,0x2f1,0x33b)][_0x23387e(0x374,0x3f1,0x433,0x459)])_0x2ac562[_0x2c48bb(0x3c4,0x3f0,0x3c4,0x3ec)]({'type':_0x17babc[_0x23387e(0x4b1,0x425,0x447,0x3b2)],'text':_0x3f0f7b[_0x23387e(0x41d,0x402,0x399,0x401)]['text']});const _0x128f53=await _0x17babc[_0x2c48bb(0x2dc,0x2eb,0x2dd,0x355)](getImageFromTurnData,_0x3f0f7b[_0x2c48bb(0x2bc,0x2d8,0x344,0x33b)]);if(_0x128f53)_0x2ac562[_0x2c48bb(0x3e8,0x377,0x44c,0x3ec)]({'type':_0x17babc['BhYgF'],'image_url':{'url':_0x128f53}});if(_0x17babc['WnVSf'](_0x2ac562[_0x23387e(0x45d,0x487,0x4cb,0x433)],0xa8f+0x1*-0x517+-0x578)){const _0x30e62c={};_0x30e62c[_0x2c48bb(0x36a,0x2a7,0x3ad,0x332)]=_0x17babc[_0x23387e(0x352,0x3cd,0x410,0x35a)],_0x30e62c[_0x2c48bb(0x2f2,0x301,0x2ff,0x300)]=_0x2ac562,_0x541901[_0x23387e(0x500,0x4b3,0x521,0x4a7)](_0x30e62c);}}break;}else{_0x35079d(_0x17babc[_0x2c48bb(0x329,0x381,0x42f,0x3b8)]),_0x5f1d22=_0x37fa66(_0x584d73),_0x4b9c4c=_0x3b29c2[_0x17babc[_0x23387e(0x3f7,0x486,0x435,0x3fa)]];for(let _0x36b298=-0x2*-0xc04+-0x1d24+-0x4d*-0x11;_0x17babc['hGaFp'](_0x36b298,0x1*-0x7ac+0x2318+0x8*-0x36d);_0x36b298++){_0x4b0dbb[_0x2c48bb(0x3aa,0x3d2,0x3dc,0x3be)+_0x36b298+'\x20Prompt']&&(_0x3d570f=_0x17babc[_0x2c48bb(0x2e5,0x297,0x2b6,0x314)](_0x17babc['nUyjy'](_0x3d224a,',\x20'),_0x1f8e40['Character\x20'+_0x36b298+_0x2c48bb(0x29b,0x335,0x329,0x30b)]));}}}}}}}else!_0x2d9c91[_0x23387e(0x3c3,0x3a4,0x34c,0x3c1)+_0x23387e(0x383,0x3ff,0x3c8,0x46a)+'ener']&&(_0x4def98[_0x23387e(0x42d,0x3a4,0x359,0x3af)+_0x2c48bb(0x398,0x2ba,0x35b,0x338)+_0x23387e(0x53d,0x4c1,0x457,0x4f8)]=!![],_0x17babc['vQsyy'](_0x18a44e)),_0x17babc['vQsyy'](_0x51b80d);}if(!_0x3ac563[_0x23387e(0x404,0x46b,0x41e,0x4d5)](_0x2c48bb(0x317,0x321,0x3d6,0x378))){const _0x46f0de={};_0x46f0de[_0x23387e(0x540,0x4b9,0x4fc,0x507)]=_0x2c48bb(0x2ce,0x35c,0x2d2,0x32a),_0x46f0de[_0x2c48bb(0x346,0x35d,0x2d5,0x32a)]=_0x8db38d;const _0x29894c={};_0x29894c['role']=_0x17babc[_0x2c48bb(0x30c,0x265,0x2f0,0x2e0)],_0x29894c[_0x23387e(0x380,0x3c7,0x421,0x380)]=[_0x46f0de],_0x541901[_0x23387e(0x51a,0x4b3,0x526,0x4d7)](_0x29894c);}else{const _0x51eacd=[],_0x5ba952=_0x17babc[_0x2c48bb(0x36b,0x31b,0x342,0x35f)](_0x4e6b0d,_0x8db38d),_0x20eef5=[_0x147ea4[_0x23387e(0x45e,0x406,0x3e0,0x45c)+'t'],_0x5ba952,_0x147ea4[_0x2c48bb(0x370,0x35b,0x34e,0x307)+_0x23387e(0x417,0x3fd,0x412,0x429)]][_0x2c48bb(0x315,0x3da,0x3b0,0x397)](Boolean)[_0x23387e(0x439,0x4a1,0x482,0x4c3)](',\x20'),_0x2061ac={};_0x2061ac[_0x23387e(0x479,0x4b9,0x486,0x4b0)]='text',_0x2061ac[_0x23387e(0x39d,0x3f1,0x395,0x3ec)]=_0x20eef5,_0x51eacd[_0x23387e(0x4c9,0x4b3,0x4ff,0x4a7)](_0x2061ac);if(_0x53eaaf){const _0x29e8fa={};_0x29e8fa[_0x23387e(0x40a,0x441,0x432,0x464)]=_0x53eaaf;const _0x91e93f={};_0x91e93f['type']=_0x23387e(0x40e,0x41b,0x3c2,0x441),_0x91e93f['image_url']=_0x29e8fa,_0x51eacd[_0x23387e(0x531,0x4b3,0x539,0x47b)](_0x91e93f),_0x17babc[_0x2c48bb(0x3b5,0x383,0x323,0x3a7)](addLog,_0x2c48bb(0x386,0x387,0x461,0x3e8)+_0x23387e(0x479,0x3fb,0x373,0x37a)+'的图片');}const _0x4cf8c4={};_0x4cf8c4[_0x23387e(0x441,0x3f9,0x45b,0x451)]=_0x17babc[_0x2c48bb(0x25f,0x35a,0x34e,0x2e0)],_0x4cf8c4[_0x23387e(0x33a,0x3c7,0x346,0x371)]=_0x51eacd,_0x541901['push'](_0x4cf8c4),_0x17babc['CXQqE'](addLog,_0x23387e(0x504,0x4af,0x494,0x47c)+'图模式：指令\x20=\x20'+_0x20eef5);}const _0x34e8b7={};_0x34e8b7[_0x2c48bb(0x29d,0x2bf,0x31e,0x2ed)+'o']=_0x131148;const _0x504739={};_0x504739['imageConfi'+'g']=_0x34e8b7,_0x185879={'model':_0x30f89f,'messages':_0x541901[_0x2c48bb(0x366,0x3c2,0x3ed,0x397)](_0x1a51c5=>_0x1a51c5[_0x23387e(0x3ab,0x3c7,0x3a5,0x35e)][_0x2c48bb(0x437,0x334,0x33b,0x3c0)]>0x9a9*0x1+-0xcda+0x331),'config':_0x504739},addLog(_0x2c48bb(0x372,0x405,0x3bb,0x3a0)+'uilt\x20multi'+'modal\x20payl'+_0x2c48bb(0x389,0x3d3,0x3b9,0x3cb)+_0x185879[_0x23387e(0x43d,0x4c2,0x467,0x514)][_0x23387e(0x43a,0x487,0x512,0x3fc)]+_0x2c48bb(0x3ab,0x40f,0x467,0x3e9));}else{const _0x21df5a=_0x2c48bb(0x3a0,0x3c9,0x3ec,0x3ed)+_0x2c48bb(0x328,0x327,0x317,0x324)+_0x2c48bb(0x322,0x2b6,0x369,0x343)+_0x2c48bb(0x39a,0x3d2,0x412,0x391)+_0xcd50e9+':\x20'+_0x2f50aa[_0x2c48bb(0x2ea,0x37d,0x3c6,0x346)];_0x2efd40(_0x21df5a),_0x323e7a[_0x23387e(0x49d,0x4b5,0x4c0,0x518)](_0x21df5a);const _0x5b1e0b={};_0x5b1e0b['id']=_0x4cac19,_0x5b1e0b[_0x2c48bb(0x330,0x36e,0x2f3,0x34d)]=![],_0x5b1e0b[_0x23387e(0x454,0x4b5,0x475,0x52f)]=_0x548755[_0x2c48bb(0x33c,0x399,0x2ee,0x346)],_0x5b1e0b['prompt']=_0x291940,_0x4f3ca4[_0x23387e(0x484,0x47c,0x423,0x4bd)](_0x15d90d[_0x23387e(0x472,0x3fc,0x3f2,0x41f)+_0x23387e(0x3ba,0x3e8,0x463,0x438)+_0x2c48bb(0x3e2,0x406,0x358,0x3dc)],_0x5b1e0b);const _0x315d16={};_0x315d16['id']=_0x45e5f1,_0x315d16[_0x2c48bb(0x35e,0x36d,0x2e5,0x34d)]=![],_0x315d16[_0x2c48bb(0x3b3,0x35e,0x432,0x3ee)]=_0x3493ef['message'],_0x315d16[_0x2c48bb(0x302,0x2b2,0x32e,0x2fe)]=_0x50958c,_0xe4e799[_0x2c48bb(0x33a,0x39c,0x399,0x3b5)](_0x17babc['mANny'],_0x315d16),_0x17babc[_0x2c48bb(0x35c,0x2e9,0x2e2,0x355)](_0x506e2d,_0x23387e(0x3dd,0x3ac,0x32f,0x321)+_0x23387e(0x41f,0x415,0x3fd,0x451)+_0x2c48bb(0x37f,0x403,0x3c1,0x374)+_0x23387e(0x3e4,0x3b5,0x42f,0x440)+':\x20'+_0x51b49c);}}function _0x2c48bb(_0x3c3082,_0x216fff,_0x19b82c,_0x4a428f){return _0x344f(_0x4a428f-0x152,_0x19b82c);}let _0x235ce6=_0x3735f3['replace'](/\/$/,''),_0x55b0a9;_0x235ce6[_0x2c48bb(0x302,0x2f4,0x268,0x2e6)](_0x2c48bb(0x36e,0x295,0x2b0,0x2ea))||_0x235ce6['includes'](_0x23387e(0x417,0x3f3,0x37a,0x418))?_0x55b0a9=_0x17babc[_0x2c48bb(0x37f,0x2b1,0x2cd,0x340)](_0x235ce6,_0x3bf070):_0x55b0a9=_0x17babc[_0x23387e(0x4eb,0x483,0x44e,0x481)](_0x17babc[_0x23387e(0x4ef,0x4bd,0x440,0x4ff)](_0x235ce6,_0x17babc[_0x2c48bb(0x3a9,0x3d6,0x406,0x3d1)]),_0x3bf070);_0x55b0a9=_0x55b0a9['replace'](/\/v1\/v1\//g,_0x17babc[_0x2c48bb(0x356,0x2a1,0x30e,0x2ef)]),addLog('[Banana]\x20S'+_0x2c48bb(0x3a5,0x3dc,0x3cb,0x357)+_0x2c48bb(0x32b,0x306,0x32d,0x344)+_0x55b0a9),_0x17babc[_0x2c48bb(0x35a,0x337,0x339,0x3a6)](addLog,'[Banana]\x20P'+'ayload:\x20'+JSON['stringify'](_0x185879,null,0x53a*0x1+0x233f*0x1+-0x9*0x47f));try{const _0x5402c4={};_0x5402c4[_0x2c48bb(0x344,0x395,0x36e,0x31e)+'pe']=_0x17babc[_0x2c48bb(0x3b3,0x344,0x304,0x327)],_0x5402c4[_0x23387e(0x3dd,0x452,0x44d,0x3e1)+_0x23387e(0x43e,0x408,0x3ab,0x421)]='Bearer\x20'+_0x5c9f6a;const _0x109fad=await fetch(_0x55b0a9,{'method':_0x2c48bb(0x3a6,0x3c7,0x3ab,0x36e),'headers':_0x5402c4,'body':JSON['stringify'](_0x185879)});if(!_0x109fad['ok']){const _0x187497=await _0x109fad[_0x23387e(0x40e,0x3f1,0x45b,0x405)]();throw new Error(_0x2c48bb(0x39d,0x33b,0x30d,0x35b)+'t\x20failed\x20w'+_0x23387e(0x40b,0x424,0x401,0x490)+'\x20'+_0x109fad[_0x23387e(0x402,0x401,0x45b,0x483)]+':\x20'+_0x187497);}const _0x19fadf=await _0x109fad['json']();let _0x36e861='';const _0x499967=_0x19fadf['choices'];if(_0x499967&&_0x499967[_0x2c48bb(0x33c,0x426,0x3c0,0x3c0)]>-0x1b82*0x1+0xa*0x336+-0x26*0x1f){if(_0x17babc['oIYRy'](_0x23387e(0x3d7,0x446,0x47d,0x3e5),'RXFqx')){const _0x301f06=_0x499967[-0x1*-0x1d32+-0x15c4+0x76e*-0x1][_0x2c48bb(0x33a,0x2fd,0x2f8,0x346)]?.['content'];if(Array[_0x2c48bb(0x34f,0x356,0x3f1,0x387)](_0x301f06))for(const _0x3ca0ea of _0x301f06){if(_0x17babc[_0x2c48bb(0x2da,0x37b,0x3aa,0x31a)](_0x17babc[_0x2c48bb(0x35d,0x399,0x30a,0x36b)],_0x23387e(0x376,0x3e9,0x383,0x372))){if(_0x17babc['xYbZL'](_0x3ca0ea[_0x23387e(0x49e,0x4b9,0x4e6,0x4a5)],_0x17babc['BhYgF'])&&_0x3ca0ea[_0x23387e(0x4a5,0x41b,0x443,0x415)]?.[_0x2c48bb(0x3f4,0x391,0x39a,0x37a)]){if(_0x17babc[_0x23387e(0x33e,0x3ab,0x362,0x407)](_0x2c48bb(0x34d,0x3f9,0x34a,0x399),_0x23387e(0x47c,0x440,0x462,0x488))){_0x36e861=_0x3ca0ea['image_url'][_0x2c48bb(0x406,0x304,0x345,0x37a)];break;}else{_0x1a5163(_0x2c48bb(0x337,0x3f7,0x40a,0x37e)+_0x23387e(0x3e7,0x459,0x4da,0x460)+':\x20'+_0x475955[_0x23387e(0x488,0x40d,0x45e,0x48a)]),_0x53120d['error'](_0x23387e(0x46f,0x445,0x462,0x426)+_0x2c48bb(0x3c3,0x32a,0x342,0x392)+':',_0x4c0a14);throw _0x585042;}}}else return _0x5a9433['image'];}else _0x17babc['CAYNW'](typeof _0x301f06,_0x17babc['CWhbb'])&&_0x17babc[_0x2c48bb(0x2eb,0x2c9,0x2f1,0x311)](addLog,_0x17babc[_0x2c48bb(0x330,0x37c,0x349,0x320)]);}else{if(_0xc18721){const _0x483b04=_0x253e9d[_0x2c48bb(0x2f3,0x30b,0x3db,0x34b)](_0x148dd9,arguments);return _0x5dbd1a=null,_0x483b04;}}}if(!_0x36e861)throw new Error(_0x17babc[_0x2c48bb(0x439,0x42f,0x36d,0x3f3)]);return _0x17babc[_0x23387e(0x495,0x437,0x473,0x3a6)](addLog,_0x17babc[_0x23387e(0x43b,0x3f6,0x411,0x487)]),{'image':_0x36e861,'change':_0x17babc[_0x23387e(0x39f,0x3d0,0x3ff,0x37b)](_0x1cfc20,'')};}catch(_0x130999){_0x17babc[_0x2c48bb(0x373,0x37e,0x2ee,0x33e)](addLog,_0x2c48bb(0x357,0x38e,0x2fc,0x37e)+_0x23387e(0x4b1,0x459,0x417,0x3e4)+':\x20'+_0x130999['message']),console[_0x23387e(0x43d,0x4b5,0x523,0x464)](_0x17babc[_0x23387e(0x429,0x444,0x4a8,0x3c8)],_0x130999);throw _0x130999;}}export async function bananaGenerate(_0x4f9874){const _0x4ffadc={'Abvpk':function(_0x253bbb,_0x2a2189){return _0x253bbb(_0x2a2189);},'KtjtG':function(_0xf9de1c,_0x564274){return _0xf9de1c(_0x564274);},'MmLbd':function(_0xd44ad4,_0x2d5751){return _0xd44ad4||_0x2d5751;},'SZsIN':_0x5a057f(0x5b,0x6,-0x89,-0xc),'WbtSy':_0x5a057f(0x4,0x30,0x80,-0x1b),'FathG':function(_0x397e66,_0x549775){return _0x397e66(_0x549775);},'cPhNL':function(_0x1a02b7){return _0x1a02b7();},'mXzZm':_0x140f88(0x521,0x5f7,0x576,0x542),'gesCd':_0x5a057f(0x5e,0x54,0xda,0x10),'ntJCK':function(_0x55dbd8,_0x345b64){return _0x55dbd8(_0x345b64);},'eTKOs':function(_0xa1057a,_0x32b14b){return _0xa1057a(_0x32b14b);},'hdwXq':function(_0x775af3,_0x100b16){return _0x775af3!=_0x100b16;},'mkdtp':function(_0x2b9e5c,_0x154520,_0xe255dc,_0x18292c){return _0x2b9e5c(_0x154520,_0xe255dc,_0x18292c);},'tLqWb':function(_0x43a731,_0x3733ea){return _0x43a731(_0x3733ea);},'TRpZZ':function(_0x5718a2,_0x43ebee){return _0x5718a2===_0x43ebee;},'tPTgL':_0x140f88(0x562,0x547,0x579,0x4f2),'yQjot':function(_0x54cbed,_0xe5e106){return _0x54cbed(_0xe5e106);},'dpcGR':function(_0x3ff74b,_0x2f971c){return _0x3ff74b(_0x2f971c);},'MWJxn':_0x140f88(0x6b2,0x608,0x641,0x5f8)+'mage-respo'+'nse'};_0x4ffadc[_0x140f88(0x559,0x523,0x572,0x4fd)](clearLog);let {id:_0x539004,prompt:_0x52c2ed,width:_0x13f831,height:_0x30e702,change:_0x2e75a9,retouchPrompt:_0x139cde,retouchImage:_0x3aea21}=_0x4f9874;function _0x140f88(_0x4d4aef,_0x5d9c32,_0x194f75,_0x4c4775){return _0x344f(_0x194f75-0x3af,_0x4c4775);}addLog(_0x5a057f(0x1,0x8e,0x97,0x7f)+_0x140f88(0x5a5,0x5b4,0x5a9,0x55c)+'age\x20genera'+_0x140f88(0x512,0x610,0x5a2,0x53b)+'st\x20(ID:\x20'+_0x539004+')');let _0x48075e='';function _0x5a057f(_0x59135e,_0x43a2e6,_0x42fe78,_0x2d9337){return _0x344f(_0x43a2e6- -0x1d2,_0x42fe78);}if(_0x2e75a9){if(_0x140f88(0x520,0x5f7,0x576,0x59f)===_0x4ffadc[_0x5a057f(0xd7,0x77,0x16,-0x14)])_0x48075e=_0x2e75a9[_0x140f88(0x603,0x5e6,0x651,0x605)](_0x4ffadc[_0x140f88(0x5f1,0x622,0x5d0,0x634)],'');else{_0x470283(_0x5a057f(0x100,0x74,0x3b,0x22)+'启动');if(_0x1abb13)_0x4ffadc[_0x5a057f(0xb1,0x84,0x9f,0xc7)](_0x2fcac7,_0x5a057f(-0x3,0x6f,0x77,0x24)+_0x1c24b0);if(_0x2504ce)_0x4ffadc[_0x5a057f(-0x86,-0x2d,-0x6,0x5d)](_0x2151f7,_0x5a057f(0x15,0x18,0x59,0x58)+']');}}else _0x48075e=_0x52c2ed;if(_0x2e75a9&&_0x2e75a9[_0x140f88(0x61b,0x597,0x601,0x5c3)](_0x4ffadc['gesCd'])){_0x4ffadc[_0x140f88(0x694,0x680,0x642,0x6d1)](addLog,_0x5a057f(0x9c,0x74,0xea,0x2b)+'启动');if(_0x139cde)_0x4ffadc[_0x140f88(0x5d6,0x5c1,0x5f9,0x65a)](addLog,_0x5a057f(0xc8,0x6f,0x48,0x41)+_0x139cde);if(_0x3aea21)_0x4ffadc[_0x5a057f(0x14,0x97,0x99,0xa2)](addLog,_0x5a057f(0x3e,0x18,-0x74,-0x21)+']');}try{const {image:_0x205069,change:_0x38005f}=await _0x4ffadc[_0x140f88(0x681,0x5c0,0x618,0x5b4)](generateBananaImage,{'prompt':_0x52c2ed,'width':_0x13f831,'height':_0x30e702,'change':_0x2e75a9,'retouchPrompt':_0x139cde,'retouchImage':_0x3aea21});if(_0x4ffadc[_0x5a057f(0x70,0x1e,-0x55,-0x17)](extension_settings[extensionName][_0x5a057f(-0x1f,0x65,0x3c,0x6d)],'0')){const _0x432986={};_0x432986['change']=_0x48075e,await _0x4ffadc[_0x140f88(0x57e,0x5e4,0x557,0x506)](setItemImg,_0x52c2ed,_0x205069,_0x432986),_0x4ffadc[_0x140f88(0x566,0x5a8,0x554,0x4ee)](addLog,_0x5a057f(0x43,-0x41,-0xbd,-0x50)+'or\x20prompt:'+'\x20'+_0x52c2ed),extension_settings[extensionName][_0x5a057f(0xd0,0x3f,0x89,0x99)][_0x140f88(0x61c,0x616,0x5ec,0x581)]?(extension_settings[extensionName]['banana'][_0x5a057f(-0x5,0x6b,0x1c,0x10)]=extension_settings[extensionName][_0x5a057f(-0x4e,0x3f,0x13,-0x28)][_0x5a057f(0xba,0x6b,0x9f,0xb2)]+(0x2071+-0xc19*-0x2+-0x526*0xb),_0x4ffadc[_0x140f88(0x569,0x58f,0x588,0x583)](addLog,_0x5a057f(0x26,0x86,0x74,0x92)+_0x5a057f(0x9b,0x92,0xb9,0x4c)+extension_settings[extensionName]['banana'][_0x5a057f(-0x1d,0x6b,-0x1d,0xf6)])):(extension_settings[extensionName][_0x5a057f(0x67,0x3f,-0x4f,0x9c)][_0x140f88(0x5ae,0x5bc,0x5ec,0x624)]=0x11df+-0xc*0x106+-0x16*0x41,_0x4ffadc[_0x5a057f(0x95,0xc1,0xef,0xdc)](addLog,_0x140f88(0x684,0x5d3,0x607,0x5d5)+_0x140f88(0x60e,0x621,0x613,0x67c)+extension_settings[extensionName]['banana'][_0x5a057f(-0x2,0x6b,0xed,0xd7)]));}else{if(_0x4ffadc[_0x5a057f(0x14d,0xd9,0x99,0xba)](_0x4ffadc[_0x140f88(0x542,0x53a,0x551,0x5db)],_0x4ffadc[_0x140f88(0x532,0x559,0x551,0x58d)]))_0x4ffadc[_0x5a057f(0x105,0xc3,0x76,0x61)](addLog,'缓存设置为不存入数据'+'库');else{const _0x218d68=[],_0x218ce9=_0x4ffadc[_0x5a057f(0x58,0x95,0xde,0xeb)](_0x5d3083,_0x3a6b26),_0x5a5e57=[_0x1bf6dd[_0x140f88(0x556,0x5e5,0x59c,0x5ec)+'t'],_0x218ce9,_0x107b53[_0x5a057f(0x45,-0x1d,0x21,-0x31)+'mpt']]['filter'](_0x52a599)[_0x140f88(0x606,0x609,0x637,0x5ea)](',\x20'),_0x478747={};_0x478747[_0x5a057f(0x142,0xce,0x118,0xf3)]=_0x4ffadc[_0x5a057f(0xdc,0xbe,0xe1,0x7c)],_0x478747[_0x140f88(0x4ff,0x58c,0x587,0x58a)]=_0x5a5e57,_0x218d68['push'](_0x478747);if(_0x1f83af){const _0x546b42={};_0x546b42[_0x140f88(0x571,0x57a,0x5d7,0x5da)]=_0x4e845f;const _0x2ae606={};_0x2ae606[_0x140f88(0x65e,0x620,0x64f,0x6dc)]=_0x4ffadc['WbtSy'],_0x2ae606[_0x5a057f(0x20,0x30,0xb5,0xa5)]=_0x546b42,_0x218d68[_0x5a057f(0x125,0xc8,0xf3,0x56)](_0x2ae606),_0x4ffadc[_0x5a057f(0x1f,0x84,0xd8,0xae)](_0x4e9142,'[Banana]\x20修'+_0x140f88(0x5a8,0x612,0x591,0x51f)+_0x5a057f(0x10b,0xa2,0xc3,0x5f));}const _0x235cd1={};_0x235cd1[_0x5a057f(0x5d,0xe,0x7c,0x18)]=_0x5a057f(0x112,0x99,0xae,0xc1),_0x235cd1['content']=_0x218d68,_0x1aaa0f[_0x5a057f(0x109,0xc8,0x89,0xcd)](_0x235cd1),_0x4ffadc[_0x5a057f(0xb9,0x97,0xf0,0x74)](_0x1bbe7d,_0x5a057f(0x3b,0xc4,0xb9,0x47)+_0x140f88(0x5cd,0x527,0x56f,0x5d4)+_0x5a5e57);}}const _0x309f36={};_0x309f36['id']=_0x539004,_0x309f36['success']=!![],_0x309f36[_0x5a057f(-0xa4,-0x16,0x1e,0x9)]=_0x205069,_0x309f36[_0x140f88(0x5e8,0x58c,0x55b,0x55e)]=_0x52c2ed,_0x309f36[_0x140f88(0x59b,0x5cd,0x586,0x5c1)]=_0x48075e,eventSource[_0x140f88(0x581,0x58b,0x612,0x59f)](EventType[_0x140f88(0x551,0x593,0x592,0x5c9)+_0x140f88(0x52e,0x5fd,0x57e,0x54b)+_0x140f88(0x5fd,0x6b6,0x639,0x5b4)],_0x309f36);const _0x49ad43={};_0x49ad43['id']=_0x539004,_0x49ad43['success']=!![],_0x49ad43['imageData']=_0x205069,_0x49ad43[_0x5a057f(-0x84,-0x26,-0xa1,-0x78)]=_0x52c2ed,_0x49ad43[_0x5a057f(-0x15,0x5,-0x1e,-0x3a)]=_0x48075e,eventSource['emit'](_0x140f88(0x6a2,0x5e9,0x641,0x5dd)+'mage-respo'+_0x5a057f(0x84,0x6a,0xb6,0x2b),_0x49ad43),_0x4ffadc['dpcGR'](addLog,'[Banana]\x20E'+'mitted\x20suc'+_0x140f88(0x69e,0x6a7,0x622,0x66f)+_0x140f88(0x50d,0x4f0,0x54b,0x56b)+':\x20'+_0x539004);}catch(_0x5a66d8){const _0x275e5f='[Banana]\x20G'+'eneration\x20'+'failed\x20for'+_0x5a057f(0x5,0x6d,0xfd,0x48)+_0x539004+':\x20'+_0x5a66d8[_0x5a057f(0xb2,0x22,0x27,-0x35)];addLog(_0x275e5f),console[_0x5a057f(0x62,0xca,0x47,0x49)](_0x275e5f);const _0x44856f={};_0x44856f['id']=_0x539004,_0x44856f[_0x5a057f(-0x44,0x29,-0xc,0x50)]=![],_0x44856f[_0x5a057f(0xb3,0xca,0x85,0x13d)]=_0x5a66d8[_0x140f88(0x5dd,0x59c,0x5a3,0x532)],_0x44856f[_0x5a057f(-0x63,-0x26,-0xa5,0x31)]=_0x52c2ed,eventSource['emit'](EventType[_0x5a057f(0x46,0x11,-0x1,-0x10)+'MAGE_RESPO'+_0x140f88(0x5e4,0x5cb,0x639,0x6c0)],_0x44856f);const _0x13b7eb={};_0x13b7eb['id']=_0x539004,_0x13b7eb[_0x5a057f(-0x12,0x29,0x49,0xb9)]=![],_0x13b7eb[_0x140f88(0x656,0x6d5,0x64b,0x664)]=_0x5a66d8[_0x140f88(0x57a,0x594,0x5a3,0x568)],_0x13b7eb[_0x5a057f(-0x7c,-0x26,-0x34,0xb)]=_0x52c2ed,eventSource[_0x5a057f(0x3f,0x91,0xbf,0x64)](_0x4ffadc[_0x5a057f(0x18,0x61,0x39,0xd4)],_0x13b7eb),addLog(_0x5a057f(0x38,-0x3f,0x10,-0x8c)+_0x140f88(0x62e,0x5fb,0x5ab,0x543)+_0x140f88(0x588,0x57c,0x5d1,0x647)+_0x140f88(0x4f6,0x5ab,0x54b,0x53e)+':\x20'+_0x539004);}}const LEGACY_EVENT_NAMES=[_0x9426dc(0x1b6,0x2a3,0x22d,0x2b7)+_0x9426dc(0x194,0x1c7,0x203,0x26c)+'st',_0x1b7b7b(0x49,0x136,0xbe,0x57)+_0x1b7b7b(0x18,-0x3c,0x40,0x42)+'st'];function initializeBananaListener(){const _0x37556b={'efBZx':function(_0x1c2368,_0x66f311){return _0x1c2368(_0x66f311);},'ZmYHL':_0x54e518(0x4e,-0x13,-0x26,0x83)+'件监听器已初始化。'};eventSource['on'](EventType[_0xddc089(-0x12f,-0x128,-0xd3,-0x185)+'MAGE_REQUE'+'ST'],bananaGenerate);function _0x54e518(_0xdecc12,_0x162987,_0x3c1fc5,_0x43a2ce){return _0x1b7b7b(_0x43a2ce,_0x162987-0x52,_0xdecc12- -0x7a,_0x43a2ce-0x108);}function _0xddc089(_0x30822e,_0x49de54,_0x5e906d,_0x5f541b){return _0x1b7b7b(_0x5f541b,_0x49de54-0x197,_0x30822e- -0x17f,_0x5f541b-0x18d);}LEGACY_EVENT_NAMES[_0x54e518(-0x5d,-0x77,0x14,-0xb5)](_0x3b84f5=>{eventSource['on'](_0x3b84f5,bananaGenerate);}),_0x37556b[_0x54e518(-0x5b,-0xb8,0x11,-0x3d)](addLog,_0x37556b[_0xddc089(-0x179,-0x198,-0x1c6,-0x1d2)]);}export async function replaceWithBanana(){function _0x1a23d9(_0x272926,_0x1baa79,_0x2c916b,_0x35ac5e){return _0x9426dc(_0x2c916b,_0x1baa79-0x6a,_0x272926- -0x3f,_0x35ac5e-0xdf);}function _0x16b93e(_0x3d473f,_0x46dc4a,_0x561126,_0x1bf667){return _0x1b7b7b(_0x3d473f,_0x46dc4a-0x126,_0x561126- -0x17d,_0x1bf667-0x54);}const _0x509c22={'OrLKl':function(_0xd8635d,_0x3285d3){return _0xd8635d(_0x3285d3);},'VAJqK':_0x1a23d9(0x1d3,0x1c4,0x202,0x1f7)+_0x1a23d9(0x109,0x7b,0xd6,0xfe),'TSrNf':function(_0x4b85b5,_0x2d8220){return _0x4b85b5===_0x2d8220;},'SjMAG':_0x1a23d9(0x1eb,0x25f,0x186,0x181),'hYyDh':function(_0x4f07db,_0x47108f){return _0x4f07db==_0x47108f;},'RFunn':function(_0x318837){return _0x318837();},'jEEbS':_0x16b93e(-0x156,-0x146,-0x12b,-0x141)+_0x1a23d9(0xfb,0xcd,0x137,0x10c)};_0x509c22[_0x16b93e(-0xe1,-0x143,-0x147,-0x128)](extension_settings[extensionName][_0x16b93e(-0x4e,-0x8c,-0x8b,-0x6f)],_0x1a23d9(0x16d,0x1e5,0x144,0x1a4))?(!window[_0x1a23d9(0xe7,0x154,0xf1,0x16a)+_0x1a23d9(0x142,0x13f,0x121,0xf2)+'ener']&&(window[_0x16b93e(-0x159,-0x183,-0x185,-0x17b)+_0x1a23d9(0x142,0x1c4,0x143,0xef)+_0x16b93e(-0x73,-0x6a,-0x68,-0x64)]=!![],_0x509c22[_0x1a23d9(0x151,0x107,0x146,0x1d3)](initializeBananaListener)),initializeImageProcessing()):window[_0x16b93e(-0x1b3,-0x1af,-0x185,-0x1bf)+'BananaList'+_0x1a23d9(0x204,0x1dd,0x182,0x18c)]&&(eventSource['removeList'+_0x1a23d9(0x204,0x214,0x1f9,0x25a)](EventType[_0x1a23d9(0x13f,0xf1,0x172,0x12f)+_0x16b93e(-0x110,-0x9f,-0xdc,-0x152)+'ST'],bananaGenerate),LEGACY_EVENT_NAMES[_0x16b93e(-0x1e0,-0x188,-0x160,-0xeb)](_0xa8c083=>{function _0x53fbd8(_0x7fb8b9,_0x24f54b,_0x23bca5,_0x389e9f){return _0x16b93e(_0x24f54b,_0x24f54b-0x189,_0x389e9f-0x23f,_0x389e9f-0x2c);}function _0x28808b(_0x4e3993,_0x32fa6e,_0x50bfe3,_0x254279){return _0x1a23d9(_0x4e3993- -0x11d,_0x32fa6e-0x1d2,_0x254279,_0x254279-0x75);}const _0xaf53b2={'TeWQv':function(_0xd255c3,_0x2483f5){function _0x831450(_0x7dff1e,_0x42b272,_0x35a83a,_0xf419bb){return _0x344f(_0xf419bb- -0x147,_0x42b272);}return _0x509c22[_0x831450(0xcc,0xbe,0x152,0x12f)](_0xd255c3,_0x2483f5);},'FWZSL':_0x509c22[_0x28808b(0x70,0x6e,0xc2,0x0)]};_0x509c22[_0x28808b(0x3e,-0x4e,0xbd,0x26)](_0x509c22['SjMAG'],_0x509c22[_0x28808b(0x46,0x51,0x92,0xbd)])?eventSource[_0x28808b(-0x2b,-0x45,-0x7b,-0x38)+_0x28808b(0xe7,0xa0,0xc2,0x173)](_0xa8c083,bananaGenerate):(_0xaf53b2[_0x53fbd8(0x13c,0x1b3,0x16c,0x1c3)](_0x3f0f3f,_0xaf53b2[_0x28808b(0x2a,-0x5e,-0x47,0x5d)]),_0x86c7f7=_0x2f2c70);}),window['initialize'+_0x16b93e(-0xdb,-0x158,-0x12a,-0x183)+'ener']=![],addLog(_0x509c22[_0x1a23d9(0x177,0x110,0x1d3,0x185)]));}