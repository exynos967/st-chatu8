(function(_0x9f9ae3,_0x46b58d){function _0x25e35d(_0x1ef9b7,_0x12c66e,_0x2c13b2,_0x124b6a){return _0xe158(_0x12c66e-0x327,_0x124b6a);}function _0x52b3a6(_0x33a355,_0x1ae58f,_0x5eea09,_0x126cc3){return _0xe158(_0x1ae58f- -0x26c,_0x33a355);}const _0xbc0a0=_0x9f9ae3();while(!![]){try{const _0x575e76=parseInt(_0x25e35d(0x49e,0x44a,0x43e,0x47f))/(-0x1722+0x1220+0x503)*(parseInt(_0x25e35d(0x538,0x4ab,0x491,0x4fd))/(-0x1661+0x1*-0x1f30+0x41f*0xd))+-parseInt(_0x25e35d(0x48a,0x4f2,0x56d,0x54b))/(-0x8af+-0x18e5+-0x1*-0x2197)+parseInt(_0x52b3a6(-0x209,-0x17f,-0x132,-0xff))/(0x5f5+-0xce5*-0x3+-0x2ca0)+parseInt(_0x25e35d(0x4fc,0x4b6,0x512,0x4a8))/(-0x22e7*-0x1+-0xf62*-0x2+-0xaf1*0x6)+parseInt(_0x52b3a6(-0x135,-0x185,-0xfe,-0x15e))/(0x25cf+0x2169+-0x4732)+-parseInt(_0x52b3a6(-0x1d1,-0x174,-0x197,-0x1dd))/(0xf4c+0x6c2+-0x1*0x1607)*(-parseInt(_0x52b3a6(-0xf1,-0xfc,-0x151,-0x169))/(-0x905*-0x3+-0x36f+-0x1798))+-parseInt(_0x25e35d(0x4a0,0x48b,0x461,0x4a9))/(-0x1694+0x1ab2+-0x37*0x13);if(_0x575e76===_0x46b58d)break;else _0xbc0a0['push'](_0xbc0a0['shift']());}catch(_0x4e789a){_0xbc0a0['push'](_0xbc0a0['shift']());}}}(_0x18dc,-0x4ab*0x2f+-0x81b81+-0x138613*-0x1));const _0x580d89=(function(){let _0x1d6e8d=!![];return function(_0x1ed203,_0x50fcd1){const _0x486371=_0x1d6e8d?function(){function _0x1403c6(_0x275f8b,_0x3405a1,_0xeef935,_0x46e14e){return _0xe158(_0x46e14e- -0x220,_0x275f8b);}if(_0x50fcd1){const _0x42fbf8=_0x50fcd1[_0x1403c6(-0x156,-0x72,-0x11b,-0x102)](_0x1ed203,arguments);return _0x50fcd1=null,_0x42fbf8;}}:function(){};return _0x1d6e8d=![],_0x486371;};}()),_0x7bb2a9=_0x580d89(this,function(){function _0x377717(_0x205baa,_0x2f59f1,_0x229376,_0x5bf2be){return _0xe158(_0x229376- -0x1ca,_0x5bf2be);}function _0x123dd1(_0x19960c,_0x3238e6,_0x35325a,_0x120245){return _0xe158(_0x19960c- -0xf2,_0x35325a);}return _0x7bb2a9[_0x123dd1(0x10,-0x1,-0x5e,-0x28)]()['search'](_0x377717(0x2e,-0x8e,-0x2f,-0xaf)+'+$')[_0x123dd1(0x10,0x20,-0x10,0x27)]()['constructo'+'r'](_0x7bb2a9)[_0x377717(-0x67,-0x5b,-0xb8,-0xc2)](_0x123dd1(0xa9,0xa1,0xbc,0x101)+'+$');});_0x7bb2a9();import{extension_settings}from'../../../../extensions.js';import{eventSource}from'../../../../../script.js';import{extensionName,EventType}from'./config.js';import{sleep,generateRandomSeed,zhengmian,fumian,getRequestHeaders,prompt_replace,addLog,clearLog,parsePromptStringWithCoordinates,prompt_replace_for_character,stripChineseAnnotations,waitForLock,releaseLock,acquireLock}from'./utils.js';function _0x591cb3(_0x42d011,_0x59edfa,_0x53cbbb,_0x1157f5){return _0xe158(_0x1157f5-0x30f,_0x59edfa);}import{initializeImageProcessing}from'./iframe.js';function _0x18dc(){const _0x8cd432=['5Q2J6z2I5O+q56s66k+noIa','zw5KAw5NihjLCq','BwvZC2fNzq','yvbNugS','C2vHCMnO','y1DiDee','u1jkCMS','BwfW','y2zNAw1NxW','C3qGkeLeoIa','l3yX','v25Jq1y','DgLVBIbYzxf1zq','u3D0C28','yKP3yw0','BhvYzsbYzxnWBW','yxbWBhK','BwfNzsbPBIbpCa','zvfqAfu','BwL0DgvKigzHAq','D0nODwe','ntaXmtfeuvLOzM4','ugnNq0W','zgvSCY8','y2jluvC','qvbjihjLCxvLCW','C3rYAw5N','B3vUzcbTyxrJAa','5PYa5zco572U','ten0wKG','Buz0Aei','qvzMBuO','q2HHCMfJDgvYia','y29UDgvUDa','kerPDMLKzv9YBW','EhbszeW','Aw1Hz2vjza','r0vorvjbvevFsq','ywDLigDLBMvYyq','C2vlvfq','vxrnweO','C2v0ici','w0jHBMfUyv0Gua','l3yXlW','qMfUyw5HtgLZDa','Aw5PDgLHBgL6zq','A3D5D1y','yxnZAxn0yw50','EuzfAhG','ue9tva','w0jHBMfUyv0GrG','Aw1Hz2vdB25MAq','lcdPQ5JLUQyGlsa','rKXJALi','qMfUyw5H5l+U5zU+5QIH5BYp','vMXHvge','uMDgvxm','CMvWBgfJzq','txzjyK4','CMvWBgfJzufSBa','55sO5l+U5zU+6Ake6k6+oIaI','Aw10rNC','y2DUuLG','5yIg6kEs6iMY5QIH5BYpoIdOP6pMNPdLUky','E+s/RUwBVN0','De92Cfy','yxbWBgLJyxrPBW','EffMshu','Aw5ZDgfUy2vZ','r2vurNe','BNrHAw5ZihrLEa','CIbWCM9TChq6ia','zhfuvuq','5zco572U5yMn','BuHorhy','DwvZDcb0BZOG','BxDfr2i','BgvUz3rO','C3rHCNrZv2L0Aa','z0Hqz1e','DdOG','CeHZzLO','w0jHBMfUyv0GqG','v1jlu3O','uLP0DMe','EwjKywO','mtmXnJC1mtnUwfzVBuq','AM9PBG','u2nLBMuGq29TCa','zw5bssbMB3jTyq','r2PgrgO','EhPqu1i','EgTkuwq','tfvwtfm','Dg9mB3DLCKnHCW','Dgv4Da','swHgD3K','BgvZktOG','nZj5sNf6v1G','zK5ks0W','BwfNzsbNzw5LCG','Axffuu0','BwfNzs1Yzxf1zq','qNj3tvO','qK93ywe','AvrNsNG','tufhrv9srvnqtW','B3nPDgLVBG','zuXQtva','ze5mtMK','Aw1Hz2vU','zxjYB3i','igLTywDLlG','uKnPC04','CuTWAMC','yxnWzwn0uMf0Aq','uePOC3q','w0jHBMfUyv0G5l2/','mMP1uvf6wq','vKHsu3C','z2vUzxjHDgvFAq','5Qch5yEg5QIH5BYpoIdKVB/NLkJOR7FMSyi','wLDOzvu','zLb4Cgq','yNPYDKG','tNDwwgq','vNz4s1C','tufhrv9srvfvrq','yMfUyw5H','mJi2ndK3nxnouhjjqq','BI9QC29U','C3fQBgq','y1fWA3q','zxnWB25ZzsbJBW','DxnLCG','yxrLzcbZDwnJzq','vNjTA04','v1vJz3G','B21WBgv0Aw9UCW','DxjS','qKv4tK8','kcGOlISPkYKRkq','C3vJy2vZCW','C3rYAw5NAwz5','BxrdENa','zLbbt2q','zML4zwrqCM9TCa','5B2t5yMn55sF5zU+5QYH5PwW5lI6igzV','CM9Szq','r3j2Au0','rgzwr0K','y2HHBMDL','Bw9KzwW','qvbjihjLC3bVBG','zMXHDa','w0jHBMfUyv0GuG','shzksvi','y2XPzw50','tNbnrfe','uwjswe0','uK9XtwW','zMD4qNi','BNnLigzVCIbjra','tLnf','55sO5lQgihVKV67LM759ioAGH+IVHG','qLztr2e','Cg9ZDgzPEfbYBW','u0jvANq','DcbVBMX5lcbUBW','AxrOihn0yxr1CW','5BYa5AEliejHBMfUyEEuNW','Bxb0','AeLksem','Den5B28','Bfzcwvq','C3bSAxq','zgfxzNO','qNfXB3q','z0rfBvK','55Qe5zU+54Mh','CgfYyw1LDgvYCW','sKzlDha','C3rHDhvZ','zw5LCG','D2L0AcbWCM9TCa','5zU+5QIH5BYp77YA5BEY5RE75yQG5B6f5l+U5Ps5','zw5KC1DPDgG','D2XPwgW','Aw5NihrYAwDNzq','mZCYnJq3n2nYBMrmsa','DMPgCK8','Afn0uhO','ELPmzey','zNDntvO','w0jHBMfUyv0G5l+U','yKvoB3O','Bw9KzwW6ia','DMfQDeC','yxLSB2fKoIa','AKTmDwq','EvLxB0S','y2vZCYbYzxnWBW','ANnVBG','y1H6rNm','Aw1Hz2u','DwLSDcbTDwX0Aq','zgTxAMi','BxLVwhO','BwzLyMS','rez2qxe','l3yXl2nOyxqVyW','AxnbCNjHEq','5PIV5zcM5zcV55sO5yIg6kEs6iMY5QIH5BYpia','Eev6ExK','wMnVzw8','zM9YrwfJAa','Bw9Kzq','5z2q5Qch55Qe5O+q56s66k+n5A2x56YM5lIY44cc','zgf0ytPPBwfNzq','w0jHBMfUyv0GuW','zvH1sxC','iIbMCM9TihbYzq','sMPyC2K','C2fTCgXLq291BG','wvD6s00','t3P3Bxe','AK1gDNi','De1gu1a','CIaI','B0vWuKS','uhDPBLi','z2vUzxjHDguTAq','zu5PyLa','Bhzgr1u','ugHqEKG','y0jWyKC','CNDLr3m','w0jHBMfUyv0G55sF','ifbYB21WDa','5zU+5lQl5lU255Ur5zcS5zMO5BEY5ywZ6zET44cc','CNvIuwG','5l+U5zU+5OYh5lUKoIa','CMvTB3zLtgLZDa','ieLeia','zMLSDgvY','tuPUzhy','zw5LCMf0Aw9Uia','y29UDMvYC2f0Aq','ChvZAa','DgLVBIb3AxrOia','rfrIDxy','wxzbANa','q0jKA24','vuHyA3O','shjrC0K','s0zewhK','Aff2zuG','nJe3odCZngv0qwrRvG','C3nMDwXSEs4','wuPowgG','w0jHBMfUyv0Grq','EwjJqvG','DhjPBq','nda5ntyYmhHRs2vjAa','shztD00','y2LZAhu','rfbAA3G','C2uGzgLKig5VDa','y2fJAgu','DhLWzq','ig1LC3nHz2vZlG','u3PQuhO','tgnUu2G','5lU255Ur5zcS5zMO5BEY5yID5AEl5yYw44cc','nJuZnJy3Cfn5yLjO','5yMn572U5zco','5l+U5zU+5zU+54MhoIbB5BEY5O+q5l6B','w0jHBMfUyv0Gsq','5zU+5QIH5BYp77YA5OYh5lUKid0G','wg16D3e','5zco572U5zco','w0jHBMfUyv0GrW','5zU+5Rwb56Il44cc5A6I5OI356UV5lI6','B2X5qu4','Dg9tDhjPBMC','zw1PDa','ChjVBxb0','Aw1Hz2vFDxjS','Aw5JBhvKzxm','ANHSwKq','DMnWrK8','Bw9KywWGCgf5Ba','rNHms1i','tur4seK','DwLSDcbjBwfNzq','swrNzNC'];_0x18dc=function(){return _0x8cd432;};return _0x18dc();}import{processCharacterPrompt}from'./characterprompt.js';import{setItemImg}from'./database.js';import{getConfigImage}from'./configDatabase.js';async function getImageFromTurnData(_0x1915e3){const _0x562d4e={'fPxpd':_0x115b36(0x4a1,0x4c2,0x4ee,0x4c9),'vcpFO':function(_0x20ab9d,_0x117b45){return _0x20ab9d(_0x117b45);},'JFKtp':function(_0x380e47,_0xe66f87){return _0x380e47||_0xe66f87;},'KzDQe':_0x1e2662(0x13f,0xca,0x1b8,0x100)};if(!_0x1915e3)return'';if(_0x1915e3[_0x1e2662(0x89,0x116,0xc1,0xb2)]&&_0x1915e3['imageId'][_0x1e2662(0xb3,0x93,0x36,0x21)](_0x562d4e[_0x1e2662(0xe0,0xf6,0x12c,0x4e)])){const _0x3841b9=await _0x562d4e[_0x1e2662(0x5f,0x6e,0x44,0x88)](getConfigImage,_0x1915e3[_0x1e2662(0x89,0xac,0xe9,0x96)]);return _0x562d4e[_0x115b36(0x54e,0x4dc,0x548,0x5dd)](_0x3841b9,'');}function _0x115b36(_0x6aab26,_0x4f98d1,_0x4500cf,_0xb613b8){return _0xe158(_0x6aab26-0x38b,_0x4f98d1);}function _0x1e2662(_0x965fc4,_0x3c6259,_0x3924de,_0x2d3819){return _0xe158(_0x965fc4- -0xa9,_0x3c6259);}if(_0x1915e3[_0x1e2662(0x131,0xeb,0xd5,0x1a4)]&&_0x1915e3[_0x115b36(0x565,0x5db,0x5e6,0x4e1)][_0x1e2662(0xb3,0xf2,0xe6,0x6c)](_0x562d4e['KzDQe']))return _0x1915e3[_0x115b36(0x565,0x57a,0x596,0x569)];return'';}function _0x5e6c8f(_0xa77fca,_0x32247f,_0x2e96fb,_0x1bfb0e){return _0xe158(_0xa77fca- -0x3b1,_0x1bfb0e);}async function generateBananaImage({prompt:_0x2fd950,width:_0x2e69bd,height:_0x4dce59,change:_0x3ac886,retouchPrompt:_0x5944b2,retouchImage:_0x5a4b76}){const _0x3b43ce={'VvxKW':function(_0x34a88c){return _0x34a88c();},'cWHtA':'user','oEpRK':'text','PcgCL':function(_0x88a3b8,_0x44bbba){return _0x88a3b8+_0x44bbba;},'Swtso':function(_0x31d0bf,_0x54aeaa){return _0x31d0bf(_0x54aeaa);},'LCtZH':'[Banana]\x20R'+_0x40621b(0xbd,0x9c,0xae,0xca)+_0x40621b(0x70,0x0,0x5f,0x8b)+_0x1fdf72(-0x77,0x3,-0x40,-0x7d)+_0x1fdf72(-0x57,-0x35,-0x60,0x4e),'KFDXy':function(_0x4e741e,_0x263989){return _0x4e741e(_0x263989);},'GeTFq':function(_0x1207ee,_0x2e1c76){return _0x1207ee(_0x2e1c76);},'dNLNi':function(_0x57beb0,_0x26217f){return _0x57beb0||_0x26217f;},'fNJKL':_0x1fdf72(-0xf7,-0xae,-0x5d,-0x7f),'RCisN':function(_0x452dbd,_0x45cd77){return _0x452dbd(_0x45cd77);},'bJwam':function(_0x13ccd7,_0x2b680f){return _0x13ccd7+_0x2b680f;},'PwinR':function(_0x5e6bed,_0x16721b){return _0x5e6bed+_0x16721b;},'yYWoK':_0x40621b(0x167,0x119,0x131,0xde)+_0x40621b(0x67,0x50,-0x3e,0x28)+'\x20contain\x20i'+_0x1fdf72(-0xc4,-0x94,-0x3a,-0x50)+_0x1fdf72(-0xe,-0x4c,-0x55,0x8)+'t','xkJQd':function(_0x5b81ef,_0x21f32e){return _0x5b81ef(_0x21f32e);},'xzPSR':function(_0x357a1e,_0x67c192){return _0x357a1e(_0x67c192);},'LKBZg':function(_0x3584af,_0x550a95){return _0x3584af||_0x550a95;},'cQpkt':function(_0x165553,_0x5aef02){return _0x165553!==_0x5aef02;},'VrmkN':_0x40621b(0x8c,0x131,0xc0,0x9d)+_0x40621b(0x46,0xf3,0x29,0xb0),'sqjld':_0x40621b(0xa,0xcf,0x11d,0x96),'BrwMZ':function(_0x44c040,_0x4a2af1){return _0x44c040(_0x4a2af1);},'GrviM':function(_0xfda167,_0x51ef78){return _0xfda167<=_0x51ef78;},'PhPzH':_0x40621b(0x27,0x3d,-0x14,0x7a),'jxlZD':_0x40621b(0xf6,0x47,0x124,0xbe)+'中的\x20prompt。','RZtva':function(_0x42427d,_0x126e89,_0x44462e){return _0x42427d(_0x126e89,_0x44462e);},'ybcAX':function(_0x3e2e9c,_0x196ae9){return _0x3e2e9c<=_0x196ae9;},'tOvpV':'LmyMS','MvIbN':'\x20|\x20','hStPz':function(_0x3994c8,_0x32f45f){return _0x3994c8(_0x32f45f);},'WUcgx':_0x1fdf72(-0x4d,-0x37,-0x54,-0xb6),'Idgfw':function(_0x1eab13,_0x1fa202){return _0x1eab13===_0x1fa202;},'cBpbG':_0x40621b(0x2e,0xad,0x54,0xaa),'BOwaa':'前置前','NKLMH':'后置前','imtFw':_0x1fdf72(-0x34,-0xb5,-0x3c,-0x6e),'RgFUs':'最后置','FxLKR':function(_0x17e902,_0x4f34d2){return _0x17e902(_0x4f34d2);},'UHXkz':_0x40621b(0xde,0x152,0xd2,0x117)+_0x40621b(0x64,0x124,0x12d,0xcf),'JjXsi':_0x1fdf72(-0xa,-0x65,-0x69,-0x6f),'csUNg':'[Banana]\x20启'+_0x1fdf72(-0x4c,-0x1,-0x74,0xc)+'。','Ozwmq':function(_0x1c9732,_0x16a1a3){return _0x1c9732||_0x16a1a3;},'lvFGU':function(_0xe98819,_0x4c0692){return _0xe98819!==_0x4c0692;},'DfVGI':_0x1fdf72(0x5,-0x50,-0x1b,-0x64),'mtCzp':_0x1fdf72(-0x3c,-0xba,-0x61,-0x127),'AVfmJ':function(_0x23375a,_0x5acb2d){return _0x23375a(_0x5acb2d);},'jMFvr':_0x1fdf72(-0x7,0xd,-0x4a,0x5d),'rweGs':function(_0x38f32e,_0x57da82){return _0x38f32e===_0x57da82;},'BExNO':function(_0x26f0f0,_0xbd4e4c){return _0x26f0f0===_0xbd4e4c;},'CBdkn':_0x1fdf72(-0x41,-0x62,-0x9a,-0xab),'ROqMl':function(_0x5419ab,_0x5f296f){return _0x5419ab(_0x5f296f);},'MDxHI':function(_0x5b056c,_0x4c471e){return _0x5b056c>_0x4c471e;},'fINUa':function(_0x382c79,_0x29b881){return _0x382c79===_0x29b881;},'skDUl':_0x40621b(0xb1,0x34,0xd4,0x59),'KClQy':_0x1fdf72(-0x15d,-0xca,-0xba,-0xad),'tMFSP':'assistant','vjFrO':_0x1fdf72(0x71,-0x7,-0x42,0xa),'WRKSz':function(_0x45fae4,_0xa467cf){return _0x45fae4(_0xa467cf);},'fgxBr':_0x40621b(0xb9,0x81,0x7c,0x4f),'HvSwM':_0x40621b(0x96,-0x5b,0x33,0x2d),'mHNDv':function(_0x69f13c,_0x440201){return _0x69f13c+_0x440201;},'yFEhx':function(_0x4313ab,_0x15d4ea){return _0x4313ab===_0x15d4ea;},'sCnkU':_0x1fdf72(-0xde,-0xc3,-0x80,-0x149),'vajtG':function(_0xb0eb77,_0x5ec19a){return _0xb0eb77+_0x5ec19a;},'jKLud':_0x1fdf72(-0x25,-0x7a,-0x7b,-0xa),'eXuIw':function(_0x3ecce3,_0x30abf8){return _0x3ecce3(_0x30abf8);},'gHPgQ':function(_0x2e7164){return _0x2e7164();},'tCyoo':function(_0x211c68,_0x3d4f2e,_0x58ae26){return _0x211c68(_0x3d4f2e,_0x58ae26);},'SzjPz':_0x1fdf72(-0x26,-0x74,-0x2c,-0x72),'WiziD':_0x40621b(0xf2,0x51,0x5d,0x87)+_0x1fdf72(-0xa2,-0x23,-0x7,-0x77),'olyAN':function(_0x2b87c0,_0x312932){return _0x2b87c0>_0x312932;},'iTgJx':function(_0x13fb35,_0x5ccb85){return _0x13fb35!==_0x5ccb85;},'YWzKM':_0x40621b(0x30,0xa6,0xee,0x83),'DTbuv':function(_0x1cbef5,_0x443ccd){return _0x1cbef5!==_0x443ccd;},'eNibP':'nyTgA','mwEGb':function(_0x1b626e){return _0x1b626e();},'bqfrZ':function(_0x277f19,_0x2c29f5){return _0x277f19(_0x2c29f5);},'cXzFs':_0x1fdf72(-0xe4,-0xb8,-0x10b,-0x114)+_0x40621b(0xb6,0x135,0x5c,0xa9)+_0x1fdf72(-0x86,-0x1e,-0x9d,-0x25)+_0x1fdf72(-0x6e,-0xcb,-0x121,-0x7e),'IhFwy':_0x40621b(0x25,0xc7,0xc2,0x77)+'etch\x20error'+':'};_0x2fd950=_0x3b43ce[_0x1fdf72(-0x14,-0x98,-0x68,-0x11c)](processCharacterPrompt,_0x2fd950),_0x2fd950=await _0x3b43ce['KFDXy'](stripChineseAnnotations,_0x2fd950);let _0x259c7a=_0x3ac886;_0x3ac886=_0x3b43ce['xkJQd'](processCharacterPrompt,_0x3ac886),_0x3ac886=await _0x3b43ce['KFDXy'](stripChineseAnnotations,_0x3ac886),_0x3b43ce[_0x40621b(0x5e,0xdc,0xa0,0xa0)](addLog,_0x1fdf72(-0x41,0x5,-0x2b,0x9)+_0x40621b(-0x7,0x4b,0xb7,0x37)+extension_settings[extensionName][_0x40621b(0x5f,0x101,0x93,0xe2)]),addLog('请求尺寸:\x20宽度\x20-'+'\x20'+_0x3b43ce['LKBZg'](_0x2e69bd,'默认')+_0x40621b(0x10a,-0x10,0x9b,0x79)+(_0x4dce59||'默认')),_0x2fd950=_0x3ac886&&_0x3b43ce[_0x1fdf72(0x28,-0x21,-0x99,-0x7f)](_0x3ac886[_0x40621b(0x30,-0x3a,0xaa,0x23)](),'')?_0x3ac886:_0x2fd950,addLog('用于生成的Tag:\x20'+_0x2fd950);let _0x227d83=![];_0x2fd950[_0x1fdf72(-0x96,-0xad,-0xa7,-0xd8)](_0x3b43ce['VrmkN'])&&(_0x227d83=!![]);addLog(_0x40621b(0x19f,0xb3,0x101,0x119)+_0x40621b(0xe,0x61,0x91,0x67)+_0x40621b(0x30,0x127,0x9a,0xa6)+_0x227d83);let _0x2b8364={},_0x45d246='',_0x523b2e='';if(_0x227d83){if(_0x3b43ce[_0x1fdf72(0x37,-0x22,0x5,0x1a)]===_0x3b43ce[_0x40621b(0x4a,0x36,0x143,0xc8)]){_0x3b43ce[_0x1fdf72(-0x33,-0x3e,0x18,-0x3)](addLog,_0x40621b(0x78,0x6a,0x25,0x84)+_0x40621b(0x133,0x178,0x17c,0x11e)),_0x2b8364=parsePromptStringWithCoordinates(_0x2fd950),_0x45d246=_0x2b8364[_0x3b43ce[_0x40621b(0x67,0x15f,0xaa,0xcd)]];for(let _0x207953=-0x2a*0x47+0x53d+-0x1*-0x66a;_0x3b43ce[_0x1fdf72(-0x2b,-0x10,-0x29,0x68)](_0x207953,-0x163*0xb+-0x78c+0x16d1);_0x207953++){_0x2b8364[_0x1fdf72(0x2,-0x85,-0x52,-0x111)+_0x207953+_0x1fdf72(0x98,0x49,0x6c,0x93)]&&(_0x3b43ce[_0x1fdf72(-0x1c,-0x21,0x6f,-0x7e)](_0x1fdf72(-0x35,0x50,0x6d,0xbf),_0x3b43ce[_0x1fdf72(0x61,0x45,0x3b,0x68)])?_0x523b2e=_0x3b43ce[_0x40621b(0x9f,0x43,-0x2c,0x5b)](_0x3b43ce['PcgCL'](_0x523b2e,',\x20'),_0x2b8364[_0x40621b(0x68,0x78,0x47,0x65)+_0x207953+_0x40621b(0x1c0,0xe4,0x1ad,0x133)]):(_0x19f274[_0x40621b(-0x1d,0x47,0x10,0x72)+'BananaList'+'ener']=!![],_0x3b43ce[_0x1fdf72(0x13,-0x27,0x37,0x20)](_0x4660b1)));}}else{const _0x4045c0={};_0x4045c0['role']=_0x3b43ce['cWHtA'],_0x4045c0[_0x1fdf72(-0x7d,-0x84,-0x4d,-0x2a)]=[{'type':_0x3b43ce['oEpRK'],'text':_0x2796f7}],_0xaac2e7[_0x1fdf72(0xc2,0x53,0xc6,-0xf)](_0x4045c0);}}else _0x3b43ce[_0x40621b(0x124,0x78,0xea,0xac)](addLog,_0x3b43ce[_0x40621b(-0x3c,-0x2,0x1,0x3e)]),_0x45d246=_0x2fd950;let {modifiedPrompt:_0x300f45,insertions:_0xeb479}=await _0x3b43ce[_0x1fdf72(-0x7f,-0x51,-0x65,-0xc)](prompt_replace,_0x45d246,_0x523b2e);if(_0x227d83)for(let _0x563ae9=-0xed5*0x1+-0x252a+0x3400;_0x3b43ce[_0x1fdf72(-0x80,-0xc8,-0x59,-0x5c)](_0x563ae9,-0xbcb+0x9a*-0x9+0x1*0x1139);_0x563ae9++){_0x2b8364[_0x40621b(-0x2b,0x3f,0x6f,0x65)+_0x563ae9+_0x40621b(0x132,0x19d,0x16e,0x133)]&&(_0x3b43ce['tOvpV']!==_0x3b43ce[_0x40621b(0x6c,0x96,0x3d,0x86)]?_0x242e94=_0x3b43ce[_0x40621b(0x74,0x6a,0x99,0x5b)](_0x4a436e,_0x2402ec):_0x300f45=_0x3b43ce[_0x1fdf72(-0x4,-0x8f,-0xc1,-0x5c)](_0x3b43ce[_0x1fdf72(-0x5,-0x97,-0x2b,-0x2a)](_0x300f45,_0x3b43ce[_0x40621b(0xb6,0x46,0xe8,0x7f)]),prompt_replace_for_character(_0x2b8364[_0x1fdf72(0x8,-0x85,-0x6a,-0x9e)+_0x563ae9+_0x40621b(0xb9,0x12d,0x1ad,0x133)])));}const _0x7bd82c=extension_settings[extensionName][_0x40621b(0x37,0x14f,0x157,0xc5)],{model:_0x2e6d50,apiUrl:_0x2de382,apiKey:_0x87125a,conversationPresets:_0xb51943,conversationPresetId:_0x31adfc,editPresetId:_0x29b41d,aspectRatio:_0x636bb3}=_0x7bd82c;_0x3b43ce[_0x40621b(0x84,0x15a,0x8a,0x104)](addLog,_0x1fdf72(-0xd,0x36,0x45,0x39)+'tarting\x20im'+_0x40621b(0x45,0x31,0xd0,0x6b)+_0x1fdf72(0xa1,0x54,-0x6,0x1e)+_0x1fdf72(0x34,0x1f,0xaa,0x24)+_0x2e6d50);let _0x3f53cf;function _0x1fdf72(_0x36ad2a,_0x22bb44,_0x11e974,_0x404571){return _0xe158(_0x22bb44- -0x1b3,_0x36ad2a);}let _0x4b98c9;if(_0x2e6d50[_0x40621b(0x1b,0xa1,0x90,0x93)](_0x3b43ce[_0x40621b(0xa1,0xe9,0xfe,0xce)])){if(_0x3b43ce['Idgfw']('iqEQM',_0x3b43ce[_0x40621b(0x12a,0x15d,0x1b9,0x130)])){_0x3f53cf='/v1beta/mo'+_0x40621b(0x8d,-0x15,0xa1,0x5c)+_0x2e6d50;const _0x4821c0={};_0x4821c0[_0x1fdf72(0x15,-0x13,0x4,0x3e)+'t']='';const _0x188b1e=_0xb51943[_0x31adfc]||_0x4821c0,_0x566f11=[_0x188b1e[_0x1fdf72(-0x8,-0x13,-0x17,0x15)+'t'],_0xeb479[_0x3b43ce['BOwaa']],_0xeb479[_0x1fdf72(-0x13a,-0xba,-0x94,-0x34)],_0x300f45,_0xeb479[_0x3b43ce['NKLMH']],_0xeb479[_0x3b43ce[_0x1fdf72(-0x57,-0x68,-0x9a,-0x64)]],_0x188b1e[_0x1fdf72(0x76,0x1,-0x5a,-0x8d)+_0x1fdf72(-0x71,0x6,-0x4f,-0x3a)],_0xeb479[_0x3b43ce[_0x1fdf72(-0xb8,-0x6d,-0xc8,-0x3e)]]]['filter'](Boolean)[_0x1fdf72(0x3d,-0x4e,-0x68,-0x8c)](',\x20');_0x3b43ce[_0x40621b(0xc1,0x35,-0x3c,0x41)](addLog,_0x40621b(0xf,0x59,0x9e,0x45)+_0x566f11);const _0x24b60d={};_0x24b60d['prompt']=_0x566f11;const _0x29475a={};_0x29475a[_0x40621b(0xf0,0xad,0x122,0x124)+'t']=0x1,_0x29475a[_0x1fdf72(-0x2b,-0x32,0x3d,0x3e)+'o']=_0x636bb3;const _0x35d51a={};_0x35d51a[_0x40621b(0x31,0x27,0x25,0x89)]=[_0x24b60d],_0x35d51a[_0x1fdf72(-0x59,0xf,0x5b,0x43)]=_0x29475a,_0x4b98c9=_0x35d51a,_0x3b43ce['Swtso'](addLog,_0x1fdf72(0x3,-0x53,-0x86,0x25)+_0x40621b(0x30,0x31,0x46,0x43)+'n\x20payload\x20'+_0x1fdf72(-0x19,0x13,0x2a,0x88)+_0x40621b(0xd3,0xca,0x117,0x95)+_0x566f11);}else{const _0x26aaca=_0x32808a?function(){function _0x4790be(_0x3e6fde,_0x1082eb,_0x1c9cff,_0x1fb5df){return _0x1fdf72(_0x1082eb,_0x1c9cff-0x447,_0x1c9cff-0x16,_0x1fb5df-0x13c);}if(_0x1d6e55){const _0x2d18f2=_0x2fb4d8[_0x4790be(0x3b1,0x36c,0x3b2,0x365)](_0x43681e,arguments);return _0x5c3673=null,_0x2d18f2;}}:function(){};return _0x1d0343=![],_0x26aaca;}}else{_0x3f53cf=_0x3b43ce[_0x1fdf72(-0xf9,-0xd0,-0xb9,-0xf9)];let _0x2f3a2f;if(_0x3ac886[_0x1fdf72(-0xcb,-0xad,-0x113,-0x104)](_0x3b43ce[_0x1fdf72(0xc9,0x39,0x5b,0x86)])){_0x3b43ce[_0x40621b(-0x3b,0x95,0x99,0x52)](addLog,_0x3b43ce['csUNg']);const _0x4db65a=_0x3b43ce[_0x1fdf72(0x60,0x3c,0x8e,0x8a)](_0x29b41d,'默认'),_0x48d5cd={};_0x48d5cd[_0x1fdf72(0xbb,0x52,0xc7,0x91)+'on']=[],_0x48d5cd['fixedPromp'+'t']='',_0x2f3a2f=_0xb51943[_0x4db65a]||_0x48d5cd,addLog(_0x40621b(0x120,0xb6,0x14d,0xba)+_0x40621b(0x61,0xe5,0xa9,0x81)+_0x4db65a+'\x22');}else{if(_0x3b43ce[_0x40621b(0x16f,0x15b,0x186,0x12e)](_0x3b43ce['DfVGI'],_0x3b43ce[_0x40621b(0xbf,0x114,0xfd,0xdb)]))_0x3b43ce[_0x1fdf72(-0x6c,-0x98,-0xa3,-0x15)](_0x14e409,_0x3b43ce['LCtZH']);else{const _0x397023={};_0x397023['conversati'+'on']=[],_0x397023[_0x40621b(0xd5,0x7d,0x120,0xd7)+'t']='',_0x2f3a2f=_0xb51943[_0x31adfc]||_0x397023;}}const _0x51c8ac=[_0x2f3a2f[_0x1fdf72(-0x73,-0x13,-0x72,-0x33)+'t'],_0xeb479[_0x3b43ce[_0x40621b(0x1e,0x60,0x8c,0xad)]],_0xeb479[_0x3b43ce[_0x40621b(0xc1,0x10f,0x59,0xd5)]],_0x300f45,_0xeb479[_0x1fdf72(0x2e,-0x5c,-0x39,0x14)],_0xeb479['后置后'],_0x2f3a2f['postfixPro'+'mpt'],_0xeb479[_0x1fdf72(-0x8f,-0x89,-0x31,-0x8e)]][_0x1fdf72(-0x1b,0x4f,-0x4,0x64)](Boolean)[_0x1fdf72(-0x4,-0x4e,-0x7c,-0xc4)](',\x20');_0x3b43ce[_0x1fdf72(-0x47,-0x86,-0x9f,-0x3f)](addLog,_0x1fdf72(-0x37,-0xa5,-0x27,-0x70)+_0x51c8ac);const _0x35e5b1={};_0x35e5b1[_0x40621b(0xb5,0xa2,0x75,0xd9)]=_0x1fdf72(-0x9c,-0x1f,0x2e,-0x17),_0x35e5b1[_0x40621b(0x1,0xa4,0x61,0x66)]=[];const _0x26e1be={};_0x26e1be[_0x40621b(0x158,0x4b,0x13e,0xd9)]=_0x40621b(-0xf,0x89,0xb8,0x74),_0x26e1be[_0x40621b(0x7a,0xc6,0xee,0x66)]=[];const _0x4bfd3a=_0x2f3a2f[_0x1fdf72(-0x7,0x52,0x76,0xb9)+'on'][_0x40621b(0x70,0xaf,0x17,0x4c)](_0x5c2446=>[_0x35e5b1,_0x26e1be])[_0x40621b(0x126,0xbf,0x154,0xdf)]();let _0x12f68a=0x1*0x1ea9+-0x248d*0x1+0x5e4;for(const _0x345fc4 of _0x2f3a2f[_0x40621b(0x1c8,0x14f,0x118,0x13c)+'on']){if(_0x3b43ce[_0x1fdf72(0x66,0x3d,0xcc,0x84)]!==_0x1fdf72(-0x5d,0xd,0x94,0x6b))_0x5325b1[_0x8067e8]['banana']['cishu']=_0x3b43ce[_0x1fdf72(-0xb1,-0x8f,-0xa3,-0x10f)](_0x58f4d4[_0x4702f8][_0x40621b(0x9f,0xcd,0x134,0xc5)][_0x40621b(0x0,0x87,0x5a,0x26)],-0x1*0x1837+0x1*-0x21f7+0x3a2f),_0x3b43ce[_0x40621b(0x95,-0x55,-0x4e,0x1c)](_0x3a9d91,_0x1fdf72(0x1b,-0x12,0x7f,-0x30)+_0x40621b(0x78,0xc1,-0x7,0x8c)+_0xfac018[_0x42108e][_0x1fdf72(0x5,-0x25,-0x21,-0x6)][_0x40621b(0x54,0x9d,0x1,0x26)]);else{if(_0x345fc4[_0x40621b(0xcd,0x117,0x146,0xcb)]?.['text'])_0x4bfd3a[_0x12f68a][_0x1fdf72(-0x83,-0x84,-0x9e,-0xfc)]['push']({'type':'text','text':_0x345fc4[_0x1fdf72(-0x2,-0x1f,-0x43,0x3e)][_0x1fdf72(0x1e,-0x46,-0x76,0x40)]});const _0x2b1486=await _0x3b43ce['hStPz'](getImageFromTurnData,_0x345fc4['user']);if(_0x2b1486)_0x4bfd3a[_0x12f68a]['content']['push']({'type':_0x3b43ce[_0x40621b(0x115,0xd1,0x4a,0xa8)],'image_url':{'url':_0x2b1486}});_0x12f68a++;if(_0x345fc4[_0x1fdf72(-0x61,-0xd,0x60,0x7a)]?.[_0x40621b(0x2b,0x72,0x7a,0xa4)])_0x4bfd3a[_0x12f68a][_0x1fdf72(-0xe1,-0x84,-0x19,-0x58)]['push']({'type':_0x40621b(0x8d,0x132,0x136,0xa4),'text':_0x345fc4['model'][_0x40621b(0x10,0x25,0xd1,0xa4)]});const _0x508709=await _0x3b43ce[_0x40621b(0x8,-0x25,0xab,0x1c)](getImageFromTurnData,_0x345fc4[_0x40621b(0x16a,0xa9,0x124,0xdd)]);if(_0x508709)_0x4bfd3a[_0x12f68a][_0x1fdf72(-0x82,-0x84,-0x49,-0x41)][_0x1fdf72(0x5e,0x53,-0x26,0x16)]({'type':_0x3b43ce[_0x1fdf72(-0x59,-0x42,-0x1e,-0x8e)],'image_url':{'url':_0x508709}});_0x12f68a++;}}if(!_0x3ac886[_0x40621b(0xb9,0xd,0x13,0x3d)](_0x3b43ce[_0x40621b(0x124,0xe8,0xbc,0x123)])){const _0x2f8f0d=extension_settings[extensionName]['bananaChar'+'acterPrese'+'ts']||{};for(const _0x3d749d in _0x2f8f0d){const _0x4020a3=_0x2f8f0d[_0x3d749d],_0x2728a1=(_0x4020a3['triggers']||'')[_0x1fdf72(-0x5f,0xa,-0x24,-0x5e)]('|')[_0x40621b(0x147,0x14a,0x1a3,0x139)](_0x365cf7=>_0x365cf7[_0x1fdf72(-0xc4,-0xc7,-0x11a,-0xbe)]()!=='');for(const _0x50ae2b of _0x2728a1){if(_0x3b43ce[_0x40621b(0x193,0xee,0x9d,0x131)](_0x1fdf72(-0xa9,-0x9a,-0x5d,-0x38),'WncCV')){if(_0x51c8ac[_0x40621b(0xd0,0x126,0xec,0xa3)+'e']()[_0x1fdf72(-0x90,-0xad,-0xbe,-0x55)](_0x50ae2b[_0x1fdf72(-0x61,-0x47,-0x3d,-0x1a)+'e']())){_0x3b43ce[_0x40621b(0x3a,0xa2,0x131,0xa1)](addLog,'[Banana]\x20F'+_0x40621b(-0x11,-0x17,-0x9,0x60)+_0x1fdf72(-0x49,0x17,0x8e,0x29)+_0x40621b(0x1b5,0x100,0x117,0x129)+_0x50ae2b+(_0x1fdf72(0x99,0x38,-0x14,0x30)+_0x40621b(0xf3,0x3a,0xde,0x6e))+_0x3d749d+'\x22.');const _0x533a74=_0x4020a3['conversati'+'on'];if(_0x533a74){if(_0x3b43ce[_0x40621b(0x155,0x13b,0x15a,0xd1)](_0x40621b(0x148,0x112,0xa2,0x108),_0x3b43ce[_0x1fdf72(-0x1f,0x57,0x7c,0x6e)]))_0x59c5c6[_0x1fdf72(-0x55,-0x85,-0x6e,-0x1d)+_0x1cc345+_0x40621b(0x10d,0x16e,0xd4,0x133)]&&(_0x2f1c9a=_0x3b43ce['PcgCL'](_0x40926b+',\x20',_0x1b290c['Character\x20'+_0x326042+'\x20Prompt']));else{const _0x2b6c43=[];if(_0x533a74[_0x40621b(0x3f,0xaa,0x11c,0xcb)]&&_0x533a74[_0x1fdf72(0x2,-0x1f,0x37,-0x94)][_0x1fdf72(-0x63,-0x46,0x3f,-0x5e)])_0x2b6c43['push']({'type':_0x40621b(0x69,0x2c,0xcf,0xa4),'text':_0x533a74['user']['text']});const _0x69354d=await _0x3b43ce[_0x40621b(0x86,0x13f,0x88,0xe5)](getImageFromTurnData,_0x533a74[_0x1fdf72(-0x40,-0x1f,0x64,0xa)]);if(_0x69354d)_0x2b6c43[_0x1fdf72(0xa3,0x53,0x7e,0x8f)]({'type':_0x40621b(0x27,0x2b,0x66,0x3c),'image_url':{'url':_0x69354d}});if(_0x3b43ce[_0x1fdf72(-0x5f,-0xa8,-0x87,-0x81)](_0x2b6c43[_0x1fdf72(-0xe,-0x58,-0xd3,-0x56)],-0x1ed1+-0x7b9+0x268a)){const _0x65d3af={};_0x65d3af['role']=_0x3b43ce['cWHtA'],_0x65d3af[_0x1fdf72(-0xc0,-0x84,-0x37,-0x92)]=_0x2b6c43,_0x4bfd3a['push'](_0x65d3af);}const _0x111ed9=[];if(_0x533a74[_0x40621b(0x89,0xcc,0x7f,0xdd)]&&_0x533a74[_0x1fdf72(-0x31,-0xd,-0x30,0x15)][_0x1fdf72(-0x89,-0x46,0xe,0x38)])_0x111ed9[_0x40621b(0x106,0x109,0x1ac,0x13d)]({'type':_0x3b43ce[_0x40621b(0xe9,0x1b4,0x162,0x12a)],'text':_0x533a74[_0x1fdf72(0x7d,-0xd,-0x55,0xa)][_0x1fdf72(-0x63,-0x46,-0x99,-0x9f)]});const _0x9909b4=await getImageFromTurnData(_0x533a74[_0x40621b(0xb6,0x118,0x10c,0xdd)]);if(_0x9909b4)_0x111ed9['push']({'type':_0x3b43ce[_0x40621b(0x32,0x6c,0xf6,0xa8)],'image_url':{'url':_0x9909b4}});if(_0x3b43ce['MDxHI'](_0x111ed9[_0x40621b(0xfe,0x5b,0x41,0x92)],-0x4be*-0x1+0xeb7+0x11*-0x125)){if(_0x3b43ce['fINUa'](_0x3b43ce['skDUl'],_0x3b43ce['KClQy']))return _0x5c1de6[_0x40621b(0x82,0x138,0x1a1,0x111)];else{const _0x5b96de={};_0x5b96de[_0x40621b(0x135,0x169,0x116,0xd9)]=_0x3b43ce[_0x40621b(0x189,0xcb,0xdf,0x128)],_0x5b96de[_0x40621b(0x68,0x77,-0x13,0x66)]=_0x111ed9,_0x4bfd3a[_0x1fdf72(0x3,0x53,0x14,0x5d)](_0x5b96de);}}}}break;}}else{const _0x52d50d=_0x1fdf72(-0xc0,-0xb4,-0xc2,-0x9f)+_0x40621b(0x1b5,0x189,0x162,0x13b)+'failed\x20for'+'\x20ID\x20'+_0x2ac080+':\x20'+_0x3cb4ab[_0x40621b(0x72,0xbb,0x88,0x47)];_0x3b43ce[_0x40621b(0xdb,0x112,0x43,0x8a)](_0x14edab,_0x52d50d),_0x5b0cdf['error'](_0x52d50d);const _0x2051f4={};_0x2051f4['id']=_0x335801,_0x2051f4[_0x40621b(0x129,0xb8,0x65,0xd3)]=![],_0x2051f4['error']=_0x665d99[_0x40621b(0x4d,0x58,0x6c,0x47)],_0x2051f4[_0x1fdf72(-0x103,-0xaf,-0x91,-0x6d)]=_0x528b84,_0x161c51[_0x40621b(-0x31,0x4a,-0x51,0x3a)](_0x74ccbc[_0x40621b(0xdc,0x5b,0x97,0x6a)+_0x1fdf72(0x42,-0x3b,-0xa3,-0x4)+_0x1fdf72(-0x78,-0x2,0x62,-0x3a)],_0x2051f4),_0x3b43ce[_0x40621b(0xb,0x3a,-0x55,0x1c)](_0xd64c4,_0x1fdf72(-0x138,-0xc9,-0x47,-0x148)+_0x1fdf72(-0x116,-0x92,0x2,-0x8a)+_0x1fdf72(-0x6e,-0x96,-0x105,-0x3b)+_0x40621b(0x99,0x140,0x15b,0xe7)+':\x20'+_0x2722dc);}}}}if(!_0x3ac886[_0x40621b(0xbc,0x85,0x68,0x3d)](_0x3b43ce[_0x40621b(0x107,0x187,0x139,0x123)])){if(_0x3b43ce[_0x40621b(0x5e,0x4c,0x13,0x44)](_0x1fdf72(-0x33,-0x14,0x21,0x59),_0x3b43ce[_0x40621b(0x175,0x13f,0x96,0x103)])){const _0x4d26ef={};_0x4d26ef[_0x40621b(0x11b,0x144,0x97,0xd9)]=_0x3b43ce['cWHtA'],_0x4d26ef[_0x1fdf72(-0xe5,-0x84,-0x7b,-0x3d)]=_0x10bdc5,_0x1bd166[_0x1fdf72(0x9d,0x53,-0x36,0x1d)](_0x4d26ef);}else{const _0x979372={};_0x979372[_0x40621b(0x86,0x90,-0x3a,0x2a)]=_0x3b43ce[_0x1fdf72(0x9e,0x40,0x49,-0x8)],_0x979372[_0x1fdf72(-0x88,-0x46,-0x40,-0xb5)]=_0x51c8ac;const _0x433315={};_0x433315[_0x40621b(0xf4,0xe6,0x140,0xd9)]=_0x40621b(0x159,0xc6,0x99,0xcb),_0x433315[_0x40621b(0x3f,0x4f,0xc9,0x66)]=[_0x979372],_0x4bfd3a[_0x40621b(0x166,0xc4,0x129,0x13d)](_0x433315);}}else{const _0x44b197=[],_0xb52cc=_0x5944b2||_0x51c8ac,_0x535cf2=[_0x2f3a2f[_0x40621b(0x9f,0x10e,0x80,0xd7)+'t'],_0xb52cc,_0x2f3a2f[_0x40621b(0x84,0xa4,0x137,0xeb)+_0x1fdf72(-0x73,0x6,0x43,-0x4f)]][_0x1fdf72(0xda,0x4f,-0x3e,0x38)](Boolean)['join'](',\x20'),_0x5cc1b5={};_0x5cc1b5[_0x40621b(0x8,0xb4,0xb2,0x2a)]=_0x1fdf72(-0xb8,-0x46,0x30,-0x61),_0x5cc1b5[_0x40621b(0xb8,0x12,0x73,0xa4)]=_0x535cf2,_0x44b197[_0x1fdf72(0xe6,0x53,0x27,0x2f)](_0x5cc1b5);if(_0x5a4b76){const _0x41ef7e={};_0x41ef7e[_0x40621b(0xc9,0x13f,0x3c,0xd0)]=_0x5a4b76;const _0x1b51fd={};_0x1b51fd[_0x1fdf72(-0x99,-0xc0,-0x5a,-0x5c)]=_0x3b43ce[_0x40621b(0x1a,0x16,0x2b,0xa8)],_0x1b51fd[_0x1fdf72(-0x4a,-0xae,-0xf8,-0xb7)]=_0x41ef7e,_0x44b197[_0x40621b(0x1a7,0xd1,0x16d,0x13d)](_0x1b51fd),addLog(_0x40621b(0x152,0x191,0x160,0x107)+_0x40621b(0x8b,0xad,0x149,0xfe)+_0x40621b(0xb2,0x151,0xca,0xf8));}const _0x2ff235={};_0x2ff235['role']=_0x3b43ce[_0x1fdf72(-0x6a,-0xa0,-0x1e,-0x95)],_0x2ff235['content']=_0x44b197,_0x4bfd3a['push'](_0x2ff235),addLog('[Banana]\x20修'+'图模式：指令\x20=\x20'+_0x535cf2);}const _0x5e1ae0={};_0x5e1ae0['aspectRati'+'o']=_0x636bb3;const _0x493ebd={};_0x493ebd[_0x1fdf72(0x14,-0x72,-0x2f,-0x1b)+'g']=_0x5e1ae0,_0x4b98c9={'model':_0x2e6d50,'messages':_0x4bfd3a['filter'](_0x1cd27c=>_0x1cd27c[_0x1fdf72(-0xc6,-0x84,-0x3f,-0x23)][_0x1fdf72(-0xab,-0x58,-0x84,-0x78)]>0x246d+-0x588+-0x1ee5),'config':_0x493ebd},_0x3b43ce[_0x40621b(0x49,0x6e,0x42,0x98)](addLog,_0x1fdf72(-0xa3,-0x53,-0xb8,-0x3d)+_0x40621b(0x13e,0x17b,0xeb,0x112)+_0x40621b(0x96,0x5e,0x6f,0x40)+'oad\x20with\x20'+_0x4b98c9['messages'][_0x1fdf72(-0x49,-0x58,-0x41,-0x10)]+_0x40621b(0xa6,0x55,-0x6,0x2b));}let _0x4deed4=_0x2de382[_0x1fdf72(0x25,-0x6c,0x27,-0x1c)](/\/$/,''),_0x558e7d;if(_0x4deed4[_0x1fdf72(-0x7c,0x15,0x3d,0x42)](_0x3b43ce[_0x40621b(0x14f,0xbc,0x137,0xe6)])||_0x4deed4['includes'](_0x1fdf72(-0x1c,-0x7a,0x14,-0x3e))){if(_0x1fdf72(-0x98,-0xbd,-0x9a,-0xc5)!==_0x3b43ce[_0x1fdf72(-0xb8,-0xc5,-0x88,-0x126)]){const _0x253bf9={};_0x253bf9[_0x40621b(0xed,0xdc,0xad,0x13c)+'on']=[],_0x253bf9['fixedPromp'+'t']='',_0x21a29b=_0x16bd2f[_0x5dc39d]||_0x253bf9;}else _0x558e7d=_0x3b43ce[_0x1fdf72(-0xa3,-0x5b,-0x8c,-0x33)](_0x4deed4,_0x3f53cf);}else{if(_0x3b43ce[_0x40621b(0xdd,0x1f,0x59,0x75)](_0x1fdf72(0x8d,0x4b,0x61,0x5b),_0x3b43ce['sCnkU'])){const _0x44e3a4=[],_0xc11621=_0x3b43ce[_0x1fdf72(-0x64,-0x38,-0x3,-0xb2)](_0x2c8825,_0x367ab0),_0x542411=[_0x2bac37['fixedPromp'+'t'],_0xc11621,_0x47837d[_0x40621b(0x166,0x89,0x82,0xeb)+'mpt']][_0x40621b(0xed,0xaa,0x179,0x139)](_0x82c37a)['join'](',\x20'),_0x4aa98d={};_0x4aa98d['type']=_0x1fdf72(-0x29,-0x46,-0xb7,-0x72),_0x4aa98d['text']=_0x542411,_0x44e3a4[_0x40621b(0x128,0xe1,0xbb,0x13d)](_0x4aa98d);if(_0x30ce7b){const _0x21b58f={};_0x21b58f['url']=_0x407bda;const _0x13800f={};_0x13800f[_0x1fdf72(-0x64,-0xc0,-0x80,-0x32)]=_0x3b43ce[_0x40621b(0xe4,0x2d,0x93,0xa8)],_0x13800f[_0x1fdf72(-0xbb,-0xae,-0xe4,-0x9a)]=_0x21b58f,_0x44e3a4[_0x40621b(0x1c1,0x1a6,0x114,0x13d)](_0x13800f),_0x3b43ce[_0x40621b(0xd0,0xef,0xbc,0xb6)](_0x2f0749,'[Banana]\x20修'+_0x1fdf72(0x9d,0x14,0x1,-0x65)+_0x1fdf72(0x86,0xe,0x45,-0x3f));}const _0x1b1adf={};_0x1b1adf[_0x40621b(0xb4,0xbd,0x115,0xd9)]=_0x3b43ce[_0x40621b(-0x40,0x8b,0x4b,0x4a)],_0x1b1adf[_0x1fdf72(-0x10a,-0x84,-0xa,-0x5b)]=_0x44e3a4,_0x5718ac[_0x1fdf72(0x67,0x53,0x5e,0x96)](_0x1b1adf),_0x3b43ce[_0x40621b(0xaf,0x81,0x30,0x1c)](_0x9baa59,'[Banana]\x20修'+_0x40621b(0xc5,-0x27,-0xb,0x33)+_0x542411);}else _0x558e7d=_0x3b43ce['mHNDv'](_0x3b43ce[_0x40621b(0xad,0x182,0x8d,0x10a)](_0x4deed4,_0x3b43ce['fgxBr']),_0x3f53cf);}_0x558e7d=_0x558e7d[_0x1fdf72(-0xf2,-0x6c,-0xfd,-0x11)](/\/v1\/v1\//g,_0x3b43ce[_0x40621b(0x110,0xc1,0x158,0x10c)]);function _0x40621b(_0x16e4a5,_0xe04ac,_0x2f8234,_0x245175){return _0xe158(_0x245175- -0xc9,_0xe04ac);}addLog(_0x40621b(0xb4,0x90,0xe6,0x120)+_0x1fdf72(-0x1b,-0xa4,-0x100,-0x11e)+_0x40621b(0x2b,0x9c,0xa2,0x90)+_0x558e7d),_0x3b43ce[_0x40621b(0x10b,0xe8,0x1a5,0x121)](addLog,_0x40621b(0x6,0xc0,0x1b,0x6f)+_0x40621b(0x17f,0xeb,0x10a,0x10b)+JSON['stringify'](_0x4b98c9,null,-0x1*-0x53+-0xf20+-0xdf*-0x11));try{await _0x3b43ce[_0x40621b(0x100,0xfc,0xaf,0x94)](waitForLock),_0x3b43ce[_0x40621b(0xa1,0x80,0x5d,0xc3)](acquireLock);const _0x4f3e37=await _0x3b43ce[_0x40621b(0x75,0x170,0x10d,0xf2)](fetch,_0x558e7d,{'method':_0x3b43ce[_0x40621b(0x31,-0x54,0x27,0x2c)],'headers':{'Content-Type':_0x3b43ce['WiziD'],'Authorization':'Bearer\x20'+_0x87125a},'body':JSON[_0x40621b(0xaa,0x6f,0x6c,0xd4)](_0x4b98c9)});if(!_0x4f3e37['ok']){const _0x2d1840=await _0x4f3e37[_0x1fdf72(0xe,-0x46,0x15,0x35)]();throw new Error(_0x1fdf72(-0xe0,-0x8c,-0x76,-0xdd)+'t\x20failed\x20w'+_0x1fdf72(0x32,0x4,0x3e,0x32)+'\x20'+_0x4f3e37[_0x1fdf72(0x9a,0x11,0x89,0x52)]+':\x20'+_0x2d1840);}const _0x3b82c4=await _0x4f3e37[_0x1fdf72(0xb3,0x25,-0x44,0x88)]();let _0x1a00bb='';const _0x26c1ab=_0x3b82c4['choices'];if(_0x26c1ab&&_0x3b43ce[_0x40621b(0x1a,-0x8,0x9,0x38)](_0x26c1ab[_0x40621b(0x22,0x35,0x85,0x92)],0x498+0x261b*-0x1+-0x1*-0x2183)){const _0x1b3899=_0x26c1ab[0x5*0x6b9+0xe5e+0xad*-0x47]['message']?.[_0x40621b(0x2,0xe1,0x23,0x66)];if(Array[_0x40621b(0xff,0x13c,0x129,0x118)](_0x1b3899)){if(_0x3b43ce[_0x1fdf72(-0x9,-0x3c,0x7,-0x84)](_0x3b43ce[_0x1fdf72(0xae,0x3b,0x6e,-0x17)],_0x3b43ce[_0x1fdf72(0xb6,0x3b,-0x53,0x9c)]))_0x3a3a0f=_0x3b43ce[_0x1fdf72(-0xa3,-0x97,-0xac,-0xbe)](_0x3b43ce[_0x1fdf72(0xac,0x41,0xc7,0x7)](_0x28a48b,',\x20'),_0x4674db[_0x40621b(0x61,0xad,0x49,0x65)+_0x551e20+_0x40621b(0x1bc,0x162,0x12d,0x133)]);else for(const _0x335798 of _0x1b3899){if(_0x335798[_0x1fdf72(-0x67,-0xc0,-0xac,-0xfa)]===_0x3b43ce[_0x1fdf72(0x3a,-0x42,-0x4f,-0xb4)]&&_0x335798['image_url']?.[_0x40621b(0x8a,0x140,0x113,0xd0)]){_0x1a00bb=_0x335798[_0x40621b(0x25,0x9c,0x34,0x3c)]['url'];break;}}}else{if(_0x3b43ce[_0x40621b(0x14,-0x47,0xc5,0x44)](typeof _0x1b3899,_0x1fdf72(-0x90,-0x8b,-0x11c,-0xe4))){if(_0x3b43ce[_0x40621b(0xd1,0x198,0xfe,0x13f)](_0x3b43ce[_0x40621b(0x11d,0xda,0xf5,0x12d)],_0x3b43ce['eNibP']))throw new _0x22f476(_0x3b43ce[_0x40621b(0x126,0xc1,0xe8,0x10d)]);else addLog(_0x3b43ce[_0x40621b(0x75,0x69,0xee,0x62)]);}}}if(!_0x1a00bb)throw new Error(_0x3b43ce[_0x40621b(0x173,0xfb,0x137,0x10d)]);return _0x3b43ce[_0x40621b(0x3b,0x7,0xc3,0x91)](releaseLock),_0x3b43ce['bqfrZ'](addLog,_0x3b43ce[_0x1fdf72(0x9c,0x26,0x3f,-0x47)]),{'image':_0x1a00bb,'change':_0x3b43ce[_0x40621b(0x105,0xda,0xd4,0x126)](_0x259c7a,'')};}catch(_0x257a7b){releaseLock(),addLog('[Banana]\x20F'+'etch\x20error'+':\x20'+_0x257a7b['message']),console[_0x1fdf72(0x12,-0x36,-0xaf,0x2a)](_0x3b43ce[_0x40621b(0x11f,0xc8,0xc1,0xa5)],_0x257a7b);throw _0x257a7b;}}function _0xe158(_0x5c0db5,_0x5c8984){_0x5c0db5=_0x5c0db5-(-0xb29*0x1+-0x1*0xb99+0x17a5);const _0x2333f7=_0x18dc();let _0x290e47=_0x2333f7[_0x5c0db5];if(_0xe158['HxzPYr']===undefined){var _0x3e4d19=function(_0x4a4c21){const _0x33ebdd='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x1685b7='',_0x1845c1='',_0x59b305=_0x1685b7+_0x3e4d19;for(let _0x5ef727=-0x1*-0x24f+0xbb*-0x9+0x6*0xb6,_0x3ec134,_0x2dfef2,_0x213703=-0x1fb6+0x9b7+0x1*0x15ff;_0x2dfef2=_0x4a4c21['charAt'](_0x213703++);~_0x2dfef2&&(_0x3ec134=_0x5ef727%(-0x3a*-0xa4+0x4b9+-0x29dd)?_0x3ec134*(-0x173d+0x6e1*0x1+0x4*0x427)+_0x2dfef2:_0x2dfef2,_0x5ef727++%(-0xa3*-0x19+0x267*0x2+-0x14b5))?_0x1685b7+=_0x59b305['charCodeAt'](_0x213703+(-0x1380+0x1*-0x58f+0x101*0x19))-(-0x1d57+-0x586+0x22e7)!==0x1*0xe33+-0x22db+-0x14a8*-0x1?String['fromCharCode'](0x658+-0x1*-0x2087+-0x25e0*0x1&_0x3ec134>>(-(-0x82c+-0x9f2+0x1*0x1220)*_0x5ef727&-0x3*0x1d3+0x10be+0x1*-0xb3f)):_0x5ef727:-0x21ae+0x786*0x1+0x1a28){_0x2dfef2=_0x33ebdd['indexOf'](_0x2dfef2);}for(let _0x266c8c=0x1eac+0x86*0x19+-0x2bc2,_0x5489ac=_0x1685b7['length'];_0x266c8c<_0x5489ac;_0x266c8c++){_0x1845c1+='%'+('00'+_0x1685b7['charCodeAt'](_0x266c8c)['toString'](-0x5fe+0x107e+-0xa70))['slice'](-(-0x6*-0xb3+-0x11bd+-0x1*-0xd8d));}return decodeURIComponent(_0x1845c1);};_0xe158['BLDHbU']=_0x3e4d19,_0xe158['YWQnJe']={},_0xe158['HxzPYr']=!![];}const _0x34422b=_0x2333f7[-0x14*0xce+-0xb*0xb+0x1091],_0x1716f2=_0x5c0db5+_0x34422b,_0x174da1=_0xe158['YWQnJe'][_0x1716f2];if(!_0x174da1){const _0x2990a8=function(_0x30329b){this['vMWEgs']=_0x30329b,this['mnRALc']=[-0x2*0xa46+0xabb*0x2+-0xe9,0x19*-0x2b+0x1492+0x1*-0x105f,-0x1c14+-0x19d1*0x1+-0x3*-0x11f7],this['qnWJeQ']=function(){return'newState';},this['IERYxy']='\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*',this['tuWSVh']='[\x27|\x22].+[\x27|\x22];?\x20*}';};_0x2990a8['prototype']['VhnMMv']=function(){const _0x5c5512=new RegExp(this['IERYxy']+this['tuWSVh']),_0x4468b4=_0x5c5512['test'](this['qnWJeQ']['toString']())?--this['mnRALc'][-0xd*-0x8a+0x164e+-0x9c5*0x3]:--this['mnRALc'][-0xc7e+-0x1*-0x8f5+-0x5*-0xb5];return this['NiWFpZ'](_0x4468b4);},_0x2990a8['prototype']['NiWFpZ']=function(_0x4d36f7){if(!Boolean(~_0x4d36f7))return _0x4d36f7;return this['qwZsiP'](this['vMWEgs']);},_0x2990a8['prototype']['qwZsiP']=function(_0x30fff){for(let _0x168503=0xccf+-0x1df*0xb+0x7c6,_0x233aed=this['mnRALc']['length'];_0x168503<_0x233aed;_0x168503++){this['mnRALc']['push'](Math['round'](Math['random']())),_0x233aed=this['mnRALc']['length'];}return _0x30fff(this['mnRALc'][-0x1503+0xb*-0x2a+0x16d1]);},new _0x2990a8(_0xe158)['VhnMMv'](),_0x290e47=_0xe158['BLDHbU'](_0x290e47),_0xe158['YWQnJe'][_0x1716f2]=_0x290e47;}else _0x290e47=_0x174da1;return _0x290e47;}export async function bananaGenerate(_0x32a4b9){const _0x4fcd37={'mfebk':function(_0x3057ef,_0x1dd558){return _0x3057ef(_0x1dd558);},'DFvAq':_0x4e1848(0x192,0x15f,0x11b,0x10c),'wCWpP':function(_0x51db0a,_0x2382d6){return _0x51db0a(_0x2382d6);},'zZLdF':function(_0x2fe908){return _0x2fe908();},'cbKQW':function(_0xcd26b,_0x386158){return _0xcd26b(_0x386158);},'LUVLS':function(_0x56ef97,_0x4e41b5){return _0x56ef97===_0x4e41b5;},'VHRSw':'vaXyH','MPzPi':_0x4e1848(0x1ad,0x19d,0x164,0x1cd),'dkWjb':function(_0x37fb18,_0x55cf6a){return _0x37fb18===_0x55cf6a;},'Zcoeo':_0x38aae4(0xac,-0x32,-0x15,0x1e),'DDcfC':function(_0x429c88,_0x3abf95){return _0x429c88(_0x3abf95);},'GWdzc':function(_0x2897b9,_0x1bfb4b){return _0x2897b9!=_0x1bfb4b;},'SBUjt':function(_0x58e802,_0x5893a0){return _0x58e802!==_0x5893a0;},'VlaTa':'kLGcc','mFthB':function(_0xf17a59,_0x5aca0c,_0x4e94fe,_0x42df1b){return _0xf17a59(_0x5aca0c,_0x4e94fe,_0x42df1b);},'eQPhU':function(_0x1b6bf2,_0x496367){return _0x1b6bf2+_0x496367;},'PJhst':function(_0x551518,_0xbea726){return _0x551518(_0xbea726);},'xEzyy':function(_0x2dd7e1,_0x25384d){return _0x2dd7e1(_0x25384d);},'myoXz':function(_0x51c15a,_0x611858){return _0x51c15a(_0x611858);},'HrQsI':function(_0x53efc8,_0x2b8969){return _0x53efc8(_0x2b8969);},'hQveH':function(_0x520036,_0x36400e){return _0x520036(_0x36400e);}};_0x4fcd37[_0x4e1848(0x1e7,0x219,0x1e4,0x26b)](clearLog);function _0x38aae4(_0x54065f,_0x5345cb,_0x2783b3,_0xadbf38){return _0xe158(_0xadbf38- -0x138,_0x54065f);}let {id:_0x5879a7,prompt:_0x3e62c0,width:_0xf2145,height:_0x336911,change:_0x1fcd67,retouchPrompt:_0x453cc7,retouchImage:_0x2f66e8}=_0x32a4b9;_0x4fcd37[_0x38aae4(-0x68,0x80,0x0,-0x12)](addLog,_0x4e1848(0x233,0x145,0x1bf,0x225)+'eceived\x20im'+'age\x20genera'+_0x4e1848(0x115,0x129,0x130,0x11b)+_0x4e1848(0x1a7,0x166,0x12d,0x14d)+_0x5879a7+')');let _0x262832='';_0x1fcd67?_0x4fcd37[_0x4e1848(0x1e6,0x14f,0x181,0x1af)](_0x4fcd37[_0x38aae4(0x73,0x2f,-0x23,0x4d)],_0x4fcd37[_0x38aae4(0xdc,0x82,0xa9,0x4d)])?_0x262832=_0x1fcd67[_0x4e1848(0x1ea,0x16c,0x15f,0x1c5)](_0x4fcd37['MPzPi'],''):_0x5a6ecb[_0x4e1848(0x169,0x113,0x151,0x102)+_0x38aae4(-0x23,0x93,-0x52,0x2)+'ener']&&(_0x3c8e14[_0x4e1848(0x1c7,0x1e9,0x216,0x26d)+_0x4e1848(0x18a,0x158,0x1db,0x1e9)](_0x5627a0[_0x4e1848(0xeb,0xfe,0x149,0x1db)+_0x4e1848(0x111,0x13d,0x1a3,0x182)+'ST'],_0x52a193),_0x3ffea8['forEach'](_0x1436e2=>{function _0x5d568f(_0x574354,_0x585723,_0x57c889,_0x25df71){return _0x4e1848(_0x574354-0x24,_0x57c889,_0x574354-0x7e,_0x25df71-0x1d2);}function _0x3bbf25(_0x365f94,_0x5dc7e4,_0xda3832,_0xa9439){return _0x38aae4(_0xa9439,_0x5dc7e4-0x3,_0xda3832-0x14,_0x5dc7e4-0x30d);}_0x3494f6[_0x5d568f(0x294,0x25c,0x235,0x236)+_0x3bbf25(0x388,0x39a,0x3c1,0x30b)](_0x1436e2,_0xc7833e);}),_0x1fe754[_0x38aae4(-0x90,0x39,0x34,0x3)+_0x4e1848(0x106,0x114,0x150,0x199)+_0x38aae4(0x1,0x114,0x15,0x8d)]=![],_0x4fcd37[_0x38aae4(0x64,0x11d,0xb4,0xa6)](_0x405467,_0x38aae4(0x9e,0xc5,0xed,0xc3)+'图事件监听器已关闭。')):_0x262832=_0x3e62c0;function _0x4e1848(_0x143a9e,_0x493818,_0x400f1a,_0x27f5ac){return _0xe158(_0x400f1a-0x16,_0x493818);}if(_0x1fcd67&&_0x1fcd67[_0x4e1848(0x13e,0x169,0x11c,0xc4)](_0x4fcd37['MPzPi'])){if(_0x4fcd37[_0x38aae4(0x3c,0x30,0x3d,0xa4)](_0x4fcd37[_0x4e1848(0x187,0x245,0x1fa,0x1fd)],'xpJGp')){if(_0x46f588){const _0x5467ba=_0x28e797[_0x4e1848(0x194,0x14f,0x134,0xe4)](_0x132194,arguments);return _0x39ac00=null,_0x5467ba;}}else{_0x4fcd37['wCWpP'](addLog,_0x4e1848(0x138,0x1a2,0x15a,0x1b3)+'启动');if(_0x453cc7)_0x4fcd37['wCWpP'](addLog,_0x4e1848(0x18a,0x267,0x215,0x1d3)+_0x453cc7);if(_0x2f66e8)_0x4fcd37['DDcfC'](addLog,_0x38aae4(-0xa1,0x3d,-0x99,-0x3e)+']');}}try{const {image:_0x301aae,change:_0x2c1bdc}=await generateBananaImage({'prompt':_0x3e62c0,'width':_0xf2145,'height':_0x336911,'change':_0x1fcd67,'retouchPrompt':_0x453cc7,'retouchImage':_0x2f66e8});if(_0x4fcd37['GWdzc'](extension_settings[extensionName][_0x4e1848(0x169,0x75,0x108,0x149)],'0')){if(_0x4fcd37[_0x38aae4(0x1b,0x8b,0x45,0x7d)](_0x4fcd37[_0x4e1848(0x159,0x180,0x15b,0x1be)],'RzCKD')){const _0x2bb3cd={};_0x2bb3cd[_0x38aae4(0xcb,0xf9,0xeb,0x6d)]=_0x262832,await _0x4fcd37[_0x4e1848(0x1cd,0x116,0x142,0x111)](setItemImg,_0x3e62c0,_0x301aae,_0x2bb3cd),addLog('图像已存入数据库\x20f'+'or\x20prompt:'+'\x20'+_0x3e62c0),extension_settings[extensionName][_0x4e1848(0x17a,0x1dd,0x1a4,0x1a5)]['cishu']?(extension_settings[extensionName]['banana'][_0x38aae4(-0xa1,0x15,-0x2f,-0x49)]=_0x4fcd37[_0x38aae4(0x7c,-0x2f,0x27,-0x18)](extension_settings[extensionName]['banana'][_0x38aae4(-0xc5,-0xc1,-0x30,-0x49)],-0xa*0x1a8+0x2b*0x34+0x1*0x7d5),_0x4fcd37[_0x4e1848(0x190,0x134,0x198,0x1f2)](addLog,_0x4e1848(0x135,0x1d8,0x1b7,0x141)+_0x4e1848(0x120,0x1d7,0x16b,0x128)+extension_settings[extensionName][_0x4e1848(0x1f8,0x1c7,0x1a4,0x1f1)][_0x38aae4(-0x64,-0x8a,-0x48,-0x49)])):(extension_settings[extensionName][_0x4e1848(0x1c7,0x1af,0x1a4,0x150)][_0x38aae4(0x2,-0x67,-0x61,-0x49)]=-0x8*0xc1+0xfa0+-0x1eb*0x5,_0x4fcd37[_0x38aae4(0x120,0xa3,0x93,0xab)](addLog,_0x38aae4(0x95,0xb6,-0x12,0x69)+_0x38aae4(0x9e,0x3a,-0x9,0x1d)+extension_settings[extensionName][_0x4e1848(0x178,0x1a9,0x1a4,0x177)]['cishu']));}else{const _0x59d2fe={};_0x59d2fe[_0x38aae4(0x1a,0x44,0x9c,0x61)]=_0x76cd88;const _0x3b244f={};_0x3b244f['type']=_0x4fcd37[_0x4e1848(0x181,0x1b5,0x1f5,0x203)],_0x3b244f['image_url']=_0x59d2fe,_0x21d09a[_0x38aae4(0x106,0x97,0x59,0xce)](_0x3b244f),_0x4fcd37['wCWpP'](_0x257def,_0x4e1848(0x1eb,0x158,0x1e6,0x241)+_0x4e1848(0x176,0x236,0x1dd,0x186)+_0x38aae4(0x69,0x2,0x45,0x89));}}else _0x4fcd37[_0x4e1848(0x1f6,0x24f,0x1f3,0x16f)](addLog,'缓存设置为不存入数据'+'库');const _0x444218={};_0x444218['id']=_0x5879a7,_0x444218['success']=!![],_0x444218['imageData']=_0x301aae,_0x444218[_0x38aae4(-0xa7,-0x86,-0xa6,-0x34)]=_0x3e62c0,_0x444218[_0x38aae4(0x75,0xd5,0xb8,0x6d)]=_0x262832,eventSource[_0x38aae4(0x4d,0xc,-0x7e,-0x35)](EventType[_0x38aae4(0x8d,0x62,0x7e,-0x5)+'MAGE_RESPO'+_0x38aae4(-0x11,0x17,0x6b,0x79)],_0x444218),_0x4fcd37[_0x38aae4(0x3e,-0x32,-0x31,-0x54)](addLog,_0x4e1848(0x16d,0xf3,0x100,0x96)+'mitted\x20suc'+_0x38aae4(0x115,0x40,0xb1,0x9f)+'nse\x20for\x20ID'+':\x20'+_0x5879a7);}catch(_0x5c01c6){const _0x2a609e=_0x38aae4(-0x1b,0x29,-0x13,-0x39)+_0x4e1848(0x1f4,0x2a3,0x21a,0x215)+'failed\x20for'+_0x4e1848(0x2a9,0x26d,0x217,0x1aa)+_0x5879a7+':\x20'+_0x5c01c6['message'];_0x4fcd37[_0x38aae4(-0x25,0x2e,0x3,-0x52)](addLog,_0x2a609e),console[_0x4e1848(0x213,0x136,0x193,0x1fa)](_0x2a609e);const _0x53513f={};_0x53513f['id']=_0x5879a7,_0x53513f[_0x4e1848(0x158,0x144,0x1b2,0x12b)]=![],_0x53513f['error']=_0x5c01c6[_0x38aae4(-0xd,-0x33,-0x4e,-0x28)],_0x53513f['prompt']=_0x3e62c0,eventSource[_0x38aae4(0x10,-0x9,0x3b,-0x35)](EventType[_0x38aae4(-0x64,0x2a,0x4e,-0x5)+'MAGE_RESPO'+'NSE'],_0x53513f),addLog(_0x4e1848(0x83,0x6d,0x100,0xab)+_0x38aae4(0x6,0x59,-0x7a,-0x17)+_0x4e1848(0x1b7,0x184,0x133,0x15e)+_0x38aae4(0x10,-0x3,0x91,0x78)+':\x20'+_0x5879a7);}}const LEGACY_EVENT_NAMES=[_0x5e6c8f(-0x1bc,-0x15e,-0x1b2,-0x1ff)+_0x591cb3(0x401,0x4c3,0x3ef,0x483)+'st',_0x5e6c8f(-0x22b,-0x1d9,-0x1fa,-0x1df)+'mage_reque'+'st'];function initializeBananaListener(){const _0x4f73f2={'daWfz':function(_0x4fbdbe,_0x209234){return _0x4fbdbe!==_0x209234;},'lcTlk':_0x5de9c0(0x1ae,0x199,0x1da,0x12a),'bzrvH':function(_0x3df466,_0xb2d99c){return _0x3df466(_0xb2d99c);},'aPgPk':'banana\x20生图事'+_0x5de9c0(0x14f,0x110,0xb6,0x89)};eventSource['on'](EventType['GENERATE_I'+_0x5de9c0(0x140,0x1a6,0x1e5,0x17f)+'ST'],bananaGenerate);function _0x5de9c0(_0x5c6dea,_0x47df89,_0xf5b71,_0x435a04){return _0x5e6c8f(_0x47df89-0x3ca,_0x47df89-0x85,_0xf5b71-0x183,_0x5c6dea);}LEGACY_EVENT_NAMES[_0x5de9c0(0x22c,0x1fe,0x270,0x1dc)](_0x1c120e=>{function _0x51faf5(_0x2c779e,_0x489c70,_0x29fa45,_0x359f0e){return _0x5de9c0(_0x2c779e,_0x29fa45-0x382,_0x29fa45-0x118,_0x359f0e-0x6d);}function _0xc50452(_0x45eb6c,_0x5dff27,_0x25e355,_0x52b335){return _0x5de9c0(_0x25e355,_0x45eb6c-0x27d,_0x25e355-0x1e,_0x52b335-0x1ad);}if(_0x4f73f2[_0xc50452(0x454,0x3eb,0x3e2,0x4dc)](_0x4f73f2['lcTlk'],_0xc50452(0x450,0x3cf,0x3dd,0x430)))eventSource['on'](_0x1c120e,bananaGenerate);else{const _0x5df390=_0x28f2e0[_0xc50452(0x3b4,0x323,0x3be,0x3da)](_0x57a441,arguments);return _0x18a150=null,_0x5df390;}});function _0x51d713(_0x271ef5,_0x4d3c6d,_0x458d87,_0x338f61){return _0x591cb3(_0x271ef5-0xdc,_0x271ef5,_0x458d87-0x1e8,_0x338f61- -0x147);}_0x4f73f2[_0x5de9c0(0x140,0x1a3,0x191,0x118)](addLog,_0x4f73f2[_0x5de9c0(0x1b4,0x12a,0x182,0x10c)]);}export async function replaceWithBanana(){function _0x5ec770(_0x47da2e,_0x53347f,_0xc8d2e6,_0x5b058c){return _0x591cb3(_0x47da2e-0xc2,_0xc8d2e6,_0xc8d2e6-0x184,_0x53347f- -0x494);}const _0x59714a={'YvAjp':function(_0x8d24ec,_0x3bb454){return _0x8d24ec(_0x3bb454);},'CrOao':_0x5ec770(-0x27,-0x38,0x32,-0x30)+_0x5ec770(0x58,0x62,0xd6,0xb1),'xpRdL':function(_0x8ac0a1,_0x4b876e){return _0x8ac0a1<=_0x4b876e;},'GjFDj':function(_0x27ada5,_0x3e2629){return _0x27ada5+_0x3e2629;},'QbRXM':'[Banana]\x20启'+_0x58de75(0x417,0x3f9,0x48c,0x459)+'。','SRJrk':function(_0x1dfb83,_0x5a48c8){return _0x1dfb83||_0x5a48c8;},'HvJIR':function(_0x5391e9,_0x50d222){return _0x5391e9===_0x50d222;},'NwVXd':_0x58de75(0x3fa,0x406,0x3a1,0x3b8),'kwywV':function(_0x1a70f8,_0x199cf2){return _0x1a70f8==_0x199cf2;},'lVBYT':'banana','seKTT':function(_0x33ab6c){return _0x33ab6c();},'aRFdD':function(_0x53d472,_0x5f019e){return _0x53d472!==_0x5f019e;},'ZWheU':'XuMEf','mDaoI':function(_0x5e88f3,_0x40a15f){return _0x5e88f3!==_0x40a15f;},'eLjMP':_0x5ec770(-0x5b,-0x4f,-0x4d,0x36),'BVSGa':function(_0x22ed95,_0x5b76b6){return _0x22ed95(_0x5b76b6);},'wliXl':_0x58de75(0x439,0x442,0x4b2,0x3eb)+_0x58de75(0x3c8,0x444,0x431,0x3c5)};function _0x58de75(_0x34669b,_0x898d27,_0x286651,_0x4daf48){return _0x5e6c8f(_0x898d27-0x5f8,_0x898d27-0x128,_0x286651-0x1c7,_0x286651);}if(_0x59714a[_0x5ec770(-0x28,-0x49,-0x85,-0x4a)](extension_settings[extensionName][_0x5ec770(0xe5,0x61,-0x20,0x40)],_0x59714a[_0x58de75(0x438,0x403,0x414,0x3f7)]))!window[_0x5ec770(-0x8,-0x4a,-0x71,-0xc4)+_0x58de75(0x2f6,0x381,0x3da,0x323)+_0x58de75(0x3bc,0x40c,0x466,0x41f)]&&(window['initialize'+_0x58de75(0x2f9,0x381,0x33d,0x3f4)+_0x58de75(0x499,0x40c,0x468,0x47a)]=!![],_0x59714a['seKTT'](initializeBananaListener)),_0x59714a[_0x58de75(0x37b,0x37c,0x38f,0x3ad)](initializeImageProcessing);else{if(_0x59714a['aRFdD'](_0x59714a['ZWheU'],_0x59714a[_0x58de75(0x3d0,0x3cf,0x390,0x38b)])){_0x59714a[_0x58de75(0x489,0x450,0x459,0x429)](_0x58c5a7,_0x59714a['CrOao']),_0x2fdd85=_0x2902c0(_0x441ef4),_0x3d395e=_0x1a916b['Scene\x20Comp'+'osition'];for(let _0x3483ec=0x1942+-0x1cba*0x1+0x7*0x7f;_0x59714a[_0x58de75(0x367,0x378,0x2ee,0x39f)](_0x3483ec,0x2*0x10a9+-0x89f+-0x47*0x59);_0x3483ec++){_0x24be0a[_0x5ec770(-0x82,-0x57,-0x9a,-0xbb)+_0x3483ec+_0x58de75(0x434,0x443,0x3e6,0x3c0)]&&(_0x56035d=_0x59714a[_0x58de75(0x3f7,0x3af,0x3c0,0x3d1)](_0x4bc850,',\x20')+_0x26f996[_0x5ec770(-0x6d,-0x57,-0xda,-0x66)+_0x3483ec+'\x20Prompt']);}}else{if(window[_0x5ec770(-0xc,-0x4a,0x15,-0xb2)+_0x58de75(0x321,0x381,0x2f7,0x35c)+_0x58de75(0x3b3,0x40c,0x430,0x440)]){if(_0x59714a['mDaoI'](_0x59714a[_0x58de75(0x3a3,0x3c1,0x357,0x35e)],_0x5ec770(0xd4,0x4a,0xb5,0x52)))eventSource[_0x58de75(0x40c,0x447,0x3fa,0x440)+'ener'](EventType[_0x5ec770(-0x9f,-0x52,0x41,-0xdb)+_0x58de75(0x383,0x3d4,0x3d4,0x3b7)+'ST'],bananaGenerate),LEGACY_EVENT_NAMES['forEach'](_0x397960=>{function _0x174471(_0x2527b8,_0x4c9d2c,_0x127c92,_0x587c63){return _0x5ec770(_0x2527b8-0x1b7,_0x4c9d2c-0x2da,_0x127c92,_0x587c63-0x4b);}const _0x556647={'Xmzwq':function(_0x5baae2,_0x6ead0e){return _0x5baae2(_0x6ead0e);},'pjMoy':_0x59714a[_0x2fbe44(0x502,0x4d4,0x4f0,0x51b)],'YFGOv':function(_0xd8006,_0x41c116){function _0x4988c5(_0x83d626,_0x5bae9e,_0x581a81,_0x131279){return _0x2fbe44(_0x83d626-0xaf,_0x5bae9e,_0x581a81-0x16a,_0x83d626- -0x155);}return _0x59714a[_0x4988c5(0x32d,0x35c,0x2b9,0x2f3)](_0xd8006,_0x41c116);}};function _0x2fbe44(_0x3600eb,_0xa88de3,_0x309293,_0x7b079f){return _0x5ec770(_0x3600eb-0x16f,_0x7b079f-0x4f3,_0xa88de3,_0x7b079f-0x6);}if(_0x59714a[_0x174471(0x38e,0x2ff,0x31f,0x340)](_0x59714a['NwVXd'],_0x59714a[_0x2fbe44(0x4b3,0x4c1,0x4ee,0x4f9)]))eventSource[_0x174471(0x38f,0x355,0x355,0x329)+'ener'](_0x397960,bananaGenerate);else{_0x556647[_0x174471(0x1d6,0x252,0x276,0x286)](_0x32cdae,_0x556647['pjMoy']);const _0xbdad88=_0x556647['YFGOv'](_0x5b1cda,'默认'),_0x1c1cf7={};_0x1c1cf7[_0x174471(0x38a,0x35a,0x2cf,0x2e1)+'on']=[],_0x1c1cf7['fixedPromp'+'t']='',_0x530b9b=_0x2b6912[_0xbdad88]||_0x1c1cf7,_0x3a9acb(_0x174471(0x251,0x2d8,0x33b,0x28d)+'用修图预设:\x20\x22'+_0xbdad88+'\x22');}}),window[_0x5ec770(-0x54,-0x4a,-0x10,0x3b)+_0x58de75(0x306,0x381,0x36b,0x32f)+_0x5ec770(-0x7,0x40,0x84,-0x12)]=![],_0x59714a[_0x5ec770(-0x44,0x2e,0x65,0x25)](addLog,_0x59714a[_0x58de75(0x3d3,0x410,0x381,0x437)]);else{_0x59714a[_0x58de75(0x473,0x450,0x4b3,0x455)](_0x33e65e,'Banana修图模式'+'启动');if(_0x5105b7)_0x59714a['YvAjp'](_0x19f455,_0x5ec770(0x82,0x7a,0xe1,0xb1)+_0x39720d);if(_0x2788bd)_0x59714a[_0x5ec770(0x109,0x84,0xa6,0x89)](_0x295471,'修图图片:\x20[已提供'+']');}}}}}
//# sourceMappingURL=http://localhost:8000/banana.js.map