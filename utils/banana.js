(function(_0x510305,_0x11f778){function _0x20abb3(_0x20ff9b,_0x2a5b09,_0x53b670,_0x94d298){return _0x5509(_0x53b670-0x37e,_0x94d298);}function _0x138c75(_0x4b33a3,_0x412043,_0x5c6139,_0x5b86b8){return _0x5509(_0x4b33a3- -0xd8,_0x412043);}const _0x150921=_0x510305();while(!![]){try{const _0xba6394=parseInt(_0x20abb3(0x57d,0x538,0x598,0x584))/(0x18*0x7a+-0x2250+0x16e1)*(-parseInt(_0x20abb3(0x59a,0x501,0x58a,0x5fa))/(0x1*0x1135+-0x11*-0x19+-0x4*0x4b7))+-parseInt(_0x138c75(0x108,0x168,0x1a0,0x120))/(-0x1b36+-0x2443+0x3f7c)*(parseInt(_0x138c75(0x128,0x101,0x1a0,0xfd))/(0xed8+-0xba8*0x3+-0x2*-0xa12))+-parseInt(_0x20abb3(0x768,0x5ea,0x6ad,0x76f))/(0x1737+-0x39*-0x43+-0x261d*0x1)*(-parseInt(_0x20abb3(0x63d,0x5fd,0x5b0,0x53e))/(-0x1c2f+0x21d*-0xd+0x37ae))+parseInt(_0x20abb3(0x4f4,0x5a2,0x572,0x51c))/(0x1df*0x3+-0x230b+-0x1*-0x1d75)+parseInt(_0x138c75(0x1f1,0x271,0x2b3,0x2a2))/(0xad0+-0x1d*-0x137+-0x2e03)*(-parseInt(_0x138c75(0x237,0x1f1,0x1c7,0x261))/(0x16*0xe0+-0x1600+-0x1f*-0x17))+-parseInt(_0x20abb3(0x5f2,0x5bc,0x5ee,0x61d))/(-0x4ef*0x2+0x1bc2+-0x392*0x5)*(-parseInt(_0x20abb3(0x625,0x687,0x6c0,0x6e1))/(0xe*-0x225+0x5e2*0x5+0xa7))+-parseInt(_0x20abb3(0x5a1,0x68e,0x629,0x664))/(0x4*-0x2f4+0x3*0x41+0xb19*0x1);if(_0xba6394===_0x11f778)break;else _0x150921['push'](_0x150921['shift']());}catch(_0x1a1d5b){_0x150921['push'](_0x150921['shift']());}}}(_0x3ec6,-0xa1e26+0x63599*-0x2+0x1d7caa));const _0x5d64d0=(function(){function _0x4b58ea(_0x1b8760,_0x6e1dfd,_0x1139e0,_0x4ab511){return _0x5509(_0x1139e0-0x14b,_0x6e1dfd);}const _0x4ab892={'vLXwy':function(_0x1afffb,_0x1ca2cd){return _0x1afffb(_0x1ca2cd);},'SSsvB':'分角色模式:\x20解析带'+'坐标的提示词字符串。','NDtOM':_0x4b58ea(0x3b5,0x3d0,0x3ce,0x47c)+_0x4b58ea(0x3db,0x442,0x467,0x50d),'WWhgR':function(_0x178663,_0x2e616a){return _0x178663<=_0x2e616a;},'JgqhF':_0x3b09e8(0x7b,0xb2,-0x30,0x2c),'jTfWF':_0x4b58ea(0x37f,0x4ba,0x431,0x416)};function _0x3b09e8(_0x572428,_0x23a52f,_0x2a119d,_0x588a28){return _0x5509(_0x588a28- -0x2d8,_0x572428);}let _0x2b993d=!![];return function(_0x26bc75,_0x2fc0d8){function _0x54ba1a(_0x59cef7,_0x327272,_0x43a0f4,_0x4ca11b){return _0x3b09e8(_0x59cef7,_0x327272-0xbb,_0x43a0f4-0x14,_0x4ca11b-0x359);}function _0x4f85ac(_0x12a35b,_0x56c93b,_0x8d74a3,_0x267e60){return _0x3b09e8(_0x12a35b,_0x56c93b-0x58,_0x8d74a3-0x8b,_0x8d74a3-0x36d);}if(_0x4ab892[_0x54ba1a(0x2e2,0x38e,0x327,0x3a5)]===_0x4ab892[_0x4f85ac(0x394,0x457,0x3b2,0x311)]){_0x4ab892[_0x4f85ac(0x28a,0x371,0x2cf,0x2f7)](_0x5e38fb,_0x4ab892['SSsvB']),_0x355572=_0x243a4b(_0x33eabe),_0x5ab62e=_0x2ef154[_0x4ab892[_0x54ba1a(0x1bb,0x27a,0x1cd,0x26a)]];for(let _0x5d3d61=0xa03+0x1531+-0x7*0x475;_0x4ab892[_0x54ba1a(0x34f,0x216,0x2e3,0x2b8)](_0x5d3d61,0x18ce+0x130b+0x2bd5*-0x1);_0x5d3d61++){_0x45ce0a[_0x54ba1a(0x287,0x2f2,0x27f,0x279)+_0x5d3d61+_0x54ba1a(0x460,0x34b,0x3fe,0x3d5)]&&(_0x414027=_0x155ce6+',\x20'+_0x115a83[_0x54ba1a(0x244,0x209,0x286,0x279)+_0x5d3d61+_0x54ba1a(0x46a,0x494,0x40c,0x3d5)]);}}else{const _0x3da297=_0x2b993d?function(){function _0x4039ee(_0x135247,_0x56a21e,_0x1f06c6,_0x1c744b){return _0x4f85ac(_0x1c744b,_0x56a21e-0x1b3,_0x135247- -0x41c,_0x1c744b-0x13e);}if(_0x2fc0d8){const _0x4db627=_0x2fc0d8[_0x4039ee(-0xd0,-0xd,-0xb1,-0x13a)](_0x26bc75,arguments);return _0x2fc0d8=null,_0x4db627;}}:function(){};return _0x2b993d=![],_0x3da297;}};}()),_0x3a74c2=_0x5d64d0(this,function(){const _0x409d1c={};_0x409d1c[_0x411efd(0x177,0x123,0x6b,0xdc)]='(((.+)+)+)'+'+$';const _0x35061c=_0x409d1c;function _0x4f8ba8(_0x31e8a0,_0x483357,_0x1df7c6,_0x551c5e){return _0x5509(_0x1df7c6-0x106,_0x31e8a0);}function _0x411efd(_0x2f0561,_0x3aa5c5,_0x541db4,_0x1ac17e){return _0x5509(_0x3aa5c5- -0xba,_0x2f0561);}return _0x3a74c2[_0x411efd(0x1f0,0x1d4,0x1d8,0x1f9)]()[_0x4f8ba8(0x417,0x2c9,0x38a,0x2ea)](_0x35061c['WAXca'])['toString']()[_0x411efd(0x1e8,0x172,0x11d,0x212)+'r'](_0x3a74c2)[_0x411efd(0x22f,0x1ca,0x22c,0x1b2)](_0x35061c['WAXca']);});function _0x3ec6(){const _0x1e63e6=['C0rsrwi','w0jHBMfUyv0Gvq','AhLTtge','ANrwz1m','C3rYzwfT','ueT3ExO','mtbAt21NsNy','y29UDgvUDa','qLv6wLy','yxrRDwO','qunpyxC','t3PKEe4','y29UDMvYC2f0Aq','BhvKzv9OzwfKzq','y29TCgXLDgvuyq','zxjYB3i','y0Llqw0','5zU+5lQl5lU255Ur5zcS5zMO5BEY5ywZ6zET44cc','Aw9U','B3DUigLTywDLoG','AMTKr2W','zuLSsuS','yxbWBgLJyxrPBW','AxrOihn0yxr1CW','y29UC3rYDwn0BW','w0jHBMfUyv0Grq','BhvYzsbYzxnWBW','B2zQDMe','CIbWCM9TChq6ia','zw5KC1DPDgG','ndjlvujsvu0','55sO55U05O6L6k+35Rgc5QIH5BYp','Bw9KywWGCgf5Ba','rvruzM8','y2fJAgu','v1DOz1i','w0jHBMfUyv0Gra','z0HPELe','DKXyD3K','AML1z3vHBG','EhDsEui','5Qch5yEg5QIH5BYpoIdKVB/NLkJOR7FMSyi','tKHdtLq','Dg9mB3DLCKnHCW','z2uGzM9YBwf0la','DgLVBIb3AxrOia','AhvSAKW','Bw9KzwW','DfrurKi','rvLVtuW','y2fUy2vSx2jHBG','lcdPQ5JLUQyGlsa','DfnpseS','AgjQyKu','5zU+5Rwb56Il44cc5A6I5OI356UV5lI6','5Q2J6z2I5O+q56s66k+noIa','l3yX','DwLSDcbjBwfNzq','DgLVBIbYzxf1zq','ChvZAa','Dgv4Da','C2LUzYbKAxjLyW','wKjYEha','ieLeia','C21stem','w0jHBMfUyv0G55sF','rhHRAwK','5zU+5QIH5BYp77YA5OYh5lUKid0G','wwvxzeS','Bvj3vhO','DxbKyxrLu3rHDa','5lU75yQH5BEY5y+w5RAi','yxjRzg93BIbPBq','5yIg6kEs6iMY5QIH5BYpoIdOP6pMNPdLUky','5zU+5QIH5BYp77YA5BEY5RE75yQG5B6f5l+U5Ps5','sgTlrNa','DeTMtvi','uhfvC2C','CNvUBMLUzW','w0jHBMfUyv0Gtq','AxnbCNjHEq','y2XPzw50','DxnLCG','r2fvBfO','rwXQAha','weXHyKK','t2PrzgK','Aw1Hz2vU','DdOG','CMTKB3DUigLTyq','Bxb0','ue9tva','otKWntbVvuvTwfK','iIbMCM9TihbYzq','C2v0ici','zM9JsgW','vM5zs2u','Aw1Hz2vdB25MAq','y3vZDg9T','BwL0DgvKigzHAq','l3yXlW','yxzcsu4','tufhrv9srvnqtW','suXwsgK','zML4zwrqCM9TCa','t3z3yMS','A2XRyNm','BNrHAw5ZihrLEa','igv4DhjHy3rPBG','CxzTzKW','DhLWzq','u2nLBMuGq29TCa','C2vHCMnO','BgvZktOG','qvbjihjLC3bVBG','EufLsMi','w0jHBMfUyv0G5l2/','CgfYyw1LDgvYCW','w0jHBMfUyv0GuG','qNj5yK8','v0jWwfq','ihWG','Dg9tDhjPBMC','yKHgzK8','C2uGzgLKig5VDa','BvHHsui','C2fTCgXLq291BG','5zU+5yop5BEY5A2y5ywL5PwW5O2U5BQtigy','zw1PDa','y09Hs0i','Cfvxww8','qNzgtM8','BgvUz3rO','w0jHBMfUyv0GqG','ignVBNrHAw4GAq','B0TXyLC','C2zMBfi','zw5bssbMB3jTyq','z0jfu1i','z1PZEva','5O6L6k+35Rgc','5PYa5zco572U','vMfZrMC','Evnvu0y','Aw1Hz2vFDxjS','w0jHBMfUyv0G5l+U','vNvVChK','uLzdt1C','r1foEgO','sfH1D1q','vK5uugW','mtaYndeZmdrPDuXzBLu','wMfhCeK','uMHOq04','ywDLifvstdOG','lI4U','5yMn572U5zco','tLLSCKy','renMC3C','zxrPB25FC291CG','Aw5ZDgfUy2vZ','B25SB2fKzw5K','zw5LCG','yxbWBhK','yMfUyw5H','5zco572U5zco','55sO6yws6AAg5lUJ55cg5QIH5BYp','BLLhwuC','BI9QC29U','l2fWAs9IywnRzq','Bw9Kzq','EsbJB252zxj0zq','C3vIC3rYAw5N','5l+U5zU+5zU+54MhoIbB5BEY5O+q5l6B','EuLdvhC','BffVugi','D1jhC1i','Aw1Hz2u','BgL6q0m','Bwf0y2G','s2vzr1u','mJqWrMrgz0Tn','wvbyqw8','uKH2sfu','BgrwvgO','tLnf','C3rHDhvZ','DxjS','BwfNzsbPBIbpCa','C3qGkeLeoIa','igLTywDLlG','kerPDMLKzv9YBW','AMXPy2m','y0zRwwi','D2L0AcbWCM9TCa','C3bSAxq','y1Dotgi','BwfNzw4G5QIH5z6l5lIn5PsV','ChjVBxb0','BhDoBuq','C3rHCNrZv2L0Aa','5RAi5B2t5yMn5lU75yQH77Ym5y+r6ycb5AsX6lsL','zxrJAcbnyxjRza','DvDMt3y','AeHwt3u','Cu5hC3i','qvbjihjLCxvLCW','CMvZDwX0','tvvitue','57Yt5A2y6k6+572U5lI65lIn5A2y5ywL5PwW5O2U','wwnOuK4','C3rFy2HHDhu4xW','DwvZDcb0BZOG','u1jsshq','yMfZzty0lG','55sO5lQgihVKV67LM759ioAGH+IVHG','yLLtwhm','Aw5PDgLHBgL6zq','y3PMweC','zNLSALi','qMfUyw5H5l+U5zU+5QIH5BYp','te9WtLe','qxvktfK','5lU255Ur5zcS5zMO5BEY5yID5AEl5yYw44cc','z2rQAwO','AM9PBG','rMfruNu','w0jHBMfUyv0Gua','CMvWBgfJzq','Aw5JBhvKzxm','BwvZC2fNzxm','D3PvzLe','w0jHBMfUyv0Gsq','5yMn572U5yMn','yxrLzcbZDwnJzq','BwfW','DNLXz1a','uKTvs28','zvrlsK0','zMnNBNC','sMHZAxq','rwLOsha','ig1LC3nHz2vZlG','qMvHCMvYia','BwfNzsbNzw5LCG','zMXHDa','vhnWve0','uuX3zvy','Dg9Rzw4','yxDNCe8','rMfPBgvKihrVia','ndu5odflq2LSrvK','vMPmu0C','ue16sei','wfbRr0S','yMfUyw5HioEuN+wBVUs6IW','vgH0ve8','mNW0Fdn8mhWX','y2HHBMDL','uhHSD0W','ywDLigDLBMvYyq','E+s/RUwBVN0','yxnWzwn0uMf0Aq','DwLSDcbTDwX0Aq','B3nPDgLVBG','ALrMv0y','rMHzy2e','uKPJyNe','y2vZCYbYzxnWBW','DLHOrNC','wgLozNe','55sO5lQo55sF5OIq55QevgfNoIa','sMDXAey','m3WXFdr8mhWY','BwvZC2fNzq','B3iGChjVBxb0oG','vM1IEMW','vwfrwKe','y3vZDg9Tx2LUyW','CMH2C0q','wu9qB3O','svPNsfm','DwnJzxnZzNvSBa','mZGWmde1rvPnrxvc','tNHzsMO','qMfUyw5HtgLZDa','DhjPz2DLCNm','uxHbsxm','5zco572U5yMn','A29Rvge','y2LZAhu','BhbxD1a','ywn0zxjqCMvZzq','Cg9ZDgzPEfbYBW','CMvTB3zLtgLZDa','wLnqv0e','BNzjsgG','yxnZAxn0yw50','z1LJtvy','C3Lxs0K','q29UDgvUDc1uEq','zMv0y2GGAw1HzW','otKWuxzkuKjl','zwfQCeC','yw5Hx3rHC2S','yMfUyw5Hq2HHCG','B25LCNjVCG','rxvyC0S','l3yXl2nOyxqVyW','rhLfq28','C1DJDfi','vvD0vgS','5B2t5yMn55sF5zU+5QYH5PwW5lI6igzV','CMvHzefZrgf0yq','zvPvAMW','zfbcB2K','w0jHBMfUyv0GuW','r0vorvjbvevFsq','C3rYAw5NAwz5','5OYb6yws6AAg5lUJ55cg77Ym5yIh5O2I5lI655U0','ifbYB21WDa','BMrZl2nOyxqTyW','zw5LCMf0Aw9Uia','zM9YrwfJAa','CKjcB1m','y2HHDf9JB21WBa','igLTywDLihrVia','ywLSzwqGDg8GzG','tufhrv9srvfvrq','zMLSDgvY','Bw1owMi','zgvSCY8','uePLDKC','DuvHDw0','y0XKB3m','v0fyy2e','zgf0ytPPBwfNzq','rMr1v1m','nZC0ntfzv0v5B1K','rw1UyM4','AgTnz0m','r1rhAxC','C3fXyMu','zw1uAwy','suL2A2e','svjPzwm','qxv0Ag9YAxPHDa','tKr0t00','Aw1Hz2vjza','CM9Szq','y3vZDg9Tx3vYBa','zxrLy3rLzcbnyq','B21WBgv0Aw9UCW','zwnLAxzLzcbPBq','vvjm','zMzdu20','s2Pnwu0','C3nMDwXSEs4','ntG0mJuXnxjHs1jSBG','5z2q5Qch55Qe5O+q56s66k+n5A2x56YM5lIY44cc','yMXVyG','rhney1K','q2HHCMfJDgvYia','zxiG','C3rYAw5N','5yIW5y+w5RAi5lU75yQH5lQl5lU2icHu','l3yXyMv0ys9TBW','tgntqwu','zxnWB25ZzsbJBW','vMXyCg8','mtz6CxzrzuC','yxnRsuq6ia','sLbKyKy','wxnuzKS','w0jHBMfUyv0GrG','BNnLigzVCIbjra','DMLgrfe','AxzUwxa','l2DLBMvYyxrL','C3vJy2vZCW','zMfPBgvKigzVCG','y3z5Eee','mtm4nti2z0rhCff0','DhjPBq','ztOG','ze5nrwe','zxrJAcbLCNjVCG','BwL0DgvKihn1yW','Aw9UoIaIqMvHCG','renor2u'];_0x3ec6=function(){return _0x1e63e6;};return _0x3ec6();}_0x3a74c2();import{extension_settings}from'../../../../extensions.js';import{eventSource}from'../../../../../script.js';import{extensionName,EventType}from'./config.js';import{sleep,generateRandomSeed,zhengmian,fumian,getRequestHeaders,prompt_replace,addLog,clearLog,parsePromptStringWithCoordinates,prompt_replace_for_character,stripChineseAnnotations}from'./utils.js';import{initializeImageProcessing}from'./iframe.js';import{processCharacterPrompt}from'./characterprompt.js';import{setItemImg}from'./database.js';import{getConfigImage}from'./configDatabase.js';import{taskQueue,TaskType,TaskStatus}from'./taskQueue.js';function _0x5509(_0x1b405a,_0x33e5b5){_0x1b405a=_0x1b405a-(0x1*0xcaa+0x2*-0xdfd+0x112d*0x1);const _0x4bbc48=_0x3ec6();let _0x2f1fd0=_0x4bbc48[_0x1b405a];if(_0x5509['bYmMkK']===undefined){var _0x4164c7=function(_0x20d24d){const _0x2e3a79='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x141035='',_0x300bc2='',_0x3c7b61=_0x141035+_0x4164c7;for(let _0x38b94b=-0x4ce+0xfb0*0x2+0x1*-0x1a92,_0x422d3e,_0x2dce52,_0x2a6797=-0x2525*0x1+0x24a*0x11+-0x3*0x97;_0x2dce52=_0x20d24d['charAt'](_0x2a6797++);~_0x2dce52&&(_0x422d3e=_0x38b94b%(0x34*-0x34+-0x1894+0x2328)?_0x422d3e*(-0x1a85+-0xb*-0x2b3+-0x2ec)+_0x2dce52:_0x2dce52,_0x38b94b++%(-0xe2d+0x224b+0x53*-0x3e))?_0x141035+=_0x3c7b61['charCodeAt'](_0x2a6797+(0x2*0x473+-0x163d+0x5*0x2ad))-(-0x10ae+-0x1878+0x2930)!==-0x1*-0x21be+0x1*-0xc53+-0x156b?String['fromCharCode'](-0x164c+0x3*-0x5f4+-0x23*-0x12d&_0x422d3e>>(-(-0x1ffe+0x1401*0x1+-0x1*-0xbff)*_0x38b94b&0x377+-0x2340*-0x1+0x7*-0x587)):_0x38b94b:-0x18ef*0x1+-0x1*0x7bb+0x20aa){_0x2dce52=_0x2e3a79['indexOf'](_0x2dce52);}for(let _0x3cb73b=0x102d+0xe64+-0x1e91,_0x59b464=_0x141035['length'];_0x3cb73b<_0x59b464;_0x3cb73b++){_0x300bc2+='%'+('00'+_0x141035['charCodeAt'](_0x3cb73b)['toString'](-0x25*0x103+-0x7d*-0x41+0x2e1*0x2))['slice'](-(0x50e*0x3+-0xb*-0xde+-0xc59*0x2));}return decodeURIComponent(_0x300bc2);};_0x5509['TXyNDO']=_0x4164c7,_0x5509['fuUGiU']={},_0x5509['bYmMkK']=!![];}const _0xe6b3ab=_0x4bbc48[-0x1681+-0x3*0x6+0x1693],_0x4c6c96=_0x1b405a+_0xe6b3ab,_0x292037=_0x5509['fuUGiU'][_0x4c6c96];if(!_0x292037){const _0x2f9900=function(_0x41aa8e){this['KkdqEn']=_0x41aa8e,this['AYjkzg']=[-0x6b*-0x1d+-0x1*0x9d3+-0x24b,0x2708+0x1bd0+-0x42d8,0x1*0x1d5d+0x1*-0xfee+0x13*-0xb5],this['xtOKgA']=function(){return'newState';},this['tSGqsX']='\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*',this['MJMhou']='[\x27|\x22].+[\x27|\x22];?\x20*}';};_0x2f9900['prototype']['wEwMCt']=function(){const _0x518d07=new RegExp(this['tSGqsX']+this['MJMhou']),_0x2f19d5=_0x518d07['test'](this['xtOKgA']['toString']())?--this['AYjkzg'][-0xbac+-0x7ba+0x1367]:--this['AYjkzg'][-0xc*0x247+-0x11*-0x147+0x59d];return this['hdqUEK'](_0x2f19d5);},_0x2f9900['prototype']['hdqUEK']=function(_0x138dee){if(!Boolean(~_0x138dee))return _0x138dee;return this['HwTrrE'](this['KkdqEn']);},_0x2f9900['prototype']['HwTrrE']=function(_0x5429f4){for(let _0x3c09d3=0xea6+-0x6e2*0x1+-0x7c4,_0x576ca8=this['AYjkzg']['length'];_0x3c09d3<_0x576ca8;_0x3c09d3++){this['AYjkzg']['push'](Math['round'](Math['random']())),_0x576ca8=this['AYjkzg']['length'];}return _0x5429f4(this['AYjkzg'][-0xdb6+0x27*0xbf+-0xf63]);},new _0x2f9900(_0x5509)['wEwMCt'](),_0x2f1fd0=_0x5509['TXyNDO'](_0x2f1fd0),_0x5509['fuUGiU'][_0x4c6c96]=_0x2f1fd0;}else _0x2f1fd0=_0x292037;return _0x2f1fd0;}let currentTaskId=null,currentRequestId=null,currentPrompt=null;async function getImageFromTurnData(_0x2ee93c){const _0x14fe9c={'tTTFB':function(_0x321109,_0x31b5d9){return _0x321109+_0x31b5d9;},'ldVTj':function(_0x27a14e,_0x532a30){return _0x27a14e+_0x532a30;},'kdRwJ':_0x2ec9ac(0x4af,0x434,0x39d,0x4af),'JvVeA':function(_0x131ae2,_0x1637bf){return _0x131ae2(_0x1637bf);},'fyljR':function(_0x4bd346,_0x13477c){return _0x4bd346(_0x13477c);},'Ovwbk':'cfgimg_','JPdbF':function(_0x31a0a3,_0x4449e7){return _0x31a0a3!==_0x4449e7;},'ETTfo':_0x231038(-0x7d,-0x121,-0x135,-0xdf),'mmNZb':function(_0x207b96,_0x497e7f){return _0x207b96(_0x497e7f);},'sfflR':function(_0x3d48aa,_0xa9c195){return _0x3d48aa||_0xa9c195;},'PJevG':_0x2ec9ac(0x37c,0x385,0x41e,0x40c),'QLweV':function(_0x35b699,_0x1d7544){return _0x35b699===_0x1d7544;},'RVCOW':'njwGj'};function _0x231038(_0x4db00c,_0x5461ab,_0x145b49,_0x2191e7){return _0x5509(_0x145b49- -0x387,_0x5461ab);}if(!_0x2ee93c)return'';if(_0x2ee93c[_0x231038(-0x1e2,-0x123,-0x19d,-0x230)]&&_0x2ee93c[_0x2ec9ac(0x355,0x391,0x2f6,0x39b)][_0x2ec9ac(0x479,0x483,0x4e0,0x4b4)](_0x14fe9c[_0x231038(-0x124,-0x1c8,-0x10a,-0x15c)])){if(_0x14fe9c[_0x231038(-0x18b,-0x1dc,-0x185,-0x113)](_0x231038(-0x8e,-0xc,-0x8c,0x37),_0x14fe9c[_0x2ec9ac(0x397,0x3dc,0x367,0x388)])){const _0x315f99=await _0x14fe9c[_0x231038(0x0,-0x41,-0x29,0x80)](getConfigImage,_0x2ee93c['imageId']);return _0x14fe9c[_0x231038(-0xaf,-0x161,-0xeb,-0x104)](_0x315f99,'');}else _0x38b94b=_0x14fe9c[_0x231038(-0x192,-0xbb,-0x143,-0x8e)](_0x14fe9c[_0x231038(-0xab,-0x17a,-0xbb,-0x16a)](_0x422d3e,_0x14fe9c['kdRwJ']),_0x2dce52(_0x2a6797['Character\x20'+_0x3cb73b+_0x2ec9ac(0x4df,0x4fb,0x4a0,0x4a7)]));}if(_0x2ee93c[_0x231038(-0x48,-0x76,-0xc2,-0x7b)]&&_0x2ee93c[_0x231038(-0x96,-0x110,-0xc2,-0x99)][_0x2ec9ac(0x52f,0x483,0x408,0x474)](_0x14fe9c[_0x2ec9ac(0x4e2,0x507,0x49a,0x5aa)])){if(_0x14fe9c[_0x231038(-0x104,0x26,-0x7c,-0x56)](_0x14fe9c[_0x231038(-0x87,-0x137,-0xe0,-0x125)],_0x14fe9c[_0x231038(-0x35,-0x110,-0xe0,-0x169)]))return _0x2ee93c['image'];else{const _0x4ce23b='[Banana]\x20G'+_0x231038(-0x21,-0xd9,-0x31,-0x82)+_0x2ec9ac(0x3f9,0x3b1,0x46e,0x3b9)+'\x20ID\x20'+_0x5a8089+':\x20'+_0x475faf[_0x231038(0x39,-0x10d,-0x61,0x5e)];_0x14fe9c['JvVeA'](_0x500602,_0x4ce23b),_0x49d5ef[_0x231038(-0x20d,-0x206,-0x164,-0x12c)](_0x4ce23b);const _0x46d5c7={};_0x46d5c7['id']=_0x1b9311,_0x46d5c7[_0x2ec9ac(0x44f,0x3b0,0x449,0x363)]=![],_0x46d5c7['error']=_0x4ccb8c[_0x2ec9ac(0x535,0x4cd,0x4e1,0x54b)],_0x46d5c7[_0x2ec9ac(0x47d,0x481,0x456,0x3e8)]=_0x528089,_0x1d3617[_0x2ec9ac(0x414,0x43b,0x4f7,0x4d0)](_0xcec4a[_0x2ec9ac(0x547,0x4f8,0x4d2,0x461)+'MAGE_RESPO'+_0x2ec9ac(0x4c1,0x474,0x446,0x3f0)],_0x46d5c7),_0x14fe9c[_0x2ec9ac(0x503,0x496,0x53b,0x4c2)](_0x43ae70,_0x231038(-0x16c,-0x1f1,-0x15a,-0xec)+_0x2ec9ac(0x415,0x41e,0x480,0x40a)+_0x2ec9ac(0x359,0x3d5,0x3eb,0x35f)+_0x2ec9ac(0x422,0x3ac,0x33a,0x3db)+':\x20'+_0x216399);}}function _0x2ec9ac(_0x42409b,_0x4b79e1,_0x2e7a7f,_0x38c875){return _0x5509(_0x4b79e1-0x1a7,_0x42409b);}return'';}async function generateBananaImage({prompt:_0x54dde1,width:_0x5a705d,height:_0x16d5c8,change:_0x4fb789,retouchPrompt:_0x124302,retouchImage:_0x12b179}){const _0x53fba4={'EYoML':_0x1cb4c4(0x1a5,0x1af,0xee,0x12e),'ywxHK':_0x1cb4c4(0x1c9,0x19f,0x11c,0x1ac),'XLabI':_0x44f4cf(0x3c6,0x3de,0x422,0x405),'ivnYp':_0x1cb4c4(0xdc,0x192,0x168,0x113),'VvJdK':_0x44f4cf(0x41d,0x544,0x4d1,0x486)+_0x44f4cf(0x3a3,0x37a,0x415,0x3e5)+_0x1cb4c4(0x1d0,0x219,0x10e,0x23e),'NYCQp':'banana\x20生图事'+_0x1cb4c4(0x17f,0x1f8,0x1bf,0x178),'XPkGK':function(_0x1626a8,_0x143d44){return _0x1626a8(_0x143d44);},'OOELe':function(_0x17607d,_0x467697){return _0x17607d+_0x467697;},'BrybO':_0x1cb4c4(0x116,0x100,0x138,0x11a)+_0x1cb4c4(0x8a,0x3c,-0x7,0x7f)+_0x44f4cf(0x420,0x3cf,0x3a2,0x41e)+'t\x20only,\x20no'+_0x44f4cf(0x43f,0x4f0,0x3b5,0x471),'wRGsR':_0x1cb4c4(0x189,0xe5,0x23d,0x100),'rhvsD':_0x1cb4c4(0x1c0,0x10a,0x25f,0x140),'ILVHi':_0x44f4cf(0x4ce,0x4e9,0x3a1,0x458),'mRwTz':_0x1cb4c4(0x12d,0x189,0x19b,0x191),'OzdxN':_0x44f4cf(0x474,0x369,0x326,0x3c9)+_0x1cb4c4(0x148,0x1b4,0x1bc,0x202),'UaQZA':function(_0x5d2e9f){return _0x5d2e9f();},'syWKI':function(_0x9dc497,_0x49601a){return _0x9dc497+_0x49601a;},'tKfMR':function(_0x13984f,_0x4ae399){return _0x13984f(_0x4ae399);},'EHnKI':function(_0x17315b,_0x3308c1){return _0x17315b(_0x3308c1);},'DCNGe':function(_0x3fa16d,_0x259288){return _0x3fa16d(_0x259288);},'yICTw':function(_0x28acee,_0x34e050){return _0x28acee||_0x34e050;},'GQNxj':function(_0x2969b4,_0x1b5d37){return _0x2969b4!==_0x1b5d37;},'OjQdi':function(_0x381bf5,_0x102b23){return _0x381bf5(_0x102b23);},'LOpNQ':_0x44f4cf(0x3f4,0x41a,0x3af,0x422)+_0x1cb4c4(0x1a8,0x226,0x1f9,0x1a3),'cLdos':function(_0xa9de79,_0x5b3fcf){return _0xa9de79(_0x5b3fcf);},'VlXpo':function(_0x51c322,_0x3a6813){return _0x51c322(_0x3a6813);},'xNStM':_0x44f4cf(0x382,0x379,0x47d,0x3fc)+_0x1cb4c4(0x81,0xb6,0x139,0xbb),'cWNLb':function(_0x5cdc3f,_0x49f2f9){return _0x5cdc3f(_0x49f2f9);},'hymLa':function(_0xef07da,_0x666496){return _0xef07da<=_0x666496;},'RhhCN':function(_0x3606f4,_0x10688c){return _0x3606f4+_0x10688c;},'hbjbE':function(_0x1a355a,_0xf0c0d1){return _0x1a355a+_0xf0c0d1;},'cFkYb':function(_0x4f61f5,_0x23684c){return _0x4f61f5(_0x23684c);},'xmHiT':_0x1cb4c4(0xc9,0x5f,0x134,0x2f)+'中的\x20prompt。','fcgnw':function(_0x3a3f17,_0x2a7614){return _0x3a3f17===_0x2a7614;},'emTif':_0x1cb4c4(0x123,0x6a,0xef,0x198),'jlicc':'Yvdim','hkMgC':function(_0x3ce39,_0x33510e){return _0x3ce39+_0x33510e;},'gZsyP':function(_0x4e9011,_0x30c0e1){return _0x4e9011===_0x30c0e1;},'EihHp':function(_0x13ee70,_0x12fa80){return _0x13ee70(_0x12fa80);},'qvmfL':_0x1cb4c4(0x1d4,0x13a,0x1db,0x254)+_0x44f4cf(0x328,0x36b,0x3ef,0x38d),'IIvka':'eobJG','MUHMA':function(_0x59ff11,_0x305bb4){return _0x59ff11===_0x305bb4;},'PxlwL':_0x1cb4c4(0x1d3,0x195,0x1d4,0x1a5),'avBIN':'wFpCf','OKSqr':_0x1cb4c4(0x13c,0xa6,0xcd,0x100),'hHVOu':function(_0x272582,_0x3481e0){return _0x272582(_0x3481e0);},'YeWdK':function(_0x19b7d5,_0x47663d){return _0x19b7d5(_0x47663d);},'YsTfK':_0x1cb4c4(0x130,0x1e0,0x158,0x158),'eTKJM':function(_0x56993f,_0x16e443){return _0x56993f(_0x16e443);},'gBESR':'YzhHU','lpWwP':function(_0x4a0b10,_0x345270){return _0x4a0b10!==_0x345270;},'eZUjl':_0x44f4cf(0x43e,0x3e7,0x4c7,0x426),'YBbPt':function(_0x46b80e,_0x43a90e){return _0x46b80e(_0x43a90e);},'DyECo':function(_0xf7956e,_0x1481e6){return _0xf7956e>_0x1481e6;},'rBBoS':function(_0x5a7fe5,_0x46449d){return _0x5a7fe5(_0x46449d);},'oKqbW':_0x1cb4c4(0x135,0x114,0x14d,0x93),'lwNmD':_0x1cb4c4(0xce,0x141,0x11a,0x14f),'uJaEO':function(_0x37203e,_0x1f8a6c){return _0x37203e||_0x1f8a6c;},'NxYJj':function(_0x336bae,_0x3006c6){return _0x336bae(_0x3006c6);},'focHl':_0x44f4cf(0x425,0x3c1,0x384,0x3eb),'awgpO':'/v1/','AuJLY':function(_0x555e9a,_0x22dec6){return _0x555e9a===_0x22dec6;},'CLaWK':_0x1cb4c4(0x196,0x1dc,0x17b,0x200),'ffCSm':function(_0xcfc52c,_0x307b00){return _0xcfc52c===_0x307b00;},'IZgHS':function(_0x3072cb,_0x2ea749){return _0x3072cb!==_0x2ea749;},'nYGYG':_0x44f4cf(0x397,0x46d,0x3f2,0x3bc),'klkbs':_0x44f4cf(0x325,0x2db,0x3e1,0x37e),'eajpG':_0x1cb4c4(0x149,0x15f,0xa5,0x108)+_0x44f4cf(0x440,0x4ee,0x444,0x4f4)+_0x1cb4c4(0x7a,0x56,0x7d,0x1)+'/generate','gdjij':_0x1cb4c4(0x102,0x5d,0x70,0xb1),'jkdGl':_0x1cb4c4(0xf7,0x35,0x5c,0xab),'VasFg':_0x44f4cf(0x3d3,0x4cb,0x4aa,0x47e),'VnYKe':_0x1cb4c4(0x157,0x193,0x11c,0x1cb),'smRLC':function(_0x376c55,_0x34ba02){return _0x376c55===_0x34ba02;},'PqUsg':_0x44f4cf(0x3ab,0x3ae,0x4c4,0x44b),'DCfsw':'jIHYK','XdAgX':function(_0x3b8ea9,_0x29440b){return _0x3b8ea9(_0x29440b);},'GTGiw':_0x1cb4c4(0xee,0x151,0x188,0xf8),'KjMYM':function(_0x3a6642,_0x2392cd,_0x37a123){return _0x3a6642(_0x2392cd,_0x37a123);},'PMzHB':_0x44f4cf(0x40d,0x3d8,0x34f,0x40e),'jtVgS':_0x1cb4c4(0x11b,0x16f,0x1d6,0x6d),'lizCC':_0x44f4cf(0x418,0x384,0x4ae,0x3fe),'viFDQ':_0x44f4cf(0x42d,0x465,0x4a9,0x435),'Eljhp':_0x1cb4c4(0xc4,0x140,0x5f,0xf3)+_0x1cb4c4(0x79,0x4e,-0x3c,-0x25)+_0x1cb4c4(0xf9,0x8f,0x183,0x108)+_0x44f4cf(0x49b,0x3cc,0x374,0x3df)+_0x1cb4c4(0x10c,0xc9,0xab,0x14b)+'g\x20URL...','dNMEa':_0x1cb4c4(0x154,0x1c8,0x180,0x213),'VNTPl':function(_0x541bb2,_0x210d4b){return _0x541bb2(_0x210d4b);},'eDrMv':_0x44f4cf(0x4ed,0x4fc,0x446,0x4ef)+_0x1cb4c4(0x1ba,0x1a8,0x241,0x16f)+_0x44f4cf(0x453,0x504,0x437,0x45e)+'d\x20Markdown'+_0x1cb4c4(0x1e6,0x27e,0x16d,0x259)+_0x1cb4c4(0x176,0x19d,0x11d,0x11d),'ThtTO':_0x1cb4c4(0xa1,0x14d,0xd8,0xa8)+_0x1cb4c4(0xdd,0xf0,0x86,0x84)+'t\x20URL\x20as\x20f'+'allback.','LcSAe':function(_0x33c75e,_0x461e82){return _0x33c75e!==_0x461e82;},'BUzZV':_0x44f4cf(0x57f,0x532,0x436,0x4da),'cIKAm':_0x44f4cf(0x481,0x3c7,0x4ba,0x425)+_0x1cb4c4(0x11c,0x15d,0x70,0x104)+_0x44f4cf(0x472,0x48e,0x489,0x439)+_0x1cb4c4(0x15c,0x124,0x204,0x14f)+_0x44f4cf(0x4f7,0x43d,0x44e,0x43c)+'t','Vmbzl':function(_0x444c1b,_0x4040de){return _0x444c1b(_0x4040de);},'Emnbn':_0x1cb4c4(0x90,0xcf,0x2a,0x33)+_0x1cb4c4(0x9c,0x3b,0x13,0x9b)+':','JMpJw':function(_0x1f2ac5,_0x1c5bc2){return _0x1f2ac5===_0x1c5bc2;},'BCkcd':_0x1cb4c4(0xe7,0x114,0x17d,0x31),'sWctR':function(_0x25a646,_0xf39b8b){return _0x25a646!==_0xf39b8b;},'sLvGN':'EeGRq'};clearLog();const _0x5f4818=taskQueue['addTask']({'name':_0x53fba4[_0x1cb4c4(0x1cb,0x1cd,0x283,0x24d)]((_0x54dde1||'')[_0x44f4cf(0x3f4,0x4f5,0x39f,0x45f)](-0x6fb*-0x3+0x264d+-0x3b3e,0x8e4+0x5*0x70d+0x11*-0x297),_0x54dde1&&_0x54dde1['length']>0xacd+-0x2cc*0x7+0x8e5?_0x1cb4c4(0x13b,0x1eb,0x1a8,0x198):''),'type':TaskType['BANANA'],'prompt':_0x54dde1});currentTaskId=_0x5f4818,_0x54dde1=_0x53fba4[_0x44f4cf(0x3df,0x37a,0x432,0x3ff)](processCharacterPrompt,_0x54dde1),_0x54dde1=await stripChineseAnnotations(_0x54dde1);let _0x3a9e5a=_0x4fb789;_0x4fb789=processCharacterPrompt(_0x4fb789),_0x4fb789=await _0x53fba4[_0x1cb4c4(0xec,0x145,0x19f,0xb1)](stripChineseAnnotations,_0x4fb789),_0x53fba4['EHnKI'](addLog,'开始\x20Banana生'+_0x1cb4c4(0xd6,0xc0,0x53,0xd4)+extension_settings[extensionName][_0x1cb4c4(0xf1,0x6c,0x169,0x113)]),_0x53fba4[_0x44f4cf(0x313,0x463,0x434,0x3b2)](addLog,'请求尺寸:\x20宽度\x20-'+'\x20'+_0x53fba4['yICTw'](_0x5a705d,'默认')+_0x1cb4c4(0xd3,0xcf,0x11b,0x18b)+_0x53fba4[_0x1cb4c4(0x14e,0xb1,0x10e,0xe8)](_0x16d5c8,'默认'));function _0x1cb4c4(_0x4457d0,_0xd6a53a,_0x434935,_0x5d0491){return _0x5509(_0x4457d0- -0x174,_0xd6a53a);}_0x54dde1=_0x4fb789&&_0x53fba4[_0x1cb4c4(0x134,0xae,0xd4,0x1b6)](_0x4fb789[_0x1cb4c4(0x99,0x127,0x39,0x10f)](),'')?_0x4fb789:_0x54dde1,_0x53fba4['OjQdi'](addLog,_0x1cb4c4(0x1af,0x166,0x16f,0x100)+_0x54dde1);let _0x1b85e7=![];_0x54dde1[_0x1cb4c4(0x185,0x1d5,0xf6,0x106)](_0x53fba4[_0x44f4cf(0x53b,0x466,0x490,0x490)])&&(_0x1b85e7=!![]);_0x53fba4[_0x44f4cf(0x48a,0x488,0x58e,0x501)](addLog,'是否启用分角色模式\x20'+_0x1cb4c4(0x15f,0x1fa,0x165,0x1dd)+_0x1cb4c4(0x111,0xcb,0xac,0x138)+_0x1b85e7);let _0x8f0e78={},_0x487596='',_0xc25a22='';if(_0x1b85e7){_0x53fba4['VlXpo'](addLog,_0x53fba4['xNStM']),_0x8f0e78=_0x53fba4[_0x44f4cf(0x4cb,0x4a7,0x4b7,0x477)](parsePromptStringWithCoordinates,_0x54dde1),_0x487596=_0x8f0e78[_0x44f4cf(0x3c7,0x394,0x393,0x422)+_0x44f4cf(0x405,0x57d,0x404,0x4bb)];for(let _0x38924b=-0x9c0+-0x1f97+-0x31*-0xd8;_0x53fba4[_0x44f4cf(0x39c,0x2f3,0x31f,0x3b5)](_0x38924b,-0x51*-0x5d+0xddb*0x1+-0x2b44);_0x38924b++){_0x8f0e78[_0x1cb4c4(0x84,0xd6,0xe7,0xf6)+_0x38924b+_0x1cb4c4(0x1e0,0x267,0x1f3,0x192)]&&(_0xc25a22=_0x53fba4[_0x44f4cf(0x43c,0x43a,0x508,0x44c)](_0x53fba4[_0x44f4cf(0x32e,0x355,0x394,0x3e8)](_0xc25a22,',\x20'),_0x8f0e78[_0x44f4cf(0x2ef,0x455,0x392,0x397)+_0x38924b+_0x1cb4c4(0x1e0,0x1b9,0x23e,0x19c)]));}}else _0x53fba4[_0x1cb4c4(0x161,0x120,0x21a,0x1b3)](addLog,_0x53fba4['xmHiT']),_0x487596=_0x54dde1;let {modifiedPrompt:_0xa53c00,insertions:_0x7ace87}=await prompt_replace(_0x487596,_0xc25a22);if(_0x1b85e7)for(let _0x4f0731=-0x8c6+0x1f2+0x6d5;_0x53fba4['hymLa'](_0x4f0731,-0x1*0x1a21+0x7*0x11a+0x126f);_0x4f0731++){if(_0x53fba4[_0x1cb4c4(0x18f,0xf5,0x143,0x1d2)](_0x53fba4[_0x44f4cf(0x2cb,0x2dd,0x32d,0x384)],_0x53fba4[_0x1cb4c4(0x160,0x223,0x157,0x16b)]))throw new _0x166119(_0x1cb4c4(0x19a,0x1f8,0x150,0x1dd)+_0x44f4cf(0x4c9,0x485,0x464,0x4e0)+'e:\x20'+_0x46fa77[_0x1cb4c4(0x15a,0xc8,0x1a4,0xdb)]);else _0x8f0e78[_0x44f4cf(0x2d7,0x315,0x3d1,0x397)+_0x4f0731+_0x44f4cf(0x4f1,0x540,0x475,0x4f3)]&&(_0xa53c00=_0x53fba4[_0x44f4cf(0x420,0x3b7,0x2ed,0x381)](_0xa53c00,_0x1cb4c4(0x119,0x6e,0x1dc,0xea))+_0x53fba4[_0x1cb4c4(0xec,0xa6,0x135,0x101)](prompt_replace_for_character,_0x8f0e78[_0x44f4cf(0x370,0x317,0x324,0x397)+_0x4f0731+'\x20Prompt']));}const _0x5675f2=extension_settings[extensionName][_0x44f4cf(0x428,0x46f,0x41d,0x457)],{model:_0x58661d,apiUrl:_0x24949a,apiKey:_0x169606,conversationPresets:_0xe2052f,conversationPresetId:_0x5d2b4b,editPresetId:_0x2506f2,aspectRatio:_0x178716}=_0x5675f2;_0x53fba4['cLdos'](addLog,_0x44f4cf(0x4d9,0x567,0x504,0x4ef)+'tarting\x20im'+_0x44f4cf(0x4d7,0x42e,0x54b,0x4b7)+_0x1cb4c4(0xcd,0x158,0xd6,0xcf)+'model:\x20'+_0x58661d);let _0x2646e2,_0x34d39c;function _0x44f4cf(_0x5687eb,_0x2f1dff,_0x19acb6,_0x2d22d8){return _0x5509(_0x2d22d8-0x19f,_0x19acb6);}if(_0x58661d['startsWith'](_0x44f4cf(0x390,0x4c9,0x421,0x40a))){if(_0x53fba4['gZsyP'](_0x1cb4c4(0xa5,0x3f,0xa5,0xfb),_0x44f4cf(0x41a,0x47b,0x46b,0x462))){const _0x20ecb8=_0x11d269[_0x44f4cf(0x3af,0x466,0x46b,0x456)](_0xacc7fb,arguments);return _0xb9fe7a=null,_0x20ecb8;}else{_0x2646e2=_0x44f4cf(0x38a,0x450,0x33b,0x39b)+_0x44f4cf(0x4ba,0x51e,0x4fa,0x4fe)+_0x58661d;const _0x11775d={};_0x11775d['fixedPromp'+'t']='';const _0x3cb9c3=_0xe2052f[_0x5d2b4b]||_0x11775d,_0x3738bd=[_0x3cb9c3['fixedPromp'+'t'],_0x7ace87[_0x53fba4[_0x1cb4c4(0x150,0x1be,0x12b,0x126)]],_0x7ace87['前置后'],_0xa53c00,_0x7ace87[_0x53fba4[_0x1cb4c4(0x1b7,0x247,0x14b,0x267)]],_0x7ace87[_0x53fba4[_0x44f4cf(0x4ba,0x467,0x417,0x41a)]],_0x3cb9c3[_0x44f4cf(0x57f,0x4ac,0x510,0x4d8)+_0x1cb4c4(0xfa,0xc9,0x13f,0xd2)],_0x7ace87[_0x1cb4c4(0x12d,0x1b4,0x119,0x197)]]['filter'](Boolean)['join'](',\x20');_0x53fba4[_0x1cb4c4(0x191,0xee,0x172,0x24b)](addLog,_0x44f4cf(0x450,0x33c,0x46f,0x3ea)+_0x3738bd);const _0x5aadea={};_0x5aadea[_0x1cb4c4(0x166,0xaf,0xda,0x104)]=_0x3738bd;const _0x277d08={};_0x277d08['sampleCoun'+'t']=0x1,_0x277d08[_0x44f4cf(0x4ec,0x48b,0x480,0x4b9)+'o']=_0x178716;const _0x2b5964={};_0x2b5964[_0x1cb4c4(0x140,0x145,0x105,0x1c1)]=[_0x5aadea],_0x2b5964[_0x1cb4c4(0x115,0xf4,0x19d,0xb9)]=_0x277d08,_0x34d39c=_0x2b5964,_0x53fba4[_0x1cb4c4(0x9f,0x11b,0x7f,0xd4)](addLog,_0x44f4cf(0x375,0x39d,0x493,0x438)+_0x44f4cf(0x426,0x33d,0x48a,0x3ec)+'n\x20payload\x20'+_0x44f4cf(0x460,0x437,0x4fd,0x475)+_0x1cb4c4(0xf8,0x78,0x98,0x103)+_0x3738bd);}}else{_0x2646e2=_0x53fba4[_0x1cb4c4(0x10d,0x17f,0x8d,0xd7)];let _0x32df92;if(_0x4fb789['includes'](_0x44f4cf(0x4e0,0x4b6,0x489,0x4b8))){if(_0x53fba4['IIvka']!==_0x53fba4[_0x44f4cf(0x365,0x403,0x41d,0x385)])_0x499443=_0x1e8e06['replaceAll'](_0x53fba4[_0x1cb4c4(0xd1,0x12c,0xb8,0x108)],'');else{_0x53fba4[_0x44f4cf(0x533,0x3d2,0x43f,0x477)](addLog,'[Banana]\x20启'+_0x1cb4c4(0x177,0xdc,0xf7,0x221)+'。');const _0x24253a=_0x53fba4['yICTw'](_0x2506f2,'默认'),_0x46e928={};_0x46e928['conversati'+'on']=[],_0x46e928[_0x1cb4c4(0x108,0x177,0xaf,0x1ba)+'t']='',_0x32df92=_0xe2052f[_0x24253a]||_0x46e928,addLog(_0x1cb4c4(0x114,0x176,0xdd,0x89)+'用修图预设:\x20\x22'+_0x24253a+'\x22');}}else{if(_0x53fba4['MUHMA'](_0x53fba4[_0x1cb4c4(0x1a3,0x263,0x18a,0xeb)],_0x53fba4[_0x44f4cf(0x440,0x409,0x413,0x418)])){const _0x573b3c={};_0x573b3c['role']=_0x53fba4['ywxHK'],_0x573b3c[_0x44f4cf(0x474,0x3b6,0x315,0x3ba)]=_0x1f2e53,_0x459ae9[_0x44f4cf(0x466,0x361,0x44a,0x3ee)](_0x573b3c);}else{const _0x2730dc={};_0x2730dc[_0x1cb4c4(0xac,0x83,0x11,0x6e)+'on']=[],_0x2730dc['fixedPromp'+'t']='',_0x32df92=_0xe2052f[_0x5d2b4b]||_0x2730dc;}}const _0x5f4b4a=[_0x32df92['fixedPromp'+'t'],_0x7ace87[_0x53fba4[_0x1cb4c4(0x150,0x146,0x183,0x13b)]],_0x7ace87[_0x53fba4['OKSqr']],_0xa53c00,_0x7ace87[_0x44f4cf(0x4aa,0x53d,0x4c4,0x4d3)],_0x7ace87[_0x1cb4c4(0x145,0x1de,0x142,0x1bb)],_0x32df92[_0x44f4cf(0x4f7,0x4e6,0x531,0x4d8)+_0x44f4cf(0x40a,0x42c,0x361,0x40d)],_0x7ace87['最后置']][_0x44f4cf(0x4fc,0x481,0x53d,0x4fc)](Boolean)[_0x1cb4c4(0x181,0x239,0x21e,0x151)](',\x20');_0x53fba4[_0x1cb4c4(0x16c,0xec,0xde,0x1c5)](addLog,_0x44f4cf(0x468,0x4a7,0x45e,0x3ea)+_0x5f4b4a);const _0xf5864a={};_0xf5864a['role']=_0x44f4cf(0x352,0x356,0x3cc,0x405),_0xf5864a[_0x44f4cf(0x374,0x361,0x44f,0x3ba)]=[];const _0x39ffc7={};_0x39ffc7[_0x44f4cf(0x31f,0x3c1,0x3c8,0x38a)]=_0x44f4cf(0x4a0,0x42d,0x53a,0x4dc),_0x39ffc7['content']=[];const _0x370afe=_0x32df92[_0x44f4cf(0x417,0x383,0x3e0,0x3bf)+'on'][_0x1cb4c4(0x18b,0x192,0x19e,0xcf)](_0x2151b7=>[_0xf5864a,_0x39ffc7])[_0x1cb4c4(0x195,0x167,0x15b,0x198)]();let _0x3c9a6e=0x1*-0x24f6+0x1f8c+0x56a;for(const _0x115441 of _0x32df92['conversati'+'on']){if(_0x115441[_0x44f4cf(0x435,0x43d,0x36e,0x405)]?.[_0x1cb4c4(0xdc,0xcc,0x199,0x19f)])_0x370afe[_0x3c9a6e][_0x44f4cf(0x3fb,0x40f,0x307,0x3ba)]['push']({'type':_0x53fba4['ivnYp'],'text':_0x115441[_0x1cb4c4(0xf2,0x55,0x7e,0x54)][_0x44f4cf(0x472,0x368,0x486,0x3ef)]});const _0x46e9e2=await _0x53fba4[_0x1cb4c4(0xe4,0x10e,0x165,0xa5)](getImageFromTurnData,_0x115441['user']);if(_0x46e9e2)_0x370afe[_0x3c9a6e][_0x1cb4c4(0xa7,0x15a,0xee,0xb)][_0x44f4cf(0x492,0x3c6,0x409,0x3ee)]({'type':_0x53fba4[_0x1cb4c4(0x8f,0xee,0x102,0xea)],'image_url':{'url':_0x46e9e2}});_0x3c9a6e++;if(_0x115441[_0x44f4cf(0x496,0x499,0x335,0x3e2)]?.[_0x1cb4c4(0xdc,0xdd,0xa1,0x1a)])_0x370afe[_0x3c9a6e][_0x44f4cf(0x30f,0x307,0x44e,0x3ba)][_0x1cb4c4(0xdb,0x17e,0x146,0x17d)]({'type':_0x53fba4[_0x44f4cf(0x463,0x320,0x3b3,0x3a6)],'text':_0x115441[_0x44f4cf(0x497,0x3c5,0x340,0x3e2)]['text']});const _0x161eaa=await _0x53fba4[_0x44f4cf(0x521,0x41c,0x469,0x4a1)](getImageFromTurnData,_0x115441[_0x44f4cf(0x498,0x3ab,0x355,0x3e2)]);if(_0x161eaa)_0x370afe[_0x3c9a6e][_0x1cb4c4(0xa7,0xf2,0x24,0x5b)][_0x1cb4c4(0xdb,0x185,0x16f,0x154)]({'type':_0x53fba4['YsTfK'],'image_url':{'url':_0x161eaa}});_0x3c9a6e++;}if(!_0x4fb789[_0x1cb4c4(0x185,0x12e,0x108,0x1e9)](_0x53fba4[_0x1cb4c4(0xd1,0x144,0x28,0xba)])){const _0x21c8e4=extension_settings[extensionName][_0x1cb4c4(0x1d1,0x251,0x136,0x1f5)+_0x44f4cf(0x4d3,0x44b,0x4cc,0x4d7)+'ts']||{};for(const _0x4668d5 in _0x21c8e4){if(_0x53fba4[_0x44f4cf(0x3fc,0x53c,0x46c,0x483)]('QxLDN',_0x53fba4[_0x44f4cf(0x49f,0x49e,0x445,0x43d)]))_0xa0f059[_0x1cb4c4(0xae,0x71,0x115,0xff)+'sk'](_0x376445,![]);else{const _0xa69097=_0x21c8e4[_0x4668d5],_0x5d11ca=(_0xa69097[_0x44f4cf(0x572,0x424,0x4c5,0x4d1)]||'')[_0x44f4cf(0x4ba,0x417,0x502,0x476)]('|')[_0x1cb4c4(0x1e9,0x26b,0x1bb,0x1ac)](_0x467f9d=>_0x467f9d[_0x1cb4c4(0x99,0x6d,0xe9,0x124)]()!=='');for(const _0x59a1db of _0x5d11ca){if(_0x53fba4[_0x44f4cf(0x54d,0x4df,0x546,0x4d6)](_0x53fba4['eZUjl'],_0x53fba4[_0x1cb4c4(0x1da,0x1c9,0x273,0x1f0)])){const _0x3e5f57=new _0x30d7c0();_0x3e5f57[_0x1cb4c4(0x141,0x105,0xc2,0x8a)]=()=>_0x787b2b(_0x3e5f57[_0x44f4cf(0x3c2,0x506,0x51c,0x482)]),_0x3e5f57['onerror']=_0x24c1a8,_0x3e5f57[_0x1cb4c4(0x1d9,0x198,0x258,0x1b9)+_0x1cb4c4(0x7c,0x18,0x11c,0xd3)](_0x1065df);}else{if(_0x5f4b4a[_0x1cb4c4(0xcb,0xe0,0x56,0x100)+'e']()[_0x44f4cf(0x4c2,0x432,0x447,0x498)](_0x59a1db['toLowerCas'+'e']())){addLog(_0x44f4cf(0x304,0x447,0x429,0x3a3)+'ound\x20match'+'ing\x20trigge'+'r\x20\x22'+_0x59a1db+(_0x44f4cf(0x4ce,0x406,0x4cf,0x410)+_0x44f4cf(0x377,0x35f,0x458,0x411))+_0x4668d5+'\x22.');const _0x1f0614=_0xa69097['conversati'+'on'];if(_0x1f0614){const _0xb84f3f=[];if(_0x1f0614[_0x44f4cf(0x3f6,0x460,0x43d,0x405)]&&_0x1f0614[_0x1cb4c4(0xf2,0x41,0x80,0x63)][_0x1cb4c4(0xdc,0x17f,0x140,0xc5)])_0xb84f3f[_0x1cb4c4(0xdb,0xbe,0xb1,0x122)]({'type':_0x53fba4[_0x1cb4c4(0x93,0x13c,0x23,0xf4)],'text':_0x1f0614[_0x44f4cf(0x476,0x343,0x3f9,0x405)][_0x44f4cf(0x3a0,0x48f,0x429,0x3ef)]});const _0x31d8c0=await _0x53fba4['YBbPt'](getImageFromTurnData,_0x1f0614[_0x1cb4c4(0xf2,0x133,0x164,0x17e)]);if(_0x31d8c0)_0xb84f3f[_0x1cb4c4(0xdb,0xb3,0x36,0x14b)]({'type':_0x1cb4c4(0x130,0x1e9,0xe9,0x158),'image_url':{'url':_0x31d8c0}});if(_0x53fba4[_0x44f4cf(0x4b6,0x52e,0x50a,0x4e8)](_0xb84f3f[_0x44f4cf(0x470,0x4ac,0x4b8,0x437)],-0x1de*0x1+-0xa*-0x109+-0x87c)){const _0xea518f={};_0xea518f[_0x44f4cf(0x387,0x3b2,0x44b,0x38a)]=_0x53fba4[_0x1cb4c4(0xf5,0x55,0x151,0x12d)],_0xea518f[_0x1cb4c4(0xa7,0xa5,0xdc,0xae)]=_0xb84f3f,_0x370afe[_0x1cb4c4(0xdb,0x38,0xff,0x5e)](_0xea518f);}const _0x4b5fe9=[];if(_0x1f0614[_0x44f4cf(0x40d,0x384,0x441,0x3e2)]&&_0x1f0614['model'][_0x44f4cf(0x3ad,0x375,0x364,0x3ef)])_0x4b5fe9[_0x44f4cf(0x37d,0x37b,0x3d5,0x3ee)]({'type':_0x1cb4c4(0xdc,0xf6,0x120,0x80),'text':_0x1f0614[_0x1cb4c4(0xcf,0x23,0x4f,0x117)][_0x1cb4c4(0xdc,0x3a,0xa7,0x8f)]});const _0x2dcc54=await _0x53fba4['rBBoS'](getImageFromTurnData,_0x1f0614[_0x44f4cf(0x490,0x40e,0x3b0,0x3e2)]);if(_0x2dcc54)_0x4b5fe9[_0x44f4cf(0x3c3,0x458,0x3c5,0x3ee)]({'type':_0x1cb4c4(0x130,0xa6,0x106,0x158),'image_url':{'url':_0x2dcc54}});if(_0x53fba4[_0x44f4cf(0x4c8,0x547,0x5ab,0x4e8)](_0x4b5fe9[_0x1cb4c4(0x124,0x138,0x114,0x159)],0x1bc8*-0x1+0x1c98+0x2*-0x68)){if(_0x53fba4[_0x44f4cf(0x3dd,0x4c9,0x42b,0x447)](_0x53fba4[_0x44f4cf(0x4a4,0x39f,0x3d8,0x43a)],_0x53fba4[_0x44f4cf(0x3bc,0x446,0x3ec,0x47a)])){const _0x31b278={};_0x31b278[_0x1cb4c4(0x77,-0x13,0x8a,0xb7)]=_0x53fba4['ywxHK'],_0x31b278[_0x1cb4c4(0xa7,0xc5,0xa7,0x28)]=_0x4b5fe9,_0x370afe[_0x44f4cf(0x3db,0x37f,0x425,0x3ee)](_0x31b278);}else _0x1be70d['removeList'+_0x1cb4c4(0x142,0x149,0xb8,0x1b8)](_0x39dbf6,_0x404ffc);}}break;}}}}}}if(!_0x4fb789[_0x44f4cf(0x53e,0x46d,0x4bb,0x498)](_0x53fba4[_0x1cb4c4(0xd1,0x184,0x13b,0x143)])){const _0x5b1802={};_0x5b1802[_0x44f4cf(0x3c4,0x3cc,0x364,0x421)]=_0x53fba4[_0x1cb4c4(0x93,0x154,0x49,0xac)],_0x5b1802['text']=_0x5f4b4a;const _0x235a49={};_0x235a49[_0x44f4cf(0x3f3,0x370,0x384,0x38a)]='user',_0x235a49['content']=[_0x5b1802],_0x370afe[_0x1cb4c4(0xdb,0x107,0x165,0x12e)](_0x235a49);}else{const _0x4efc93=[],_0x4383b8=_0x53fba4['uJaEO'](_0x124302,_0x5f4b4a),_0x50ff05=[_0x32df92[_0x44f4cf(0x437,0x4b1,0x41e,0x41b)+'t'],_0x4383b8,_0x32df92[_0x44f4cf(0x492,0x4a3,0x503,0x4d8)+'mpt']]['filter'](Boolean)['join'](',\x20'),_0x387b6f={};_0x387b6f['type']='text',_0x387b6f['text']=_0x50ff05,_0x4efc93[_0x44f4cf(0x3ed,0x490,0x38f,0x3ee)](_0x387b6f);if(_0x12b179){const _0xebd58e={};_0xebd58e[_0x1cb4c4(0x15b,0x9b,0x13d,0x99)]=_0x12b179;const _0x235136={};_0x235136['type']=_0x53fba4['YsTfK'],_0x235136['image_url']=_0xebd58e,_0x4efc93[_0x1cb4c4(0xdb,0x50,0x88,0xbb)](_0x235136),addLog(_0x1cb4c4(0x131,0x1a6,0x13f,0xd5)+_0x44f4cf(0x3aa,0x3cf,0x43c,0x3fd)+'的图片');}const _0x4408fa={};_0x4408fa[_0x1cb4c4(0x77,0x12c,0x18,0xe0)]=_0x53fba4[_0x44f4cf(0x408,0x3fb,0x3ae,0x408)],_0x4408fa['content']=_0x4efc93,_0x370afe['push'](_0x4408fa),_0x53fba4[_0x44f4cf(0x43a,0x562,0x43b,0x4cf)](addLog,'[Banana]\x20修'+_0x1cb4c4(0xe3,0x68,0xbd,0x144)+_0x50ff05);}const _0x554f1a={};_0x554f1a[_0x1cb4c4(0x1a6,0x108,0x1ca,0x105)+'o']=_0x178716;const _0x3f44c6={};_0x3f44c6[_0x44f4cf(0x48f,0x4d3,0x4cb,0x414)+'g']=_0x554f1a,_0x34d39c={'model':_0x58661d,'messages':_0x370afe[_0x1cb4c4(0x1e9,0x1b4,0x21a,0x1fe)](_0x2e03e3=>_0x2e03e3['content'][_0x1cb4c4(0x124,0xe7,0x170,0x179)]>-0x1*0x138e+0x103*0x6+0xd7c),'config':_0x3f44c6},addLog('[Banana]\x20B'+_0x44f4cf(0x440,0x495,0x550,0x4ba)+_0x44f4cf(0x3e4,0x371,0x414,0x3d3)+'oad\x20with\x20'+_0x34d39c[_0x1cb4c4(0x186,0x153,0x17b,0x164)][_0x1cb4c4(0x124,0x178,0x66,0x158)]+_0x1cb4c4(0x192,0x1b1,0x1f6,0x18c));}let _0x259808=_0x24949a[_0x44f4cf(0x49a,0x44d,0x535,0x497)](/\/$/,''),_0x2bdf7e;if(_0x259808[_0x1cb4c4(0xbd,0x8f,0x16,0x12b)](_0x53fba4[_0x1cb4c4(0xff,0x11f,0x1a4,0x129)])||_0x259808[_0x44f4cf(0x3d6,0x402,0x413,0x498)](_0x53fba4[_0x44f4cf(0x55c,0x40c,0x4c2,0x4ac)])){if(_0x53fba4[_0x44f4cf(0x4d5,0x436,0x451,0x491)](_0x53fba4['CLaWK'],_0x53fba4['CLaWK']))_0x2bdf7e=_0x53fba4['OOELe'](_0x259808,_0x2646e2);else{const _0x4f9e3c={};_0x4f9e3c['role']=_0x53fba4[_0x1cb4c4(0xf5,0x163,0xbf,0x1a8)],_0x4f9e3c[_0x44f4cf(0x394,0x443,0x47a,0x3ba)]=[{'type':_0x53fba4['ivnYp'],'text':_0x13a45b}],_0x52b2a0['push'](_0x4f9e3c);}}else _0x2bdf7e=_0x53fba4['syWKI'](_0x259808+'/v1',_0x2646e2);_0x2bdf7e=_0x2bdf7e['replace'](/\/v1\/v1\//g,_0x53fba4[_0x1cb4c4(0x199,0xe7,0x116,0x10d)]);const _0x17d937=extension_settings[extensionName][_0x1cb4c4(0xf1,0x15b,0x11e,0x4d)];let _0x3a007f,_0x26fdd6,_0x15a64b;if(_0x53fba4[_0x44f4cf(0x2d0,0x33b,0x429,0x390)](_0x17d937,_0x1cb4c4(0xc7,0x7e,0x6a,0x142))){let _0x54088a=_0x259808;!_0x54088a['endsWith'](_0x53fba4[_0x44f4cf(0x419,0x369,0x3d4,0x412)])&&!_0x54088a[_0x44f4cf(0x3db,0x4b1,0x538,0x498)](_0x53fba4[_0x1cb4c4(0x199,0x23a,0x138,0x1fc)])&&(_0x53fba4[_0x44f4cf(0x501,0x42b,0x4cd,0x4cc)](_0x53fba4[_0x44f4cf(0x40c,0x511,0x3b9,0x45a)],_0x53fba4[_0x1cb4c4(0x10a,0xed,0xa8,0xd2)])?_0x54088a=_0x54088a+_0x53fba4['focHl']:(_0x52f4ec['on'](_0x21791b[_0x44f4cf(0x4c0,0x538,0x4f1,0x4f0)+'MAGE_REQUE'+'ST'],_0x662d58),_0x52c361['on'](_0x53fba4['VvJdK'],_0x2ae216),_0x396568(_0x53fba4['NYCQp'])));_0x54088a=_0x54088a[_0x1cb4c4(0x184,0x143,0x1c4,0x169)](/\/v1\/$/,_0x53fba4[_0x44f4cf(0x3b4,0x449,0x3dd,0x412)]),_0x3a007f=_0x53fba4[_0x1cb4c4(0x1cf,0x13a,0x248,0x1b9)],_0x26fdd6=_0x53fba4['DCNGe'](getRequestHeaders,window['token']);const _0x7ab6a7={};_0x7ab6a7['chat_compl'+'etion_sour'+'ce']=_0x53fba4[_0x44f4cf(0x4b5,0x44b,0x42d,0x493)],_0x7ab6a7[_0x44f4cf(0x3ae,0x346,0x359,0x38b)]=_0x54088a,_0x7ab6a7[_0x1cb4c4(0x1b6,0x1a8,0x1c4,0x141)+_0x44f4cf(0x3f5,0x359,0x460,0x3c0)+'rs']=_0x1cb4c4(0x74,0x125,0x17,0x133)+'ion:\x20\x22Bear'+_0x44f4cf(0x3f4,0x2f1,0x341,0x398)+_0x169606+'\x22',_0x7ab6a7[_0x1cb4c4(0xcf,0xde,0x37,0x121)]=_0x58661d,_0x7ab6a7[_0x1cb4c4(0x186,0x144,0x1c6,0xff)]=_0x34d39c[_0x1cb4c4(0x186,0x22f,0x204,0x1dd)],_0x7ab6a7[_0x1cb4c4(0xa4,-0x3,-0xd,0x89)]=![],_0x15a64b=_0x7ab6a7;if(_0x58661d[_0x1cb4c4(0x168,0x15d,0x135,0x178)](_0x53fba4[_0x1cb4c4(0xb4,0x15e,0xe2,0xb8)])){if(_0x53fba4[_0x44f4cf(0x384,0x3bb,0x415,0x43e)](_0x53fba4[_0x44f4cf(0x4b4,0x3a3,0x490,0x441)],_0x53fba4[_0x1cb4c4(0x100,0x98,0xf8,0x88)]))_0x182c39['removeList'+_0x1cb4c4(0x142,0x1eb,0x8d,0x1d7)](_0x5966d7['GENERATE_I'+'MAGE_REQUE'+'ST'],_0xc997d7),_0x40f886[_0x44f4cf(0x4c2,0x4ee,0x519,0x4d9)+_0x44f4cf(0x3d8,0x422,0x504,0x455)](_0x44f4cf(0x4fd,0x4d3,0x41c,0x486)+'cancel_ban'+_0x1cb4c4(0x1d0,0x248,0x20f,0x136),_0x49bb3f),_0x594201[_0x1cb4c4(0x1e3,0x1d7,0x1df,0x212)](_0x37689=>{function _0x3203bc(_0x14daf6,_0x2d148c,_0x3f0189,_0x1f741e){return _0x44f4cf(_0x14daf6-0xef,_0x2d148c-0xe,_0x1f741e,_0x3f0189- -0x1c6);}function _0x14297c(_0x36f6de,_0x4ee77a,_0x45e5c6,_0x2ab304){return _0x44f4cf(_0x36f6de-0x10f,_0x4ee77a-0x129,_0x4ee77a,_0x2ab304- -0x7e);}_0x4f53a4[_0x3203bc(0x3cc,0x2de,0x313,0x289)+_0x3203bc(0x34c,0x281,0x28f,0x26a)](_0x37689,_0x231281);}),_0x571047['initialize'+'BananaList'+'ener']=![],_0x53fba4[_0x44f4cf(0x56c,0x407,0x4fe,0x4b1)](_0x2a0a2d,_0x44f4cf(0x44b,0x3af,0x417,0x3f4)+_0x1cb4c4(0xb1,0x104,0x47,0x8f));else{_0x53fba4[_0x1cb4c4(0x1e4,0x293,0x123,0x22f)](addLog,_0x44f4cf(0x515,0x4d1,0x455,0x49b)+'magen\x20模型不支'+'持酒馆代理，切换为直'+_0x44f4cf(0x443,0x47c,0x3ad,0x43f)),_0x3a007f=_0x2bdf7e;const _0x50d881={};_0x50d881['Content-Ty'+'pe']=_0x53fba4['OzdxN'],_0x50d881[_0x1cb4c4(0x74,0xcc,0x52,0x23)+'ion']=_0x1cb4c4(0x193,0x192,0x1d6,0x250)+_0x169606,_0x26fdd6=_0x50d881,_0x15a64b=_0x34d39c;}}_0x53fba4['EihHp'](addLog,_0x1cb4c4(0x114,0xd7,0xa9,0x95)+_0x1cb4c4(0x146,0x208,0x1b0,0x115));}else{if(_0x53fba4[_0x1cb4c4(0xe0,0x5e,0x161,0x157)](_0x53fba4[_0x44f4cf(0x394,0x44a,0x3f0,0x400)],_0x53fba4[_0x1cb4c4(0x13e,0xa3,0x13b,0x1b6)]))_0x53fba4[_0x1cb4c4(0x19e,0x142,0xea,0x186)](_0x168810,'缓存设置为不存入数据'+'库');else{_0x3a007f=_0x2bdf7e;const _0x3d1616={};_0x3d1616[_0x44f4cf(0x434,0x470,0x57d,0x4df)+'pe']=_0x1cb4c4(0xb6,0x164,0xe6,0x172)+'n/json',_0x3d1616[_0x44f4cf(0x2d4,0x3c1,0x422,0x387)+_0x1cb4c4(0xb2,0x2b,0x18,0xfd)]=_0x1cb4c4(0x193,0x1e7,0x1db,0x1bc)+_0x169606,_0x26fdd6=_0x3d1616,_0x15a64b=_0x34d39c,_0x53fba4['XdAgX'](addLog,'[Banana]\x20使'+_0x1cb4c4(0xbf,0x22,0xf0,0x154));}}_0x53fba4['cLdos'](addLog,_0x44f4cf(0x55d,0x556,0x5a3,0x4ef)+'ending\x20req'+_0x1cb4c4(0x174,0x108,0x1f5,0x173)+_0x3a007f),_0x53fba4[_0x1cb4c4(0xf6,0x10c,0xfa,0x1a7)](addLog,_0x1cb4c4(0x183,0x1cb,0x102,0x11c)+'ayload:\x20'+JSON[_0x44f4cf(0x4b4,0x4fb,0x503,0x4f1)](_0x15a64b,null,0x12fd+0x878*-0x2+-0x20b*0x1));try{taskQueue[_0x44f4cf(0x39d,0x450,0x3a8,0x3f9)+'us'](_0x5f4818,_0x53fba4[_0x1cb4c4(0x6f,-0x9,0x23,0x18)]);const _0x4399a5=await _0x53fba4[_0x44f4cf(0x351,0x303,0x2cf,0x391)](fetch,_0x3a007f,{'method':_0x53fba4[_0x1cb4c4(0x19d,0x233,0x240,0x137)],'headers':_0x26fdd6,'body':JSON[_0x44f4cf(0x510,0x5a4,0x590,0x4f1)](_0x15a64b)});if(!_0x4399a5['ok']){const _0x4e3ce5=await _0x4399a5['text']();throw new Error(_0x44f4cf(0x414,0x3e2,0x4f7,0x481)+'t\x20failed\x20w'+_0x1cb4c4(0xb7,0x63,0xe9,0x111)+'\x20'+_0x4399a5[_0x1cb4c4(0x15a,0x1f1,0x16b,0xc7)]+':\x20'+_0x4e3ce5);}const _0x35ff85=await _0x4399a5['json']();let _0x44235e='';const _0x56a63a=_0x35ff85['choices'];if(_0x56a63a&&_0x56a63a[_0x1cb4c4(0x124,0x72,0x118,0x139)]>0xc*-0x10b+-0x2643+-0x7*-0x741){const _0x2c8c68=_0x56a63a[-0x2*0x1150+0x3*-0xd+0x22c7][_0x44f4cf(0x425,0x4ea,0x4f0,0x4c5)]?.[_0x44f4cf(0x3aa,0x421,0x44e,0x3ba)];if(Array[_0x44f4cf(0x3b1,0x481,0x362,0x403)](_0x2c8c68))for(const _0x28fa7f of _0x2c8c68){if(_0x53fba4[_0x1cb4c4(0x134,0xa5,0x1e1,0x15a)](_0x53fba4[_0x1cb4c4(0xa3,0x4,0x1e,0x44)],_0x53fba4[_0x44f4cf(0x36e,0x3b2,0x34c,0x3b6)]))_0x496644['Character\x20'+_0x5884c5+_0x1cb4c4(0x1e0,0x28c,0x13f,0x1c7)]&&(_0x5ee322=_0x53fba4['OOELe'](_0x22bae6,',\x20')+_0x4eb253[_0x1cb4c4(0x84,0x76,-0x26,0x13c)+_0x889ed3+'\x20Prompt']);else{if(_0x53fba4[_0x1cb4c4(0x18f,0x1eb,0xf0,0x1a6)](_0x28fa7f['type'],_0x53fba4['YsTfK'])&&_0x28fa7f[_0x1cb4c4(0x130,0x15e,0x96,0x107)]?.[_0x1cb4c4(0x15b,0xef,0xad,0x106)]){if(_0x53fba4[_0x44f4cf(0x444,0x3b8,0x3be,0x3f3)](_0x53fba4[_0x1cb4c4(0x152,0x1d5,0x1f4,0xd7)],_0x53fba4[_0x1cb4c4(0x152,0xff,0x1db,0x105)])){_0x44235e=_0x28fa7f[_0x1cb4c4(0x130,0xfb,0x111,0x137)][_0x44f4cf(0x49b,0x51c,0x4bb,0x46e)];break;}else{if(_0x1a1b91){const _0x428fee=_0x148c6b['apply'](_0x4827d6,arguments);return _0x38679b=null,_0x428fee;}}}}}else{if(_0x53fba4[_0x44f4cf(0x472,0x459,0x3a3,0x3f3)](typeof _0x2c8c68,_0x44f4cf(0x343,0x369,0x3e6,0x399))){if(_0x53fba4[_0x1cb4c4(0x18f,0xfa,0x1c0,0x20e)](_0x53fba4[_0x44f4cf(0x3c8,0x41a,0x439,0x3a5)],_0x53fba4[_0x1cb4c4(0x92,0x138,0xdb,-0x2e)])){const _0x5a0b88=/!\[.*?\]\((https?:\/\/[^\s\)]+)\)/,_0x38e7c7=_0x2c8c68[_0x44f4cf(0x3b3,0x509,0x48b,0x466)](_0x5a0b88);if(_0x38e7c7&&_0x38e7c7[0xed3+-0xda+-0x12a*0xc]){addLog(_0x53fba4[_0x1cb4c4(0xf4,0x14c,0x123,0x60)]);const _0x1a7e8f=_0x38e7c7[0x22d*-0x3+-0x856+0xede];addLog(_0x1cb4c4(0xef,0xb5,0x164,0x11d)+_0x1cb4c4(0xe8,0x5f,0x152,0x11a)+_0x44f4cf(0x3e5,0x49c,0x489,0x44d)+_0x1a7e8f);try{if(_0x53fba4[_0x44f4cf(0x47f,0x4f6,0x4b3,0x4cc)](_0x53fba4[_0x44f4cf(0x3e8,0x426,0x42c,0x3ae)],_0x53fba4[_0x44f4cf(0x3eb,0x35b,0x400,0x3ae)]))_0x53fba4[_0x1cb4c4(0x19e,0x24f,0xfa,0x170)](_0x1ad203,_0x53fba4[_0x44f4cf(0x3e1,0x4e1,0x46b,0x42a)]);else{const _0x29b05b=await _0x53fba4[_0x1cb4c4(0x8b,0x129,-0xe,0x14b)](fetch,_0x1a7e8f);if(!_0x29b05b['ok'])throw new Error(_0x44f4cf(0x4b8,0x565,0x491,0x4ad)+_0x1cb4c4(0x1cd,0x1d3,0x197,0x192)+_0x1cb4c4(0x9a,0xfb,0x12f,0xd6)+_0x29b05b[_0x1cb4c4(0x15a,0xfe,0xd5,0xa0)]);const _0x1089d1=await _0x29b05b[_0x44f4cf(0x31a,0x3af,0x44c,0x395)](),_0x35aac7=await new Promise((_0x1b8c68,_0x1a889d)=>{const _0x4bfd84=new FileReader();function _0x5147f4(_0x9c88af,_0x17bf35,_0x107a94,_0xe6b71b){return _0x44f4cf(_0x9c88af-0x1bc,_0x17bf35-0x114,_0x107a94,_0x9c88af- -0x5e);}_0x4bfd84[_0x3e2dd1(0x39d,0x4e3,0x3a4,0x443)]=()=>_0x1b8c68(_0x4bfd84[_0x3e2dd1(0x529,0x498,0x3dd,0x471)]);function _0x3e2dd1(_0x4bb622,_0x1c32ad,_0xdb9b76,_0x5d9f84){return _0x44f4cf(_0x4bb622-0x111,_0x1c32ad-0xd5,_0xdb9b76,_0x5d9f84- -0x11);}_0x4bfd84[_0x3e2dd1(0x530,0x466,0x47d,0x4d4)]=_0x1a889d,_0x4bfd84['readAsData'+_0x3e2dd1(0x2c4,0x3ae,0x37b,0x37e)](_0x1089d1);});_0x44235e=_0x35aac7,_0x53fba4[_0x1cb4c4(0x136,0x170,0x9e,0x1e4)](addLog,_0x53fba4['eDrMv']);}}catch(_0x197dd9){_0x53fba4[_0x1cb4c4(0x16c,0x1c9,0xc7,0xf3)](addLog,_0x1cb4c4(0x90,-0xd,0x43,0x105)+_0x44f4cf(0x45a,0x59e,0x458,0x4fa)+_0x1cb4c4(0x16a,0x220,0x107,0x1af)+_0x1cb4c4(0xb3,0x3,0xe8,0xf4)+'\x20'+_0x197dd9['message']),_0x44235e=_0x1a7e8f,addLog(_0x53fba4[_0x44f4cf(0x54d,0x3fd,0x52a,0x4b3)]);}}else addLog(_0x53fba4[_0x1cb4c4(0x117,0x158,0x167,0x7d)]);}else{_0xb37d33=_0x44f4cf(0x3ac,0x2df,0x34c,0x39b)+_0x1cb4c4(0x1eb,0x16c,0x284,0x283)+_0x3be229;const _0x2e7342={};_0x2e7342[_0x1cb4c4(0x108,0xb5,0x114,0x7e)+'t']='';const _0x6c5854=_0x2abe7b[_0x99fe43]||_0x2e7342,_0xa83a56=[_0x6c5854[_0x1cb4c4(0x108,0x6b,0x160,0x187)+'t'],_0x52217e[_0x53fba4[_0x44f4cf(0x441,0x3dc,0x3c9,0x463)]],_0x345841[_0x1cb4c4(0x13c,0x156,0x118,0x17f)],_0x1c5078,_0xd5f359[_0x53fba4[_0x44f4cf(0x4d7,0x564,0x54b,0x4ca)]],_0x2c49b3[_0x53fba4[_0x44f4cf(0x396,0x3e0,0x43e,0x41a)]],_0x6c5854['postfixPro'+_0x1cb4c4(0xfa,0x6a,0xe1,0x118)],_0x3ed3bd[_0x53fba4[_0x1cb4c4(0xe5,0x2f,0x156,0x93)]]][_0x1cb4c4(0x1e9,0x252,0x267,0x196)](_0x1b6bd2)[_0x1cb4c4(0x181,0x14e,0x11e,0x212)](',\x20');_0x5ec31a(_0x1cb4c4(0xd7,0x26,0xc9,0xf9)+_0xa83a56);const _0x236a07={};_0x236a07[_0x44f4cf(0x4c3,0x46c,0x520,0x479)]=_0xa83a56;const _0x3cb380={};_0x3cb380[_0x44f4cf(0x3ef,0x414,0x479,0x431)+'t']=0x1,_0x3cb380['aspectRati'+'o']=_0x48d4c1;const _0x1e30ec={};_0x1e30ec['instances']=[_0x236a07],_0x1e30ec[_0x44f4cf(0x488,0x48a,0x4ab,0x428)]=_0x3cb380,_0x317ed7=_0x1e30ec,_0x53fba4[_0x1cb4c4(0x19e,0x1ca,0xfd,0x261)](_0x87e47c,_0x1cb4c4(0x125,0xe1,0x1c6,0xa5)+_0x1cb4c4(0xd9,0x162,0xec,0x180)+'n\x20payload\x20'+_0x1cb4c4(0x162,0x19d,0x13e,0x20e)+_0x44f4cf(0x3f9,0x37d,0x4cb,0x40b)+_0xa83a56);}}}}if(!_0x44235e){if(_0x53fba4[_0x44f4cf(0x37e,0x36b,0x2fd,0x39c)](_0x53fba4[_0x44f4cf(0x47c,0x41a,0x354,0x3bb)],_0x53fba4[_0x1cb4c4(0xa8,0x54,0xd0,0x17)])){_0x53fba4[_0x1cb4c4(0x19e,0x1a9,0x10d,0x22f)](_0x3bcb19,'[Banana]\x20I'+_0x44f4cf(0x50e,0x508,0x437,0x478)+_0x1cb4c4(0x1df,0x244,0x20f,0x25e)+_0x44f4cf(0x496,0x45d,0x4ce,0x43f)),_0x318941=_0x124779;const _0x183da6={};_0x183da6[_0x1cb4c4(0x1cc,0x147,0x280,0x289)+'pe']=_0x53fba4[_0x44f4cf(0x3e8,0x412,0x2fe,0x3be)],_0x183da6[_0x44f4cf(0x411,0x3ec,0x398,0x387)+_0x1cb4c4(0xb2,0x11e,0x8,0x72)]=_0x1cb4c4(0x193,0x233,0x254,0x17e)+_0x4e8011,_0x268658=_0x183da6,_0x2163db=_0x327fd1;}else throw new Error(_0x53fba4[_0x1cb4c4(0xb0,0x117,0x15c,0xb5)]);}addLog('[Banana]\x20I'+_0x1cb4c4(0x194,0x12f,0x10f,0x1c2)+_0x1cb4c4(0x18a,0x238,0x211,0x1b3)+_0x1cb4c4(0x7f,-0x17,0xd1,0x2a)),taskQueue[_0x44f4cf(0x3a9,0x3e9,0x44a,0x3c1)+'sk'](_0x5f4818,!![]),currentTaskId=null;const _0x4f7365={};return _0x4f7365[_0x1cb4c4(0x151,0x16a,0x1b9,0xad)]=_0x44235e,_0x4f7365[_0x44f4cf(0x477,0x4e9,0x43c,0x4b5)]=_0x3a9e5a||'',_0x4f7365;}catch(_0x39f8b5){_0x53fba4[_0x1cb4c4(0x1b4,0x107,0x17c,0x12f)](addLog,_0x1cb4c4(0x90,0xd9,0x1a,0xb1)+'etch\x20error'+':\x20'+_0x39f8b5['message']),console[_0x1cb4c4(0xaf,0x101,0x14a,0x6c)](_0x53fba4[_0x1cb4c4(0x6d,0x8d,0xb5,0x3a)],_0x39f8b5);if(_0x53fba4['JMpJw'](_0x39f8b5['message'],_0x53fba4['BCkcd'])){}else _0x53fba4[_0x1cb4c4(0x1d6,0x192,0x176,0x282)](_0x53fba4['sLvGN'],_0x53fba4['sLvGN'])?(_0x3e8e60['initialize'+_0x44f4cf(0x534,0x56c,0x415,0x4d0)+_0x44f4cf(0x49a,0x469,0x3b8,0x455)]=!![],_0x53fba4[_0x1cb4c4(0x1b5,0x134,0x1e1,0x1d3)](_0x285486)):taskQueue[_0x1cb4c4(0xae,0x2b,0xff,0x16d)+'sk'](_0x5f4818,![]);currentTaskId=null;throw _0x39f8b5;}}export async function bananaGenerate(_0x27e5dd){const _0x41d573={'XiNfq':function(_0x1ca2a2,_0x54e865){return _0x1ca2a2(_0x54e865);},'YOPoz':function(_0x53404f){return _0x53404f();},'RJcbq':_0x38b909(-0x135,-0x92,-0x149,-0xa1),'cOaKB':_0x38b909(-0xc4,-0xe5,-0x27,-0xfd)+_0x38b909(-0x2c,-0xda,-0x7c,-0x4e)+_0x38b909(-0x193,-0x256,-0x1b7,-0x206)+_0x38b909(-0x179,-0x1ba,-0xfc,-0x10b),'Vuopy':function(_0x5e8fdd,_0x5a870b){return _0x5e8fdd(_0x5a870b);},'kokTa':_0x38b909(-0x10b,-0x1b7,-0x7c,-0x77),'uaubI':'imagen','YPXAo':_0x59d76c(0x2b1,0x372,0x292,0x262)+_0x38b909(-0xc5,-0x79,-0x13b,-0x3),'SRRHt':function(_0x297087){return _0x297087();},'XFuue':'{修图}','RENMw':function(_0x5d4300,_0x253989){return _0x5d4300===_0x253989;},'VeMfW':_0x59d76c(0x368,0x2cf,0x410,0x36b),'vyqgP':'XeBXx','DsDcY':function(_0x1ca3d9,_0x356ce6){return _0x1ca3d9!=_0x356ce6;},'VjLSG':function(_0x25965f,_0x2dafd3,_0x138e64,_0x3880bb){return _0x25965f(_0x2dafd3,_0x138e64,_0x3880bb);},'WBpXT':function(_0x244fdb,_0x42612b){return _0x244fdb(_0x42612b);},'NYlrF':function(_0x4bcc64,_0xf176aa){return _0x4bcc64!==_0xf176aa;},'gHizQ':'JxEMR','GaUlZ':function(_0x166fcc,_0x4766a8){return _0x166fcc+_0x4766a8;},'sqqbe':function(_0x1b77d6,_0x2caf3b){return _0x1b77d6(_0x2caf3b);},'ofjva':function(_0x18d234,_0x1a1082){return _0x18d234===_0x1a1082;},'ACOaw':'nvIHh'};_0x41d573[_0x59d76c(0x370,0x401,0x3bd,0x34f)](clearLog);let {id:_0x1cc0c5,prompt:_0x561061,width:_0x1a1877,height:_0x3c8d90,change:_0x1884b1,retouchPrompt:_0x2cb34b,retouchImage:_0x170e76}=_0x27e5dd;currentRequestId=_0x1cc0c5;function _0x59d76c(_0xd198b5,_0xfd302,_0x283cfb,_0x32fa5e){return _0x5509(_0xd198b5-0x87,_0x283cfb);}currentPrompt=_0x561061;function _0x38b909(_0x57151a,_0x48fe2b,_0xb16df3,_0x3ce88a){return _0x5509(_0x57151a- -0x381,_0x3ce88a);}addLog(_0x38b909(-0xf7,-0xa6,-0x163,-0x12b)+_0x38b909(-0x192,-0x1f0,-0x1dc,-0x15e)+_0x59d76c(0x39f,0x2e9,0x45c,0x3bb)+_0x59d76c(0x2d5,0x347,0x38f,0x306)+_0x59d76c(0x358,0x376,0x33f,0x2d4)+_0x1cc0c5+')');let _0xb71aa3='';_0x1884b1?_0xb71aa3=_0x1884b1['replaceAll']('{修图}',''):_0xb71aa3=_0x561061;if(_0x1884b1&&_0x1884b1[_0x59d76c(0x380,0x30d,0x441,0x2fb)](_0x41d573['XFuue'])){if(_0x41d573['RENMw'](_0x41d573['VeMfW'],_0x41d573[_0x59d76c(0x387,0x313,0x3dc,0x414)]))_0x3244ee[_0x13499f][_0x38b909(-0xc9,-0x61,-0x94,-0x142)][_0x38b909(-0x4b,-0xfc,-0x28,-0x9d)]=-0x1d43+0x2280+-0x53c,_0x41d573[_0x59d76c(0x3a9,0x36c,0x415,0x399)](_0x42a906,_0x38b909(-0x35,-0x26,0x6,-0x18)+_0x38b909(-0x151,-0x1cd,-0xca,-0x176)+_0x4094e5[_0x1e42da][_0x38b909(-0xc9,-0x11,-0x186,-0x8d)][_0x38b909(-0x4b,-0xd7,-0xd7,-0x24)]);else{_0x41d573[_0x38b909(-0xdb,-0x64,-0xc9,-0x1a)](addLog,_0x59d76c(0x377,0x39b,0x2fb,0x36e)+'启动');if(_0x2cb34b)_0x41d573['XiNfq'](addLog,'修图指令:\x20'+_0x2cb34b);if(_0x170e76)_0x41d573[_0x59d76c(0x3a9,0x41a,0x338,0x353)](addLog,_0x59d76c(0x348,0x381,0x3f8,0x40b)+']');}}try{const {image:_0x1d2b36,change:_0x63f651}=await generateBananaImage({'prompt':_0x561061,'width':_0x1a1877,'height':_0x3c8d90,'change':_0x1884b1,'retouchPrompt':_0x2cb34b,'retouchImage':_0x170e76});if(_0x41d573[_0x38b909(-0x18a,-0xe0,-0x123,-0x122)](extension_settings[extensionName][_0x38b909(-0x14b,-0x160,-0x1a0,-0xeb)],'0')){const _0x426869={};_0x426869[_0x59d76c(0x39d,0x3f7,0x323,0x3d0)]=_0xb71aa3,await _0x41d573[_0x59d76c(0x397,0x326,0x35c,0x369)](setItemImg,_0x561061,_0x1d2b36,_0x426869),_0x41d573[_0x59d76c(0x313,0x302,0x354,0x29c)](addLog,_0x59d76c(0x31a,0x312,0x3a8,0x2ea)+_0x38b909(-0x5a,0x58,-0x53,-0x94)+'\x20'+_0x561061),extension_settings[extensionName]['banana'][_0x59d76c(0x3bd,0x2fb,0x35d,0x44a)]?_0x41d573[_0x38b909(-0xd0,-0xdd,-0x6a,-0xf3)](_0x41d573[_0x38b909(-0x148,-0x1f6,-0x12a,-0x1da)],_0x41d573[_0x38b909(-0x148,-0x19c,-0x9e,-0x17d)])?(!_0x948f3f['initialize'+_0x38b909(-0x50,-0x105,0x0,-0x34)+_0x59d76c(0x33d,0x2b2,0x36d,0x3a5)]&&(_0x2db5d8['initialize'+_0x38b909(-0x50,0x52,-0xc0,0x70)+_0x59d76c(0x33d,0x31e,0x3c3,0x3e9)]=!![],_0x41d573['YOPoz'](_0x1424ca)),_0x41d573[_0x38b909(-0x55,0x40,0x2b,-0x92)](_0x161df5)):(extension_settings[extensionName]['banana'][_0x38b909(-0x4b,0x5,-0x62,-0x78)]=_0x41d573[_0x38b909(-0x11a,-0x1b0,-0x10c,-0xd0)](extension_settings[extensionName][_0x59d76c(0x33f,0x328,0x367,0x323)][_0x38b909(-0x4b,0x44,0x11,0x75)],-0x45*0x61+-0xad7+0x24fd),_0x41d573[_0x59d76c(0x313,0x369,0x31f,0x3ae)](addLog,_0x59d76c(0x3d3,0x3cd,0x3a6,0x47c)+'r\x20prompt:\x20'+extension_settings[extensionName]['banana'][_0x59d76c(0x3bd,0x44e,0x354,0x3eb)])):(extension_settings[extensionName][_0x38b909(-0xc9,-0x8e,-0x88,-0xad)][_0x59d76c(0x3bd,0x386,0x35f,0x460)]=0xd3e+0x517+-0x1254,_0x41d573[_0x59d76c(0x26b,0x26e,0x21f,0x28c)](addLog,'当前生图次数为\x20fo'+_0x38b909(-0x151,-0x10d,-0x124,-0x18a)+extension_settings[extensionName][_0x59d76c(0x33f,0x37f,0x2a9,0x2ac)][_0x38b909(-0x4b,0x34,0x11,-0xc9)]));}else _0x41d573[_0x38b909(-0xdb,-0x17b,-0x102,-0x16a)](addLog,_0x59d76c(0x36c,0x3df,0x34a,0x36c)+'库');const _0xa6dc39={};_0xa6dc39['id']=_0x1cc0c5,_0xa6dc39[_0x59d76c(0x290,0x335,0x249,0x31d)]=!![],_0xa6dc39['imageData']=_0x1d2b36,_0xa6dc39[_0x38b909(-0xa7,-0x12d,-0x2f,-0x144)]=_0x561061,_0xa6dc39[_0x59d76c(0x39d,0x35f,0x3aa,0x3e4)]=_0xb71aa3,eventSource[_0x59d76c(0x31b,0x2c9,0x297,0x30d)](EventType['GENERATE_I'+_0x59d76c(0x301,0x310,0x3a1,0x38e)+'NSE'],_0xa6dc39),addLog(_0x59d76c(0x2b4,0x2c4,0x331,0x300)+_0x38b909(-0x170,-0x16c,-0x1dc,-0xb8)+_0x59d76c(0x3a7,0x416,0x35c,0x34c)+'nse\x20for\x20ID'+':\x20'+_0x1cc0c5);}catch(_0x2864bc){if(_0x41d573[_0x59d76c(0x2b6,0x27a,0x256,0x291)](_0x41d573[_0x59d76c(0x2a5,0x2c9,0x298,0x1e2)],_0x59d76c(0x3c3,0x42e,0x445,0x3db))){const _0x1e1536='[Banana]\x20G'+_0x38b909(-0x2b,-0x26,0x4a,-0xa9)+_0x38b909(-0x177,-0x188,-0x132,-0xb8)+_0x59d76c(0x2da,0x31a,0x246,0x348)+_0x1cc0c5+':\x20'+_0x2864bc[_0x59d76c(0x3ad,0x355,0x321,0x337)];_0x41d573[_0x59d76c(0x3a9,0x36e,0x337,0x38a)](addLog,_0x1e1536),console[_0x38b909(-0x15e,-0x1e8,-0x181,-0x12e)](_0x1e1536);const _0x33d5a2={};_0x33d5a2['id']=_0x1cc0c5,_0x33d5a2[_0x38b909(-0x178,-0xfd,-0x198,-0xe6)]=![],_0x33d5a2[_0x38b909(-0x15e,-0x112,-0x127,-0xe5)]=_0x2864bc['message'],_0x33d5a2[_0x38b909(-0xa7,-0xec,-0x136,0xc)]=_0x561061,eventSource['emit'](EventType[_0x59d76c(0x3d8,0x3f7,0x44f,0x45b)+_0x59d76c(0x301,0x373,0x388,0x2eb)+_0x59d76c(0x354,0x348,0x406,0x2a8)],_0x33d5a2),_0x41d573['WBpXT'](addLog,_0x38b909(-0x154,-0xf1,-0x1c1,-0x210)+'mitted\x20fai'+_0x38b909(-0x153,-0xce,-0xdb,-0x16f)+'nse\x20for\x20ID'+':\x20'+_0x1cc0c5);}else{let _0x5eb826=_0x39d4f6;!_0x5eb826[_0x38b909(-0x150,-0xbe,-0x14c,-0x20a)](_0x41d573[_0x38b909(-0x62,-0x32,-0x46,0x40)])&&!_0x5eb826[_0x38b909(-0x88,0x12,-0x2c,-0xc9)](_0x59d76c(0x2ff,0x37a,0x25d,0x2f6))&&(_0x5eb826=_0x5eb826+_0x41d573[_0x38b909(-0x62,0x42,-0x24,-0x19)]);_0x5eb826=_0x5eb826['replace'](/\/v1\/$/,_0x41d573[_0x59d76c(0x3a6,0x362,0x376,0x3f4)]),_0x35804c=_0x41d573[_0x59d76c(0x31c,0x259,0x279,0x39b)],_0x40fb61=_0x41d573[_0x59d76c(0x32d,0x26e,0x2bf,0x2a1)](_0x4bf68e,_0x52a1f9[_0x38b909(-0x75,-0x117,0x37,-0x4)]);const _0x32cc30={};_0x32cc30[_0x38b909(-0x28,-0x1e,-0x21,-0xb3)+_0x59d76c(0x33a,0x3d3,0x34f,0x359)+'ce']=_0x41d573[_0x38b909(-0x4c,-0x84,-0x6d,0x63)],_0x32cc30[_0x38b909(-0x195,-0xeb,-0x10a,-0x1e2)]=_0x5eb826,_0x32cc30[_0x59d76c(0x3b1,0x421,0x46b,0x392)+_0x38b909(-0x160,-0xd4,-0x9e,-0x20f)+'rs']='Authorizat'+_0x59d76c(0x299,0x20a,0x341,0x346)+_0x38b909(-0x188,-0xea,-0x1b5,-0x21d)+_0x4b8589+'\x22',_0x32cc30[_0x38b909(-0x13e,-0x1f7,-0x17d,-0x157)]=_0x23480c,_0x32cc30[_0x59d76c(0x381,0x425,0x387,0x303)]=_0x2ce87a[_0x59d76c(0x381,0x3a7,0x370,0x383)],_0x32cc30[_0x38b909(-0x169,-0x203,-0x1ee,-0x172)]=![],_0x352524=_0x32cc30;if(_0x2296f1[_0x38b909(-0xa5,-0x49,-0xa6,-0x148)](_0x41d573['uaubI'])){_0x41d573[_0x59d76c(0x32d,0x314,0x361,0x2fe)](_0x22906c,_0x38b909(-0x85,-0x6a,-0x23,-0xd0)+_0x38b909(-0xa8,-0xf0,-0x82,-0xc9)+_0x59d76c(0x3da,0x43d,0x336,0x3c5)+_0x59d76c(0x327,0x2d0,0x2c6,0x3a1)),_0x1de30c=_0x2c2eee;const _0xc9ed67={};_0xc9ed67[_0x59d76c(0x3c7,0x45f,0x324,0x373)+'pe']=_0x41d573[_0x38b909(-0xb7,-0x8,-0x67,-0x7b)],_0xc9ed67[_0x59d76c(0x26f,0x230,0x255,0x1ad)+_0x38b909(-0x15b,-0x1d9,-0x1d3,-0x115)]=_0x59d76c(0x38e,0x382,0x2d7,0x42b)+_0x2f986f,_0x106bd7=_0xc9ed67,_0x5e9a2c=_0x356cde;}_0x41d573[_0x59d76c(0x32d,0x2b6,0x3e7,0x3e7)](_0x5aac3e,'[Banana]\x20使'+_0x59d76c(0x341,0x378,0x37e,0x3d3));}}}function handleCancelBananaTask(_0x19219e){const _0x1a5289={'vXhFw':function(_0x1c3701,_0x364251){return _0x1c3701(_0x364251);},'xwRyB':function(_0x54d4a9,_0x4d98c9){return _0x54d4a9===_0x4d98c9;},'NHCNT':_0x3b8c5d(0x199,0x141,0x94,0x104),'uEaum':_0x5d3727(0x59d,0x504,0x530,0x544),'ySUSF':function(_0x185ac8,_0x456093){return _0x185ac8||_0x456093;},'FhYca':function(_0x41298c,_0x37729a){return _0x41298c(_0x37729a);}},{taskId:_0x3648b0}=_0x19219e;function _0x3b8c5d(_0x1216b6,_0x393e95,_0x4acc89,_0x4ebd8b){return _0x5509(_0x393e95- -0x1e4,_0x4ebd8b);}_0x1a5289[_0x3b8c5d(0x1b6,0x13d,0x95,0x1cb)](addLog,'[Banana]\x20收'+_0x3b8c5d(-0x70,0x17,-0x77,0x50)+_0x3b8c5d(-0x1d,0x1d,-0x64,0x4b)+_0x3648b0+')');function _0x5d3727(_0x45b787,_0x1a4f6f,_0x564417,_0x7f8c7c){return _0x5509(_0x564417-0x2d5,_0x45b787);}if(_0x1a5289[_0x3b8c5d(0x119,0x58,0x11b,-0x3a)](currentTaskId,_0x3648b0)&&currentRequestId){const _0x37157f=_0x1a5289[_0x5d3727(0x507,0x5d0,0x513,0x532)][_0x3b8c5d(0x199,0xf3,0x120,0x3c)]('|');let _0x31fb2c=-0x3*-0x98a+-0x1d96+-0x2*-0x7c;while(!![]){switch(_0x37157f[_0x31fb2c++]){case'0':currentRequestId=null;continue;case'1':eventSource[_0x5d3727(0x600,0x5ed,0x569,0x5e2)](EventType[_0x3b8c5d(0x16b,0x16d,0x1a9,0x14f)+_0x5d3727(0x59c,0x4c2,0x54f,0x60a)+_0x5d3727(0x509,0x63e,0x5a2,0x4f6)],{'id':currentRequestId,'success':![],'error':_0x1a5289[_0x3b8c5d(0x140,0x17d,0x1d4,0xc9)],'prompt':_0x1a5289[_0x3b8c5d(0x68,0xbf,0x15f,0x26)](currentPrompt,'')});continue;case'2':currentPrompt=null;continue;case'3':_0x1a5289[_0x3b8c5d(0x129,0x13a,0x173,0x13d)](addLog,'[Banana]\x20取'+_0x3b8c5d(0x1b1,0xf9,0x176,0x7d)+'响应\x20(ID:\x20'+currentRequestId+')');continue;case'4':currentTaskId=null;continue;}break;}}}function initializeBananaListener(){function _0x74f088(_0x32a437,_0x291ad3,_0x3b753d,_0x40ae14){return _0x5509(_0x3b753d-0x157,_0x291ad3);}const _0x5892fa={'cvyxA':_0x74f088(0x39f,0x3ab,0x43e,0x430)+_0x74f088(0x3cf,0x2f4,0x39d,0x3c1)+'ana_task','GQPtA':function(_0x5dc501,_0x74b62a){return _0x5dc501(_0x74b62a);}};eventSource['on'](EventType[_0x74f088(0x3f9,0x50f,0x4a8,0x4e1)+_0x2c7bed(0x53a,0x4d5,0x4f6,0x5f5)+'ST'],bananaGenerate);function _0x2c7bed(_0x230486,_0x12461d,_0x597933,_0x57345c){return _0x5509(_0x230486-0x1de,_0x12461d);}eventSource['on'](_0x5892fa[_0x74f088(0x2f9,0x3ad,0x362,0x33c)],handleCancelBananaTask),_0x5892fa['GQPtA'](addLog,_0x74f088(0x3a7,0x492,0x46a,0x430)+'件监听器已初始化。');}export async function replaceWithBanana(){function _0x23c8f6(_0x3def79,_0x3e8095,_0x13ed99,_0x4897a6){return _0x5509(_0x13ed99-0x9b,_0x4897a6);}function _0x25f203(_0x38d7ab,_0x1f2c5a,_0xf1b912,_0x3e3dee){return _0x5509(_0x1f2c5a-0x1b0,_0x38d7ab);}const _0x31cad1={'mXaIB':_0x23c8f6(0x387,0x265,0x301,0x302),'Dxkii':function(_0x1dfcee,_0x2a9c3e){return _0x1dfcee==_0x2a9c3e;},'dPBoi':function(_0x33fdad,_0x2863ab){return _0x33fdad!==_0x2863ab;},'UWtTk':_0x23c8f6(0x388,0x355,0x387,0x438),'QxAIs':_0x23c8f6(0x2df,0x26c,0x2af,0x316),'nmaZS':function(_0x2b216c){return _0x2b216c();},'czfXG':function(_0x1f699e){return _0x1f699e();},'eLVSJ':function(_0x1cfacf,_0x5f16f6){return _0x1cfacf===_0x5f16f6;},'RKUKo':_0x25f203(0x3dc,0x3f8,0x49c,0x38b),'gYcMV':_0x23c8f6(0x3d5,0x410,0x391,0x42a),'IRiec':_0x25f203(0x54c,0x4c5,0x4fa,0x46b),'eIlIK':_0x25f203(0x448,0x497,0x51e,0x537)+_0x25f203(0x3e2,0x3f6,0x40e,0x382)+'ana_task'};if(_0x31cad1[_0x23c8f6(0x36a,0x307,0x2f1,0x302)](extension_settings[extensionName][_0x25f203(0x427,0x46e,0x530,0x407)],_0x25f203(0x507,0x468,0x3d8,0x49a))){if(!window[_0x23c8f6(0x2fe,0x346,0x388,0x2c8)+_0x25f203(0x4e4,0x4e1,0x54e,0x552)+_0x25f203(0x43c,0x466,0x415,0x4b8)]){if(_0x31cad1[_0x25f203(0x4f2,0x4ff,0x55a,0x5bc)](_0x31cad1[_0x23c8f6(0x47a,0x350,0x3e6,0x3dd)],_0x31cad1[_0x25f203(0x528,0x4e3,0x4cd,0x523)]))window['initialize'+_0x25f203(0x430,0x4e1,0x577,0x520)+_0x23c8f6(0x2bd,0x408,0x351,0x3e7)]=!![],_0x31cad1['nmaZS'](initializeBananaListener);else{const _0x11d3b8=_0x51c00f?function(){function _0x4e7b80(_0x79e3ad,_0x4b4860,_0x3cd9dd,_0x2674d5){return _0x25f203(_0x2674d5,_0x79e3ad- -0x445,_0x3cd9dd-0x129,_0x2674d5-0x5c);}if(_0x573470){const _0x53c379=_0xf52137[_0x4e7b80(0x22,0x6d,0xde,0x56)](_0x53ed82,arguments);return _0x80dca6=null,_0x53c379;}}:function(){};return _0x11b141=![],_0x11d3b8;}}_0x31cad1[_0x25f203(0x4b3,0x49e,0x500,0x533)](initializeImageProcessing);}else{if(_0x31cad1['eLVSJ'](_0x31cad1[_0x23c8f6(0x2e2,0x335,0x39c,0x2db)],_0x31cad1[_0x23c8f6(0x3ad,0x385,0x3d9,0x359)])){const _0x3450dd={};_0x3450dd[_0x23c8f6(0x1fd,0x2e0,0x286,0x270)]=_0x31cad1[_0x23c8f6(0x346,0x2ba,0x32c,0x2e9)],_0x3450dd['content']=_0x2e4372,_0x3ac696[_0x23c8f6(0x2c5,0x2ea,0x2ea,0x395)](_0x3450dd);}else{if(window[_0x25f203(0x4ed,0x49d,0x3fc,0x4c8)+_0x23c8f6(0x395,0x359,0x3cc,0x465)+'ener']){const _0x31824f=_0x31cad1[_0x23c8f6(0x331,0x339,0x282,0x285)][_0x25f203(0x528,0x487,0x506,0x478)]('|');let _0x5d7e11=0x379+0x2532+-0x28ab;while(!![]){switch(_0x31824f[_0x5d7e11++]){case'0':window[_0x23c8f6(0x3dc,0x408,0x388,0x371)+_0x23c8f6(0x3bc,0x3b0,0x3cc,0x376)+_0x25f203(0x457,0x466,0x43b,0x437)]=![];continue;case'1':addLog('[Banana]\x20生'+_0x25f203(0x3c7,0x3d5,0x46c,0x441));continue;case'2':eventSource[_0x23c8f6(0x476,0x3ca,0x3d5,0x3d4)+_0x25f203(0x476,0x466,0x3df,0x4fb)](EventType[_0x25f203(0x5c2,0x501,0x457,0x5bb)+_0x23c8f6(0x426,0x344,0x3f7,0x337)+'ST'],bananaGenerate);continue;case'3':LEGACY_EVENT_NAMES[_0x23c8f6(0x362,0x34c,0x3f2,0x44a)](_0x36bd60=>{function _0xabf9aa(_0x3e13ab,_0x2dc880,_0x507e2c,_0x162265){return _0x23c8f6(_0x3e13ab-0xb4,_0x2dc880-0xe1,_0x3e13ab- -0x296,_0x2dc880);}eventSource[_0xabf9aa(0x13f,0xd6,0x106,0x1b6)+'ener'](_0x36bd60,bananaGenerate);});continue;case'4':eventSource[_0x23c8f6(0x3ec,0x3bf,0x3d5,0x435)+_0x23c8f6(0x2ad,0x2a9,0x351,0x2ff)](_0x31cad1[_0x23c8f6(0x34a,0x354,0x2c4,0x270)],handleCancelBananaTask);continue;}break;}}}}}