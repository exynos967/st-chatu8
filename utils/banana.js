(function(_0xc1f563,_0x166c3f){function _0xfb45d2(_0xe2c758,_0x3a6fd1,_0x4838c1,_0x8a5e23){return _0x38b6(_0x4838c1-0x2ef,_0x8a5e23);}const _0x282fe6=_0xc1f563();function _0x44470f(_0x3747d6,_0x3d80ba,_0x55e7d8,_0x1db29b){return _0x38b6(_0x3747d6- -0x2b5,_0x55e7d8);}while(!![]){try{const _0x277c04=parseInt(_0x44470f(-0x4,0xb5,0x9a,-0x65))/(0x1748+-0x2223+-0x22c*-0x5)+parseInt(_0xfb45d2(0x4f9,0x560,0x545,0x5d8))/(-0x1*0x26d1+0x3c*-0x7a+0x436b)+-parseInt(_0x44470f(0x9b,0xc4,0x55,0x9))/(-0x1*0x247b+0x21be+0x2c0)+-parseInt(_0x44470f(-0x74,0xf,-0x59,-0x124))/(-0x3*-0x6f7+-0x1c7*-0x15+-0x3a34)+-parseInt(_0xfb45d2(0x56c,0x577,0x568,0x501))/(-0xfc1+-0x1b02+0x2ac8)+parseInt(_0x44470f(-0x34,-0xb3,0x66,0x83))/(0x23b*-0x1+-0x2*0xe3+0x407)+parseInt(_0x44470f(0x7b,0xab,0x141,0x12f))/(-0x19a4+0x1bed*-0x1+0x3598)*(parseInt(_0xfb45d2(0x551,0x59d,0x57f,0x64b))/(-0xc9*0xc+-0xc9e+0x1612));if(_0x277c04===_0x166c3f)break;else _0x282fe6['push'](_0x282fe6['shift']());}catch(_0xf04aac){_0x282fe6['push'](_0x282fe6['shift']());}}}(_0x2112,0xe29*-0x97+-0x386e1*0x1+0x148de3));const _0x201eab=(function(){let _0x4726ae=!![];return function(_0x51ad20,_0x224ad3){const _0x5c4fa9=_0x4726ae?function(){function _0xae35d1(_0x165a1d,_0x169df9,_0x430e13,_0x4eade6){return _0x38b6(_0x169df9- -0x252,_0x165a1d);}if(_0x224ad3){const _0x3d00ef=_0x224ad3[_0xae35d1(0x30,0x67,0x99,0xca)](_0x51ad20,arguments);return _0x224ad3=null,_0x3d00ef;}}:function(){};return _0x4726ae=![],_0x5c4fa9;};}()),_0x3f0b1e=_0x201eab(this,function(){const _0x28db93={};function _0xe25826(_0x39eb97,_0x8c015f,_0x430a3b,_0x1ef909){return _0x38b6(_0x8c015f- -0x12a,_0x1ef909);}_0x28db93[_0xe25826(0x1ca,0x22f,0x221,0x1d6)]=_0x466f6d(0x3e1,0x494,0x400,0x404)+'+$';const _0x2ecf6e=_0x28db93;function _0x466f6d(_0x22019e,_0x6b98b7,_0xabd698,_0x544f49){return _0x38b6(_0x22019e-0x148,_0x544f49);}return _0x3f0b1e[_0x466f6d(0x432,0x3ac,0x431,0x441)]()[_0x466f6d(0x372,0x308,0x2c5,0x344)](_0x2ecf6e['UIVgy'])[_0x466f6d(0x432,0x408,0x3f2,0x4ba)]()[_0x466f6d(0x4af,0x4d4,0x436,0x4a0)+'r'](_0x3f0b1e)['search'](_0x2ecf6e[_0xe25826(0x2a7,0x22f,0x26b,0x213)]);});_0x3f0b1e();import{extension_settings}from'../../../../extensions.js';import{eventSource}from'../../../../../script.js';import{extensionName,EventType}from'./config.js';import{sleep,generateRandomSeed,zhengmian,fumian,getRequestHeaders,prompt_replace,addLog,clearLog,parsePromptStringWithCoordinates,prompt_replace_for_character,stripChineseAnnotations}from'./utils.js';import{initializeImageProcessing}from'./iframe.js';import{processCharacterPrompt}from'./characterprompt.js';import{setItemImg}from'./database.js';import{getConfigImage}from'./configDatabase.js';import{taskQueue,TaskType,TaskStatus}from'./taskQueue.js';function _0x38b6(_0x336a35,_0x87b416){_0x336a35=_0x336a35-(-0x2296+-0x5*-0x2f9+0x1579);const _0x418a4d=_0x2112();let _0x64c4a2=_0x418a4d[_0x336a35];if(_0x38b6['yRraIj']===undefined){var _0x2183e9=function(_0x335113){const _0xb4eef7='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x2ba751='',_0x494a16='',_0x55255a=_0x2ba751+_0x2183e9;for(let _0x25d5fa=0x3*0x277+0x213*0x12+-0x2cbb,_0x48586b,_0x3bd428,_0x50c3f1=-0x395*0x5+-0xc49*0x2+-0x91*-0x4b;_0x3bd428=_0x335113['charAt'](_0x50c3f1++);~_0x3bd428&&(_0x48586b=_0x25d5fa%(0x1538+-0x1*-0x15c4+-0x2af8)?_0x48586b*(-0xb02+0xe9*-0x29+-0x33d*-0xf)+_0x3bd428:_0x3bd428,_0x25d5fa++%(0x786+0x3*0xa02+-0x4b1*0x8))?_0x2ba751+=_0x55255a['charCodeAt'](_0x50c3f1+(-0x1*-0x1bd9+-0x273*-0x1+-0x1e42))-(-0x1*0x587+0x1*-0xf0d+0x149e)!==0x1*-0x155a+0x1763*0x1+0x1*-0x209?String['fromCharCode'](0xa7*0x19+0x3ce*0x2+-0x1*0x16ec&_0x48586b>>(-(-0xe2c*-0x1+0xe54+-0x1c7e)*_0x25d5fa&-0x1*0x24dd+-0x1af3*0x1+0x1*0x3fd6)):_0x25d5fa:-0x868+-0xbb*0xb+0x17*0xb7){_0x3bd428=_0xb4eef7['indexOf'](_0x3bd428);}for(let _0x132ac6=0x1a64+-0xed*0x18+-0x42c,_0x313093=_0x2ba751['length'];_0x132ac6<_0x313093;_0x132ac6++){_0x494a16+='%'+('00'+_0x2ba751['charCodeAt'](_0x132ac6)['toString'](0x11f4*-0x2+0x120d+0x11eb))['slice'](-(0x341*0x3+0x236+0xbf7*-0x1));}return decodeURIComponent(_0x494a16);};_0x38b6['IiyAAC']=_0x2183e9,_0x38b6['XlVBcm']={},_0x38b6['yRraIj']=!![];}const _0x2b5e24=_0x418a4d[0xad0+0xa3e+-0x150e],_0x5c7b37=_0x336a35+_0x2b5e24,_0x49c444=_0x38b6['XlVBcm'][_0x5c7b37];if(!_0x49c444){const _0x1462df=function(_0x2eb6d5){this['dZLnEI']=_0x2eb6d5,this['grqRQL']=[-0xfef+-0x2ad+0x1*0x129d,-0x20a1+0x1062+0x1*0x103f,-0x1607*0x1+-0xb4e+0x35*0xa1],this['geNudr']=function(){return'newState';},this['ONKMUr']='\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*',this['EZaZZQ']='[\x27|\x22].+[\x27|\x22];?\x20*}';};_0x1462df['prototype']['eBjoNn']=function(){const _0x110216=new RegExp(this['ONKMUr']+this['EZaZZQ']),_0x111963=_0x110216['test'](this['geNudr']['toString']())?--this['grqRQL'][-0x1fd2+0xe37+-0x467*-0x4]:--this['grqRQL'][0x2*0x1319+0x17fc+-0x3e2e];return this['UALynm'](_0x111963);},_0x1462df['prototype']['UALynm']=function(_0x46e4c8){if(!Boolean(~_0x46e4c8))return _0x46e4c8;return this['yPniXM'](this['dZLnEI']);},_0x1462df['prototype']['yPniXM']=function(_0x26bbff){for(let _0x5a753a=-0xd8e+0x765+0x629,_0x4e64f2=this['grqRQL']['length'];_0x5a753a<_0x4e64f2;_0x5a753a++){this['grqRQL']['push'](Math['round'](Math['random']())),_0x4e64f2=this['grqRQL']['length'];}return _0x26bbff(this['grqRQL'][-0x14ae*-0x1+0x1f00+-0x33ae]);},new _0x1462df(_0x38b6)['eBjoNn'](),_0x64c4a2=_0x38b6['IiyAAC'](_0x64c4a2),_0x38b6['XlVBcm'][_0x5c7b37]=_0x64c4a2;}else _0x64c4a2=_0x49c444;return _0x64c4a2;}let currentTaskId=null,currentRequestId=null,currentPrompt=null;async function getImageFromTurnData(_0x167b0e){function _0x38c29d(_0x3905bb,_0x33f780,_0x3b52a1,_0x329453){return _0x38b6(_0x33f780-0x22c,_0x3b52a1);}function _0x3d60db(_0x3f4e54,_0x3b25e4,_0x286540,_0xcfb2c5){return _0x38b6(_0x3f4e54-0x3e4,_0x3b25e4);}const _0x20ae09={'HuGwB':function(_0x2a10b8,_0x4dcb86){return _0x2a10b8+_0x4dcb86;},'pzWpc':'cfgimg_','LifhM':function(_0x4b8e0c,_0x6bfa90){return _0x4b8e0c===_0x6bfa90;},'VGEpQ':_0x38c29d(0x546,0x576,0x5c6,0x550),'CPpNY':function(_0x5d1a25,_0x4fb940){return _0x5d1a25(_0x4fb940);},'GMplo':function(_0x324fab,_0x4a704e){return _0x324fab||_0x4a704e;},'DYaSm':_0x3d60db(0x6d4,0x727,0x700,0x64b)};if(!_0x167b0e)return'';if(_0x167b0e[_0x3d60db(0x6ab,0x666,0x6ff,0x622)]&&_0x167b0e[_0x38c29d(0x5a2,0x4f3,0x4cc,0x44f)][_0x38c29d(0x5ac,0x57b,0x5ee,0x611)](_0x20ae09['pzWpc'])){if(_0x20ae09['LifhM'](_0x3d60db(0x5b9,0x587,0x5db,0x5a7),_0x20ae09[_0x3d60db(0x70b,0x6e4,0x64a,0x66c)]))_0x45b8b8['Character\x20'+_0x5edd46+_0x3d60db(0x662,0x68c,0x5e5,0x72d)]&&(_0x326369=_0x20ae09['HuGwB'](_0x20ae09[_0x38c29d(0x4b1,0x4a2,0x44b,0x47a)](_0x592147,',\x20'),_0x5ab77a[_0x3d60db(0x682,0x677,0x625,0x5d9)+_0x1bb914+_0x38c29d(0x4d2,0x4aa,0x534,0x566)]));else{const _0x2cce4a=await _0x20ae09['CPpNY'](getConfigImage,_0x167b0e[_0x38c29d(0x5aa,0x4f3,0x5b5,0x52c)]);return _0x20ae09[_0x3d60db(0x669,0x5a9,0x6c1,0x6f9)](_0x2cce4a,'');}}if(_0x167b0e[_0x38c29d(0x3ef,0x428,0x36b,0x3c9)]&&_0x167b0e[_0x38c29d(0x37d,0x428,0x3c4,0x3e8)][_0x3d60db(0x733,0x743,0x7c4,0x7ce)](_0x20ae09['DYaSm']))return _0x167b0e[_0x38c29d(0x3b3,0x428,0x369,0x4d9)];return'';}function _0x2112(){const _0x14ebb3=['Dg9Rzw4','zxrPB25FC291CG','zwXpsvO','ChvZAa','55sO6yws6AAg5lUJ55cg5QIH5BYp','Aw5PDgLHBgL6zq','thbcCei','Aw1Hz2vjza','D3bpqMS','uNbMrhm','CuT0AMm','zxnWB25ZzsbJBW','D0HcB3y','mNWXFdr8mhWZ','w0jHBMfUyv0GrG','zeXxzw4','C3rFy2HHDhu4xW','A2LsvuW','sKrbD2C','AwHbwvu','yxnRsuq6ia','qxblyLy','CMvZDwX0','y3vZDg9T','r1DvBve','z2jIC0q','r2Dyq2u','BwL0DgvKigzHAq','thnWEfG','AxL1Bfm','vhHlEe4','Aw9UoIaIqMvHCG','w0jHBMfUyv0G5l+U','5zU+5lQl5lU255Ur5zcS5zMO5BEY5ywZ6zET44cc','wefODM4','wMzfrLa','qMH1Eu4','ieLeia','CMvTB3zLtgLZDa','DefhsMu','C3bSAxq','ver4q04','Dg9tDhjPBMC','5yIW5y+w5RAi5lU75yQH5lQl5lU2icHu','ywDLifvstdOG','y2HHBMDL','AK1mAMy','BgvZktOG','zgf0ytPPBwfNzq','5zU+5Rwb56Il44cc5A6I5OI356UV5lI6','q1j4Cu8','mhW0Fdj8m3WX','zuzMB2u','rMfPBgvKihrVia','ztOG','C3LdugC','5zon5BQuicHjrdOG','ze9Xzem','vu9LCLG','thvTwLi','vgTUuvq','AKXPzgi','yxnZAxn0yw50','BhvYzsbYzxnWBW','y2TmzNO','BwvZC2fNzxm','Aw1Hz2vU','yMfUyw5HioEuN+wBVUs6IW','CwnfExC','ufLLCfi','tgTOALm','sfDVAgW','5PIV5zcM5zcV55sO5yIg6kEs6iMY5QIH5BYpia','qvbksfa','AKH5suq','rM1WuNe','zcbIyxnLnJqGAq','BwfNzsbMCM9Tia','ENvwDKy','w0jHBMfUyv0G5Ps2','DuXTzvu','y1bIyLa','5BYa5AEliejHBMfUyEEuNW','yxnqAwC','zfftAum','y29uuMG','qM5ruvy','nJqGAw1Hz2uU','vev3Efe','nhWXFdj8m3WW','y3vKrvC','EsbLEhrYywn0zq','w0jHBMfUyv0G5y+w','qMvHCMvYia','EeLVtKm','y1vxuMy','Aw1Hz2vFDxjS','EwXfyu0','tg1PvhO','y2vZCYbYzxnWBW','zw1PDa','BKfeDKm','qMfUyw5HtgLZDa','vKDfCfe','AfvXBxa','5yIg6kEs6iMY5QIH5BYpoIdOP6pMNPdLUky','yxz1v1i','DvHet3m','vfzHt3C','5Qch5yEg5QIH5BYpoIdKVB/NLkJOR7FMSyi','5Q2J6z2I5O+q56s66k+noIa','vuHdueq','n1flCwzcsa','5yMn572U5yMn','5RAi5B2t5yMn5lU75yQH77Ym5y+r6ycb5AsX6lsL','y2HHDf9JB21WBa','D1PTtuy','yNPkweW','BIbWyxLSB2fKia','BNnLigzVCIbjra','q0X5BKe','t0j2quu','w0jHBMfUyv0GuG','w0jHBMfUyv0G5l2/','yMfUyw5Hq2HHCG','ignVBNrHAw4GAq','BNrHAw5ZihrLEa','D1PABhC','5zco572U5zco','CKfMB3K','r0vorvjbvevFsq','DxbKyxrLu3rHDa','EhjNrwu','q0f0wM8','yxLSB2fKoIa','l3yX','C2LUzYbKAxjLyW','CMTKB3DUigLTyq','vK5JD00','tufhrv9srvnqtW','zxjYB3i','C3vIC3rYAw5N','EK51t24','C3rHCNrZv2L0Aa','mZm4ndqWnu9zqufvwq','DhjPBq','BhvKzv9OzwfKzq','vgfjywe','sxHkA1i','zw5KC1DPDgG','CMvWBgfJzq','tufhrv9srvfvrq','r0XOs1m','vuLwz3K','l3yXyMv0ys9TBW','57Yt5A2y6k6+572U5lI65lIn5A2y5ywL5PwW5O2U','yMfZzty0lG','rhvHsNG','z2uGvvjmlcbLEa','CLfmr1C','vLvVtvi','DwLSDcbTDwX0Aq','vLvYAhu','5yMn572U5zco','sLnYthK','w0jHBMfUyv0GuW','CuPlChu','y29UC3rYDwn0BW','D09vsem','vhfjCgG','CxjpAM4','rLvXA1y','t2nnBKG','w0jHBMfUyv0Gvq','s2vrrMO','AM9PBG','6k+35Rgc5Bc65A+4oIdLRR3LUQyGlq','B25LCNjVCG','CMTKB3DUigvTyG','zwnLAxzLzcbPBq','sKDRquy','Bxb1Ahq','zMffwwS','DhLWzq','wKjtChm','ExbhrwG','55sO5l+U5zU+6Ake6k6+oIaI','DhjHy3rPBMCUlG','C3nMDwXSEs4','vMPAqve','kerPDMLKzv9YBW','CIaI','ywDLigDLBMvYyq','BwfNzsbNzw5LCG','ywXSyMfJAY4','DwfIDxK','igLTywDLlG','DgLVBIbYzxf1zq','z0ffuKe','y3vZDg9Tx3vYBa','Bw9KzwW','Aw5NihrYAwDNzq','lI4U','DgLVBIb3AxrOia','vfzSz0K','DKrbueS','AML1z3vHBG','DcbvuKWGyxmGzG','zw5LCMf0Aw9Uia','yMfUyw5H','yLPnEMK','s1rhzKm','AxfVt3q','B2L5EKC','Au5izMK','5B2t5yMn55sF5zU+5QYH5PwW5lI6igzV','zM9YrwfJAa','Dvn2Ehu','CevJrue','zxrJAcbnyxjRza','zgvSCY8','C3rHDhvZ','sxLpEMy','Cu9eA0S','y2HVAwnLCW','q0TzDMW','ue9tva','zKXYq0S','zuXluKW','vePNBeu','AhvhrKq','lcdPQ5JLUQyGlsa','5OYb6yws6AAg5lUJ55cg77Ym5yIh5O2I5lI655U0','CgfYyw1LDgvYCW','Aw1Hz2u','zhfOthi','qK1wtxq','rfP6Chy','zvDUwe8','Cg9ZDgzPEfbYBW','zezNB2q','A2vwwK8','tLr4zNu','vvjm','CM9Szq','B3iGChjVBxb0oG','Aw5JBhvKzxm','ihWG','D2L0AcbWCM9TCa','uNvkuKm','zw5KAw5NihjLCq','vKXWu1y','w0jHBMfUyv0G55sF','CMvHzefZrgf0yq','tvDoq3q','swngCxq','ywrKvgfZAW','twfYA2rVD24U','5zU+5QIH5BYp77YA5BEY5RE75yQG5B6f5l+U5Ps5','uvjREKy','terSvhC','uM9ODwq','l2fWAs9IywnRzq','D3z0C2W','r3blqvC','vK5Nu3y','55Qe5zU+54Mh','rK1qquW','u1vPtNC','EsbJB252zxj0zq','t0Dzzw8','ugLYvfK','ugfIB0S','Egrowva','rhrbDeW','DwnJzxnZzNvSBa','tu5py0u','y2LZAhu','uhvYwNK','y0DzBuS','C2vHCMnO','zKPJDfu','Bw9KzwW6ia','CwrTswm','B2LZwwi','B21WBgv0Aw9UCW','5lU75yQH5BEY5y+w5RAi','BwfW','v3LfExu','qKjJuKq','yw5Hx3rHC2S','s21mz2W','zw5LCG','tNrny2W','zMLSDgvY','CMvWBgfJzufSBa','y2XPzw50','Bxb0','CKDmtMi','AuL1Cuq','DuTqBei','Dg9mB3DLCKnHCW','rhr2Bge','mtiZotCWngXSAKnQEq','BwfNzw4G5QIH5z6l5lIn5PsV','m3WXFdb8mNW0','z3jcCfq','B2LLvhm','w0jHBMfUyv0Grq','55sO5lQgihVKV67LM759ioAGH+IVHG','Bw9KywWGCgf5Ba','y2fUy2vSx2jHBG','w0jHBMfUyv0Gra','C3rYzwfT','CLrYC2S','l3yXlW','qu5ID00','zML4zwrqCM9TCa','shHTzKy','yxjRzg93BIbPBq','zxrLy3rLzcbnyq','Egr0uwy','qxv0Ag9YAxPHDa','qvbjihjLCxvLCW','mZq5nZe2DejsvKPr','B3nPDgLVBG','r3vttNa','serPsNe','s3nhvxy','C3rYAw5NAwz5','uNfdD2S','B3DUigLTywDLoG','Dgv4Da','s2HlEfK','Aw1Hz2vdB25MAq','zwrKzwqGyMfZzq','B25SB2fKzw5K','se5nD0i','DwLSDcbjBwfNzq','wu9Azgu','CNvUBMLUzW','BwvZC2fNzq','w0jHBMfUyv0Gtq','vfPLzhG','DxnLCG','ywLSzwqGDg8GzG','iIbMCM9TihbYzq','u210teS','uxPXzKu','z0fVv2m','w0jHBMfUyv0Gsq','DwvZDcb0BZOG','uK9vvhi','B3vUzcbTyxrJAa','ALvrrLu','zuzTC3i','shvhD0i','vevSv0i','v01vr2y','ndy2mdK4nuLUtxPnEq','v2zVrge','w0jHBMfUyv0GrW','Dhb0CLO','vgrQExK','ifbYB21WDa','zKPwuu4','u2nLBMuGq29TCa','nJq5mtK4ogPms3Lcvq','l3yXl2nOyxqVyW','s3LsvMG','CIbWCM9TChq6ia','r01WBg8','BwfNzsbPBIbpCa','zxiG','BeLJyvK','C3rYAw5N','sunsBhi','zvbtz28','tNv4Ee8','s3rVrwW','5zU+5QIH5BYp77YA5OYh5lUKid0G','yxbWBgLJyxrPBW','oda4mJyZmLbfyM1oua','y29UDMvYC2f0Aq','DcbVBMX5lcbUBW','veLkvee','wunAu1K','5zU+5yop5BEY5A2y5ywL5PwW5O2U5BQtigy','teHOvLC','Cgvvr00','C3Lguuq','kcGOlISPkYKRkq','5lU255Ur5zcS5zMO5BEY5yID5AEl5yYw44cc','C2uGzgLKig5VDa','5zco572U5yMn','Aw9U','q2HHCMfJDgvYia','wwnszKi','DxjS','Bw9Kzq','y2fJAgu','BMTfCu8','yNvJrfq','tu5UwgW','ChjVBxb0','5l+U5zU+5OYh5lUKoIa','zxrJAcbLCNjVCG','E+s/RUwBVN0','zMfPBgvKigzVCG','yurIwMC','C3qGkeLeoIa','quvZD2G','BgvUz3rO','ig1LC3nHz2vZlG','y29UDgvUDa','nJCXnJa0z2fytu5J','yxnWzwn0uMf0Aq','C3vJy2vZCW','q29UDgvUDc1uEq','EgnnwgW','weHPDgC','rgrOqMy','zNb0wvC','yxbWBhK','zMv0y2GGAw1HzW','AxrOihn0yxr1CW','qvbjihjLC3bVBG','zw5bssbMB3jTyq','tLnf','rKHJtfa'];_0x2112=function(){return _0x14ebb3;};return _0x2112();}async function generateBananaImage({prompt:_0x4c6cca,width:_0x2a0d82,height:_0x48c463,change:_0x14ca9c,retouchPrompt:_0x51920c,retouchImage:_0x1d28e7}){const _0x498f8e={'RqCwk':_0x3c6bb5(0x6c1,0x6ce,0x72d,0x746)+_0x580bda(-0x16c,-0x192,-0xe3,-0xde)+_0x3c6bb5(0x6c5,0x715,0x6c5,0x601)+_0x3c6bb5(0x619,0x5db,0x6d2,0x550)+_0x580bda(-0x158,-0x281,-0x1d8,-0x297),'oisYb':function(_0x4c9cca,_0x15213b){return _0x4c9cca+_0x15213b;},'KmLgl':function(_0x5c293c,_0xd8f032){return _0x5c293c+_0xd8f032;},'jHyID':_0x580bda(-0x16e,-0x250,-0x1a5,-0x235),'vDAPK':function(_0x1d4124,_0x434c4e){return _0x1d4124(_0x434c4e);},'peUGM':function(_0x46f50e,_0x1a5818){return _0x46f50e(_0x1a5818);},'MNnXl':function(_0x5a9b1f,_0x292672){return _0x5a9b1f(_0x292672);},'bfYrF':'1|4|2|3|0','fLrCK':function(_0x4c6a59,_0x1988c8){return _0x4c6a59(_0x1988c8);},'dqhLr':_0x3c6bb5(0x595,0x586,0x4d1,0x562)+_0x580bda(-0x100,-0x116,-0xcd,-0x10c),'TJglE':_0x3c6bb5(0x657,0x623,0x6ba,0x67f)+_0x580bda(-0x15c,-0x188,-0x165,-0xe4)+_0x3c6bb5(0x5bb,0x5bc,0x668,0x53f),'KTGfC':function(_0x58a85f){return _0x58a85f();},'SmtLK':function(_0x1ab5c2,_0x4965c6){return _0x1ab5c2(_0x4965c6);},'TVlgI':_0x3c6bb5(0x6a7,0x65e,0x753,0x6d5),'TEwxQ':function(_0x4ad8da,_0x4ef1e2){return _0x4ad8da(_0x4ef1e2);},'TaIaa':'{修图}','IcFqt':_0x3c6bb5(0x6ce,0x5fc,0x62f,0x70f),'nADvC':function(_0xa11d16,_0x187001){return _0xa11d16(_0x187001);},'cUWRf':function(_0x4e3c78,_0x50a186){return _0x4e3c78===_0x50a186;},'BXDlR':_0x3c6bb5(0x5b7,0x628,0x559,0x572),'BBcRD':'user','PWCva':'xcNas','ZejTA':_0x3c6bb5(0x6a5,0x67c,0x5fa,0x6ba),'ckLfz':function(_0x7dc42f,_0x3d4bd8){return _0x7dc42f+_0x3d4bd8;},'dQSiC':function(_0x3b9aaf,_0x1bc4b8){return _0x3b9aaf(_0x1bc4b8);},'KhKxY':_0x3c6bb5(0x6b0,0x69f,0x6fb,0x701)+'坐标的提示词字符串。','NTxfu':_0x3c6bb5(0x607,0x5c1,0x575,0x6d7)+_0x3c6bb5(0x5de,0x5eb,0x632,0x6ad),'oieTs':function(_0xcc0dc7,_0x438a7f){return _0xcc0dc7<=_0x438a7f;},'WyEyu':function(_0xffcf14,_0x100fde){return _0xffcf14+_0x100fde;},'yVwtn':function(_0x44004b,_0x445ed6){return _0x44004b+_0x445ed6;},'IyOzf':function(_0x155439,_0x1b27cb){return _0x155439(_0x1b27cb);},'fJctU':_0x3c6bb5(0x68a,0x6ab,0x677,0x5d9)+_0x3c6bb5(0x621,0x580,0x686,0x57f),'JSxAK':function(_0x5772c6,_0x441eb7){return _0x5772c6(_0x441eb7);},'ePSgo':'[Banana]\x20D'+_0x580bda(-0x159,-0x127,-0x15c,-0x190)+_0x3c6bb5(0x54b,0x48e,0x526,0x588)+_0x580bda(-0xa9,-0x163,-0x14d,-0x7b)+_0x3c6bb5(0x69e,0x6b8,0x62d,0x6c6),'LmiTz':function(_0x38f6d3,_0x1acd69){return _0x38f6d3(_0x1acd69);},'PYepR':_0x3c6bb5(0x6ec,0x7ac,0x70a,0x6c5)+_0x580bda(-0x22b,-0x1ad,-0x189,-0x1d5)+_0x580bda(0x11,-0x55,-0x93,-0xcb)+_0x580bda(-0x75,0x1,-0xa2,-0xd9)+_0x3c6bb5(0x694,0x72a,0x647,0x74b)+_0x3c6bb5(0x59a,0x653,0x615,0x654),'RuJRC':function(_0x327931){return _0x327931();},'EgomR':function(_0x5719e7,_0x183aea){return _0x5719e7+_0x183aea;},'huGFD':function(_0x14df78,_0x29c2ab){return _0x14df78||_0x29c2ab;},'CLynA':function(_0x7990b5,_0x247093){return _0x7990b5>_0x247093;},'HNMwB':_0x3c6bb5(0x563,0x58f,0x5fe,0x57b),'xdNYP':function(_0x4b6f7a,_0x15fd9d){return _0x4b6f7a(_0x15fd9d);},'VUoMR':function(_0x1babd0,_0x528885){return _0x1babd0(_0x528885);},'PirTY':function(_0x479d41,_0x3fdd1d){return _0x479d41(_0x3fdd1d);},'JDAwg':function(_0x47edaf,_0x19681f){return _0x47edaf(_0x19681f);},'hUqmp':function(_0xc086a4,_0x50efed){return _0xc086a4!==_0x50efed;},'eFmsr':function(_0x3185e1,_0x58e51d){return _0x3185e1(_0x58e51d);},'EDvii':function(_0x380b22,_0x3ccb28){return _0x380b22<=_0x3ccb28;},'OGYeo':_0x3c6bb5(0x5a9,0x5a4,0x4ef,0x53d),'VNgSv':_0x3c6bb5(0x68d,0x5ec,0x763,0x5ee),'asPig':function(_0x55b7e0,_0x3255ef){return _0x55b7e0+_0x3255ef;},'LpBpB':function(_0x4d94bd,_0x5e3a66){return _0x4d94bd(_0x5e3a66);},'syCPg':_0x3c6bb5(0x6b4,0x74f,0x6de,0x748)+'中的\x20prompt。','qKtjc':function(_0x4dfebd,_0x20cc1f,_0x2307cc){return _0x4dfebd(_0x20cc1f,_0x2307cc);},'TDxCN':_0x3c6bb5(0x6f2,0x798,0x69b,0x63f),'xjWTC':function(_0x2a1581,_0x131469){return _0x2a1581<=_0x131469;},'lIcaY':function(_0x406fc6,_0x3853af){return _0x406fc6!==_0x3853af;},'keVZO':_0x3c6bb5(0x6f0,0x6dc,0x71d,0x723),'SrMey':function(_0x5ba237,_0x4d7f94){return _0x5ba237+_0x4d7f94;},'eLKRL':function(_0x4f603b,_0x2a12ad){return _0x4f603b(_0x2a12ad);},'cudEW':'imagen','ZJNAt':_0x580bda(-0xa1,-0x96,-0xcc,0x0),'bucDT':_0x580bda(0xf,-0x98,-0x4b,-0x10c),'mpuht':_0x3c6bb5(0x6c7,0x71a,0x605,0x626),'wHBov':'最后置','YcRfB':function(_0x5d493e,_0xb29417){return _0x5d493e(_0xb29417);},'GWUmQ':_0x3c6bb5(0x609,0x5a9,0x5d0,0x621)+_0x3c6bb5(0x5b6,0x50b,0x649,0x5c5),'iNHfi':function(_0x2eb08c,_0x1da4ca){return _0x2eb08c!==_0x1da4ca;},'FmpRq':_0x580bda(-0x266,-0x175,-0x1ae,-0xd8),'avuWR':'bqCzg','Dtvla':function(_0x2a4e5b,_0x5e9659){return _0x2a4e5b(_0x5e9659);},'ROUTr':'[Banana]\x20启'+_0x3c6bb5(0x5ce,0x524,0x55d,0x550)+'。','eFfoe':function(_0x9427,_0x3385da){return _0x9427(_0x3385da);},'TElWB':_0x3c6bb5(0x683,0x605,0x67d,0x743),'RXtuI':_0x3c6bb5(0x6e6,0x68e,0x654,0x7ab),'KyRVh':_0x3c6bb5(0x6b8,0x6f5,0x5e8,0x639),'GLhKS':'后置前','wZZlw':function(_0x30ba99,_0x175c7b){return _0x30ba99(_0x175c7b);},'CKYvl':_0x3c6bb5(0x5e5,0x62c,0x5f9,0x5b1),'uXDOs':function(_0x680884,_0x3f683d){return _0x680884(_0x3f683d);},'BnQQV':_0x580bda(-0xa3,-0x163,-0x11a,-0x87),'nppaD':_0x3c6bb5(0x59c,0x63b,0x587,0x5fb),'NtMcl':function(_0xc9e9da,_0x2d749a){return _0xc9e9da(_0x2d749a);},'oiyzG':_0x580bda(-0x29,-0x161,-0xb4,-0x175),'HxmfF':function(_0x356895,_0x331e20){return _0x356895>_0x331e20;},'BhuyN':function(_0x1ccce4,_0xd36419){return _0x1ccce4(_0xd36419);},'WOrtn':function(_0x4dd38d,_0x3559ba){return _0x4dd38d!==_0x3559ba;},'UCicP':_0x580bda(-0x1c5,-0xf3,-0x15b,-0x226),'kiRUL':'jITUS','AEswh':_0x3c6bb5(0x685,0x6f0,0x5b4,0x692),'JSrLy':function(_0x3f2c6c,_0x518255){return _0x3f2c6c!==_0x518255;},'qdmIc':_0x3c6bb5(0x660,0x704,0x6fb,0x6e4),'ixpwY':function(_0x1bdc76,_0x280fed){return _0x1bdc76(_0x280fed);},'uLmeU':_0x580bda(-0x1d2,-0x1fe,-0x161,-0x157),'bZMzi':function(_0x182c63,_0x56b79c){return _0x182c63===_0x56b79c;},'XnxfQ':'TIJTA','LspxX':function(_0x3d1f78,_0x205c83){return _0x3d1f78+_0x205c83;},'KsGUv':function(_0x352782,_0x50b88e){return _0x352782===_0x50b88e;},'WfoDa':_0x580bda(-0x291,-0x268,-0x1ce,-0x123),'pJGyZ':_0x3c6bb5(0x684,0x665,0x5b0,0x688),'qkCkc':function(_0x118d4b,_0x539d97){return _0x118d4b+_0x539d97;},'OBvAE':function(_0x24b3b3,_0x4c5fb1){return _0x24b3b3===_0x4c5fb1;},'xcMXl':_0x3c6bb5(0x572,0x60b,0x543,0x60a),'HWohl':_0x3c6bb5(0x616,0x642,0x684,0x6ba)+'n/json','Tdjyy':function(_0x501005,_0x8d96e9){return _0x501005===_0x8d96e9;},'ANbwM':_0x580bda(-0x19a,-0x21b,-0x1af,-0x206),'zuVvF':function(_0x542b20,_0x51b1e2){return _0x542b20(_0x51b1e2);},'LumZR':_0x580bda(-0xf7,-0x114,-0x1ba,-0x20b),'ApKbV':'fOsYL','GgXCe':function(_0xc083dd,_0x290409){return _0xc083dd>_0x290409;},'TVaOw':function(_0x44ea6a,_0x29946b){return _0x44ea6a!==_0x29946b;},'SUiNw':_0x3c6bb5(0x5b0,0x63c,0x4fb,0x666),'zNuOn':_0x580bda(-0x282,-0x287,-0x1ee,-0x269),'wZmMF':_0x3c6bb5(0x62a,0x6c4,0x673,0x672),'bzJXL':function(_0x2df503,_0x136a80){return _0x2df503===_0x136a80;},'JGkAF':_0x3c6bb5(0x610,0x572,0x6be,0x54c),'DdhBf':_0x580bda(-0x25,-0x7c,-0xbe,-0x10d)+'/','FHcLP':function(_0xd8e4c4,_0x7d9d8b){return _0xd8e4c4(_0x7d9d8b);},'xrgEe':function(_0xbca8ca,_0x2b4250){return _0xbca8ca(_0x2b4250);},'gQZze':_0x580bda(-0xb5,-0x122,-0x188,-0x16e),'IxJkR':function(_0x21574d,_0x22d860){return _0x21574d(_0x22d860);},'ihAYU':_0x3c6bb5(0x5d1,0x594,0x62f,0x526)+_0x3c6bb5(0x5d9,0x63d,0x56c,0x556)+_0x3c6bb5(0x6d0,0x718,0x699,0x6fe)+_0x580bda(-0x65,0x20,-0x50,0x50)+_0x3c6bb5(0x554,0x5ea,0x4fe,0x516)+'.','aDbZg':function(_0x113b21,_0x374061){return _0x113b21===_0x374061;},'gAERA':_0x3c6bb5(0x5c5,0x572,0x500,0x66a),'ypGEh':function(_0x3a5fb2,_0x4f8605){return _0x3a5fb2(_0x4f8605);},'GuSNp':function(_0x3f0514,_0x31f02b){return _0x3f0514(_0x31f02b);},'kxqMO':_0x580bda(0x1a,0x7b,-0x41,-0x68)+_0x580bda(-0xa,-0x110,-0x66,-0x129)+_0x3c6bb5(0x568,0x5e7,0x638,0x63c)+_0x3c6bb5(0x55b,0x4db,0x4e6,0x571),'qODkK':_0x580bda(-0x1af,-0x107,-0x162,-0x1a7),'faEYk':_0x3c6bb5(0x5c4,0x5be,0x657,0x69a),'TZedx':_0x580bda(-0x15b,-0x13a,-0xf2,-0x2a)+_0x580bda(-0xae,-0x1be,-0x113,-0x181)+_0x580bda(-0x139,-0x32,-0x71,-0x88)+_0x3c6bb5(0x60d,0x6a8,0x688,0x5ab)+_0x3c6bb5(0x644,0x595,0x599,0x5ff)+'t','coTRh':function(_0x5db353,_0x21cb55){return _0x5db353(_0x21cb55);},'pEcEA':'[Banana]\x20I'+_0x580bda(-0x2a4,-0x203,-0x1db,-0x272)+'ated\x20succe'+_0x580bda(-0x1ca,-0x2b6,-0x1e0,-0x218),'rGLNb':function(_0x338399,_0x422da4){return _0x338399!==_0x422da4;},'Rohud':_0x580bda(-0x26,-0x5,-0xaa,-0x4),'MWNCt':'kTBSu','elOIZ':_0x3c6bb5(0x655,0x5bb,0x6a0,0x711)+_0x580bda(-0xd3,-0x9d,-0x106,-0xd3)+':','rAfoy':function(_0x476b6d,_0x110019){return _0x476b6d!==_0x110019;},'LDlTw':_0x580bda(-0xbd,-0x1e0,-0x18a,-0x11f),'APJHP':'jfdrS'};_0x498f8e[_0x580bda(-0x226,-0x148,-0x1a3,-0x26f)](clearLog);const _0x583895=taskQueue[_0x3c6bb5(0x599,0x54b,0x596,0x65f)]({'name':_0x498f8e['EgomR'](_0x498f8e[_0x580bda(-0x12e,-0x26d,-0x1b6,-0x1f9)](_0x4c6cca,'')[_0x580bda(-0x100,-0xa1,-0x61,0x43)](-0x1124*-0x1+0x1fa1+-0x30c5,0x1c8b+0x2*-0xdec+-0x95),_0x4c6cca&&_0x498f8e[_0x3c6bb5(0x6bf,0x700,0x684,0x5fc)](_0x4c6cca['length'],0x269f+-0x1600+-0x34d*0x5)?_0x498f8e[_0x580bda(-0x107,-0x171,-0x14b,-0xbc)]:''),'type':TaskType['BANANA'],'prompt':_0x4c6cca});currentTaskId=_0x583895,_0x4c6cca=_0x498f8e[_0x580bda(-0x31,-0x40,-0x9a,-0xc8)](processCharacterPrompt,_0x4c6cca),_0x4c6cca=await _0x498f8e[_0x3c6bb5(0x61e,0x6a7,0x622,0x642)](stripChineseAnnotations,_0x4c6cca);let _0x4182e4=_0x14ca9c;_0x14ca9c=_0x498f8e['xdNYP'](processCharacterPrompt,_0x14ca9c),_0x14ca9c=await _0x498f8e[_0x3c6bb5(0x6e7,0x794,0x77f,0x611)](stripChineseAnnotations,_0x14ca9c),_0x498f8e[_0x580bda(-0x186,-0x1d7,-0x18d,-0x155)](addLog,_0x3c6bb5(0x699,0x627,0x606,0x67c)+_0x3c6bb5(0x678,0x5a6,0x5b9,0x6b7)+extension_settings[extensionName]['client']),_0x498f8e[_0x3c6bb5(0x659,0x5ef,0x718,0x683)](addLog,_0x580bda(-0x26a,-0x220,-0x1ec,-0x2b0)+'\x20'+_0x498f8e[_0x580bda(-0x145,-0xf1,-0x1b6,-0x1ea)](_0x2a0d82,'默认')+_0x580bda(-0x222,-0x25b,-0x1b5,-0x188)+_0x498f8e[_0x3c6bb5(0x57f,0x507,0x55c,0x544)](_0x48c463,'默认')),_0x4c6cca=_0x14ca9c&&_0x498f8e[_0x3c6bb5(0x6af,0x769,0x6a3,0x66b)](_0x14ca9c[_0x3c6bb5(0x6d8,0x61f,0x644,0x6c1)](),'')?_0x14ca9c:_0x4c6cca,_0x498f8e[_0x3c6bb5(0x5fc,0x525,0x5b6,0x6a1)](addLog,'用于生成的Tag:\x20'+_0x4c6cca);let _0x5f3c1d=![];_0x4c6cca['includes'](_0x498f8e[_0x3c6bb5(0x58b,0x613,0x649,0x605)])&&(_0x5f3c1d=!![]);_0x498f8e[_0x580bda(-0x72,-0xc5,-0x4e,-0x37)](addLog,_0x3c6bb5(0x68f,0x708,0x61a,0x68a)+_0x580bda(-0x219,-0x1db,-0x1de,-0x184)+_0x580bda(-0x123,-0xfd,-0xbf,0xb)+_0x5f3c1d);let _0x20908c={},_0x138e51='',_0x5c315d='';if(_0x5f3c1d){_0x498f8e[_0x3c6bb5(0x5aa,0x5e0,0x647,0x58d)](addLog,_0x498f8e[_0x580bda(-0x99,-0x16b,-0x14f,-0x1f7)]),_0x20908c=_0x498f8e[_0x580bda(-0x1e9,-0x147,-0x18d,-0x145)](parsePromptStringWithCoordinates,_0x4c6cca),_0x138e51=_0x20908c[_0x498f8e['NTxfu']];for(let _0x247592=0x798+-0x1553+0xdbc;_0x498f8e['EDvii'](_0x247592,0xd63*-0x1+0xc18+0x14f);_0x247592++){_0x498f8e[_0x3c6bb5(0x6af,0x706,0x6af,0x677)](_0x3c6bb5(0x5f5,0x58f,0x550,0x5b2),'UfAbe')?_0x20908c[_0x3c6bb5(0x625,0x60a,0x633,0x6a4)+_0x247592+'\x20Prompt']&&(_0x498f8e['hUqmp'](_0x498f8e[_0x580bda(-0x23d,-0x122,-0x18e,-0x14c)],_0x498f8e[_0x3c6bb5(0x5a2,0x54f,0x5be,0x52b)])?_0x5c315d=_0x498f8e[_0x580bda(-0x42,-0x146,-0x9b,-0x41)](_0x5c315d+',\x20',_0x20908c[_0x3c6bb5(0x625,0x5bb,0x667,0x650)+_0x247592+_0x580bda(-0xc7,-0xaa,-0x130,-0x119)]):_0x27b337(_0x498f8e['RqCwk'])):_0x48586b=_0x498f8e['oisYb'](_0x498f8e['KmLgl'](_0x3bd428,_0x498f8e['jHyID']),_0x498f8e[_0x580bda(-0x1f2,-0x12b,-0x1cf,-0x103)](_0x50c3f1,_0x132ac6[_0x580bda(-0xb0,-0x110,-0x110,-0xd1)+_0x313093+_0x3c6bb5(0x605,0x648,0x5ba,0x5b4)]));}}else _0x498f8e[_0x580bda(-0x1bc,-0x40,-0xe8,-0x1ba)](addLog,_0x498f8e[_0x580bda(-0x11b,-0xa1,-0xb7,-0x105)]),_0x138e51=_0x4c6cca;let {modifiedPrompt:_0x4a25ae,insertions:_0x132167}=await _0x498f8e[_0x3c6bb5(0x651,0x5c7,0x70e,0x5c7)](prompt_replace,_0x138e51,_0x5c315d);if(_0x5f3c1d){if(_0x498f8e['TDxCN']!==_0x498f8e[_0x3c6bb5(0x670,0x73b,0x5fc,0x6f8)])_0x5d73ee[_0x2a74dd]['banana'][_0x580bda(-0xe0,-0x218,-0x187,-0x122)]=-0x2209+0x31d*0x3+-0x1*-0x18b3,_0x498f8e[_0x3c6bb5(0x61e,0x5a6,0x5f0,0x687)](_0x3142a9,'当前生图次数为\x20fo'+'r\x20prompt:\x20'+_0x32b8ca[_0xbb8eea]['banana'][_0x3c6bb5(0x5ae,0x600,0x4e4,0x56d)]);else for(let _0x33186d=-0x1cfb+0x1f94*-0x1+0x13*0x330;_0x498f8e['xjWTC'](_0x33186d,-0x193a+0x1*-0x1feb+0x3929*0x1);_0x33186d++){if(_0x20908c[_0x580bda(-0x12f,-0xe9,-0x110,-0x9b)+_0x33186d+_0x3c6bb5(0x605,0x6ca,0x571,0x584)]){if(_0x498f8e[_0x3c6bb5(0x60f,0x6de,0x6e0,0x57e)](_0x498f8e[_0x3c6bb5(0x58a,0x653,0x50b,0x4df)],_0x498f8e[_0x3c6bb5(0x58a,0x55a,0x5aa,0x55e)])){const _0x5a3abc=_0x580bda(-0x12b,-0x1da,-0x133,-0x14c)+_0x580bda(-0x1dc,-0x1a3,-0x1cc,-0x1df)+_0x3c6bb5(0x631,0x595,0x6a0,0x656)+_0x580bda(0x5,-0x77,-0xc9,-0xd0)+_0x145135+':\x20'+_0x2d630c['message'];_0x498f8e[_0x3c6bb5(0x61e,0x6ea,0x564,0x654)](_0x228373,_0x5a3abc),_0x579290[_0x3c6bb5(0x6d3,0x711,0x6b3,0x75f)](_0x5a3abc);const _0x472dc3={};_0x472dc3['id']=_0xc85cb3,_0x472dc3['success']=![],_0x472dc3['error']=_0x24f8d3[_0x580bda(-0x140,-0x73,-0x147,-0x79)],_0x472dc3[_0x3c6bb5(0x62d,0x660,0x5e5,0x5e9)]=_0x19f30c,_0x308911[_0x3c6bb5(0x6ab,0x6b0,0x6e5,0x763)](_0x13d8af[_0x3c6bb5(0x6c9,0x660,0x6a9,0x643)+_0x3c6bb5(0x6d2,0x68e,0x65b,0x702)+'NSE'],_0x472dc3),_0x498f8e[_0x3c6bb5(0x62c,0x591,0x5b2,0x5df)](_0x35c2fa,'[Banana]\x20E'+_0x580bda(-0x198,-0x186,-0xd3,-0x122)+_0x580bda(-0x40,-0xab,-0xaf,-0x42)+'nse\x20for\x20ID'+':\x20'+_0x3f8220);}else _0x4a25ae=_0x498f8e['SrMey'](_0x498f8e[_0x3c6bb5(0x5b5,0x666,0x58d,0x567)](_0x4a25ae,_0x498f8e[_0x3c6bb5(0x691,0x5c2,0x737,0x702)]),_0x498f8e[_0x580bda(-0x232,-0x15e,-0x1b8,-0x1c0)](prompt_replace_for_character,_0x20908c[_0x580bda(-0xf8,-0x162,-0x110,-0x141)+_0x33186d+_0x580bda(-0x170,-0x163,-0x130,-0x1b5)]));}}}const _0x512601=extension_settings[extensionName][_0x3c6bb5(0x56a,0x4cf,0x538,0x624)],{model:_0x5632d8,apiUrl:_0x25c84a,apiKey:_0x3ebf22,conversationPresets:_0x3c273b,conversationPresetId:_0x26da34,editPresetId:_0x1d8027,aspectRatio:_0x5e42f3}=_0x512601;_0x498f8e['nADvC'](addLog,_0x580bda(0xf,0x71,-0x49,0x27)+'tarting\x20im'+'age\x20genera'+_0x3c6bb5(0x564,0x529,0x585,0x524)+_0x3c6bb5(0x5b3,0x552,0x4f8,0x5ac)+_0x5632d8);let _0xe1900f,_0x483d50;if(_0x5632d8[_0x580bda(-0x62,0x5a,-0x5f,-0x7f)](_0x498f8e[_0x3c6bb5(0x6a1,0x63d,0x652,0x6c1)])){if(_0x498f8e[_0x580bda(-0xd3,0x21,-0x86,0x19)](_0x498f8e['ZJNAt'],'XAhvn')){const _0x200bac=_0x498f8e['bfYrF'][_0x580bda(-0x74,-0xae,-0xc6,-0x166)]('|');let _0x48fe03=-0xe07+-0x2643+-0x1*-0x344a;while(!![]){switch(_0x200bac[_0x48fe03++]){case'0':_0x498f8e[_0x580bda(-0x197,-0x255,-0x1b9,-0x277)](_0x4c0657,_0x498f8e[_0x580bda(-0x10a,-0x16e,-0x1b1,-0x1ca)]);continue;case'1':_0x2006a1[_0x580bda(-0x177,-0xf3,-0xc8,-0x189)+_0x3c6bb5(0x5bd,0x65e,0x677,0x609)](_0x3f83a0['GENERATE_I'+'MAGE_REQUE'+'ST'],_0x2b193e);continue;case'2':_0x103b7a[_0x3c6bb5(0x571,0x5d8,0x618,0x5c5)](_0x4c3b09=>{function _0x1dad24(_0x31ca26,_0x44a04f,_0x49d6e7,_0x24ff86){return _0x580bda(_0x31ca26-0x18a,_0x24ff86,_0x44a04f-0x102,_0x24ff86-0x1ef);}_0x3dc75d['removeList'+_0x1dad24(0x55,-0x76,-0x78,0x28)](_0x4c3b09,_0x12a8fa);});continue;case'3':_0x248974['initialize'+_0x3c6bb5(0x6ad,0x635,0x738,0x749)+'ener']=![];continue;case'4':_0x5aa009['removeList'+'ener'](_0x498f8e[_0x3c6bb5(0x57e,0x58e,0x4f2,0x62e)],_0x4e7515);continue;}break;}}else{_0xe1900f=_0x580bda(-0xc8,-0x9b,-0x54,-0x99)+_0x3c6bb5(0x575,0x5e2,0x59d,0x57c)+_0x5632d8;const _0x2df0d3={};_0x2df0d3['fixedPromp'+'t']='';const _0x5cf2e5=_0x3c273b[_0x26da34]||_0x2df0d3,_0x415272=[_0x5cf2e5[_0x3c6bb5(0x5d6,0x699,0x649,0x60f)+'t'],_0x132167[_0x580bda(-0xa9,0x55,-0x7d,-0x138)],_0x132167[_0x498f8e[_0x3c6bb5(0x62b,0x556,0x6d1,0x570)]],_0x4a25ae,_0x132167[_0x3c6bb5(0x623,0x5fd,0x5af,0x6b7)],_0x132167[_0x498f8e['mpuht']],_0x5cf2e5[_0x580bda(-0x1ca,-0x248,-0x1ad,-0x1cb)+_0x580bda(-0x247,-0x1ea,-0x173,-0x218)],_0x132167[_0x498f8e[_0x580bda(-0x93,-0x16d,-0xe2,-0x9a)]]][_0x580bda(-0x245,-0x1a9,-0x176,-0x1ca)](Boolean)[_0x3c6bb5(0x548,0x5dd,0x4d1,0x5d8)](',\x20');_0x498f8e[_0x3c6bb5(0x626,0x678,0x5df,0x6bd)](addLog,_0x3c6bb5(0x6b5,0x6b8,0x772,0x660)+_0x415272);const _0x145da0={};_0x145da0[_0x580bda(-0x13d,-0x1a6,-0x108,-0x1c8)]=_0x415272;const _0x4ef20c={};_0x4ef20c['sampleCoun'+'t']=0x1,_0x4ef20c[_0x3c6bb5(0x639,0x594,0x697,0x5fa)+'o']=_0x5e42f3;const _0x82ff51={};_0x82ff51['instances']=[_0x145da0],_0x82ff51[_0x3c6bb5(0x582,0x591,0x4da,0x5e2)]=_0x4ef20c,_0x483d50=_0x82ff51,_0x498f8e[_0x580bda(-0xbc,-0x64,-0x117,-0x108)](addLog,'[Banana]\x20B'+_0x3c6bb5(0x5eb,0x640,0x65c,0x583)+_0x580bda(0x28,-0x8e,-0x78,0x2b)+_0x3c6bb5(0x591,0x5c1,0x528,0x51c)+'t:\x20'+_0x415272);}}else{_0xe1900f=_0x498f8e[_0x580bda(-0x79,-0x173,-0xd6,-0xdf)];let _0x536a14;if(_0x14ca9c['includes'](_0x580bda(-0x16a,-0x6b,-0x105,-0x11b))){if(_0x498f8e[_0x3c6bb5(0x56f,0x522,0x5e3,0x594)](_0x498f8e[_0x3c6bb5(0x692,0x6e7,0x66a,0x766)],_0x498f8e[_0x580bda(-0x64,-0x98,-0x84,-0x15b)])){_0x498f8e[_0x3c6bb5(0x5c7,0x66a,0x51a,0x55f)](addLog,_0x498f8e[_0x3c6bb5(0x5f9,0x651,0x68d,0x58d)]);const _0x528788=_0x498f8e[_0x580bda(-0x23e,-0x1cd,-0x1b6,-0x252)](_0x1d8027,'默认'),_0x1aa06f={};_0x1aa06f['conversati'+'on']=[],_0x1aa06f['fixedPromp'+'t']='',_0x536a14=_0x3c273b[_0x528788]||_0x1aa06f,_0x498f8e[_0x3c6bb5(0x67b,0x631,0x662,0x5d7)](addLog,_0x580bda(-0x64,-0x6a,-0x73,0x57)+_0x3c6bb5(0x553,0x4c0,0x5e7,0x56f)+_0x528788+'\x22');}else throw new _0x1e231a(_0x3c6bb5(0x643,0x653,0x6c4,0x5e1)+_0x3c6bb5(0x622,0x65f,0x5c2,0x5d1)+'\x20contain\x20i'+'mage\x20in\x20Op'+'enAI\x20forma'+'t');}else{if(_0x498f8e[_0x3c6bb5(0x56f,0x5f8,0x566,0x61d)](_0x498f8e[_0x3c6bb5(0x5fe,0x665,0x6ba,0x614)],_0x498f8e['RXtuI'])){const _0x3e6f90={};_0x3e6f90[_0x580bda(-0xd4,-0x158,-0x11d,-0x51)+'on']=[],_0x3e6f90['fixedPromp'+'t']='',_0x536a14=_0x3c273b[_0x26da34]||_0x3e6f90;}else!_0x5a7d9d[_0x580bda(-0x6e,-0x128,-0xe9,-0x177)+'BananaList'+'ener']&&(_0x49dc14['initialize'+'BananaList'+_0x580bda(-0x153,-0x1fc,-0x178,-0x166)]=!![],_0x498f8e[_0x580bda(-0x1be,-0x194,-0x1c9,-0x1cb)](_0x60be7f)),_0x498f8e[_0x580bda(-0x25f,-0x1d3,-0x1c9,-0x20a)](_0x4ca8b9);}const _0x488863=[_0x536a14[_0x580bda(-0x10c,-0x15e,-0x15f,-0x118)+'t'],_0x132167[_0x498f8e[_0x580bda(-0x129,-0xbc,-0x12b,-0x1b3)]],_0x132167['前置后'],_0x4a25ae,_0x132167[_0x498f8e[_0x580bda(0x12,-0x9e,-0x56,-0x8d)]],_0x132167[_0x498f8e[_0x3c6bb5(0x54e,0x5ad,0x519,0x577)]],_0x536a14[_0x3c6bb5(0x588,0x535,0x556,0x4c2)+'mpt'],_0x132167[_0x498f8e[_0x3c6bb5(0x653,0x6d9,0x5f1,0x608)]]]['filter'](Boolean)[_0x580bda(-0x20e,-0x26d,-0x1ed,-0x1d3)](',\x20');_0x498f8e[_0x3c6bb5(0x6c6,0x6e3,0x65c,0x6ff)](addLog,_0x580bda(-0xe9,-0x55,-0x80,-0x12e)+_0x488863);const _0x47288d={};_0x47288d[_0x3c6bb5(0x58d,0x57f,0x500,0x504)]='user',_0x47288d[_0x580bda(-0x140,-0x11d,-0xfe,-0x62)]=[];const _0x460fb0={};_0x460fb0['role']=_0x580bda(-0x4f,-0x13d,-0xb0,-0x41),_0x460fb0[_0x580bda(-0x130,-0x1c2,-0xfe,-0xd2)]=[];const _0x96c15c=_0x536a14[_0x580bda(-0xc2,-0x12d,-0x11d,-0x1db)+'on'][_0x3c6bb5(0x5b8,0x684,0x5d7,0x561)](_0x2d5af4=>[_0x47288d,_0x460fb0])['flat']();let _0x217ff5=-0x73*-0xb+0x1a2b+-0x1f1c;for(const _0x338cea of _0x536a14[_0x3c6bb5(0x618,0x6ae,0x6d4,0x67c)+'on']){if(_0x338cea[_0x580bda(-0x1e6,-0x176,-0x144,-0x102)]?.[_0x3c6bb5(0x5e5,0x658,0x57b,0x5bf)])_0x96c15c[_0x217ff5][_0x3c6bb5(0x637,0x5f3,0x5dc,0x57f)][_0x580bda(-0x78,-0x129,-0xeb,-0x9a)]({'type':_0x498f8e['CKYvl'],'text':_0x338cea['user']['text']});const _0x5c08c4=await _0x498f8e['Dtvla'](getImageFromTurnData,_0x338cea['user']);if(_0x5c08c4)_0x96c15c[_0x217ff5][_0x580bda(-0x76,-0x1be,-0xfe,-0x142)]['push']({'type':_0x498f8e[_0x580bda(-0x27e,-0x262,-0x1d0,-0x1e5)],'image_url':{'url':_0x5c08c4}});_0x217ff5++;if(_0x338cea[_0x3c6bb5(0x561,0x568,0x638,0x59b)]?.[_0x580bda(-0x103,-0x149,-0x150,-0x18d)])_0x96c15c[_0x217ff5]['content'][_0x3c6bb5(0x64a,0x5fb,0x6ee,0x5c1)]({'type':'text','text':_0x338cea['model']['text']});const _0x4fdb85=await _0x498f8e[_0x580bda(-0x5d,-0x5,-0x83,-0x4a)](getImageFromTurnData,_0x338cea[_0x580bda(-0x168,-0x20a,-0x1d4,-0x160)]);if(_0x4fdb85)_0x96c15c[_0x217ff5][_0x580bda(-0x59,-0x83,-0xfe,-0x1d0)][_0x3c6bb5(0x64a,0x711,0x586,0x643)]({'type':_0x3c6bb5(0x6a7,0x62a,0x731,0x775),'image_url':{'url':_0x4fdb85}});_0x217ff5++;}if(!_0x14ca9c[_0x580bda(-0x12b,-0xd0,-0x1a6,-0x1df)](_0x498f8e['TaIaa'])){if(_0x580bda(-0x19b,-0x157,-0x13f,-0x206)!=='gAoWc'){_0x498f8e[_0x3c6bb5(0x5f4,0x5da,0x566,0x53d)](_0x130725,'[Banana]\x20I'+_0x580bda(-0x17f,-0xf1,-0x16c,-0x1fe)+_0x580bda(-0x107,-0x1e3,-0x1b4,-0x207)+'接请求'),_0x45586a=_0x403628;const _0x28ea8c={};_0x28ea8c[_0x3c6bb5(0x63b,0x5e3,0x6e8,0x6c9)+'pe']='applicatio'+'n/json',_0x28ea8c[_0x3c6bb5(0x5db,0x609,0x50a,0x68e)+_0x3c6bb5(0x624,0x6ea,0x57b,0x69a)]='Bearer\x20'+_0x5d5dd1,_0x1f7151=_0x28ea8c,_0xebf0c=_0x5150bf;}else{const _0x3b9ef0=extension_settings[extensionName][_0x580bda(-0xd8,-0x12b,-0x72,-0xf0)+'acterPrese'+'ts']||{};for(const _0x43544c in _0x3b9ef0){const _0x51b820=_0x3b9ef0[_0x43544c],_0x74d06d=(_0x51b820['triggers']||'')[_0x3c6bb5(0x66f,0x708,0x732,0x704)]('|')['filter'](_0x3b5e35=>_0x3b5e35[_0x580bda(-0x95,-0x27,-0x5d,-0x6f)]()!=='');for(const _0x1d4690 of _0x74d06d){if(_0x498f8e[_0x3c6bb5(0x69d,0x644,0x71a,0x5e5)]===_0x498f8e['nppaD'])_0x30f9e6(_0x3c6bb5(0x6e2,0x6dd,0x775,0x6e2)+'库');else{if(_0x488863['toLowerCas'+'e']()[_0x580bda(-0x23e,-0x1f1,-0x1a6,-0x14b)](_0x1d4690[_0x580bda(-0x183,-0x12c,-0x16f,-0x1cc)+'e']())){_0x498f8e[_0x580bda(-0x235,-0x224,-0x177,-0x194)](addLog,_0x580bda(-0x64,-0x181,-0xe0,-0x195)+_0x580bda(-0x94,-0x164,-0x13b,-0x1f5)+_0x580bda(-0x20e,-0x29b,-0x1d3,-0x178)+_0x580bda(-0x144,-0x29d,-0x1dd,-0x151)+_0x1d4690+(_0x3c6bb5(0x5f3,0x5ae,0x645,0x689)+'set\x20\x22')+_0x43544c+'\x22.');const _0x53182d=_0x51b820[_0x580bda(-0xa9,-0xb1,-0x11d,-0x13d)+'on'];if(_0x53182d){if(_0x498f8e['oiyzG']!==_0x498f8e[_0x3c6bb5(0x56e,0x4bb,0x507,0x4ca)]){const _0x20ce06={};_0x20ce06['role']=_0x3c6bb5(0x5f1,0x578,0x6a4,0x55a),_0x20ce06[_0x3c6bb5(0x637,0x6f8,0x5ca,0x69e)]=_0x6b7fe9,_0x3e0d4f['push'](_0x20ce06);}else{const _0x2f4ae0=[];if(_0x53182d[_0x3c6bb5(0x5f1,0x685,0x572,0x657)]&&_0x53182d[_0x3c6bb5(0x5f1,0x6b4,0x5a7,0x5d6)][_0x580bda(-0x135,-0x191,-0x150,-0x196)])_0x2f4ae0[_0x3c6bb5(0x64a,0x5ca,0x604,0x59b)]({'type':_0x498f8e[_0x580bda(-0x13a,-0x228,-0x1bb,-0x1ad)],'text':_0x53182d[_0x3c6bb5(0x5f1,0x67b,0x67e,0x648)][_0x580bda(-0x1ef,-0x226,-0x150,-0xd8)]});const _0x293aa1=await getImageFromTurnData(_0x53182d['user']);if(_0x293aa1)_0x2f4ae0[_0x3c6bb5(0x64a,0x5fd,0x695,0x6c6)]({'type':_0x3c6bb5(0x6a7,0x5e1,0x614,0x5e3),'image_url':{'url':_0x293aa1}});if(_0x498f8e[_0x580bda(-0x1b7,-0x14a,-0x15e,-0xee)](_0x2f4ae0[_0x580bda(-0x1b9,-0x150,-0x100,-0x54)],0xc9f*-0x3+0x6b*0x9+-0x2*-0x110d)){if(_0x498f8e[_0x3c6bb5(0x6af,0x687,0x62d,0x76f)](_0x580bda(-0x276,-0x107,-0x1c8,-0x20e),_0x3c6bb5(0x6e9,0x7ba,0x673,0x7b8))){const _0x1ef8e9={};_0x1ef8e9[_0x3c6bb5(0x58d,0x559,0x608,0x4c9)]='user',_0x1ef8e9[_0x3c6bb5(0x637,0x584,0x6ac,0x583)]=_0x2f4ae0,_0x96c15c[_0x580bda(-0x2d,-0x16a,-0xeb,-0x14f)](_0x1ef8e9);}else{const _0x3af372={};_0x3af372[_0x580bda(-0x11e,-0x180,-0x10e,-0x3c)]=_0x3997d5;const _0x2aa8a5={};_0x2aa8a5['type']=_0x498f8e[_0x580bda(-0x25c,-0x1a6,-0x1d0,-0x11d)],_0x2aa8a5[_0x580bda(-0x45,-0x13f,-0x8e,-0x75)]=_0x3af372,_0x525833[_0x580bda(-0x166,-0x15c,-0xeb,-0xb5)](_0x2aa8a5),_0x1b797a('[Banana]\x20修'+_0x3c6bb5(0x59b,0x5f9,0x50d,0x4de)+_0x3c6bb5(0x5a3,0x543,0x4da,0x4d3));}}const _0x24ec9a=[];if(_0x53182d[_0x3c6bb5(0x561,0x4f4,0x4ac,0x5af)]&&_0x53182d['model'][_0x580bda(-0x1e7,-0x132,-0x150,-0xba)])_0x24ec9a[_0x580bda(-0x1a7,-0x142,-0xeb,-0x183)]({'type':_0x498f8e['CKYvl'],'text':_0x53182d[_0x580bda(-0xfe,-0x1bd,-0x1d4,-0x1d9)]['text']});const _0x36ce16=await _0x498f8e[_0x3c6bb5(0x66b,0x5a7,0x6ca,0x5bd)](getImageFromTurnData,_0x53182d[_0x580bda(-0x208,-0x26a,-0x1d4,-0x1e8)]);if(_0x36ce16)_0x24ec9a[_0x580bda(-0x27,-0x186,-0xeb,-0x177)]({'type':_0x580bda(-0x65,-0xb6,-0x8e,-0x58),'image_url':{'url':_0x36ce16}});if(_0x498f8e[_0x3c6bb5(0x5d7,0x69f,0x620,0x552)](_0x24ec9a[_0x3c6bb5(0x635,0x664,0x69b,0x60f)],0x1036*0x2+-0x1*0x9fb+-0x77b*0x3)){if(_0x498f8e['WOrtn'](_0x498f8e['UCicP'],_0x498f8e[_0x3c6bb5(0x658,0x67a,0x581,0x646)])){const _0x445471={};_0x445471[_0x3c6bb5(0x58d,0x504,0x615,0x514)]=_0x498f8e[_0x3c6bb5(0x634,0x5a9,0x6bb,0x591)],_0x445471[_0x3c6bb5(0x637,0x5a7,0x680,0x66b)]=_0x24ec9a,_0x96c15c[_0x580bda(-0x53,-0x64,-0xeb,-0xf4)](_0x445471);}else{const _0x5e7633=new _0x2a55ac();_0x5e7633[_0x580bda(-0x155,-0x1fc,-0x14c,-0x154)]=()=>_0x2c9425(_0x5e7633[_0x580bda(-0x12e,-0x180,-0xd8,-0x11b)]),_0x5e7633['onerror']=_0x4328ee,_0x5e7633['readAsData'+_0x580bda(-0x27b,-0x25f,-0x1a9,-0xe6)](_0x1d3443);}}}}break;}}}}}}if(!_0x14ca9c[_0x580bda(-0x269,-0x1c1,-0x1a6,-0x186)](_0x498f8e[_0x3c6bb5(0x6da,0x6c6,0x738,0x694)])){if(_0x498f8e['JSrLy'](_0x498f8e[_0x580bda(-0x14a,-0xb2,-0x181,-0x1a5)],_0x498f8e[_0x3c6bb5(0x5b4,0x595,0x521,0x654)]))_0x2e7ab1[_0x580bda(-0xf9,-0x110,-0xe9,-0xa2)+_0x3c6bb5(0x6ad,0x623,0x68e,0x772)+'ener']&&(_0x13490d[_0x3c6bb5(0x66d,0x740,0x72d,0x5d7)+_0x3c6bb5(0x5bd,0x680,0x5e1,0x5d5)](_0x500fab[_0x3c6bb5(0x6c9,0x640,0x77b,0x61d)+_0x3c6bb5(0x6de,0x691,0x61e,0x730)+'ST'],_0x5010b5),_0x5ec53b[_0x580bda(-0x10d,-0x15c,-0xc8,-0x66)+_0x580bda(-0x20c,-0x224,-0x178,-0xce)](_0x498f8e[_0x3c6bb5(0x57e,0x620,0x5e0,0x54c)],_0x2eb397),_0x9cb0d8[_0x3c6bb5(0x571,0x4fb,0x4f8,0x5a3)](_0x380413=>{function _0x584927(_0x399d82,_0x1ea891,_0x5d4113,_0x3ef2bd){return _0x3c6bb5(_0x399d82- -0xc6,_0x1ea891-0x9e,_0x5d4113-0x1ee,_0x1ea891);}_0x5c1817['removeList'+_0x584927(0x4f7,0x476,0x594,0x516)](_0x380413,_0x763d71);}),_0x1a54cc['initialize'+_0x580bda(-0x10d,-0x90,-0x88,-0x91)+'ener']=![],_0x498f8e[_0x580bda(-0x125,-0x128,-0x96,-0x148)](_0x34e02f,_0x580bda(-0x178,-0x1b6,-0x1a0,-0x18c)+_0x580bda(-0x119,-0x126,-0xcd,-0xf5)));else{const _0x2d30b0={};_0x2d30b0[_0x580bda(-0x1ef,-0x1ab,-0x1a8,-0x190)]=_0x498f8e['BBcRD'],_0x2d30b0[_0x580bda(-0x97,-0x18a,-0xfe,-0x114)]=[{'type':_0x498f8e['CKYvl'],'text':_0x488863}],_0x96c15c['push'](_0x2d30b0);}}else{const _0x5e4f16=[],_0x3350cb=_0x51920c||_0x488863,_0x310bda=[_0x536a14[_0x3c6bb5(0x5d6,0x667,0x5bb,0x528)+'t'],_0x3350cb,_0x536a14[_0x580bda(-0x1a7,-0x118,-0x1ad,-0x16e)+_0x3c6bb5(0x5c2,0x54f,0x575,0x68c)]][_0x3c6bb5(0x5bf,0x507,0x51b,0x5b9)](Boolean)[_0x580bda(-0x1ac,-0x17d,-0x1ed,-0x131)](',\x20'),_0x2ac58c={};_0x2ac58c[_0x580bda(-0x296,-0x1a3,-0x1e5,-0x241)]=_0x498f8e[_0x580bda(-0x28b,-0x1f0,-0x1bb,-0x1f0)],_0x2ac58c[_0x3c6bb5(0x5e5,0x522,0x69f,0x69b)]=_0x310bda,_0x5e4f16['push'](_0x2ac58c);if(_0x1d28e7){const _0x27b21c={};_0x27b21c['url']=_0x1d28e7;const _0x4cf1f9={};_0x4cf1f9[_0x580bda(-0x139,-0x19d,-0x1e5,-0x296)]=_0x498f8e[_0x3c6bb5(0x565,0x519,0x4bc,0x57f)],_0x4cf1f9[_0x580bda(0x13,-0xfe,-0x8e,-0x12c)]=_0x27b21c,_0x5e4f16[_0x3c6bb5(0x64a,0x612,0x605,0x63b)](_0x4cf1f9),_0x498f8e['ixpwY'](addLog,'[Banana]\x20修'+'图模式：已添加待修改'+_0x3c6bb5(0x5a3,0x5e8,0x5c0,0x546));}const _0x274c1b={};_0x274c1b[_0x580bda(-0x250,-0x269,-0x1a8,-0x137)]=_0x580bda(-0x1f4,-0x89,-0x144,-0x1ea),_0x274c1b[_0x580bda(-0x12a,-0x1bf,-0xfe,-0x184)]=_0x5e4f16,_0x96c15c['push'](_0x274c1b),addLog(_0x3c6bb5(0x667,0x5b9,0x708,0x6ee)+_0x580bda(-0x4e,-0x173,-0x120,-0x143)+_0x310bda);}const _0x33507e={};_0x33507e[_0x580bda(-0xd8,-0x51,-0xfc,-0x119)+'o']=_0x5e42f3;const _0x4e58ef={};_0x4e58ef[_0x3c6bb5(0x5e7,0x563,0x56c,0x539)+'g']=_0x33507e,_0x483d50={'model':_0x5632d8,'messages':_0x96c15c[_0x580bda(-0x10d,-0x1ef,-0x176,-0x231)](_0x4a878a=>_0x4a878a['content']['length']>-0x1*-0x472+-0xaad+0x63b),'config':_0x4e58ef},addLog('[Banana]\x20B'+_0x3c6bb5(0x6e8,0x784,0x749,0x618)+_0x3c6bb5(0x5cf,0x5a9,0x673,0x64e)+'oad\x20with\x20'+_0x483d50[_0x580bda(-0x8,-0x69,-0xad,-0x86)][_0x3c6bb5(0x635,0x564,0x70c,0x63b)]+_0x580bda(-0xb8,-0xbf,-0xff,-0x70));}function _0x580bda(_0x38a5b1,_0x249110,_0x3eab59,_0x4d4ac7){return _0x38b6(_0x3eab59- -0x3ae,_0x249110);}let _0x3bb1d6=_0x25c84a[_0x580bda(0x25,-0x9e,-0x58,0x1)](/\/$/,''),_0x32bde2;function _0x3c6bb5(_0x18e71c,_0x4eb794,_0x493f19,_0x159fab){return _0x38b6(_0x18e71c-0x387,_0x159fab);}_0x3bb1d6[_0x580bda(0x72,-0x9c,-0x59,-0x6b)](_0x498f8e[_0x580bda(-0xf1,-0x124,-0x19d,-0x1d8)])||_0x3bb1d6[_0x580bda(-0x153,-0x11c,-0x1a6,-0x1aa)](_0x498f8e[_0x3c6bb5(0x697,0x5d0,0x6a9,0x67a)])?_0x498f8e[_0x3c6bb5(0x56b,0x60a,0x570,0x4a7)](_0x498f8e['XnxfQ'],_0x580bda(-0x9e,-0x188,-0x11b,-0xcd))?_0x32bde2=_0x498f8e[_0x580bda(-0xe4,-0xc1,-0xd2,-0x71)](_0x3bb1d6,_0xe1900f):_0x565644=!![]:_0x32bde2=_0x3bb1d6+_0x580bda(0xd,-0x2e,-0x67,-0x132)+_0xe1900f;_0x32bde2=_0x32bde2[_0x580bda(-0x16,0x52,-0x58,-0x70)](/\/v1\/v1\//g,_0x3c6bb5(0x5d4,0x5e4,0x641,0x5e5));const _0x571986=extension_settings[extensionName][_0x580bda(-0x11d,-0x1b1,-0x174,-0x15f)];let _0xdc4f08,_0x216b79,_0x26b644;if(_0x498f8e[_0x3c6bb5(0x5e1,0x5fc,0x615,0x5ca)](_0x571986,_0x498f8e[_0x3c6bb5(0x601,0x6c2,0x5d1,0x616)])){if(_0x580bda(-0xc4,-0x84,-0xd0,-0x1b)===_0x498f8e['pJGyZ'])throw new _0x11e6ff(_0x580bda(-0xce,-0xed,-0xb9,-0x190)+_0x3c6bb5(0x641,0x663,0x705,0x690)+_0x3c6bb5(0x67d,0x633,0x64d,0x652)+_0xa0795[_0x580bda(-0x222,-0x259,-0x1bf,-0x206)]);else{let _0x3f55af=_0x3bb1d6;!_0x3f55af['endsWith'](_0x498f8e[_0x3c6bb5(0x598,0x4c5,0x624,0x4de)])&&!_0x3f55af[_0x580bda(-0x107,-0x226,-0x1a6,-0x11f)](_0x3c6bb5(0x5d4,0x61e,0x55c,0x643))&&(_0x3f55af=_0x498f8e['qkCkc'](_0x3f55af,_0x498f8e[_0x580bda(-0x22b,-0x116,-0x19d,-0x18f)]));_0x3f55af=_0x3f55af[_0x3c6bb5(0x6dd,0x62e,0x608,0x76e)](/\/v1\/$/,_0x498f8e['IcFqt']),_0xdc4f08=_0x3c6bb5(0x59f,0x57a,0x5a1,0x63c)+'nds/chat-c'+_0x580bda(-0x10a,-0x132,-0x17f,-0x1e0)+'/generate',_0x216b79=_0x498f8e['MNnXl'](getRequestHeaders,window[_0x3c6bb5(0x647,0x715,0x652,0x6a1)]);const _0x3173d3={};_0x3173d3[_0x580bda(0x38,-0x118,-0x7b,-0xda)+_0x3c6bb5(0x648,0x679,0x6eb,0x5dc)+'ce']=_0x580bda(-0x103,-0x166,-0xd7,-0x51),_0x3173d3[_0x3c6bb5(0x560,0x4f5,0x4c1,0x60c)]=_0x3f55af,_0x3173d3['custom_inc'+_0x3c6bb5(0x6d9,0x67d,0x694,0x6c6)+'rs']=_0x3c6bb5(0x5db,0x676,0x63b,0x57a)+_0x580bda(-0xfe,-0xda,-0xcf,-0x184)+_0x3c6bb5(0x60e,0x61a,0x6a4,0x5b0)+_0x3ebf22+'\x22',_0x3173d3[_0x3c6bb5(0x561,0x5e6,0x5bf,0x51e)]=_0x5632d8,_0x3173d3[_0x580bda(-0x14,-0x89,-0xad,-0x102)]=_0x483d50[_0x580bda(-0x135,-0xb6,-0xad,-0x10f)],_0x3173d3[_0x580bda(-0x135,-0x11d,-0x163,-0x16f)]=![],_0x26b644=_0x3173d3;if(_0x5632d8[_0x3c6bb5(0x6d6,0x625,0x732,0x720)](_0x3c6bb5(0x689,0x6f7,0x6f0,0x6aa))){if(_0x498f8e[_0x580bda(-0x12e,-0x6a,-0x75,0x58)](_0x498f8e[_0x3c6bb5(0x63c,0x60a,0x70c,0x6d3)],'uSvxu')){_0x498f8e['fLrCK'](addLog,_0x580bda(-0x179,-0x76,-0x13e,-0x10d)+_0x580bda(-0xd9,-0xac,-0x16c,-0x14d)+_0x3c6bb5(0x581,0x5ee,0x4c5,0x4f5)+'接请求'),_0xdc4f08=_0x32bde2;const _0x254add={};_0x254add['Content-Ty'+'pe']=_0x498f8e[_0x3c6bb5(0x68e,0x662,0x652,0x749)],_0x254add[_0x580bda(-0xab,-0x1fa,-0x15a,-0x146)+_0x580bda(-0x13b,-0xac,-0x111,-0x10f)]=_0x3c6bb5(0x6a4,0x73d,0x72a,0x64f)+_0x3ebf22,_0x216b79=_0x254add,_0x26b644=_0x483d50;}else{const _0xb5720c={};_0xb5720c['conversati'+'on']=[],_0xb5720c[_0x3c6bb5(0x5d6,0x5f5,0x5d9,0x68c)+'t']='',_0x5afb2e=_0x2c5c48[_0x5ca692]||_0xb5720c;}}_0x498f8e[_0x580bda(-0xf6,-0x1fc,-0x16e,-0xc0)](addLog,'[Banana]\x20使'+_0x3c6bb5(0x64b,0x66a,0x687,0x636));}}else{if(_0x498f8e[_0x580bda(-0x1c0,-0x188,-0x131,-0xab)](_0x580bda(-0x10d,-0x147,-0x7f,-0x6a),_0x498f8e[_0x3c6bb5(0x5d5,0x5ac,0x578,0x55e)]))return _0x30d94e[_0x580bda(-0x177,-0x24e,-0x1b2,-0x27f)];else{_0xdc4f08=_0x32bde2;const _0x31da64={};_0x31da64[_0x580bda(-0xc7,-0x126,-0xfa,-0x44)+'pe']=_0x580bda(-0x19d,-0x97,-0x11f,-0x6e)+'n/json',_0x31da64[_0x580bda(-0x1df,-0x218,-0x15a,-0xa0)+_0x580bda(-0x132,-0x114,-0x111,-0x10a)]='Bearer\x20'+_0x3ebf22,_0x216b79=_0x31da64,_0x26b644=_0x483d50,_0x498f8e['dQSiC'](addLog,_0x580bda(-0x11b,-0x14a,-0x73,-0xcd)+'用直接请求模式');}}_0x498f8e['NtMcl'](addLog,_0x580bda(-0x3f,-0xc2,-0x49,0x45)+_0x3c6bb5(0x593,0x63c,0x4f9,0x57d)+_0x580bda(-0x1d7,-0x20c,-0x13d,-0xd6)+_0xdc4f08),_0x498f8e[_0x3c6bb5(0x695,0x768,0x71e,0x672)](addLog,'[Banana]\x20P'+_0x3c6bb5(0x6cd,0x610,0x741,0x61b)+JSON[_0x580bda(-0x100,-0xf9,-0x153,-0x201)](_0x26b644,null,-0x1c32+-0x1*-0xd3d+0xef7));try{taskQueue[_0x3c6bb5(0x6ca,0x775,0x64a,0x6c8)+'us'](_0x583895,_0x580bda(-0x1b2,-0xc4,-0x148,-0x97));const _0x33e9c6=await fetch(_0xdc4f08,{'method':_0x498f8e[_0x3c6bb5(0x682,0x758,0x74c,0x661)],'headers':_0x216b79,'body':JSON['stringify'](_0x26b644)});if(!_0x33e9c6['ok']){if(_0x498f8e[_0x580bda(-0x106,-0x1ca,-0x154,-0xe5)](_0x3c6bb5(0x664,0x670,0x713,0x5ac),_0x498f8e[_0x3c6bb5(0x65c,0x726,0x728,0x728)]))_0x481a72=_0x3f1775[_0x3c6bb5(0x5c0,0x593,0x52a,0x580)](_0x498f8e[_0x580bda(-0x9b,-0x8b,-0x5b,0x23)],'');else{const _0x44b264=await _0x33e9c6[_0x580bda(-0x1aa,-0x12b,-0x150,-0x9a)]();throw new Error(_0x3c6bb5(0x5dc,0x543,0x672,0x5f8)+'t\x20failed\x20w'+_0x580bda(-0x6a,-0x5c,-0xf3,-0x55)+'\x20'+_0x33e9c6['status']+':\x20'+_0x44b264);}}const _0x40fda1=await _0x33e9c6['json']();let _0x4b4042='';const _0x24fb8e=_0x40fda1[_0x580bda(-0x23c,-0x195,-0x1bc,-0x26e)];if(_0x24fb8e&&_0x498f8e[_0x3c6bb5(0x661,0x693,0x6d0,0x612)](_0x24fb8e[_0x580bda(-0x158,-0xe8,-0x100,-0x16d)],-0x12d1*0x1+0x20*0xd7+0x80f*-0x1)){const _0x401ff3=_0x24fb8e[0x3d*-0x30+-0x1677+-0x21e7*-0x1]['message']?.[_0x3c6bb5(0x637,0x606,0x566,0x652)];if(Array['isArray'](_0x401ff3))for(const _0x5182df of _0x401ff3){if(_0x498f8e[_0x3c6bb5(0x6b3,0x6e8,0x6e4,0x6f9)](_0x498f8e[_0x580bda(-0x1da,-0x235,-0x190,-0x114)],_0x580bda(-0x2b,-0xd9,-0xf8,-0xb6))){if(_0x5182df[_0x580bda(-0x116,-0x26e,-0x1e5,-0x2b2)]===_0x498f8e[_0x580bda(-0x27a,-0x2a4,-0x1d0,-0x1f1)]&&_0x5182df[_0x3c6bb5(0x6a7,0x653,0x6bd,0x67a)]?.[_0x3c6bb5(0x627,0x63a,0x6fc,0x6d7)]){if(_0x498f8e[_0x580bda(-0xe,0x45,-0x4a,-0xb7)](_0x498f8e[_0x3c6bb5(0x6d5,0x6e2,0x709,0x680)],_0x498f8e[_0x580bda(-0xe5,-0xdd,-0x7a,-0x58)])){_0x4b4042=_0x5182df[_0x580bda(-0x98,-0xc4,-0x8e,0x30)]['url'];break;}else _0x56fc16=_0x4f1430;}}else _0x45ff07=_0x498f8e[_0x3c6bb5(0x5bc,0x4ea,0x5d3,0x5dd)](_0x40c702,_0x498f8e[_0x3c6bb5(0x598,0x639,0x5a1,0x555)]);}else{if(_0x498f8e['bzJXL'](typeof _0x401ff3,_0x498f8e[_0x580bda(-0x1f5,-0x182,-0x1e8,-0x20f)])){const _0x34be14=/!\[.*?\]\(((?:https?:\/\/|data:image\/[^;]+;base64,)[^\s\)]+)\)/,_0x31f639=_0x401ff3['match'](_0x34be14);if(_0x31f639&&_0x31f639[-0xc31+0x1341*0x1+-0x70f]){const _0x31e939=_0x31f639[-0x407*0x1+-0xd3b+-0x9*-0x1eb];if(_0x31e939[_0x3c6bb5(0x6d6,0x746,0x667,0x76b)](_0x498f8e[_0x580bda(-0x10b,-0x1ad,-0xf7,-0xb9)])){if('RpfDs'===_0x3c6bb5(0x650,0x6ac,0x6d3,0x620))_0x498f8e[_0x3c6bb5(0x646,0x5fa,0x63b,0x65b)](addLog,_0x498f8e[_0x580bda(-0xcc,-0xbf,-0x123,-0xbb)]),_0x4b4042=_0x31e939,_0x498f8e[_0x3c6bb5(0x6cb,0x603,0x6a8,0x6cd)](addLog,_0x498f8e[_0x3c6bb5(0x68c,0x719,0x666,0x6d6)]);else{const {taskId:_0x3c297c}=_0x5bfc42;_0x498f8e[_0x3c6bb5(0x6ac,0x6d4,0x6bc,0x66f)](_0x436c8f,_0x580bda(-0x162,-0x4a,-0x9f,-0x133)+_0x580bda(-0xf2,-0x176,-0xc3,-0x121)+_0x580bda(-0xb7,-0x13,-0xda,-0xec)+_0x3c297c+')');if(_0x498f8e[_0x580bda(0x3f,0xd,-0x8f,-0x107)](_0x549cb5,_0x3c297c)&&_0x4176c7){const _0x264320=_0x580bda(-0x78,-0x8,-0xbb,-0x182)['split']('|');let _0x21021b=-0x249f+0x3*-0x18e+0x2949;while(!![]){switch(_0x264320[_0x21021b++]){case'0':_0x1b9457(_0x580bda(-0x12b,-0xcd,-0x92,-0xde)+_0x3c6bb5(0x6b9,0x71b,0x724,0x74e)+_0x3c6bb5(0x67f,0x6c3,0x6d6,0x651)+_0xaf14e0+')');continue;case'1':_0xd33d20=null;continue;case'2':_0x1ab9ad=null;continue;case'3':_0x2532be=null;continue;case'4':const _0x99084={};_0x99084['id']=_0xaab2bc,_0x99084[_0x3c6bb5(0x63a,0x70e,0x5db,0x5e0)]=![],_0x99084[_0x3c6bb5(0x6d3,0x6d2,0x600,0x764)]=_0x498f8e['BXDlR'],_0x99084[_0x3c6bb5(0x62d,0x607,0x5c6,0x650)]=_0x3c5106||'',_0x5128ef[_0x3c6bb5(0x6ab,0x636,0x5ed,0x739)](_0x42cede[_0x580bda(0x53,-0x16,-0x6c,-0x128)+_0x3c6bb5(0x6d2,0x63c,0x6d9,0x684)+'NSE'],_0x99084);continue;}break;}}}}else{if(_0x498f8e[_0x580bda(-0xc2,-0x43,-0x79,-0x13f)](_0x498f8e['gQZze'],_0x3c6bb5(0x5ad,0x4ec,0x56e,0x635))){_0x498f8e[_0x3c6bb5(0x6db,0x6ce,0x64b,0x6ad)](addLog,_0x498f8e[_0x580bda(-0x130,-0x124,-0xdb,-0xee)]),_0x498f8e[_0x3c6bb5(0x64d,0x68b,0x681,0x5c3)](addLog,_0x580bda(-0x1ad,-0xa6,-0x146,-0x1c3)+_0x580bda(-0xdd,-0x1b6,-0x15d,-0x116)+_0x580bda(-0x146,-0xa0,-0xc2,-0x49)+_0x31e939);try{if(_0x498f8e[_0x3c6bb5(0x632,0x66c,0x6b9,0x573)](_0x498f8e[_0x580bda(-0x140,-0x1db,-0x1d6,-0x15a)],_0x498f8e[_0x580bda(-0x13d,-0x169,-0x1d6,-0x18a)])){const _0x383baf=await _0x498f8e[_0x580bda(-0x281,-0x1f5,-0x1e3,-0x163)](fetch,_0x31e939);if(!_0x383baf['ok'])throw new Error(_0x3c6bb5(0x67c,0x73e,0x727,0x642)+'fetch\x20imag'+_0x580bda(-0xd5,-0x132,-0xb8,-0x9b)+_0x383baf[_0x3c6bb5(0x576,0x5e9,0x580,0x60b)]);const _0x16ed65=await _0x383baf['blob'](),_0x5eae2d=await new Promise((_0x547000,_0x3b2550)=>{function _0x5b5f8b(_0x3576e5,_0x2b9f15,_0x3cd101,_0x5ebdc8){return _0x580bda(_0x3576e5-0x6c,_0x5ebdc8,_0x3cd101-0x28a,_0x5ebdc8-0x159);}const _0x25fcc0={};_0x25fcc0[_0x5b5f8b(0x20d,0x26b,0x194,0x1a1)]=_0x498f8e[_0x5b5f8b(0x127,0x7e,0x10f,0x1bf)];function _0x57a0ed(_0x5af8a6,_0xc8b9df,_0x2370a7,_0x48ef5c){return _0x580bda(_0x5af8a6-0xcf,_0x48ef5c,_0x5af8a6-0x4b0,_0x48ef5c-0x14b);}const _0x1ad2c0=_0x25fcc0;if(_0x498f8e['PWCva']!==_0x498f8e['ZejTA']){const _0x314a0c=new FileReader();_0x314a0c['onloadend']=()=>_0x547000(_0x314a0c[_0x5b5f8b(0x274,0x19c,0x1b2,0x1e8)]),_0x314a0c[_0x57a0ed(0x2c5,0x31e,0x2ff,0x278)]=_0x3b2550,_0x314a0c[_0x57a0ed(0x311,0x3db,0x257,0x265)+'URL'](_0x16ed65);}else{const _0x3df264={};_0x3df264[_0x57a0ed(0x2cb,0x2d9,0x36d,0x266)]=_0x5b5f8b(0x6c,0x113,0x13a,0x203),_0x3df264[_0x57a0ed(0x360,0x36b,0x3a7,0x296)]=_0x88c05;const _0x502b35={};_0x502b35[_0x57a0ed(0x308,0x32f,0x23d,0x2c8)]=_0x1ad2c0['fptYW'],_0x502b35['content']=[_0x3df264],_0x3e6e74['push'](_0x502b35);}});_0x4b4042=_0x5eae2d,_0x498f8e[_0x580bda(-0x200,-0x1b4,-0x141,-0x140)](addLog,'[Banana]\x20S'+_0x580bda(-0x1b8,-0xe8,-0x189,-0x13a)+_0x580bda(-0x127,-0x130,-0x18f,-0x214)+'d\x20Markdown'+'\x20image\x20to\x20'+_0x580bda(0x85,-0x127,-0x52,-0x45));}else _0x206938=_0x498f8e[_0x3c6bb5(0x687,0x642,0x745,0x641)](_0x23af5e,',\x20')+_0x14bdc6[_0x3c6bb5(0x625,0x644,0x621,0x6da)+_0x1c3dd9+_0x3c6bb5(0x605,0x548,0x5cd,0x660)];}catch(_0xf7ecaf){addLog(_0x3c6bb5(0x655,0x6e1,0x66b,0x5aa)+'ailed\x20to\x20f'+_0x3c6bb5(0x574,0x533,0x4ea,0x55c)+_0x580bda(-0x1eb,-0x186,-0x151,-0x178)+'\x20'+_0xf7ecaf[_0x3c6bb5(0x5ee,0x63d,0x6be,0x53c)]),_0x4b4042=_0x31e939,_0x498f8e[_0x580bda(-0x1aa,-0x181,-0x156,-0x107)](addLog,_0x498f8e['kxqMO']);}}else{_0x498f8e[_0x3c6bb5(0x69b,0x769,0x6f7,0x6ab)](_0x40fcb3,_0x498f8e[_0x3c6bb5(0x5e6,0x60a,0x554,0x65c)]),_0x412d60=_0x498f8e[_0x3c6bb5(0x69f,0x71c,0x669,0x702)](_0x379a2a,_0x30c466),_0x14e441=_0x15c2ea[_0x498f8e['NTxfu']];for(let _0x2a5ae0=-0x1f68+0x112a+0xe3f;_0x498f8e[_0x3c6bb5(0x5cc,0x60e,0x4ff,0x5ca)](_0x2a5ae0,0x3bf*0x3+-0x113c+0x1b*0x39);_0x2a5ae0++){_0x256d5b['Character\x20'+_0x2a5ae0+'\x20Prompt']&&(_0xc6aa51=_0x498f8e[_0x3c6bb5(0x5b5,0x5a5,0x4e3,0x61f)](_0x498f8e[_0x3c6bb5(0x5b9,0x562,0x5d2,0x639)](_0x333639,',\x20'),_0x3c80da[_0x580bda(-0xcb,-0xbe,-0x110,-0x176)+_0x2a5ae0+_0x3c6bb5(0x605,0x566,0x643,0x532)]));}}}}else _0x498f8e[_0x580bda(-0xa8,-0x158,-0x131,-0x9e)](_0x498f8e[_0x3c6bb5(0x578,0x4ce,0x54e,0x55a)],_0x580bda(-0xd3,-0x1d8,-0x162,-0x112))?addLog(_0x498f8e[_0x580bda(-0x17f,-0xac,-0x152,-0x1cf)]):_0x55f616['Character\x20'+_0x207797+_0x580bda(-0x1a4,-0xb8,-0x130,-0xd9)]&&(_0x2183e9=_0x498f8e['yVwtn'](_0x2b5e24+_0x498f8e[_0x580bda(-0x15c,0x12,-0xa4,0x4)],_0x498f8e[_0x580bda(-0x213,-0x24a,-0x1be,-0x14c)](_0x5c7b37,_0x49c444[_0x580bda(-0xd6,-0xf1,-0x110,-0x143)+_0x335113+'\x20Prompt'])));}}}if(!_0x4b4042){if(_0x498f8e['Tdjyy'](_0x498f8e[_0x580bda(-0x29a,-0x1ad,-0x1e6,-0x25c)],_0x3c6bb5(0x5c4,0x579,0x686,0x5ac)))throw new Error(_0x498f8e[_0x580bda(-0x13c,-0x11e,-0x145,-0x166)]);else _0x41ec42['on'](_0x4b4d75[_0x3c6bb5(0x6c9,0x68c,0x611,0x65f)+_0x580bda(-0xef,0x56,-0x57,-0xa0)+'ST'],_0x3af87f),_0x26c40c['on'](_0x580bda(-0x1ac,-0x141,-0xde,-0x154)+_0x580bda(-0x213,-0x108,-0x165,-0x217)+_0x3c6bb5(0x5bb,0x5b0,0x63e,0x52c),_0x523026),_0x498f8e[_0x580bda(-0x1f2,-0x28f,-0x1b9,-0x234)](_0x4adcc7,_0x498f8e[_0x580bda(-0x17b,-0x229,-0x183,-0xe9)]);}_0x498f8e[_0x580bda(-0xcc,-0x76,-0x99,0xb)](addLog,_0x498f8e[_0x3c6bb5(0x573,0x5ed,0x4fa,0x5da)]),taskQueue['completeTa'+'sk'](_0x583895,!![]),currentTaskId=null;const _0x44f8df={};return _0x44f8df[_0x580bda(-0x13a,-0x12f,-0x1b2,-0x101)]=_0x4b4042,_0x44f8df[_0x3c6bb5(0x674,0x61f,0x691,0x66d)]=_0x4182e4||'',_0x44f8df;}catch(_0x568643){if(_0x498f8e[_0x3c6bb5(0x5c3,0x67e,0x557,0x62a)](_0x498f8e[_0x580bda(-0xff,-0x197,-0x197,-0x1be)],_0x498f8e[_0x580bda(-0x21c,-0x20c,-0x19e,-0x20b)])){_0x498f8e[_0x3c6bb5(0x6db,0x6aa,0x711,0x706)](addLog,_0x580bda(-0x1ac,-0x10,-0xe0,-0x109)+_0x580bda(-0x95,-0x1cd,-0x106,-0x18f)+':\x20'+_0x568643[_0x580bda(-0x129,-0x17b,-0x147,-0x1f6)]),console['error'](_0x498f8e[_0x3c6bb5(0x649,0x65e,0x642,0x57f)],_0x568643);if(_0x498f8e['cUWRf'](_0x568643[_0x580bda(-0xba,-0x1f6,-0x147,-0xb2)],_0x3c6bb5(0x5b7,0x530,0x5d4,0x5fb))){}else _0x498f8e[_0x580bda(0x3e,-0x84,-0x6d,-0xfd)](_0x498f8e[_0x580bda(-0x1ca,-0x1f7,-0x198,-0xc2)],_0x498f8e[_0x3c6bb5(0x690,0x73f,0x6aa,0x626)])?taskQueue['completeTa'+'sk'](_0x583895,![]):_0x34bba9=_0x498f8e['yVwtn'](_0x412016,_0x22d21a);currentTaskId=null;throw _0x568643;}else _0x498f8e['JSxAK'](_0x25bae9,_0x498f8e['ePSgo']),_0x2c2c52=_0x4bbac0,_0x498f8e[_0x3c6bb5(0x6a9,0x673,0x5f4,0x614)](_0x280984,_0x498f8e[_0x580bda(-0xda,-0x12a,-0xa9,-0x12c)]);}}export async function bananaGenerate(_0x39ede6){const _0x27f6f8={'dOqdC':_0x144162(0xa2,0xc6,0xc4,-0x2e),'mgBpX':_0x229797(0x629,0x5d8,0x5e9,0x63e),'ZBSps':function(_0x4abe99,_0x524eda){return _0x4abe99||_0x524eda;},'VLpSV':function(_0xb9eb10){return _0xb9eb10();},'CRxqO':function(_0xaa35d8,_0x37661d){return _0xaa35d8(_0x37661d);},'wpOBk':_0x144162(0x4d,0x41,0xaf,0x68),'HDiJq':function(_0x7e17eb,_0x159491){return _0x7e17eb!==_0x159491;},'ICRlr':_0x229797(0x74c,0x68f,0x72c,0x634),'wvtsl':function(_0x423470,_0x664206){return _0x423470(_0x664206);},'DuaJx':function(_0x2b0abc,_0x5242c9){return _0x2b0abc(_0x5242c9);},'eyVSB':function(_0x24b31f,_0x4f4307){return _0x24b31f(_0x4f4307);},'VjZAQ':function(_0x171b7c,_0x2ceee4){return _0x171b7c(_0x2ceee4);},'FMPAL':function(_0x3b05b3,_0xec1790){return _0x3b05b3!=_0xec1790;},'jUQFU':function(_0x392535,_0x565ff7,_0x23e555,_0x18e9cf){return _0x392535(_0x565ff7,_0x23e555,_0x18e9cf);},'LMVby':function(_0x219ff6,_0x1efe24){return _0x219ff6(_0x1efe24);},'LHhVW':function(_0x39cc5e,_0x524b85){return _0x39cc5e+_0x524b85;},'syFQD':function(_0x5ba2fa,_0x387cd7){return _0x5ba2fa(_0x387cd7);},'qJKpu':_0x144162(0xe9,0x1bb,0x10e,0xad),'wOUHC':function(_0x4099e4,_0x55accb){return _0x4099e4(_0x55accb);},'jMLjf':'GTwRO','gxoRE':function(_0x3fb6de,_0x50697f){return _0x3fb6de(_0x50697f);},'ylEaM':function(_0x4bcac1,_0x462b62){return _0x4bcac1(_0x462b62);}};_0x27f6f8[_0x144162(-0x4f,0x5b,-0x96,-0x5d)](clearLog);function _0x144162(_0x5e461b,_0x1e2508,_0x83a7,_0x2ab5ee){return _0x38b6(_0x5e461b- -0x25c,_0x2ab5ee);}let {id:_0xca6d2f,prompt:_0x5b5d0e,width:_0x30076a,height:_0x7a989c,change:_0x55fff7,retouchPrompt:_0x8652f,retouchImage:_0x57be96}=_0x39ede6;currentRequestId=_0xca6d2f,currentPrompt=_0x5b5d0e,_0x27f6f8[_0x144162(0x96,0x33,0xf8,0x5e)](addLog,'[Banana]\x20R'+_0x144162(-0x97,-0xfd,-0xc1,0x2f)+_0x144162(-0x8a,-0x16,-0x104,0x18)+_0x144162(-0x85,-0x6,-0xf6,0xe)+_0x144162(0x50,0xf3,-0x64,-0x29)+_0xca6d2f+')');let _0x517d4c='';if(_0x55fff7)_0x517d4c=_0x55fff7['replaceAll'](_0x27f6f8[_0x144162(0x6c,0x25,-0x46,0x13d)],'');else{if(_0x27f6f8[_0x144162(-0x3,0x7f,-0x17,0x5e)](_0x27f6f8[_0x229797(0x5c8,0x632,0x56d,0x6ab)],_0x229797(0x60c,0x5d0,0x69a,0x5a8)))_0x517d4c=_0x5b5d0e;else{const _0x3136cb=_0x535811?function(){if(_0x2bd13d){const _0x462698=_0x1b967d['apply'](_0x3438ba,arguments);return _0x4cd42f=null,_0x462698;}}:function(){};return _0x4e97c1=![],_0x3136cb;}}function _0x229797(_0x42f38e,_0xc67e91,_0x1f473a,_0x522643){return _0x38b6(_0xc67e91-0x3a8,_0x1f473a);}if(_0x55fff7&&_0x55fff7['includes'](_0x27f6f8['wpOBk'])){_0x27f6f8[_0x144162(-0x43,0xc,-0xc2,-0x10b)](addLog,'Banana修图模式'+'启动');if(_0x8652f)_0x27f6f8[_0x229797(0x699,0x705,0x6e6,0x680)](addLog,_0x144162(0x4b,0xb5,-0x20,0x6f)+_0x8652f);if(_0x57be96)_0x27f6f8['eyVSB'](addLog,'修图图片:\x20[已提供'+']');}try{const {image:_0x534d07,change:_0x5c024d}=await _0x27f6f8[_0x144162(-0x8d,-0x13e,-0x110,-0x104)](generateBananaImage,{'prompt':_0x5b5d0e,'width':_0x30076a,'height':_0x7a989c,'change':_0x55fff7,'retouchPrompt':_0x8652f,'retouchImage':_0x57be96});if(_0x27f6f8[_0x229797(0x51f,0x5c5,0x600,0x648)](extension_settings[extensionName][_0x144162(0x46,0x119,0x1d,-0x5e)],'0')){const _0x20fc1a={};_0x20fc1a[_0x229797(0x75c,0x695,0x742,0x760)]=_0x517d4c,await _0x27f6f8[_0x144162(0x18,-0x2b,0x30,-0x89)](setItemImg,_0x5b5d0e,_0x534d07,_0x20fc1a),_0x27f6f8['LMVby'](addLog,_0x144162(0x39,0x7d,0x8a,0x1b)+_0x144162(-0x55,-0x35,-0x45,-0xf0)+'\x20'+_0x5b5d0e),extension_settings[extensionName][_0x144162(-0x79,-0x3a,-0x43,-0xb1)][_0x229797(0x603,0x5cf,0x5a4,0x5c6)]?(extension_settings[extensionName][_0x144162(-0x79,-0x141,-0x140,-0xe5)][_0x229797(0x61a,0x5cf,0x6a6,0x67e)]=_0x27f6f8[_0x229797(0x5d1,0x63e,0x59a,0x661)](extension_settings[extensionName][_0x229797(0x4e4,0x58b,0x4ff,0x51c)][_0x229797(0x51a,0x5cf,0x645,0x58c)],0x1992+0xa1b+-0x2*0x11d6),addLog('当前生图次数为\x20fo'+_0x144162(0x28,-0x9c,-0x63,0x75)+extension_settings[extensionName][_0x229797(0x50c,0x58b,0x609,0x4ed)][_0x229797(0x62b,0x5cf,0x615,0x6a1)])):(extension_settings[extensionName][_0x229797(0x503,0x58b,0x548,0x5b3)]['cishu']=0x1*-0x1c67+-0x23cc*-0x1+-0x3b2*0x2,_0x27f6f8[_0x229797(0x6a8,0x640,0x687,0x625)](addLog,_0x144162(-0x73,-0x12a,-0x4f,-0xc5)+_0x229797(0x5e4,0x62c,0x665,0x5fa)+extension_settings[extensionName][_0x229797(0x5d1,0x58b,0x5a5,0x524)]['cishu']));}else{if(_0x27f6f8[_0x144162(-0x3,0x56,0x52,0x69)](_0x27f6f8[_0x229797(0x70c,0x70e,0x6cd,0x720)],_0x27f6f8[_0x144162(0x10a,0xf6,0x77,0x7c)])){const _0xe54a24={};_0xe54a24[_0x144162(-0x56,-0x94,-0xa3,0x53)]=_0x27f6f8[_0x144162(0x9d,0x129,0x171,0x1a)],_0xe54a24[_0x229797(0x6d8,0x658,0x5b6,0x6a7)]=_0x4b7933,_0x55f600[_0x229797(0x71d,0x66b,0x73c,0x5e5)](_0xe54a24);}else addLog('缓存设置为不存入数据'+'库');}const _0x375048={};_0x375048['id']=_0xca6d2f,_0x375048['success']=!![],_0x375048['imageData']=_0x534d07,_0x375048[_0x144162(0x4a,0x94,-0x45,0x4d)]=_0x5b5d0e,_0x375048[_0x144162(0x91,-0x3a,-0x40,0x9d)]=_0x517d4c,eventSource[_0x229797(0x6ac,0x6cc,0x673,0x755)](EventType['GENERATE_I'+_0x229797(0x717,0x6f3,0x636,0x6e9)+_0x144162(0x62,0x135,0x110,-0x19)],_0x375048),_0x27f6f8[_0x144162(0x10c,0xef,0xaa,0xc1)](addLog,_0x229797(0x618,0x5ee,0x59a,0x565)+'mitted\x20suc'+_0x229797(0x5fc,0x6cb,0x64a,0x733)+_0x144162(0xdb,0x19a,0x178,0x12c)+':\x20'+_0xca6d2f);}catch(_0x4938ce){if(_0x27f6f8[_0x144162(0x92,0x7d,0x12,0x48)]==='GTwRO'){const _0x1725bd=_0x229797(0x55f,0x623,0x673,0x6d4)+_0x144162(-0x7a,-0x79,-0xcb,-0x74)+_0x229797(0x619,0x652,0x696,0x5d1)+_0x144162(0x89,0xc2,0xfb,0xb2)+_0xca6d2f+':\x20'+_0x4938ce['message'];_0x27f6f8['gxoRE'](addLog,_0x1725bd),console['error'](_0x1725bd);const _0x30188e={};_0x30188e['id']=_0xca6d2f,_0x30188e[_0x229797(0x66d,0x65b,0x6ef,0x724)]=![],_0x30188e[_0x144162(0xf0,0x167,0x128,0x156)]=_0x4938ce[_0x144162(0xb,-0xa2,0x2c,-0x71)],_0x30188e[_0x144162(0x4a,0x75,0x6,0xec)]=_0x5b5d0e,eventSource[_0x229797(0x625,0x6cc,0x6cf,0x661)](EventType[_0x144162(0xe6,0x38,0x110,0xe3)+_0x229797(0x6c3,0x6f3,0x68f,0x78b)+_0x229797(0x66a,0x666,0x681,0x6e1)],_0x30188e),_0x27f6f8[_0x144162(0xc5,0x11b,0xb3,0x8a)](addLog,_0x229797(0x546,0x5ee,0x68e,0x5ac)+_0x144162(0x7f,0x10d,0xaa,0x99)+_0x144162(0xa3,0x8b,0x138,0x1f)+_0x229797(0x733,0x6df,0x646,0x710)+':\x20'+_0xca6d2f);}else{const _0x1394be=_0x144162(0xbd,-0x3,0x9,-0x6)[_0x229797(0x5bb,0x690,0x731,0x68a)]('|');let _0x35932b=0xbba+-0xe10+-0x2e*-0xd;while(!![]){switch(_0x1394be[_0x35932b++]){case'0':_0x154bb6=null;continue;case'1':_0x540c40[_0x144162(0xc8,0x10b,0x148,0x33)](_0x49800c[_0x229797(0x631,0x6ea,0x654,0x755)+_0x144162(0xef,0x155,0x17d,0x5e)+_0x229797(0x5d1,0x666,0x5fb,0x699)],{'id':_0x1852f4,'success':![],'error':_0x27f6f8['mgBpX'],'prompt':_0x27f6f8[_0x144162(-0x92,-0x105,-0x21,-0x40)](_0x516360,'')});continue;case'2':_0x5212cf=null;continue;case'3':_0x46f272=null;continue;case'4':_0x14e7f('[Banana]\x20取'+_0x229797(0x751,0x6da,0x6ef,0x77a)+'响应\x20(ID:\x20'+_0x568565+')');continue;}break;}}}}function handleCancelBananaTask(_0x2021af){const _0x219772={'dFgod':function(_0x2573eb,_0x5519e0){return _0x2573eb(_0x5519e0);},'uWNPu':_0xe55ff4(0x184,0xfb,0xd5,0x1bd),'ZfEFP':function(_0x34bfd0,_0x51b00e){return _0x34bfd0||_0x51b00e;},'dLWen':function(_0x82b1ab,_0x146047){return _0x82b1ab(_0x146047);}},{taskId:_0x3de9a2}=_0x2021af;function _0xe55ff4(_0x2488ed,_0x507f97,_0x4cfe02,_0x402a68){return _0x38b6(_0x2488ed- -0x149,_0x507f97);}_0x219772[_0x103831(0x151,0x109,0x162,0xa7)](addLog,'[Banana]\x20收'+'到取消任务事件\x20(T'+_0xe55ff4(0x18b,0x1c3,0x22f,0x185)+_0x3de9a2+')');function _0x103831(_0x15ec03,_0x31bb6b,_0x2d9a6a,_0x1c0540){return _0x38b6(_0x1c0540- -0x15b,_0x2d9a6a);}if(currentTaskId===_0x3de9a2&&currentRequestId){const _0x296547=_0x219772['uWNPu'][_0xe55ff4(0x19f,0x194,0x10d,0x11c)]('|');let _0x5acdfa=0x156d+0x1961*0x1+0x1*-0x2ece;while(!![]){switch(_0x296547[_0x5acdfa++]){case'0':currentRequestId=null;continue;case'1':eventSource['emit'](EventType[_0xe55ff4(0x1f9,0x220,0x1e1,0x225)+_0x103831(0x262,0x18b,0x1e6,0x1f0)+_0x103831(0x231,0x107,0xa8,0x163)],{'id':currentRequestId,'success':![],'error':'任务已取消','prompt':_0x219772[_0xe55ff4(0x19a,0x12c,0x1be,0x270)](currentPrompt,'')});continue;case'2':_0x219772[_0x103831(0x102,0x248,0xe8,0x174)](addLog,'[Banana]\x20取'+_0xe55ff4(0x1e9,0x1a1,0x2af,0x2bd)+_0xe55ff4(0x1af,0x24b,0x119,0x216)+currentRequestId+')');continue;case'3':currentPrompt=null;continue;case'4':currentTaskId=null;continue;}break;}}}function initializeBananaListener(){const _0x322e38={'NuxxO':_0x1b793f(0x280,0x328,0x372,0x29b)+_0x582766(0x2a3,0x2d0,0x389,0x262)+_0x1b793f(0x17d,0x2aa,0x194,0x1ff),'BMVMt':function(_0x39dfd2,_0x7a7a67){return _0x39dfd2(_0x7a7a67);}};function _0x1b793f(_0x5b1d72,_0x3a3799,_0x31007b,_0x41174c){return _0x38b6(_0x41174c- -0x35,_0x5b1d72);}eventSource['on'](EventType[_0x582766(0x3b2,0x3c9,0x311,0x309)+'MAGE_REQUE'+'ST'],bananaGenerate);function _0x582766(_0x1aab97,_0x2c7f7e,_0x44c3ed,_0x3e6240){return _0x38b6(_0x2c7f7e-0x87,_0x3e6240);}eventSource['on'](_0x322e38[_0x582766(0x244,0x313,0x3ca,0x245)],handleCancelBananaTask),_0x322e38[_0x582766(0x1ba,0x285,0x323,0x2c6)](addLog,_0x582766(0x3d6,0x38a,0x30b,0x2e9)+'件监听器已初始化。');}export async function replaceWithBanana(){function _0x2f42b2(_0x13cb45,_0x4be73d,_0x4375c4,_0x25400d){return _0x38b6(_0x13cb45- -0x3c7,_0x25400d);}function _0x24e825(_0x8d623b,_0x2d271e,_0x398b22,_0x5c56c5){return _0x38b6(_0x5c56c5-0xb1,_0x8d623b);}const _0x330cdb={'zkBWB':function(_0x1ebe3a,_0x457729){return _0x1ebe3a(_0x457729);},'WMUGf':function(_0x1e662c,_0x4e93eb){return _0x1e662c(_0x4e93eb);},'YNoVs':'[Banana]\x20U'+_0x2f42b2(-0x7f,0x17,-0x141,-0x91)+_0x24e825(0x294,0x2a2,0x1bc,0x292)+'allback.','OcMnH':function(_0x40f90a,_0x5d0ed9){return _0x40f90a==_0x5d0ed9;},'YOZde':'banana','fJVQN':function(_0x1bf881,_0xf0026a){return _0x1bf881!==_0xf0026a;},'DAbsc':_0x24e825(0x3ab,0x3bd,0x34e,0x32d),'cPbbP':function(_0x297b31){return _0x297b31();},'grBpT':function(_0x355e72){return _0x355e72();},'tgNSz':function(_0xb2c931,_0xf20b6c){return _0xb2c931!==_0xf20b6c;},'GpKAW':'Zmagf','qrOjn':_0x2f42b2(-0x184,-0x18a,-0x1bb,-0x197),'KtoEl':_0x24e825(0x283,0x328,0x2b4,0x2bf)+_0x2f42b2(-0xe6,-0xb1,-0x141,-0x58)};if(_0x330cdb[_0x24e825(0x389,0x4db,0x4f1,0x41d)](extension_settings[extensionName][_0x24e825(0x407,0x392,0x3ef,0x352)],_0x330cdb[_0x2f42b2(-0x162,-0x13a,-0x123,-0x22e)]))!window['initialize'+'BananaList'+_0x2f42b2(-0x191,-0x1ef,-0x1dc,-0x249)]&&(_0x330cdb[_0x24e825(0x2df,0x376,0x27a,0x330)](_0x24e825(0x2d7,0x2ed,0x3e5,0x32d),_0x330cdb['DAbsc'])?(_0x330cdb['zkBWB'](_0xed88a0,_0x24e825(0x3bc,0x3bb,0x2c8,0x37f)+_0x24e825(0x28f,0x2fc,0x299,0x31c)+'etch\x20Markd'+_0x24e825(0x3ae,0x2fd,0x2e4,0x30e)+'\x20'+_0x53b3ba[_0x2f42b2(-0x160,-0x11f,-0x123,-0x1c0)]),_0x1b9c06=_0x13a790,_0x330cdb[_0x2f42b2(-0x14f,-0x204,-0xcc,-0x137)](_0x3d6068,_0x330cdb['YNoVs'])):(window[_0x24e825(0x30c,0x327,0x366,0x376)+_0x24e825(0x419,0x422,0x3be,0x3d7)+'ener']=!![],_0x330cdb[_0x24e825(0x433,0x3f5,0x305,0x3c2)](initializeBananaListener))),_0x330cdb[_0x24e825(0x2bd,0x35a,0x37a,0x2f5)](initializeImageProcessing);else{if(_0x330cdb['tgNSz'](_0x330cdb[_0x24e825(0x39a,0x2a2,0x27f,0x2cb)],_0x330cdb['GpKAW'])){const _0x5de458=_0x1d512c[_0x2f42b2(-0x10e,-0x197,-0x65,-0xd6)](_0x4e7dfb,arguments);return _0x278e67=null,_0x5de458;}else{if(window[_0x24e825(0x3b3,0x3d0,0x36b,0x376)+_0x2f42b2(-0xa1,-0x1f,-0x2f,-0x27)+_0x24e825(0x286,0x239,0x3b8,0x2e7)]){const _0x10c849=_0x330cdb[_0x2f42b2(-0x5d,-0x2a,0x50,-0x104)][_0x2f42b2(-0xdf,-0x184,-0x1d,-0x165)]('|');let _0x3d5c9b=-0x9*0x75+-0x179a+0xa5*0x2b;while(!![]){switch(_0x10c849[_0x3d5c9b++]){case'0':LEGACY_EVENT_NAMES[_0x24e825(0x1c6,0x1d9,0x369,0x29b)](_0x543d27=>{function _0xed5f4a(_0x5b2f60,_0x2fe0a6,_0x10bb57,_0xa6a36b){return _0x24e825(_0x2fe0a6,_0x2fe0a6-0x1d,_0x10bb57-0xb6,_0x10bb57- -0x1ec);}function _0x12c55f(_0x193f8b,_0x2637f2,_0x25efec,_0x37a8b6){return _0x2f42b2(_0x37a8b6-0x1f6,_0x2637f2-0x63,_0x25efec-0xec,_0x25efec);}eventSource[_0x12c55f(0x47,0x81,0xfc,0x115)+_0xed5f4a(0xb6,0x171,0xfb,0x6b)](_0x543d27,bananaGenerate);});continue;case'1':eventSource['removeList'+'ener']('st_chatu8_'+_0x2f42b2(-0x17e,-0x1fd,-0x20c,-0xaf)+_0x24e825(0x2b5,0x2c5,0x375,0x2e5),handleCancelBananaTask);continue;case'2':window[_0x24e825(0x334,0x351,0x327,0x376)+_0x24e825(0x373,0x43e,0x32c,0x3d7)+'ener']=![];continue;case'3':eventSource[_0x2f42b2(-0xe1,-0x64,-0xc0,-0x3d)+'ener'](EventType[_0x2f42b2(-0x85,-0x66,-0x49,0x34)+_0x24e825(0x484,0x338,0x3ff,0x408)+'ST'],bananaGenerate);continue;case'4':_0x330cdb['zkBWB'](addLog,_0x330cdb[_0x2f42b2(-0x13a,-0x7f,-0xd8,-0xdd)]);continue;}break;}}}}}