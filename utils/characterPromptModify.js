(function(_0x57923f,_0x34c6ec){const _0x14f7ee=_0x57923f();function _0x53d9b0(_0x316d82,_0xf0370b,_0x40d800,_0x25a7fb){return _0x1551(_0x25a7fb- -0x21e,_0xf0370b);}function _0x298859(_0x254ed6,_0x52609c,_0x19c07b,_0x563d40){return _0x1551(_0x254ed6- -0x10d,_0x52609c);}while(!![]){try{const _0x162771=parseInt(_0x53d9b0(-0x1cd,-0x105,-0x73,-0x121))/(-0x1*0x43d+-0x1ba0*-0x1+-0x92*0x29)+parseInt(_0x53d9b0(0x2a,0x69,0x43,-0x7))/(0xf9e*0x2+-0x230c+0x3d2)*(parseInt(_0x298859(-0x5,-0x4a,0xa9,-0x45))/(0x190c+0x24fb+-0x3e04))+parseInt(_0x53d9b0(0xa6,0x1e,0x1,0x12))/(-0x1924+0x5*0x3af+-0x73*-0xf)*(parseInt(_0x298859(0x15,0x2e,-0x52,-0x7b))/(0x1*0x226a+0x13*0x1bb+-0x4346))+parseInt(_0x53d9b0(-0x153,-0x55,-0x11f,-0xbd))/(0x81c+-0xffd+0x7e7)+parseInt(_0x298859(0xca,0x15e,0xeb,0x4d))/(0x58a+-0x505*-0x5+-0x6*0x51a)+parseInt(_0x298859(0x97,0x4a,0x135,0x4b))/(-0xc*-0xb2+-0x1db*0xb+0x1*0xc19)+-parseInt(_0x53d9b0(-0x135,-0x17a,-0x133,-0x11c))/(0x159a+0x1c35+0x115*-0x2e);if(_0x162771===_0x34c6ec)break;else _0x14f7ee['push'](_0x14f7ee['shift']());}catch(_0x37491d){_0x14f7ee['push'](_0x14f7ee['shift']());}}}(_0x5438,-0x1815a8+0x8054d+-0x1*-0x1e6454));const _0x213fbc=(function(){const _0x314078={'JWrEf':function(_0x1a570d,_0xaf50ae){return _0x1a570d===_0xaf50ae;},'HQCGx':_0x100969(0x2cd,0x309,0x336,0x301),'YYvmg':_0x100969(0x2c5,0x332,0x378,0x2c4),'wSkNx':function(_0x386dbd,_0x2863b6){return _0x386dbd(_0x2863b6);},'SgtSd':_0x1f79da(0x31b,0x2df,0x377,0x352),'rVLhZ':_0x100969(0x3a3,0x319,0x31e,0x276),'wHzZA':_0x100969(0x17d,0x212,0x1e0,0x197),'hCqwM':'upperBodyS'+'FW','MRolc':'fullBodySF'+_0x1f79da(0x304,0x3b6,0x3ee,0x398),'XwzRT':_0x100969(0x198,0x20a,0x225,0x266)+_0x1f79da(0x3fb,0x398,0x337,0x360),'kApYP':'fullBodyNS'+'FW','vDGQj':'fullBodyNS'+_0x1f79da(0x299,0x3cc,0x2b2,0x347),'TpuUI':_0x1f79da(0x469,0x471,0x497,0x436)};let _0x21f32e=!![];function _0x100969(_0x1e2c26,_0x1297f4,_0x2298ea,_0x29bf31){return _0x1551(_0x1297f4-0xee,_0x29bf31);}function _0x1f79da(_0x95aea,_0x2f0fae,_0x3a7605,_0x50304e){return _0x1551(_0x50304e-0x1ef,_0x3a7605);}return function(_0x197c20,_0x4cf3f0){function _0x33b99c(_0x190e9c,_0x271fbe,_0x538e5f,_0x15b208){return _0x1f79da(_0x190e9c-0xe,_0x271fbe-0x3f,_0x190e9c,_0x271fbe- -0x3dc);}const _0x452795={'efucV':function(_0x170d9f,_0x442cc2){function _0x5945ce(_0x26f5f6,_0x198f99,_0x27b1d3,_0x37e1bb){return _0x1551(_0x26f5f6-0x349,_0x198f99);}return _0x314078[_0x5945ce(0x50d,0x47b,0x528,0x4de)](_0x170d9f,_0x442cc2);},'niHPA':_0x314078[_0x33b99c(0x62,0x47,0x9b,0xe0)],'hxgjA':_0x314078[_0x383a4b(0x35,0x9c,-0x9,-0x15)],'yTffV':function(_0x49a3d0,_0x5c5092){function _0x4a8bb1(_0x2c05b2,_0x5564c8,_0x271701,_0x25a6dc){return _0x33b99c(_0x5564c8,_0x271701-0x52d,_0x271701-0x6b,_0x25a6dc-0x11e);}return _0x314078[_0x4a8bb1(0x5af,0x5d1,0x569,0x597)](_0x49a3d0,_0x5c5092);},'HwKev':_0x314078[_0x383a4b(0x60,-0x4c,0x2e,0x46)],'AdXFe':_0x314078[_0x33b99c(-0x43,0x18,0xa0,-0x6c)],'BbwiG':_0x314078[_0x383a4b(-0x2,0x15,-0x37,-0x62)],'MnkkC':'facialFeat'+_0x383a4b(-0x7,0xa6,-0xb,0x31),'ahwEx':_0x33b99c(0x13,-0x9f,-0xcb,-0x8b)+_0x33b99c(0x26,-0x4d,-0x85,-0x83),'dbgXw':_0x314078[_0x33b99c(-0xf7,-0x5b,0xa,-0x3f)],'QoVJh':_0x314078[_0x383a4b(-0x64,-0x3f,-0x1b,-0xbd)],'PKcex':_0x314078['XwzRT'],'QjRlY':_0x314078[_0x33b99c(-0x76,0x3a,0x23,0x5e)],'kSCRN':_0x314078[_0x33b99c(-0x6d,0x3f,0x45,0xdd)]};function _0x383a4b(_0x453941,_0x5b8589,_0x28926c,_0x3dd56e){return _0x100969(_0x453941-0x11e,_0x453941- -0x29c,_0x28926c-0x4e,_0x3dd56e);}if(_0x314078[_0x33b99c(-0x31,-0x65,0x33,-0x1a)]!==_0x33b99c(-0x9c,-0xef,-0xd9,-0x68)){const _0x7ac6ce=_0x21f32e?function(){function _0x476e1a(_0xbc8e8b,_0xbf60d,_0x396746,_0x5d7757){return _0x383a4b(_0x5d7757-0x4d4,_0xbf60d-0x10,_0x396746-0xa6,_0xbf60d);}function _0x18ff46(_0x114ca4,_0x3cf57e,_0x21d786,_0x2e18cc){return _0x383a4b(_0x2e18cc-0x1a4,_0x3cf57e-0xa6,_0x21d786-0x84,_0x21d786);}if(_0x4cf3f0){if(_0x452795['efucV'](_0x452795[_0x476e1a(0x487,0x3dc,0x4bd,0x42c)],_0x452795[_0x476e1a(0x46c,0x487,0x4e8,0x446)])){const _0x3ce167=_0x14be92[_0x476e1a(0x602,0x55c,0x5ef,0x575)](_0x1480e9,arguments);return _0x5de0ac=null,_0x3ce167;}else{const _0x3c6912=_0x4cf3f0[_0x18ff46(0x2cd,0x29f,0x1d1,0x245)](_0x197c20,arguments);return _0x4cf3f0=null,_0x3c6912;}}}:function(){};return _0x21f32e=![],_0x7ac6ce;}else{const _0xa09bb6=[_0x452795[_0x383a4b(-0x4e,0x16,-0xf4,0x34)],_0x452795[_0x33b99c(-0x75,-0xa0,-0xbb,-0x76)],_0x452795['MnkkC'],_0x452795['ahwEx'],_0x452795[_0x383a4b(0x18,0xc2,0xc5,-0x43)],'upperBodyS'+_0x383a4b(-0x56,-0xf4,-0x53,-0x68),_0x383a4b(-0x71,-0x5d,0x1e,-0x94)+'W',_0x452795[_0x33b99c(0xc5,0x17,-0x71,0x20)],_0x452795[_0x383a4b(0x8,0x34,0x4e,0x1c)],_0x383a4b(-0x92,-0xc7,-0x96,-0x84)+_0x33b99c(0x27,0x30,-0x3c,0x8f),_0x452795['QjRlY'],_0x452795[_0x33b99c(0x81,0x59,-0x4b,0x67)]];_0xa09bb6[_0x33b99c(0xa3,0x28,0xb4,0xcf)](_0x2311ac=>{function _0x346afe(_0x483603,_0x5fff97,_0x43bb6f,_0x198e48){return _0x383a4b(_0x198e48-0x37c,_0x5fff97-0x1ba,_0x43bb6f-0x146,_0x483603);}function _0x5332b0(_0xe80ea,_0x12d139,_0x514e6d,_0xf53e1e){return _0x383a4b(_0x514e6d-0x58,_0x12d139-0xd5,_0x514e6d-0x18a,_0xe80ea);}if(_0x510bdd[_0x2311ac]){const _0x3944c=_0x3d5e5a[_0x5332b0(0x2c,-0x44,-0x51,-0x4d)+'ById']('char_'+_0x2311ac);_0x3944c&&(_0x3944c['value']=_0x126a98[_0x2311ac],_0x452795[_0x346afe(0x3ff,0x43c,0x4be,0x411)](_0x441f5f,_0x3944c)[_0x5332b0(0xf4,0x99,0x5b,0xfd)](_0x452795[_0x5332b0(0x7f,0xeb,0xab,0xb)]));}});}};}()),_0x5407fd=_0x213fbc(this,function(){const _0x2a6bf5={};_0x2a6bf5[_0x3961a4(0x1c8,0x1e0,0x12b,0x1ed)]=_0x3961a4(0x1aa,0x1f7,0x206,0x17c)+'+$';function _0x3961a4(_0x1fe01e,_0x119778,_0x2645a4,_0x17e236){return _0x1551(_0x1fe01e- -0x3b,_0x119778);}function _0x545234(_0x5f292f,_0x483409,_0x4110ec,_0x343128){return _0x1551(_0x5f292f-0x26e,_0x483409);}const _0x52845c=_0x2a6bf5;return _0x5407fd[_0x3961a4(0xd5,0xd7,0xa3,0x74)]()['search'](_0x545234(0x453,0x4f2,0x458,0x4da)+'+$')[_0x545234(0x37e,0x3c7,0x3d4,0x35c)]()[_0x3961a4(0x172,0x173,0x1bb,0x13a)+'r'](_0x5407fd)[_0x3961a4(0x1b3,0x202,0x143,0x16b)](_0x52845c[_0x3961a4(0x1c8,0x1e9,0x125,0x214)]);});_0x5407fd();function _0xaebf35(_0x68b1f5,_0x12ed93,_0xa03fd2,_0x5341b9){return _0x1551(_0x5341b9- -0x17b,_0xa03fd2);}import{eventSource}from'../../../../../script.js';import{eventNames,extensionName}from'./config.js';function _0x5438(){const _0x58eb83=['zNLDieXmtsbVDq','z3biweK','yxv0BW','z2vUzxjHDgLVBG','ueTJzxG','DxbWzxjcB2r5uW','yMfZzty0','A2XhB08','C3rYAw5N','5PwW5O2UoG','sNPHz2e','B3iGzgvIDwDNAq','rMrbAe0','DcbWCMvZzxq6','CNv3vwO','5lIl5y2k6lQRtLngvZOG','zNLDioACQUIVHUwiQ+EAHos6UUEjQq','ig1LC3nHz2uGAq','sLDYrwy','BgDTAwq','zgjNwhC','Dhb1DdO','zNLDienOyxjHyW','y2HHCL9TB2rPzG','vNn4AhG','5lIl5y2k6lQRu0zx6iom6z2I','zgf0yq','runUrK0','rufwz0G','l3bUzZTIyxnLnG','veHnq0e','y2z3rfq','Eevlr0C','CNP2yxu','q29UDgv4Da','CMvZzxrZ','CKzSEve','mta1otC0mtLkCKvNBuK','Be1kruK','5lQu5A6y5Asw6lkm6iom6z2I','v2HREKC','ALbHA1a','AerIu3C','zgf0ytO','zKLrvue','teXnioIVT+AXGUwKSEI0Pq','iIdNMOtKU6xKUiVMLBdMJA46cGO','igLUzgv4','r3fQDeC','wvL2BwC','ChjVBxb0oG','kcGOlISPkYKRkq','zMLSDgvY','B2riA1G','r2rUD2K','ig91Dhb1Da','twLfqM8','tvnHBeC','teXnioI/LowBNUE7K+AENos4UUEPUG','q05MBgC','C2vHCMnO','ugPXAfK','zxH0icH0CMLNzW','ChvZAa','z0v4A00','v29YBgrcB29R','uNbIAwe','AvvJDuC','CMvZDwX0','E3VLVzpLIy3OP5lOIBj9Fq','DgLUzYbJAgfYia','zNLDifjLCxvLCW','Aw1Hz2vZihrVia','BvndEfC','C1bjA2C','sKn5yuG','wwLLtNi','DhLWzq','wwP0wNu','shDlzxy','Aw5NignOyxiGBq','ANv6q0q','uw9wsMG','CLzmAfO','t1bAD3a','zNLDiev4DhjHyW','icdML6C6ia','uuXfu3q','5lIl5y2k6lQRu0zx','ugXLBNK','AMf6Exm','6k6+ici','u2D0u2q','rM9Vuui','DgvYigXPC3qGDa','zNLDifn0yxj0Aq','vMvYCgC','5lIk5y2k6lQRu0zx6iom6z2IoIa','C3vIC3rYAw5N','zM9YrwfJAa','te1AtfC','mtuXnLDSwerVDW','yvPdAfC','C05fzKK','svzQy0G','yLfeqNG','BgvUz3rO','u0zxqMfJAW','DhjPBq','AgTyyNq','rLHkCMm','Dgv4Da','AM9PBG','6iUX5PAh5zcn56EWoIa','y2LZCLe','vwjtCKC','CuDgtvq','A0fWwva','DLvPsKK','D1nRtNG','B3z1wNa','BMfTzuno','DKrhuwO','EwPcAMu','twzHB2m','5lIk5y2k6lQRtLngv+IdJoMDOJO','mtzOCxHRwey','zNvSBejVzhLouW','rwrlEg8','BvfAEwm','sffdr3G','y2HHCL8','C3vJy2vZCW','rMfnD0i','CYbMB3vUzcbPBG','q2vMrfO','CNnetxK','zun3uuW','t2TnquW','Dg1eBu0','Exf4uLu','5Rgc6lAf5PE2','zw5LCG','D29YBgqGyM9VAW','sxLxqxG','EvrMzLy','zKjpD2m','zNLDifnHDMvKia','A1nduK4','D3rSCKu','BMC6','u0D2Ehi','Exr1suO','6kEs6iMY5l+U5Ps5ieXmtsdOR7C','DgvYihrYAwDNzq','Aw1Hz2vFDxjS','zw1PDa','yxbWBhK','zvfSs20','vgr1tfC','BvngEwi','wKDOz1u','DKTlvxK','zunbuvG','i3n0lwnOyxr1oa','Bw9KAwz5ihjLCq','vMfYAwfIBgvZ','thj3Efe','t0rjrLLFuKvtua','zNLDie5VignOyq','AwHuq0O','ENz5Eg0','rgrYBvy','ue9ou0u','C3jkBvy','C3rHCNrZv2L0Aa','ntq0mZK1B2nnwKTK','zLbsqLu','CMvWBgfJzq','zNLDioATO+wCQowKHoEqHUINKUIjSG','qNLjza','mJyZmZK4mJnhCNrOwwW','ywrK','CKXwA1q','z2v0rwXLBwvUDa','BMLiuee','icdMLRa6ia','ndCXmhDSvgD5uW','Aw5MBW','tNvjBhm','qwfrANe','zxHLyW','ChjVBxb0','Bw9KAwz5ihbYBW','Ewr6ueK','Dg9tDhjPBMC','BMCGy2HHCMfJDa','BwvZC2fNzq','DvrHvfC','6k+k5PAT77YA5Qoa5Rwl5yIW5lUL5lIl5y+y6yEp','BgTzu1O','DurdvhO','AuvNueu','teXnx0niqvjFtq','5RkH5PYj5Qoa5Rwl5yIW6zYa6kAb5PU05PAW55Qe','Cu1Zq3u','BwvZC2fNzsbHDa','DxbWzxjcB2r5tG','Bg9N','koEPUIK','rKTYv0C','AhHNAKe','BfzABKO','mJmWnde1DwjKyM9b','CMvZzxrjza','BMfTzuvo','ioMHUEABToAuUsZMMk/LKkBLUPtNLkG/','suXfwK0','AxnbCNjHEq','5yEg5Ash5PU05PAW6kEs6iMYici','BxPYugq','qLPur3q','qvzut0K','5lIT5PAh5zcn56EW','BMfTzq','DMfYAwfIBgvZoG','ugDKzfO','ven0Du8','v1bXv1G','u2rADwG','v2XHsNq','zgf0ytPPBwfNzq','Cg5swg0','CK96Cu8','Ber4CeW','5lIl5y2k6lQRtLngvW','D3LiBgy','5lIk5y2k6lQRu0zxoIa','5lIk5y2k6lQRtLngv+IdJoMDOG','pc/KURRNIAK+','zNvSBejVzhLtrG','A2TTDvK','twPwCw8','zNLDief0DgfJAa','CMvTB3zLtgLZDa','lxrHyI1JAgfYyq','wNbsv1i','BwfW','Aerqveu','vuvtva','5lIl5y2k6lQRu0zx6iom6z2IoIa','CMfJDgvYihrHzW','wgLnDMy','tvjVBgm','5y+c6icd5zU+54Mh','B2jQzwn0','qMj3AuC','zMfJAwfSrMvHDa','5lIl5y2k6lQRtLngv+IdJoMDOJO','Bwvtu1i','C2L6zq','rez2BMC','zxjLzcK6','ufjptvbux1jfuW','y2HHCMfJDgvYCW','5OM+5lIn5yIW5OYh5A6A55Qe6kEs6iMY6Ake6k6+','zNLDifvZzxiGCG','rLDcywnR','qLfsqNC','Ce5lvuu','CfvTq20','serfDKm','v2vzwLe','vfPsA1G','Dg9pz2S','qwryrMu','mJm2odi2nNnNuxzuAa','lI4U','Aw5WDxq','ueHYsxy','CMvWBgfJzufSBa','zxiGChjVBxb0ia','zNLDiowqIow5TUEBUoMcU+A2IoAbRW','DMfSDwu','zNLDien1CNjLBG','5PYQ5zYOieXmtsdOVPpLH7RKUk0','u1bNAg8','5lIl5y2k6lQRtLngv+IdJoMDOG','5A2x5Q61ici','t0rjrLLFr0vuxW','revUy1u','tLfjB2K','u0zx','5BEY5y+w5RAi5PU05PAW','DK1czNO','CMvXDwvZDcaOsq','5lIk5y2k6lQRtLngvW','BMfuwe0','wNf1B24','zgv0ywLS','CMfUzg9Tvvvjra','uM1eBhG','t091vxu','u05mC3i','uhjVBxb0tw9KAq','y29UDgvUDa','E3VNLkJMIlFPNidMSyj9Fq','zNLDifjHDYbmta','rNjTAg0','C0fKqwW','y2HHDe1LDgfKyq','zxf1AxjLBwvUDa','Aw5JBhvKzxm','vMjrs1G','t05trq','vhb1vuK','5lQu5A6y5Asw6lkm','w2nOyxjHy3rLCG','uej2uvq','DgLTzw91De1Z','zNLDiezPBMfSia','y2HHCMfJDgvYua','6i635y+w6kEs6iMY5l+U5Ps55O+q56s66k+n6lAf','yuLlBuW','veDcrhK','AenXD00','uKvxEwO','wvbyy0y','uw5Izxi','wK5IvMi','wMneB0W','zxjYB3i','cLVKU6xKUiVMMk/NLkJMIlFKUiRKVkdNMOq','reHAsgu','BfnSyuu','Eu9qCxq','tsbVDxrWDxqGzG','q0D2EgO','6kkR5l2/55sO77YA','DxjLC0jHy2S','BM93','q0jKD28','6k+35ywi6ycj5OUP5lIa5lIQ6kEs6iMY6Ake6k6+','mZa1ody0ALzhq2rT','zNLDiow3SUABToAwSoINKUIjSUMIHa','ugzlEuO','DxjLCW','6iUX5PAh5zcn56EW','v0jHy2S','z1vNC00','D1zRzMC','D0H6wKe','y29UC3rYDwn0BW','zNLDioINO+AEKowiSoEAHos6UUEjQq','5lQu5A6y5Asw6lkm6iom6z2IoIa','yM5kDee','DhjPz2DLCG'];_0x5438=function(){return _0x58eb83;};return _0x5438();}import{extension_settings}from'../../../../extensions.js';import{getContext}from'../../../../st-context.js';import{saveSettingsDebounced}from'../../../../../script.js';import{generateCharacterListText,generateOutfitEnableListText,generateCommonCharacterListText}from'./settings/worldbook.js';import{updateCombinedPrompt}from'./settings/llm.js';import{buildPromptForRequestType}from'./settings/llmService.js';import{refreshCharacterSettings}from'./settings/character/index.js';function _0x1551(_0xc4dc6f,_0x526e73){const _0x580da7=_0x5438();return _0x1551=function(_0x493012,_0x6771e0){_0x493012=_0x493012-(0x23cb+-0x17*0x19b+-0x35*-0xa);let _0x854f05=_0x580da7[_0x493012];if(_0x1551['kDuQyy']===undefined){var _0x35ad4c=function(_0x1ec802){const _0x5f1384='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x33f9ba='',_0x3f5d11='',_0x4fda05=_0x33f9ba+_0x35ad4c;for(let _0x43ced4=-0x2f4*0x5+0x59*0x59+-0x102d,_0x1ff764,_0x317285,_0x54697d=-0x4*-0xc2+0x1*-0x220e+0x1f06;_0x317285=_0x1ec802['charAt'](_0x54697d++);~_0x317285&&(_0x1ff764=_0x43ced4%(0x14cc+-0x24e3+0x101b)?_0x1ff764*(0x1*0x1d81+0x116d*0x2+-0x401b)+_0x317285:_0x317285,_0x43ced4++%(-0x1*0x14ad+-0x13fb+0x1*0x28ac))?_0x33f9ba+=_0x4fda05['charCodeAt'](_0x54697d+(-0x163*-0x1a+-0x2e8+0x34*-0xa3))-(-0x2b6+0xe5+0x5*0x5f)!==-0x457*0x4+-0xbef*0x3+-0x1f*-0x1b7?String['fromCharCode'](-0xf77+0x13f9*0x1+-0x383&_0x1ff764>>(-(0x2626+0x1d*0x43+-0x2dbb*0x1)*_0x43ced4&-0xf23*0x2+-0x1213+0xcb*0x3d)):_0x43ced4:0xfbd+-0x2*-0x5cb+-0x1b53){_0x317285=_0x5f1384['indexOf'](_0x317285);}for(let _0x3f3345=-0x72*0x20+0x165c+-0x81c,_0x51ac55=_0x33f9ba['length'];_0x3f3345<_0x51ac55;_0x3f3345++){_0x3f5d11+='%'+('00'+_0x33f9ba['charCodeAt'](_0x3f3345)['toString'](0x1f73+-0x1ff2*0x1+0x8f))['slice'](-(-0xeba+-0x26d0+0x1ac6*0x2));}return decodeURIComponent(_0x3f5d11);};_0x1551['GWLBvm']=_0x35ad4c,_0xc4dc6f=arguments,_0x1551['kDuQyy']=!![];}const _0x12144b=_0x580da7[0x91*0x3b+0x7fd*-0x4+0xf*-0x19],_0x486646=_0x493012+_0x12144b,_0x16f7b3=_0xc4dc6f[_0x486646];if(!_0x16f7b3){const _0x680642=function(_0x34fa76){this['xFMTjz']=_0x34fa76,this['EByxQd']=[-0x2*-0x76d+-0x1cf*0x8+-0x61,-0xef5+-0x21fe+0x30f3,-0x1e17+0x3*-0x38f+0x1462*0x2],this['uDJkzc']=function(){return'newState';},this['laAJAJ']='\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*',this['yOsPBo']='[\x27|\x22].+[\x27|\x22];?\x20*}';};_0x680642['prototype']['oGZKhW']=function(){const _0x3916b5=new RegExp(this['laAJAJ']+this['yOsPBo']),_0xfebeca=_0x3916b5['test'](this['uDJkzc']['toString']())?--this['EByxQd'][0x3f5+0x179b+-0x19f*0x11]:--this['EByxQd'][-0x122c+0x14e*-0x2+0x14c8];return this['emyGcO'](_0xfebeca);},_0x680642['prototype']['emyGcO']=function(_0x5506a2){if(!Boolean(~_0x5506a2))return _0x5506a2;return this['zetShz'](this['xFMTjz']);},_0x680642['prototype']['zetShz']=function(_0x2e9b8e){for(let _0x50b964=0x2*0x4bb+-0x2615+-0x11*-0x1af,_0x54d622=this['EByxQd']['length'];_0x50b964<_0x54d622;_0x50b964++){this['EByxQd']['push'](Math['round'](Math['random']())),_0x54d622=this['EByxQd']['length'];}return _0x2e9b8e(this['EByxQd'][-0x190+0x11*0x1+0x17f*0x1]);},new _0x680642(_0x1551)['oGZKhW'](),_0x854f05=_0x1551['GWLBvm'](_0x854f05),_0xc4dc6f[_0x486646]=_0x854f05;}else _0x854f05=_0x16f7b3;return _0x854f05;},_0x1551(_0xc4dc6f,_0x526e73);}import{stylishConfirm}from'./ui_common.js';import{mergeAdjacentMessages,replaceAllPlaceholders,replacePlaceholder as _0x40de14}from'./promptProcessor.js';function replacePlaceholder(_0x54a996,_0x3fdf15,_0x53ae7f,_0x5e7eca){const _0x103bdf={'toOgk':function(_0x5223ae,_0x47d396,_0x38680e,_0x520212,_0x1a6e61){return _0x5223ae(_0x47d396,_0x38680e,_0x520212,_0x1a6e61);},'FaZLw':function(_0x1be3f2,_0x1492f9){return _0x1be3f2===_0x1492f9;},'ihTCJ':_0x49617b(0x2df,0x262,0x368,0x2c9),'vKKUy':_0x5108ba(0x1f5,0x204,0x21d,0x23e),'AaQjq':function(_0x2fa2b1,_0x2eca52){return _0x2fa2b1===_0x2eca52;},'OOuUu':_0x49617b(0x28b,0x296,0x1b3,0x25b),'TGBDy':function(_0x179a58,_0x5315d8,_0x4e2413,_0x1d8bce,_0x439c6c){return _0x179a58(_0x5315d8,_0x4e2413,_0x1d8bce,_0x439c6c);}};function _0x49617b(_0x4f435b,_0x2f926d,_0x2c37b7,_0x47b410){return _0x1551(_0x47b410-0x10f,_0x2c37b7);}if(_0x103bdf['FaZLw'](typeof _0x54a996,_0x103bdf[_0x5108ba(0x14a,0x1e7,0xf4,0xda)])){if(_0x53ae7f&&_0x54a996[_0x49617b(0x248,0x30b,0x1ff,0x294)](_0x3fdf15)){if(_0x103bdf['FaZLw'](_0x103bdf[_0x49617b(0x2ea,0x2cd,0x348,0x363)],_0x49617b(0x314,0x317,0x2fa,0x2b1)))_0x5e7eca&&_0x5e7eca[_0x5108ba(0x156,0x13e,0x183,0x19d)](_0x3fdf15);else{const _0x4545f1={};for(const _0x50e6cf in _0xa50771){_0x4545f1[_0x50e6cf]=_0x103bdf[_0x49617b(0x2ae,0x2d8,0x1f3,0x26e)](_0xaf7153,_0x22a8ac[_0x50e6cf],_0xe78da9,_0x32816b,_0x3c9e33);}return _0x4545f1;}}return _0x54a996[_0x49617b(0x2eb,0x24a,0x2d4,0x274)](_0x3fdf15,_0x53ae7f);}if(Array[_0x49617b(0x1b4,0x2de,0x289,0x236)](_0x54a996))return _0x54a996['map'](_0x8293f9=>replacePlaceholder(_0x8293f9,_0x3fdf15,_0x53ae7f,_0x5e7eca));function _0x5108ba(_0x512978,_0x488e6c,_0x31db4e,_0x3f5b03){return _0x1551(_0x512978-0x53,_0x3f5b03);}if(_0x54a996&&_0x103bdf[_0x49617b(0x205,0x1fb,0x22c,0x21a)](typeof _0x54a996,_0x103bdf[_0x5108ba(0x1ce,0x271,0x163,0x21c)])){const _0x21983d={};for(const _0x1b6d1e in _0x54a996){_0x21983d[_0x1b6d1e]=_0x103bdf[_0x49617b(0x23b,0x328,0x279,0x2a0)](replacePlaceholder,_0x54a996[_0x1b6d1e],_0x3fdf15,_0x53ae7f,_0x5e7eca);}return _0x21983d;}return _0x54a996;}function attachImagesToMessage(_0x5dc95a,_0x544e5c,_0x2aea64,_0xb5d8ba=_0xaebf35(0xe,-0xcb,-0x66,-0x30)){const _0x5c6343={};_0x5c6343[_0x51f2d3(0x33d,0x346,0x376,0x312)]=function(_0xb8e87e,_0x4e9bd9){return _0xb8e87e===_0x4e9bd9;},_0x5c6343[_0x51f2d3(0x2da,0x349,0x2ca,0x35a)]=_0x51f2d3(0x2bc,0x214,0x35d,0x2cc),_0x5c6343[_0x25eb2c(0x4c2,0x4ca,0x56b,0x4c0)]=function(_0x1a043c,_0x3e9a75){return _0x1a043c===_0x3e9a75;},_0x5c6343[_0x25eb2c(0x598,0x535,0x5b6,0x59f)]=_0x25eb2c(0x4cd,0x43e,0x51d,0x4e2),_0x5c6343[_0x25eb2c(0x53b,0x568,0x5b6,0x5c9)]=function(_0x1721dd,_0x51eea9){return _0x1721dd+_0x51eea9;},_0x5c6343['GVduy']='data:',_0x5c6343[_0x51f2d3(0x2bb,0x335,0x277,0x315)]=function(_0x5bed3e,_0x246db1){return _0x5bed3e===_0x246db1;},_0x5c6343[_0x25eb2c(0x5f3,0x588,0x57d,0x5a5)]=_0x25eb2c(0x4b6,0x5a7,0x4b0,0x512),_0x5c6343[_0x51f2d3(0x2ea,0x296,0x268,0x31c)]=_0x51f2d3(0x34f,0x2e4,0x3ba,0x397),_0x5c6343[_0x51f2d3(0x326,0x3cf,0x3c4,0x3b8)]=function(_0x12a378,_0xd8669a){return _0x12a378>=_0xd8669a;},_0x5c6343[_0x51f2d3(0x318,0x34d,0x3bb,0x324)]=function(_0x365aad,_0x1d951e){return _0x365aad>_0x1d951e;};const _0x56e06e=_0x5c6343;if(!_0x2aea64||_0x2aea64[_0x51f2d3(0x31e,0x3a0,0x328,0x320)]===-0x17b+-0x2528+0xce1*0x3||_0x544e5c<-0x237+0x13f2+-0x11bb||_0x56e06e[_0x25eb2c(0x600,0x65b,0x5aa,0x5ba)](_0x544e5c,_0x5dc95a['length']))return _0x5dc95a;const _0x4f5bde=[..._0x5dc95a],_0x31c767=_0x4f5bde[_0x544e5c],_0x353f9a=[];if(typeof _0x31c767['content']===_0x56e06e[_0x25eb2c(0x534,0x590,0x4be,0x56e)]){const _0x334985={};_0x334985['type']=_0x25eb2c(0x5da,0x543,0x5dd,0x5b7),_0x334985['text']=_0x31c767['content'],_0x353f9a['push'](_0x334985);}else Array['isArray'](_0x31c767['content'])&&_0x353f9a[_0x25eb2c(0x59f,0x4e3,0x50c,0x587)](..._0x31c767[_0x25eb2c(0x544,0x561,0x50f,0x514)]);if(_0x56e06e[_0x25eb2c(0x5ba,0x510,0x5af,0x5ac)](_0x2aea64[_0x51f2d3(0x31e,0x2e6,0x3ac,0x2f9)],-0xc2*0x26+0x1315+0x9b7)){const _0x20f22a={};_0x20f22a[_0x51f2d3(0x301,0x2c3,0x31f,0x30a)]='text',_0x20f22a[_0x51f2d3(0x323,0x2f0,0x292,0x37b)]=_0x25eb2c(0x4b5,0x5b2,0x5b0,0x52f)+_0x2aea64[_0x51f2d3(0x31e,0x329,0x28b,0x322)]+'张'+_0xb5d8ba+']',_0x353f9a['push'](_0x20f22a);}function _0x25eb2c(_0x2b7853,_0x35ed91,_0x25cb2c,_0x55bb2a){return _0xaebf35(_0x2b7853-0x7a,_0x35ed91-0x4,_0x35ed91,_0x55bb2a-0x511);}_0x2aea64['forEach']((_0x2bb4ca,_0x4bd5f0)=>{const _0xe32bbf=_0x56e06e['eCwQL'](typeof _0x2bb4ca,_0x56e06e[_0x2efd1a(-0x4d,-0xb9,-0x165,-0xc)])?_0x2bb4ca:_0x2bb4ca[_0x3b6016(0x490,0x532,0x556,0x537)];function _0x3b6016(_0x25c09c,_0x21d5db,_0x5b031d,_0x5a9367){return _0x25eb2c(_0x25c09c-0x41,_0x5a9367,_0x5b031d-0x1d8,_0x21d5db- -0x1c);}const _0x111fb6=_0x56e06e[_0x2efd1a(-0x132,-0x167,-0x177,-0x147)](typeof _0x2bb4ca,_0x56e06e[_0x2efd1a(-0x63,-0x88,-0x16,-0x2d)])&&_0x2bb4ca[_0x2efd1a(-0x19e,-0x164,-0x1a9,-0x206)]?_0x2bb4ca[_0x2efd1a(-0x11e,-0x164,-0xfb,-0xc5)]:''+_0xb5d8ba+_0x56e06e[_0x2efd1a(-0x58,-0x5e,-0xe4,-0x9d)](_0x4bd5f0,0xaa6*0x2+0x1*-0x8ae+-0xc9d),_0x1bfcfe={};_0x1bfcfe[_0x2efd1a(-0x115,-0x92,-0xd3,-0xc6)]=_0x2efd1a(-0x97,-0x70,-0x31,-0x61);function _0x2efd1a(_0x394d4b,_0x1521c7,_0x39e729,_0x5e2fff){return _0x25eb2c(_0x394d4b-0x167,_0x39e729,_0x39e729-0x7a,_0x1521c7- -0x627);}_0x1bfcfe[_0x2efd1a(-0x21,-0x70,-0xa2,0x14)]='['+_0x111fb6+']',_0x353f9a[_0x3b6016(0x5f0,0x56b,0x50d,0x545)](_0x1bfcfe);let _0x5a81ad=_0xe32bbf;if(!_0xe32bbf[_0x2efd1a(-0x22c,-0x195,-0x1bc,-0x165)](_0x56e06e['GVduy'])){if(_0x56e06e[_0x2efd1a(-0x2c,-0xd8,-0x185,-0xd4)](_0x56e06e[_0x2efd1a(-0x6a,-0x82,-0xbe,0x24)],_0x2efd1a(-0xc1,-0x115,-0x73,-0x18c)))_0x5a81ad=_0x2efd1a(-0x175,-0x15d,-0x176,-0x111)+_0x3b6016(0x51f,0x549,0x57b,0x5ec)+'4,'+_0xe32bbf;else{const _0x24fb3c=_0x3317be?function(){function _0x7a1402(_0x44dcd4,_0x3c5bc1,_0x2cedca,_0xe86edb){return _0x2efd1a(_0x44dcd4-0x5a,_0x2cedca-0x2e,_0xe86edb,_0xe86edb-0x4);}if(_0xeb6d23){const _0x24cc90=_0x3515b0[_0x7a1402(-0x95,0x77,-0x14,-0xb0)](_0x3c2dd4,arguments);return _0x56a035=null,_0x24cc90;}}:function(){};return _0x195ecf=![],_0x24fb3c;}}const _0x4fb15a={};_0x4fb15a['url']=_0x5a81ad,_0x4fb15a[_0x2efd1a(-0x8f,-0x119,-0x82,-0xc6)]=_0x3b6016(0x5ab,0x52e,0x495,0x4f5);const _0x41ea37={};_0x41ea37[_0x2efd1a(0x17,-0x92,-0xec,-0x114)]=_0x56e06e[_0x2efd1a(-0xe,-0xa9,-0x61,-0x113)],_0x41ea37[_0x2efd1a(-0xd8,-0x44,-0x5a,-0x63)]=_0x4fb15a,_0x353f9a[_0x3b6016(0x503,0x56b,0x5a6,0x50d)](_0x41ea37);});const _0x16dca1={..._0x31c767};_0x16dca1[_0x25eb2c(0x525,0x569,0x4c3,0x514)]=_0x353f9a,_0x4f5bde[_0x544e5c]=_0x16dca1;function _0x51f2d3(_0x9f01af,_0x100c54,_0x21eabb,_0x1754f2){return _0xaebf35(_0x9f01af-0xb7,_0x100c54-0x167,_0x100c54,_0x9f01af-0x27d);}return _0x4f5bde;}function findMessageIndexWithPlaceholder(_0x51543f,_0x5b3358){const _0x68133a={};_0x68133a[_0x59cb32(0x1b9,0x227,0x1bb,0x1e9)]=_0x2268d6(-0xc3,-0x8d,-0x51,-0xdd)+'内容',_0x68133a[_0x59cb32(0x212,0x24d,0x23b,0x261)]=function(_0x1cafee,_0x5bd0ca){return _0x1cafee===_0x5bd0ca;},_0x68133a['tmDmM']='string',_0x68133a[_0x59cb32(0x23f,0x2bb,0x226,0x21d)]='object',_0x68133a[_0x2268d6(0x6d,0x20,0x1,0x1c)]=function(_0xbec35a,_0x4ccc42){return _0xbec35a+_0x4ccc42;};function _0x2268d6(_0x1b2459,_0x1873cd,_0x3beb30,_0x4670a6){return _0xaebf35(_0x1b2459-0xf3,_0x1873cd-0x5,_0x1873cd,_0x4670a6- -0x7b);}_0x68133a[_0x2268d6(-0x8f,-0x12b,-0x159,-0xc5)]=_0x59cb32(0x169,0x200,0x1c5,0x236),_0x68133a[_0x59cb32(0x165,0x174,0x16a,0x1d6)]=_0x2268d6(0x6f,-0xc,0xd6,0x57),_0x68133a[_0x2268d6(-0x77,-0xac,-0xbc,-0x46)]=_0x2268d6(-0xd9,-0x2a,0x35,-0x42),_0x68133a['cfwDT']=function(_0x20c24b,_0x3748a0){return _0x20c24b<_0x3748a0;},_0x68133a['LpCOd']=function(_0x25813b,_0x5c6202){return _0x25813b===_0x5c6202;},_0x68133a[_0x2268d6(-0x1b,-0x55,-0x16b,-0xb8)]=_0x2268d6(-0xdb,-0x33,-0xb5,-0x38),_0x68133a[_0x59cb32(0x1cb,0x219,0x169,0x218)]='vLzLk',_0x68133a['MjVqo']=_0x59cb32(0x26b,0x252,0x209,0x1ce);function _0x59cb32(_0x331443,_0x1a9952,_0x707b38,_0x14b5a8){return _0xaebf35(_0x331443-0xa4,_0x1a9952-0x2c,_0x14b5a8,_0x707b38-0x163);}const _0x780bad=_0x68133a;for(let _0x3add7c=0x1*-0x150b+-0x3eb*-0x5+-0x174*-0x1;_0x780bad[_0x2268d6(0x21,0x5d,0x71,-0x25)](_0x3add7c,_0x51543f[_0x2268d6(0x1f,0xca,-0x6a,0x26)]);_0x3add7c++){const _0x227522=_0x51543f[_0x3add7c];if(_0x780bad['LpCOd'](typeof _0x227522[_0x2268d6(-0xf1,0x33,-0xdf,-0x78)],_0x780bad[_0x59cb32(0x1a0,0x2a9,0x225,0x209)])&&_0x227522[_0x2268d6(-0x100,-0x32,-0xe9,-0x78)][_0x59cb32(0xee,0x1ff,0x16d,0xe6)](_0x5b3358)){if(_0x780bad[_0x59cb32(0x101,0xa0,0x126,0x79)]===_0x780bad[_0x2268d6(-0xcc,-0x45,-0x75,-0xb8)])return _0x3add7c;else{_0x2fd539[_0x59cb32(0x1a2,0x17e,0xf1,0x69)](_0x780bad['rzvau']);return;}}else{if(Array['isArray'](_0x227522[_0x2268d6(-0x56,0x14,-0x4a,-0x78)])){if(_0x780bad[_0x2268d6(0x89,0x74,0xc7,0x5d)](_0x780bad[_0x2268d6(-0x10f,-0x119,-0x7e,-0x75)],_0x780bad[_0x59cb32(0x1b0,0x134,0x169,0x1cc)]))for(const _0x2e044f of _0x227522[_0x2268d6(-0x81,-0xfd,-0xe9,-0x78)]){if(_0x2e044f['type']===_0x780bad[_0x2268d6(-0x3c,-0x5c,-0x6c,-0xb7)]&&_0x2e044f[_0x2268d6(0x38,0x80,-0x13,0x2b)][_0x59cb32(0xc6,0x182,0x16d,0xd4)](_0x5b3358))return _0x3add7c;}else{const _0x195109=_0x780bad[_0x59cb32(0x1c6,0x2a6,0x23b,0x1bf)](typeof _0x1ff764,_0x780bad[_0x59cb32(0x1e2,0x261,0x225,0x235)])?_0x317285:_0x54697d[_0x2268d6(-0x9d,0x40,-0x70,-0x3e)],_0x1f0c8e=_0x780bad[_0x2268d6(0xf9,0x100,0xd0,0x5d)](typeof _0x3f3345,_0x780bad[_0x2268d6(-0x5c,0x88,0x81,0x48)])&&_0x51ac55[_0x59cb32(0x81,0x17a,0x115,0xb7)]?_0x680642[_0x59cb32(0x1a4,0xcb,0x115,0x101)]:''+_0x34fa76+_0x780bad[_0x59cb32(0x1d0,0x1e9,0x1fa,0x166)](_0x3916b5,0x1f2f+-0x1210+0x68f*-0x2),_0x3dc0ab={};_0x3dc0ab['type']=_0x59cb32(0x177,0x1d5,0x209,0x1fd),_0x3dc0ab['text']='['+_0x1f0c8e+']',_0xfebeca[_0x59cb32(0x20b,0x201,0x1d9,0x135)](_0x3dc0ab);let _0x3f634d=_0x195109;!_0x195109[_0x2268d6(-0x10c,-0xb8,-0x15a,-0xfa)](_0x780bad[_0x2268d6(-0x109,-0xb9,-0xc9,-0xc5)])&&(_0x3f634d=_0x59cb32(0x13a,0xd2,0x11c,0xb7)+_0x2268d6(0x47,0x58,0x37,-0x27)+'4,'+_0x195109);const _0x575883={};_0x575883['type']=_0x780bad[_0x2268d6(-0xfb,-0x5b,-0x1,-0x74)],_0x575883[_0x59cb32(0x1eb,0x19f,0x235,0x1c2)]={},_0x575883[_0x59cb32(0x1eb,0x19f,0x235,0x1c2)]['url']=_0x3f634d,_0x575883[_0x59cb32(0x1eb,0x19f,0x235,0x1c2)]['detail']=_0x780bad[_0x59cb32(0x14f,0x218,0x198,0x23d)],_0x5506a2[_0x2268d6(0x7c,-0xb3,0x20,-0x5)](_0x575883);}}}}return-(-0x24c3+0x140b+0x1*0x10b9);}function generateRequestId(){function _0x47e57b(_0x4ded2e,_0x37d381,_0xb15220,_0x1d1b01){return _0xaebf35(_0x4ded2e-0xa0,_0x37d381-0x1e7,_0x37d381,_0x4ded2e-0x314);}const _0x3a77aa={'jazys':function(_0x3d1dc4,_0x3d3049){return _0x3d1dc4(_0x3d3049);},'ZNbVb':function(_0x5dbb4a,_0x401f1f){return _0x5dbb4a===_0x401f1f;},'uTaTW':_0x47e57b(0x3a4,0x43d,0x36f,0x32c),'CQBzS':function(_0x29aa29,_0x28152b){return _0x29aa29+_0x28152b;}};if(crypto&&crypto[_0x51ec7e(0x81,0x90,0x13c,0x2b)]){if(_0x3a77aa[_0x51ec7e(0x39,0xad,0x78,0xb)](_0x3a77aa[_0x47e57b(0x2ac,0x2e2,0x25c,0x2bb)],_0x3a77aa[_0x47e57b(0x2ac,0x33e,0x2d6,0x276)]))return crypto[_0x51ec7e(-0x15,0x90,0xe9,0xdc)]();else{if(_0x444273[_0x16ad17]){const _0x3b27ca=_0x4b0d14[_0x47e57b(0x29e,0x2ee,0x344,0x24e)+_0x47e57b(0x29a,0x2eb,0x2fd,0x238)](_0x47e57b(0x3ce,0x447,0x373,0x40c)+_0xb1970c);_0x3b27ca&&(_0x3b27ca[_0x51ec7e(0x59,0x7f,-0x2b,0xec)]=_0x2b3c62[_0x18cf28],_0x3a77aa[_0x51ec7e(0x7c,0x123,0x162,0x81)](_0x53bed3,_0x3b27ca)['trigger']('input'));}}}function _0x51ec7e(_0x33f3b3,_0x56c215,_0x206364,_0x2880af){return _0xaebf35(_0x33f3b3-0x7b,_0x56c215-0x19b,_0x2880af,_0x56c215-0x92);}return _0x3a77aa['CQBzS'](Date[_0x51ec7e(0x129,0xb8,0xc9,0x11f)]()[_0x51ec7e(-0x26,0x27,0x4c,-0x3c)](-0x94*0x38+0x25e3+-0xb*0x7d),Math['random']()[_0x47e57b(0x2a9,0x282,0x357,0x2ea)](-0x15bf+-0x11b9+0x5*0x7ec)[_0x51ec7e(0xd1,0x12b,0xfd,0x8f)](-0x1be0+0x12ea*-0x1+0xbb3*0x4));}export function LLM_CHAR_MODIFY_GET_PROMPT(){const _0x47606c={'WlaJt':function(_0x47732d,_0x59a497){return _0x47732d(_0x59a497);},'lDxpL':_0x1c4c36(-0x124,-0xd3,-0x98,-0x76)+'时','AVTOI':function(_0x1cdaf8,_0x82765b){return _0x1cdaf8!==_0x82765b;},'EdKxo':'tOJvf','jPakP':function(_0x1575a6){return _0x1575a6();},'gUgsM':function(_0x4ecdab,_0x48f0f9,_0x2589e8){return _0x4ecdab(_0x48f0f9,_0x2589e8);}};function _0x1c4c36(_0x27d24a,_0x19f00e,_0x1be3d4,_0x557a5c){return _0xaebf35(_0x27d24a-0x109,_0x19f00e-0x173,_0x1be3d4,_0x557a5c- -0x8a);}return new Promise((_0x1d34c2,_0x5d06eb)=>{function _0x322a21(_0x1a03f6,_0x1bdbf1,_0x2d132d,_0x320f7a){return _0x1c4c36(_0x1a03f6-0xe9,_0x1bdbf1-0x8c,_0x1bdbf1,_0x2d132d-0x7b);}const _0xd9bf3c={'HDEvC':function(_0x23e729,_0x3a1441){function _0x1f1e5e(_0x397b7b,_0x2d423f,_0x230ebb,_0x48cf2b){return _0x1551(_0x230ebb- -0x1ba,_0x2d423f);}return _0x47606c[_0x1f1e5e(-0x90,-0x69,-0x87,-0x118)](_0x23e729,_0x3a1441);}};function _0x5598ed(_0x3a3970,_0x3ce01f,_0x187a93,_0x4a0850){return _0x1c4c36(_0x3a3970-0x99,_0x3ce01f-0x10d,_0x4a0850,_0x3a3970-0x381);}if(_0x47606c[_0x5598ed(0x2a7,0x23f,0x261,0x21c)](_0x47606c[_0x5598ed(0x3ae,0x398,0x335,0x342)],_0x47606c[_0x322a21(0x6f,0x116,0xa8,0x134)]))return _0x24d50f;else{const _0x3e9a57=_0x47606c[_0x5598ed(0x357,0x38f,0x2ae,0x3c1)](generateRequestId);console[_0x5598ed(0x299,0x348,0x314,0x210)](_0x322a21(-0x66,0x4,0x0,0x81)+_0x322a21(0x5,0x52,-0xd,0x50)+_0x5598ed(0x375,0x38e,0x3d5,0x3e9)+_0x322a21(0x3,-0x3c,0x6e,-0x18)+_0x5598ed(0x28a,0x1f1,0x2d4,0x274)+'mpt\x20(ID:\x20'+_0x3e9a57+')');const _0x41855d=_0x190202=>{function _0x5a95bd(_0x24b697,_0x18296e,_0x5e28a4,_0x176e5a){return _0x5598ed(_0x24b697- -0x165,_0x18296e-0x83,_0x5e28a4-0xe2,_0x176e5a);}if(_0x190202['id']!==_0x3e9a57)return;function _0x388f0c(_0x11f7f7,_0x19a36a,_0x360b42,_0x7fbf8e){return _0x322a21(_0x11f7f7-0x61,_0x360b42,_0x7fbf8e- -0x19f,_0x7fbf8e-0x12f);}eventSource[_0x5a95bd(0x158,0x1a2,0x13c,0x1d4)+'ener'](eventNames['LLM_CHAR_M'+_0x388f0c(-0x224,-0x1f2,-0x192,-0x1bb)+_0x388f0c(-0x1d6,-0x1e6,-0x284,-0x1d5)+_0x5a95bd(0x111,0x166,0x199,0x1c0)],_0x41855d),_0xd9bf3c[_0x5a95bd(0x173,0xf2,0x13b,0x12e)](_0x1d34c2,_0x190202['prompt']);};eventSource['on'](eventNames[_0x5598ed(0x294,0x250,0x202,0x224)+_0x5598ed(0x2ea,0x318,0x303,0x357)+_0x5598ed(0x2d0,0x247,0x26e,0x31f)+'PONSE'],_0x41855d);const _0x34e908={};_0x34e908['id']=_0x3e9a57,eventSource[_0x322a21(0x15a,0x163,0xc4,0x12d)](eventNames[_0x5598ed(0x294,0x2f8,0x2f2,0x241)+_0x5598ed(0x2ea,0x364,0x37b,0x2ef)+'PROMPT_REQ'+_0x322a21(0x3f,-0x5,-0x44,0x20)],_0x34e908),_0x47606c[_0x322a21(0xb5,0x31,0x20,0x45)](setTimeout,()=>{function _0x194876(_0x5d3cc0,_0x4701d3,_0x13f4a1,_0x48a294){return _0x5598ed(_0x4701d3- -0x425,_0x4701d3-0xa2,_0x13f4a1-0xe4,_0x48a294);}eventSource[_0x113b97(0x121,0x1a9,0x11e,0x17e)+_0x194876(-0x44,-0x69,-0x59,-0x36)](eventNames['LLM_CHAR_M'+_0x194876(-0x1d7,-0x13b,-0x1bd,-0x103)+'PROMPT_RES'+'PONSE'],_0x41855d);function _0x113b97(_0x328fb4,_0x135cb2,_0x4e3ed6,_0x3147f2){return _0x5598ed(_0x3147f2- -0x13f,_0x135cb2-0xbc,_0x4e3ed6-0x12e,_0x135cb2);}_0x47606c[_0x113b97(0x1d1,0xe6,0xf0,0x170)](_0x5d06eb,new Error(_0x47606c[_0x194876(-0x212,-0x172,-0xd9,-0x1d6)]));},-0x89a+-0x2300+0x52aa);}});}export function LLM_CHAR_MODIFY(_0x43eb5b,_0x153e2a={}){function _0x541981(_0x1714a5,_0x38b7c0,_0x7089,_0x32c3d6){return _0xaebf35(_0x1714a5-0x140,_0x38b7c0-0xcd,_0x1714a5,_0x7089-0x4fc);}const _0x3bd3d4={'mkGIL':function(_0x2c9644,_0x55d508){return _0x2c9644!==_0x55d508;},'ZcDoL':_0x541981(0x5d9,0x4cd,0x553,0x5b3),'zvyxm':function(_0x240f25){return _0x240f25();},'lVZnJ':_0x541981(0x4dc,0x57f,0x560,0x5d1),'rLVkT':function(_0x867834,_0x231ddf){return _0x867834(_0x231ddf);},'gSxJm':function(_0x1eab1a){return _0x1eab1a();}};function _0x3a1b32(_0x2cd5f4,_0x3b37bf,_0x214504,_0x31ee68){return _0xaebf35(_0x2cd5f4-0x6d,_0x3b37bf-0x1e6,_0x214504,_0x3b37bf-0x108);}return new Promise((_0x2f6d9f,_0x3abdb6)=>{const _0x74d966={'wVkfg':function(_0x42cc64,_0x3d090b){return _0x3bd3d4['mkGIL'](_0x42cc64,_0x3d090b);},'mlFPy':_0x11f4d8(0x140,0x1e3,0x1e5,0xb5),'ueTKC':_0x3bd3d4[_0x11f4d8(0x139,0x129,0x1d8,0x19e)],'DFvng':function(_0x3a5008){function _0x111219(_0x36de94,_0x4699a5,_0xc78561,_0x2083fc){return _0x94fd9f(_0x2083fc,_0x4699a5-0x9c,_0x36de94-0x26e,_0x2083fc-0x2c);}return _0x3bd3d4[_0x111219(0x130,0x18e,0x8b,0x1a2)](_0x3a5008);},'vUiJI':function(_0x14fe37,_0x5f3ff5){return _0x14fe37(_0x5f3ff5);},'JCyaH':_0x94fd9f(0x88,0x13,-0x1c,-0x73),'oYvJc':function(_0x9c5a1,_0x372657){return _0x9c5a1(_0x372657);},'lSlaE':_0x3bd3d4[_0x94fd9f(-0xe5,-0x1a8,-0x115,-0x1ba)],'srJmV':function(_0x40728b){return _0x40728b();},'FKrWG':function(_0xc475ae,_0x3adb64){function _0x55a442(_0x1d027d,_0x55aba8,_0x1aaac0,_0x51e559){return _0x94fd9f(_0x55aba8,_0x55aba8-0x1cd,_0x1d027d-0x5fa,_0x51e559-0x166);}return _0x3bd3d4[_0x55a442(0x4c8,0x4a3,0x574,0x525)](_0xc475ae,_0x3adb64);}},_0x50b942=_0x3bd3d4['gSxJm'](generateRequestId),_0x3ad316=_0x153e2a[_0x11f4d8(0x12e,0x10a,0x1d5,0xc4)]||0x76bd+-0x22*0x43b+0x10379;let _0x338d12=null;console[_0x94fd9f(-0x124,-0x1a1,-0x119,-0x9c)](_0x11f4d8(0x12c,0x1dd,0x85,0x16f)+_0x11f4d8(0x11f,0x1a0,0x1c4,0x13f)+'fy]\x20Execut'+_0x94fd9f(-0xd9,-0x92,-0x34,-0x66)+'odify\x20LLM\x20'+_0x94fd9f(-0x14e,-0x26,-0xc2,-0xcd)+'D:\x20'+_0x50b942+')');const _0x5df13d=()=>{function _0x2e3a77(_0x3cf2f1,_0x3e01a5,_0x5b1bc3,_0x5a5979){return _0x94fd9f(_0x5a5979,_0x3e01a5-0x17,_0x5b1bc3- -0x38,_0x5a5979-0x1e1);}function _0x1b83d4(_0x3302a3,_0x1254fc,_0x138f3e,_0x52d5a2){return _0x11f4d8(_0x1254fc- -0x2d,_0x1254fc-0xf0,_0x3302a3,_0x52d5a2-0x13a);}eventSource['removeList'+_0x1b83d4(0x16a,0x1b5,0x118,0x12e)](eventNames[_0x2e3a77(-0xdb,-0xea,-0x156,-0xce)+_0x1b83d4(0x10a,0x6a,-0x12,-0x1f)+_0x1b83d4(0x5e,0xfc,0x55,0x184)],_0x2861b4),_0x338d12&&(_0x74d966[_0x1b83d4(0x173,0x120,0xb4,0xb2)](_0x74d966['mlFPy'],_0x74d966['ueTKC'])?(clearTimeout(_0x338d12),_0x338d12=null):_0x4195b7(_0x246a5d));},_0x2861b4=_0x525b86=>{const _0x1ee53d={};_0x1ee53d[_0x3d6cb8(0x2c0,0x331,0x2c3,0x22d)]=_0x3d6cb8(0x26c,0x329,0x2b7,0x2ac);const _0x5da80f=_0x1ee53d;if(_0x525b86['id']!==_0x50b942)return;function _0x3d6cb8(_0x5ef4f9,_0x440481,_0x584ea8,_0x52625a){return _0x94fd9f(_0x52625a,_0x440481-0x156,_0x584ea8-0x2cc,_0x52625a-0x2b);}_0x74d966[_0x3d6cb8(0x213,0x180,0x1e8,0x24a)](_0x5df13d);function _0x35e25(_0x470cd7,_0x97c2ee,_0x3e72ac,_0x42a3d1){return _0x94fd9f(_0x470cd7,_0x97c2ee-0x1d6,_0x97c2ee-0x37c,_0x42a3d1-0x92);}if(_0x525b86[_0x3d6cb8(0x27a,0x2fe,0x2cc,0x368)])_0x74d966[_0x35e25(0x313,0x36e,0x3d1,0x320)](_0x2f6d9f,_0x525b86[_0x3d6cb8(0x321,0x22e,0x28c,0x30e)]);else{if(_0x74d966[_0x35e25(0x2bd,0x343,0x39b,0x337)]===_0x35e25(0x2e0,0x25b,0x25b,0x218)){const _0x2a5f36={};_0x2a5f36[_0x35e25(0x3a0,0x345,0x304,0x321)]=_0x5da80f[_0x3d6cb8(0x32d,0x28d,0x2c3,0x286)],_0x2a5f36[_0x35e25(0x354,0x367,0x356,0x2bb)]=_0x35e25(0x360,0x2df,0x2d4,0x282)+_0x6771e0[_0x3d6cb8(0x259,0x316,0x2b2,0x29f)]+'张'+_0x854f05+']',_0x493012[_0x3d6cb8(0x1eb,0x2b0,0x287,0x211)](_0x2a5f36);}else _0x74d966['oYvJc'](_0x3abdb6,new Error(_0x525b86['result']||_0x74d966[_0x35e25(0x30a,0x2e1,0x344,0x2d0)]));}};eventSource['on'](eventNames['LLM_CHAR_M'+_0x94fd9f(-0x194,-0x117,-0x141,-0x1cb)+_0x11f4d8(0x129,0x165,0x170,0x7c)],_0x2861b4);function _0x94fd9f(_0x255ba0,_0x556caa,_0x39ae16,_0x5cdb17){return _0x3a1b32(_0x255ba0-0x158,_0x39ae16- -0x1c3,_0x255ba0,_0x5cdb17-0x85);}const _0x1a24bd={};function _0x11f4d8(_0x2d672e,_0x315260,_0x37c76e,_0x461070){return _0x541981(_0x37c76e,_0x315260-0x165,_0x2d672e- -0x3df,_0x461070-0x9c);}_0x1a24bd[_0x94fd9f(-0x1d7,-0x122,-0x129,-0xe2)]=_0x43eb5b,_0x1a24bd['id']=_0x50b942,eventSource[_0x11f4d8(0x1f0,0x14f,0x20a,0x20f)](eventNames[_0x94fd9f(-0x110,-0x7d,-0x11e,-0xbd)+'ODIFY_REQU'+'EST'],_0x1a24bd),_0x338d12=setTimeout(()=>{function _0x29fd8f(_0x2c8fe1,_0x4628f8,_0xb51fda,_0x465f2e){return _0x11f4d8(_0x4628f8- -0x83,_0x4628f8-0x19,_0xb51fda,_0x465f2e-0x1df);}_0x74d966[_0x4d87e9(0x3b2,0x3fb,0x2c3,0x371)](_0x5df13d);function _0x4d87e9(_0x4630eb,_0x2f2565,_0x5effd7,_0x10d05c){return _0x11f4d8(_0x10d05c-0x2d4,_0x2f2565-0x17,_0x4630eb,_0x10d05c-0x6c);}_0x74d966[_0x4d87e9(0x3ac,0x3e8,0x33e,0x395)](_0x3abdb6,new Error(_0x4d87e9(0x55b,0x53a,0x436,0x4c1)+_0x29fd8f(0x1c4,0x15e,0xb1,0x1f5)));},_0x3ad316);});}function preprocessTagContent(_0x4fb375){const _0x14d7e5={};_0x14d7e5['CefDZ']=_0x212279(0x4ec,0x55b,0x57d,0x471);const _0x533345=_0x14d7e5;let _0x42f557=_0x4fb375[_0x212279(0x49c,0x4a7,0x48e,0x543)](/:/g,':')[_0x212279(0x49c,0x52a,0x4bc,0x4fd)](/\(/g,'（')[_0x5ecb08(0x24e,0x2f9,0x1fd,0x284)](/\)/g,'）')[_0x212279(0x49c,0x4fe,0x4c8,0x4e2)](/,/g,',');function _0x212279(_0x1ec7e4,_0x24c30b,_0x1bef73,_0x99be54){return _0xaebf35(_0x1ec7e4-0x140,_0x24c30b-0x98,_0x99be54,_0x1ec7e4-0x518);}_0x42f557=_0x42f557[_0x212279(0x49c,0x45c,0x4bb,0x413)](/下半身NSWebcam:/g,_0x533345['CefDZ']),_0x42f557=_0x42f557[_0x212279(0x49c,0x4c6,0x54c,0x44f)](/下半身NSFW_背面:/g,_0x533345[_0x212279(0x5d6,0x686,0x585,0x5a2)]),_0x42f557=_0x42f557[_0x5ecb08(0x24e,0x256,0x2b2,0x224)](/上半身NSFW_背面:/g,_0x212279(0x5cc,0x529,0x5c1,0x5d0));function _0x5ecb08(_0x58aab9,_0x2c44d9,_0x49ef55,_0x309f85){return _0xaebf35(_0x58aab9-0x1ba,_0x2c44d9-0x9d,_0x2c44d9,_0x58aab9-0x2ca);}return _0x42f557;}function parseCharacterData(_0x2cd427){const _0x49266e={};_0x49266e[_0x512570(0x34f,0x482,0x3d7,0x390)]=_0x512570(0x2e6,0x273,0x314,0x2b2),_0x49266e[_0x27d457(0x479,0x5af,0x4b5,0x52c)]='facialFeat'+'ures',_0x49266e[_0x27d457(0x55d,0x5a6,0x5c2,0x5ab)]=_0x27d457(0x495,0x4dd,0x594,0x504)+_0x512570(0x38a,0x307,0x390,0x376),_0x49266e['gFcPi']=_0x512570(0x2fd,0x3d8,0x3a7,0x40f)+'FW',_0x49266e[_0x512570(0x41b,0x409,0x3be,0x44b)]='fullBodySF'+'WBack',_0x49266e[_0x512570(0x3a5,0x2e6,0x339,0x293)]=_0x512570(0x27d,0x34d,0x30c,0x2d6)+'SFW',_0x49266e[_0x512570(0x262,0x2e3,0x2ff,0x274)]=_0x27d457(0x50d,0x495,0x4eb,0x4d2)+_0x27d457(0x62e,0x61e,0x66b,0x5d3),_0x49266e[_0x27d457(0x506,0x54a,0x49a,0x53c)]=_0x512570(0x3b2,0x4bb,0x421,0x49f)+'FW',_0x49266e[_0x27d457(0x4da,0x570,0x4a0,0x546)]='fullBodyNS'+_0x27d457(0x521,0x45f,0x530,0x50e);function _0x27d457(_0x1c700e,_0xbeda7e,_0x48fdf0,_0x2c2f52){return _0xaebf35(_0x1c700e-0xf7,_0xbeda7e-0x1bc,_0xbeda7e,_0x2c2f52-0x531);}_0x49266e[_0x27d457(0x5cd,0x60b,0x5b1,0x5f0)]=function(_0x5b8cda,_0x3afd61){return _0x5b8cda===_0x3afd61;},_0x49266e[_0x512570(0x301,0x405,0x360,0x398)]='awdpI',_0x49266e['WGcPm']='pjmpI',_0x49266e[_0x27d457(0x5c2,0x50a,0x5f4,0x5aa)]='VzFjS',_0x49266e['bDcxZ']='[character'+_0x27d457(0x484,0x51d,0x582,0x533)+_0x512570(0x33b,0x309,0x39e,0x343)+_0x27d457(0x4ef,0x5ac,0x5c9,0x571);const _0x401f91=_0x49266e,_0x4652c1=_0x2cd427['split']('\x0a')[_0x512570(0x2d5,0x38a,0x334,0x2b7)](_0x1f12c7=>_0x1f12c7['trim']())[_0x27d457(0x54b,0x5fb,0x5eb,0x59c)](_0x2b2e53=>_0x2b2e53),_0x15d0de={};function _0x512570(_0x3f65a3,_0x536916,_0x455005,_0x5c4fbc){return _0xaebf35(_0x3f65a3-0x50,_0x536916-0xc0,_0x3f65a3,_0x455005-0x36b);}_0x15d0de[_0x512570(0x400,0x42b,0x41b,0x381)]='',_0x15d0de[_0x27d457(0x566,0x57d,0x519,0x4da)]='',_0x15d0de['facialFeat'+_0x27d457(0x5ac,0x559,0x4f9,0x55d)]='',_0x15d0de[_0x27d457(0x57e,0x57a,0x52b,0x504)+_0x27d457(0x539,0x4ab,0x53e,0x556)]='',_0x15d0de['upperBodyS'+'FW']='',_0x15d0de[_0x27d457(0x59a,0x555,0x5c1,0x56d)+'FWBack']='',_0x15d0de[_0x512570(0x373,0x39e,0x32d,0x326)+'W']='',_0x15d0de['fullBodySF'+_0x512570(0x396,0x431,0x399,0x352)]='',_0x15d0de['upperBodyN'+_0x512570(0x384,0x2dc,0x361,0x3e3)]='',_0x15d0de['upperBodyN'+_0x512570(0x3fd,0x45b,0x40d,0x493)]='',_0x15d0de['fullBodyNS'+'FW']='',_0x15d0de[_0x512570(0x3c3,0x37c,0x421,0x410)+_0x27d457(0x4be,0x48a,0x56d,0x50e)]='';const _0x51d5e3=_0x15d0de,_0x42c2f1={};_0x42c2f1[_0x512570(0x367,0x362,0x31c,0x29e)]='nameCN',_0x42c2f1[_0x512570(0x36a,0x36c,0x398,0x375)]=_0x401f91[_0x512570(0x326,0x3d0,0x3d7,0x3dc)],_0x42c2f1[_0x27d457(0x4d6,0x54f,0x4cf,0x53f)]=_0x401f91['naTXM'],_0x42c2f1['五官外貌背面']=_0x401f91[_0x512570(0x343,0x478,0x3e5,0x47e)],_0x42c2f1['上半身SFW']=_0x401f91['gFcPi'],_0x42c2f1['上半身SFW背面']=_0x512570(0x43f,0x388,0x3a7,0x36a)+_0x512570(0x379,0x2bc,0x348,0x3d9),_0x42c2f1[_0x512570(0x43c,0x46a,0x3fa,0x364)]=_0x27d457(0x531,0x4e2,0x46b,0x4f3)+'W',_0x42c2f1['下半身SFW背面']=_0x401f91[_0x512570(0x44a,0x377,0x3be,0x348)],_0x42c2f1[_0x512570(0x338,0x3d4,0x365,0x3bd)]=_0x401f91['XiMvf'],_0x42c2f1[_0x27d457(0x477,0x4ef,0x4fc,0x4f1)]=_0x401f91[_0x27d457(0x552,0x485,0x4af,0x4c5)],_0x42c2f1[_0x512570(0x2f4,0x391,0x328,0x30f)]=_0x401f91['VbQKX'],_0x42c2f1['下半身NSFW背面']=_0x401f91[_0x27d457(0x57e,0x4dc,0x513,0x546)];const _0x462929=_0x42c2f1;for(const _0x436cd2 of _0x4652c1){if(_0x401f91[_0x512570(0x3dc,0x458,0x42a,0x384)](_0x401f91[_0x27d457(0x5d2,0x53e,0x4ff,0x526)],_0x401f91['WGcPm']))_0x3e36ea[_0x512570(0x36b,0x324,0x345,0x335)]['push'](_0x42f096);else{const _0xabcdee=_0x436cd2['indexOf'](':');if(_0xabcdee===-(0x25a*0x2+0x8*0x61+-0x7bb))continue;const _0x50a35e=_0x436cd2[_0x512570(0x46b,0x450,0x404,0x426)](-0xf*-0x8e+-0xc43+0x3f1,_0xabcdee)[_0x512570(0x3c8,0x4ac,0x40e,0x49d)](),_0xf2793d=_0x436cd2[_0x27d457(0x5ca,0x578,0x596,0x5ca)](_0xabcdee+(-0x489*0x3+0x123b*0x1+-0x49f))['trim']();if(_0x462929[_0x50a35e])_0x51d5e3[_0x462929[_0x50a35e]]=_0xf2793d;else _0x50a35e&&_0xf2793d&&console[_0x512570(0x2dc,0x297,0x30d,0x2ed)]('[character'+'PromptModi'+_0x27d457(0x614,0x532,0x52f,0x578)+_0x512570(0x3f3,0x3cd,0x35d,0x3e3)+_0x50a35e+'\x22');}}if(!_0x51d5e3[_0x27d457(0x637,0x601,0x5c7,0x5e1)]){if(_0x401f91[_0x512570(0x46a,0x345,0x3e4,0x3a0)]!==_0x401f91[_0x27d457(0x562,0x53b,0x643,0x5aa)]){const _0x2e4df5={};_0x2e4df5[_0x512570(0x3cf,0x450,0x3ef,0x3b2)]=_0x27d457(0x54e,0x681,0x639,0x5d7),_0x2e4df5[_0x27d457(0x5e3,0x627,0x554,0x5d7)]=_0x253b77[_0x512570(0x327,0x3f6,0x36e,0x330)],_0x2fc56e[_0x27d457(0x52c,0x613,0x60c,0x5a7)](_0x2e4df5);}else return null;}return console[_0x27d457(0x4c6,0x51e,0x4e5,0x4d3)](_0x401f91['bDcxZ'],_0x51d5e3),_0x51d5e3;}function extractCharacterTags(_0x2040d8){function _0x30d380(_0x59dba5,_0x256afe,_0x23e172,_0x5cd680){return _0xaebf35(_0x59dba5-0x1b8,_0x256afe-0x48,_0x59dba5,_0x23e172-0x35);}const _0x27b444={'HLPjq':_0x32ef37(-0x4d,-0x31,-0x133,-0xa8)+'+$','YjtZu':function(_0x539475,_0x1e8f90){return _0x539475(_0x1e8f90);},'fIQUA':_0x30d380(-0x93,-0x4e,-0x11,-0x23)},_0x5be144={};_0x5be144[_0x32ef37(-0xbe,-0xed,-0xbe,-0x138)]=[];const _0x5225c1=_0x5be144;function _0x32ef37(_0x516b36,_0xb2e153,_0x56b741,_0x147ef1){return _0xaebf35(_0x516b36-0xb7,_0xb2e153-0x86,_0x56b741,_0x147ef1- -0x112);}_0x2040d8=_0x2040d8[_0x30d380(-0xa,-0xef,-0x47,0x9)](/<thinking>[\s\S]*?<\/thinking>/gi,'')[_0x32ef37(-0x19,-0xe1,-0xd9,-0x6f)]();const _0x274fdb=/<人物>([\s\S]*?)<\/人物>/g;let _0x1b3896;while((_0x1b3896=_0x274fdb[_0x32ef37(-0x213,-0x1b2,-0x1f2,-0x181)](_0x2040d8))!==null){const _0x1a771e=preprocessTagContent(_0x1b3896[0x1acf+-0x1113+0x2f*-0x35]),_0x218957=_0x27b444[_0x32ef37(0x16,-0x14,-0x5e,-0x8d)](parseCharacterData,_0x1a771e);if(_0x218957){if(_0x27b444['fIQUA']!==_0x27b444[_0x30d380(0xd2,0xb6,0x98,0x143)])return _0x486927[_0x32ef37(-0x14c,-0x215,-0x1fb,-0x17d)]()[_0x32ef37(-0xfa,-0x8d,0x12,-0x9f)](untQxq['HLPjq'])[_0x30d380(0x15,-0x70,-0x36,-0x8a)]()[_0x32ef37(-0x102,-0x139,-0x3d,-0xe0)+'r'](_0xa5d166)['search'](untQxq['HLPjq']);else _0x5225c1['characters'][_0x30d380(0xa6,0x118,0xab,0xfb)](_0x218957);}}return _0x5225c1;}function getCurrentCharacterPreset(){const _0x144548={};_0x144548['KquNF']=_0x3e8210(-0x69,0x85,0x7a,-0x1f),_0x144548[_0x3e8210(0x95,-0x3b,-0x1f,-0xb)]=_0x3e8210(0x127,0xb3,0x28,0xc0);function _0x3e8210(_0x2dcd51,_0x507804,_0x566b92,_0x395f52){return _0xaebf35(_0x2dcd51-0x1b,_0x507804-0x16f,_0x507804,_0x395f52- -0x7);}const _0x255472=_0x144548,_0x13f3a3=extension_settings[extensionName];function _0x5b3f1b(_0x57bea8,_0x244e6b,_0x3cba15,_0x22df77){return _0xaebf35(_0x57bea8-0x4c,_0x244e6b-0x151,_0x244e6b,_0x3cba15-0x495);}const _0x3b722f=_0x13f3a3[_0x3e8210(0x98,-0x53,0x14,0xc)+_0x5b3f1b(0x3d7,0x498,0x43d,0x486)];if(!_0x3b722f||!_0x13f3a3[_0x3e8210(-0x12,-0xa3,-0x91,0xc)+_0x5b3f1b(0x4c9,0x4d8,0x4ef,0x4af)][_0x3b722f]){if(_0x255472[_0x3e8210(-0x56,0x14,-0x7a,-0xb)]!=='JsmPr')return null;else{const _0x2f6d0c=_0x3bbb19[_0x5b3f1b(0x41f,0x466,0x41f,0x3e9)+_0x5b3f1b(0x417,0x3ae,0x41b,0x3a4)]('char_'+_0xcf260c);_0x2f6d0c&&(_0x2f6d0c[_0x3e8210(-0xac,-0x77,-0x1d,-0x1a)]=_0xdc8610[_0x3dca1d],_0x28450f(_0x2f6d0c)[_0x5b3f1b(0x47c,0x575,0x4cb,0x501)](_0x255472['KquNF']));}}const _0x343751={};return _0x343751['id']=_0x3b722f,_0x343751['data']=_0x13f3a3[_0x5b3f1b(0x446,0x45f,0x4a8,0x418)+'resets'][_0x3b722f],_0x343751;}function buildCharacterText(_0x4b1bb6){const _0x595742={};_0x595742['TduLW']='<人物>\x0a',_0x595742[_0x134c52(0x241,0x293,0x291,0x22f)]=_0x134c52(0x1a8,0x1a2,0x1e3,0x258);const _0x4e448f=_0x595742,_0x32b5a3=_0x4b1bb6['data'];let _0x131741=_0x4e448f[_0x134c52(0x3a9,0x39a,0x2f8,0x2eb)];_0x131741+='中文名称:\x20'+(_0x32b5a3[_0xa6e67f(0x4,-0x70,-0x41,0x73)]||'')+'\x0a',_0x131741+=_0x134c52(0x284,0x2a0,0x2ca,0x25e)+(_0x32b5a3[_0x134c52(0x14d,0x1dc,0x1cb,0x1c5)]||'')+'\x0a',_0x131741+='五官外貌:\x20'+(_0x32b5a3['facialFeat'+'ures']||'')+'\x0a',_0x131741+=_0x134c52(0x209,0x252,0x256,0x25b)+(_0x32b5a3[_0xa6e67f(-0xd9,-0x89,-0x85,-0x121)+_0xa6e67f(-0x87,-0x10b,0x19,-0x104)]||'')+'\x0a';function _0xa6e67f(_0x4a40eb,_0x35e246,_0xe09b8b,_0x4c667b){return _0xaebf35(_0x4a40eb-0x3c,_0x35e246-0x13,_0xe09b8b,_0x4a40eb- -0xac);}_0x131741+=_0x134c52(0x16b,0x220,0x1e1,0x14f)+(_0x32b5a3[_0x134c52(0x1e0,0x2f0,0x25e,0x2e8)+'FW']||'')+'\x0a',_0x131741+=_0xa6e67f(-0x14,-0x27,0x99,-0x31)+(_0x32b5a3[_0x134c52(0x1d7,0x209,0x25e,0x2da)+_0x134c52(0x172,0x178,0x1ff,0x196)]||'')+'\x0a',_0x131741+='下半身SFW:\x20'+(_0x32b5a3[_0x134c52(0x16b,0x22e,0x1e4,0x1fd)+'W']||'')+'\x0a',_0x131741+=_0x134c52(0x1cb,0x180,0x1ee,0x191)+(_0x32b5a3['fullBodySF'+_0x134c52(0x1e6,0x265,0x250,0x1c3)]||'')+'\x0a',_0x131741+='上半身NSFW:\x20'+(_0x32b5a3[_0x134c52(0x22e,0x1c3,0x1c3,0x11d)+_0x134c52(0x267,0x1fb,0x218,0x1fc)]||'')+'\x0a',_0x131741+=_0xa6e67f(0x8,-0x37,-0x35,0x86)+'\x20'+(_0x32b5a3[_0x134c52(0x1d9,0x16a,0x1c3,0x112)+_0x134c52(0x2bb,0x259,0x2c4,0x298)]||'')+'\x0a',_0x131741+=_0x134c52(0x1ff,0x1b8,0x268,0x253)+(_0x32b5a3[_0x134c52(0x2af,0x357,0x2d8,0x369)+'FW']||'')+'\x0a',_0x131741+='下半身NSFW背面:'+'\x20'+(_0x32b5a3[_0xa6e67f(0xa,0xb7,0x6d,-0x2d)+_0x134c52(0x208,0x1a1,0x1ff,0x253)]||'')+'\x0a';function _0x134c52(_0x2e74b1,_0x39475c,_0x4aec3f,_0x3062d8){return _0xaebf35(_0x2e74b1-0x1bf,_0x39475c-0x19,_0x3062d8,_0x4aec3f-0x222);}return _0x131741+=_0x4e448f[_0x134c52(0x333,0x271,0x291,0x208)],_0x131741;}export async function handleCharacterPromptModify(_0x145a31,_0x1f79e7=[]){const _0xc4f73e={'THMCA':_0x214881(0xc5,0x11d,0x143,0xef)+'PromptModi'+_0x214881(0x95,0x3b,0xaf,0x4c)+_0x214881(0x1b3,0xb9,0x101,0xfe)+_0x214881(0x208,0x28c,0x1f1,0x262)+_0x1ce5a9(0x481,0x40a,0x3c1,0x3d0),'DEncU':_0x214881(0xb9,0x1a2,0x104,0x67),'jhyAX':_0x1ce5a9(0x2ec,0x3e1,0x315,0x371)+'PromptModi'+_0x1ce5a9(0x2f5,0x2e6,0x29b,0x327)+'ed','gpHXI':_0x214881(0x210,0x186,0x1b3,0x264)+_0x214881(0x172,0x12a,0xd4,0x139)+_0x214881(0x1ca,0xff,0x19a,0x15d),'SPgho':_0x214881(0x30,0x112,0xd7,0x103),'YieNr':_0x1ce5a9(0x2ce,0x312,0x3f9,0x349),'ysjMO':function(_0x50124c,_0x557107){return _0x50124c>_0x557107;},'qMsCu':function(_0x35d5b0,_0x4ee62b){return _0x35d5b0===_0x4ee62b;},'PBvQT':_0x214881(0x1c8,0x159,0x1da,0x199),'gqsqR':'[character'+_0x1ce5a9(0x347,0x3c0,0x398,0x364)+_0x1ce5a9(0x2e2,0x35b,0x265,0x2e7)+'提示词修改请求...','WeYZQ':function(_0x1d8105){return _0x1d8105();},'yOPqt':'CpklT','eQlKm':_0x214881(0x12a,0xac,0x15c,0xc4),'XuJca':'[character'+_0x214881(0x9f,0x159,0x136,0xdc)+_0x214881(0x18f,0x11e,0x122,0x144)+_0x1ce5a9(0x37c,0x30e,0x38d,0x3a6),'mzBhD':_0x1ce5a9(0x2c5,0x39a,0x37d,0x371)+_0x214881(0xc0,0x1cc,0x136,0x1c2)+_0x214881(0x1dd,0x221,0x1fe,0x288)+'context:','TdXlL':'[character'+_0x1ce5a9(0x3cf,0x33c,0x3f3,0x364)+'fy]\x20Saved\x20'+_0x1ce5a9(0x4d4,0x468,0x379,0x428)+':','AgzXS':_0x1ce5a9(0x3ef,0x40e,0x301,0x371)+_0x1ce5a9(0x327,0x338,0x37b,0x364)+_0x1ce5a9(0x3a6,0x43d,0x47a,0x42c)+_0x214881(0x12f,0x103,0xe7,0xdd),'ECnFM':_0x1ce5a9(0x312,0x352,0x31d,0x3ac),'VbKCM':function(_0x3ecfaf,_0x3117e8){return _0x3ecfaf!==_0x3117e8;},'qGFMT':_0x214881(0x265,0x213,0x1d1,0x21c),'ILEZM':_0x214881(0x125,0xd6,0x143,0x1c5)+'PromptModi'+_0x214881(0xfe,0x1dd,0x181,0x13e)+_0x214881(0x28e,0x1e4,0x205,0x189)+'r\x20text:','pNKUE':function(_0x38d4b8,_0x1655bd,_0x4ff335){return _0x38d4b8(_0x1655bd,_0x4ff335);},'vMBfz':_0x1ce5a9(0x33f,0x451,0x3a7,0x3b0)+'y','FaMwB':function(_0x5a6f4d){return _0x5a6f4d();},'rOzqO':_0x1ce5a9(0x33e,0x3b6,0x2e9,0x371)+_0x1ce5a9(0x33e,0x370,0x2e5,0x364)+'fy]\x20Charac'+_0x1ce5a9(0x4a1,0x422,0x39f,0x3f7)+_0x1ce5a9(0x3e7,0x331,0x3d7,0x3d7)+_0x1ce5a9(0x34f,0x2d1,0x35a,0x33a),'ruwUj':'[character'+_0x214881(0x1cd,0x18a,0x136,0x1a3)+_0x214881(0x138,0x1ab,0x120,0x123)+'后:','iEgPE':function(_0x4402ee,_0x1db120,_0x1f8f2c){return _0x4402ee(_0x1db120,_0x1f8f2c);},'hDbSw':_0x214881(0xe7,0xd7,0x138,0x118),'dquac':_0x1ce5a9(0x364,0x2dc,0x2e2,0x371)+'PromptModi'+_0x1ce5a9(0x353,0x2c5,0x2b3,0x33e)+_0x214881(0xa5,0x115,0x13d,0x1b1)+_0x214881(0x121,0x160,0x17c,0x193)+'ndex:','gExkM':function(_0x31b6bb,_0x151621){return _0x31b6bb||_0x151621;},'pUmCm':function(_0x2860fa,_0x3288e7,_0x9cc558,_0x228d19,_0x42dea9){return _0x2860fa(_0x3288e7,_0x9cc558,_0x228d19,_0x42dea9);},'sPIkg':_0x214881(0xe1,0x15f,0x143,0x1e5)+_0x214881(0x147,0x1e1,0x136,0x11c)+_0x1ce5a9(0x2ef,0x30c,0x3c2,0x374)+_0x1ce5a9(0x36d,0x3c7,0x405,0x3cb),'RmDlx':function(_0x378d15,_0x415a4e){return _0x378d15===_0x415a4e;},'DdrmV':_0x1ce5a9(0x4a3,0x470,0x45a,0x40c),'BQRBw':_0x1ce5a9(0x373,0x340,0x346,0x345),'SdZuh':function(_0x1e29dd,_0x465e95,_0xd5db36){return _0x1e29dd(_0x465e95,_0xd5db36);},'Vsxhx':_0x214881(0xd8,0x177,0x143,0xc2)+_0x214881(0xb8,0xb7,0x136,0xfb)+_0x214881(0xc2,0x115,0x16b,0x139)+_0x214881(0x1cc,0x1ad,0x180,0x1d7),'PjqhY':_0x1ce5a9(0x485,0x3df,0x3bf,0x3d3),'ytuIJ':_0x1ce5a9(0x3cb,0x31a,0x388,0x351)+'检测到角色标签','KZHMv':'[character'+'PromptModi'+_0x1ce5a9(0x37b,0x3b2,0x3a8,0x367)+_0x1ce5a9(0x3b9,0x330,0x2f0,0x384)+_0x1ce5a9(0x41a,0x37c,0x3ac,0x3a4)+_0x214881(0x2b0,0x24c,0x201,0x1de),'MLMXL':'角色提示词修改完成！','meSSR':_0x214881(0x1b0,0x25d,0x1b4,0x1c9),'hQBKY':_0x214881(0x19f,0x137,0x143,0x17d)+_0x1ce5a9(0x3a3,0x3a8,0x3d2,0x364)+'fy]\x20Error:'};console[_0x1ce5a9(0x3aa,0x3b6,0x32f,0x304)](_0x1ce5a9(0x330,0x3a8,0x33a,0x371)+_0x214881(0x1c1,0xd2,0x136,0xd3)+_0x214881(0x125,0x136,0x1ca,0x1ca)+_0x214881(0x134,0x34,0xca,0x157)+_0x1ce5a9(0x380,0x3b8,0x388,0x34d)+_0x1ce5a9(0x2dd,0x2a6,0x2c0,0x2d9)+'uest...');function _0x1ce5a9(_0x30f2ed,_0x3f826d,_0x4f21b4,_0x2a2f8a){return _0xaebf35(_0x30f2ed-0x42,_0x3f826d-0x1e0,_0x4f21b4,_0x2a2f8a-0x362);}toastr[_0x214881(0x156,0x10d,0xc2,0xf1)](_0xc4f73e['gqsqR']);function _0x214881(_0x5c4279,_0xe7c63c,_0x493e96,_0x17d8a7){return _0xaebf35(_0x5c4279-0x1ab,_0xe7c63c-0x70,_0xe7c63c,_0x493e96-0x134);}try{const _0xc8e0e7=getContext(),_0x7c455d=extension_settings[extensionName],_0x1c9a6d=_0xc4f73e[_0x214881(0x140,0x1a0,0x116,0xe1)](getCurrentCharacterPreset);if(!_0x1c9a6d){if(_0xc4f73e[_0x1ce5a9(0x404,0x3f5,0x380,0x383)]!=='TxiwZ'){toastr[_0x214881(0x127,0x102,0x151,0xaf)](_0xc4f73e[_0x214881(0x27b,0x1e3,0x209,0x280)]);return;}else{_0x40cf60['warning'](_0x1ce5a9(0x3bc,0x3c0,0x387,0x351)+'检测到角色标签'),_0x26e276['log'](_0xc4f73e[_0x1ce5a9(0x449,0x458,0x311,0x3b7)]),_0x54d541[_0x214881(0x174,0x10d,0xd6,0x83)](_0x1ce5a9(0x30b,0x379,0x3a7,0x371)+_0x214881(0xb1,0x157,0x136,0x175)+_0x1ce5a9(0x3b8,0x3ba,0x2f9,0x367)+_0x1ce5a9(0x323,0x3f6,0x2f7,0x384)+_0x1ce5a9(0x2fd,0x3fc,0x424,0x3a4)+_0x1ce5a9(0x39c,0x49f,0x40a,0x42f),_0xc1af49);return;}}console[_0x1ce5a9(0x35e,0x3ae,0x30a,0x304)](_0xc4f73e['XuJca'],_0x1c9a6d['id']);const _0x5f2cc5=_0x1c9a6d['data'][_0x214881(0x1fa,0x10b,0x16e,0x218)+_0x1ce5a9(0x3ba,0x3b9,0x434,0x3bb)]||'',_0x2cad03=_0x1c9a6d[_0x1ce5a9(0x3b2,0x3f2,0x412,0x3b3)][_0x1ce5a9(0x343,0x43b,0x42c,0x39c)+_0x214881(0x135,0x224,0x1ac,0x17e)]||'',_0x1a5f4b=_0x1c9a6d['data'][_0x1ce5a9(0x350,0x3d9,0x353,0x39c)+_0x1ce5a9(0x326,0x36a,0x23f,0x2da)]||{};console[_0x1ce5a9(0x285,0x30d,0x25a,0x304)](_0xc4f73e['mzBhD'],_0x5f2cc5),console[_0x1ce5a9(0x3b0,0x3a8,0x2da,0x304)](_0xc4f73e['TdXlL'],_0x2cad03),console[_0x214881(0x131,0x120,0xd6,0x54)](_0xc4f73e['AgzXS'],_0x1a5f4b);const _0x589ec2=_0x145a31||'',_0x5f596e=[];_0x145a31&&(_0xc4f73e[_0x1ce5a9(0x304,0x324,0x39a,0x3b4)]!==_0x214881(0x241,0x13e,0x18f,0xde)?_0x5f596e[_0x214881(0x256,0x195,0x1aa,0x13f)](_0x145a31):_0x25d4a5['push'](_0x4e99c1));_0x5f2cc5&&(_0xc4f73e['VbKCM'](_0xc4f73e[_0x1ce5a9(0x37d,0x416,0x3a7,0x40d)],_0x1ce5a9(0x3aa,0x459,0x355,0x3ff))?(_0x2c899f=_0x1a4e2b(_0x33ec05,_0x208f98,_0xbd0a07,_0xc4f73e[_0x1ce5a9(0x2e2,0x2ca,0x3e5,0x356)]),_0x37c3be[_0x214881(0x11f,0x58,0xd6,0xfc)](_0xc4f73e['jhyAX'],_0x230787[_0x1ce5a9(0x44a,0x3da,0x380,0x403)],_0xc4f73e[_0x1ce5a9(0x381,0x372,0x3f6,0x39a)],_0x5956b3)):_0x5f596e['push'](_0x5f2cc5));_0x2cad03&&_0x5f596e['push'](_0x2cad03);const _0x248f1a=_0x5f596e['join']('\x0a');console[_0x1ce5a9(0x286,0x327,0x3aa,0x304)](_0xc4f73e[_0x214881(0x15d,0x13f,0xdf,0x150)],_0x248f1a);let _0x410e65=_0xc4f73e[_0x1ce5a9(0x327,0x3ab,0x3a0,0x341)](buildPromptForRequestType,_0xc4f73e[_0x1ce5a9(0x323,0x3b3,0x369,0x35a)],_0x589ec2);const _0x4a09ea=generateCharacterListText(_0x248f1a),_0x47807c=_0xc4f73e[_0x1ce5a9(0x397,0x477,0x483,0x41e)](generateOutfitEnableListText),_0x2c06ca=_0xc4f73e[_0x214881(0x187,0x102,0x116,0x1ba)](generateCommonCharacterListText);console[_0x214881(0xec,0xca,0xd6,0x124)](_0xc4f73e[_0x214881(0x105,0xf8,0xef,0x119)],_0x4a09ea);const _0x3200b5=_0xc8e0e7[_0x214881(0x1bc,0x1b2,0x13c,0xe2)+'ta']?.['variables']||{},_0x18b9ff=buildCharacterText(_0x1c9a6d);_0x410e65=mergeAdjacentMessages(_0x410e65),console[_0x1ce5a9(0x278,0x330,0x397,0x304)](_0xc4f73e[_0x1ce5a9(0x3c7,0x307,0x43a,0x3a7)],_0x410e65);const _0x26de02=_0xc4f73e[_0x1ce5a9(0x32e,0x257,0x2ec,0x2fe)](findMessageIndexWithPlaceholder,_0x410e65,_0xc4f73e[_0x214881(0x1cf,0x198,0x195,0x18a)]);console[_0x1ce5a9(0x29d,0x382,0x371,0x304)](_0xc4f73e['dquac'],_0x26de02);const _0x5251db={..._0x1a5f4b,..._0x3200b5},_0x56789d={'context':_0x5f2cc5,'worldBookContent':_0x2cad03,'variables':_0x5251db,'userDemand':_0xc4f73e[_0x214881(0x15f,0x162,0x1ab,0x11b)](_0x145a31,''),'characterListText':_0x4a09ea,'outfitEnableListText':_0x47807c,'commonCharacterListText':_0x2c06ca},{messages:_0x45d93d,replacedVariables:_0xf286cb}=_0xc4f73e[_0x214881(0x9e,0x13e,0x113,0x182)](replaceAllPlaceholders,_0x410e65,_0x56789d);_0x410e65=_0x45d93d,_0x410e65=_0xc4f73e[_0x1ce5a9(0x2c1,0x37f,0x2d5,0x342)](_0x40de14,_0x410e65,_0x1ce5a9(0x42d,0x32f,0x466,0x3de),_0x18b9ff,_0xf286cb),console[_0x214881(0x4c,0xc6,0xd6,0x150)](_0xc4f73e[_0x1ce5a9(0x433,0x3be,0x3d6,0x3e3)],_0x410e65);let _0x3ac2b8='';if(_0xf286cb[_0x214881(0x191,0xa4,0x10a,0x73)]>0x34a*0x1+0x80f+0x1*-0xb59){if(_0xc4f73e[_0x1ce5a9(0x32f,0x3c0,0x2bf,0x361)]('UbSrG',_0xc4f73e[_0x214881(0xd8,0x148,0xb2,0x5e)]))_0x3ac2b8=_0x1ce5a9(0x352,0x2a6,0x2cf,0x2fb)+_0x1ce5a9(0x39b,0x34e,0x326,0x386)+[..._0xf286cb][_0x1ce5a9(0x490,0x469,0x389,0x409)]('、')+'\x0a';else{const _0xdbbd43=_0xdddad0[_0x29b06a]||_0xc4f73e[_0x214881(0x1a5,0x16a,0x124,0xb5)],_0x2a30cc=_0x5bb947[_0x416db9];_0xf60a55+='•\x20'+_0x4b8985[_0x5a9e48]+':\x0a',_0x943091+=_0x214881(0x1d1,0x239,0x1c1,0x191)+_0xdbbd43[_0x1ce5a9(0x413,0x3ba,0x369,0x3fb)](0x10cf+-0xecd+-0x202,0x246b+-0x2*-0x3c8+-0x2bc9)+(_0xdbbd43[_0x214881(0x19b,0x1ea,0x1d5,0x23c)]>-0x2157+-0x1d+0x76*0x49?_0xc4f73e[_0x1ce5a9(0x45b,0x3e1,0x46c,0x3e5)]:'')+'\x0a',_0x275f9d+=_0x1ce5a9(0x24d,0x327,0x382,0x2ee)+_0x2a30cc[_0x214881(0x131,0x165,0x1cd,0x1ed)](0x2063*-0x1+0x23e*0xe+-0x11*-0xf,-0xf2c+-0x510*-0x1+-0x527*-0x2)+(_0xc4f73e['ysjMO'](_0x2a30cc[_0x1ce5a9(0x418,0x37c,0x38b,0x403)],0xeb9+0x1a16+0x1*-0x289d)?_0xc4f73e[_0x1ce5a9(0x370,0x3cd,0x34f,0x3e5)]:'')+'\x0a\x0a',_0x207148++;}}if(_0x1f79e7&&_0x1f79e7['length']>0x1*-0x1acf+0x1*-0x2de+0x47*0x6b&&_0x26de02>=0x1*-0x12b3+-0x1*-0x22e5+0x2b3*-0x6){if(_0xc4f73e['VbKCM'](_0xc4f73e[_0x214881(0x185,0x176,0x112,0x74)],_0xc4f73e[_0x1ce5a9(0x296,0x2c0,0x2d9,0x340)]))for(const _0x4903c5 of _0x43b059[_0x214881(0x16c,0x11f,0x137,0x160)]){if(_0xc4f73e[_0x1ce5a9(0x27c,0x2d1,0x2f0,0x301)](_0x4903c5[_0x1ce5a9(0x3ec,0x39a,0x36d,0x3e6)],_0xc4f73e[_0x214881(0x11e,0x133,0x144,0x1c8)])&&_0x4903c5['text']['includes'](_0x316ae8))return _0x59987a;}else _0x410e65=_0xc4f73e['pUmCm'](attachImagesToMessage,_0x410e65,_0x26de02,_0x1f79e7,_0xc4f73e[_0x1ce5a9(0x32e,0x3ef,0x33b,0x356)]),console[_0x214881(0x123,0x102,0xd6,0xfd)](_0x1ce5a9(0x37f,0x3e9,0x334,0x371)+_0x1ce5a9(0x2c5,0x3c8,0x3e2,0x364)+'fy]\x20Attach'+'ed',_0x1f79e7['length'],_0xc4f73e['gpHXI'],_0x26de02);}_0xc4f73e[_0x1ce5a9(0x36c,0x368,0x304,0x319)](updateCombinedPrompt,_0x410e65,_0x3ac2b8);const _0x3dbe72={};_0x3dbe72['timeoutMs']=0x493e0;const _0x4f6f8f=await _0xc4f73e[_0x214881(0x165,0x104,0xeb,0x117)](LLM_CHAR_MODIFY,_0x410e65,_0x3dbe72);console[_0x214881(0x110,0xcf,0xd6,0x16f)](_0xc4f73e[_0x214881(0x226,0x134,0x183,0x174)],_0x4f6f8f);if(!_0x4f6f8f){toastr[_0x214881(0xe4,0xf0,0x151,0xa6)](_0xc4f73e[_0x1ce5a9(0x429,0x3a4,0x38b,0x3d6)]);return;}const _0x17b3c2=extractCharacterTags(_0x4f6f8f);if(_0xc4f73e['RmDlx'](_0x17b3c2['characters'][_0x1ce5a9(0x3f1,0x39f,0x40c,0x403)],0x1*0x33+0x179e+-0x1*0x17d1)){toastr['warning'](_0xc4f73e[_0x214881(0x1d5,0x29c,0x203,0x1da)]),console[_0x214881(0x16a,0x91,0xd6,0xbb)](_0xc4f73e[_0x1ce5a9(0x3b0,0x391,0x442,0x3b7)]),console[_0x1ce5a9(0x357,0x255,0x26a,0x304)](_0xc4f73e['KZHMv'],_0x4f6f8f);return;}console[_0x214881(0x41,0x8d,0xd6,0xca)](_0x214881(0x1ce,0x94,0x143,0x1e0)+_0x1ce5a9(0x316,0x2cd,0x2b2,0x364)+_0x1ce5a9(0x479,0x3e1,0x362,0x3ee)+'ted\x20data:',_0x17b3c2);const _0x5f4bb9=_0x17b3c2[_0x1ce5a9(0x31a,0x3ce,0x3c7,0x33c)][-0x4e5*0x5+0x1840+0x39];await _0xc4f73e['pNKUE'](updateCharacterPresetFromLLM,_0x1c9a6d['id'],_0x5f4bb9),toastr['success'](_0xc4f73e['MLMXL']);}catch(_0x593f99){_0xc4f73e[_0x214881(0x187,0x101,0x109,0x13a)]!=='PQcDP'?(console[_0x1ce5a9(0x3ab,0x2e1,0x41a,0x37f)](_0xc4f73e['hQBKY'],_0x593f99),toastr['error']('角色提示词修改失败:'+'\x20'+_0x593f99[_0x1ce5a9(0x385,0x29b,0x26f,0x2f9)])):_0x2743d6[_0x44fae7[_0x945a5e]]=_0x5792a3;}}async function updateCharacterPresetFromLLM(_0x227eb1,_0x843efa){const _0x19e7dc={'DMxSI':_0x3b42fe(0x40d,0x3ed,0x43a,0x47e),'hDPTE':'上半身SFW','YPXcF':'上半身SFW背面','Mfaoc':_0x3b42fe(0x4bb,0x4a1,0x46c,0x471),'hkXbt':_0x3b42fe(0x3f0,0x462,0x4dc,0x3d7),'paPCb':_0x85e89a(0x301,0x263,0x2be,0x295),'OkMAL':_0x85e89a(0x212,0x2c7,0x284,0x23c),'LrwxQ':_0x85e89a(0x2d0,0x1ec,0x281,0x323),'CNflg':_0x85e89a(0x241,0x2fe,0x2b5,0x2d3),'NuIls':function(_0x48e1b9,_0x3a1691){return _0x48e1b9===_0x3a1691;},'mzrPd':_0x3b42fe(0x446,0x3ad,0x354,0x350),'PHrIv':function(_0x5c452a,_0x54d637){return _0x5c452a!==_0x54d637;},'FXJrc':_0x85e89a(0x2d0,0x252,0x267,0x26f),'TCtuO':function(_0x4b64a1,_0x8f1c14){return _0x4b64a1>_0x8f1c14;},'MSalG':function(_0x26b500,_0x5243fc){return _0x26b500>_0x5243fc;},'wyHlf':_0x85e89a(0x281,0x294,0x2ab,0x21e),'eCAQX':function(_0x28d0d2,_0x1089ef){return _0x28d0d2===_0x1089ef;},'PfKyJ':_0x3b42fe(0x431,0x3b0,0x365,0x35a)+'内容','ubKqK':function(_0x4b6002){return _0x4b6002();},'SGvxr':function(_0x12ed09,_0x4a0d5a){return _0x12ed09(_0x4a0d5a);},'ZpRWR':_0x3b42fe(0x3ee,0x388,0x366,0x388)+_0x85e89a(0x233,0x2a7,0x28b,0x1fb)+'cter','ovuZp':function(_0x16e1f9,_0xcdf3dd){return _0x16e1f9(_0xcdf3dd);},'oGarl':function(_0x404ea6,_0x92ff73){return _0x404ea6(_0x92ff73);}},_0x3d5b48=extension_settings[extensionName],_0x1c0427=_0x3d5b48[_0x85e89a(0x25e,0x2fc,0x2d7,0x334)+_0x85e89a(0x277,0x381,0x31e,0x2c3)][_0x227eb1];if(!_0x1c0427){toastr['error'](_0x19e7dc['DMxSI']);return;}let _0x470e37=_0x85e89a(0x1f9,0x220,0x271,0x204)+_0x227eb1+_0x3b42fe(0x447,0x477,0x519,0x4ed);const _0xc36056={};_0xc36056['nameCN']='中文名称',_0xc36056[_0x3b42fe(0x34f,0x3bb,0x3c8,0x375)]=_0x85e89a(0x296,0x337,0x2f1,0x2e9),_0xc36056[_0x85e89a(0x33f,0x2a1,0x297,0x284)+'ures']='五官外貌',_0xc36056[_0x85e89a(0x2a7,0x332,0x297,0x318)+'uresBack']=_0x85e89a(0x304,0x34a,0x322,0x354),_0xc36056[_0x3b42fe(0x3ef,0x44e,0x3bc,0x446)+'FW']=_0x19e7dc[_0x3b42fe(0x448,0x3dc,0x41b,0x3b2)],_0xc36056[_0x3b42fe(0x3df,0x44e,0x4f1,0x4fd)+_0x3b42fe(0x3b1,0x3ef,0x3d1,0x432)]=_0x19e7dc[_0x3b42fe(0x41e,0x42b,0x37d,0x41e)],_0xc36056['fullBodySF'+'W']=_0x19e7dc[_0x3b42fe(0x55a,0x4c5,0x422,0x4da)],_0xc36056[_0x85e89a(0x306,0x313,0x286,0x1f7)+'WBack']=_0x19e7dc[_0x85e89a(0x2bd,0x395,0x368,0x3e0)],_0xc36056[_0x3b42fe(0x410,0x3b3,0x432,0x432)+_0x3b42fe(0x441,0x408,0x3ec,0x3e1)]=_0x19e7dc['paPCb'],_0xc36056[_0x3b42fe(0x44f,0x3b3,0x340,0x362)+'SFWBack']=_0x19e7dc[_0x85e89a(0x33f,0x3db,0x385,0x30d)];function _0x3b42fe(_0x24bf7c,_0x4694a3,_0xc1eb51,_0x1f139b){return _0xaebf35(_0x24bf7c-0xe1,_0x4694a3-0x1e8,_0xc1eb51,_0x4694a3-0x412);}_0xc36056['fullBodyNS'+'FW']=_0x19e7dc[_0x3b42fe(0x41e,0x38b,0x405,0x3c1)],_0xc36056[_0x85e89a(0x39a,0x308,0x37a,0x322)+'FWBack']=_0x19e7dc[_0x3b42fe(0x4d7,0x484,0x531,0x502)];const _0x5265ef=_0xc36056;let _0x317e13=-0x1*0x31d+0x1*-0xb15+0xe32;for(const _0x5cfc50 in _0x5265ef){if(_0x19e7dc[_0x85e89a(0x1f4,0x294,0x253,0x2fb)](_0x19e7dc[_0x85e89a(0x254,0x2a4,0x272,0x285)],_0x19e7dc[_0x3b42fe(0x43b,0x3c0,0x39d,0x3c6)])){if(_0x843efa[_0x5cfc50]&&_0x19e7dc[_0x85e89a(0x356,0x2f7,0x2ad,0x33d)](_0x843efa[_0x5cfc50],_0x1c0427[_0x5cfc50])){const _0x31393b=_0x1c0427[_0x5cfc50]||_0x19e7dc[_0x85e89a(0x3bf,0x37e,0x369,0x302)],_0x21504e=_0x843efa[_0x5cfc50];_0x470e37+='•\x20'+_0x5265ef[_0x5cfc50]+':\x0a',_0x470e37+=_0x3b42fe(0x45c,0x49f,0x415,0x404)+_0x31393b['substring'](0x5*0x509+-0xc32+0xcfb*-0x1,-0x1*0xfd3+-0x2*0x99d+-0x509*-0x7)+(_0x19e7dc[_0x3b42fe(0x3c8,0x3c7,0x3f8,0x40b)](_0x31393b['length'],0x1c0e+0x125c+-0x2e38)?_0x85e89a(0x2a0,0x230,0x2ab,0x253):'')+'\x0a',_0x470e37+=_0x3b42fe(0x3c9,0x39e,0x3b8,0x3dd)+_0x21504e[_0x3b42fe(0x431,0x4ab,0x525,0x510)](0x135b+0xdee+-0x2149,-0x1a31+-0x7*0x1b0+-0x7f*-0x4d)+(_0x19e7dc[_0x85e89a(0x3c1,0x380,0x334,0x2cb)](_0x21504e[_0x3b42fe(0x456,0x4b3,0x447,0x4a9)],0x19fd+-0x7*-0x367+0x1*-0x319c)?_0x19e7dc[_0x3b42fe(0x3a0,0x3d0,0x451,0x409)]:'')+'\x0a\x0a',_0x317e13++;}}else{if(_0x535f66){const _0x4e7a40=_0x534944[_0x3b42fe(0x4ea,0x4e6,0x459,0x4b3)](_0x10990e,arguments);return _0x1ed01b=null,_0x4e7a40;}}}if(_0x19e7dc[_0x85e89a(0x2bc,0x19c,0x239,0x248)](_0x317e13,-0x208+-0xa32+-0x61d*-0x2)){toastr['info'](_0x19e7dc[_0x3b42fe(0x4c5,0x43d,0x433,0x3c0)]);return;}function _0x85e89a(_0x38688d,_0x5890d2,_0x274df5,_0x7d9a93){return _0xaebf35(_0x38688d-0x11a,_0x5890d2-0x19c,_0x38688d,_0x274df5-0x2c4);}_0x470e37+='共\x20'+_0x317e13+_0x85e89a(0x318,0x1d6,0x26e,0x2cb);const _0x2ac47f=await stylishConfirm(_0x470e37);if(!_0x2ac47f){toastr[_0x3b42fe(0x360,0x3a0,0x2fc,0x31a)](_0x85e89a(0x2ca,0x25e,0x2bb,0x292));return;}for(const _0x30a4df in _0x5265ef){_0x843efa[_0x30a4df]&&(_0x1c0427[_0x30a4df]=_0x843efa[_0x30a4df]);}_0x19e7dc['ubKqK'](saveSettingsDebounced);const _0x895981=_0x19e7dc[_0x3b42fe(0x536,0x4e0,0x4cc,0x531)]($,_0x19e7dc[_0x3b42fe(0x403,0x3da,0x33f,0x441)]);_0x895981[_0x85e89a(0x3e6,0x412,0x365,0x403)]&&_0x19e7dc[_0x85e89a(0x38d,0x3e2,0x373,0x352)](refreshCharacterSettings,_0x895981),_0x19e7dc['oGarl'](updateFormFields,_0x843efa),console[_0x3b42fe(0x449,0x3b4,0x3b3,0x3ba)](_0x85e89a(0x300,0x35f,0x2d3,0x340)+_0x3b42fe(0x39d,0x414,0x42b,0x4b4)+_0x3b42fe(0x3e6,0x43c,0x398,0x414)+_0x3b42fe(0x461,0x4a4,0x46f,0x426)+_0x227eb1+'\x22');}function updateFormFields(_0x51261c){const _0x5c3bdd={};function _0xb31b79(_0x30194f,_0x384bfb,_0x52e5db,_0x3f7e47){return _0xaebf35(_0x30194f-0xf6,_0x384bfb-0x131,_0x384bfb,_0x52e5db-0x48a);}_0x5c3bdd['OPZwp']=_0xb31b79(0x4fc,0x3e6,0x472,0x424),_0x5c3bdd[_0xb31b79(0x512,0x5ae,0x528,0x4bc)]='nameCN',_0x5c3bdd[_0xb31b79(0x470,0x401,0x43e,0x430)]='nameEN',_0x5c3bdd[_0x41fe81(0x52,0x1f,0xbe,0x9c)]=_0x41fe81(0x105,-0xb,0x3f,0x57)+_0xb31b79(0x4a7,0x412,0x4b6,0x523);function _0x41fe81(_0xa11c1,_0x42f8f8,_0x522554,_0x1c3263){return _0xaebf35(_0xa11c1-0x21,_0x42f8f8-0xfe,_0x42f8f8,_0x1c3263-0x84);}_0x5c3bdd[_0x41fe81(0xf0,0xc8,0x18f,0x15b)]='upperBodyS'+'FW',_0x5c3bdd[_0x41fe81(0x58,0x32,0x5,0xa3)]=_0x41fe81(0x131,0xa5,0x37,0xc0)+_0x41fe81(0xa3,-0xe,-0x49,0x61),_0x5c3bdd['Qnber']=_0xb31b79(0x4f5,0x3a7,0x44c,0x454)+'W',_0x5c3bdd[_0xb31b79(0x461,0x51c,0x4f1,0x478)]=_0xb31b79(0x4f9,0x413,0x44c,0x432)+_0x41fe81(0xe8,0x4e,0xf,0xb2),_0x5c3bdd['Jzaga']=_0x41fe81(0x7f,-0x40,0x23,0x25)+_0xb31b79(0x409,0x496,0x480,0x42d),_0x5c3bdd[_0x41fe81(0x55,0x178,0xec,0xe3)]='fullBodyNS'+_0xb31b79(0x4bd,0x426,0x467,0x4ef);const _0x469752=_0x5c3bdd,_0x3b2d7a=[_0x469752[_0xb31b79(0x482,0x4a9,0x528,0x5bc)],_0x469752[_0x41fe81(-0x75,0x29,0xae,0x38)],_0x469752[_0xb31b79(0x4a3,0x3fc,0x4a2,0x418)],'facialFeat'+_0x41fe81(0xde,0x4c,0xb4,0xa9),_0x469752[_0x41fe81(0x163,0xad,0x13c,0x15b)],_0x469752['DHZHe'],_0x469752[_0x41fe81(0x7c,0x125,0x4d,0x9e)],_0x469752[_0x41fe81(0x10e,0x12d,0x125,0xeb)],_0x469752[_0xb31b79(0x548,0x4c6,0x4cb,0x435)],'upperBodyN'+'SFWBack','fullBodyNS'+'FW',_0x469752[_0xb31b79(0x4c7,0x4c3,0x4e9,0x442)]];_0x3b2d7a[_0xb31b79(0x5a9,0x5b4,0x524,0x5d5)](_0x231069=>{function _0x1e6c15(_0x175bfa,_0x3802e9,_0x530e7f,_0x4468da){return _0x41fe81(_0x175bfa-0x1aa,_0x530e7f,_0x530e7f-0x2b,_0x3802e9-0x1e0);}function _0x542c60(_0x42e8ca,_0x14aa53,_0x4a06e6,_0x4462dd){return _0x41fe81(_0x42e8ca-0x31,_0x14aa53,_0x4a06e6-0x155,_0x4462dd-0x110);}if(_0x51261c[_0x231069]){const _0x3d4fa5=document[_0x1e6c15(0x243,0x1ee,0x29e,0x250)+_0x542c60(0x89,0x116,0xb8,0x11a)]('char_'+_0x231069);_0x3d4fa5&&(_0x3d4fa5[_0x1e6c15(0x29f,0x251,0x2da,0x1e6)]=_0x51261c[_0x231069],$(_0x3d4fa5)['trigger'](_0x469752[_0x1e6c15(0x26b,0x2ef,0x2af,0x241)]));}});}
//# sourceMappingURL=http://localhost:8000/characterPromptModify.js.map