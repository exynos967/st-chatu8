function _0x34e2(){const _0x2aa90d=['uwTpD20','wLHUzvy','5lIl5y2k6lQRtLngv+IdJoMDOJO','y2HHCMfJDgvYua','E3VNLkJMIlFPNidMSyj9Fq','qwvbwfy','t05trq','r1HcD0G','DxjLCW','s2DNuK8','B1n0CKm','yNbYvvG','wMzor0i','z2v0rwXLBwvUDa','B2rPzNKGteXnia','5lIl5y2k6lQRu0zx6iom6z2IoIa','C2fMu04','uw9HzxC','wxPqAfG','lxrHyI1JAgfYyq','Bw9KAwz5ihjLCq','wNPlCKq','y2Dqq1e','zxjYB3i','zMfJAwfSrMvHDa','Aw5NignOyxiGBq','s0zMDey','C25oyuK','u3HHuxO','ndu3ndi3nLvlreXyDG','CffeywC','BwvZC2fNzq','zfnguum','Aw5WDxq','zNL4EMS','zxH0icH0CMLNzW','lI4U','zNLDie5VignOyq','Dg9tDhjPBMC','DeXOD2K','rKD2tfy','BMfTzuno','uKvgwK0','i3n0lwnOyxr1oa','zNLDioATO+wCQowKHoEqHUINKUIjSG','BgvUz3rO','zMz3t0W','BwvZC2fNzsbHDa','sufMtey','Aw5KzxHpzG','nefyzgH5Dq','zu5VwM0','zLnZvhK','D29YBgqGyM9VAW','5lIl5y2k6lQRu0zx6iom6z2I','rLDcywnR','EMPRrxG','sgDfCxG','tfDsrgm','Aw5MBW','zNLDieXmtsbVDq','wgnJq2O','5lIk5y2k6lQRtLngvW','zM9YrwfJAa','D2fYBMLUzW','y2HHCL8','uvv6tg0','z0Xcvwy','EuPdz04','zK1Mswy','y0LItgm','ue9ou0u','yNv1Dfy','DMjys2O','zw5LCG','yM13v2G','DgLTzw91De1Z','zw1PDa','rvnu','ENbRwKi','sLHyAfa','z1j4z1a','vhjTBfO','5PYQ5zYOieXmtsdOVPpLH7RKUk0','tgPJwwG','BM93','CYbMB3vUzcbPBG','wNL0tMm','zKDVCLK','DhjPz2DLCG','cLVKU6xKUiVMMk/NLkJMIlFKUiRKVkdNMOq','rvjSBfa','AePUEuO','DwvZDc4UlG','ig91Dhb1Da','tfzetuu','zNLDiowqIow5TUEBUoMcU+A2IoAbRW','5lQu5A6y5Asw6lkm6iom6z2IoIa','B2zir2u','mZeYq01dENfv','t0rjrLLFuKvtua','zKvLyMm','rhztsvm','q29UDgv4Da','revWqvi','zLzdEgS','6kkR5l2/55sO77YA','CMvTB3zLtgLZDa','5lIT5PAh5zcn56EW','CMvZDwX0','ywrK','BMrLEdO','5Qoa5Rwl5yIW6kEs6iMY5Qch562+','y1jfBNG','y29UDgv4DdO','teXnioI/LowBNUE7K+AENos4UUEPUG','ig1LC3nHz2uGAq','qM5Rtgi','C3rYAw5N','weTnEuS','AxnbCNjHEq','yKjWuw0','y2HHCL9TB2rPzG','whPgvuu','tMLRueq','kcGOlISPkYKRkq','qNLjza','CMfUzg9T','qMv4rKS','mJa5mZK0EMPUALjP','5RkH5PYj5Qoa5Rwl5yIW6zYa6kAb5PU05PAW55Qe','koEPUIK','C1LZsgC','teXnioIVT+AXGUwKSEI0Pq','sg9Mr2m','C3D2C2S','ChjVBxb0oG','vLH4v3G','y2HHCMfJDgvYCW','6i635y+w6kEs6iMY5l+U5Ps55O+q56s66k+n6lAf','zgf0ytPPBwfNzq','icdML6C6ia','pos6UUEjQt4k','z2vUzxjHDgLVBG','r0zqquG','sffouuy','wLvvvvC','Au1Wz0C','C3vJy2vZCW','BgzgBhe','EwPRuKm','C2L6zq','zwLwrLO','yMfZzty0','DgvYihrYAwDNzq','6k6+ici','uMPnAMC','wfPwzwi','5lQu5A6y5Asw6lkmoIa','ufjptvbux1jfuq','C2vHCMnO','DuHyv2u','A3DhB08','u0zxqMfJAW','refbr0S','6kEs6iMY5O+q56s66k+n5l+U5Ps55AsX6lsLoG','DxbWzxjcB2r5tG','uufNA2u','uMLjA0e','D2fUyM8','CMvIAuG','DNjyrw0','v1jiueK','DhjPBq','zNrRshO','zgf0ytO','tfnRyMu','5lQu5A6y5Asw6lkm','ChvZAa','A3zLrKi','t0jZwwq','5lIl5y2k6lQRtLngvW','yNjNyKO','zNLDief0DgfJAa','mJmYotGWCgnxBwPu','yMvkzxm','zNLDifjHDYbmta','CMvWBgfJzq','zNvSBejVzhLouW','thHoqum','C3bSAxq','Dhjpr0m','uNj0DfO','DxfLsMu','mJq1ntiWAxbVAgLU','DM5bBeC','AM9PBG','qvLgsve','zMTSzvK','txvmrgS','s2PvBhm','Cgz2C2K','ioMHUEABToAuUsZMMk/LKkBLUPtNLkG/','6k+k5PAT77YA5Qoa5Rwl5yIW5lUL5lIl5y+y6yEp','uerswwq','CMfUzg9Tvvvjra','u0zx','zK9orfC','6iUX5PAh5zcn56EW','ufjptvbux1jfuW','wKrguuO','uM9MDva','DhfJtwG','rdOG','BMfTzuvo','y0rXDNi','qKnnCxK','5lIk5y2k6lQRu0zx6iom6z2IoIa','rM9SvKi','vvbpq0i','DxbWzxjcB2r5uW','tsbVDxrWDxqGzG','tvb0Bgi','twPmquu','B3iGzgvIDwDNAq','zNLDievYCM9YoG','rhzLuLK','ruLpuxe','5lQu5A6y5Asw6lkm6iom6z2I','y1HMCLG','zgv0ywLS','5yEg5Ash5PU05PAW6kEs6iMYici','t0rjrLLFuKvrvq','yxv0BW','uwrYueG','DMfYAwfIBgvZ','5lIl5y2k6lQRu0zxoIa','v1DeDe8','igLUzgv4','5lIk5y2k6lQRtLngv+IdJoMDOJO','A0v6Cfy','5lIk5y2k6lQRu0zx6iom6z2I','sgzZu1O','v1flu0O','u2jrufi','l3bUzZTIyxnLnG','vvP5v1G','zgf0yq','wLzxzwC','pc/KURRNIAK+','y29UC3rYDwn0BW','tNnbEMu','w2nOyxjHy3rLCG','Een3vMu','tNHWtNu','zNLDiev4zwn1Da','qxvVAvu','5lIl5y2k6lQRtLngvZOG','Bxb0icHjrdOG','Bg9N','y3z2AgO','BMC6','ug5nqKG','v2TOBgC','5Rgc6lAf5PE2','vMfYAwfIBgvZ','r2LPA24','vhPMsNO','wuLlEvC','zNLDiezPBMfSia','mZCZotGZmfftyKzwyq','yKnku2K','v2nmrwG','yxbWBhK','shbyB2i','B0rzwwC','zNLDifnHDMvKia','mZK5mJuWmevHuhzSBW','icdMLRa6ia','uhjVBxb0tw9KAq','mtG5odG5mKznBu9PAq','A1bkCfO','CenKr0e','5PwW5O2UoG','D2LWv20','zgvbsfi','D3zOzM8','EfPQA3e','vuvMrvq','6kEs6iMY5l+U5Ps5ieXmtsdOR7C','BMfTzq','Dgv4Da','zxHLyW','Aw1Hz2vZihrVia','Eu1jsxK','r2n3yuW','v0jHy2S','DhLWzq','6kEs6iMY5O+q56s66k+n5l+U5Ps55A6m5OIq77Yb','teXnx0niqvjFtq','zND3s2i','Aw1Hz2vFDxjS','DMfSDwu','CeDUBuC','y29UDgvUDa','sM9tEu0','vfPRvvu','BevNAK8','tLzwvwu','zNLDiev4DhjHyW','Ew9Twxq','zNLDien1CNjLBG','5lIk5y2k6lQRu0zx','reLMq3y','CMfJDgvYihrHzW','t0rjrLLFr0vuxW','5lIl5y2k6lQRtLngv+IdJoMDOG','C3vIC3rYAw5N','vhDgqve','5OM+5lIn5yIW5OYh5A6A55Qe6kEs6iMY6Ake6k6+','zNLDienOyxjHyW','re5ezxu','zNvSBejVzhLtrG','DLrbB3e','BK9JuMq','DxjS','y0jKsfe','wMXqwxm','DxjLC0jHy2S','D1PxBwy','5y+c6icd5zU+54Mh','y3rLCG','ChjVBxb0','qxruAgW','rwXLs1y','iIdNMOtKU6xKUiVMLBdMJA46cGO','Bw9KAwz5ihbYBW','Aw5JBhvKzxm','wwrIzui','6k+35ywi6ycj5OUP5lIa5lIQ6kEs6iMY6Ake6k6+','CMvZzxrZ','Dhb1DdO','B2jQzwn0'];_0x34e2=function(){return _0x2aa90d;};return _0x34e2();}(function(_0x1f8ecc,_0x24f01d){function _0x2457ce(_0x4a2d93,_0x5621cd,_0x451f8b,_0x2e914b){return _0xadc0(_0x451f8b- -0x2cf,_0x4a2d93);}function _0x29d4a3(_0x5750a3,_0x2ba271,_0x24a0ff,_0x2734cc){return _0xadc0(_0x2734cc-0x1b6,_0x2ba271);}const _0x4f8f10=_0x1f8ecc();while(!![]){try{const _0x1cc677=parseInt(_0x2457ce(0x28,0x67,-0x3e,0x6d))/(-0xe7d*-0x1+-0x2be+0x3ea*-0x3)*(parseInt(_0x29d4a3(0x3bc,0x3a3,0x31c,0x3c1))/(-0x1*-0x3d+0x37f*0x6+-0x1535))+-parseInt(_0x29d4a3(0x3a6,0x494,0x3c6,0x451))/(-0x14eb+-0xe59+-0xb*-0x335)+parseInt(_0x29d4a3(0x429,0x4ca,0x46c,0x4a7))/(0x13be+-0x41*-0xa+-0x1644)+-parseInt(_0x29d4a3(0x465,0x4a1,0x418,0x4a4))/(-0x4a+0xf01*-0x2+0x1e51)+parseInt(_0x29d4a3(0x485,0x429,0x410,0x49d))/(-0x1*-0x79f+0x2692+-0x2e2b)+parseInt(_0x2457ce(-0xad,-0x134,-0xd9,-0x33))/(-0x1*0x20d3+0x1875*0x1+-0x865*-0x1)+parseInt(_0x2457ce(-0x81,-0x102,-0x93,-0xe8))/(-0x1049*0x1+-0x2197*0x1+0x63d*0x8)*(-parseInt(_0x29d4a3(0x41f,0x487,0x435,0x410))/(0x1*-0x2605+0x140f+-0x1*-0x11ff));if(_0x1cc677===_0x24f01d)break;else _0x4f8f10['push'](_0x4f8f10['shift']());}catch(_0x58870b){_0x4f8f10['push'](_0x4f8f10['shift']());}}}(_0x34e2,0x13*0xab77+0x6eca2+-0xd17c9));const _0x5a567a=(function(){let _0x314455=!![];return function(_0x28a12d,_0x3a52e0){const _0x47e560=_0x314455?function(){if(_0x3a52e0){const _0xbce3be=_0x3a52e0['apply'](_0x28a12d,arguments);return _0x3a52e0=null,_0xbce3be;}}:function(){};return _0x314455=![],_0x47e560;};}()),_0x5e0896=_0x5a567a(this,function(){const _0x138b7c={};_0x138b7c[_0x1f1d30(0x33f,0x34c,0x3b6,0x328)]=_0x4e6971(0x4cf,0x407,0x483,0x4ac)+'+$';function _0x4e6971(_0x4574b1,_0x30b86a,_0x98ad84,_0x50e803){return _0xadc0(_0x50e803-0x256,_0x30b86a);}function _0x1f1d30(_0x4abfdb,_0x3a08f3,_0x550e63,_0xea63ae){return _0xadc0(_0x4abfdb-0x93,_0x550e63);}const _0x3af106=_0x138b7c;return _0x5e0896[_0x4e6971(0x4f9,0x45a,0x46b,0x455)]()[_0x4e6971(0x529,0x502,0x4e8,0x4cf)](_0x3af106[_0x1f1d30(0x33f,0x2bb,0x2cf,0x2e2)])[_0x4e6971(0x3ed,0x3f7,0x3bc,0x455)]()['constructo'+'r'](_0x5e0896)[_0x1f1d30(0x30c,0x352,0x35c,0x32b)](_0x3af106['RofuP']);});_0x5e0896();import{eventSource}from'../../../../../script.js';import{eventNames,extensionName}from'./config.js';import{extension_settings}from'../../../../extensions.js';import{getContext}from'../../../../st-context.js';import{saveSettingsDebounced}from'../../../../../script.js';import{generateCharacterListText,generateOutfitEnableListText,generateCommonCharacterListText}from'./settings/worldbook.js';import{updateCombinedPrompt}from'./settings/llm.js';import{buildPromptForRequestType}from'./settings/llmService.js';import{refreshCharacterSettings}from'./settings/character/index.js';function _0xadc0(_0x4e07e9,_0xb867f3){_0x4e07e9=_0x4e07e9-(0xaa4*-0x1+0x3*0x60f+-0x59e);const _0x98aabb=_0x34e2();let _0x145971=_0x98aabb[_0x4e07e9];if(_0xadc0['haBZxp']===undefined){var _0x4eac13=function(_0xbb9093){const _0x490674='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x2aab9f='',_0x4782b8='',_0x1f7bf8=_0x2aab9f+_0x4eac13;for(let _0x200e2c=-0x1043*0x1+-0x1124+0x2167,_0xc17951,_0x277ab9,_0x4cf4ca=-0x1424+-0x14fc+0x2920;_0x277ab9=_0xbb9093['charAt'](_0x4cf4ca++);~_0x277ab9&&(_0xc17951=_0x200e2c%(-0x1e64+0x5*-0x378+0x2fc0*0x1)?_0xc17951*(0x7a2*-0x4+-0x1724+-0xee*-0x3a)+_0x277ab9:_0x277ab9,_0x200e2c++%(0x1465+0x11*-0x1fe+0xd7d*0x1))?_0x2aab9f+=_0x1f7bf8['charCodeAt'](_0x4cf4ca+(-0x7bc+0x11*0x13a+-0xd14))-(0x2589+0x1d8a+-0x4309)!==-0x1822+0x87b+-0x1*-0xfa7?String['fromCharCode'](-0xc66+0xc42*-0x3+0x3*0x10b9&_0xc17951>>(-(-0x1c91*-0x1+0x14e*-0x4+0x1757*-0x1)*_0x200e2c&0x1b6*0xf+0x3fb*0x7+-0x1*0x3581)):_0x200e2c:-0x231c+-0x6d*-0x1b+0x179d){_0x277ab9=_0x490674['indexOf'](_0x277ab9);}for(let _0x54d160=0x1d8b+0x72*0x1f+-0x2b59,_0x48f79f=_0x2aab9f['length'];_0x54d160<_0x48f79f;_0x54d160++){_0x4782b8+='%'+('00'+_0x2aab9f['charCodeAt'](_0x54d160)['toString'](-0x4db+0x144a+-0xf5f))['slice'](-(-0x1bf6+0x110d+0xaeb));}return decodeURIComponent(_0x4782b8);};_0xadc0['qKyOtT']=_0x4eac13,_0xadc0['EpwIbB']={},_0xadc0['haBZxp']=!![];}const _0x445f6f=_0x98aabb[-0x1a1e+0x2687+-0xc69],_0x386736=_0x4e07e9+_0x445f6f,_0x419e32=_0xadc0['EpwIbB'][_0x386736];if(!_0x419e32){const _0x283985=function(_0x360d89){this['CBZYQl']=_0x360d89,this['ompwmw']=[0x285+-0x2099+-0x3*-0xa07,0x102d+0x20a9+-0x30d6,0xcef*0x3+-0x3*-0x799+-0x7b3*0x8],this['WueAsg']=function(){return'newState';},this['KvINrP']='\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*',this['XVHnWv']='[\x27|\x22].+[\x27|\x22];?\x20*}';};_0x283985['prototype']['lItkzl']=function(){const _0x28186f=new RegExp(this['KvINrP']+this['XVHnWv']),_0xe801d8=_0x28186f['test'](this['WueAsg']['toString']())?--this['ompwmw'][-0xa0a+0x44f*-0x6+-0xbf7*-0x3]:--this['ompwmw'][-0x66e*-0x5+0x1e77+0x27*-0x19b];return this['zBAhbX'](_0xe801d8);},_0x283985['prototype']['zBAhbX']=function(_0x2e974d){if(!Boolean(~_0x2e974d))return _0x2e974d;return this['uXJufQ'](this['CBZYQl']);},_0x283985['prototype']['uXJufQ']=function(_0x81524a){for(let _0x15d971=-0x4*0x17d+-0xa2*-0x3+0x40e,_0xbc83d0=this['ompwmw']['length'];_0x15d971<_0xbc83d0;_0x15d971++){this['ompwmw']['push'](Math['round'](Math['random']())),_0xbc83d0=this['ompwmw']['length'];}return _0x81524a(this['ompwmw'][0x61*0x3f+0x16ad+-0x6*0x7c2]);},new _0x283985(_0xadc0)['lItkzl'](),_0x145971=_0xadc0['qKyOtT'](_0x145971),_0xadc0['EpwIbB'][_0x386736]=_0x145971;}else _0x145971=_0x419e32;return _0x145971;}import{stylishConfirm}from'./ui_common.js';import{mergeAdjacentMessages,replaceAllPlaceholders,replacePlaceholder as _0x1dbf8d}from'./promptProcessor.js';function replacePlaceholder(_0x1490fb,_0x33644d,_0x1dadbd,_0x39994c){const _0x217304={'REFZM':function(_0x5da6bb,_0x3f4f8f){return _0x5da6bb(_0x3f4f8f);},'lEgjO':'input','yomYt':_0x3a0f18(-0xe7,-0xb5,-0x187,-0x113),'XKMyK':'facialFeat'+_0x58728e(0x26e,0x2c3,0x2b1,0x28b),'pfvsi':_0x3a0f18(-0x1a5,-0x1e3,-0x1f6,-0x153)+_0x3a0f18(-0x75,-0xfb,-0x10d,-0x38),'UZyWX':_0x3a0f18(-0xe1,-0x108,-0x111,-0xd2)+'FW','HQNQF':_0x3a0f18(-0xe1,-0x55,-0x95,-0xf0)+_0x58728e(0x1c7,0x1ed,0x1b9,0x163),'LVDME':_0x3a0f18(-0x117,-0xd0,-0x1ab,-0x6f)+_0x3a0f18(-0xef,-0xff,-0x166,-0xca),'snNaI':_0x3a0f18(-0x117,-0xcc,-0x168,-0x77)+_0x3a0f18(-0x11a,-0x196,-0x122,-0x186),'LWRDc':function(_0x29e846,_0xd13bef){return _0x29e846!==_0xd13bef;},'TNqss':function(_0x1e9cdb,_0x1a670e){return _0x1e9cdb===_0x1a670e;},'wBVzI':_0x3a0f18(-0x147,-0x1e1,-0xbd,-0x194),'cBdHQ':function(_0x5c2f61,_0x2eba9d){return _0x5c2f61!==_0x2eba9d;},'bBpQm':_0x3a0f18(-0x18f,-0x1c9,-0x23a,-0x148),'DvSIS':'YvgIT','vnAlG':function(_0x410a7d,_0x412601){return _0x410a7d===_0x412601;},'TLZWm':_0x3a0f18(-0x67,-0x89,0x19,-0x2),'BexFK':_0x58728e(0x18d,0x103,0x206,0x16e),'mMNwW':function(_0x14a258,_0x4136c2,_0x31ec2a,_0xfc3784,_0x307f3c){return _0x14a258(_0x4136c2,_0x31ec2a,_0xfc3784,_0x307f3c);}};if(_0x217304['TNqss'](typeof _0x1490fb,_0x217304['wBVzI'])){if(_0x217304[_0x58728e(0x227,0x1ce,0x241,0x272)](_0x217304[_0x58728e(0x124,0x143,0x126,0x1a5)],_0x3a0f18(-0x18f,-0x201,-0x21c,-0x182)))_0x269805=_0x58728e(0x15e,0x158,0x28a,0x1f7)+_0x58728e(0x190,0x22c,0x23e,0x196)+[..._0x5d315f][_0x58728e(0x23a,0x28f,0x1bd,0x1f0)]('、')+'\x0a';else{if(_0x1dadbd&&_0x1490fb['includes'](_0x33644d)){if(_0x217304[_0x3a0f18(-0x183,-0x1c4,-0x22a,-0x1b8)]('RGWTQ',_0x217304[_0x58728e(0x11c,0x172,0x164,0x192)]))_0x39994c&&_0x39994c[_0x58728e(0x192,0x173,0x10a,0x19a)](_0x33644d);else{const _0x5d24ee=[_0x3a0f18(-0x194,-0x204,-0x135,-0x209),_0x217304[_0x58728e(0x2b5,0x2f7,0x2e9,0x262)],_0x217304[_0x58728e(0x1bc,0x1ea,0x17d,0x1a3)],_0x217304[_0x3a0f18(-0xf4,-0xae,-0xbd,-0x153)],_0x217304[_0x3a0f18(-0xc7,-0x3e,-0xc5,-0x26)],_0x217304[_0x3a0f18(-0x12c,-0xda,-0x131,-0x17e)],_0x58728e(0x2fa,0x20f,0x2f3,0x26e)+'W',_0x58728e(0x2f7,0x2ed,0x235,0x26e)+'WBack',_0x217304[_0x58728e(0x134,0x232,0x229,0x18b)],_0x217304[_0x3a0f18(-0x1a2,-0x221,-0x17d,-0x208)],_0x58728e(0x1ef,0x272,0x244,0x1e8)+'FW','fullBodyNS'+_0x58728e(0x1b5,0x1ce,0x145,0x163)];_0x5d24ee[_0x58728e(0x11c,0x10c,0x125,0x16b)](_0x2d1a20=>{function _0x27fa47(_0x8e49bb,_0x5a3dd7,_0x8d618d,_0x37027c){return _0x3a0f18(_0x8e49bb-0xa,_0x8d618d,_0x8d618d-0x1bc,_0x37027c-0x12d);}function _0x1d8c7b(_0x184433,_0x43b3a3,_0x240fec,_0x430d3f){return _0x3a0f18(_0x43b3a3-0x2b7,_0x430d3f,_0x240fec-0x14c,_0x430d3f-0x1a4);}if(_0x3a838c[_0x2d1a20]){const _0x1c095b=_0x166b5d[_0x1d8c7b(0x215,0x25e,0x1eb,0x2f2)+_0x27fa47(-0x135,-0xaf,-0xa7,-0xac)](_0x27fa47(-0x172,-0x155,-0x1fe,-0x1cb)+_0x2d1a20);_0x1c095b&&(_0x1c095b['value']=_0x165605[_0x2d1a20],_0x217304[_0x27fa47(-0x189,-0x183,-0x154,-0x20f)](_0x3e9eb1,_0x1c095b)[_0x1d8c7b(0x1c0,0x153,0x1ca,0x1cd)](_0x217304[_0x1d8c7b(0x1a7,0x22d,0x21f,0x288)]));}});}}return _0x1490fb['replaceAll'](_0x33644d,_0x1dadbd);}}function _0x58728e(_0x26454a,_0x234c5e,_0x5624ea,_0x280950){return _0xadc0(_0x280950- -0xad,_0x234c5e);}if(Array[_0x58728e(0x16b,0x1db,0x111,0x1a4)](_0x1490fb))return _0x1490fb['map'](_0x29b30e=>replacePlaceholder(_0x29b30e,_0x33644d,_0x1dadbd,_0x39994c));function _0x3a0f18(_0x1b3a20,_0x3e252d,_0x542372,_0x34de0a){return _0xadc0(_0x1b3a20- -0x396,_0x3e252d);}if(_0x1490fb&&_0x217304['vnAlG'](typeof _0x1490fb,_0x217304['TLZWm'])){if(_0x217304[_0x58728e(0x246,0x217,0x1f4,0x1ef)](_0x217304[_0x3a0f18(-0x13d,-0x13e,-0x162,-0x17a)],_0x217304[_0x58728e(0x140,0x1b7,0x114,0x1ac)])){const _0x2d925d={};for(const _0x277b24 in _0x1490fb){_0x2d925d[_0x277b24]=_0x217304['mMNwW'](replacePlaceholder,_0x1490fb[_0x277b24],_0x33644d,_0x1dadbd,_0x39994c);}return _0x2d925d;}else{const _0x30a2c5={};_0x30a2c5[_0x3a0f18(-0x133,-0x131,-0x184,-0x171)]=[];const _0x13155c=_0x30a2c5;_0x40abf1=_0x5b7e83[_0x58728e(0x191,0x24d,0x141,0x1e7)](/<thinking>[\s\S]*?<\/thinking>/gi,'')[_0x58728e(0x1cf,0x1df,0x15d,0x1d9)]();const _0x3c583e=/<人物>([\s\S]*?)<\/人物>/g;let _0xde1003;while(_0x217304['LWRDc'](_0xde1003=_0x3c583e[_0x3a0f18(-0x99,-0xea,-0x63,-0x143)](_0x6c56cc),null)){const _0x3bc415=_0x217304[_0x58728e(0x1c8,0x104,0xd7,0x156)](_0x500f03,_0xde1003[0x329*0x5+0xbe8*0x1+-0x1bb4]),_0x548840=_0x209529(_0x3bc415);_0x548840&&_0x13155c[_0x58728e(0x20e,0x23a,0x21f,0x1b6)][_0x58728e(0x16c,0x1a7,0x1be,0x1de)](_0x548840);}return _0x13155c;}}return _0x1490fb;}function attachImagesToMessage(_0x4cec33,_0x30079a,_0x435248,_0x412724='参考图片'){const _0x413176={'FolVB':_0x32a87e(0x13,-0x16,0x5e,0x1b),'trOGC':function(_0x47044b,_0x1afe32){return _0x47044b>_0x1afe32;},'NsAze':_0x32a87e(-0x9c,-0x75,-0xcc,-0x108),'uqeJe':function(_0x518264,_0x34ae4d){return _0x518264(_0x34ae4d);},'YIKyW':function(_0x436cf2,_0x2b24f1){return _0x436cf2===_0x2b24f1;},'aHElR':'QJFxD','fkleY':_0x5c0e8a(0x240,0x120,0x1a6,0x1be),'DveRY':_0x32a87e(-0xc,-0x23,0x7a,0x64),'NZWpW':function(_0x74f45b,_0xc92bfc){return _0x74f45b===_0xc92bfc;},'qVnzn':function(_0x4b752c,_0x3e8c49){return _0x4b752c+_0x3e8c49;},'WWDtO':'text','hNgeA':_0x5c0e8a(0x27c,0x275,0x139,0x1da),'ZWcfi':_0x32a87e(0xf9,0x59,-0x17,0x3e),'KjUls':_0x32a87e(0x7a,0x94,0x10c,0x134),'BCMqy':_0x32a87e(-0x38,0x50,0x70,-0x5a),'ZVWeg':function(_0x11260b,_0x2e5898){return _0x11260b<_0x2e5898;},'wvhfo':function(_0x2d30bd,_0x29b86f){return _0x2d30bd>_0x29b86f;}};if(!_0x435248||_0x413176[_0x5c0e8a(0x248,0x241,0x224,0x237)](_0x435248[_0x5c0e8a(0x104,0x11c,0xe1,0x158)],-0x23af+0x4*-0x4d9+0x3713)||_0x413176[_0x5c0e8a(0x1d5,0x20b,0x22a,0x223)](_0x30079a,-0x1c06+0x501*0x1+-0x1*-0x1705)||_0x30079a>=_0x4cec33[_0x32a87e(-0x42,-0x6c,0x16,-0xf3)])return _0x4cec33;const _0x32d9f7=[..._0x4cec33],_0x9670f1=_0x32d9f7[_0x30079a],_0x35e622=[];function _0x5c0e8a(_0xa47d3a,_0x31e81f,_0x57beb8,_0x51f955){return _0xadc0(_0x51f955- -0xae,_0x57beb8);}if(typeof _0x9670f1[_0x32a87e(0x17,0x97,0xcb,0x108)]===_0x413176['DveRY']){const _0x57fd23={};_0x57fd23[_0x5c0e8a(0x1c4,0x289,0x2d4,0x254)]=_0x413176[_0x32a87e(-0x3f,0x54,-0x5,-0x2)],_0x57fd23[_0x32a87e(0xfe,0x8a,0xdc,0x86)]=_0x9670f1['content'],_0x35e622['push'](_0x57fd23);}else Array[_0x32a87e(-0x9,-0x21,0x49,0x36)](_0x9670f1[_0x32a87e(0x11f,0x97,0x3,0x12e)])&&_0x35e622['push'](..._0x9670f1[_0x32a87e(0xcf,0x97,-0xe,0x23)]);if(_0x413176[_0x32a87e(-0x21,0x85,0x83,0x56)](_0x435248['length'],-0x4e+0xdc6+-0xd78)){const _0x4c530a={};_0x4c530a['type']=_0x413176[_0x32a87e(0xe2,0x54,0x2c,0x98)],_0x4c530a[_0x5c0e8a(0x1f7,0x244,0x1a7,0x24e)]=_0x5c0e8a(0x161,0x105,0x130,0x185)+_0x435248[_0x32a87e(-0x53,-0x6c,-0x80,-0x105)]+'张'+_0x412724+']',_0x35e622[_0x5c0e8a(0x231,0x141,0x24d,0x1dd)](_0x4c530a);}_0x435248[_0x32a87e(-0x6a,-0x5a,-0x3d,0x26)]((_0x280358,_0x1bef87)=>{function _0x2bddf7(_0x128ef6,_0x5b0b4d,_0x27eddd,_0x355ab3){return _0x5c0e8a(_0x128ef6-0x15,_0x5b0b4d-0xae,_0x27eddd,_0x128ef6- -0xdf);}const _0x58ff51={'ftkHz':_0x413176[_0xe9659d(0x236,0x1aa,0x1c4,0x292)],'TBWpU':function(_0x5cb99c,_0x36d7e4){function _0x444f3c(_0x736bc,_0x5ccfb1,_0x1e70d3,_0x460eab){return _0xe9659d(_0x736bc- -0x165,_0x460eab,_0x1e70d3-0x1dd,_0x460eab-0xda);}return _0x413176[_0x444f3c(0xb6,0xce,0x13d,0x135)](_0x5cb99c,_0x36d7e4);},'zjkEx':function(_0x516065,_0x173ac9){function _0x5294fc(_0x48f8d5,_0x5a8f6a,_0x479d8d,_0x279882){return _0xe9659d(_0x479d8d-0x4,_0x5a8f6a,_0x479d8d-0x111,_0x279882-0x1ad);}return _0x413176[_0x5294fc(0x226,0x269,0x21f,0x1f9)](_0x516065,_0x173ac9);},'KggRO':_0x413176[_0x2bddf7(0x147,0x12b,0x14c,0xaf)],'gLBUf':function(_0x1c86c8,_0x3d379d){function _0x107774(_0x388742,_0x5d640b,_0xad7f87,_0x5685a1){return _0x2bddf7(_0x388742-0x498,_0x5d640b-0x12b,_0xad7f87,_0x5685a1-0x70);}return _0x413176[_0x107774(0x5a5,0x522,0x5cf,0x571)](_0x1c86c8,_0x3d379d);},'AtThl':_0x2bddf7(0x6d,0xad,0x28,-0x20)};function _0xe9659d(_0x3cff50,_0x352341,_0x550357,_0x445bee){return _0x5c0e8a(_0x3cff50-0x1d7,_0x352341-0x136,_0x352341,_0x3cff50-0x31);}if(_0x413176[_0xe9659d(0x268,0x1c1,0x2a0,0x2b5)](_0x413176['aHElR'],_0x413176[_0x2bddf7(0x112,0x9d,0x166,0xa8)])){const _0x35be51=_0x6cc4da[_0x1b0bf8]||_0x58ff51[_0x2bddf7(0xfa,0xe5,0x8b,0x117)],_0x3ff8d0=_0x18266b[_0x1684e4];_0x363b05+='•\x20'+_0x265307[_0x2e05ca]+':\x0a',_0x1e485e+=_0xe9659d(0x1e9,0x246,0x162,0x280)+_0x35be51[_0xe9659d(0x299,0x260,0x29d,0x2e4)](0x136f+-0xc*0x24f+0x49*0x1d,0x24*0xb3+0x1*0x11ec+-0x2ae6)+(_0x58ff51['TBWpU'](_0x35be51['length'],-0x1*-0x2501+0x25f9+-0x4ac8)?_0x2bddf7(0x70,0x40,-0x38,0xea):'')+'\x0a',_0xa8a42+=_0xe9659d(0x272,0x1da,0x21d,0x1e3)+_0x3ff8d0[_0xe9659d(0x299,0x2c4,0x332,0x284)](-0x1*0x1204+-0x9*0x17+0x12d3,0x1a17*-0x1+-0xc22*-0x2+0x2f*0xb)+(_0x58ff51[_0x2bddf7(0x84,0xec,0x59,0x25)](_0x3ff8d0[_0xe9659d(0x189,0xe5,0x140,0x1e9)],-0x1c67*-0x1+-0x12cb+-0x96a)?_0x58ff51[_0xe9659d(0x2bc,0x33f,0x258,0x2e3)]:'')+'\x0a\x0a',_0x28283b++;}else{const _0x97b75b=_0x413176[_0xe9659d(0x268,0x2d2,0x1ce,0x1c4)](typeof _0x280358,_0x413176[_0xe9659d(0x23e,0x204,0x1e6,0x223)])?_0x280358:_0x280358[_0x2bddf7(0xe5,0xbc,0x189,0x133)],_0x88a6b0=_0x413176['NZWpW'](typeof _0x280358,_0xe9659d(0x2b2,0x318,0x276,0x31d))&&_0x280358['name']?_0x280358[_0x2bddf7(0x16e,0x10c,0x1aa,0x211)]:''+_0x412724+_0x413176['qVnzn'](_0x1bef87,0xd*-0x7a+-0x545+0xb78),_0x23af31={};_0x23af31[_0x2bddf7(0x175,0x1fe,0x110,0x20d)]=_0x413176['WWDtO'],_0x23af31['text']='['+_0x88a6b0+']',_0x35e622[_0x2bddf7(0xfe,0x11d,0x163,0x159)](_0x23af31);let _0x43d2f3=_0x97b75b;if(!_0x97b75b['startsWith'](_0x413176['hNgeA'])){if(_0x413176['ZWcfi']==='WnKum'){const _0x301a33=_0x24d928[_0xe9659d(0x2c0,0x2b2,0x31b,0x2a9)+'ById'](_0xe9659d(0x19d,0x195,0x184,0x164)+_0x48b838);_0x301a33&&(_0x301a33[_0xe9659d(0x28a,0x320,0x210,0x21d)]=_0x33f943[_0x64a5],_0x58ff51[_0x2bddf7(0x8f,-0x14,0x120,0x4e)](_0x24a8b7,_0x301a33)[_0x2bddf7(0xa5,0x5c,0x9f,0x8c)](_0x58ff51[_0x2bddf7(0x199,0x125,0x238,0x17f)]));}else _0x43d2f3=_0x2bddf7(0xd8,0xba,0x70,0x79)+_0xe9659d(0x251,0x28d,0x2a2,0x25b)+'4,'+_0x97b75b;}const _0x3b6f23={};_0x3b6f23[_0xe9659d(0x285,0x2af,0x2af,0x27e)]=_0x413176[_0x2bddf7(0x114,0xec,0x168,0x190)],_0x3b6f23[_0xe9659d(0x289,0x26f,0x244,0x30d)]={},_0x3b6f23[_0xe9659d(0x289,0x26f,0x244,0x30d)][_0xe9659d(0x2a1,0x298,0x208,0x30d)]=_0x43d2f3,_0x3b6f23[_0xe9659d(0x289,0x26f,0x244,0x30d)][_0x2bddf7(0x132,0xbd,0x152,0xd4)]=_0x413176[_0xe9659d(0x234,0x1af,0x26d,0x2c0)],_0x35e622['push'](_0x3b6f23);}});const _0x172307={..._0x9670f1};_0x172307['content']=_0x35e622,_0x32d9f7[_0x30079a]=_0x172307;function _0x32a87e(_0xdf20d7,_0x5b42e7,_0x416985,_0x3ee70b){return _0xadc0(_0x5b42e7- -0x272,_0xdf20d7);}return _0x32d9f7;}function findMessageIndexWithPlaceholder(_0x3f57f9,_0x41f4a0){const _0x54c8c0={};_0x54c8c0['cDqvr']=_0x483698(0x5de,0x5b8,0x584,0x57d)+_0x326af8(0x29f,0x329,0x20e,0x2ae);function _0x483698(_0x6c4dfd,_0x22fa41,_0x155366,_0x56f9e8){return _0xadc0(_0x22fa41-0x38c,_0x56f9e8);}_0x54c8c0[_0x483698(0x5a5,0x611,0x576,0x5fa)]=function(_0xa35264,_0x23b214){return _0xa35264===_0x23b214;},_0x54c8c0[_0x326af8(0x2ac,0x2a4,0x23b,0x272)]=_0x326af8(0x21b,0x20a,0x2fd,0x2b4);function _0x326af8(_0x40673e,_0x359ad1,_0xe10ff2,_0x1cbb03){return _0xadc0(_0x1cbb03-0x65,_0xe10ff2);}_0x54c8c0[_0x326af8(0x2d6,0x306,0x385,0x350)]=_0x483698(0x620,0x5fd,0x58f,0x652),_0x54c8c0[_0x326af8(0x246,0x204,0x1ca,0x266)]=_0x483698(0x722,0x688,0x635,0x67f),_0x54c8c0[_0x326af8(0x429,0x41c,0x403,0x390)]=_0x326af8(0x2f3,0x28b,0x315,0x28d),_0x54c8c0[_0x326af8(0x23b,0x2c0,0x1c4,0x260)]=_0x483698(0x698,0x6c1,0x699,0x6a0);const _0x951ad9=_0x54c8c0;for(let _0x2982a6=-0x1*-0xf38+-0xdec*-0x1+0x749*-0x4;_0x2982a6<_0x3f57f9[_0x483698(0x5ba,0x592,0x529,0x54b)];_0x2982a6++){const _0x573167=_0x3f57f9[_0x2982a6];if(_0x951ad9[_0x326af8(0x31c,0x2d2,0x2fd,0x2ea)](typeof _0x573167[_0x326af8(0x389,0x3df,0x3c5,0x36e)],_0x951ad9['fSsTy'])&&_0x573167[_0x483698(0x6fb,0x695,0x65b,0x72e)][_0x483698(0x648,0x6b6,0x6c3,0x653)](_0x41f4a0))return _0x951ad9[_0x483698(0x5d8,0x611,0x568,0x6aa)](_0x951ad9['HpXob'],_0x951ad9['HpXob'])?_0x2982a6:null;else{if(Array[_0x326af8(0x33e,0x2c9,0x211,0x2b6)](_0x573167[_0x483698(0x6f3,0x695,0x651,0x72a)]))for(const _0x4953ec of _0x573167[_0x326af8(0x2cf,0x404,0x31e,0x36e)]){if(_0x951ad9[_0x326af8(0x319,0x2e3,0x311,0x2ea)](_0x4953ec[_0x326af8(0x33b,0x33e,0x353,0x367)],_0x951ad9['FGvLV'])&&_0x4953ec[_0x483698(0x630,0x688,0x667,0x5f2)][_0x483698(0x6d3,0x6b6,0x6ae,0x755)](_0x41f4a0)){if(_0x951ad9['YdbeB']===_0x951ad9[_0x326af8(0x239,0x2f7,0x258,0x260)]){_0x5ea0f0[_0x483698(0x5c2,0x5a5,0x58d,0x5d9)](_0x951ad9[_0x483698(0x5f6,0x63c,0x6a1,0x5e3)]),_0x4a0388[_0x326af8(0x35c,0x35d,0x2bb,0x341)](_0x483698(0x610,0x661,0x6cb,0x5eb)+_0x483698(0x60e,0x67c,0x6ff,0x68d)+_0x326af8(0x1ea,0x27d,0x2c8,0x263)+'racter\x20tag'+_0x483698(0x655,0x5bb,0x547,0x55f)+_0x483698(0x61e,0x5c3,0x5bb,0x59f)),_0x32e581[_0x483698(0x6fd,0x668,0x69e,0x677)]('[character'+'PromptModi'+_0x483698(0x5dd,0x61f,0x6a5,0x6c3)+_0x483698(0x6cc,0x642,0x6d4,0x6d5)+_0x483698(0x5d4,0x645,0x6b7,0x630)+_0x326af8(0x2cc,0x320,0x2d3,0x343),_0x99b8fa);return;}else return _0x2982a6;}}}}return-(0x228d*0x1+0x19d3+-0x1*0x3c5f);}function generateRequestId(){const _0x57a271={};_0x57a271[_0x36dc31(0x75e,0x6b3,0x6ed,0x72a)]=function(_0x1024fe,_0x3138a3){return _0x1024fe+_0x3138a3;};function _0x509fb3(_0x3583a3,_0x2232ac,_0x4d38e5,_0x1dcf6){return _0xadc0(_0x3583a3-0x10f,_0x4d38e5);}function _0x36dc31(_0x311d3f,_0x196505,_0x2fbbec,_0x4156b5){return _0xadc0(_0x196505-0x3c0,_0x4156b5);}const _0x4c97b7=_0x57a271;if(crypto&&crypto[_0x36dc31(0x6c9,0x666,0x634,0x5d0)])return crypto[_0x509fb3(0x3b5,0x419,0x3d6,0x3fd)]();return _0x4c97b7[_0x36dc31(0x6db,0x6b3,0x6c3,0x6bb)](Date[_0x36dc31(0x672,0x5ee,0x631,0x614)]()['toString'](-0x254c+-0x1f92+-0x646*-0xb),Math[_0x36dc31(0x61f,0x618,0x5a5,0x62a)]()[_0x509fb3(0x30e,0x350,0x2b6,0x2f8)](-0x515*0x2+-0xcd5+0x1723)[_0x509fb3(0x425,0x4b8,0x3b3,0x3f7)](-0x1222+0x1*-0x1cdc+0x2f00));}export function LLM_CHAR_MODIFY_GET_PROMPT(){function _0x56b052(_0x2ac8b7,_0x29102b,_0x2d6368,_0x2f24d2){return _0xadc0(_0x29102b-0x277,_0x2f24d2);}function _0x1af1e0(_0x35e5e5,_0x276dea,_0x118266,_0x13fe21){return _0xadc0(_0x118266- -0x17c,_0x276dea);}const _0x1516dd={'gRxgP':_0x1af1e0(0x19f,0x1bf,0x147,0x134),'ZUUUW':function(_0x1a6ecc,_0x5da0e3){return _0x1a6ecc!==_0x5da0e3;},'MPtlb':function(_0x5927af,_0x453957){return _0x5927af(_0x453957);},'NVVUe':_0x1af1e0(0x10c,0x218,0x19c,0x11f),'safSN':'获取角色修改提示词超'+'时','MuLDk':'akWze','deAHR':_0x1af1e0(0x12c,0x1c6,0x1ab,0x198),'cgPCQ':function(_0x99ffa3){return _0x99ffa3();},'RRBaP':function(_0x5454d5,_0x5c8558,_0x441ad2){return _0x5454d5(_0x5c8558,_0x441ad2);}};return new Promise((_0x51e743,_0x166437)=>{const _0x5837eb={};function _0x21f3b7(_0x4c63d7,_0x1fd53d,_0x59d5c3,_0x2791f4){return _0x1af1e0(_0x4c63d7-0xb2,_0x59d5c3,_0x2791f4-0x5,_0x2791f4-0x92);}_0x5837eb[_0x21f3b7(0xce,0x15a,0xbd,0x12e)]=_0x1516dd[_0x3607b7(0x514,0x4e6,0x546,0x470)],_0x5837eb['qZxdp']=_0x1516dd[_0x3607b7(0x547,0x5db,0x529,0x4ae)];function _0x3607b7(_0xfbb16f,_0x2c9636,_0x1dda5b,_0x21ad36){return _0x1af1e0(_0xfbb16f-0x1d8,_0x2c9636,_0xfbb16f-0x383,_0x21ad36-0x1df);}const _0x3289f2=_0x5837eb;if(_0x1516dd[_0x3607b7(0x4a7,0x509,0x47b,0x428)]===_0x1516dd[_0x3607b7(0x4fd,0x4e4,0x4cd,0x470)]){_0x19be12['error'](_0x3289f2[_0x3607b7(0x4ac,0x4cc,0x54e,0x4ca)]);return;}else{const _0x55ea71=_0x1516dd[_0x3607b7(0x3f6,0x43a,0x363,0x436)](generateRequestId);console[_0x21f3b7(0x189,0x131,0x1b2,0x165)](_0x21f3b7(0x130,0x1fd,0x115,0x15e)+'PromptModi'+'fy]\x20Reques'+'ting\x20char\x20'+_0x3607b7(0x530,0x596,0x591,0x48c)+_0x3607b7(0x4e2,0x569,0x55a,0x572)+_0x55ea71+')');const _0x1b6116=_0x236bcd=>{function _0x491446(_0x1729ca,_0x4cca29,_0x3e7ad3,_0x5dfe5a){return _0x3607b7(_0x4cca29-0x1b3,_0x3e7ad3,_0x3e7ad3-0x5b,_0x5dfe5a-0x8c);}function _0x3081fa(_0x2a7d40,_0x229a69,_0x3f1080,_0x38fe2f){return _0x3607b7(_0x2a7d40- -0x3a,_0x3f1080,_0x3f1080-0x164,_0x38fe2f-0x103);}if(_0x1516dd[_0x3081fa(0x3f7,0x36a,0x428,0x361)]!==_0x1516dd[_0x491446(0x602,0x5e4,0x678,0x5ad)]){const _0x153d03={};for(const _0x527908 in _0x502040){_0x153d03[_0x527908]=_0x236fbd(_0x10227c[_0x527908],_0x2067d0,_0x310a6b,_0x4b9f85);}return _0x153d03;}else{if(_0x1516dd[_0x491446(0x584,0x625,0x5e6,0x5d0)](_0x236bcd['id'],_0x55ea71))return;eventSource[_0x3081fa(0x411,0x47f,0x486,0x48a)+_0x3081fa(0x3f0,0x426,0x3b3,0x425)](eventNames[_0x491446(0x659,0x6be,0x73f,0x6a5)+_0x491446(0x6d1,0x6ce,0x6df,0x67a)+_0x491446(0x685,0x664,0x65b,0x67e)+_0x491446(0x5f1,0x5da,0x671,0x5f3)],_0x1b6116),_0x1516dd[_0x3081fa(0x484,0x462,0x417,0x3f6)](_0x51e743,_0x236bcd[_0x3081fa(0x4f2,0x4e1,0x507,0x538)]);}};eventSource['on'](eventNames[_0x3607b7(0x50b,0x575,0x519,0x58f)+_0x3607b7(0x51b,0x48a,0x55d,0x523)+'PROMPT_RES'+_0x3607b7(0x427,0x4d0,0x3b7,0x40e)],_0x1b6116);const _0x1eb463={};_0x1eb463['id']=_0x55ea71,eventSource[_0x3607b7(0x42d,0x4a5,0x42e,0x386)](eventNames[_0x3607b7(0x50b,0x48a,0x4cf,0x588)+_0x21f3b7(0x161,0x103,0x1db,0x19d)+_0x21f3b7(0x120,0x197,0x15d,0x101)+'UEST'],_0x1eb463),_0x1516dd['RRBaP'](setTimeout,()=>{eventSource['removeList'+_0x555205(0x36b,0x37b,0x3ee,0x3ef)](eventNames[_0x555205(0x4d8,0x4a8,0x53c,0x4d0)+_0x391a82(0x638,0x610,0x675,0x5f2)+_0x555205(0x4f4,0x4ea,0x514,0x476)+_0x391a82(0x544,0x4d3,0x523,0x4ac)],_0x1b6116);function _0x555205(_0x5353d5,_0x221637,_0x2a7076,_0x13c9be){return _0x21f3b7(_0x5353d5-0xa7,_0x221637-0x1bc,_0x5353d5,_0x13c9be-0x343);}function _0x391a82(_0x1f8aa5,_0x58db5d,_0x3cab17,_0x2d9b12){return _0x21f3b7(_0x1f8aa5-0x6c,_0x58db5d-0x141,_0x3cab17,_0x1f8aa5-0x49b);}_0x166437(new Error(_0x3289f2['qZxdp']));},0x3afb+-0xe7*0x45+0x4*0xa96);}});}export function LLM_CHAR_MODIFY(_0x134ce9,_0x2c3e26={}){function _0x4fad60(_0x1774ee,_0x299e92,_0x3b3e5b,_0x5f2e2a){return _0xadc0(_0x3b3e5b-0xc3,_0x1774ee);}function _0x56a3e1(_0x2b4176,_0x2ba5a8,_0x3151ae,_0x2b1be5){return _0xadc0(_0x2b1be5- -0x15e,_0x2b4176);}const _0x402a3f={'rebiH':function(_0x14f825,_0x5aea93){return _0x14f825(_0x5aea93);},'DIfCv':_0x4fad60(0x299,0x3ab,0x321,0x339),'TrmlZ':function(_0x450b5e,_0x2cb93d){return _0x450b5e===_0x2cb93d;},'LxNAC':_0x56a3e1(0x14e,0xce,0x85,0x101),'XZVeb':'sLmhB','kEzpV':_0x56a3e1(0x218,0x110,0x23a,0x19e),'bprUX':function(_0x4b6844){return _0x4b6844();},'fEebc':_0x56a3e1(0x188,0x17c,0x105,0x181),'pGnmG':_0x56a3e1(0x130,0x1d0,0x1bb,0x17b),'ZDFQJ':function(_0x56ce0d){return _0x56ce0d();},'txbhS':function(_0x3fdfe5,_0x3c194b,_0x3d56b9){return _0x3fdfe5(_0x3c194b,_0x3d56b9);}};return new Promise((_0x392158,_0x19226f)=>{const _0x53ff6f={'vKjZU':_0x402a3f[_0x107408(0x397,0x419,0x33f,0x3d6)],'hJnyJ':_0x5071f6(-0x1ef,-0x114,-0x16d,-0x14c)+'+$','bmwWh':function(_0x28705d,_0x1e8507){return _0x28705d!==_0x1e8507;},'HgEqx':function(_0x2b56cd){function _0x5dd2dd(_0x87d674,_0x2f7a45,_0x21d76c,_0x3469c6){return _0x5071f6(_0x87d674-0x18f,_0x3469c6,_0x21d76c-0x4d,_0x21d76c-0x2bd);}return _0x402a3f[_0x5dd2dd(0x1e6,0x2d4,0x256,0x23a)](_0x2b56cd);},'xCwVe':'Phvwd','kveFB':function(_0x443432,_0x42350b){return _0x443432(_0x42350b);}};function _0x5071f6(_0x1a7a2a,_0xa41fe5,_0x2c14e1,_0x26689a){return _0x4fad60(_0xa41fe5,_0xa41fe5-0x1be,_0x26689a- -0x465,_0x26689a-0x7a);}function _0x107408(_0x1c6e4a,_0x1bd231,_0xe8c9f0,_0x31bafd){return _0x56a3e1(_0x31bafd,_0x1bd231-0x18b,_0xe8c9f0-0x123,_0x1c6e4a-0x22c);}if(_0x402a3f[_0x5071f6(-0xfa,-0xbf,-0x13b,-0x164)]===_0x402a3f[_0x107408(0x3d6,0x3ae,0x467,0x3a5)])_0x402a3f[_0x5071f6(-0x19f,-0x14f,-0x1be,-0x11f)](_0x1c04ed,new _0x29e3ee(_0x24f890[_0x5071f6(-0xd6,-0xf2,-0xf0,-0x15c)]||_0x402a3f[_0x107408(0x3e0,0x455,0x39b,0x3fb)]));else{const _0x5557b1=_0x402a3f[_0x107408(0x379,0x2da,0x3cb,0x3b7)](generateRequestId),_0x446ad9=_0x2c3e26[_0x5071f6(-0x1c4,-0x130,-0x10d,-0x17d)]||-0x3*-0x95b7+0xd329*-0x1+-0x4d*0xc;let _0x13ef65=null;console[_0x107408(0x3aa,0x39a,0x419,0x33c)](_0x107408(0x3a3,0x343,0x377,0x417)+_0x107408(0x3be,0x3d1,0x383,0x321)+_0x5071f6(-0x161,-0x10f,-0x100,-0xca)+_0x5071f6(-0x193,-0x202,-0x1e4,-0x1b0)+_0x107408(0x40c,0x46e,0x44d,0x4b8)+'request\x20(I'+_0x107408(0x37c,0x2f6,0x40f,0x400)+_0x5557b1+')');const _0x18ddb3=()=>{function _0x1e684a(_0x5f35b7,_0x2217be,_0x1dfd49,_0x1cd124){return _0x107408(_0x5f35b7- -0x185,_0x2217be-0x7c,_0x1dfd49-0x5f,_0x2217be);}function _0x441a10(_0x94e353,_0x51efac,_0x5dd2ad,_0x13aeaf){return _0x5071f6(_0x94e353-0x15,_0x94e353,_0x5dd2ad-0x1f0,_0x51efac-0x470);}eventSource[_0x1e684a(0x18d,0x19d,0x227,0x10f)+_0x1e684a(0x16c,0xf0,0xe0,0x179)](eventNames[_0x1e684a(0x24d,0x2d5,0x2da,0x205)+_0x1e684a(0x186,0x181,0xde,0x137)+'ONSE'],_0x5bf422);if(_0x13ef65){if(_0x402a3f[_0x441a10(0x2e4,0x2f9,0x362,0x34c)](_0x402a3f[_0x1e684a(0x1df,0x1a6,0x216,0x1f8)],_0x402a3f[_0x441a10(0x30a,0x344,0x357,0x309)])){const _0x16b6ab={};_0x16b6ab[_0x441a10(0x362,0x3d0,0x368,0x3c2)]=_0x53ff6f['vKjZU'],_0x16b6ab[_0x441a10(0x346,0x3ca,0x3c4,0x3c1)]=_0x4e07e9[_0x1e684a(0x252,0x281,0x2f8,0x275)],_0x24dc9a[_0x441a10(0x3ec,0x359,0x388,0x35c)](_0x16b6ab);}else _0x402a3f[_0x441a10(0x37f,0x351,0x355,0x35a)](clearTimeout,_0x13ef65),_0x13ef65=null;}},_0x5bf422=_0x3126ea=>{if(_0x53ff6f[_0x4a8174(0x3b3,0x345,0x396,0x3ad)](_0x3126ea['id'],_0x5557b1))return;_0x53ff6f[_0x4a8174(0x3a1,0x31d,0x359,0x413)](_0x18ddb3);function _0xc0e1d1(_0x4955d9,_0x32d250,_0x57be7c,_0x2ce382){return _0x107408(_0x32d250- -0x487,_0x32d250-0x97,_0x57be7c-0xf1,_0x4955d9);}function _0x4a8174(_0x1dea5a,_0x419934,_0x2262ad,_0x274534){return _0x107408(_0x1dea5a-0xc1,_0x419934-0x12c,_0x2262ad-0x129,_0x274534);}if(_0x3126ea[_0x4a8174(0x3fc,0x366,0x3b2,0x48e)]){if(_0x53ff6f['bmwWh'](_0x53ff6f[_0xc0e1d1(-0xea,-0xe3,-0x142,-0x87)],_0x53ff6f[_0x4a8174(0x465,0x4a3,0x47d,0x450)]))return _0x23e256[_0x4a8174(0x38e,0x350,0x3ea,0x3f6)]()[_0x4a8174(0x408,0x3de,0x451,0x4ae)](iZMZLS[_0xc0e1d1(-0x143,-0x184,-0x156,-0x143)])[_0xc0e1d1(-0x1fb,-0x1ba,-0x12b,-0x18b)]()[_0x4a8174(0x462,0x489,0x460,0x408)+'r'](_0x208db6)['search'](iZMZLS[_0x4a8174(0x3c4,0x40a,0x44c,0x38a)]);else _0x392158(_0x3126ea[_0x4a8174(0x3d5,0x33c,0x3c7,0x3d5)]);}else _0x19226f(new Error(_0x3126ea[_0x4a8174(0x3d5,0x3bb,0x3d6,0x3a9)]||'LLM\x20请求失败'));};eventSource['on'](eventNames[_0x5071f6(-0xde,-0xd6,-0x2a,-0x9e)+_0x107408(0x30b,0x2e7,0x2b6,0x360)+_0x107408(0x404,0x3ee,0x37b,0x3d6)],_0x5bf422);const _0x301f89={};_0x301f89[_0x107408(0x3f3,0x380,0x35c,0x38b)]=_0x134ce9,_0x301f89['id']=_0x5557b1,eventSource[_0x5071f6(-0x1ab,-0x1b4,-0xdc,-0x17c)](eventNames[_0x5071f6(-0x24,-0x10d,-0x5e,-0x9e)+_0x107408(0x38f,0x3ef,0x2f8,0x3e0)+_0x107408(0x2f5,0x2b9,0x36c,0x283)],_0x301f89),_0x13ef65=_0x402a3f['txbhS'](setTimeout,()=>{function _0x19d4ca(_0x450cff,_0x304554,_0x5526ea,_0x2d1d7c){return _0x107408(_0x450cff-0x14e,_0x304554-0x189,_0x5526ea-0x17d,_0x5526ea);}function _0x370acd(_0x5b942a,_0x53fb84,_0x521a03,_0x1d3b59){return _0x107408(_0x521a03- -0x379,_0x53fb84-0x12b,_0x521a03-0x11d,_0x5b942a);}_0x18ddb3(),_0x53ff6f[_0x19d4ca(0x4a8,0x424,0x53d,0x50c)](_0x19226f,new Error(_0x19d4ca(0x516,0x50b,0x4e3,0x509)+_0x370acd(0xb8,0xb,0x36,0xde)));},_0x446ad9);}});}function preprocessTagContent(_0x42e1f7){const _0x12faf8={};_0x12faf8[_0x569f84(0xac,0x129,0xfe,0x110)]=_0x51fe88(0x52d,0x5a0,0x572,0x528),_0x12faf8['RrttZ']=_0x569f84(0x1de,0x183,0x1a2,0x15b);const _0x542708=_0x12faf8;let _0x115642=_0x42e1f7[_0x51fe88(0x4ef,0x445,0x4d4,0x4db)](/:/g,':')[_0x51fe88(0x476,0x453,0x4d4,0x4cd)](/\(/g,'（')['replace'](/\)/g,'）')[_0x51fe88(0x53e,0x46a,0x4d4,0x4c8)](/,/g,',');function _0x51fe88(_0xf51ef4,_0x10ed27,_0x18eab4,_0x55ab0e){return _0xadc0(_0x18eab4-0x240,_0x55ab0e);}_0x115642=_0x115642[_0x569f84(0x15f,0x14f,0xc1,0x1f3)](/下半身NSWebcam:/g,_0x542708[_0x569f84(0xa4,0x129,0xe7,0x104)]),_0x115642=_0x115642['replace'](/下半身NSFW_背面:/g,_0x542708[_0x51fe88(0x4be,0x555,0x4ae,0x447)]),_0x115642=_0x115642['replace'](/上半身NSFW_背面:/g,_0x542708[_0x569f84(0x1df,0x154,0x17d,0xca)]);function _0x569f84(_0x404a2d,_0x296f59,_0x258a14,_0x28fab6){return _0xadc0(_0x296f59- -0x145,_0x28fab6);}return _0x115642;}function parseCharacterData(_0x27790e){function _0xb337b(_0x52edca,_0x3ef8c2,_0x5408f9,_0x1c4050){return _0xadc0(_0x5408f9- -0x353,_0x3ef8c2);}const _0x12ea88={'DEpAR':_0xecdd27(0x5d1,0x634,0x5a6,0x54b),'UEfET':_0xb337b(-0x5d,-0xfb,-0xef,-0xc8)+'时','ERllP':function(_0x58fc3c,_0x329d9d){return _0x58fc3c(_0x329d9d);},'SxaQz':_0xecdd27(0x571,0x59f,0x609,0x5d5),'gKBRG':'facialFeat'+_0xecdd27(0x69e,0x637,0x692,0x62c),'oRYkV':_0xb337b(-0x169,-0x1db,-0x162,-0x183)+_0xecdd27(0x659,0x61a,0x67b,0x726),'RjMjg':'fullBodySF'+'W','njFML':_0xecdd27(0x681,0x6a0,0x675,0x621)+_0xb337b(0x2e,-0x3e,-0x52,0x30),'JXXhP':_0xb337b(-0x33,-0xbb,-0xd4,-0x83)+_0xb337b(-0x13c,-0xee,-0xac,-0xa9),'AYFIQ':_0xecdd27(0x5cc,0x606,0x5d9,0x56c)+_0xb337b(-0x172,-0x15b,-0xd7,-0x127),'bCJSi':'fullBodyNS'+'FW','VXxWx':_0xecdd27(0x61c,0x54b,0x5ef,0x5c6)+_0xecdd27(0x5f3,0x4ee,0x56a,0x600),'tqcMh':function(_0xe22ee1,_0x914a2b){return _0xe22ee1===_0x914a2b;},'SbQPR':function(_0x49aeb9,_0x2caaaa){return _0x49aeb9!==_0x2caaaa;},'yjkRC':'cvvhj','fMfIf':'WQKSJ','XjZHX':_0xb337b(-0x73,-0x1f,-0x37,-0x1),'ZzKrD':_0xecdd27(0x5d2,0x5ca,0x64c,0x65a),'yJCgN':_0xecdd27(0x61f,0x586,0x62f,0x6c2)+'PromptModi'+'fy]\x20解析到的人物'+_0xb337b(-0x9,-0x22,-0x5f,0xb)},_0x3a99d5=_0x27790e[_0xb337b(-0x7f,-0xec,-0xbc,-0x15a)]('\x0a')['map'](_0x825ca5=>_0x825ca5['trim']())['filter'](_0x1df800=>_0x1df800),_0x2d6a41={};_0x2d6a41[_0xecdd27(0x569,0x5e5,0x55c,0x5f9)]='',_0x2d6a41['nameEN']='',_0x2d6a41[_0xecdd27(0x4f0,0x4ec,0x54b,0x56a)+_0xb337b(-0xbe,-0x22,-0x1b,0x25)]='',_0x2d6a41[_0xb337b(-0xf9,-0x167,-0x162,-0x108)+_0xecdd27(0x65b,0x685,0x67b,0x6af)]='',_0x2d6a41[_0xecdd27(0x599,0x66e,0x60f,0x637)+'FW']='',_0x2d6a41[_0xecdd27(0x6b3,0x5d4,0x60f,0x614)+_0xecdd27(0x55a,0x4fd,0x56a,0x538)]='',_0x2d6a41[_0xb337b(-0x31,-0x28,-0x38,-0x5a)+'W']='',_0x2d6a41[_0xecdd27(0x6ab,0x6b0,0x675,0x6a7)+_0xb337b(-0xfb,-0x13,-0x52,-0xc5)]='',_0x2d6a41[_0xecdd27(0x626,0x665,0x5d9,0x588)+_0xecdd27(0x5c7,0x630,0x601,0x5b4)]='',_0x2d6a41[_0xb337b(-0x17f,-0xfc,-0xd4,-0x120)+_0xb337b(-0x9a,-0x77,-0xd7,-0x14c)]='',_0x2d6a41['fullBodyNS'+'FW']='';function _0xecdd27(_0x64d982,_0x4d7fba,_0x3c5b54,_0x47749f){return _0xadc0(_0x3c5b54-0x35a,_0x47749f);}_0x2d6a41['fullBodyNS'+_0xb337b(-0x108,-0x168,-0x143,-0x116)]='';const _0x381d14=_0x2d6a41,_0x5022ac={};_0x5022ac[_0xb337b(-0x1b0,-0x89,-0x10e,-0x8d)]='nameCN',_0x5022ac[_0xecdd27(0x633,0x570,0x603,0x5a9)]=_0x12ea88[_0xb337b(-0x135,-0x129,-0x15e,-0x1a5)],_0x5022ac[_0xb337b(-0x16b,-0xd5,-0xc9,-0xcd)]=_0x12ea88['gKBRG'],_0x5022ac['五官外貌背面']=_0x12ea88['oRYkV'],_0x5022ac[_0xb337b(-0x8d,-0x4c,-0x42,-0xb)]='upperBodyS'+'FW',_0x5022ac[_0xecdd27(0x68a,0x6b0,0x624,0x5d0)]=_0xecdd27(0x588,0x5b8,0x60f,0x65f)+_0xecdd27(0x4ed,0x512,0x56a,0x4da),_0x5022ac['下半身SFW']=_0x12ea88[_0xb337b(-0x122,-0x73,-0xde,-0x118)],_0x5022ac['下半身SFW背面']=_0x12ea88['njFML'],_0x5022ac[_0xecdd27(0x5a1,0x4ff,0x571,0x4f7)]=_0x12ea88[_0xb337b(-0x12e,-0x15c,-0x12a,-0xd8)],_0x5022ac['上半身NSFW背面']=_0x12ea88[_0xb337b(-0x11a,-0xd8,-0xb5,-0xcb)],_0x5022ac[_0xecdd27(0x5a4,0x5c1,0x5e8,0x5a7)]=_0x12ea88[_0xb337b(-0xed,-0x1c,-0x6b,0x6)],_0x5022ac[_0xecdd27(0x5c7,0x6e6,0x66f,0x666)]=_0x12ea88[_0xb337b(-0x17d,-0x6d,-0xf1,-0x94)];const _0xd1385c=_0x5022ac;for(const _0xee166d of _0x3a99d5){const _0x4b796c=_0xee166d[_0xecdd27(0x4e2,0x58d,0x564,0x5d8)](':');if(_0x12ea88[_0xb337b(-0x62,-0x134,-0xa6,-0x12d)](_0x4b796c,-(0x36*-0xb1+0xd70+0x17e7)))continue;const _0xcf6b3=_0xee166d['substring'](-0x1dc7+-0x845*0x1+0x14*0x1e7,_0x4b796c)['trim'](),_0x2e5952=_0xee166d[_0xb337b(-0xb0,0x5d,-0x3d,-0x7e)](_0x4b796c+(0x42d*0x7+0x219*0x10+-0x3eca))[_0xb337b(-0xe4,-0x165,-0xcd,-0x37)]();if(_0xd1385c[_0xcf6b3]){if(_0x12ea88[_0xecdd27(0x58e,0x5a2,0x627,0x620)](_0xecdd27(0x5fe,0x655,0x637,0x5f2),_0x12ea88[_0xb337b(-0xc8,-0x61,-0xe4,-0xfc)])){_0x541ca4[_0xecdd27(0x500,0x559,0x54a,0x528)](_0x12ea88[_0xecdd27(0x5a5,0x60a,0x59b,0x55a)]);return;}else _0x381d14[_0xd1385c[_0xcf6b3]]=_0x2e5952;}else _0xcf6b3&&_0x2e5952&&(_0x12ea88['tqcMh'](_0xecdd27(0x688,0x680,0x626,0x67d),_0x12ea88[_0xecdd27(0x530,0x610,0x578,0x603)])?console[_0xb337b(0x1b,-0xce,-0x77,-0xb7)](_0xecdd27(0x693,0x5e2,0x62f,0x5ad)+'PromptModi'+'fy]\x20未识别的人物'+'字段\x20\x22'+_0xcf6b3+'\x22'):(_0x391a80[_0xb337b(-0x70,-0x109,-0x10f,-0x91)+'ener'](_0x4e12a5['LLM_CHAR_M'+_0xb337b(0x5c,-0xd6,-0x3f,0x40)+'PROMPT_RES'+_0xb337b(-0x15e,-0x12e,-0x133,-0x18d)],_0x448611),_0x178467(new _0x2587c3(_0x12ea88[_0xb337b(-0x41,-0xad,-0x5a,-0x93)]))));}if(!_0x381d14[_0xecdd27(0x507,0x518,0x55c,0x4d3)]){if(_0x12ea88['XjZHX']===_0x12ea88[_0xb337b(-0x17f,-0x18f,-0x165,-0x15f)])_0x333162[_0xb337b(-0xd9,-0xc5,-0x10f,-0x10b)+_0xb337b(-0xc2,-0x198,-0x130,-0x183)](_0x47819f['LLM_CHAR_M'+_0xb337b(-0xbd,-0x86,-0x116,-0xb6)+'ONSE'],_0x77a620),_0x53d23c&&(_0x12ea88[_0xb337b(-0x125,-0xf8,-0x11f,-0x153)](_0x56e74c,_0x15e94e),_0x4f8d90=null);else return null;}return console[_0xb337b(-0x94,-0xe1,-0x77,0x1f)](_0x12ea88[_0xb337b(-0xb8,-0x197,-0x136,-0x119)],_0x381d14),_0x381d14;}function extractCharacterTags(_0x12e761){const _0x10a869={'ZlPYs':function(_0x345a14,_0x5b2eb9){return _0x345a14!==_0x5b2eb9;},'cREnx':function(_0x38c740,_0x22a214){return _0x38c740(_0x22a214);},'GWsxn':function(_0x2dd995,_0x2745a6){return _0x2dd995(_0x2745a6);}},_0x1bf35b={};_0x1bf35b[_0x6121f0(0x4ec,0x55e,0x594,0x509)]=[];const _0x11aa52=_0x1bf35b;_0x12e761=_0x12e761[_0x1c17a2(-0x14c,-0x10e,-0x15c,-0x159)](/<thinking>[\s\S]*?<\/thinking>/gi,'')[_0x6121f0(0x4e8,0x4ff,0x5b3,0x52c)]();function _0x6121f0(_0x1cd623,_0x2e380c,_0x5641dc,_0xb445d3){return _0xadc0(_0xb445d3-0x2a6,_0x2e380c);}function _0x1c17a2(_0xca61ed,_0x37b606,_0x13025a,_0x139083){return _0xadc0(_0x37b606- -0x3a2,_0xca61ed);}const _0xd6ffa9=/<人物>([\s\S]*?)<\/人物>/g;let _0x433984;while(_0x10a869[_0x6121f0(0x54d,0x563,0x547,0x5c6)](_0x433984=_0xd6ffa9[_0x1c17a2(-0xb0,-0xa5,-0xd2,-0x75)](_0x12e761),null)){const _0x288fc2=_0x10a869[_0x6121f0(0x452,0x55a,0x569,0x4f0)](preprocessTagContent,_0x433984[0x833+-0x101f+0x7ed*0x1]),_0x43fe44=_0x10a869['GWsxn'](parseCharacterData,_0x288fc2);_0x43fe44&&_0x11aa52[_0x6121f0(0x4fc,0x49b,0x500,0x509)][_0x1c17a2(-0xe1,-0x117,-0x140,-0xa9)](_0x43fe44);}return _0x11aa52;}function getCurrentCharacterPreset(){const _0x567c1c=extension_settings[extensionName],_0xd41899=_0x567c1c['characterP'+'resetId'];function _0x4e98de(_0x3ad753,_0x2009ee,_0x1732a9,_0x389883){return _0xadc0(_0x2009ee- -0x31c,_0x1732a9);}if(!_0xd41899||!_0x567c1c[_0x30d437(0x36f,0x2c5,0x2d2,0x358)+'resets'][_0xd41899])return null;const _0x4b5f01={};_0x4b5f01['id']=_0xd41899,_0x4b5f01['data']=_0x567c1c[_0x30d437(0x36f,0x2df,0x33e,0x3af)+_0x30d437(0x369,0x30b,0x3ae,0x2dc)][_0xd41899];function _0x30d437(_0x5677be,_0x1dd5cb,_0x52b27e,_0x1d9abc){return _0xadc0(_0x5677be-0x3c,_0x1dd5cb);}return _0x4b5f01;}function buildCharacterText(_0x31657b){const _0x16055d={};_0x16055d[_0x1667b8(-0x23d,-0x190,-0x1a9,-0x15a)]=_0x1667b8(-0x122,-0xf8,-0x158,-0x172),_0x16055d[_0x1667b8(-0xb2,-0x13f,-0xdc,-0x11f)]=_0x1667b8(-0x60,-0x136,-0xed,-0x46);const _0x285aeb=_0x16055d,_0x5d4fa9=_0x31657b[_0x579615(0x312,0x3f8,0x427,0x3b9)];let _0x2a5ede=_0x285aeb[_0x1667b8(-0x212,-0x190,-0x1a9,-0x253)];_0x2a5ede+='中文名称:\x20'+(_0x5d4fa9[_0x579615(0x2f2,0x371,0x26d,0x2eb)]||'')+'\x0a';function _0x579615(_0x2a747f,_0x48c8cd,_0x4f1cd8,_0x524a6d){return _0xadc0(_0x524a6d-0xe9,_0x48c8cd);}_0x2a5ede+='英文名称:\x20'+(_0x5d4fa9[_0x1667b8(-0x157,-0xc2,-0x110,-0xca)]||'')+'\x0a',_0x2a5ede+=_0x579615(0x339,0x37c,0x308,0x360)+(_0x5d4fa9['facialFeat'+_0x579615(0x469,0x3eb,0x411,0x421)]||'')+'\x0a',_0x2a5ede+=_0x1667b8(-0x21a,-0x123,-0x185,-0x1e0)+(_0x5d4fa9[_0x1667b8(-0x1d0,-0x1f4,-0x1ce,-0x12d)+_0x579615(0x385,0x498,0x37b,0x40a)]||'')+'\x0a',_0x2a5ede+='上半身SFW:\x20'+(_0x5d4fa9[_0x579615(0x425,0x315,0x349,0x39e)+'FW']||'')+'\x0a',_0x2a5ede+=_0x579615(0x2f6,0x40c,0x309,0x39b)+(_0x5d4fa9[_0x1667b8(-0xb6,-0x131,-0x10a,-0x165)+_0x579615(0x263,0x273,0x29a,0x2f9)]||'')+'\x0a',_0x2a5ede+=_0x579615(0x39c,0x348,0x43d,0x3ae)+(_0x5d4fa9['fullBodySF'+'W']||'')+'\x0a',_0x2a5ede+=_0x1667b8(-0x14,-0x10b,-0x80,-0xe6)+(_0x5d4fa9['fullBodySF'+_0x579615(0x477,0x3b3,0x374,0x3ea)]||'')+'\x0a',_0x2a5ede+='上半身NSFW:\x20'+(_0x5d4fa9[_0x1667b8(-0x11c,-0xb9,-0x140,-0x1e1)+_0x1667b8(-0xfa,-0x81,-0x118,-0xec)]||'')+'\x0a',_0x2a5ede+=_0x1667b8(-0xc5,-0x160,-0xf7,-0x118)+'\x20'+(_0x5d4fa9[_0x1667b8(-0x19e,-0x169,-0x140,-0x106)+_0x579615(0x339,0x3cf,0x3db,0x365)]||'')+'\x0a',_0x2a5ede+=_0x579615(0x437,0x457,0x36f,0x3c3)+(_0x5d4fa9['fullBodyNS'+'FW']||'')+'\x0a',_0x2a5ede+=_0x1667b8(-0x78,-0x62,-0x8d,-0x8c)+'\x20'+(_0x5d4fa9[_0x1667b8(-0xc4,-0x90,-0x12a,-0x8c)+_0x1667b8(-0x156,-0x24d,-0x1af,-0x229)]||'')+'\x0a',_0x2a5ede+=_0x285aeb[_0x579615(0x36b,0x448,0x422,0x3cc)];function _0x1667b8(_0x5a4bed,_0x4d17a9,_0x267d38,_0x598b33){return _0xadc0(_0x267d38- -0x3bf,_0x598b33);}return _0x2a5ede;}export async function handleCharacterPromptModify(_0x56dd6d,_0x32e852=[]){function _0x3aadaf(_0x220702,_0x1264a4,_0x2acc4c,_0x43ae72){return _0xadc0(_0x220702-0x1fd,_0x2acc4c);}function _0x531669(_0x42322b,_0x2bd526,_0x42b381,_0x4f7d12){return _0xadc0(_0x42322b- -0x1bb,_0x2bd526);}const _0x63b75={'oDYYg':function(_0x31ef9a,_0x36f37e){return _0x31ef9a+_0x36f37e;},'cIbLc':_0x3aadaf(0x4d2,0x50c,0x54d,0x50f)+'PromptModi'+'fy]\x20Starti'+'ng\x20charact'+'er\x20prompt\x20'+_0x3aadaf(0x3ea,0x488,0x38b,0x3b8)+_0x3aadaf(0x433,0x449,0x418,0x4bb),'ZfNGB':_0x531669(0x11a,0x93,0x157,0x152)+_0x3aadaf(0x4ed,0x564,0x55c,0x4be)+_0x531669(0x4a,0x82,0x4a,-0x48)+'提示词修改请求...','swvsk':function(_0x335c32){return _0x335c32();},'pQDag':_0x3aadaf(0x529,0x58f,0x59a,0x4f8),'XzFUE':_0x531669(0x11a,0x18f,0x125,0x12e)+'PromptModi'+_0x531669(0x155,0x1e3,0x19f,0x116)+'t\x20preset:','cXHGQ':_0x3aadaf(0x4d2,0x49f,0x54c,0x534)+_0x531669(0x135,0x8a,0xc3,0xde)+_0x3aadaf(0x4ea,0x54c,0x43e,0x51f)+_0x3aadaf(0x40b,0x3b5,0x376,0x44a)+':','tLhwi':function(_0x415eb9,_0x3c8aef){return _0x415eb9||_0x3c8aef;},'UPOCB':_0x3aadaf(0x4d2,0x455,0x569,0x49f)+_0x3aadaf(0x4ed,0x56b,0x4c9,0x56c)+_0x3aadaf(0x516,0x4f4,0x575,0x49c)+_0x531669(0xb8,0x15e,0xb2,0x108)+'r\x20text:','wipWm':function(_0x3b7d62,_0x24c62c,_0x41c7ec){return _0x3b7d62(_0x24c62c,_0x41c7ec);},'ZytNc':_0x531669(0x98,-0xd,0x143,0x49)+'y','tGIJO':function(_0x171dd7,_0x1af629){return _0x171dd7(_0x1af629);},'dSFQC':function(_0xdf487e){return _0xdf487e();},'JEyef':function(_0xa1c458,_0x8843c){return _0xa1c458(_0x8843c);},'QkOwm':'[character'+_0x3aadaf(0x4ed,0x4ee,0x4e2,0x44a)+_0x531669(0x7e,0x88,0x76,-0xe)+'后:','wanbo':_0x531669(0x179,0x18d,0x13e,0x17a),'TZkUU':_0x531669(0x11a,0xde,0x6e,0xc7)+_0x531669(0x135,0xaf,0xe5,0x1ba)+'fy]\x20User\x20r'+'equirement'+_0x3aadaf(0x44a,0x409,0x3ef,0x3db)+_0x531669(0x8d,0x16,0xc5,0xeb),'vrXEm':function(_0x461103,_0x2d4beb){return _0x461103||_0x2d4beb;},'gkquq':function(_0x11ae89,_0x3a801e,_0x205bd2,_0x824f85,_0x30db31){return _0x11ae89(_0x3a801e,_0x205bd2,_0x824f85,_0x30db31);},'TcVNR':'{{当前角色}}','IAfLF':_0x3aadaf(0x4d2,0x438,0x44c,0x472)+_0x3aadaf(0x4ed,0x505,0x48a,0x536)+_0x3aadaf(0x4e3,0x511,0x52c,0x532)+_0x531669(0xa6,0x26,0x6c,0xc0),'OBsYd':function(_0x5061d2,_0x461762){return _0x5061d2===_0x461762;},'RiIkA':_0x531669(0x51,0xbb,0xa2,0x72),'bmIGS':function(_0x3201ad,_0x3ad58b){return _0x3201ad>_0x3ad58b;},'DyzYv':function(_0x1e2da5,_0x3036d3){return _0x1e2da5>=_0x3036d3;},'SPaiL':function(_0x12405b,_0x40a734){return _0x12405b===_0x40a734;},'BnkLb':_0x3aadaf(0x517,0x4b6,0x532,0x4a8),'WcLEh':_0x531669(0x168,0x1d2,0xe7,0x134),'MjLAE':_0x531669(0x11a,0x143,0xe7,0xc3)+_0x3aadaf(0x4ed,0x47b,0x594,0x540)+_0x3aadaf(0x48d,0x525,0x4be,0x518)+'ed','VRMYw':function(_0x165fbc,_0x972431,_0x402045){return _0x165fbc(_0x972431,_0x402045);},'GXBwH':_0x531669(0x11a,0xe3,0xfc,0x14b)+_0x531669(0x135,0xda,0x196,0x179)+_0x531669(0x5a,-0x1a,0xdd,0x7d)+_0x3aadaf(0x52b,0x4bf,0x5c0,0x535),'JoSyM':'LLM\x20返回结果为空','QAgke':function(_0x19ec45,_0x3c328c){return _0x19ec45(_0x3c328c);},'fONDW':_0x3aadaf(0x429,0x425,0x392,0x3a1)+'检测到角色标签','yMIIy':'[character'+_0x3aadaf(0x4ed,0x4db,0x4c3,0x53e)+_0x3aadaf(0x50b,0x4cf,0x523,0x503)+'ted\x20data:','HbVPE':function(_0x4d3882,_0x47ede6,_0x4670ad){return _0x4d3882(_0x47ede6,_0x4670ad);},'mIaWn':_0x531669(0x148,0x12c,0x1b9,0xf6),'YzPhX':function(_0x368dbe,_0x1084e2){return _0x368dbe!==_0x1084e2;},'TwFAQ':_0x531669(0x176,0x1c0,0x21d,0x145),'KUtAU':_0x531669(0x80,0xef,-0x7,0x20),'vbXKj':_0x531669(0x11a,0x1b6,0xb8,0x78)+'PromptModi'+_0x531669(0xff,0x198,0x16f,0x195)};console[_0x3aadaf(0x4d9,0x571,0x4ed,0x539)](_0x63b75[_0x531669(0x64,0xa0,0x94,0x42)]),toastr['info'](_0x63b75[_0x531669(0x181,0x218,0x1a9,0x13f)]);try{const _0x3c72ae=getContext(),_0x1a5d43=extension_settings[extensionName],_0x4aa8a4=_0x63b75[_0x3aadaf(0x45d,0x491,0x41c,0x3f9)](getCurrentCharacterPreset);if(!_0x4aa8a4){toastr['error'](_0x63b75[_0x3aadaf(0x3f4,0x3b0,0x3c6,0x470)]);return;}console[_0x3aadaf(0x4d9,0x49e,0x50b,0x45e)](_0x63b75[_0x3aadaf(0x451,0x444,0x45a,0x435)],_0x4aa8a4['id']);const _0x37363f=_0x4aa8a4[_0x3aadaf(0x4cd,0x4f6,0x438,0x4d8)][_0x531669(0xad,0x28,0x9b,0x24)+_0x531669(0x85,0x93,0xbd,0x11c)]||'',_0x3913f8=_0x4aa8a4[_0x3aadaf(0x4cd,0x4ee,0x4d7,0x482)][_0x531669(0xad,0x138,0x158,0x44)+'WorldBook']||'',_0x3dae0f=_0x4aa8a4['data'][_0x531669(0xad,0x11e,0x9d,0x62)+_0x531669(0x127,0x128,0x1a8,0x14a)]||{};console[_0x531669(0x121,0x1c7,0x144,0xc0)](_0x531669(0x11a,0xf2,0xdc,0x191)+_0x531669(0x135,0x127,0x18d,0x9d)+_0x531669(0x132,0x12d,0xa4,0x1ad)+_0x3aadaf(0x448,0x495,0x483,0x4d8),_0x37363f),console['log'](_0x63b75['cXHGQ'],_0x3913f8),console[_0x531669(0x121,0xe5,0xbe,0x122)](_0x531669(0x11a,0xda,0x130,0x87)+_0x3aadaf(0x4ed,0x4b8,0x567,0x53b)+'fy]\x20Saved\x20'+'variables:',_0x3dae0f);const _0x488e0c=_0x63b75[_0x531669(0x45,-0x2f,0x2d,0xab)](_0x56dd6d,''),_0x3bc04c=[];_0x56dd6d&&_0x3bc04c[_0x531669(0xd0,0x44,0xce,0x37)](_0x56dd6d);_0x37363f&&_0x3bc04c[_0x531669(0xd0,0x2e,0xd5,0x25)](_0x37363f);_0x3913f8&&_0x3bc04c[_0x3aadaf(0x488,0x437,0x4cd,0x481)](_0x3913f8);const _0x3326ec=_0x3bc04c[_0x531669(0xe2,0x3b,0x177,0x144)]('\x0a');console[_0x3aadaf(0x4d9,0x4e6,0x4a3,0x4a7)](_0x63b75[_0x531669(0xf9,0x163,0x12f,0x89)],_0x3326ec);let _0x43e737=_0x63b75[_0x3aadaf(0x4f2,0x50e,0x449,0x4b4)](buildPromptForRequestType,_0x63b75[_0x3aadaf(0x42d,0x4aa,0x3a3,0x42e)],_0x488e0c);const _0x463f36=_0x63b75['tGIJO'](generateCharacterListText,_0x3326ec),_0x6e03b9=_0x63b75[_0x531669(0x3e,0x52,0x9b,-0x53)](generateOutfitEnableListText),_0x4668b5=generateCommonCharacterListText();console['log'](_0x531669(0x11a,0x102,0x121,0x112)+'PromptModi'+_0x531669(0x15e,0x19c,0x171,0x1b8)+'ter\x20list\x20t'+_0x3aadaf(0x3f9,0x498,0x435,0x48d)+'ered):',_0x463f36);const _0x2e2a49=_0x3c72ae['chatMetada'+'ta']?.[_0x3aadaf(0x4c1,0x4d1,0x4b0,0x41b)]||{},_0x40bdff=buildCharacterText(_0x4aa8a4);_0x43e737=_0x63b75['JEyef'](mergeAdjacentMessages,_0x43e737),console[_0x531669(0x121,0x140,0x84,0x1a0)](_0x63b75[_0x3aadaf(0x52d,0x580,0x4d3,0x500)],_0x43e737);const _0x396d1d=_0x63b75[_0x3aadaf(0x4f2,0x468,0x4d6,0x563)](findMessageIndexWithPlaceholder,_0x43e737,_0x63b75[_0x3aadaf(0x47f,0x44f,0x400,0x4fb)]);console[_0x3aadaf(0x4d9,0x46e,0x4c3,0x4da)](_0x63b75[_0x531669(0x150,0x138,0x174,0x116)],_0x396d1d);const _0x4719f4={..._0x3dae0f,..._0x2e2a49},_0xd40bd6={'context':_0x37363f,'worldBookContent':_0x3913f8,'variables':_0x4719f4,'userDemand':_0x63b75[_0x3aadaf(0x481,0x493,0x3ee,0x454)](_0x56dd6d,''),'characterListText':_0x463f36,'outfitEnableListText':_0x6e03b9,'commonCharacterListText':_0x4668b5},{messages:_0x4b34c8,replacedVariables:_0xe62dad}=_0x63b75[_0x3aadaf(0x4f2,0x51c,0x53f,0x4e9)](replaceAllPlaceholders,_0x43e737,_0xd40bd6);_0x43e737=_0x4b34c8,_0x43e737=_0x63b75['gkquq'](_0x1dbf8d,_0x43e737,_0x63b75['TcVNR'],_0x40bdff,_0xe62dad),console[_0x3aadaf(0x4d9,0x543,0x464,0x4e6)](_0x63b75[_0x3aadaf(0x406,0x46e,0x4a2,0x452)],_0x43e737);let _0x522807='';if(_0xe62dad[_0x531669(0xb5,0xcb,0xf1,0x144)]>0xcaa+0x152b+-0x21d5){if(_0x63b75[_0x3aadaf(0x48a,0x46e,0x45f,0x43a)](_0x63b75[_0x3aadaf(0x47e,0x433,0x4d4,0x3fc)],_0x63b75[_0x531669(0xc6,0x169,0x11b,0x2e)]))_0x522807=_0x531669(0xe9,0x4e,0xc4,0xcd)+'被使用：'+[..._0xe62dad][_0x3aadaf(0x49a,0x474,0x545,0x4e2)]('、')+'\x0a';else return _0x243053;}if(_0x32e852&&_0x63b75['bmIGS'](_0x32e852[_0x3aadaf(0x403,0x467,0x3d4,0x45c)],0x1*0x1c99+0x2*-0x79d+0xd5f*-0x1)&&_0x63b75['DyzYv'](_0x396d1d,-0x17e1*0x1+0x695+0x6c*0x29)){if(_0x63b75['SPaiL'](_0x63b75[_0x531669(0x93,0x92,0xbd,0xf1)],_0x63b75[_0x531669(0x93,0xbc,0x29,0x117)]))_0x43e737=_0x63b75['gkquq'](attachImagesToMessage,_0x43e737,_0x396d1d,_0x32e852,_0x63b75[_0x3aadaf(0x4e6,0x476,0x4fa,0x56d)]),console[_0x3aadaf(0x4d9,0x4f8,0x4dc,0x51c)](_0x63b75[_0x531669(0xfd,0xb4,0x9e,0x11a)],_0x32e852[_0x3aadaf(0x403,0x3c4,0x3d6,0x498)],_0x531669(0x143,0x10b,0x99,0x12c)+_0x531669(0x4d,0x82,0x8f,0xac)+_0x531669(0x10c,0xb5,0xfe,0x198),_0x396d1d);else{const _0x36e8ff=_0x1a84e0?function(){function _0x2dbf9(_0x2bb2f2,_0x253c4c,_0x39a970,_0x28584e){return _0x531669(_0x253c4c-0x409,_0x28584e,_0x39a970-0x146,_0x28584e-0x1c4);}if(_0xa6c20c){const _0x22725e=_0x3e19bf[_0x2dbf9(0x53f,0x538,0x50e,0x4ea)](_0x35196d,arguments);return _0x132e93=null,_0x22725e;}}:function(){};return _0x5e9103=![],_0x36e8ff;}}_0x63b75[_0x3aadaf(0x4f2,0x47b,0x501,0x473)](updateCombinedPrompt,_0x43e737,_0x522807);const _0x12aa1d={};_0x12aa1d['timeoutMs']=0x493e0;const _0x52b7bc=await _0x63b75['VRMYw'](LLM_CHAR_MODIFY,_0x43e737,_0x12aa1d);console['log'](_0x63b75[_0x3aadaf(0x534,0x596,0x553,0x57e)],_0x52b7bc);if(!_0x52b7bc){toastr[_0x3aadaf(0x3ed,0x454,0x346,0x3f2)](_0x63b75[_0x531669(0x14f,0x156,0xd8,0x1d7)]);return;}const _0x33848f=_0x63b75[_0x3aadaf(0x47d,0x4da,0x490,0x494)](extractCharacterTags,_0x52b7bc);if(_0x33848f[_0x531669(0xa8,0x2d,0x2b,0x9)][_0x531669(0x4b,0x91,0x49,-0x2a)]===0xa2f+-0x60c+-0x423){toastr[_0x3aadaf(0x416,0x49a,0x43b,0x3ae)](_0x63b75[_0x531669(0xed,0x62,0x167,0x12d)]),console[_0x531669(0x121,0x196,0x15a,0x157)]('[character'+_0x531669(0x135,0x184,0xc6,0xb3)+_0x531669(0x43,0xeb,0x43,-0x29)+_0x3aadaf(0x510,0x5ba,0x4aa,0x507)+_0x531669(0x74,0xd3,0xa2,0xa)+_0x3aadaf(0x434,0x3ea,0x45e,0x4a3)),console[_0x531669(0x121,0x1c5,0xaf,0x185)](_0x531669(0x11a,0xc2,0x16d,0x1a0)+_0x3aadaf(0x4ed,0x4fe,0x4a9,0x48e)+_0x3aadaf(0x490,0x4c6,0x4ab,0x471)+_0x531669(0xfb,0xf5,0x163,0x69)+_0x3aadaf(0x4b6,0x507,0x51f,0x53a)+_0x531669(0x123,0xbb,0xac,0x7d),_0x52b7bc);return;}console[_0x3aadaf(0x4d9,0x572,0x4e4,0x4f9)](_0x63b75[_0x3aadaf(0x4fc,0x4a0,0x520,0x4e3)],_0x33848f);const _0x120e91=_0x33848f[_0x531669(0xa8,0x33,0xf4,0x74)][-0xa*-0x8e+0x2d7*-0x1+-0xb*0x3f];await _0x63b75['HbVPE'](updateCharacterPresetFromLLM,_0x4aa8a4['id'],_0x120e91),toastr[_0x531669(0xb2,0x48,0x124,0xab)](_0x63b75['mIaWn']);}catch(_0x5240d1){if(_0x63b75[_0x531669(0x30,-0x6a,-0x45,-0x4e)](_0x63b75[_0x531669(0x15c,0xfd,0xf6,0x1ea)],_0x63b75['KUtAU']))console['error'](_0x63b75[_0x531669(0x67,0x2e,-0x17,0x7f)],_0x5240d1),toastr[_0x531669(0x35,-0x38,0x8e,-0x16)](_0x531669(0xc3,0x15c,0x61,0x31)+'\x20'+_0x5240d1[_0x531669(0x3d,-0x4d,-0x25,0xa8)]);else{if(_0xe5b862&&_0x12252c[_0x531669(0xeb,0x13a,0xa1,0xd3)])return _0x369e4a[_0x531669(0xeb,0x7a,0x188,0x137)]();return _0x63b75[_0x3aadaf(0x4e9,0x536,0x4a7,0x47d)](_0xca0284[_0x3aadaf(0x42b,0x393,0x4a4,0x463)]()[_0x531669(0x44,-0x4,-0x42,0x76)](-0xc0b*0x3+0x59*-0x34+-0x1*-0x3659),_0x20396d[_0x3aadaf(0x455,0x411,0x3c3,0x40d)]()[_0x531669(0x44,0xeb,-0x66,-0x4b)](0x59*0x2f+-0x3b*-0x16+-0x1545)[_0x3aadaf(0x513,0x46b,0x4c3,0x58f)](0x1e33+-0x1049+0x37a*-0x4));}}}async function updateCharacterPresetFromLLM(_0xa26143,_0x2db9b9){const _0x56ccf2={'nOcRd':'IHOCS','buutV':_0x491b39(0x5fe,0x5ae,0x61d,0x6a3),'fVCxk':_0x491b39(0x58e,0x4a1,0x54a,0x538),'Qoaew':_0x1f4510(0x626,0x5ea,0x60c,0x670),'TzfJz':_0x491b39(0x5ab,0x5ec,0x616,0x63f),'hWaQk':'下半身SFW','oStrC':_0x1f4510(0x58c,0x5f0,0x518,0x527),'VVdPn':_0x491b39(0x603,0x5cd,0x593,0x5c3),'OzUBn':_0x1f4510(0x692,0x60d,0x6cd,0x710),'Wkhlg':function(_0x93ec6f,_0x4933ec){return _0x93ec6f===_0x4933ec;},'EIOQq':_0x491b39(0x4ee,0x59b,0x582,0x5f9),'kwGoO':function(_0x5929c2,_0x558dea){return _0x5929c2!==_0x558dea;},'beJes':_0x1f4510(0x5d9,0x64c,0x5e0,0x62a),'fGorY':function(_0x9097a9,_0x26467e){return _0x9097a9>_0x26467e;},'GcwaL':_0x491b39(0x56d,0x587,0x502,0x484),'LjcYh':function(_0x4f305f,_0x5299e5){return _0x4f305f(_0x5299e5);},'NxpNu':'已取消更新','uHXWe':function(_0x4950b6){return _0x4950b6();},'brgbJ':function(_0x22c29c,_0x5d468f){return _0x22c29c(_0x5d468f);},'wZWmf':_0x491b39(0x550,0x4ef,0x509,0x4aa)+_0x1f4510(0x569,0x5ab,0x574,0x4f0)+_0x1f4510(0x6a1,0x70c,0x74d,0x604)},_0x260e7a=extension_settings[extensionName],_0xa0d7e0=_0x260e7a['characterP'+_0x1f4510(0x6aa,0x722,0x6aa,0x6f3)][_0xa26143];if(!_0xa0d7e0){if(_0x56ccf2['nOcRd']===_0x56ccf2[_0x491b39(0x660,0x6a7,0x622,0x627)]){toastr['error'](_0x56ccf2[_0x491b39(0x5c2,0x541,0x526,0x482)]);return;}else _0x3200ec[_0x3da787]=_0x20aa09(_0x302360[_0xb8de95],_0x1dc6a3,_0x4cd2e8,_0x4b5d3b);}function _0x1f4510(_0x596112,_0x1948e5,_0x1ee1b5,_0x526d94){return _0xadc0(_0x596112-0x37d,_0x1ee1b5);}let _0x4a71ac=_0x1f4510(0x63d,0x63f,0x650,0x673)+_0xa26143+_0x491b39(0x6cb,0x6b7,0x62d,0x672);const _0x5f1774={};_0x5f1774[_0x491b39(0x4c5,0x488,0x507,0x5ae)]=_0x56ccf2[_0x1f4510(0x5bf,0x585,0x5e7,0x5dc)],_0x5f1774['nameEN']=_0x56ccf2[_0x491b39(0x61c,0x690,0x646,0x607)],_0x5f1774['facialFeat'+_0x1f4510(0x6b5,0x64e,0x660,0x74f)]=_0x491b39(0x617,0x59d,0x58f,0x535),_0x5f1774[_0x491b39(0x57b,0x550,0x4f6,0x46a)+'uresBack']=_0x491b39(0x66a,0x58b,0x5c2,0x600),_0x5f1774[_0x491b39(0x5c1,0x63d,0x5ba,0x589)+'FW']=_0x56ccf2[_0x1f4510(0x661,0x61d,0x647,0x642)],_0x5f1774[_0x1f4510(0x632,0x5d8,0x59d,0x5e8)+_0x491b39(0x52e,0x514,0x515,0x52e)]=_0x491b39(0x5ab,0x641,0x5cf,0x53d),_0x5f1774[_0x491b39(0x6be,0x616,0x620,0x5b5)+'W']=_0x56ccf2['hWaQk'],_0x5f1774['fullBodySF'+_0x1f4510(0x67e,0x60c,0x645,0x6db)]=_0x56ccf2[_0x1f4510(0x6b7,0x727,0x61b,0x71e)],_0x5f1774['upperBodyN'+_0x1f4510(0x624,0x5bb,0x5bd,0x6bb)]='上半身NSFW',_0x5f1774['upperBodyN'+_0x1f4510(0x5f9,0x59f,0x62b,0x617)]='上半身NSFW背面',_0x5f1774[_0x491b39(0x541,0x5fb,0x59a,0x528)+'FW']=_0x56ccf2['VVdPn'],_0x5f1774['fullBodyNS'+_0x491b39(0x50c,0x4b3,0x515,0x489)]=_0x56ccf2['OzUBn'];const _0xd0570c=_0x5f1774;let _0x2e19c3=0x1167+0x7*0x4ff+-0x3460;for(const _0x511405 in _0xd0570c){if(_0x56ccf2[_0x1f4510(0x65d,0x6b5,0x5bf,0x5cf)]('CZiLm',_0x56ccf2[_0x491b39(0x5e5,0x575,0x5c1,0x5b1)]))_0x11d730[_0x44de69]&&(_0x4ea5ca[_0x38ad77]=_0xd3b96b[_0x81b31d]);else{if(_0x2db9b9[_0x511405]&&_0x56ccf2[_0x491b39(0x54c,0x52b,0x580,0x5f6)](_0x2db9b9[_0x511405],_0xa0d7e0[_0x511405])){const _0x403715=_0xa0d7e0[_0x511405]||_0x56ccf2[_0x491b39(0x58b,0x51a,0x597,0x56c)],_0x31fbdb=_0x2db9b9[_0x511405];_0x4a71ac+='•\x20'+_0xd0570c[_0x511405]+':\x0a',_0x4a71ac+='\x20\x20旧:\x20'+_0x403715[_0x491b39(0x5ac,0x608,0x61b,0x677)](-0x52*0x19+0x1698+-0xe96,0xc76+0x7*0x2f5+-0x20f7)+(_0x56ccf2[_0x1f4510(0x5ae,0x52c,0x57d,0x653)](_0x403715[_0x1f4510(0x583,0x5e1,0x51b,0x532)],-0x1*-0xaab+-0x553+0x1*-0x526)?_0x56ccf2[_0x491b39(0x589,0x5e9,0x605,0x5cf)]:'')+'\x0a',_0x4a71ac+=_0x491b39(0x67d,0x65e,0x5f4,0x5ca)+_0x31fbdb[_0x1f4510(0x693,0x6b9,0x727,0x6f5)](0x1566+-0x22*-0x81+0x4d1*-0x8,-0xb33+0xdc2+0x5*-0x79)+(_0x56ccf2[_0x1f4510(0x5ae,0x580,0x5ca,0x611)](_0x31fbdb['length'],0x24a+0x61e+-0x1*0x836)?_0x56ccf2[_0x1f4510(0x67d,0x697,0x6c9,0x6c9)]:'')+'\x0a\x0a',_0x2e19c3++;}}}if(_0x56ccf2[_0x1f4510(0x65d,0x6fa,0x6ca,0x610)](_0x2e19c3,-0x1fed+-0x26ce+0x46bb)){toastr[_0x491b39(0x4c1,0x4b1,0x519,0x4fe)](_0x1f4510(0x5d8,0x652,0x534,0x5b4)+'内容');return;}_0x4a71ac+='共\x20'+_0x2e19c3+_0x1f4510(0x620,0x5f2,0x66b,0x583);const _0x1bcc97=await _0x56ccf2[_0x491b39(0x4b9,0x532,0x532,0x509)](stylishConfirm,_0x4a71ac);if(!_0x1bcc97){toastr[_0x1f4510(0x591,0x579,0x5c6,0x4f0)](_0x56ccf2[_0x491b39(0x567,0x66a,0x5dc,0x560)]);return;}for(const _0x59d5a6 in _0xd0570c){_0x2db9b9[_0x59d5a6]&&(_0xa0d7e0[_0x59d5a6]=_0x2db9b9[_0x59d5a6]);}_0x56ccf2[_0x1f4510(0x5f7,0x64e,0x642,0x5f3)](saveSettingsDebounced);const _0x50fdbd=_0x56ccf2[_0x491b39(0x5b3,0x639,0x594,0x582)]($,_0x56ccf2[_0x491b39(0x6a6,0x698,0x627,0x65f)]);function _0x491b39(_0x2329f1,_0x564a8f,_0x261b62,_0x5f1d2e){return _0xadc0(_0x261b62-0x305,_0x5f1d2e);}_0x50fdbd['length']&&_0x56ccf2[_0x491b39(0x516,0x4f7,0x532,0x503)](refreshCharacterSettings,_0x50fdbd),updateFormFields(_0x2db9b9),console[_0x491b39(0x662,0x5ec,0x5e1,0x53d)](_0x1f4510(0x652,0x6a2,0x67b,0x665)+'PromptModi'+'fy]\x20已更新角色预'+_0x1f4510(0x5f1,0x672,0x549,0x5d5)+_0xa26143+'\x22');}function updateFormFields(_0x18c84d){const _0x4802ba={'xZjkq':function(_0x55aad5,_0x43d915){return _0x55aad5!==_0x43d915;},'NikPD':'ooJuc','AwcnR':function(_0x33e2cb,_0x16e5ed){return _0x33e2cb(_0x16e5ed);},'iOZHR':'nameCN','LSkbe':_0x2c2b7f(0x638,0x5c5,0x581,0x51f)+_0x358e77(0x3d0,0x354,0x3b1,0x3b1),'KFftF':_0x2c2b7f(0x604,0x5c5,0x563,0x5b7)+_0x358e77(0x3b9,0x3df,0x45a,0x314),'fwwKb':_0x2c2b7f(0x681,0x689,0x62e,0x707)+'FW','cXfrX':_0x358e77(0x34d,0x2d1,0x359,0x2b8)+_0x358e77(0x2a8,0x26a,0x264,0x30c),'sYsHg':_0x358e77(0x317,0x276,0x353,0x273)+_0x358e77(0x33f,0x3e3,0x369,0x3b1),'fIEho':_0x2c2b7f(0x691,0x653,0x6a9,0x601)+_0x358e77(0x314,0x3b1,0x291,0x27e),'GFPAH':_0x2c2b7f(0x6ae,0x669,0x707,0x6a3)+'FW','AssTY':'fullBodyNS'+_0x2c2b7f(0x65e,0x5e4,0x66e,0x5e8)};function _0x2c2b7f(_0x3df9d5,_0x20e7ca,_0x3db4ca,_0x36e456){return _0xadc0(_0x20e7ca-0x3d4,_0x3df9d5);}function _0x358e77(_0x38d054,_0x2e4eaa,_0x537b57,_0x4ed903){return _0xadc0(_0x38d054-0x98,_0x537b57);}const _0x316188=[_0x4802ba['iOZHR'],'nameEN',_0x4802ba[_0x2c2b7f(0x62b,0x65d,0x6b7,0x67c)],_0x4802ba[_0x358e77(0x28b,0x257,0x2c0,0x263)],_0x4802ba[_0x2c2b7f(0x6d2,0x6d9,0x6e0,0x744)],_0x4802ba[_0x2c2b7f(0x6c2,0x692,0x640,0x702)],_0x358e77(0x3b3,0x3d2,0x350,0x396)+'W',_0x2c2b7f(0x70c,0x6ef,0x656,0x6d9)+_0x358e77(0x399,0x384,0x3b3,0x35f),_0x4802ba[_0x2c2b7f(0x5ab,0x631,0x5dc,0x597)],_0x4802ba['fIEho'],_0x4802ba[_0x2c2b7f(0x623,0x63d,0x5de,0x627)],_0x4802ba['AssTY']];_0x316188[_0x2c2b7f(0x667,0x5ec,0x669,0x5d6)](_0x126679=>{function _0x3b392b(_0x4e7d5f,_0x2e5d65,_0x57e891,_0x3752b6){return _0x358e77(_0x2e5d65- -0x24c,_0x2e5d65-0x13c,_0x3752b6,_0x3752b6-0x1cb);}function _0x31002e(_0x99464e,_0x2f08f5,_0x38ec70,_0x328310){return _0x2c2b7f(_0x38ec70,_0x99464e- -0x38f,_0x38ec70-0x7,_0x328310-0x8);}if(_0x18c84d[_0x126679]){const _0x232407=document['getElement'+_0x31002e(0x29c,0x27e,0x270,0x2a7)]('char_'+_0x126679);if(_0x232407){if(_0x4802ba[_0x3b392b(0x125,0x144,0x15c,0x109)](_0x4802ba[_0x3b392b(0x2a,0xa1,0x2f,0x2)],_0x4802ba[_0x3b392b(0x145,0xa1,0x89,0x11)]))return _0x9355bf;else _0x232407[_0x3b392b(0x158,0x153,0xae,0x195)]=_0x18c84d[_0x126679],_0x4802ba['AwcnR']($,_0x232407)[_0x31002e(0x277,0x2dd,0x1da,0x1ee)](_0x3b392b(0x4c,0x46,0x93,0x52));}}});}