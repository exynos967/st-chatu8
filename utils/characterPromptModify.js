(function(_0x8184cf,_0x218fc2){function _0x449d8d(_0x5bad46,_0x15398e,_0x54fda3,_0x2ec247){return _0x2409(_0x2ec247-0x31d,_0x15398e);}const _0x2ab46f=_0x8184cf();function _0x5a8ba9(_0x2f901f,_0x21578d,_0x24402a,_0x45dc8c){return _0x2409(_0x2f901f- -0x16c,_0x45dc8c);}while(!![]){try{const _0xe52aba=parseInt(_0x5a8ba9(0x51,0x25,-0x25,0xcc))/(-0x1d72+0xe*0xb0+0x13d3)+parseInt(_0x5a8ba9(-0x6c,-0x71,0x4d,-0x99))/(-0x1*-0x13a0+-0x27*-0xf9+0x9*-0x665)+-parseInt(_0x5a8ba9(-0x2d,-0x43,-0x9d,-0x1c))/(0x4b3*-0x4+0x63*0x9+0x24*0x6d)+parseInt(_0x449d8d(0x4d2,0x593,0x4c8,0x4df))/(-0xd62+-0x14de+0x2db*0xc)*(-parseInt(_0x449d8d(0x566,0x4ac,0x4ff,0x4e0))/(0x1*0xf15+-0x7d1*-0x3+-0x1*0x2683))+parseInt(_0x5a8ba9(0xb7,0xb6,0x16e,0x76))/(-0x5*-0x379+-0x2583+0x142c)*(-parseInt(_0x5a8ba9(-0x33,-0x2b,0x68,0x5))/(0xb*-0x31+0x1f9c+0xe*-0x21b))+parseInt(_0x449d8d(0x3ba,0x4ea,0x3f1,0x461))/(0x1087+-0x47*0x1a+-0x949)+-parseInt(_0x449d8d(0x5a2,0x551,0x52a,0x4e8))/(-0x4cb+-0x2*0x542+-0x8*-0x1eb);if(_0xe52aba===_0x218fc2)break;else _0x2ab46f['push'](_0x2ab46f['shift']());}catch(_0x3adc44){_0x2ab46f['push'](_0x2ab46f['shift']());}}}(_0x1e92,-0x26267+-0x161*-0x115+-0x27269*-0x1));const _0x3d73a4=(function(){const _0x1bf758={};function _0x41bdde(_0x1253cd,_0x41b0ea,_0x529c54,_0x1a8b50){return _0x2409(_0x41b0ea- -0x53,_0x529c54);}_0x1bf758[_0xf0632e(0x47b,0x47b,0x433,0x3fa)]=function(_0x343380,_0x5b457c){return _0x343380!==_0x5b457c;},_0x1bf758[_0xf0632e(0x392,0x3fa,0x37a,0x394)]=_0x41bdde(0x1a5,0x20b,0x2b7,0x29e);const _0x1947f5=_0x1bf758;let _0x576429=!![];function _0xf0632e(_0x2d211e,_0x1daf5d,_0x3fc760,_0x35b381){return _0x2409(_0x1daf5d-0x22c,_0x3fc760);}return function(_0x5498e0,_0x33f9e2){function _0x4ebc0d(_0x121a06,_0x4460b9,_0x4c4816,_0x19c3c9){return _0xf0632e(_0x121a06-0xea,_0x4460b9- -0x15d,_0x19c3c9,_0x19c3c9-0x3e);}function _0x1d6d97(_0x1a1f76,_0x2a6435,_0x1e02f7,_0x360f1){return _0x41bdde(_0x1a1f76-0xf0,_0x1e02f7- -0x13f,_0x1a1f76,_0x360f1-0x3d);}if(_0x1947f5[_0x4ebc0d(0x32e,0x31e,0x291,0x299)](_0x1d6d97(0x6a,0x8d,0x99,0x132),_0x1947f5[_0x4ebc0d(0x2e4,0x29d,0x22d,0x218)])){const _0x4efaff=_0x576429?function(){if(_0x33f9e2){const _0x3fb797=_0x33f9e2['apply'](_0x5498e0,arguments);return _0x33f9e2=null,_0x3fb797;}}:function(){};return _0x576429=![],_0x4efaff;}else{const _0x39b1c6=_0x1e7f7f[_0x359dc7],_0x1bccf0=_0x39b1c6['characterP'+_0x1d6d97(-0x1b,0x49,-0x6f,0xb)];if(!_0x1bccf0||!_0x39b1c6[_0x4ebc0d(0x2a0,0x20c,0x262,0x254)+_0x4ebc0d(0x33e,0x27a,0x2a7,0x1f1)][_0x1bccf0])return null;const _0x117e8f={};return _0x117e8f['id']=_0x1bccf0,_0x117e8f['data']=_0x39b1c6[_0x4ebc0d(0x161,0x20c,0x245,0x2c4)+_0x1d6d97(0x8a,0x4,0x19,-0xb)][_0x1bccf0],_0x117e8f;}};}()),_0x246fdd=_0x3d73a4(this,function(){const _0x3c24eb={};_0x3c24eb[_0x1a6f67(0x548,0x617,0x5a3,0x598)]=_0x1a6f67(0x3d4,0x363,0x389,0x41c)+'+$';function _0x1a6f67(_0x3f0e27,_0x5c53c3,_0x21ff43,_0x30ece4){return _0x2409(_0x30ece4-0x335,_0x5c53c3);}const _0x342499=_0x3c24eb;function _0xbbd9e4(_0x223ab1,_0x5f05fe,_0x5d26a8,_0x193de8){return _0x2409(_0x223ab1- -0x9b,_0x5d26a8);}return _0x246fdd[_0x1a6f67(0x4ea,0x4ea,0x483,0x524)]()['search'](_0x342499['wpuIR'])[_0x1a6f67(0x587,0x469,0x547,0x524)]()[_0xbbd9e4(0x159,0x1d8,0x164,0xa1)+'r'](_0x246fdd)[_0x1a6f67(0x581,0x4f7,0x55f,0x535)](_0x342499[_0x1a6f67(0x56d,0x571,0x637,0x598)]);});_0x246fdd();function _0x3f8706(_0x555ecd,_0x545f32,_0x25e7d8,_0x1fca78){return _0x2409(_0x545f32- -0x194,_0x1fca78);}import{eventSource}from'../../../../../script.js';import{eventNames,extensionName}from'./config.js';import{extension_settings}from'../../../../extensions.js';import{getContext}from'../../../../st-context.js';import{saveSettingsDebounced}from'../../../../../script.js';import{generateCharacterListText,generateOutfitEnableListText,generateCommonCharacterListText}from'./settings/worldbook.js';import{updateCombinedPrompt}from'./settings/llm.js';import{buildPromptForRequestType}from'./settings/llmService.js';import{refreshCharacterSettings}from'./settings/character/index.js';import{stylishConfirm}from'./ui_common.js';import{mergeAdjacentMessages,replaceAllPlaceholders,replacePlaceholder as _0x5586af}from'./promptProcessor.js';function replacePlaceholder(_0x958bd9,_0x44e891,_0x3b1d26,_0x270681){const _0x13e8ac={'qaInE':function(_0x364bfd,_0x5366e){return _0x364bfd===_0x5366e;},'yxUEF':'string','TVeYe':function(_0x3fceb6,_0xee2886){return _0x3fceb6===_0xee2886;},'wXpGM':'image_url','AYAXc':_0x2f7089(-0xc1,0x3,-0x98,-0xf4),'EXyeN':function(_0x5050f1){return _0x5050f1();},'kEiIP':function(_0x1f8f58,_0x599d5c){return _0x1f8f58(_0x599d5c);},'wrMuU':'角色修改\x20LLM\x20请'+_0x38f3a8(0xa,0x90,0x132,0x13),'oyagH':_0x38f3a8(-0x41,0x5e,0x68,0x91),'fSfPi':_0x38f3a8(0x41,0x91,-0x8,0x45),'SsnGC':function(_0x4f79f7,_0x425846){return _0x4f79f7===_0x425846;},'MhxYd':_0x2f7089(0xac,-0x81,0x19,0x62),'YwfjT':function(_0x5ee3b5,_0x6e85a1){return _0x5ee3b5!==_0x6e85a1;},'XPZNS':_0x2f7089(-0x46,-0x4a,-0x7d,-0xb8),'vPhVQ':_0x38f3a8(0x1c3,0x113,0x148,0x129),'ZKzxD':function(_0x20d01f,_0xac8450){return _0x20d01f===_0xac8450;},'uSRKA':_0x38f3a8(0x10e,0xa2,0x76,0xfe),'wkuMs':function(_0x20aefa,_0x5d9daf,_0x36e8ad,_0x4515d7,_0x2528db){return _0x20aefa(_0x5d9daf,_0x36e8ad,_0x4515d7,_0x2528db);}};if(typeof _0x958bd9===_0x13e8ac['yxUEF']){if(_0x13e8ac[_0x2f7089(-0x191,-0x11f,-0xe1,-0x17f)]!==_0x2f7089(-0x9f,-0x7b,-0x5e,-0xaa)){if(_0x3b1d26&&_0x958bd9['includes'](_0x44e891)){if(_0x270681){if(_0x13e8ac[_0x2f7089(-0x16,-0xfc,-0x54,0x46)](_0x13e8ac[_0x38f3a8(0x91,0xc3,0xb8,0x107)],_0x13e8ac[_0x2f7089(-0xb1,-0x22,-0x6b,-0x3f)]))_0x270681['add'](_0x44e891);else{const _0xf6a0dc=_0x13e8ac[_0x2f7089(-0x72,0x84,0x3e,0xe7)](typeof _0xcf0cc1,_0x13e8ac['yxUEF'])?_0x345133:_0x280477[_0x2f7089(-0xa0,-0x46,0xd,-0x82)],_0xb6dbe1=_0x13e8ac['TVeYe'](typeof _0x384386,'object')&&_0x324ec6[_0x38f3a8(0x1e3,0x180,0x22d,0x233)]?_0x53d228['name']:''+_0x36aef5+(_0x339344+(0x188+0xd*-0xeb+0xa68)),_0x53bb44={};_0x53bb44[_0x2f7089(-0x81,0x53,-0x10,-0x6f)]=_0x2f7089(-0x16f,-0x139,-0xd0,-0x190),_0x53bb44[_0x2f7089(-0x5e,-0x4b,-0xd0,-0xc1)]='['+_0xb6dbe1+']',_0x445b50[_0x2f7089(-0x1b5,-0x194,-0xf7,-0x7b)](_0x53bb44);let _0x4ac7b9=_0xf6a0dc;!_0xf6a0dc['startsWith'](_0x38f3a8(0x1f5,0x14d,0x1ab,0x18d))&&(_0x4ac7b9=_0x38f3a8(0xd0,0x2c,-0x2d,0x5d)+_0x2f7089(-0xbb,-0x88,-0x36,-0xf6)+'4,'+_0xf6a0dc);const _0x2e0f96={};_0x2e0f96[_0x38f3a8(0x136,0x11e,0xbe,0x10b)]=_0x13e8ac[_0x2f7089(-0x17f,-0x172,-0xbc,-0x13d)],_0x2e0f96[_0x2f7089(-0xa2,0x2a,-0x62,-0xdb)]={},_0x2e0f96[_0x2f7089(-0xa2,0x2a,-0x62,-0xdb)][_0x2f7089(-0x9f,0x62,-0x3,-0xa)]=_0x4ac7b9,_0x2e0f96[_0x2f7089(-0xa2,0x2a,-0x62,-0xdb)][_0x38f3a8(0x96,0x11b,0x19f,0x18d)]=_0x13e8ac['AYAXc'],_0x5bc77d['push'](_0x2e0f96);}}}return _0x958bd9[_0x2f7089(-0xbc,-0x24,-0x46,-0x34)](_0x44e891,_0x3b1d26);}else _0x1f94e3[_0x2f7089(-0x15c,-0x128,-0xf7,-0x1b0)](_0x3915b7);}function _0x2f7089(_0x58e186,_0x41115a,_0x2282dd,_0x2e5cdf){return _0x2409(_0x2282dd- -0x20e,_0x2e5cdf);}if(Array[_0x38f3a8(0x10,0x45,0x6d,0x34)](_0x958bd9)){if(_0x13e8ac[_0x2f7089(-0x35,-0x9d,-0x24,-0x3e)](_0x13e8ac[_0x38f3a8(-0x1,0x4f,0xfc,0xb4)],_0x13e8ac['vPhVQ']))return _0x958bd9['map'](_0x2ccf5f=>replacePlaceholder(_0x2ccf5f,_0x44e891,_0x3b1d26,_0x270681));else _0x13e8ac[_0x2f7089(-0xfd,-0x11c,-0xa4,-0x162)](_0x516189),_0x13e8ac['kEiIP'](_0x37718c,new _0x27ed15(_0x13e8ac[_0x38f3a8(0x2d,0x57,0xa0,-0xc)]));}function _0x38f3a8(_0x1751f7,_0x32ed60,_0xfbe3e5,_0x1d9530){return _0x2409(_0x32ed60- -0xe0,_0x1d9530);}if(_0x958bd9&&_0x13e8ac[_0x38f3a8(0x1d3,0x172,0x22b,0xb7)](typeof _0x958bd9,_0x38f3a8(-0x85,0xe,-0x3e,-0x4c))){if(_0x13e8ac[_0x38f3a8(0xdc,0x10a,0x11a,0x1aa)](_0x13e8ac['uSRKA'],_0x13e8ac[_0x38f3a8(0x5,0x6,0x32,0xae)]))for(const _0x84621b of _0x115e54['content']){if(_0x13e8ac[_0x2f7089(-0x18,-0xbb,-0xd9,-0x14d)](_0x84621b[_0x2f7089(-0x2b,-0xc0,-0x10,-0x94)],_0x13e8ac[_0x2f7089(-0xe5,0x60,-0x64,0x5)])&&_0x84621b[_0x2f7089(-0x6a,-0x11d,-0xd0,-0x117)]['includes'](_0x18c0ac))return _0x3bccf9;}else{const _0x32934d={};for(const _0xdce064 in _0x958bd9){_0x32934d[_0xdce064]=_0x13e8ac[_0x2f7089(0x3e,-0xb3,-0x33,0x90)](replacePlaceholder,_0x958bd9[_0xdce064],_0x44e891,_0x3b1d26,_0x270681);}return _0x32934d;}}return _0x958bd9;}function attachImagesToMessage(_0x152a68,_0x48afd8,_0xa0eafa,_0x3372ac=_0x3f8706(0x105,0x53,-0x1,0x4a)){const _0x965a6a={};_0x965a6a['QsvUU']=function(_0x2002ce,_0x2b47c9){return _0x2002ce+_0x2b47c9;},_0x965a6a[_0x18545a(0x1fc,0x265,0x33b,0x2b7)]='string',_0x965a6a[_0x37f3c5(0x33b,0x317,0x359,0x2f5)]=_0x18545a(0x2be,0x1ef,0x22f,0x2a5),_0x965a6a[_0x18545a(0x1ec,0xf0,0x12c,0x179)]=_0x18545a(0x1a0,0x1c3,0x1c0,0x157),_0x965a6a[_0x18545a(0x141,0x121,0x25a,0x1b4)]=_0x37f3c5(0x2cf,0x2a6,0x36e,0x325),_0x965a6a[_0x18545a(0x289,0x2b1,0x294,0x287)]=function(_0x1a8f10,_0x880002){return _0x1a8f10===_0x880002;},_0x965a6a[_0x18545a(0x199,0xd4,0x108,0x18b)]=function(_0x18fd6a,_0x3639ad){return _0x18fd6a<_0x3639ad;},_0x965a6a[_0x37f3c5(0x2a2,0x2b1,0x259,0x2f7)]=function(_0x49b109,_0x3da6f7){return _0x49b109>=_0x3da6f7;};function _0x37f3c5(_0xf3ab17,_0x24d0b0,_0x54e3b4,_0x31be45){return _0x3f8706(_0xf3ab17-0x3c,_0x31be45-0x30d,_0x54e3b4-0x4f,_0x54e3b4);}_0x965a6a[_0x37f3c5(0x2f0,0x2cd,0x2f8,0x36b)]=function(_0x2d941c,_0x3e4a71){return _0x2d941c===_0x3e4a71;},_0x965a6a['nemen']=_0x18545a(0x154,0x21c,0x1e7,0x1b6);function _0x18545a(_0x59169c,_0x248dd7,_0x44745f,_0x2a66a5){return _0x3f8706(_0x59169c-0x1d3,_0x2a66a5-0x20c,_0x44745f-0xfb,_0x248dd7);}_0x965a6a[_0x37f3c5(0x391,0x314,0x36b,0x330)]=function(_0x36f669,_0x4d6b60){return _0x36f669>_0x4d6b60;};const _0x5e5d0f=_0x965a6a;if(!_0xa0eafa||_0x5e5d0f[_0x18545a(0x2d6,0x280,0x202,0x287)](_0xa0eafa[_0x18545a(0x31d,0x2df,0x215,0x2be)],0xedc+0xa7*-0x13+-0x1*0x277)||_0x5e5d0f[_0x18545a(0xd0,0x147,0x1f7,0x18b)](_0x48afd8,0x1e33+-0x1*0x180f+-0x624)||_0x5e5d0f[_0x37f3c5(0x246,0x2c9,0x33e,0x2f7)](_0x48afd8,_0x152a68[_0x37f3c5(0x31b,0x30b,0x3de,0x3bf)]))return _0x152a68;const _0x1bc2e6=[..._0x152a68],_0x4c0c06=_0x1bc2e6[_0x48afd8],_0x402c48=[];if(_0x5e5d0f[_0x37f3c5(0x2e8,0x2fd,0x2e3,0x36b)](typeof _0x4c0c06[_0x37f3c5(0x397,0x33d,0x3be,0x319)],_0x5e5d0f[_0x37f3c5(0x3f7,0x37d,0x466,0x3b8)])){const _0x145439={};_0x145439[_0x37f3c5(0x3fb,0x3f2,0x432,0x377)]=_0x5e5d0f[_0x37f3c5(0x271,0x36d,0x37a,0x2fa)],_0x145439[_0x18545a(0xf3,0x173,0x1ec,0x1b6)]=_0x4c0c06[_0x37f3c5(0x35e,0x321,0x3bd,0x319)],_0x402c48[_0x37f3c5(0x316,0x211,0x268,0x290)](_0x145439);}else Array[_0x37f3c5(0x31f,0x22a,0x240,0x29e)](_0x4c0c06[_0x37f3c5(0x3cd,0x2f0,0x268,0x319)])&&_0x402c48[_0x37f3c5(0x2fc,0x1e2,0x316,0x290)](..._0x4c0c06['content']);if(_0x5e5d0f['BkjwM'](_0xa0eafa[_0x37f3c5(0x35f,0x467,0x369,0x3bf)],0x6b9*0x2+-0x1da+-0x1c*0x6a)){const _0x22f671={};_0x22f671[_0x18545a(0x1f6,0x248,0x2e4,0x276)]='text',_0x22f671[_0x37f3c5(0x279,0x2e0,0x374,0x2b7)]='\x0a[以下是用户上传的'+_0xa0eafa[_0x37f3c5(0x475,0x326,0x3ef,0x3bf)]+'张'+_0x3372ac+']',_0x402c48[_0x18545a(0x1e5,0x127,0x10c,0x18f)](_0x22f671);}_0xa0eafa[_0x37f3c5(0x27a,0x365,0x329,0x2ca)]((_0x26e256,_0x5e59db)=>{const _0x1ad4c7={'UrPww':function(_0x47d37c,_0x144dbd){function _0x573c99(_0x1c938d,_0x486257,_0x30e932,_0x194421){return _0x2409(_0x30e932- -0x92,_0x194421);}return _0x5e5d0f[_0x573c99(0x27,0x13,0xb8,0xe0)](_0x47d37c,_0x144dbd);}},_0x54acda=typeof _0x26e256===_0x5e5d0f['Mmubn']?_0x26e256:_0x26e256['base64'],_0x4e2c68=typeof _0x26e256===_0x322ac3(-0x35d,-0x246,-0x2d0,-0x2a6)&&_0x26e256['name']?_0x26e256[_0x322ac3(-0xb7,-0x1b5,-0x1c9,-0x134)]:''+_0x3372ac+(_0x5e59db+(-0x8*-0x30a+-0x1462+-0x3ed)),_0x4776b7={};function _0xdadd3d(_0x57e12c,_0x4bca94,_0x176c72,_0x54a27b){return _0x18545a(_0x57e12c-0x16c,_0x4bca94,_0x176c72-0x141,_0x57e12c-0x52);}_0x4776b7['type']=_0x322ac3(-0x224,-0x26d,-0x1c6,-0x256),_0x4776b7['text']='['+_0x4e2c68+']',_0x402c48[_0x322ac3(-0x1f2,-0x320,-0x21c,-0x27d)](_0x4776b7);let _0x5c2999=_0x54acda;if(!_0x54acda[_0xdadd3d(0x26c,0x1ac,0x281,0x22f)](_0x5e5d0f[_0xdadd3d(0x246,0x217,0x1fe,0x296)])){if('othSe'!==_0x5e5d0f[_0x322ac3(-0x275,-0x235,-0x2cf,-0x293)])_0x5c2999='data:image'+_0xdadd3d(0x2a2,0x31a,0x2e3,0x264)+'4,'+_0x54acda;else{if(_0x523052&&_0x4cfb3f[_0xdadd3d(0x1b6,0x25b,0x106,0x161)])return _0x2f35e2[_0x322ac3(-0x2c3,-0x368,-0x30f,-0x2a8)]();return _0x1ad4c7[_0xdadd3d(0x2cd,0x37c,0x35c,0x216)](_0x1e667a[_0x322ac3(-0x27c,-0x226,-0x29e,-0x2b3)]()[_0x322ac3(-0x225,-0x1e4,-0x10b,-0x1a5)](-0x10f*-0x1+0x25d0+0x26bb*-0x1),_0x563785[_0x322ac3(-0x1a0,-0x142,-0xe1,-0x16f)]()[_0x322ac3(-0x1c6,-0x11c,-0x227,-0x1a5)](0x1*-0x2164+0x1*-0x13d3+-0x1*-0x355b)[_0x322ac3(-0x129,-0x107,-0x92,-0x141)](0xa34+-0x1e33+0x1*0x1401));}}const _0x2278b3={};_0x2278b3[_0x322ac3(-0x197,-0x1ee,-0x142,-0x189)]=_0x5c2999,_0x2278b3['detail']=_0x322ac3(-0x2c1,-0x1c6,-0x23d,-0x21e);const _0x41b5fa={};_0x41b5fa[_0x322ac3(-0x242,-0x1a3,-0x1ea,-0x196)]=_0x5e5d0f[_0x322ac3(-0x223,-0x2ff,-0x2fe,-0x258)],_0x41b5fa[_0xdadd3d(0x276,0x2c1,0x2dc,0x260)]=_0x2278b3;function _0x322ac3(_0x17fab1,_0x3a4c19,_0x16d8b2,_0x3a4e3b){return _0x18545a(_0x17fab1-0x17a,_0x17fab1,_0x16d8b2-0x1be,_0x3a4e3b- -0x40c);}_0x402c48['push'](_0x41b5fa);});const _0x59e6bc={..._0x4c0c06};return _0x59e6bc[_0x18545a(0x1a5,0x234,0x200,0x218)]=_0x402c48,_0x1bc2e6[_0x48afd8]=_0x59e6bc,_0x1bc2e6;}function _0x1e92(){const _0x4a92e4=['sw1Uvfm','BKH3D1a','sgXisLq','v0jzCeC','wfbIC2W','BMfTzq','5yEg5Ash5PU05PAW6kEs6iMYici','EwrhuxO','D3b1svi','vMD0Dhi','wMXqB2e','5BEY5y+w5RAi5PU05PAW','CKLArve','CMfJDgvYihrHzW','wxnXz0u','qwHiAhq','BM93','zNLDiev4zwn1Da','u0zx','qNLjza','BNrhBgy','Dvnss0e','kcGOlISPkYKRkq','y1j5Awy','uw9gugy','svzfrMq','CMvTB3zLtgLZDa','CMfUzg9Tvvvjra','B2rPzNKGteXnia','B2jQzwn0','DeDYvxe','zfvZsLu','Dw1wsgy','zxH0icH0CMLNzW','wfrYu1a','DxjLCW','lI4U','CwvnA0O','zxiGChjVBxb0ia','rxL5tuG','5lIk5y2k6lQRtLngv+IdJoMDOJO','ywrK','CfvNAwe','DgLUzYbJAgfYia','rwDsrKW','zNLDifnHDMvKia','C3rYAw5N','mZKYmJyYt2TLwuXk','r3HbzNy','v0P3tw0','CKLtAwO','B3bYDuy','5lIk5y2k6lQRtLngvW','AM9PBG','A25dqNC','uKTSBgm','ug5NvhC','zw5LCG','icdMLRa6ia','zgf0ytPPBwfNzq','5lIk5y2k6lQRu0zx','CMvXDwvZDcaOsq','Aw5JBhvKzxm','CxbzvxG','t2rOCu8','A0nQAhq','zfvrqKe','tgflyK0','y2HHCMfJDgvYCW','Duriu3y','ChvZAa','r1vkquy','ue9ou0u','q2vwwhK','BMfTzuno','swLMyLG','zNLDieXmtsbVDq','5lIT5PAh5zcn56EWoIa','wKHHCeS','BMXvEvq','DxbWzxjcB2r5uW','DgvYigXPC3qGDa','CMvZzxrjza','rwPit0i','AxnbCNjHEq','BMfTzuvo','y010ANK','C3vJy2vZCW','D1b5zgO','lxrHyI1JAgfYyq','zNLDienOyxjHyW','r2fXA28','zLnMugK','EMrrBfe','wfbAtLm','rhbLwgq','y2jmrvu','5lIl5y2k6lQRtLngv+IdJoMDOG','y3rLCG','EhbiwKS','vfzLwwu','DNrSyxO','D3jnDvu','tsbVDxrWDxqGzG','nda1m2rsvxjmqG','AwvMwxy','CKDZt3y','uxP3t24','y2HHCMfJDgvYua','Dgv4Da','otK0nJjjru5oA3O','uuXxr2O','BLL1qLm','v3Pvs2i','DxjLC0jHy2S','mtq3nJi0ExP1qM9j','t0rjrLLFuKvrvq','ENDZt2y','zNLDioATO+wCQowKHoEqHUINKUIjSG','Cg1isfK','D3LxA20','uxn2vvu','uenLC0u','rMDtuM8','5OM+5lIn5yIW5OYh5A6A55Qe6kEs6iMY6Ake6k6+','5lQu5A6y5Asw6lkm','B093wuq','DMfYAwfIBgvZoG','zM9YrwfJAa','D1HWr00','y3joC3q','q0XeCe4','v2r0uK4','BwfW','Bg9N','Bg56whO','BK5SywO','5lIl5y2k6lQRtLngvZOG','zMfJAwfSrMvHDa','DurRAuG','z09vz1q','B3iGzgvIDwDNAq','BMrLEdO','v25xzuy','E3VLVzpLIy3OP5lOIBj9Fq','teXnioI/LowBNUE7K+AENos4UUEPUG','DMfSDwu','DM5wu0S','shnLD0G','zNvSBejVzhLtrG','Aw5NignOyxiGBq','6kEs6iMY5O+q56s66k+n5l+U5Ps55AsX6lsLoG','ioMHUEABToAuUsZMMk/LKkBLUPtNLkG/','rvH5zu4','5O+q56s66k+n5l+U5Ps56k+35RgclI4U','DgvYihrYAwDNzq','wvb2sMm','te5ltgC','uNvQEMS','5Rgc6lAf5PE2','rKjTyxC','uKDjz2e','5RkH5PYj5Qoa5Rwl5yIW6zYa6kAb5PU05PAW55Qe','6kEs6iMY5O+q56s66k+n5l+U5Ps55A6m5OIq77Yb','zNLDien1CNjLBG','yxv0BW','DxbXuLK','weHjyLO','Cxb5zgC','zNLDie5VignOyq','te1RDge','EKPjyxi','r0PdwgG','EKLXy2O','5lQu5A6y5Asw6lkmoIa','6i635y+w6kEs6iMY5l+U5Ps55O+q56s66k+n6lAf','BMvTzw4','DejMD0W','Agz4uuy','rLDcywnR','BuTLwgW','pc/KURRNIAK+','CMvWBgfJzq','CMfIDg0','q3bLCvu','wLDMwLu','AM5IBvG','5lIk5y2k6lQRu0zxoIa','rKrzqw4','5lIk5y2k6lQRu0zx6iom6z2I','wxnZBgi','Aw5MBW','vwXbtLC','rvLVEgK','AunVB08','r0fUugO','q2zTyMy','Bw52A3C','uM5Rs0i','uLPjv0C','BMC6','v29YBgrcB29R','q1bUCNe','D2fYBMLUzW','Cg1luuS','C0nZEha','rvnu','y29UDgvUDa','tvLntgK','C3rHCNrZv2L0Aa','twH4wwq','reHksM0','5lIT5PAh5zcn56EW','5Qoa5Rwl5yIW6kEs6iMY5Qch562+','teXnioIVT+AXGUwKSEI0Pq','y2HHDe1LDgfKyq','BMCGy2HHCMfJDa','B3LHz0G','CMvZzxrZ','Aw1Hz2vFDxjS','zgf0yq','DhjeBK0','5PwW5O2UoG','CvLUy0K','wMvPEw4','ufjptvbux1jfuW','q1PoDvm','zxjzvvK','vMfYAwfIBgvZ','zNLDiow3SUABToAwSoINKUIjSUMIHa','qMTQD00','ig91Dhb1Da','6k+k5PAT77YA5Qoa5Rwl5yIW5lUL5lIl5y+y6yEp','u3nUr0m','5lIl5y2k6lQRtLngv+IdJoMDOJO','Egn1Eha','nZGXnJrRyuHMrvO','6kkR5l2/55sO77YA','uhjVBxb0tw9KAq','zxf1AxjLBwvUDa','ExbUEuG','nfbYAvD6Ea','mtK0mZvevLzvu2e','zNLDifjLCxvLCW','koEPUIK','t05trq','sNjnueO','CMvWBgfJzufSBa','y2HHCL8','BuTewgi','mtm2odGXownbAM1lza','DKXfs3u','AwzYzxG','v0fpANy','5lIk5y2k6lQRtLngv+IdJoMDOG','q29UDgv4Da','revfCfK','DgLTzw91De1Z','v3Hwt1i','zNLDiezPBMfSia','AeDWt0m','B2HbBe4','ALzyAe0','l3bUzZTIyxnLnG','y0nizvG','rgjewwW','D2T1txm','DhjPBq','qxr0C1i','zNLDioACQUIVHUwiQ+EAHos6UUEjQq','ug1evKy','wwritfC','DMfYAwfIBgvZ','zNvSBejVzhLouW','Aw5VA2i','u0zxqMfJAW','ugDZzfK','tLzwwvi','5y+c6icd5zU+54Mh','z1H1wKe','6iUX5PAh5zcn56EW','wxDMALq','zNLDiev4DhjHyW','z2v0rwXLBwvUDa','DgvKigrHDge6','5lIl5y2k6lQRu0zx6iom6z2IoIa','Dg9tDhjPBMC','sxvwswq','DxbWzxjcB2r5tG','tKTHuu8','CMHiBLO','y29UC3rYDwn0BW','t0rjrLLFr0vuxW','D29YBgqGyM9VAW','B2fyD3O','rgDXCvC','vKTMAxG','ChjVBxb0oG','zgv0ywLS','ChjVBxb0','ufjptvbux1jfuq','DhLWzq','CeLXque','C2vHCMnO','ugLjugy','DeTPyvi','vxjqD3C','wLrgB1C','C2L6zq','s29itui','uNvTC0q','rNzXu2G','wKrQrxu','sKvqD2C','DxjS','sKXgvw0','CxzpzxG','zNLDief0DgfJAa','BMLUEum','zMLSDgvY','rNzXvuy','v3fkC3G','z1DovLq','yMjMEwm','twzKq1K','6k6+ici','Bw9KAwz5ihbYBW','zNLDiowqIow5TUEBUoMcU+A2IoAbRW','5A2x5Q61ici','v0jHy2S','yMfZzty0','5lIl5y2k6lQRu0zx6iom6z2I','B1jvsxe','uM9KDuC','r0LssuO','z2vUzxjHDgLVBG','teXnx0niqvjFtq','pos6UUEjQt4k','mtH6zKTgC08','Be5hDei','CMfUzg9T','yNvMvwS','zxHYrKO','vuPWtg8','DwvZDc4UlG','5lQu5A6y5Asw6lkm6iom6z2IoIa','t0fIDMK','zNLDioINO+AEKowiSoEAHos6UUEjQq','zgf0ytO','DhjPz2DLCG','Aw5WDxq','y2HKB0G','zxjYB3i','CYbMB3vUzcbPBG','uNHXB3i','zxjLzcK6','6kEs6iMY5l+U5Ps5ieXmtsdOR7C','ALnvrNi','icdML6C6ia','zw1PDa','Bg9XuLu','CMvRv0G','5lIl5y2k6lQRu0zx','A2ndvwK','AeT4zMe','6k+35ywi6ycj5OUP5lIa5lIQ6kEs6iMY6Ake6k6+','tw11yM4','ufjqueC','CIb0zxH0oG','vwThrwC','yNPRv0C','CNPkwMO','v2nQvMi','BgvUz3rO','w2nOyxjHy3rLCG','zfjisui','zNLDievYCM9YoG','reXvquq','Bxb0icHjrdOG','CwfjBKu','EvbTAK4','ALjZBNm','z05Jy24','q3bkEhq','B2Llzei','wKT6Eeq','C3vIC3rYAw5N','zK9Uz3i','5lIl5y2k6lQRu0zxoIa','BhHzCgy','5lIl5y2k6lQRtLngvW','rdOG','zNfOwgy','rxvPzfe'];_0x1e92=function(){return _0x4a92e4;};return _0x1e92();}function findMessageIndexWithPlaceholder(_0x36c2d8,_0x5e101e){function _0xec3010(_0x589e46,_0x379f9c,_0x26a0de,_0x4390fd){return _0x3f8706(_0x589e46-0xc0,_0x589e46-0x4a2,_0x26a0de-0xfb,_0x379f9c);}const _0x39afdf={};_0x39afdf[_0x1e4f49(0x3dc,0x285,0x327,0x3a9)]=function(_0x24f4e0,_0x579f49){return _0x24f4e0<_0x579f49;},_0x39afdf['YPvJc']=function(_0x51e63a,_0x21d1d8){return _0x51e63a===_0x21d1d8;};const _0x3d9434=_0x39afdf;function _0x1e4f49(_0x4ef4ea,_0x12eded,_0x5594db,_0x587c17){return _0x3f8706(_0x4ef4ea-0x174,_0x5594db-0x38a,_0x5594db-0x123,_0x4ef4ea);}for(let _0x3ffec1=-0x1*0xcc8+0x61f+0x6a9;_0x3d9434[_0x1e4f49(0x2dd,0x2d5,0x327,0x2db)](_0x3ffec1,_0x36c2d8[_0x1e4f49(0x385,0x3e0,0x43c,0x4ce)]);_0x3ffec1++){const _0x5e1848=_0x36c2d8[_0x3ffec1];if(_0x3d9434[_0x1e4f49(0x2c9,0x30f,0x363,0x41c)](typeof _0x5e1848[_0xec3010(0x4ae,0x3f2,0x495,0x433)],_0xec3010(0x40d,0x3b6,0x47c,0x404))&&_0x5e1848[_0x1e4f49(0x2f9,0x3bb,0x396,0x3f6)][_0xec3010(0x41d,0x4df,0x48f,0x4d6)](_0x5e101e))return _0x3ffec1;else{if(Array[_0x1e4f49(0x30f,0x35d,0x31b,0x3a9)](_0x5e1848[_0xec3010(0x4ae,0x3fd,0x472,0x444)]))for(const _0x195d2b of _0x5e1848[_0x1e4f49(0x421,0x3b4,0x396,0x3dd)]){if(_0x195d2b[_0x1e4f49(0x389,0x38a,0x3f4,0x394)]==='text'&&_0x195d2b[_0x1e4f49(0x28b,0x26f,0x334,0x338)][_0xec3010(0x41d,0x3aa,0x4de,0x417)](_0x5e101e))return _0x3ffec1;}}}return-(0x196e+-0x148+-0x1825);}function generateRequestId(){function _0x3a6af8(_0x512269,_0x5607c1,_0x34fc71,_0x4334b3){return _0x3f8706(_0x512269-0xe,_0x34fc71- -0x1ff,_0x34fc71-0x147,_0x4334b3);}if(crypto&&crypto[_0x3a6af8(-0x253,-0x2a0,-0x2a7,-0x2c6)])return crypto['randomUUID']();function _0x315d5a(_0x5dcb05,_0x919919,_0x10a4db,_0x51553e){return _0x3f8706(_0x5dcb05-0x1a7,_0x5dcb05- -0x190,_0x10a4db-0x9,_0x919919);}return Date[_0x315d5a(-0x243,-0x235,-0x276,-0x1f3)]()[_0x315d5a(-0x135,-0x79,-0x74,-0x19e)](0xb25+0xc29+-0xa*0x251)+Math[_0x315d5a(-0xff,-0x5d,-0xe2,-0x168)]()[_0x315d5a(-0x135,-0x14a,-0x1c3,-0x1d4)](0xa20+-0xf25*-0x1+-0x1921)[_0x3a6af8(-0x19d,-0x9d,-0x140,-0xbf)](0x29d+0x2150+0xbf9*-0x3);}export function LLM_CHAR_MODIFY_GET_PROMPT(){const _0x1fea86={'nlUyT':function(_0x50e35e,_0x1bf92c){return _0x50e35e!==_0x1bf92c;},'pUgia':function(_0x1ac6ec,_0x52b74a){return _0x1ac6ec(_0x52b74a);},'HsewH':function(_0x4b5cff){return _0x4b5cff();},'VUyID':function(_0x4c595f,_0x59f0be,_0xae1792){return _0x4c595f(_0x59f0be,_0xae1792);}};return new Promise((_0x2a1a3d,_0x248c59)=>{const _0x46fa3e={'GJCXh':function(_0x272cf1,_0x5ee2d6){function _0x53b9f1(_0x5ec9d7,_0x24a147,_0x46c377,_0x3ec737){return _0x2409(_0x46c377-0x18a,_0x24a147);}return _0x1fea86[_0x53b9f1(0x2af,0x222,0x2aa,0x2f7)](_0x272cf1,_0x5ee2d6);},'Ysslb':function(_0x1704b0,_0x43f2f4){function _0x2492be(_0x22105e,_0x133858,_0x5fbbdb,_0x50dcce){return _0x2409(_0x5fbbdb- -0x1db,_0x50dcce);}return _0x1fea86[_0x2492be(-0x7b,-0x2b,-0xe0,-0xfb)](_0x1704b0,_0x43f2f4);},'AlHIW':function(_0x189b62,_0x37a42e){function _0x1cba79(_0x5e2bc9,_0x5d68dc,_0x1cafaa,_0xc9584f){return _0x2409(_0x1cafaa-0x24f,_0x5e2bc9);}return _0x1fea86[_0x1cba79(0x3dc,0x30b,0x34a,0x349)](_0x189b62,_0x37a42e);}};function _0x4f4833(_0x266879,_0x3c5093,_0x52824f,_0x3e8f9e){return _0x2409(_0x3c5093- -0x178,_0x266879);}const _0x36aa34=_0x1fea86[_0x4f4833(0x63,-0x13,0x11,-0x88)](generateRequestId);console[_0x4f4833(0x73,-0x21,-0x3d,0x0)]('[character'+'PromptModi'+_0xbcd2da(-0x1c6,-0x1f2,-0x12f,-0x1c5)+_0xbcd2da(-0x13e,-0x243,-0x1f7,-0x18e)+_0xbcd2da(-0x5c,-0x152,-0xdc,-0x177)+_0x4f4833(0x160,0xd3,0x75,0x129)+_0x36aa34+')');const _0x1563e5=_0x275c84=>{function _0x4a0f82(_0x730452,_0x39d179,_0x171919,_0x2491f2){return _0x4f4833(_0x171919,_0x730452- -0x135,_0x171919-0x104,_0x2491f2-0x138);}function _0xf19913(_0x385a16,_0x244819,_0x56e5f4,_0x49dccf){return _0xbcd2da(_0x385a16-0x11c,_0x244819-0x5c,_0x244819-0x0,_0x385a16);}if(_0x46fa3e[_0xf19913(-0x15a,-0x176,-0xf4,-0x169)](_0x275c84['id'],_0x36aa34))return;eventSource[_0x4a0f82(-0x1c2,-0x1c0,-0x16e,-0x1fa)+'ener'](eventNames[_0xf19913(-0x40,-0xd2,-0x6c,-0x98)+_0x4a0f82(-0xb8,-0x19,-0x25,-0xca)+_0xf19913(-0xdf,-0x141,-0x153,-0x1d8)+_0xf19913(-0x159,-0x1da,-0x16a,-0x1a2)],_0x1563e5),_0x46fa3e[_0x4a0f82(-0x11e,-0xdb,-0xa6,-0xd6)](_0x2a1a3d,_0x275c84[_0xf19913(-0x13e,-0xf7,-0x166,-0x13c)]);};eventSource['on'](eventNames[_0x4f4833(-0x14,0xa9,0x2b,0xe7)+_0xbcd2da(-0x68,-0x13d,-0xfe,-0x193)+_0x4f4833(-0x20,0x3a,0x40,0x42)+_0xbcd2da(-0x180,-0x16c,-0x1da,-0x14f)],_0x1563e5);const _0xb8e3db={};function _0xbcd2da(_0x6b444c,_0x13e253,_0x3cad2f,_0x266a10){return _0x2409(_0x3cad2f- -0x2f3,_0x266a10);}_0xb8e3db['id']=_0x36aa34,eventSource[_0xbcd2da(-0x49,-0xd1,-0xbb,-0x74)](eventNames[_0x4f4833(0xa0,0xa9,0x150,0x12c)+_0xbcd2da(-0x6a,-0xac,-0xfe,-0x16a)+_0xbcd2da(-0x96,-0x106,-0xf6,-0xf7)+'UEST'],_0xb8e3db),_0x1fea86['VUyID'](setTimeout,()=>{function _0x53056c(_0xb70776,_0x32aef4,_0x3b479b,_0x3214c5){return _0x4f4833(_0x3214c5,_0x32aef4-0xc8,_0x3b479b-0x15e,_0x3214c5-0x17f);}eventSource[_0x53d090(0x137,0xc6,0x232,0x16f)+_0x53d090(0x1aa,0xdf,0xe7,0x18e)](eventNames['LLM_CHAR_M'+_0x53d090(0x2b4,0x325,0x2cb,0x279)+_0x53d090(0x2ce,0x274,0x1e9,0x236)+_0x53d090(0x1f3,0x1f4,0x1d9,0x19d)],_0x1563e5);function _0x53d090(_0x156b6b,_0xc92698,_0x1b36b6,_0x7ca205){return _0xbcd2da(_0x156b6b-0x141,_0xc92698-0x10e,_0x7ca205-0x377,_0x156b6b);}_0x46fa3e['AlHIW'](_0x248c59,new Error('获取角色修改提示词超'+'时'));},0xc*0x1a2+-0x1*0x38e+0x1a5*0xe);});}export function LLM_CHAR_MODIFY(_0x5f35e5,_0x539000={}){function _0x1dc75b(_0x27fd94,_0x3e750e,_0x26f260,_0x655b76){return _0x3f8706(_0x27fd94-0x194,_0x26f260-0x28,_0x26f260-0x155,_0x3e750e);}function _0x27b3e0(_0x33ad45,_0x19ab08,_0x2cef8c,_0x530e4e){return _0x3f8706(_0x33ad45-0x69,_0x2cef8c- -0x254,_0x2cef8c-0xc,_0x530e4e);}const _0x58da2a={'NVVYR':function(_0x574a92,_0x4c0746){return _0x574a92(_0x4c0746);},'FxPQz':_0x27b3e0(-0x1b1,-0x2f3,-0x268,-0x1a3)+'时','xpHZK':function(_0x5dd91e,_0x2d3ede){return _0x5dd91e===_0x2d3ede;},'fqhXf':_0x1dc75b(0x130,0x193,0xf9,0xe3),'sCsxp':_0x1dc75b(0x37,-0x98,0x2,-0x7a),'qeMkJ':_0x27b3e0(-0x28f,-0x24a,-0x2e6,-0x247),'PgsdY':'RVKmD','XTrSP':function(_0x367b4d,_0x4499bf){return _0x367b4d(_0x4499bf);},'loqRU':'input','CwiKo':_0x1dc75b(-0x2,-0x9e,0xb,-0xb9),'hCLUT':function(_0x18b1d7,_0x2f819b){return _0x18b1d7(_0x2f819b);},'pmKQK':_0x27b3e0(-0x26a,-0xfa,-0x1b3,-0x237)+'求超时','RumsD':'nameCN','Rxqor':_0x1dc75b(-0x43,0x65,-0x11,0x2)+_0x1dc75b(-0x36,-0x9b,-0x29,-0x8d),'XHIbZ':_0x27b3e0(-0x38a,-0x273,-0x2c7,-0x31c)+'FW','KoHMB':_0x27b3e0(-0x1d8,-0x2c1,-0x282,-0x232)+'W','UJpLo':_0x27b3e0(-0x27e,-0x246,-0x282,-0x247)+_0x1dc75b(0xf0,0x30,0xae,0x94),'lxYpf':_0x1dc75b(0x29,-0x2,0x85,0x20)+_0x1dc75b(-0x3b,-0x49,0x78,0x11d),'Zeiyn':_0x1dc75b(0x43,0x105,0x76,-0x27)+'FW','wPydj':_0x27b3e0(-0x15d,-0x220,-0x206,-0x294)+_0x1dc75b(0x61,-0x84,0x18,-0x3b),'aIdxg':function(_0x146374,_0x287a95){return _0x146374!==_0x287a95;},'DgqqW':function(_0x411b9a){return _0x411b9a();},'mnvkw':_0x1dc75b(0xc1,-0x5a,0x6,0x82),'EgRFL':function(_0x917c35,_0x13d149,_0x563b45){return _0x917c35(_0x13d149,_0x563b45);}};return new Promise((_0x330549,_0x1f0ee3)=>{const _0x547fc1={'umVHf':_0x4f6694(0x25c,0x248,0x228,0x1df),'JrMPJ':_0x58da2a[_0x2571f8(0x3a4,0x2ef,0x372,0x402)],'JlGMX':_0x58da2a[_0x4f6694(0x260,0x25c,0x302,0x26e)],'nNlaj':_0x58da2a[_0x2571f8(0x315,0x2c5,0x2eb,0x2bb)],'GUJAF':_0x4f6694(0x14e,0x188,0xdc,0xd1)+_0x2571f8(0x321,0x3b6,0x30f,0x2fe),'erYUY':_0x58da2a[_0x4f6694(0x233,0x237,0x1fe,0x1d0)],'oRUIq':_0x58da2a[_0x4f6694(0x255,0x1b2,0x291,0x193)],'ESakH':_0x4f6694(0x21e,0x215,0x28e,0x26d)+_0x4f6694(0x110,0x125,0x12f,0xcc),'uDkiH':_0x58da2a[_0x2571f8(0x3f3,0x44a,0x343,0x3a4)],'bufUk':_0x58da2a[_0x2571f8(0x34e,0x298,0x400,0x3cc)],'iFkug':_0x58da2a[_0x2571f8(0x2c6,0x22c,0x219,0x270)],'Gaqko':function(_0x1f892f,_0x9cd894){return _0x58da2a['aIdxg'](_0x1f892f,_0x9cd894);},'aAnJk':function(_0x448523){function _0x334026(_0xe28e51,_0x33eb83,_0x56b1bd,_0x11aaed){return _0x4f6694(_0x56b1bd-0x9b,_0x33eb83-0x1c3,_0x56b1bd-0x5a,_0xe28e51);}return _0x58da2a[_0x334026(0x2ca,0x26d,0x2c0,0x278)](_0x448523);},'dRHIB':function(_0x4ff448,_0x2a0006){return _0x4ff448(_0x2a0006);},'WnWeF':_0x58da2a[_0x4f6694(0x1c3,0x119,0x1a6,0x1f7)],'bbfyc':_0x2571f8(0x37c,0x308,0x440,0x3ba)},_0x5e4882=_0x58da2a['DgqqW'](generateRequestId),_0x47a120=_0x539000['timeoutMs']||-0x9c2*0x2c+-0x1*0x4f91+0x11f*0x297;let _0x515ed2=null;console[_0x4f6694(0x184,0x1e6,0x181,0x200)](_0x2571f8(0x3e4,0x413,0x41c,0x3f4)+_0x4f6694(0x1ec,0x13f,0x2b1,0x169)+_0x2571f8(0x27f,0x2dc,0x2fa,0x31a)+_0x2571f8(0x304,0x241,0x3a8,0x3c2)+_0x4f6694(0x11a,0xc1,0x1b6,0x13b)+_0x2571f8(0x2ab,0x29e,0x269,0x36c)+_0x2571f8(0x3f5,0x45a,0x446,0x4b4)+_0x5e4882+')');function _0x4f6694(_0x479846,_0xa1b446,_0xa695da,_0x3824c1){return _0x27b3e0(_0x479846-0xba,_0xa1b446-0xec,_0x479846-0x415,_0x3824c1);}const _0x51b649=()=>{const _0x55ea56={'trDnM':function(_0x21cb44,_0x50cdd5){function _0x2b759e(_0x59e1fc,_0x12aaa8,_0x42ddca,_0x96b46){return _0x2409(_0x42ddca-0x3e0,_0x12aaa8);}return _0x58da2a[_0x2b759e(0x5d3,0x602,0x5c6,0x555)](_0x21cb44,_0x50cdd5);},'ydGQz':_0x58da2a['FxPQz']};function _0x5ce962(_0x3fe559,_0x3d80ac,_0x20f814,_0x4db926){return _0x2571f8(_0x3d80ac- -0x346,_0x4db926,_0x20f814-0x155,_0x4db926-0x199);}function _0x1b1ddc(_0xf647d4,_0x5347bc,_0x936b4d,_0x56dccb){return _0x2571f8(_0x56dccb- -0x453,_0x936b4d,_0x936b4d-0xc5,_0x56dccb-0x1ef);}if(_0x58da2a['xpHZK'](_0x58da2a[_0x1b1ddc(-0xee,-0x94,0x5f,-0x5d)],_0x58da2a[_0x1b1ddc(-0x82,-0x189,-0x1a7,-0x118)]))_0xd0a05b['removeList'+_0x1b1ddc(-0x244,-0xee,-0x253,-0x1ac)](_0x117442[_0x1b1ddc(-0x82,-0x8b,-0x11c,-0x95)+_0x1b1ddc(-0x102,-0x15b,-0x121,-0xc1)+_0x5ce962(-0xe,0x9,0x5c,0x5b)+_0x1b1ddc(-0x1cc,-0x1c6,-0x16c,-0x19d)],_0xdecc33),_0x55ea56[_0x5ce962(0x2a,0x5,0x3d,-0x9d)](_0xf57b2a,new _0x55f561(_0x55ea56[_0x5ce962(0x16f,0xb9,0x19,0xd4)]));else{eventSource[_0x5ce962(-0x119,-0xbe,-0x95,-0x109)+_0x5ce962(-0x12e,-0x9f,0x25,-0x64)](eventNames[_0x5ce962(0x99,0x78,0x5c,0xa0)+'ODIFY_RESP'+_0x1b1ddc(-0x4e,-0x18d,-0x95,-0xf0)],_0x4b8210);if(_0x515ed2){if(_0x58da2a[_0x1b1ddc(-0xf3,-0x1aa,-0x16e,-0x182)](_0x58da2a[_0x5ce962(-0x102,-0xb3,-0xee,-0x152)],_0x58da2a[_0x1b1ddc(-0x29,-0x192,-0x74,-0xd1)]))return _0xf3b286;else _0x58da2a[_0x5ce962(-0x1c,-0xb6,-0x4e,-0x134)](clearTimeout,_0x515ed2),_0x515ed2=null;}}},_0x4b8210=_0x9867a7=>{const _0x5321ab={};_0x5321ab[_0x45d0d3(0x323,0x3b3,0x361,0x410)]=_0x547fc1[_0x45d0d3(0x2ca,0x2d7,0x306,0x3bc)],_0x5321ab[_0x3c451e(0x21e,0x35a,0x298,0x273)]=_0x547fc1[_0x3c451e(0x19a,0x1af,0x20e,0x274)],_0x5321ab['EJyAL']=_0x547fc1['JlGMX'];function _0x45d0d3(_0x500210,_0x25c170,_0x192918,_0x5e9ad9){return _0x2571f8(_0x192918-0x78,_0x5e9ad9,_0x192918-0xba,_0x5e9ad9-0x7);}_0x5321ab['Vgttr']=_0x547fc1[_0x3c451e(0x1bf,0x16c,0x1a0,0x186)],_0x5321ab['ZTFoW']=_0x547fc1[_0x3c451e(0x1ab,0x15b,0x15f,0x15f)],_0x5321ab[_0x45d0d3(0x276,0x292,0x32b,0x2f4)]=_0x547fc1[_0x45d0d3(0x316,0x3ac,0x3c9,0x39e)],_0x5321ab[_0x45d0d3(0x419,0x478,0x471,0x4a3)]=_0x547fc1[_0x3c451e(0x299,0x2c1,0x264,0x29f)],_0x5321ab[_0x45d0d3(0x353,0x3e7,0x3ac,0x360)]=_0x547fc1['ESakH'],_0x5321ab[_0x45d0d3(0x35a,0x3e1,0x329,0x30e)]=_0x547fc1[_0x3c451e(0x13b,0x252,0x1a3,0x24d)],_0x5321ab[_0x3c451e(0xe3,0x1ba,0x19a,0xe6)]=_0x547fc1[_0x45d0d3(0x4c8,0x4aa,0x43b,0x449)],_0x5321ab[_0x3c451e(0x25d,0x1d5,0x1d9,0x221)]=_0x547fc1['iFkug'];const _0x2fad4f=_0x5321ab;if(_0x547fc1[_0x3c451e(0xd0,0x1fd,0x173,0xe4)](_0x9867a7['id'],_0x5e4882))return;function _0x3c451e(_0x2c2b1e,_0x3a2146,_0x5b4856,_0x472ef1){return _0x4f6694(_0x5b4856-0x1a,_0x3a2146-0x199,_0x5b4856-0x116,_0x2c2b1e);}_0x547fc1['aAnJk'](_0x51b649);if(_0x9867a7[_0x3c451e(0x104,0xc2,0x16f,0xfc)])_0x547fc1[_0x3c451e(0x212,0x300,0x28f,0x344)](_0x330549,_0x9867a7['result']);else{if(_0x547fc1[_0x3c451e(0x187,0x12f,0x1a7,0x206)]===_0x547fc1[_0x45d0d3(0x3d7,0x444,0x429,0x4a9)]){const _0x46b5cb=[_0x2fad4f[_0x45d0d3(0x509,0x3b2,0x466,0x460)],'nameEN','facialFeat'+_0x3c451e(0xf0,0x1be,0x13b,0xff),_0x2fad4f['EJyAL'],_0x2fad4f[_0x45d0d3(0x468,0x3f0,0x479,0x4e7)],_0x2fad4f[_0x3c451e(0x1b3,0x1d4,0x24b,0x2c3)],_0x2fad4f['uDHSv'],_0x2fad4f[_0x45d0d3(0x444,0x412,0x471,0x3c0)],_0x2fad4f[_0x3c451e(0x296,0x12c,0x1de,0x199)],_0x2fad4f['LaKbM'],_0x2fad4f[_0x3c451e(0xd7,0x1af,0x19a,0x1bf)],_0x2fad4f[_0x3c451e(0x282,0x264,0x1d9,0x222)]];_0x46b5cb[_0x45d0d3(0x3b1,0x37d,0x366,0x366)](_0x3cda46=>{function _0x40a90a(_0x4e0209,_0x436ff6,_0x5b81de,_0x28e84d){return _0x3c451e(_0x4e0209,_0x436ff6-0xa8,_0x436ff6- -0x139,_0x28e84d-0x1a9);}function _0x7b3567(_0x236be8,_0x1ad0ff,_0x2253ac,_0x50512c){return _0x3c451e(_0x236be8,_0x1ad0ff-0xf1,_0x1ad0ff- -0xfb,_0x50512c-0x102);}if(_0xb9dd87[_0x3cda46]){const _0x1f0ee9=_0x3e0564[_0x40a90a(0x51,0xfa,0x185,0x142)+_0x40a90a(-0x71,-0xe,-0x50,0x54)](_0x7b3567(0xdd,0x115,0xcd,0xf6)+_0x3cda46);_0x1f0ee9&&(_0x1f0ee9['value']=_0x3f40ae[_0x3cda46],_0x572e56(_0x1f0ee9)['trigger'](_0x2fad4f[_0x7b3567(0x117,0x98,0x128,0x82)]));}});}else _0x547fc1[_0x3c451e(0x1d5,0x340,0x28f,0x236)](_0x1f0ee3,new Error(_0x9867a7['result']||_0x45d0d3(0x40e,0x451,0x3bc,0x3e2)));}};eventSource['on'](eventNames['LLM_CHAR_M'+'ODIFY_RESP'+_0x4f6694(0x1f3,0x199,0x149,0x2a7)],_0x4b8210);const _0x40c25d={};_0x40c25d['prompt']=_0x5f35e5;function _0x2571f8(_0x402754,_0x34bdef,_0xa1d047,_0x3b9d38){return _0x1dc75b(_0x402754-0xda,_0x34bdef,_0x402754-0x309,_0x3b9d38-0x36);}_0x40c25d['id']=_0x5e4882,eventSource[_0x4f6694(0x265,0x2b1,0x1a0,0x1f1)](eventNames[_0x4f6694(0x24e,0x2db,0x217,0x261)+_0x2571f8(0x2e2,0x387,0x297,0x3a7)+_0x4f6694(0x1cc,0x1d3,0x20d,0x267)],_0x40c25d),_0x515ed2=_0x58da2a[_0x4f6694(0x12a,0xf4,0x133,0x1bb)](setTimeout,()=>{const _0x18be5b={};_0x18be5b[_0x194229(0x372,0x36f,0x308,0x2ef)]=_0x58da2a[_0x33a33f(0x4b8,0x4c3,0x503,0x4ae)];function _0x194229(_0x4ca036,_0x53248d,_0x4cae44,_0x5230b9){return _0x4f6694(_0x4ca036-0x178,_0x53248d-0x106,_0x4cae44-0x24,_0x5230b9);}const _0x1adc85=_0x18be5b;function _0x33a33f(_0xf90f75,_0x59f94e,_0x5b0f8d,_0x15f8a5){return _0x4f6694(_0x5b0f8d-0x29d,_0x59f94e-0x1e3,_0x5b0f8d-0x1b9,_0x15f8a5);}if(_0x194229(0x31c,0x25d,0x2a8,0x354)===_0x58da2a['CwiKo'])_0x51b649(),_0x58da2a['hCLUT'](_0x1f0ee3,new Error(_0x58da2a[_0x33a33f(0x4d9,0x4f9,0x467,0x3bf)]));else{if(_0x206a27[_0x48c480]){const _0x12afc5=_0x4849c8['getElement'+_0x33a33f(0x3d4,0x40e,0x3ae,0x36e)](_0x33a33f(0x3ef,0x4a5,0x493,0x527)+_0xea1955);_0x12afc5&&(_0x12afc5[_0x194229(0x308,0x365,0x309,0x2b9)]=_0x4d7ae8[_0x20a949],_0xcf9dc1(_0x12afc5)[_0x33a33f(0x5bd,0x43b,0x4f8,0x59c)](_0x1adc85[_0x33a33f(0x4ca,0x4a3,0x497,0x4d2)]));}}},_0x47a120);});}function preprocessTagContent(_0x5f4369){const _0x48661d={};_0x48661d['UbaiZ']=_0x47fda9(0x3d5,0x3cf,0x31e,0x33b);function _0x49c18d(_0x58ab75,_0x56a5e8,_0x898deb,_0x4696a9){return _0x3f8706(_0x58ab75-0x17d,_0x58ab75-0x3d0,_0x898deb-0x4b,_0x56a5e8);}function _0x47fda9(_0x3fe6d8,_0x2ed440,_0x511a4d,_0x3b7056){return _0x3f8706(_0x3fe6d8-0xf,_0x2ed440-0x3a8,_0x511a4d-0xc8,_0x3b7056);}_0x48661d['WqJsx']=_0x47fda9(0x2a8,0x30d,0x2df,0x265);const _0x135c42=_0x48661d;let _0x485eb6=_0x5f4369[_0x49c18d(0x3c3,0x34f,0x458,0x447)](/:/g,':')['replace'](/\(/g,'（')['replace'](/\)/g,'）')[_0x49c18d(0x3c3,0x3f1,0x329,0x422)](/,/g,',');return _0x485eb6=_0x485eb6['replace'](/下半身NSWebcam:/g,_0x135c42['UbaiZ']),_0x485eb6=_0x485eb6[_0x47fda9(0x327,0x39b,0x356,0x316)](/下半身NSFW_背面:/g,_0x47fda9(0x32e,0x3cf,0x40f,0x379)),_0x485eb6=_0x485eb6[_0x47fda9(0x401,0x39b,0x385,0x312)](/上半身NSFW_背面:/g,_0x135c42[_0x47fda9(0x361,0x426,0x3e9,0x454)]),_0x485eb6;}function parseCharacterData(_0x38dd18){const _0x4c0f46={};_0x4c0f46[_0x35ccb5(0x443,0x4d7,0x4b4,0x484)]=_0x35ccb5(0x3e1,0x4ac,0x3d2,0x444),_0x4c0f46[_0xd70f34(0x588,0x606,0x5eb,0x60e)]=_0x35ccb5(0x4c2,0x3cb,0x369,0x412),_0x4c0f46[_0x35ccb5(0x5cd,0x545,0x593,0x534)]=_0xd70f34(0x55c,0x5d1,0x50c,0x5a1)+_0xd70f34(0x46f,0x3f7,0x4a5,0x456),_0x4c0f46[_0x35ccb5(0x48d,0x49a,0x56b,0x4e7)]=_0xd70f34(0x475,0x5c7,0x50c,0x58e)+_0xd70f34(0x589,0x51d,0x4f4,0x48d),_0x4c0f46['QLWGj']=_0x35ccb5(0x3ca,0x3cd,0x4af,0x418)+'FW',_0x4c0f46[_0xd70f34(0x5c3,0x53a,0x591,0x5db)]=_0x35ccb5(0x3a3,0x413,0x49d,0x418)+_0x35ccb5(0x4e8,0x4b6,0x536,0x47b),_0x4c0f46[_0xd70f34(0x4d2,0x4c5,0x4d8,0x477)]='fullBodySF'+'W',_0x4c0f46[_0x35ccb5(0x3d8,0x448,0x3c9,0x44b)]='fullBodyNS'+_0x35ccb5(0x3c6,0x476,0x3d6,0x47b);function _0xd70f34(_0x313f11,_0xa98562,_0x214f1d,_0x5473c9){return _0x3f8706(_0x313f11-0x8b,_0x214f1d-0x545,_0x214f1d-0xfb,_0x5473c9);}_0x4c0f46[_0xd70f34(0x53e,0x585,0x549,0x538)]=function(_0x523fb8,_0x203e24){return _0x523fb8===_0x203e24;},_0x4c0f46[_0xd70f34(0x613,0x591,0x587,0x5a5)]=function(_0x2d4525,_0x456583){return _0x2d4525!==_0x456583;},_0x4c0f46[_0x35ccb5(0x446,0x416,0x395,0x3df)]=_0xd70f34(0x546,0x4df,0x57d,0x54e),_0x4c0f46[_0xd70f34(0x54e,0x4e7,0x509,0x47c)]=_0x35ccb5(0x527,0x3b4,0x426,0x472),_0x4c0f46['KIBVj']=function(_0x24a84e,_0xd724b3){return _0x24a84e&&_0xd724b3;},_0x4c0f46['lMelL']=_0xd70f34(0x5f5,0x626,0x5b2,0x55a),_0x4c0f46['dUsJU']=_0xd70f34(0x554,0x5cf,0x5f1,0x6a4),_0x4c0f46['OygMz']='[character'+_0xd70f34(0x54e,0x612,0x570,0x618)+_0xd70f34(0x59b,0x671,0x5dd,0x62d)+_0x35ccb5(0x3ea,0x425,0x489,0x4a6);const _0x435459=_0x4c0f46,_0x3b84f6=_0x38dd18['split']('\x0a')[_0xd70f34(0x579,0x540,0x507,0x5c0)](_0x1e39b4=>_0x1e39b4[_0xd70f34(0x5df,0x546,0x58d,0x50d)]())[_0xd70f34(0x5f2,0x5a3,0x5c1,0x5f8)](_0xf1ef11=>_0xf1ef11),_0x381200={};_0x381200[_0xd70f34(0x4c4,0x528,0x4cc,0x492)]='',_0x381200[_0x35ccb5(0x35c,0x45b,0x477,0x41d)]='',_0x381200[_0x35ccb5(0x475,0x415,0x493,0x452)+_0xd70f34(0x4e2,0x533,0x4a5,0x4fd)]='',_0x381200['facialFeat'+_0x35ccb5(0x3e4,0x453,0x448,0x43a)]='',_0x381200[_0xd70f34(0x4e7,0x4e4,0x4d2,0x4a6)+'FW']='',_0x381200['upperBodyS'+'FWBack']='',_0x381200['fullBodySF'+'W']='',_0x381200[_0xd70f34(0x532,0x50e,0x517,0x474)+_0x35ccb5(0x515,0x5b3,0x51c,0x511)]='',_0x381200[_0xd70f34(0x5b6,0x4f6,0x5a2,0x650)+_0x35ccb5(0x375,0x3ca,0x43b,0x3da)]='',_0x381200[_0x35ccb5(0x51b,0x518,0x52e,0x4e8)+_0xd70f34(0x599,0x4d8,0x595,0x55d)]='',_0x381200[_0x35ccb5(0x561,0x516,0x461,0x4d9)+'FW']='',_0x381200[_0x35ccb5(0x48c,0x4eb,0x4e2,0x4d9)+'FWBack']='';const _0x5d9da5=_0x381200,_0x5d727d={};_0x5d727d['中文名称']=_0x435459[_0xd70f34(0x642,0x63b,0x5eb,0x5ac)],_0x5d727d[_0x35ccb5(0x514,0x55c,0x492,0x4e0)]='nameEN',_0x5d727d[_0x35ccb5(0x3fd,0x4f5,0x4ff,0x445)]=_0x435459[_0x35ccb5(0x484,0x527,0x50c,0x534)],_0x5d727d['五官外貌背面']=_0x435459['IuVId'],_0x5d727d[_0x35ccb5(0x43c,0x394,0x4be,0x404)]=_0x435459[_0xd70f34(0x47f,0x467,0x4f1,0x560)],_0x5d727d[_0xd70f34(0x580,0x59d,0x53f,0x485)]=_0x435459[_0xd70f34(0x638,0x4e8,0x591,0x5e3)],_0x5d727d['下半身SFW']=_0x435459[_0xd70f34(0x43e,0x44d,0x4d8,0x512)],_0x5d727d[_0x35ccb5(0x4eb,0x500,0x4ed,0x513)]=_0xd70f34(0x589,0x4a3,0x517,0x535)+_0xd70f34(0x5f5,0x51c,0x5cb,0x5cd),_0x5d727d[_0x35ccb5(0x3ad,0x3a9,0x404,0x3fc)]=_0xd70f34(0x4ff,0x5bd,0x5a2,0x611)+_0xd70f34(0x501,0x4e4,0x494,0x507),_0x5d727d[_0xd70f34(0x5f1,0x55d,0x580,0x54d)]=_0xd70f34(0x4fd,0x5af,0x5a2,0x632)+'SFWBack',_0x5d727d[_0xd70f34(0x5ed,0x5cf,0x608,0x68b)]='fullBodyNS'+'FW',_0x5d727d[_0xd70f34(0x432,0x4b1,0x4e3,0x531)]=_0x435459['CLDpN'];function _0x35ccb5(_0x5c2ba3,_0x3f453b,_0x1c674a,_0x30e182){return _0x3f8706(_0x5c2ba3-0x2,_0x30e182-0x48b,_0x1c674a-0x19c,_0x5c2ba3);}const _0xc1b698=_0x5d727d;for(const _0x564606 of _0x3b84f6){const _0x2fbe4b=_0x564606['indexOf'](':');if(_0x435459['RZIWG'](_0x2fbe4b,-(0x4*-0x782+0x3*0x6ab+-0xa08*-0x1)))continue;const _0xb9f33e=_0x564606[_0x35ccb5(0x548,0x4aa,0x4d5,0x54a)](-0xba5*-0x1+-0x1a66+0xec1,_0x2fbe4b)[_0xd70f34(0x597,0x4ea,0x58d,0x4f5)](),_0x124c92=_0x564606[_0xd70f34(0x65d,0x69d,0x604,0x607)](_0x2fbe4b+(0x21*-0x86+-0xfbc*0x1+0x2103))['trim']();if(_0xc1b698[_0xb9f33e]){if(_0x435459['ohAlN'](_0x435459[_0xd70f34(0x481,0x488,0x499,0x553)],_0x435459[_0x35ccb5(0x42c,0x502,0x406,0x44f)]))_0x5d9da5[_0xc1b698[_0xb9f33e]]=_0x124c92;else{_0x55f0ac[_0xd70f34(0x5a2,0x565,0x5e2,0x5b5)](_0x435459[_0x35ccb5(0x41c,0x4ac,0x4bc,0x484)]);return;}}else{if(_0x435459['KIBVj'](_0xb9f33e,_0x124c92)){if(_0x435459[_0xd70f34(0x492,0x4c2,0x549,0x518)]('eGgQI',_0x435459['lMelL']))return null;else console[_0x35ccb5(0x3c9,0x484,0x420,0x44e)](_0xd70f34(0x602,0x69a,0x5f8,0x67b)+_0xd70f34(0x5bc,0x55d,0x570,0x634)+_0xd70f34(0x544,0x552,0x58f,0x610)+_0x35ccb5(0x4f4,0x4c6,0x5a3,0x510)+_0xb9f33e+'\x22');}}}if(!_0x5d9da5['nameCN']){if(_0x435459[_0x35ccb5(0x546,0x4c6,0x43e,0x48f)](_0x435459[_0x35ccb5(0x3b0,0x495,0x333,0x3e7)],_0x35ccb5(0x49d,0x5b3,0x547,0x537)))return null;else _0x5e0696[_0x4d6b38]&&(_0x1563ee[_0x4784ed]=_0x5a6243[_0x410228]);}return console['log'](_0x435459['OygMz'],_0x5d9da5),_0x5d9da5;}function extractCharacterTags(_0x4d5121){const _0x41e03a={'CpJxt':_0x5a914a(0x511,0x546,0x4de,0x519),'dqskH':_0x5a914a(0x425,0x3b2,0x41c,0x41c),'zdQlQ':function(_0x254798,_0x3d2e01){return _0x254798!==_0x3d2e01;},'pmHHY':'rZhWg','tKiaR':function(_0x106bcd,_0x491afd){return _0x106bcd(_0x491afd);}},_0x5daa6a={};_0x5daa6a[_0x5a914a(0x416,0x37a,0x438,0x41f)]=[];function _0x5a914a(_0x189111,_0x4481ba,_0x3a2ca3,_0x186725){return _0x3f8706(_0x189111-0x196,_0x3a2ca3-0x4b7,_0x3a2ca3-0xaa,_0x189111);}const _0x4cd805=_0x5daa6a;_0x4d5121=_0x4d5121[_0x5a914a(0x414,0x526,0x4aa,0x4c3)](/<thinking>[\s\S]*?<\/thinking>/gi,'')[_0xc82a2a(-0xad,-0x68,-0x44,0x22)]();const _0xae3be5=/<人物>([\s\S]*?)<\/人物>/g;let _0x57772d;function _0xc82a2a(_0x1c5855,_0x4aac0d,_0xed2507,_0x2eb7e5){return _0x3f8706(_0x1c5855-0x193,_0x4aac0d- -0xb0,_0xed2507-0x1ba,_0x2eb7e5);}while(_0x41e03a[_0xc82a2a(-0x1b1,-0x116,-0x12b,-0xa0)](_0x57772d=_0xae3be5['exec'](_0x4d5121),null)){if(_0x41e03a[_0xc82a2a(-0x4d,-0xfc,-0x42,-0xec)]===_0xc82a2a(-0xd3,-0xa3,-0x115,-0x31)){let _0x1f859a=_0x1088de['replace'](/:/g,':')[_0xc82a2a(-0x24,-0xbd,-0x5d,-0x164)](/\(/g,'（')[_0xc82a2a(-0x7c,-0xbd,-0x96,-0x154)](/\)/g,'）')['replace'](/,/g,',');return _0x1f859a=_0x1f859a['replace'](/下半身NSWebcam:/g,_0x5a914a(0x46c,0x4df,0x4de,0x526)),_0x1f859a=_0x1f859a[_0x5a914a(0x4b4,0x556,0x4aa,0x4cf)](/下半身NSFW_背面:/g,_0x41e03a[_0xc82a2a(0x78,0xc,0x9d,0x9f)]),_0x1f859a=_0x1f859a['replace'](/上半身NSFW_背面:/g,_0x41e03a['dqskH']),_0x1f859a;}else{const _0x12b6ba=_0x41e03a[_0x5a914a(0x59d,0x562,0x525,0x5b7)](preprocessTagContent,_0x57772d[-0x275+0x76+0x200]),_0x94a23=parseCharacterData(_0x12b6ba);_0x94a23&&_0x4cd805['characters'][_0x5a914a(0x4d9,0x4ed,0x43a,0x3fb)](_0x94a23);}}return _0x4cd805;}function _0x2409(_0x37d6bf,_0x1aa3d3){_0x37d6bf=_0x37d6bf-(-0x1*0x1261+-0x26*0xae+0x2d12);const _0x5a6d27=_0x1e92();let _0x254ac7=_0x5a6d27[_0x37d6bf];if(_0x2409['bUauYc']===undefined){var _0x197376=function(_0x5aae3e){const _0xff2d35='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x4d2e64='',_0x36ef67='',_0x332230=_0x4d2e64+_0x197376;for(let _0x515087=0x3e5*0x1+-0x5b0+0x1cb,_0x1334c2,_0xcf0cc1,_0x345133=0x190*0x13+-0x286+-0x1b2a;_0xcf0cc1=_0x5aae3e['charAt'](_0x345133++);~_0xcf0cc1&&(_0x1334c2=_0x515087%(0x17a8+0x1*-0x3f9+-0x13ab)?_0x1334c2*(-0x47d*0x1+-0x216*0x11+0x2833*0x1)+_0xcf0cc1:_0xcf0cc1,_0x515087++%(0x1dda+0x23b4+-0x418a))?_0x4d2e64+=_0x332230['charCodeAt'](_0x345133+(0x10*-0xe3+0xbe8+0x129*0x2))-(-0x1ead+0x19c*0x7+0x1373*0x1)!==0x22*-0x2+-0x230c+0xa*0x388?String['fromCharCode'](0x9e3*-0x1+0x765+-0x37d*-0x1&_0x1334c2>>(-(0x1bde+-0xf*-0xc1+-0x10f*0x25)*_0x515087&-0x88b*0x2+-0x1618+-0x4*-0x9cd)):_0x515087:0x20c2+0x104c*-0x1+-0x1076){_0xcf0cc1=_0xff2d35['indexOf'](_0xcf0cc1);}for(let _0x280477=0x81*-0x25+-0x4f*0x19+0x4*0x697,_0x384386=_0x4d2e64['length'];_0x280477<_0x384386;_0x280477++){_0x36ef67+='%'+('00'+_0x4d2e64['charCodeAt'](_0x280477)['toString'](0x4c+-0x223*0xd+0x281*0xb))['slice'](-(-0x2*-0x23d+-0xa*-0x3c8+0x16*-0x1ec));}return decodeURIComponent(_0x36ef67);};_0x2409['PXnHBe']=_0x197376,_0x2409['Dtfphk']={},_0x2409['bUauYc']=!![];}const _0x5b46d6=_0x5a6d27[-0x53*-0x74+-0x14c+-0x2450],_0x274e17=_0x37d6bf+_0x5b46d6,_0x348de0=_0x2409['Dtfphk'][_0x274e17];if(!_0x348de0){const _0x324ec6=function(_0x53d228){this['goPFnY']=_0x53d228,this['YgmQuK']=[0xa10+-0x1daa+0x139b,0x240c+-0x5f*-0x26+0x106*-0x31,0x11*-0x220+-0x1693*-0x1+-0xd8d*-0x1],this['eMshfy']=function(){return'newState';},this['HYeFHA']='\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*',this['zqQvWX']='[\x27|\x22].+[\x27|\x22];?\x20*}';};_0x324ec6['prototype']['EmsEXG']=function(){const _0x36aef5=new RegExp(this['HYeFHA']+this['zqQvWX']),_0x339344=_0x36aef5['test'](this['eMshfy']['toString']())?--this['YgmQuK'][-0x88c*-0x1+-0xf65+0x6da]:--this['YgmQuK'][-0x1*0x2a9+-0x47*-0x53+-0x145c];return this['bcjSRq'](_0x339344);},_0x324ec6['prototype']['bcjSRq']=function(_0x445b50){if(!Boolean(~_0x445b50))return _0x445b50;return this['iaqaAl'](this['goPFnY']);},_0x324ec6['prototype']['iaqaAl']=function(_0x5bc77d){for(let _0x44232f=0x190a+0xbd9+-0x545*0x7,_0x3ca176=this['YgmQuK']['length'];_0x44232f<_0x3ca176;_0x44232f++){this['YgmQuK']['push'](Math['round'](Math['random']())),_0x3ca176=this['YgmQuK']['length'];}return _0x5bc77d(this['YgmQuK'][0x1d8d+-0x25ba+0x82d]);},new _0x324ec6(_0x2409)['EmsEXG'](),_0x254ac7=_0x2409['PXnHBe'](_0x254ac7),_0x2409['Dtfphk'][_0x274e17]=_0x254ac7;}else _0x254ac7=_0x348de0;return _0x254ac7;}function getCurrentCharacterPreset(){const _0x59e9a0={};_0x59e9a0[_0x2ad90c(0x1ce,0x1bb,0x180,0x245)]=_0x2ad90c(0x261,0x1b9,0x217,0x205),_0x59e9a0[_0x2ad90c(0xea,0x82,0x1ad,0x30)]=function(_0x21caf1,_0x4138d4){return _0x21caf1!==_0x4138d4;};function _0x12e21b(_0x10ac1d,_0x226150,_0x5870a3,_0x499e75){return _0x3f8706(_0x10ac1d-0x57,_0x226150-0x3b9,_0x5870a3-0x12c,_0x10ac1d);}function _0x2ad90c(_0x5b4aa3,_0x41cb28,_0x2bd780,_0x47c44f){return _0x3f8706(_0x5b4aa3-0x14d,_0x5b4aa3-0x18f,_0x2bd780-0x1e4,_0x47c44f);}_0x59e9a0[_0x12e21b(0x3ed,0x349,0x36f,0x3c1)]=_0x12e21b(0x3d1,0x3ad,0x45d,0x3fb);const _0x64a964=_0x59e9a0,_0x387794=extension_settings[extensionName],_0x4d66d7=_0x387794[_0x12e21b(0x384,0x362,0x35b,0x3f7)+_0x2ad90c(0x11e,0x1de,0x1b6,0x159)];if(!_0x4d66d7||!_0x387794[_0x2ad90c(0x138,0x177,0x141,0x144)+'resets'][_0x4d66d7]){if(_0x64a964['tGrUq'](_0x64a964[_0x12e21b(0x3ac,0x349,0x34d,0x2e5)],_0x64a964['EjHOB'])){_0xc3b081[_0x12e21b(0x3b0,0x3b5,0x354,0x326)](_0x64a964[_0x2ad90c(0x1ce,0x19e,0x1a0,0x1a8)]);return;}else return null;}const _0xc702ad={};return _0xc702ad['id']=_0x4d66d7,_0xc702ad[_0x2ad90c(0x1a8,0x175,0xf1,0x181)]=_0x387794['characterP'+_0x2ad90c(0x1a6,0x25c,0x199,0x17f)][_0x4d66d7],_0xc702ad;}function buildCharacterText(_0x1646ae){const _0x21b2ca={};_0x21b2ca['yPmjN']=_0xe96b9f(0x331,0x41e,0x369,0x3a9),_0x21b2ca[_0x45b402(-0x2cf,-0x251,-0x233,-0x1a4)]=_0xe96b9f(0x2d2,0x331,0x2cd,0x316);const _0x4d7573=_0x21b2ca,_0x476691=_0x1646ae[_0x45b402(-0xad,-0x10f,-0x16f,-0x158)];let _0x37ac60=_0x4d7573[_0xe96b9f(0x36a,0x2d8,0x394,0x41b)];_0x37ac60+=_0xe96b9f(0x237,0x1b2,0x265,0x252)+(_0x476691[_0xe96b9f(0x2df,0x2c4,0x262,0x327)]||'')+'\x0a',_0x37ac60+='英文名称:\x20'+(_0x476691[_0x45b402(-0x14b,-0x145,-0x1f6,-0x226)]||'')+'\x0a',_0x37ac60+=_0x45b402(-0x172,-0x257,-0x19d,-0x1e4)+(_0x476691[_0xe96b9f(0x250,0x333,0x2a2,0x338)+_0xe96b9f(0x21c,0x239,0x23b,0x1b6)]||'')+'\x0a';function _0x45b402(_0x3aa4c5,_0x10dbfa,_0x31fc04,_0xe359e5){return _0x3f8706(_0x3aa4c5-0x1d6,_0x31fc04- -0x188,_0x31fc04-0xf4,_0x3aa4c5);}_0x37ac60+=_0x45b402(-0x67,-0x73,-0xf2,-0x2e)+(_0x476691[_0xe96b9f(0x283,0x2ec,0x2a2,0x355)+'uresBack']||'')+'\x0a',_0x37ac60+=_0x45b402(-0x122,-0xe8,-0x190,-0x1b5)+(_0x476691['upperBodyS'+'FW']||'')+'\x0a',_0x37ac60+='上半身SFW背面:\x20'+(_0x476691['upperBodyS'+_0x45b402(-0x204,-0x23b,-0x198,-0x24c)]||'')+'\x0a',_0x37ac60+=_0x45b402(-0x43,-0x184,-0xc7,-0x142)+(_0x476691['fullBodySF'+'W']||'')+'\x0a',_0x37ac60+=_0x45b402(-0x152,-0x1f1,-0x12e,-0x88)+(_0x476691[_0xe96b9f(0x2a6,0x2a6,0x2ad,0x2d0)+'WBack']||'')+'\x0a',_0x37ac60+='上半身NSFW:\x20'+(_0x476691[_0x45b402(-0x1ed,-0x150,-0x12b,-0xa5)+'SFW']||'')+'\x0a';function _0xe96b9f(_0x2b7d7a,_0x38e063,_0x47f01d,_0x1cffb0){return _0x3f8706(_0x2b7d7a-0xd,_0x47f01d-0x2db,_0x47f01d-0x15,_0x1cffb0);}return _0x37ac60+=_0xe96b9f(0x285,0x1dc,0x240,0x2f6)+'\x20'+(_0x476691[_0xe96b9f(0x3d3,0x321,0x338,0x3a6)+_0xe96b9f(0x3a7,0x300,0x32b,0x295)]||'')+'\x0a',_0x37ac60+=_0x45b402(-0x1bd,-0x249,-0x1c2,-0x1fc)+(_0x476691[_0xe96b9f(0x2f3,0x318,0x329,0x3ca)+'FW']||'')+'\x0a',_0x37ac60+=_0x45b402(-0x174,-0xa9,-0x161,-0x215)+'\x20'+(_0x476691[_0xe96b9f(0x306,0x310,0x329,0x36a)+_0xe96b9f(0x312,0x252,0x2cb,0x2ec)]||'')+'\x0a',_0x37ac60+=_0x4d7573[_0x45b402(-0x22e,-0x291,-0x233,-0x20c)],_0x37ac60;}export async function handleCharacterPromptModify(_0x31cdf0,_0x25e2ee=[]){const _0xc63658={'Cfmbf':'input','wyWkm':function(_0x1f702a,_0x5e76b1){return _0x1f702a===_0x5e76b1;},'SfOVy':function(_0x44ee95,_0x56364c){return _0x44ee95(_0x56364c);},'cCHeX':_0x56512a(0x600,0x615,0x636,0x684)+'PromptModi'+'fy]\x20Starti'+_0x1a1331(0x305,0x33f,0x343,0x2c9)+_0x1a1331(0x254,0x344,0x291,0x297)+'modify\x20req'+_0x56512a(0x56c,0x5f7,0x539,0x678),'CZNuS':_0x56512a(0x463,0x4ea,0x506,0x4ea),'knCBw':_0x56512a(0x684,0x5ec,0x64d,0x5d5),'vtlaz':function(_0xf508ac){return _0xf508ac();},'rzJZj':function(_0x150d42){return _0x150d42();},'iFkdo':function(_0x538993,_0x2b96b7){return _0x538993===_0x2b96b7;},'HlHJT':_0x56512a(0x4f9,0x510,0x50e,0x5cf),'ypnyH':'[character'+_0x56512a(0x5c4,0x58d,0x567,0x5a1)+'fy]\x20Saved\x20'+_0x56512a(0x5c1,0x51e,0x50c,0x4f6),'zPMMV':function(_0x2c774d,_0x35ef7c){return _0x2c774d||_0x35ef7c;},'EuidQ':'aKBMj','iCooO':_0x1a1331(0x33f,0x425,0x36b,0x414),'opruF':'[character'+_0x56512a(0x581,0x58d,0x602,0x631)+_0x56512a(0x480,0x4f9,0x4c9,0x58f)+_0x56512a(0x542,0x53a,0x5aa,0x5cf)+_0x56512a(0x558,0x60f,0x5b7,0x662),'pIqAA':'char_modif'+'y','AttsR':function(_0x307277,_0x3835ae){return _0x307277(_0x3835ae);},'GAnPj':function(_0x49c607){return _0x49c607();},'dESRd':_0x56512a(0x62c,0x615,0x60d,0x655)+_0x56512a(0x649,0x58d,0x614,0x5bf)+_0x56512a(0x443,0x4f9,0x49e,0x4ca)+_0x1a1331(0x325,0x364,0x2bc,0x2e4)+_0x1a1331(0x1cb,0x2d0,0x28c,0x273)+_0x56512a(0x669,0x602,0x5f6,0x549),'vnVSK':function(_0x295012,_0x537ad8){return _0x295012(_0x537ad8);},'hGpOC':_0x56512a(0x6a5,0x615,0x5c7,0x6d9)+_0x1a1331(0x326,0x2d1,0x359,0x348)+_0x56512a(0x617,0x5e6,0x672,0x62a)+'后:','EupuI':'{{用户需求}}','GIRIJ':_0x56512a(0x611,0x615,0x5da,0x6ab)+_0x56512a(0x60f,0x58d,0x64b,0x539)+'fy]\x20User\x20r'+_0x1a1331(0x359,0x382,0x35a,0x2e8)+'\x20message\x20i'+_0x56512a(0x5be,0x52d,0x4ab,0x579),'MfdCY':function(_0x4a7f6b,_0x48002d){return _0x4a7f6b||_0x48002d;},'WcjVb':function(_0x5e5c4a,_0x3fadd9,_0x3e455f){return _0x5e5c4a(_0x3fadd9,_0x3e455f);},'LlHub':function(_0x5a0e91,_0x1d8691,_0x3c3cd0,_0x40ecc6,_0x4336c5){return _0x5a0e91(_0x1d8691,_0x3c3cd0,_0x40ecc6,_0x4336c5);},'RKllc':function(_0x46e896,_0x4c4db5){return _0x46e896>_0x4c4db5;},'LVwGG':function(_0x57a981,_0x53f752){return _0x57a981>=_0x53f752;},'ZDjEu':function(_0x1c4203,_0x5b4b4b){return _0x1c4203!==_0x5b4b4b;},'bzkWG':'pvMXs','jSUFr':function(_0x1f1783,_0x44f6f5,_0x1c7417,_0x11e43f,_0x13ded8){return _0x1f1783(_0x44f6f5,_0x1c7417,_0x11e43f,_0x13ded8);},'IVEFd':_0x56512a(0x60c,0x5b5,0x676,0x662),'PCesE':'[character'+_0x1a1331(0x38e,0x3e1,0x359,0x2de)+_0x56512a(0x5ad,0x5dc,0x5f3,0x5e3)+'ed','nYuBS':'images\x20to\x20'+'message\x20at'+'\x20index','ZHapK':'[character'+_0x1a1331(0x3c4,0x3de,0x359,0x339)+_0x1a1331(0x2a1,0x2a5,0x2b7,0x20e)+'tput:','UeTbc':_0x56512a(0x494,0x530,0x4bf,0x58d),'jRsns':function(_0x8fd9ab,_0x451dba){return _0x8fd9ab(_0x451dba);},'CpeqU':function(_0x1f2d76,_0x322d4b){return _0x1f2d76===_0x322d4b;},'XPbsl':_0x56512a(0x5fb,0x5df,0x5fe,0x55a),'wzwoI':_0x56512a(0x5bb,0x5c5,0x5d6,0x609),'CeVXy':'未在\x20LLM\x20输出中'+_0x1a1331(0x36f,0x317,0x340,0x3f5),'mKDXb':'[character'+_0x56512a(0x5e9,0x58d,0x5da,0x4c8)+_0x1a1331(0x371,0x375,0x314,0x3a6)+_0x1a1331(0x298,0x320,0x278,0x2d6)+_0x1a1331(0x3e8,0x43a,0x3cc,0x3a9)+_0x56512a(0x5f3,0x586,0x5ff,0x52c),'DHJJm':_0x1a1331(0x46b,0x35c,0x3e1,0x3b6)+_0x56512a(0x590,0x58d,0x617,0x4e0)+_0x56512a(0x650,0x5b9,0x54c,0x57a)+_0x1a1331(0x3a9,0x3fd,0x387,0x322),'fATQD':function(_0x6ea74e,_0x2259dd,_0x3793f8){return _0x6ea74e(_0x2259dd,_0x3793f8);},'Rppps':_0x1a1331(0x2a0,0x2cd,0x30e,0x2be),'FvqSh':_0x56512a(0x59a,0x615,0x5ca,0x5d0)+_0x56512a(0x5cf,0x58d,0x4d4,0x500)+_0x56512a(0x62b,0x617,0x5dd,0x5bb)};console[_0x1a1331(0x262,0x2a4,0x2f1,0x2e3)](_0xc63658[_0x56512a(0x638,0x5a7,0x597,0x50a)]),toastr[_0x56512a(0x5b6,0x55e,0x5a8,0x5c8)](_0x56512a(0x6cb,0x615,0x581,0x56c)+'PromptModi'+_0x1a1331(0x352,0x36d,0x2e1,0x262)+_0x56512a(0x5c4,0x539,0x509,0x548));function _0x56512a(_0x41c7df,_0x5f2ece,_0x4371ba,_0x115467){return _0x3f8706(_0x41c7df-0x183,_0x5f2ece-0x562,_0x4371ba-0x1c0,_0x41c7df);}function _0x1a1331(_0x3f7ab9,_0x3f5314,_0x3ef9ab,_0x52847c){return _0x3f8706(_0x3f7ab9-0x10a,_0x3ef9ab-0x32e,_0x3ef9ab-0xab,_0x3f7ab9);}try{if(_0xc63658[_0x56512a(0x629,0x581,0x50d,0x55c)]===_0xc63658[_0x1a1331(0x2e3,0x281,0x2a1,0x253)])_0x422ef7[_0x1a1331(0x36a,0x2ba,0x2f1,0x33e)]('[character'+_0x1a1331(0x3bd,0x3b7,0x359,0x38c)+_0x1a1331(0x341,0x431,0x378,0x394)+_0x1a1331(0x45d,0x2f5,0x3b3,0x43b)+_0x1fc024+'\x22');else{const _0xe1e52b=_0xc63658[_0x1a1331(0x20d,0x322,0x2d0,0x390)](getContext),_0x31e687=extension_settings[extensionName],_0x3f6b52=_0xc63658[_0x1a1331(0x3cf,0x3b6,0x3de,0x488)](getCurrentCharacterPreset);if(!_0x3f6b52){if(_0xc63658['iFkdo'](_0xc63658[_0x1a1331(0x415,0x386,0x3f7,0x389)],_0xc63658[_0x1a1331(0x472,0x46d,0x3f7,0x3f0)])){toastr[_0x56512a(0x672,0x5ff,0x5d9,0x624)](_0x56512a(0x60e,0x60c,0x59d,0x617));return;}else _0x53fbf4[_0x1a1331(0x2ae,0x360,0x2fd,0x24c)]=_0x41d6af[_0xe5ce82],_0x3c0aee(_0x577204)[_0x56512a(0x60e,0x5fc,0x6a1,0x595)](_0xc63658[_0x1a1331(0x2d7,0x35b,0x32f,0x397)]);}console[_0x1a1331(0x346,0x391,0x2f1,0x32a)]('[character'+'PromptModi'+_0x56512a(0x51c,0x543,0x52c,0x589)+'t\x20preset:',_0x3f6b52['id']);const _0xfb8b54=_0x3f6b52[_0x1a1331(0x37c,0x2fc,0x347,0x3f9)][_0x1a1331(0x3b8,0x3e9,0x3ba,0x47f)+_0x56512a(0x64e,0x59e,0x4df,0x589)]||'',_0x50965b=_0x3f6b52[_0x1a1331(0x35c,0x291,0x347,0x311)][_0x56512a(0x60f,0x5ee,0x635,0x62f)+_0x1a1331(0x3a2,0x32b,0x334,0x342)]||'',_0xa5b88f=_0x3f6b52[_0x1a1331(0x32e,0x360,0x347,0x406)][_0x56512a(0x616,0x5ee,0x540,0x69a)+_0x1a1331(0x368,0x291,0x34f,0x2db)]||{};console[_0x1a1331(0x259,0x35c,0x2f1,0x2a9)](_0x56512a(0x573,0x615,0x6b5,0x585)+_0x1a1331(0x2fa,0x29d,0x359,0x3c4)+_0x56512a(0x564,0x4cc,0x533,0x415)+'context:',_0xfb8b54),console[_0x1a1331(0x305,0x3af,0x2f1,0x276)](_0x56512a(0x62e,0x615,0x592,0x600)+_0x1a1331(0x40e,0x2f2,0x359,0x296)+_0x56512a(0x52f,0x4cc,0x58a,0x584)+_0x1a1331(0x407,0x31b,0x390,0x2e2)+':',_0x50965b),console['log'](_0xc63658[_0x56512a(0x53e,0x58f,0x63b,0x4fc)],_0xa5b88f);const _0x4d2c67=_0xc63658['zPMMV'](_0x31cdf0,''),_0x455d6e=[];_0x31cdf0&&_0x455d6e[_0x1a1331(0x2ca,0x242,0x2b1,0x266)](_0x31cdf0);if(_0xfb8b54){if(_0xc63658[_0x1a1331(0x38f,0x3db,0x3f4,0x3db)]===_0xc63658[_0x56512a(0x672,0x628,0x585,0x5c7)])_0x455d6e[_0x1a1331(0x1f8,0x234,0x2b1,0x2d8)](_0xfb8b54);else return _0x458ad7[_0x1a1331(0x3a9,0x367,0x2f0,0x2b5)](_0x164da3=>_0x5dd713(_0x164da3,_0x3d9a4e,_0x25a01f,_0x4479c5));}if(_0x50965b){if('yzOuo'!==_0xc63658[_0x1a1331(0x328,0x295,0x32d,0x2c2)])_0x455d6e[_0x56512a(0x4b7,0x4e5,0x4d1,0x468)](_0x50965b);else{if(_0xc63658['wyWkm'](_0xc3f5d2[_0x1a1331(0x310,0x3cb,0x398,0x32b)],_0x1a1331(0x393,0x302,0x2d8,0x261))&&_0x4247d6['text'][_0x56512a(0x54e,0x4dd,0x551,0x581)](_0x54942f))return _0x559af8;}}const _0xf4bc=_0x455d6e['join']('\x0a');console[_0x1a1331(0x238,0x28f,0x2f1,0x2a1)](_0xc63658[_0x56512a(0x550,0x4d2,0x579,0x437)],_0xf4bc);let _0x9d5b45=buildPromptForRequestType(_0xc63658[_0x1a1331(0x3e3,0x3ae,0x399,0x34b)],_0x4d2c67);const _0x49af41=_0xc63658['AttsR'](generateCharacterListText,_0xf4bc),_0x5bfd94=_0xc63658[_0x1a1331(0x2ca,0x371,0x32e,0x343)](generateOutfitEnableListText),_0x2fcbfa=generateCommonCharacterListText();console[_0x1a1331(0x27e,0x2a3,0x2f1,0x2ad)](_0xc63658['dESRd'],_0x49af41);const _0x3fd5ed=_0xe1e52b[_0x1a1331(0x3db,0x394,0x342,0x2e2)+'ta']?.[_0x56512a(0x4f9,0x5af,0x614,0x5e6)]||{},_0x599acc=_0xc63658[_0x56512a(0x5ae,0x5ab,0x5e0,0x602)](buildCharacterText,_0x3f6b52);_0x9d5b45=_0xc63658[_0x1a1331(0x277,0x2a7,0x2fe,0x369)](mergeAdjacentMessages,_0x9d5b45),console[_0x56512a(0x5e8,0x525,0x4cb,0x482)](_0xc63658[_0x1a1331(0x30b,0x2fc,0x36f,0x32d)],_0x9d5b45);const _0x432b35=findMessageIndexWithPlaceholder(_0x9d5b45,_0xc63658['EupuI']);console[_0x1a1331(0x2eb,0x2cb,0x2f1,0x346)](_0xc63658[_0x1a1331(0x3d1,0x46d,0x3b9,0x456)],_0x432b35);const _0x3cb362={..._0xa5b88f,..._0x3fd5ed},_0x41db54={'context':_0xfb8b54,'worldBookContent':_0x50965b,'variables':_0x3cb362,'userDemand':_0xc63658[_0x56512a(0x5b3,0x5e3,0x569,0x62f)](_0x31cdf0,''),'characterListText':_0x49af41,'outfitEnableListText':_0x5bfd94,'commonCharacterListText':_0x2fcbfa},{messages:_0x19b66c,replacedVariables:_0x1f8969}=_0xc63658[_0x56512a(0x5cf,0x613,0x5ea,0x56b)](replaceAllPlaceholders,_0x9d5b45,_0x41db54);_0x9d5b45=_0x19b66c,_0x9d5b45=_0xc63658['LlHub'](_0x5586af,_0x9d5b45,_0x56512a(0x551,0x52f,0x4ae,0x541),_0x599acc,_0x1f8969),console['log'](_0x56512a(0x5d5,0x615,0x5a4,0x6b5)+_0x56512a(0x60f,0x58d,0x621,0x60a)+_0x1a1331(0x413,0x325,0x36e,0x3eb)+_0x56512a(0x62f,0x5c8,0x605,0x5d6),_0x9d5b45);let _0x3395e9='';_0x1f8969[_0x56512a(0x681,0x5d3,0x58b,0x53e)]>-0x1c0e+0x2406+-0x7f8*0x1&&(_0x3395e9=_0x1a1331(0x3c4,0x37f,0x353,0x37d)+_0x56512a(0x591,0x58c,0x507,0x5f2)+[..._0x1f8969][_0x56512a(0x58b,0x4d4,0x4b6,0x426)]('、')+'\x0a');_0x25e2ee&&_0xc63658[_0x56512a(0x567,0x4d6,0x572,0x49f)](_0x25e2ee[_0x1a1331(0x463,0x3f7,0x3e0,0x35f)],-0x155b+0xc13+0x948)&&_0xc63658['LVwGG'](_0x432b35,0x237+0x9*-0x279+-0x13*-0x10e)&&(_0xc63658[_0x56512a(0x513,0x5d7,0x592,0x517)]('pvMXs',_0xc63658[_0x1a1331(0x3d1,0x37b,0x3dd,0x417)])?(_0xc63658['SfOVy'](_0xf96765,_0x2cabc1),_0x507017=null):(_0x9d5b45=_0xc63658[_0x56512a(0x561,0x604,0x562,0x632)](attachImagesToMessage,_0x9d5b45,_0x432b35,_0x25e2ee,_0xc63658[_0x56512a(0x549,0x4b8,0x528,0x418)]),console['log'](_0xc63658[_0x56512a(0x465,0x519,0x584,0x532)],_0x25e2ee['length'],_0xc63658[_0x56512a(0x4e7,0x50f,0x58c,0x4b0)],_0x432b35)));_0xc63658[_0x56512a(0x67b,0x613,0x6a6,0x630)](updateCombinedPrompt,_0x9d5b45,_0x3395e9);const _0x17de5a={};_0x17de5a[_0x56512a(0x5c5,0x5a0,0x64b,0x522)]=0x493e0;const _0x44b1f8=await LLM_CHAR_MODIFY(_0x9d5b45,_0x17de5a);console[_0x1a1331(0x2cf,0x373,0x2f1,0x2c7)](_0xc63658[_0x1a1331(0x356,0x208,0x2b9,0x266)],_0x44b1f8);if(!_0x44b1f8){toastr[_0x56512a(0x662,0x5ff,0x569,0x57b)](_0xc63658['UeTbc']);return;}const _0x1ec9d2=_0xc63658[_0x1a1331(0x394,0x497,0x3e8,0x467)](extractCharacterTags,_0x44b1f8);if(_0xc63658[_0x56512a(0x55f,0x557,0x52d,0x56b)](_0x1ec9d2[_0x1a1331(0x24d,0x357,0x2af,0x287)]['length'],-0x2f9*0xd+-0x1d*-0x9d+-0xc*-0x1bd)){if(_0xc63658[_0x56512a(0x54b,0x517,0x4aa,0x5ab)](_0xc63658[_0x1a1331(0x3db,0x35d,0x3f9,0x3c6)],_0xc63658['wzwoI']))_0x429976&&_0x18ee5b[_0x56512a(0x515,0x4c8,0x458,0x484)](_0x26458c);else{toastr[_0x1a1331(0x383,0x3c3,0x336,0x399)](_0xc63658[_0x56512a(0x44b,0x4e8,0x49f,0x474)]),console[_0x56512a(0x565,0x525,0x5e5,0x588)](_0xc63658[_0x1a1331(0x2c3,0x37d,0x364,0x2e9)]),console[_0x1a1331(0x345,0x3af,0x2f1,0x3ad)](_0x1a1331(0x39e,0x396,0x3e1,0x45b)+'PromptModi'+'fy]\x20Raw\x20LL'+_0x1a1331(0x350,0x371,0x2d2,0x2e0)+_0x1a1331(0x3bc,0x385,0x2f8,0x2c6)+_0x56512a(0x580,0x567,0x52c,0x519),_0x44b1f8);return;}}console['log'](_0xc63658[_0x56512a(0x4c7,0x572,0x51e,0x60f)],_0x1ec9d2);const _0x44139f=_0x1ec9d2['characters'][0x20a3+0xadc+-0x55*0x83];await _0xc63658['fATQD'](updateCharacterPresetFromLLM,_0x3f6b52['id'],_0x44139f),toastr['success'](_0xc63658['Rppps']);}}catch(_0x53ddb7){console[_0x56512a(0x58c,0x5ff,0x690,0x5da)](_0xc63658[_0x56512a(0x577,0x5d6,0x61e,0x5f3)],_0x53ddb7),toastr[_0x1a1331(0x490,0x458,0x3cb,0x335)](_0x56512a(0x55d,0x536,0x56b,0x48a)+'\x20'+_0x53ddb7['message']);}}async function updateCharacterPresetFromLLM(_0x291607,_0x1ccd29){const _0x54b4a0={'QzLzd':_0x3becd3(0x41f,0x420,0x3e2,0x4af),'JEPwg':_0xb4dcc0(0x23f,0x2fa,0x23a,0x189),'SOkIU':'五官外貌背面','Rujzk':_0x3becd3(0x2ff,0x388,0x30d,0x340),'gXuZA':'上半身SFW背面','lNGtB':_0xb4dcc0(0x32c,0x293,0x382,0x312),'oOwYD':'下半身SFW背面','kcCUi':_0xb4dcc0(0x1f6,0x1b8,0x178,0x260),'zwsOf':_0x3becd3(0x509,0x44a,0x467,0x4f7),'fOngr':_0x3becd3(0x2f9,0x3ad,0x3d4,0x3a4),'rGsOv':function(_0x25e456,_0x3b4269){return _0x25e456===_0x3b4269;},'OdhqO':function(_0x369bc9,_0x6716d0){return _0x369bc9!==_0x6716d0;},'VKfix':_0xb4dcc0(0x2b6,0x2c7,0x2e9,0x281),'DbDYl':function(_0x253a4a,_0x2e62e0){return _0x253a4a>_0x2e62e0;},'DLUAD':_0xb4dcc0(0x1e6,0x127,0x28b,0x286),'WdtRN':_0xb4dcc0(0x264,0x30d,0x2a2,0x297)+'内容','DpeXd':function(_0xcaca09,_0x27b15b){return _0xcaca09(_0x27b15b);},'gOUgT':_0x3becd3(0x4bf,0x406,0x3fa,0x493),'gWNVT':function(_0x40e2c2){return _0x40e2c2();},'vAhoS':function(_0x172efe,_0x23ca0e){return _0x172efe(_0x23ca0e);}},_0x1d0956=extension_settings[extensionName],_0x5bfdf6=_0x1d0956[_0xb4dcc0(0x22e,0x2e2,0x196,0x23a)+_0xb4dcc0(0x29c,0x2e6,0x30f,0x33a)][_0x291607];if(!_0x5bfdf6){toastr['error'](_0x3becd3(0x400,0x3c8,0x452,0x441));return;}let _0x39f363=_0xb4dcc0(0x352,0x3d1,0x3cc,0x31e)+_0x291607+'\x22\x20的以下数据:\x0a\x0a';const _0x46be6f={};_0x46be6f[_0x3becd3(0x3af,0x396,0x334,0x360)]=_0x54b4a0['QzLzd'],_0x46be6f['nameEN']='英文名称',_0x46be6f[_0xb4dcc0(0x24c,0x22b,0x302,0x21f)+_0xb4dcc0(0x1e5,0x2a5,0x21f,0x12f)]=_0x54b4a0[_0xb4dcc0(0x2fb,0x374,0x240,0x2c1)],_0x46be6f[_0xb4dcc0(0x24c,0x2bb,0x307,0x273)+_0x3becd3(0x376,0x3be,0x353,0x382)]=_0x54b4a0['SOkIU'],_0x46be6f[_0x3becd3(0x374,0x39c,0x442,0x31b)+'FW']=_0x54b4a0[_0xb4dcc0(0x260,0x296,0x240,0x27a)],_0x46be6f[_0x3becd3(0x3ea,0x39c,0x31a,0x3bf)+_0x3becd3(0x424,0x3ff,0x3c2,0x46d)]=_0x54b4a0[_0xb4dcc0(0x2d9,0x214,0x26f,0x308)],_0x46be6f[_0x3becd3(0x471,0x3e1,0x361,0x37b)+'W']=_0x54b4a0[_0xb4dcc0(0x315,0x387,0x33a,0x33e)],_0x46be6f[_0xb4dcc0(0x257,0x1e9,0x302,0x2ac)+_0x3becd3(0x541,0x495,0x4b8,0x4c5)]=_0x54b4a0[_0xb4dcc0(0x240,0x1a6,0x18a,0x2c4)],_0x46be6f[_0x3becd3(0x454,0x46c,0x3fe,0x502)+'SFW']=_0x54b4a0[_0xb4dcc0(0x32d,0x329,0x366,0x312)],_0x46be6f[_0xb4dcc0(0x2e2,0x298,0x238,0x337)+_0x3becd3(0x44a,0x45f,0x517,0x414)]=_0x54b4a0[_0x3becd3(0x3af,0x3c1,0x409,0x31e)],_0x46be6f[_0xb4dcc0(0x2d3,0x2da,0x250,0x2b1)+'FW']=_0xb4dcc0(0x348,0x293,0x39b,0x298);function _0xb4dcc0(_0x1c8387,_0x2188f8,_0x2f21bf,_0x5b043e){return _0x3f8706(_0x1c8387-0x36,_0x1c8387-0x285,_0x2f21bf-0xde,_0x5b043e);}_0x46be6f[_0x3becd3(0x4a5,0x45d,0x521,0x3b4)+_0x3becd3(0x37a,0x3ff,0x3f4,0x483)]=_0x54b4a0[_0x3becd3(0x504,0x4cf,0x53c,0x43f)];const _0xc90d80=_0x46be6f;let _0xb0c036=0x1*-0x29b+0x914+0x1*-0x679;for(const _0x1a0c11 in _0xc90d80){if(_0x54b4a0['rGsOv'](_0xb4dcc0(0x201,0x1a1,0x1e3,0x220),_0x3becd3(0x369,0x38b,0x400,0x3ef))){if(_0x1ccd29[_0x1a0c11]&&_0x54b4a0[_0xb4dcc0(0x202,0x215,0x1e7,0x1f1)](_0x1ccd29[_0x1a0c11],_0x5bfdf6[_0x1a0c11])){const _0x329b50=_0x5bfdf6[_0x1a0c11]||_0x54b4a0[_0x3becd3(0x3f5,0x474,0x4ce,0x428)],_0x2a7255=_0x1ccd29[_0x1a0c11];_0x39f363+='•\x20'+_0xc90d80[_0x1a0c11]+':\x0a',_0x39f363+=_0xb4dcc0(0x328,0x3d4,0x3ed,0x35d)+_0x329b50[_0x3becd3(0x575,0x4ce,0x413,0x528)](0x24c3+0x137f+-0x3842,0x1ab*0x1+0x7*-0x45a+0x1cfd)+(_0x54b4a0[_0x3becd3(0x413,0x455,0x4c9,0x4dd)](_0x329b50['length'],-0x81c+0xd41+-0x4f3)?_0x54b4a0[_0x3becd3(0x443,0x4c5,0x4c6,0x537)]:'')+'\x0a',_0x39f363+=_0x3becd3(0x2f5,0x386,0x384,0x3a3)+_0x2a7255[_0xb4dcc0(0x344,0x2c6,0x3c2,0x384)](0x24af+-0x223*0x3+-0x5*0x60e,-0x38*0x5a+0x1*0x152e+-0x14c)+(_0x2a7255[_0x3becd3(0x473,0x4c1,0x575,0x4ea)]>-0x8d3*-0x1+0x3c9*-0x9+0x4*0x65c?_0x54b4a0[_0x3becd3(0x418,0x4c5,0x404,0x417)]:'')+'\x0a\x0a',_0xb0c036++;}}else _0x232fbc=_0x3becd3(0x3c3,0x387,0x37b,0x2f5)+_0xb4dcc0(0x2c9,0x20d,0x27c,0x27b)+'4,'+_0x55c610;}if(_0xb0c036===-0x1c4+0x11*-0x1a8+0x1dec){toastr[_0x3becd3(0x440,0x40b,0x3f1,0x431)](_0x54b4a0[_0xb4dcc0(0x246,0x2f2,0x2e7,0x18d)]);return;}_0x39f363+='共\x20'+_0xb0c036+_0xb4dcc0(0x25a,0x2d9,0x204,0x204);const _0x469378=await _0x54b4a0[_0x3becd3(0x38a,0x3ab,0x3ea,0x3fb)](stylishConfirm,_0x39f363);if(!_0x469378){toastr[_0x3becd3(0x399,0x40b,0x48a,0x41a)](_0xb4dcc0(0x357,0x401,0x2e6,0x32b));return;}for(const _0x59ddde in _0xc90d80){_0x54b4a0[_0xb4dcc0(0x22c,0x2c6,0x20b,0x184)](_0x54b4a0[_0x3becd3(0x432,0x3d8,0x480,0x407)],_0xb4dcc0(0x1ce,0x211,0x12a,0x1a3))?_0xe19c5d[_0x3becd3(0x3e6,0x392,0x37c,0x418)](..._0x298793[_0xb4dcc0(0x291,0x2db,0x2ac,0x294)]):_0x1ccd29[_0x59ddde]&&(_0x5bfdf6[_0x59ddde]=_0x1ccd29[_0x59ddde]);}_0x54b4a0[_0xb4dcc0(0x304,0x2d0,0x395,0x288)](saveSettingsDebounced);const _0xcfa1d3=_0x54b4a0[_0xb4dcc0(0x221,0x1cc,0x167,0x254)]($,'#st-chatu8'+_0x3becd3(0x33d,0x3a5,0x408,0x3f7)+_0xb4dcc0(0x224,0x190,0x224,0x161));_0xcfa1d3[_0x3becd3(0x411,0x4c1,0x444,0x505)]&&_0x54b4a0['vAhoS'](refreshCharacterSettings,_0xcfa1d3);_0x54b4a0['DpeXd'](updateFormFields,_0x1ccd29);function _0x3becd3(_0x13f0b4,_0x36db05,_0x15ccd1,_0x1ca2d9){return _0x3f8706(_0x13f0b4-0x10c,_0x36db05-0x40f,_0x15ccd1-0x72,_0x13f0b4);}console[_0xb4dcc0(0x248,0x1a6,0x285,0x234)](_0xb4dcc0(0x338,0x280,0x387,0x2d6)+_0xb4dcc0(0x2b0,0x2cf,0x2ab,0x2e8)+_0x3becd3(0x4b1,0x431,0x45c,0x3e9)+_0x3becd3(0x42c,0x491,0x43c,0x524)+_0x291607+'\x22');}function updateFormFields(_0x8d2a7c){const _0xef8922={'UkGEg':function(_0x2a166c,_0x304c61){return _0x2a166c(_0x304c61);},'ntGlf':function(_0x3841db,_0x518b46){return _0x3841db!==_0x518b46;},'AhHht':_0x29b59f(0x2a7,0x347,0x40c,0x3f5),'rISij':_0x4c1fde(0x39a,0x424,0x394,0x35c),'iefYv':_0x4c1fde(0x4a9,0x4c3,0x428,0x402),'inokb':_0x4c1fde(0x32f,0x421,0x3f2,0x382),'EyyMH':function(_0x502636,_0x34a559){return _0x502636(_0x34a559);},'kCjht':_0x4c1fde(0x3c4,0x3a7,0x44a,0x4ed),'PngTw':_0x4c1fde(0x30f,0x2cd,0x336,0x272),'JLFUm':'nameEN','gJOVx':_0x4c1fde(0x2f5,0x38e,0x376,0x37b)+'ures','mKeXl':'facialFeat'+_0x29b59f(0x3b3,0x2ef,0x23a,0x244),'ZWfZU':_0x29b59f(0x219,0x2cd,0x388,0x214)+'FW','xcuxp':_0x29b59f(0x399,0x312,0x3b6,0x317)+'W','ImnTS':_0x29b59f(0x3c5,0x312,0x331,0x2e8)+_0x29b59f(0x396,0x3c6,0x39f,0x3d2),'hfxQF':_0x29b59f(0x3ac,0x39d,0x38f,0x3e7)+_0x4c1fde(0x29e,0x23a,0x2fe,0x2b0),'chdoH':_0x4c1fde(0x37d,0x3c8,0x3fd,0x430)+'FW','eeEdC':'fullBodyNS'+_0x4c1fde(0x420,0x421,0x39f,0x332)};function _0x4c1fde(_0xa9c26b,_0x2b60d3,_0x995626,_0x536f98){return _0x3f8706(_0xa9c26b-0x34,_0x995626-0x3af,_0x995626-0x75,_0x2b60d3);}function _0x29b59f(_0xf11da5,_0x7c16bd,_0x57d2a5,_0x318abf){return _0x3f8706(_0xf11da5-0x85,_0x7c16bd-0x340,_0x57d2a5-0x132,_0x318abf);}const _0x2342a5=[_0xef8922[_0x4c1fde(0x385,0x358,0x324,0x262)],_0xef8922[_0x4c1fde(0x426,0x38b,0x427,0x380)],_0xef8922['gJOVx'],_0xef8922[_0x4c1fde(0x418,0x421,0x3a0,0x3e7)],_0xef8922[_0x29b59f(0x2d3,0x336,0x3a7,0x2f7)],'upperBodyS'+_0x29b59f(0x311,0x330,0x2ef,0x334),_0xef8922[_0x4c1fde(0x467,0x457,0x3d7,0x499)],_0xef8922[_0x29b59f(0x378,0x407,0x3b4,0x46a)],_0xef8922[_0x29b59f(0x2ab,0x32f,0x272,0x386)],_0x29b59f(0x31a,0x39d,0x393,0x37b)+_0x4c1fde(0x3fc,0x3eb,0x3ff,0x4b7),_0xef8922[_0x4c1fde(0x38d,0x410,0x44b,0x38f)],_0xef8922['eeEdC']];_0x2342a5[_0x4c1fde(0x2ca,0x2e4,0x36c,0x353)](_0xadda60=>{function _0x5574f5(_0x177348,_0x4b2c53,_0x3653af,_0x5449ab){return _0x29b59f(_0x177348-0x53,_0x4b2c53- -0x34,_0x3653af-0x5a,_0x177348);}function _0x391965(_0x3eb643,_0x273aad,_0x2bc924,_0x5e9c72){return _0x29b59f(_0x3eb643-0x118,_0x5e9c72-0x1c1,_0x2bc924-0x1ab,_0x3eb643);}if(_0xef8922['ntGlf'](_0xef8922[_0x5574f5(0x29f,0x258,0x1ab,0x23d)],_0xef8922[_0x5574f5(0x23d,0x258,0x2ca,0x2d9)]))_0x1c53a8[_0x5574f5(0x34d,0x28d,0x291,0x1e3)][_0x5574f5(0x34b,0x28f,0x21c,0x287)](_0x55b970);else{if(_0x8d2a7c[_0xadda60]){if(_0xef8922[_0x5574f5(0x28a,0x25d,0x227,0x21d)](_0x391965(0x4f2,0x546,0x59e,0x4e6),_0xef8922[_0x391965(0x3f7,0x457,0x3e4,0x470)])){if(_0x35a77c['id']!==_0x5ddf86)return;_0x6e4932[_0x391965(0x462,0x4d6,0x3ad,0x458)+_0x391965(0x3ca,0x52b,0x53a,0x477)](_0x5079cc['LLM_CHAR_M'+_0x391965(0x5c0,0x5c7,0x5ee,0x562)+_0x5574f5(0x2af,0x32a,0x3a7,0x3c8)+_0x5574f5(0x1f8,0x291,0x26e,0x2f0)],_0x1ab291),_0xef8922[_0x391965(0x54b,0x5e3,0x5a1,0x5af)](_0x556324,_0x308034['prompt']);}else{const _0x7bbe6b=document[_0x391965(0x58e,0x5e6,0x4f6,0x559)+_0x5574f5(0x2d0,0x25c,0x1fc,0x238)]('char_'+_0xadda60);if(_0x7bbe6b){if(_0xef8922[_0x391965(0x466,0x4bb,0x410,0x4a7)]===_0xef8922[_0x391965(0x5cb,0x5f7,0x49e,0x550)]){const _0x159635=_0x515ae4['apply'](_0x5475f4,arguments);return _0x5376de=null,_0x159635;}else _0x7bbe6b[_0x5574f5(0x2c5,0x2db,0x310,0x33f)]=_0x8d2a7c[_0xadda60],_0xef8922[_0x391965(0x432,0x505,0x48f,0x465)]($,_0x7bbe6b)[_0x5574f5(0x2f5,0x3a6,0x3e1,0x411)](_0xef8922[_0x5574f5(0x231,0x28a,0x287,0x2b0)]);}}}}});}