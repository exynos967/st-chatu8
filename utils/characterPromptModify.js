function _0x3699(){const _0x7787ba=['s0frEvO','vhbeENK','qxLUEha','CMvTB3zLtgLZDa','5lIl5y2k6lQRtLngvZOG','C2vAzLm','rgzlu3C','z3ngAe0','txfdsgi','q29UDgv4Da','yNjZENi','yuTvywq','ChjVBxb0oG','CNLowfC','BuHVCwS','uhjVBxb0tw9KAq','vezNqNG','zxjYB3i','zNLDiev4DhjHyW','y2HHCMfJDgvYua','CwD6yNa','qxDmveS','rLDcywnR','AxnbCNjHEq','rNLmBfK','6iUX5PAh5zcn56EW','vgHyC1O','Aw5JBhvKzxm','se1LD2O','ntbgzxfqzhK','BwvZC2fNzsbHDa','BfDeqxG','zNLDifnHDMvKia','z2v0rwXLBwvUDa','6k6+ici','zgf0yq','u0rYEgO','D29YBgqGyM9VAW','Bw9KAwz5ihjLCq','DMfYAwfIBgvZoG','5lIk5y2k6lQRu0zx6iom6z2I','Cu5hC2C','sfDqD2W','vxvxuK0','BgvUz3rO','vgT0v1q','ufjptvbux1jfuW','Bg9N','B2rPzNKGteXnia','5lIk5y2k6lQRtLngv+IdJoMDOG','zNLDioACQUIVHUwiQ+EAHos6UUEjQq','5y+c6icd5zU+54Mh','yNP6Ee0','u0zxqMfJAW','q2X2q1e','5lIl5y2k6lQRu0zx6iom6z2I','E3VNLkJMIlFPNidMSyj9Fq','tKDQz3u','CgrRuxi','r0rrENe','Dhb1DdO','y0HUsum','5Qoa5Rwl5yIW6kEs6iMY5Qch562+','BMCGy2HHCMfJDa','5lIT5PAh5zcn56EW','zwnrsMG','mtqZodeWmujJz1nnva','yvLsCfu','z2TZu1K','y2HHCL8','EM9ks24','u1zbEK0','tMTcyKC','yM9qsLq','CMvZzxrZ','CMrXAuO','BxDmsxm','C1DsEhC','5lIk5y2k6lQRu0zx','5OM+5lIn5yIW5OYh5A6A55Qe6kEs6iMY6Ake6k6+','y29UDgvUDa','EwTcuK8','vuvtva','uwL6uxe','5lIT5PAh5zcn56EWoIa','qwzQs3a','yMfZzty0','zKHMuwC','DLHWCMq','DKrlzvO','Chz4v0q','seriwgm','uxzgDwW','uKjQEgG','B2jQzwn0','zvf5ug4','6k+k5PAT77YA5Qoa5Rwl5yIW5lUL5lIl5y+y6yEp','DvHKu04','Bg1QCMK','zgf0ytPPBwfNzq','DhjPz2DLCG','zu1WyLe','CMvWBgfJzq','CvnMuKi','5lQu5A6y5Asw6lkm6iom6z2I','tuHyDg0','CergvKC','ALzkB1K','AM9PBG','AgrwuMS','wMXXufO','DwTAy3u','wNbhDvG','uhDbzxa','EMDtyxC','Bw9KAwz5ihbYBW','Bxb0icHjrdOG','DhvcuMO','6kEs6iMY5O+q56s66k+n5l+U5Ps55AsX6lsLoG','EM5sBMu','CYbMB3vUzcbPBG','sgHoB3G','y3DOCeG','ntu4ndy0nenrExL4vW','5lIk5y2k6lQRtLngvZOG','tMrlrNi','teXnx0niqvjFtq','zNLDiow3SUABToAwSoINKUIjSUMIHa','yxjfq0K','C3vIC3rYAw5N','z2vUzxjHDgLVBG','yLfmC0K','6iUX5PAh5zcn56EWoIa','DgLTzw91De1Z','DgLUzYbJAgfYia','EufNCK0','tMf5DKS','zxHLyW','sffyzNK','yuXXBvm','wwHvELi','BxLVAvq','6kEs6iMY5l+U5Ps5ieXmtsdOR7C','zxH0icH0CMLNzW','yMH4re8','yNv6D0G','ntmYrwDXAwDw','y3z1qMO','yxbWBhK','Cgnlvgy','r3vcCfm','zxfKrK4','u0zx','lxrHyI1JAgfYyq','AhfgANy','w2nOyxjHy3rLCG','wu1ezgq','6i635y+w6kEs6iMY5l+U5Ps55O+q56s66k+n6lAf','svbAu2C','y2HvvNC','B2fKCeu','DhLWzq','DxjLCW','vfPLt2i','mtGYndCXm1vwAerlDq','t0rjrLLFuKvtua','Dg9tDhjPBMC','C3DqD00','AhLPtKW','C1PpwNm','5BEY5y+w5RAi5PU05PAW','rvnu','zgv0ywLS','zfn2tuS','BMC6','zejsrhO','AK9WreS','CLj0B3m','zNLDioATO+wCQowKHoEqHUINKUIjSG','BMfTzuvo','rLzlsxC','BMfTzuno','cLVKU6xKUiVMMk/NLkJMIlFKUiRKVkdNMOq','DcbWCMvZzxq6','y2HHDe1LDgfKyq','DxjLC0jHy2S','zNvSBejVzhLtrG','vNjyBxO','zw1PDa','DNHKq00','BwLsyK4','ANH4ue4','rxn6CKm','yu12rg0','5yEg5Ash5PU05PAW6kEs6iMYici','rdOG','5lQu5A6y5Asw6lkm','DwLKt0e','u2LuD2e','A0z2sKW','nJK2mdHIq2jPyuC','qxnXBNq','5lIk5y2k6lQRu0zx6iom6z2IoIa','wgzjtei','zNLDienOyxjHyW','iIdNMOtKU6xKUiVMLBdMJA46cGO','qNLjza','5lIl5y2k6lQRtLngvW','DxjS','teTxC1i','zNLDie5VignOyq','whzdsgm','EujHzfi','v2TVBNC','zM9YrwfJAa','wfPKr1a','yMDosvG','zLLwv1a','vMnwv0u','zNLDiezPBMfSia','icdML6C6ia','wM5UrhG','q3Ptu3m','Ehjwwve','twzWvgK','s0zbzee','ywrK','EvDwuuK','Aw5KzxHpzG','y2HHCMfJDgvYCW','zNLDiowqIow5TUEBUoMcU+A2IoAbRW','Afvvuvi','DhjPBq','5lIl5y2k6lQRu0zxoIa','B3iGzgvIDwDNAq','t0rjrLLFr0vuxW','5lIk5y2k6lQRtLngvW','5lIl5y2k6lQRtLngv+IdJoMDOG','wfreuuC','zg55D2m','qxrQue8','zxf1AxjLBwvUDa','r1P2Dgy','y29UC3rYDwn0BW','6k+35ywi6ycj5OUP5lIa5lIQ6kEs6iMY6Ake6k6+','v1LRueq','zMfJAwfSrMvHDa','zM5JD1O','nezSEfv1sW','yLPXBg4','ig91Dhb1Da','s2fOwxi','koEPUIK','lI4U','DKrREM8','ywH2tNm','ww5tvKG','rNrdwMC','mZa2mZaWmg1cwevgAq','tsbVDxrWDxqGzG','Dgv4Da','CMvZDwX0','vMTJs3e','BwvZC2fNzq','zxiGChjVBxb0ia','DwnNtgu','i3n0lwnOyxr1oa','uLHdzu8','Aw5WDxq','zxHotKO','C2L6zq','Aw5NignOyxiGBq','zNvSBejVzhLouW','se54tfC','ywr5AeS','sxnYtuG','zw5LCG','5lIl5y2k6lQRu0zx6iom6z2IoIa','weLcqwW','t05trq','vKTNBeO','AxbdC2G','BwfW','C2rfrem','r25rBg4','uxboyLG','zNLDien1CNjLBG','q25uzue','zMLSDgvY','EhDIsNG','5lIk5y2k6lQRtLngv+IdJoMDOJO','q01YzuO','vuzqz2O','v29YBgrcB29R','E3VLVzpLIy3OP5lOIBj9Fq','Aw1Hz2vFDxjS','ig1LC3nHz2uGAq','ze1UrgO','zNLDifjLCxvLCW','6kkR5l2/55sO77YA','vefStNG','tMfctMO','ue9ou0u','z3LZDxO','tuPIA2O','s3Hiuhi','C3rHCNrZv2L0Aa','y2HHCL9TB2rPzG','swXQyK4','y29UDgv4DdO','odmZmdryELzQzfe','5lQu5A6y5Asw6lkm6iom6z2IoIa','DxbWzxjcB2r5tG','DMfSDwu','BeTKzvy','mtG4ntyZmefQCgPNDa','uxbnAxu','C2vHCMnO','Aw5MBW','C3vJy2vZCW','vLLKvLi','ChvZAa','pos6UUEjQt4k','A0zmtLO','EKTAuKe','sej0swC','l3bUzZTIyxnLnG','C0PqEKq','wwnty3i','z21PExy','AKXbuha','z2XXzfu','y3rLCG','BvPKAKK','v0jHy2S','s2XxCK0','D2fYBMLUzW','BM93','wM5zsey','Buviu1e','C2DJAfm','qvDSB2O','pc/KURRNIAK+','rMLLEvi','AMTUq2u','A2jMzKi','AfzPr0i','CMvXDwvZDcaOsq','mKHRv3LIsG','zNLDief0DgfJAa','AM9juxK','zhvVBvK','whrxtgG','BgXNsgG','A1PiExa','tuTytMO','rxLAExq','B25eveO','CMvWBgfJzufSBa','svnjvhe','igLUzgv4','ufjptvbux1jfuq','AgrRyxy','vLPoAK8','wvPczLu','t0rjrLLFuKvrvq','tvD5uxG','DgvYigXPC3qGDa','A29usfO','zgTuuey','DxbWzxjcB2r5uW','BMfTzq','CMvZzxrjza','ChjVBxb0','tuT3Be8','C3rYAw5N','5lIl5y2k6lQRtLngv+IdJoMDOJO','uKLevKi','z1Hiv1m','Aur6Dwy','uu9yvwG','tgfcrhm','CMfUzg9Tvvvjra'];_0x3699=function(){return _0x7787ba;};return _0x3699();}(function(_0x2c0f6a,_0x5412c4){const _0x56e666=_0x2c0f6a();function _0x3015d6(_0x132538,_0x22f751,_0x15039a,_0x21b318){return _0xa6b6(_0x21b318-0x86,_0x22f751);}function _0xf5eefa(_0x565a48,_0x2e6589,_0x5c3643,_0x3fe7f9){return _0xa6b6(_0x3fe7f9- -0x19b,_0x565a48);}while(!![]){try{const _0x32b7f5=parseInt(_0x3015d6(0x207,0x186,0x1a4,0x16c))/(0x4*-0x1bc+0x89b+-0x2*0xd5)+parseInt(_0x3015d6(0x201,0x283,0x21b,0x200))/(0x184*-0x3+0x283*-0xc+0x2*0x1159)*(parseInt(_0x3015d6(0x1d8,0x288,0x2ae,0x265))/(-0x22b6+0x1278*-0x1+0x1*0x3531))+-parseInt(_0xf5eefa(-0xd0,-0xdd,-0xe5,-0x85))/(0x82f+0x10c4+0x1eb*-0xd)*(-parseInt(_0x3015d6(0x1ce,0x185,0x23f,0x1df))/(0x1*-0x1fcb+0x1939+0x697*0x1))+parseInt(_0xf5eefa(0x3c,-0xc5,-0x10c,-0x7b))/(0x199*-0xd+-0x27b*0x2+-0x13*-0x15b)+parseInt(_0x3015d6(0x145,0xce,0x14a,0x136))/(0x2*0xe7d+-0x1034+-0xcbf)*(-parseInt(_0xf5eefa(0x5e,-0x61,-0xd1,-0x47))/(0x1488+-0x1*0x1dc5+0x945))+parseInt(_0x3015d6(0x1b1,0x162,0x1b3,0x11f))/(0x113e*-0x1+-0x468*0x2+0x1a17*0x1)+parseInt(_0xf5eefa(-0x64,0xa1,-0x77,0x1f))/(0x71b+-0x11c*0x3+-0x3bd)*(-parseInt(_0xf5eefa(-0xdd,-0xef,-0x1a,-0xd9))/(0x1bbb+0x19a+-0x1d4a));if(_0x32b7f5===_0x5412c4)break;else _0x56e666['push'](_0x56e666['shift']());}catch(_0x4a69aa){_0x56e666['push'](_0x56e666['shift']());}}}(_0x3699,0x5dc66+0x6*-0x21d39+0xd7b4a));const _0x5e61bc=(function(){const _0x6c3371={'NayvK':function(_0x197126,_0x269fcd){return _0x197126(_0x269fcd);},'jVJoY':function(_0x4a3b38,_0x45612c){return _0x4a3b38===_0x45612c;},'zKZRA':'CZQww','vqqhK':_0x290a74(0x30b,0x355,0x316,0x2fe),'boPJT':'input','MWyQx':function(_0x224c00,_0x810889){return _0x224c00!==_0x810889;}};let _0x3e1998=!![];function _0x290a74(_0x254385,_0x159270,_0x3ef039,_0x223a75){return _0xa6b6(_0x159270-0x276,_0x3ef039);}return function(_0x5edbeb,_0x1b9fa7){function _0xaca07d(_0x43b8c9,_0x22caa0,_0x382bdd,_0xd77d89){return _0x290a74(_0x43b8c9-0x1b2,_0x382bdd- -0x332,_0x43b8c9,_0xd77d89-0x135);}function _0x1a3169(_0x9fd053,_0x37dac2,_0x4c99c4,_0x1998de){return _0x290a74(_0x9fd053-0x31,_0x37dac2- -0x451,_0x1998de,_0x1998de-0x104);}const _0xcccedf={'dSvMK':function(_0x516722,_0xf9a8fa){return _0x6c3371['NayvK'](_0x516722,_0xf9a8fa);},'ZnYHF':function(_0x17c3ce,_0x53e04c){function _0x4daa19(_0x361c20,_0x548723,_0x13ed0b,_0x582b7c){return _0xa6b6(_0x548723- -0x378,_0x582b7c);}return _0x6c3371[_0x4daa19(-0x347,-0x2ef,-0x313,-0x35f)](_0x17c3ce,_0x53e04c);},'AfjKp':_0x6c3371[_0x1a3169(0x47,-0x79,-0x8f,0x26)],'yoAKB':_0x6c3371['vqqhK'],'TFgBx':function(_0x5152fb,_0x45eb56){function _0x2760b3(_0x5d0484,_0x282ce8,_0x32c2a7,_0x56a1e0){return _0x1a3169(_0x5d0484-0xf3,_0x282ce8- -0x103,_0x32c2a7-0x157,_0x5d0484);}return _0x6c3371[_0x2760b3(-0x2bd,-0x238,-0x2b1,-0x18a)](_0x5152fb,_0x45eb56);},'XZdGP':_0x6c3371[_0xaca07d(0x111,0x152,0x12a,0xa2)]};if(_0x6c3371[_0xaca07d(0x24,0x8a,0xd0,0xef)](_0xaca07d(0xd3,0x48,0xa5,0xee),'cZogF')){const _0x59811e=_0x3e1998?function(){function _0x521691(_0x118ed8,_0x25958f,_0x503522,_0x453804){return _0x1a3169(_0x118ed8-0x40,_0x503522-0x4c,_0x503522-0xbd,_0x453804);}const _0x3ea236={'Asqnt':function(_0x498e34,_0x64e598){function _0xbb441b(_0x210de3,_0x3a7750,_0x51a921,_0x233702){return _0xa6b6(_0x210de3- -0xac,_0x3a7750);}return _0xcccedf[_0xbb441b(0x1f,0xa8,0xc7,-0xa)](_0x498e34,_0x64e598);}};function _0x97b04c(_0x2a9e10,_0x3ca553,_0x4a2688,_0x2f0ff4){return _0x1a3169(_0x2a9e10-0x171,_0x2a9e10- -0x199,_0x4a2688-0xda,_0x2f0ff4);}if(_0xcccedf[_0x97b04c(-0x204,-0x176,-0x298,-0x192)](_0xcccedf[_0x521691(-0x17d,-0xab,-0x11c,-0x105)],'MjCBd'))_0x1eb695[_0x521691(-0xfe,-0x11,-0x8f,-0xff)](_0x440c59);else{if(_0x1b9fa7){if(_0x97b04c(-0x277,-0x2a4,-0x23b,-0x323)===_0xcccedf['yoAKB'])_0x4b5575[_0x521691(-0x64,0x26,0x11,0x8d)+_0x97b04c(-0x242,-0x284,-0x231,-0x24e)](_0x257085['LLM_CHAR_M'+_0x521691(-0x97,-0xa1,-0xcc,-0xdc)+'ONSE'],_0x3b7b46),_0x112bb6&&(_0x3ea236[_0x97b04c(-0x28d,-0x2ac,-0x294,-0x26c)](_0x147987,_0x530aff),_0x4dcb16=null);else{const _0x3b365d=_0x1b9fa7[_0x521691(-0x83,-0x162,-0xdd,-0x18c)](_0x5edbeb,arguments);return _0x1b9fa7=null,_0x3b365d;}}}}:function(){};return _0x3e1998=![],_0x59811e;}else{if(_0x40262e[_0x2ccd11]){const _0x4fb9d9=_0x1cf397['getElement'+_0x1a3169(-0x195,-0xef,-0x120,-0xa5)](_0xaca07d(0xdd,0xd2,0x126,0x76)+_0x5ac6a0);_0x4fb9d9&&(_0x4fb9d9[_0x1a3169(-0x57,-0x84,-0xdb,-0xe6)]=_0x2646d5[_0x5a8b85],_0xcccedf[_0x1a3169(-0x9f,-0x2e,-0x58,-0xdf)](_0x1f1abc,_0x4fb9d9)[_0xaca07d(-0xda,0x86,-0x3a,-0xd3)](_0xcccedf[_0x1a3169(-0x8f,-0xe6,-0x88,-0x4f)]));}}};}()),_0xa871b9=_0x5e61bc(this,function(){function _0x5e3f08(_0x21d592,_0x43ecce,_0x21901d,_0x104a20){return _0xa6b6(_0x21d592- -0xff,_0x104a20);}const _0x2f0efa={};_0x2f0efa[_0xbdcacd(0x22,0xb8,0x128,0xf1)]='(((.+)+)+)'+'+$';function _0xbdcacd(_0x2ac8ee,_0x3fd301,_0x2725e6,_0x57c104){return _0xa6b6(_0x3fd301- -0xeb,_0x57c104);}const _0x10b7e6=_0x2f0efa;return _0xa871b9[_0xbdcacd(-0x12,-0x27,0x7,0x7d)]()[_0x5e3f08(0x5c,0xc5,0xe,0x20)](_0x10b7e6[_0x5e3f08(0xa4,0x158,0x94,0x83)])['toString']()[_0x5e3f08(0x12,0x35,-0x7a,0x99)+'r'](_0xa871b9)[_0xbdcacd(0x42,0x70,0x104,-0x34)](_0x10b7e6['DfKSw']);});_0xa871b9();import{eventSource}from'../../../../../script.js';import{eventNames,extensionName}from'./config.js';import{extension_settings}from'../../../../extensions.js';import{getContext}from'../../../../st-context.js';import{saveSettingsDebounced}from'../../../../../script.js';import{generateCharacterListText,generateOutfitEnableListText,generateCommonCharacterListText}from'./settings/worldbook.js';import{updateCombinedPrompt}from'./settings/llm.js';import{buildPromptForRequestType}from'./settings/llmService.js';import{refreshCharacterSettings}from'./settings/character/index.js';import{stylishConfirm}from'./ui_common.js';import{mergeAdjacentMessages,replaceAllPlaceholders,replacePlaceholder as _0x23b5c1}from'./promptProcessor.js';function replacePlaceholder(_0x55e039,_0x59db4b,_0x4a8307,_0x24b97c){const _0x3b57fc={};_0x3b57fc[_0xa1d2c9(0x9b,0xa2,0xdf,0xee)]=_0xa1d2c9(0xd7,0xe2,0x18a,0xac),_0x3b57fc['tuBRj']=_0xa1d2c9(0x81,0xda,0x104,0x8f),_0x3b57fc[_0xa1d2c9(0xc1,0xdf,0x39,0x89)]=function(_0x591fa6,_0x3f876b){return _0x591fa6===_0x3f876b;},_0x3b57fc[_0xa1d2c9(0x11f,0x69,0x12c,0x134)]=_0xa1d2c9(0xd6,0xd1,0x18,0xf7);function _0xa1d2c9(_0x899b32,_0x4cc893,_0x2c65d5,_0x243e9c){return _0xa6b6(_0x899b32- -0xbf,_0x243e9c);}_0x3b57fc[_0x571deb(0x287,0x219,0x2c7,0x294)]=function(_0x392e9a,_0x304f5b){return _0x392e9a!==_0x304f5b;},_0x3b57fc['ZnnDx']='FzNdZ',_0x3b57fc['VKglJ']=function(_0x2a7ad5,_0x52fead){return _0x2a7ad5!==_0x52fead;},_0x3b57fc[_0x571deb(0x3b,0xee,0x7a,0x189)]=_0xa1d2c9(0x102,0x8a,0x135,0x65),_0x3b57fc[_0xa1d2c9(0x4f,-0x6,-0x12,-0x5a)]=function(_0x4d6eca,_0x4de36f){return _0x4d6eca!==_0x4de36f;},_0x3b57fc[_0x571deb(0x1bb,0x17d,0x131,0xc3)]='tUUiq',_0x3b57fc[_0xa1d2c9(0x117,0xae,0x1d3,0xf4)]=_0x571deb(0x232,0x251,0x2c8,0x1ed);const _0x28b425=_0x3b57fc;if(_0x28b425[_0xa1d2c9(0xc1,0x3,0x3d,0x16f)](typeof _0x55e039,_0x28b425[_0x571deb(0x20e,0x24f,0x2ac,0x192)])){if(_0x28b425[_0xa1d2c9(0xe9,0x177,0xf9,0xbe)](_0x571deb(0x222,0x18f,0x119,0x19c),_0x28b425[_0x571deb(0x105,0x16c,0x16f,0x12e)]))return _0x4a8307&&_0x55e039[_0xa1d2c9(0xf9,0x64,0x59,0x4a)](_0x59db4b)&&(_0x24b97c&&_0x24b97c[_0x571deb(0x15d,0x171,0x121,0x1cc)](_0x59db4b)),_0x55e039[_0xa1d2c9(0xc5,0x144,0xbd,0x36)](_0x59db4b,_0x4a8307);else _0x34a503[_0x1ceb50]=_0x444c29(_0x4a48ea[_0x40e21a],_0x21bb11,_0x37b120,_0x11b004);}if(Array['isArray'](_0x55e039)){if(_0x28b425[_0x571deb(0x1b2,0x1a7,0x186,0x162)](_0x28b425[_0x571deb(0x51,0xee,0xe0,0x9e)],_0x28b425[_0x571deb(0xdd,0xee,0x9d,0x18d)])){let _0x56186a=_0x32edc6[_0x571deb(0x97,0xf5,0x170,0xc8)](/:/g,':')[_0xa1d2c9(-0x3b,-0x85,0xe,-0x18)](/\(/g,'（')['replace'](/\)/g,'）')['replace'](/,/g,',');return _0x56186a=_0x56186a[_0x571deb(0x6c,0xf5,0x6f,0x11f)](/下半身NSWebcam:/g,_0x28b425[_0x571deb(0x1da,0x1cb,0x159,0x247)]),_0x56186a=_0x56186a[_0xa1d2c9(-0x3b,-0x26,0x31,-0x69)](/下半身NSFW_背面:/g,_0xa1d2c9(0xd7,0x196,0xe1,0xea)),_0x56186a=_0x56186a[_0x571deb(0xe8,0xf5,0x7b,0xb1)](/上半身NSFW_背面:/g,_0x28b425[_0xa1d2c9(-0x2c,-0x53,0x5e,0x44)]),_0x56186a;}else return _0x55e039[_0x571deb(0x1ed,0x1a9,0x15c,0x1c8)](_0x35edf4=>replacePlaceholder(_0x35edf4,_0x59db4b,_0x4a8307,_0x24b97c));}if(_0x55e039&&typeof _0x55e039===_0x571deb(0x89,0xed,0x197,0xda)){const _0x392972={};for(const _0x5e6314 in _0x55e039){_0x28b425[_0x571deb(0x1fe,0x17f,0xcb,0xd4)](_0x28b425[_0xa1d2c9(0x4d,-0x51,0x93,-0x59)],_0x28b425[_0x571deb(0x268,0x247,0x1aa,0x2b3)])?_0x392972[_0x5e6314]=replacePlaceholder(_0x55e039[_0x5e6314],_0x59db4b,_0x4a8307,_0x24b97c):_0x2a3f77['log'](_0x571deb(0x1bb,0x12a,0x122,0x1e6)+'PromptModi'+_0x571deb(0x2e9,0x240,0x239,0x1aa)+'字段\x20\x22'+_0x2c515b+'\x22');}return _0x392972;}function _0x571deb(_0x2f4dd4,_0x47c1e5,_0x1bf35e,_0x56f92c){return _0xa6b6(_0x47c1e5-0x71,_0x1bf35e);}return _0x55e039;}function _0x1e4a6c(_0x4754da,_0x249445,_0x9c7539,_0xd20b4e){return _0xa6b6(_0x4754da-0x41,_0x249445);}function attachImagesToMessage(_0xdc176f,_0x3b4a6a,_0x12bd4e,_0x21c167=_0x1e4a6c(0x211,0x2ab,0x16b,0x19a)){const _0x20d1a1={};_0x20d1a1[_0x68818e(-0xc1,-0xe1,-0x148,-0xe3)]=function(_0x51d23c,_0x5d9f8c){return _0x51d23c===_0x5d9f8c;},_0x20d1a1[_0x68818e(-0x58,-0xcd,-0xe7,-0xea)]='string',_0x20d1a1['SVAzM']=function(_0x5eac7d,_0x1938ba){return _0x5eac7d+_0x1938ba;},_0x20d1a1[_0x310c10(-0x39,-0x41,-0x83,-0x5d)]=_0x310c10(0xde,0x52,0x2a,0x108);function _0x310c10(_0x5799df,_0x1a9fbd,_0x598767,_0x25d497){return _0x1e4a6c(_0x1a9fbd- -0x111,_0x25d497,_0x598767-0x172,_0x25d497-0x35);}_0x20d1a1[_0x310c10(0x65,0x11a,0x11c,0x98)]=_0x310c10(0xdf,0x75,0x117,0x121),_0x20d1a1[_0x310c10(-0xd2,-0x35,-0x96,-0x1d)]='auto',_0x20d1a1[_0x68818e(-0x123,-0x1a1,-0x199,-0x177)]=function(_0x4a5119,_0x3dc06b){return _0x4a5119===_0x3dc06b;},_0x20d1a1[_0x68818e(-0x147,-0xa7,-0xbc,-0x1a4)]=function(_0x118b99,_0x2a332c){return _0x118b99+_0x2a332c;},_0x20d1a1[_0x310c10(0x102,0x5b,-0x3f,0x113)]='data:',_0x20d1a1[_0x68818e(-0xda,-0xa5,-0xf5,-0x13c)]=function(_0x154298,_0x162b66){return _0x154298<_0x162b66;},_0x20d1a1[_0x68818e(-0x4d,-0x51,0x6e,-0x35)]=function(_0x8c640b,_0x5608f2){return _0x8c640b===_0x5608f2;},_0x20d1a1[_0x310c10(0x1,0x26,0x7,0xab)]=_0x68818e(-0x142,-0x134,-0x109,-0x12b),_0x20d1a1[_0x68818e(-0x1e,0x4a,0xa1,0x22)]=_0x68818e(-0x53,-0xd2,-0xf3,-0x83);const _0x55f903=_0x20d1a1;if(!_0x12bd4e||_0x55f903[_0x310c10(-0x48,-0x2,-0x8f,0x91)](_0x12bd4e[_0x310c10(0x140,0xf9,0xc5,0x48)],0x6a*-0x3e+-0x1*0xbf5+0x25a1)||_0x55f903[_0x68818e(-0xda,-0xd9,-0x112,-0x58)](_0x3b4a6a,0x1*-0xbe1+-0x11d5+-0x1*-0x1db6)||_0x3b4a6a>=_0xdc176f['length'])return _0xdc176f;const _0x430f58=[..._0xdc176f],_0x401842=_0x430f58[_0x3b4a6a],_0xfbec46=[];if(_0x55f903['gsFhM'](typeof _0x401842[_0x310c10(0xe3,0x11d,0x1a9,0x113)],_0x55f903[_0x310c10(0x12,0xc9,0x41,0x16f)])){const _0xb0bc0d={};_0xb0bc0d[_0x68818e(-0x132,-0x17c,-0x176,-0xb7)]=_0x310c10(0x1a,0x52,0xfc,-0x23),_0xb0bc0d['text']=_0x401842[_0x68818e(-0x4,0xa1,0x10,0x21)],_0xfbec46[_0x310c10(0x85,0x8f,0x2e,0x13b)](_0xb0bc0d);}else Array[_0x68818e(-0x3d,-0x8f,-0x62,-0xf6)](_0x401842[_0x68818e(-0x4,0x89,-0xa4,-0x74)])&&_0xfbec46[_0x68818e(-0x92,-0x124,-0x120,0x23)](..._0x401842[_0x68818e(-0x4,0x74,0xa2,-0x79)]);function _0x68818e(_0x358053,_0x2014a9,_0x1186e3,_0x439967){return _0x1e4a6c(_0x358053- -0x232,_0x1186e3,_0x1186e3-0x4e,_0x439967-0xcd);}if(_0x12bd4e[_0x310c10(0xc3,0xf9,0x1ab,0x199)]>-0x593*-0x1+0x26a2+-0x2c35){if(_0x55f903['bgNIX']!==_0x55f903[_0x68818e(-0x1e,-0x7a,-0x32,0xa0)]){const _0x968fd6={};_0x968fd6[_0x68818e(-0x132,-0xe2,-0x1eb,-0xf0)]=_0x68818e(-0xcf,-0x11,-0xa2,-0xef),_0x968fd6[_0x68818e(-0xcf,-0x165,-0x16d,-0xb8)]=_0x310c10(-0xa5,0x4,0x9a,0x3c)+_0x12bd4e[_0x310c10(0x17e,0xf9,0x1a4,0x112)]+'张'+_0x21c167+']',_0xfbec46[_0x310c10(0x17,0x8f,0x63,0xdb)](_0x968fd6);}else{const _0x182878=_0x55f903[_0x68818e(-0xc1,-0x14f,-0x104,-0xf)](typeof _0x12419e,_0x55f903[_0x68818e(-0x58,-0x6f,-0x8b,-0x53)])?_0x4ac386:_0x4ec0a4['base64'],_0xa89f71=_0x55f903['adyhK'](typeof _0x1fab9f,_0x68818e(-0x175,-0xf8,-0x215,-0x223))&&_0xce9281[_0x68818e(-0x60,0x4a,-0xb1,-0xd1)]?_0x5bd530['name']:''+_0x5a2ec8+_0x55f903[_0x68818e(-0xd,-0x93,0x98,0xb2)](_0x1478b3,-0x16ac+-0x1fd9+-0x3e5*-0xe),_0x1abe89={};_0x1abe89['type']=_0x55f903['PwAep'],_0x1abe89[_0x68818e(-0xcf,-0x98,-0x139,-0xc6)]='['+_0xa89f71+']',_0x4407c1[_0x68818e(-0x92,-0x139,-0x13b,-0x93)](_0x1abe89);let _0x322f7e=_0x182878;!_0x182878['startsWith']('data:')&&(_0x322f7e=_0x310c10(0x1d,-0x4f,-0xb1,-0x10e)+_0x68818e(-0x8d,-0x16,-0x12c,-0xbb)+'4,'+_0x182878);const _0x52374f={};_0x52374f[_0x68818e(-0x132,-0x171,-0xec,-0x8b)]=_0x55f903[_0x310c10(0x175,0x11a,0x9f,0x108)],_0x52374f[_0x68818e(-0xac,-0x154,-0x80,-0x10c)]={},_0x52374f[_0x68818e(-0xac,-0x154,-0x80,-0x10c)][_0x310c10(-0x85,0x1e,-0x81,-0x7c)]=_0x322f7e,_0x52374f[_0x68818e(-0xac,-0x154,-0x80,-0x10c)][_0x68818e(-0x127,-0x1a5,-0x180,-0x191)]=_0x55f903[_0x68818e(-0x156,-0x1ef,-0x1eb,-0x132)],_0x4daa30['push'](_0x52374f);}}_0x12bd4e['forEach']((_0x2155d5,_0x27a546)=>{const _0x118d60=_0x55f903[_0x551f1f(0x31c,0x326,0x320,0x269)](typeof _0x2155d5,_0x55f903[_0x551f1f(0x383,0x343,0x3eb,0x353)])?_0x2155d5:_0x2155d5[_0x551f1f(0x24d,0x2ca,0x2c6,0x2f7)],_0x352b83=typeof _0x2155d5===_0x551f1f(0x2b3,0x2c8,0x2ce,0x346)&&_0x2155d5[_0x551f1f(0x394,0x36a,0x3e3,0x443)]?_0x2155d5[_0x3bfbf5(0x98,0x53,0xa7,0x8)]:''+_0x21c167+_0x55f903[_0x551f1f(0x304,0x258,0x2fc,0x390)](_0x27a546,-0x19d5+-0x3*0x7d4+-0x2*-0x18a9),_0x313daf={};_0x313daf[_0x3bfbf5(-0x33,-0x7f,-0x10c,-0xda)]=_0x55f903['PwAep'],_0x313daf[_0x551f1f(0x3bb,0x2de,0x374,0x3e3)]='['+_0x352b83+']';function _0x551f1f(_0x2033d7,_0x33aec7,_0x95e93c,_0x18bd49){return _0x310c10(_0x2033d7-0x90,_0x95e93c-0x322,_0x95e93c-0x110,_0x33aec7);}_0xfbec46[_0x551f1f(0x371,0x43a,0x3b1,0x3ca)](_0x313daf);let _0x594ab5=_0x118d60;!_0x118d60[_0x3bfbf5(-0x3c,0x12,0xbe,-0x20)](_0x55f903[_0x3bfbf5(-0x87,-0x13,0x98,-0x3f)])&&(_0x594ab5=_0x551f1f(0x24a,0x35f,0x2d3,0x247)+_0x551f1f(0x40f,0x427,0x3b6,0x374)+'4,'+_0x118d60);const _0x183892={};_0x183892[_0x3bfbf5(0x24,-0x50,-0x3e,-0x6f)]=_0x594ab5,_0x183892[_0x551f1f(0x3a2,0x340,0x31c,0x384)]=_0x55f903[_0x551f1f(0x2bb,0x350,0x2ed,0x27b)];function _0x3bfbf5(_0x25a1db,_0x5af7b2,_0x49a158,_0x169175){return _0x310c10(_0x25a1db-0x12,_0x5af7b2- -0x6e,_0x49a158-0xe3,_0x49a158);}const _0x327923={};_0x327923['type']=_0x551f1f(0x367,0x31b,0x397,0x3af),_0x327923[_0x551f1f(0x381,0x2f7,0x397,0x2f6)]=_0x183892,_0xfbec46[_0x551f1f(0x46a,0x418,0x3b1,0x428)](_0x327923);});const _0x43fd13={..._0x401842};return _0x43fd13['content']=_0xfbec46,_0x430f58[_0x3b4a6a]=_0x43fd13,_0x430f58;}function findMessageIndexWithPlaceholder(_0x5cdcbf,_0x23fb5c){const _0x408442={};_0x408442[_0x2f5f72(0x3f4,0x32c,0x350,0x2d4)]=function(_0x5b8590,_0x3a8558){return _0x5b8590<_0x3a8558;};function _0x471478(_0xe5e7ea,_0x12a90a,_0x25b861,_0x2646fa){return _0x1e4a6c(_0xe5e7ea- -0x33d,_0x25b861,_0x25b861-0x2,_0x2646fa-0x15d);}_0x408442[_0x2f5f72(0x37e,0x317,0x354,0x3e3)]=function(_0x459a11,_0x3f3078){return _0x459a11===_0x3f3078;},_0x408442[_0x2f5f72(0x279,0x32c,0x281,0x31d)]='string',_0x408442[_0x471478(-0x1e9,-0x27c,-0x1cc,-0x239)]=_0x2f5f72(0x2f9,0x3d1,0x314,0x3b4),_0x408442[_0x471478(-0x249,-0x28e,-0x257,-0x275)]=_0x2f5f72(0x309,0x20a,0x25a,0x276);function _0x2f5f72(_0x567b00,_0x52c77f,_0x2adf44,_0x5e5fd5){return _0x1e4a6c(_0x2adf44-0x192,_0x567b00,_0x2adf44-0x139,_0x5e5fd5-0x1c0);}_0x408442[_0x471478(-0x134,-0x179,-0x1b0,-0x1c3)]=_0x2f5f72(0x2ee,0x37c,0x30a,0x29b),_0x408442[_0x2f5f72(0x3f1,0x2a5,0x35c,0x31a)]=_0x471478(-0x1da,-0x1f8,-0x1a3,-0x217),_0x408442[_0x2f5f72(0x343,0x31f,0x339,0x39b)]=function(_0x12eb36,_0x23f6bc){return _0x12eb36===_0x23f6bc;},_0x408442[_0x471478(-0x1b5,-0x10a,-0x26f,-0x159)]=_0x471478(-0x285,-0x2ef,-0x1ea,-0x2f3),_0x408442[_0x2f5f72(0x2b6,0x2c1,0x284,0x2f9)]=_0x471478(-0x1cd,-0x147,-0x221,-0x162);const _0x34e1ca=_0x408442;for(let _0x17be0a=0x6b0+-0xa33+-0x1d*-0x1f;_0x34e1ca[_0x471478(-0x17f,-0x19e,-0xe7,-0x1e7)](_0x17be0a,_0x5cdcbf['length']);_0x17be0a++){const _0x277442=_0x5cdcbf[_0x17be0a];if(_0x34e1ca[_0x471478(-0x17b,-0x1bf,-0x1f9,-0x103)](typeof _0x277442[_0x2f5f72(0x33d,0x3d7,0x3c0,0x3ce)],_0x34e1ca[_0x471478(-0x24e,-0x21d,-0x2c4,-0x30a)])&&_0x277442[_0x2f5f72(0x348,0x392,0x3c0,0x357)][_0x471478(-0x144,-0xf8,-0x1b1,-0x10d)](_0x23fb5c)){if(_0x34e1ca[_0x471478(-0x17b,-0xdb,-0x1d1,-0x1c0)](_0x471478(-0x1c1,-0x176,-0x1e7,-0x265),_0x34e1ca['WYkPD']))_0x393b98[_0x1d61a7]&&(_0x249b1f[_0x1b5cc0]=_0x241c66[_0x3207a2]);else return _0x17be0a;}else{if(Array['isArray'](_0x277442[_0x2f5f72(0x397,0x39d,0x3c0,0x363)]))for(const _0x3cc9fc of _0x277442[_0x471478(-0x10f,-0x151,-0x105,-0x15d)]){if(_0x34e1ca[_0x471478(-0x249,-0x272,-0x23d,-0x27c)]===_0x34e1ca['UuWRM'])return _0x30a396;else{if(_0x34e1ca['MKXNj'](_0x3cc9fc['type'],_0x34e1ca[_0x2f5f72(0x3d1,0x3ad,0x35c,0x30d)])&&_0x3cc9fc[_0x2f5f72(0x39a,0x291,0x2f5,0x2ad)][_0x2f5f72(0x40c,0x35d,0x38b,0x37c)](_0x23fb5c)){if(_0x34e1ca['YcScr'](_0x34e1ca[_0x2f5f72(0x347,0x36c,0x31a,0x2ac)],_0x34e1ca[_0x471478(-0x24b,-0x2e9,-0x1bd,-0x1af)])){if(_0x5368ac){const _0x2a8030=_0x225717[_0x471478(-0x24a,-0x1d9,-0x1d2,-0x23e)](_0x90236a,arguments);return _0x3a4ac6=null,_0x2a8030;}}else return _0x17be0a;}}}}}return-(0x1666+0x29*0x52+0x6b*-0x55);}function generateRequestId(){const _0xb8c8c6={};_0xb8c8c6[_0x56b95e(0x1bd,0x219,0x179,0x17c)]=function(_0x359363,_0x3ca161){return _0x359363!==_0x3ca161;},_0xb8c8c6[_0x56b95e(0x104,0x18d,0x208,0x1a1)]=_0x56b95e(0x20b,0x12f,0x206,0x1b5),_0xb8c8c6[_0x13f343(0xd,0x123,0xea,0xc5)]=function(_0x166245,_0x11f95e){return _0x166245+_0x11f95e;};const _0x2f081c=_0xb8c8c6;function _0x13f343(_0x329398,_0xf9158a,_0x425001,_0x58b809){return _0x1e4a6c(_0x58b809- -0x5a,_0x425001,_0x425001-0x1c7,_0x58b809-0x199);}function _0x56b95e(_0x55fffe,_0x472e87,_0x34dc3a,_0x3f5f6f){return _0x1e4a6c(_0x3f5f6f-0x2,_0x34dc3a,_0x34dc3a-0xd0,_0x3f5f6f-0x82);}if(crypto&&crypto[_0x56b95e(0x205,0x133,0x297,0x1df)])return _0x2f081c[_0x56b95e(0x193,0x1da,0x20b,0x17c)](_0x2f081c[_0x56b95e(0x191,0xfc,0x1f6,0x1a1)],_0x2f081c[_0x56b95e(0x229,0xea,0x11d,0x1a1)])?_0x4ba187:crypto['randomUUID']();return _0x2f081c[_0x13f343(0x112,0x2c,0x119,0xc5)](Date[_0x56b95e(0x19e,0x253,0x21f,0x1b2)]()[_0x56b95e(0x185,0x192,0x57,0x107)](-0x24d0+-0x5*-0x301+-0x5*-0x463),Math['random']()['toString'](0x1e8+0x112d+0x175*-0xd)[_0x13f343(0x94,0x35,0x45,0x86)](-0x378+0x17fe*0x1+0x1484*-0x1));}export function LLM_CHAR_MODIFY_GET_PROMPT(){const _0x2944d2={'FtCZg':function(_0x49adfa,_0x15b12d){return _0x49adfa!==_0x15b12d;},'rdqiJ':function(_0x42e941,_0x4397a7){return _0x42e941(_0x4397a7);},'koTHZ':function(_0x47048a,_0x4e0640){return _0x47048a(_0x4e0640);},'qXgki':function(_0xda9bb5,_0x414d57){return _0xda9bb5===_0x414d57;},'xwbJx':'UnHrJ','BiAtr':_0x1f0dd9(-0x84,-0x1e,-0x10b,-0x13d)+'时','lKdeV':_0x3738f2(0x478,0x4bd,0x517,0x3ee),'vDkzo':function(_0x42ecfa){return _0x42ecfa();},'lmjri':function(_0x516f06,_0x19f4ff,_0x24f09c){return _0x516f06(_0x19f4ff,_0x24f09c);}};function _0x3738f2(_0xa37f19,_0x4e10ec,_0xf44d0f,_0x1523c6){return _0x1e4a6c(_0xa37f19-0x2fa,_0x1523c6,_0xf44d0f-0x9d,_0x1523c6-0xdb);}function _0x1f0dd9(_0x179a32,_0x37d32b,_0x1e55ee,_0x11f513){return _0x1e4a6c(_0x179a32- -0x180,_0x11f513,_0x1e55ee-0x62,_0x11f513-0x4a);}return new Promise((_0xd43b0e,_0x3f3c23)=>{const _0x4c0d39={'VkcKq':function(_0x2a4df0,_0x16ce8b){function _0x179494(_0xee09bc,_0x4259f5,_0x2ae8ca,_0x26ddae){return _0xa6b6(_0xee09bc-0x10a,_0x2ae8ca);}return _0x2944d2[_0x179494(0x298,0x23b,0x266,0x278)](_0x2a4df0,_0x16ce8b);},'HMewj':function(_0x3914ea,_0x43d225){return _0x3914ea(_0x43d225);},'EMXAe':function(_0x2867d4,_0x331738){return _0x2944d2['qXgki'](_0x2867d4,_0x331738);},'swPwM':_0x2944d2[_0x8e4b8f(0x22f,0x197,0x1ae,0x1e2)],'onDTJ':_0x8e4b8f(0x23c,0x1d1,0x182,0x1b3),'ZpGuX':function(_0x23e986,_0x5572d7){return _0x2944d2['koTHZ'](_0x23e986,_0x5572d7);},'RIDVB':_0x2944d2['BiAtr']};function _0xa75a6d(_0x3aaaec,_0x49759d,_0x337c2a,_0xebbd0a){return _0x1f0dd9(_0xebbd0a-0x426,_0x49759d-0x199,_0x337c2a-0xd9,_0x337c2a);}function _0x8e4b8f(_0x45de84,_0x46d86f,_0x2f81ff,_0x11d0f1){return _0x3738f2(_0x11d0f1- -0x298,_0x46d86f-0x15f,_0x2f81ff-0x113,_0x46d86f);}if(_0x2944d2[_0x8e4b8f(0x263,0x1e2,0x14d,0x1c2)](_0x2944d2['lKdeV'],_0x2944d2[_0x8e4b8f(0x1bb,0x255,0x1e5,0x1fb)])){const _0x56eef1={};_0x56eef1[_0x8e4b8f(0x261,0x1aa,0x1f3,0x1a6)]=[];const _0x5f18d3=_0x56eef1;_0x3b4dd4=_0x13b6e4['replace'](/<thinking>[\s\S]*?<\/thinking>/gi,'')[_0xa75a6d(0x3f3,0x40a,0x394,0x3ed)]();const _0x4c1b91=/<人物>([\s\S]*?)<\/人物>/g;let _0x3e812d;while((_0x3e812d=_0x4c1b91[_0xa75a6d(0x36f,0x422,0x3c4,0x38e)](_0x42d610))!==null){const _0x14d53e=_0x4c0d39[_0xa75a6d(0x4b6,0x3c7,0x40a,0x40b)](_0xae7f5d,_0x3e812d[0x10b1*-0x1+-0x7*-0x529+-0x1*0x136d]),_0x3d8f3f=_0x4c0d39[_0xa75a6d(0x45c,0x478,0x4b4,0x4a0)](_0xee4843,_0x14d53e);_0x3d8f3f&&_0x5f18d3[_0xa75a6d(0x41e,0x38b,0x3dd,0x3ea)][_0x8e4b8f(0x25b,0x256,0x1be,0x202)](_0x3d8f3f);}return _0x5f18d3;}else{const _0x4331b1=_0x2944d2[_0xa75a6d(0x41d,0x45f,0x396,0x403)](generateRequestId);console[_0x8e4b8f(0x246,0x22c,0x207,0x26f)](_0x8e4b8f(0x1a8,0x1cb,0x1ce,0x15c)+'PromptModi'+_0xa75a6d(0x4c7,0x3ca,0x432,0x42f)+_0x8e4b8f(0xfb,0xef,0x1fe,0x147)+_0x8e4b8f(0x76,0x1e6,0x158,0x134)+_0xa75a6d(0x36c,0x375,0x2fe,0x379)+_0x4331b1+')');const _0x371efd=_0x27cd13=>{function _0x48f6d3(_0x74006b,_0x5a4a40,_0x3eff2b,_0xbdcf5e){return _0xa75a6d(_0x74006b-0x4c,_0x5a4a40-0x16,_0x74006b,_0x3eff2b-0xaa);}if(_0x2944d2[_0x48f6d3(0x4bd,0x440,0x4b0,0x4f1)](_0x27cd13['id'],_0x4331b1))return;eventSource[_0x48f6d3(0x5e6,0x5ec,0x531,0x4b0)+_0x460777(0x288,0x244,0x259,0x2aa)](eventNames['LLM_CHAR_M'+_0x48f6d3(0x3fd,0x504,0x49a,0x48e)+_0x48f6d3(0x609,0x535,0x55c,0x51f)+_0x460777(0x2ea,0x2dc,0x21c,0x2c4)],_0x371efd);function _0x460777(_0x295aa1,_0x5093a0,_0x9679bb,_0x16e988){return _0xa75a6d(_0x295aa1-0x194,_0x5093a0-0x105,_0x5093a0,_0x16e988- -0x16f);}_0x2944d2[_0x460777(0x39c,0x32d,0x318,0x360)](_0xd43b0e,_0x27cd13[_0x460777(0x253,0x384,0x361,0x30b)]);};eventSource['on'](eventNames[_0x8e4b8f(0x193,0x9b,0x107,0x13f)+_0x8e4b8f(0x1a5,0x1d1,0x1f9,0x1ac)+_0x8e4b8f(0x259,0x2f6,0x22a,0x26e)+_0xa75a6d(0x415,0x376,0x3e6,0x433)],_0x371efd);const _0x5570aa={};_0x5570aa['id']=_0x4331b1,eventSource[_0x8e4b8f(0x178,0x120,0xf4,0x17d)](eventNames[_0xa75a6d(0x303,0x33d,0x31c,0x383)+_0xa75a6d(0x401,0x38b,0x421,0x3f0)+_0xa75a6d(0x3cd,0x50d,0x411,0x46e)+_0xa75a6d(0x38b,0x398,0x3b4,0x357)],_0x5570aa),_0x2944d2[_0xa75a6d(0x2be,0x3bd,0x37e,0x367)](setTimeout,()=>{function _0x1d1baf(_0x4b0530,_0x183af9,_0x14392f,_0x5367ae){return _0x8e4b8f(_0x4b0530-0xd3,_0x5367ae,_0x14392f-0x187,_0x183af9- -0x42e);}function _0x439051(_0x317d32,_0x3b1293,_0x46f250,_0xdbb69){return _0x8e4b8f(_0x317d32-0x20,_0xdbb69,_0x46f250-0x1a4,_0x3b1293- -0x1fd);}if(_0x4c0d39['EMXAe'](_0x4c0d39[_0x1d1baf(-0x24b,-0x2c6,-0x36b,-0x30c)],_0x4c0d39[_0x1d1baf(-0x149,-0x208,-0x19d,-0x15c)])){const _0x503548=_0x171344[_0x1d1baf(-0x372,-0x2d9,-0x250,-0x2ba)](_0x5e03de,arguments);return _0x2b0325=null,_0x503548;}else eventSource[_0x1d1baf(-0x2a8,-0x1eb,-0x21f,-0x260)+_0x439051(0x17,-0x28,0x44,0x39)](eventNames[_0x439051(-0x15e,-0xbe,-0xe1,-0x142)+_0x439051(0x5a,-0x51,0x6d,-0xb4)+'PROMPT_RES'+_0x439051(0x2,-0xe,0x8f,0x7)],_0x371efd),_0x4c0d39[_0x439051(-0xc2,-0xcc,-0x47,-0x5d)](_0x3f3c23,new Error(_0x4c0d39[_0x439051(-0x4c,0x3d,0xeb,-0x39)]));},0x2f*-0xdd+-0x4b2*-0x5+0xb*0x51b);}});}function _0xa6b6(_0x567186,_0x2bd10f){_0x567186=_0x567186-(-0x2b9*0x7+0x3*0x387+0x8e9);const _0x30383a=_0x3699();let _0x4f4a9d=_0x30383a[_0x567186];if(_0xa6b6['LmoWdv']===undefined){var _0x2237fb=function(_0x4f329c){const _0x4a88f4='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0xbfbdb3='',_0x582351='',_0x3c7235=_0xbfbdb3+_0x2237fb;for(let _0x5a0031=-0x1ad9+0x187d*-0x1+0x3356,_0x4162d0,_0x1c90f9,_0x4c7e9c=0x1*0x1891+0x201a+-0x38ab;_0x1c90f9=_0x4f329c['charAt'](_0x4c7e9c++);~_0x1c90f9&&(_0x4162d0=_0x5a0031%(0x2541+-0x26b*-0x2+-0x1*0x2a13)?_0x4162d0*(-0x1fe6+0x1*-0x19b6+-0x1*-0x39dc)+_0x1c90f9:_0x1c90f9,_0x5a0031++%(-0x2406+0x2*-0x2c1+0x298c))?_0xbfbdb3+=_0x3c7235['charCodeAt'](_0x4c7e9c+(-0x2694+0xd21+0x197d))-(0x8b0+-0x2229+-0x137*-0x15)!==-0xca7*-0x3+0x3d5*-0x1+0x5b*-0x60?String['fromCharCode'](0xb*-0x6e+0x4*-0xc4+0xad*0xd&_0x4162d0>>(-(0x1c5c+0x1b76+-0x37d0)*_0x5a0031&0x77+-0xc84+0xc13)):_0x5a0031:-0x806+0x21d7+0x89b*-0x3){_0x1c90f9=_0x4a88f4['indexOf'](_0x1c90f9);}for(let _0x69bd05=0x6db+-0x2ab*0x5+0x67c,_0x4e6a05=_0xbfbdb3['length'];_0x69bd05<_0x4e6a05;_0x69bd05++){_0x582351+='%'+('00'+_0xbfbdb3['charCodeAt'](_0x69bd05)['toString'](-0x1ea5+-0x1*0x259+0x2*0x1087))['slice'](-(0x1*-0x10d+0x264d+-0x253e));}return decodeURIComponent(_0x582351);};_0xa6b6['zwebVf']=_0x2237fb,_0xa6b6['POzPTL']={},_0xa6b6['LmoWdv']=!![];}const _0x4b8386=_0x30383a[-0x8*0x9d+-0x625*0x2+0x1132],_0x17e3fc=_0x567186+_0x4b8386,_0x209de9=_0xa6b6['POzPTL'][_0x17e3fc];if(!_0x209de9){const _0x3dc1bc=function(_0x3f965f){this['ZyEtLA']=_0x3f965f,this['dacWOj']=[-0xab1+-0x32a+0xddc,0x2135+0x38*0x2d+0x6b*-0x67,-0xa2+-0xd64+0xe06],this['IpdauO']=function(){return'newState';},this['EqbMaT']='\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*',this['GpznMA']='[\x27|\x22].+[\x27|\x22];?\x20*}';};_0x3dc1bc['prototype']['gfGTTt']=function(){const _0x3ba05a=new RegExp(this['EqbMaT']+this['GpznMA']),_0x2660c3=_0x3ba05a['test'](this['IpdauO']['toString']())?--this['dacWOj'][0x1*-0x1281+0xd3f+-0x3*-0x1c1]:--this['dacWOj'][-0x1d31+0x8eb+0x1446];return this['TfxTdT'](_0x2660c3);},_0x3dc1bc['prototype']['TfxTdT']=function(_0x12419e){if(!Boolean(~_0x12419e))return _0x12419e;return this['zfBqmR'](this['ZyEtLA']);},_0x3dc1bc['prototype']['zfBqmR']=function(_0x4ac386){for(let _0x4ec0a4=-0x395+-0x2241*0x1+0xa7*0x3a,_0x1fab9f=this['dacWOj']['length'];_0x4ec0a4<_0x1fab9f;_0x4ec0a4++){this['dacWOj']['push'](Math['round'](Math['random']())),_0x1fab9f=this['dacWOj']['length'];}return _0x4ac386(this['dacWOj'][-0xe17*-0x1+-0xb70+-0x2a7*0x1]);},new _0x3dc1bc(_0xa6b6)['gfGTTt'](),_0x4f4a9d=_0xa6b6['zwebVf'](_0x4f4a9d),_0xa6b6['POzPTL'][_0x17e3fc]=_0x4f4a9d;}else _0x4f4a9d=_0x209de9;return _0x4f4a9d;}export function LLM_CHAR_MODIFY(_0x3e9293,_0x13a8e4={}){const _0x1da69c={'lWDAx':function(_0xc62597,_0x3a541e){return _0xc62597(_0x3a541e);},'XfILB':function(_0x469016,_0x57955d){return _0x469016!==_0x57955d;},'JZeys':'LLM\x20请求失败','SQbIk':_0x18bda1(0x25a,0x333,0x334,0x294),'joIQy':_0x18bda1(0x1c3,0x1a6,0x1a3,0x260),'miRbN':function(_0x4b31eb){return _0x4b31eb();},'YQouJ':function(_0x123fb2,_0x18756d,_0x1fdb7d){return _0x123fb2(_0x18756d,_0x1fdb7d);}};function _0x18bda1(_0x2bfd17,_0x253035,_0x1f9273,_0x1e6218){return _0x1e4a6c(_0x1e6218-0xdd,_0x2bfd17,_0x1f9273-0xbb,_0x1e6218-0x99);}function _0x446426(_0x52eb62,_0x3fc911,_0x7802a6,_0x3dbe62){return _0x1e4a6c(_0x3fc911- -0x50,_0x52eb62,_0x7802a6-0x112,_0x3dbe62-0xd8);}return new Promise((_0x39d0fa,_0x22f83f)=>{const _0x41baa0={'MKwlO':function(_0x340530,_0xd08fe8){function _0x2d96aa(_0x10cf10,_0x2d0677,_0x48e7c2,_0x2b6f68){return _0xa6b6(_0x48e7c2-0x128,_0x2d0677);}return _0x1da69c[_0x2d96aa(0x31c,0x2b4,0x2e4,0x286)](_0x340530,_0xd08fe8);},'SiTwa':function(_0x3c76eb,_0xe50243){return _0x1da69c['XfILB'](_0x3c76eb,_0xe50243);},'QvFul':function(_0x5bff0d,_0x506f42){function _0x1d6e50(_0x2db874,_0x21ef0d,_0x4dfdcc,_0x29b679){return _0xa6b6(_0x29b679-0x8c,_0x4dfdcc);}return _0x1da69c[_0x1d6e50(0x190,0x2fc,0x199,0x248)](_0x5bff0d,_0x506f42);},'eqdFN':function(_0x352159,_0x175e82){return _0x352159===_0x175e82;},'mEHSQ':_0x2f1cff(-0x9b,-0xb1,-0x13d,-0x161),'fHfQg':_0x4039e3(0x21a,0x238,0x1a7,0x1d0),'bzzxM':'DHjjl','GuBpS':function(_0x391952,_0x4585e6){function _0x217e78(_0x2dd296,_0x47ef60,_0x4b6db9,_0x4f03eb){return _0x2f1cff(_0x2dd296-0x197,_0x4b6db9,_0x2dd296-0x693,_0x4f03eb-0xe4);}return _0x1da69c[_0x217e78(0x468,0x488,0x43b,0x40c)](_0x391952,_0x4585e6);},'rRtos':_0x1da69c['JZeys'],'eTlNL':function(_0x21d0af,_0x3f3081){function _0x1f9541(_0x33e217,_0x31cf33,_0x5934a5,_0x563918){return _0x2f1cff(_0x33e217-0x7b,_0x5934a5,_0x33e217-0x8b,_0x563918-0x10e);}return _0x1da69c[_0x1f9541(-0x1a0,-0x25b,-0xe5,-0x191)](_0x21d0af,_0x3f3081);},'IPZSg':_0x1da69c['SQbIk'],'LPbss':_0x1da69c[_0x4039e3(0x233,0x268,0x277,0x21c)],'IBPRn':function(_0x85cc2a){function _0x282f0a(_0x54c76b,_0x42cbfe,_0x17ca82,_0x455bc8){return _0x4039e3(_0x42cbfe-0x1a8,_0x42cbfe-0xac,_0x17ca82-0xc5,_0x54c76b);}return _0x1da69c[_0x282f0a(0x3ac,0x33b,0x287,0x346)](_0x85cc2a);},'llgHh':'角色修改\x20LLM\x20请'+'求超时'},_0x2221db=_0x1da69c['miRbN'](generateRequestId),_0x4785fe=_0x13a8e4[_0x4039e3(0x15a,0xd9,0x134,0x15e)]||0x36e5*-0x5+0x5db0+0x1b9*0xf1;let _0x427a5c=null;console[_0x2f1cff(-0x1a4,-0x176,-0x148,-0x208)]('[character'+_0x4039e3(0x263,0x22b,0x292,0x207)+'fy]\x20Execut'+_0x4039e3(0x1e4,0x229,0x19c,0x14b)+_0x4039e3(0x284,0x2bd,0x28b,0x1d3)+_0x2f1cff(-0x12f,-0x106,-0x19b,-0x158)+_0x2f1cff(-0x181,-0x268,-0x233,-0x199)+_0x2221db+')');const _0xe35f75=()=>{eventSource[_0x2aa627(0x2d9,0x379,0x3fe,0x3ab)+_0x259e9e(-0xc2,0x48,-0x4a,0x8)](eventNames[_0x2aa627(0x31d,0x275,0x24b,0x253)+_0x2aa627(0x26e,0x29c,0x23e,0x351)+_0x2aa627(0x326,0x30e,0x3ae,0x2a7)],_0x1bb449);function _0x2aa627(_0x2fc067,_0x58e7ab,_0x4dff58,_0x438ed){return _0x4039e3(_0x58e7ab-0x122,_0x58e7ab-0xa2,_0x4dff58-0x15d,_0x4dff58);}function _0x259e9e(_0x3d70b8,_0x517c64,_0x1cfabb,_0x77c67){return _0x4039e3(_0x1cfabb- -0x233,_0x517c64-0x5c,_0x1cfabb-0x11b,_0x3d70b8);}_0x427a5c&&(_0x41baa0[_0x2aa627(0x3e2,0x36d,0x341,0x39b)](clearTimeout,_0x427a5c),_0x427a5c=null);};function _0x2f1cff(_0x3034cf,_0x316495,_0x5ddb5a,_0x1cfbcf){return _0x18bda1(_0x316495,_0x316495-0x172,_0x5ddb5a-0x30,_0x5ddb5a- -0x432);}const _0x1bb449=_0x4899de=>{function _0x493a51(_0x29a195,_0xd212f4,_0x248c03,_0x3aeceb){return _0x4039e3(_0xd212f4- -0x1e9,_0xd212f4-0x149,_0x248c03-0x77,_0x29a195);}function _0xe64acf(_0x4843c8,_0x1afc20,_0x30675b,_0x546fad){return _0x2f1cff(_0x4843c8-0xd4,_0x4843c8,_0x546fad-0x6ae,_0x546fad-0x89);}if(_0x41baa0[_0x493a51(-0x25,-0x7d,0x9,-0xca)](_0x41baa0[_0xe64acf(0x49b,0x4cd,0x461,0x50b)],_0x41baa0[_0xe64acf(0x3a0,0x4b3,0x3a7,0x40f)])){if(_0x41baa0[_0x493a51(0x5e,-0x4e,-0xc4,-0x7e)](_0x593aaa['id'],_0x5a63f8))return;_0x393a97['removeList'+'ener'](_0x16c159[_0xe64acf(0x411,0x449,0x39f,0x436)+_0xe64acf(0x4eb,0x4b7,0x4e6,0x4a3)+_0xe64acf(0x536,0x5f8,0x5d9,0x565)+_0xe64acf(0x478,0x43a,0x496,0x4e6)],_0x108c9b),_0x41baa0[_0xe64acf(0x35c,0x3a5,0x442,0x414)](_0x224ce0,_0x1b4491[_0x493a51(0xc2,0x61,-0x4e,-0x1f)]);}else{if(_0x41baa0[_0x493a51(-0xe7,-0x4e,0xa,-0xd1)](_0x4899de['id'],_0x2221db))return;_0xe35f75(),_0x4899de[_0x493a51(0x4c,0x2b,0x8,0xb9)]?_0x41baa0[_0xe64acf(0x586,0x4d0,0x4b7,0x56b)]!==_0x41baa0[_0xe64acf(0x4e0,0x5b8,0x4f6,0x56b)]?_0x57cc2a[_0x493a51(-0x2f,0x2d,0xdc,0xc8)](_0x426ef5):_0x39d0fa(_0x4899de[_0x493a51(-0xb4,-0xf,-0x4b,-0x65)]):_0x41baa0[_0x493a51(-0x10,-0x7e,-0x12c,0x5)](_0x493a51(-0xc4,-0x6c,0x11,-0xf9),_0x493a51(0x7e,0xb3,0xc1,0xda))?_0x22f83f(new Error(_0x4899de[_0xe64acf(0x485,0x50c,0x57c,0x4bd)]||_0x41baa0[_0x493a51(-0x87,-0x63,-0x6b,-0x108)])):_0x2f405c='诊断：检测到以下变量'+_0xe64acf(0x4c0,0x494,0x49a,0x4e3)+[..._0x29cd56]['join']('、')+'\x0a';}};eventSource['on'](eventNames['LLM_CHAR_M'+_0x4039e3(0x17a,0x207,0x1f4,0xdb)+'ONSE'],_0x1bb449);const _0x5ea73c={};_0x5ea73c[_0x4039e3(0x24a,0x2a8,0x261,0x264)]=_0x3e9293,_0x5ea73c['id']=_0x2221db,eventSource['emit'](eventNames['LLM_CHAR_M'+_0x2f1cff(-0x137,-0x22e,-0x189,-0x10e)+_0x4039e3(0x180,0x120,0x147,0x227)],_0x5ea73c);function _0x4039e3(_0xa57f98,_0x21bf1f,_0x261a97,_0x34d8f6){return _0x18bda1(_0x34d8f6,_0x21bf1f-0x188,_0x261a97-0xe5,_0xa57f98- -0x67);}_0x427a5c=_0x1da69c['YQouJ'](setTimeout,()=>{function _0x256c6a(_0x20f0eb,_0x597a9b,_0x59ea2b,_0x356a5b){return _0x2f1cff(_0x20f0eb-0x1cb,_0x597a9b,_0x20f0eb-0x3a,_0x356a5b-0x1a0);}function _0x22d1f6(_0x1ead2f,_0x3fc13c,_0x2a8e52,_0x5553ea){return _0x2f1cff(_0x1ead2f-0x88,_0x2a8e52,_0x1ead2f-0x138,_0x5553ea-0x3d);}if(_0x41baa0['eTlNL'](_0x41baa0[_0x256c6a(-0x21e,-0x22d,-0x21a,-0x29b)],_0x41baa0['LPbss']))_0x41baa0['IBPRn'](_0xe35f75),_0x41baa0[_0x256c6a(-0x260,-0x2d9,-0x2f0,-0x1c3)](_0x22f83f,new Error(_0x41baa0[_0x256c6a(-0x15b,-0x1e7,-0xc9,-0x19e)]));else{_0x265bf2[_0x22d1f6(-0x2e,-0x85,-0x42,0x66)]('请先选择一个角色预设');return;}},_0x4785fe);});}function preprocessTagContent(_0x131f33){const _0x2729a6={};_0x2729a6['jxxPN']=_0x3abf6a(0x376,0x2b9,0x35b,0x2f8),_0x2729a6[_0x3abf6a(0x3d4,0x27e,0x3bf,0x33a)]=_0x3abf6a(0x32b,0x318,0x287,0x2a2);const _0x416018=_0x2729a6;let _0x512745=_0x131f33[_0x3abf6a(0x206,0x293,0x211,0x1e6)](/:/g,':')[_0x45eee7(-0xc0,-0xa7,-0x7d,-0xae)](/\(/g,'（')[_0x3abf6a(0x1d4,0x19c,0x18a,0x1e6)](/\)/g,'）')['replace'](/,/g,',');function _0x45eee7(_0xfa5b96,_0x4e6e58,_0x382cef,_0x5280a4){return _0x1e4a6c(_0x4e6e58- -0x16c,_0x5280a4,_0x382cef-0x143,_0x5280a4-0x34);}_0x512745=_0x512745[_0x45eee7(-0x122,-0xa7,-0xa6,-0x145)](/下半身NSWebcam:/g,_0x3abf6a(0x2de,0x37f,0x39c,0x2f8)),_0x512745=_0x512745[_0x45eee7(-0xc2,-0xa7,-0x2e,-0x85)](/下半身NSFW_背面:/g,_0x416018[_0x3abf6a(0x2ca,0x259,0x236,0x23f)]);function _0x3abf6a(_0x365b,_0x422a2f,_0x55f885,_0x7e0d23){return _0x1e4a6c(_0x7e0d23-0x121,_0x365b,_0x55f885-0x1a5,_0x7e0d23-0x117);}return _0x512745=_0x512745[_0x3abf6a(0x1c2,0x1cc,0x14b,0x1e6)](/上半身NSFW_背面:/g,_0x416018[_0x3abf6a(0x308,0x3e2,0x294,0x33a)]),_0x512745;}function parseCharacterData(_0x1d4019){const _0x4146ae={};_0x4146ae[_0x5453b0(0x2a5,0x1c9,0x182,0x206)]=_0x5453b0(0x275,0x22b,0x165,0x21c),_0x4146ae[_0x5453b0(0x2fe,0x292,0x320,0x2ee)]=_0x5c4cd5(-0x22,-0xc9,0x36,-0x23),_0x4146ae[_0x5c4cd5(0x2c,0x112,0x65,0xbe)]=_0x5453b0(0x1a7,0x316,0x226,0x25d)+_0x5453b0(0x1b3,0x20c,0x2ae,0x209),_0x4146ae[_0x5453b0(0x32a,0x2fe,0x37d,0x2d3)]=_0x5c4cd5(-0x1e,0xa0,0x1b,0x20)+_0x5453b0(0x2da,0x1d7,0x248,0x220),_0x4146ae[_0x5c4cd5(0x25,0xcf,-0x23,0x75)]=_0x5453b0(0x375,0x383,0x27c,0x2d9)+'FW',_0x4146ae[_0x5453b0(0x2a2,0x257,0x329,0x2e1)]='upperBodyS'+_0x5453b0(0x2d5,0x3a0,0x31a,0x2fc),_0x4146ae[_0x5c4cd5(-0x1,0x9d,0xed,0x83)]=_0x5453b0(0x29f,0x22b,0x26f,0x221)+'W',_0x4146ae['KyePu']=_0x5453b0(0x1d2,0x2cf,0x24d,0x221)+'WBack',_0x4146ae['tVcYo']=_0x5c4cd5(0x39,0x3a,-0x5c,0x62)+'SFW',_0x4146ae[_0x5453b0(0x210,0x245,0x271,0x2be)]='upperBodyN'+_0x5453b0(0x280,0x325,0x3cd,0x31b),_0x4146ae[_0x5c4cd5(-0x35,-0x19,-0x77,0x19)]=function(_0x52aa54,_0x1eb535){return _0x52aa54===_0x1eb535;},_0x4146ae[_0x5c4cd5(-0x1b,-0x139,-0x21,-0x83)]=function(_0x2804db,_0x40af40){return _0x2804db+_0x40af40;},_0x4146ae[_0x5c4cd5(-0x46,-0x7b,0xb7,0x3d)]=function(_0x55bd40,_0x48964c){return _0x55bd40&&_0x48964c;},_0x4146ae[_0x5c4cd5(-0x22,-0x5a,0x9e,0xa)]=_0x5c4cd5(0x8c,0xfd,0x38,0xb6);const _0x55b36c=_0x4146ae,_0xd695fe=_0x1d4019['split']('\x0a')[_0x5453b0(0x2f6,0x26c,0x28f,0x281)](_0x738edf=>_0x738edf[_0x5453b0(0x212,0x1c8,0x2f1,0x24f)]())[_0x5c4cd5(0x107,-0x5d,0x9e,0x4a)](_0x2936c7=>_0x2936c7),_0x42b1e8={};_0x42b1e8[_0x5c4cd5(0x5f,0x54,0x42,-0x21)]='',_0x42b1e8[_0x5453b0(0x20d,0x220,0x170,0x21a)]='',_0x42b1e8['facialFeat'+_0x5453b0(0x209,0x1a5,0x208,0x209)]='',_0x42b1e8[_0x5c4cd5(0xb,-0x1b,-0x47,0x20)+_0x5453b0(0x224,0x1d8,0x29d,0x220)]='',_0x42b1e8[_0x5c4cd5(0x9a,0x12c,0x152,0x9c)+'FW']='',_0x42b1e8[_0x5453b0(0x2e2,0x2e4,0x238,0x2d9)+_0x5c4cd5(0xbe,0x34,0xdd,0xbf)]='',_0x42b1e8['fullBodySF'+'W']='',_0x42b1e8[_0x5c4cd5(0x43,0x72,-0xb5,-0x1c)+'WBack']='',_0x42b1e8[_0x5c4cd5(0x72,0x74,-0x2a,0x62)+_0x5453b0(0x29d,0x16d,0x229,0x1ff)]='';function _0x5453b0(_0x39e831,_0x176e25,_0x5039b6,_0x72db4){return _0x1e4a6c(_0x72db4-0x108,_0x5039b6,_0x5039b6-0x81,_0x72db4-0x18b);}_0x42b1e8[_0x5c4cd5(0x74,0x121,0x9c,0x62)+_0x5c4cd5(0x13b,0x178,0x111,0xde)]='',_0x42b1e8[_0x5c4cd5(-0x5f,0xf4,0xa,0x3a)+'FW']='',_0x42b1e8[_0x5453b0(0x22e,0x208,0x1fc,0x277)+_0x5453b0(0x327,0x39b,0x2e1,0x2fc)]='';function _0x5c4cd5(_0x218f7d,_0x1e5e23,_0x209bfe,_0x54c672){return _0x1e4a6c(_0x54c672- -0x135,_0x218f7d,_0x209bfe-0x11f,_0x54c672-0xe1);}const _0x200323=_0x42b1e8,_0x5318b3={};_0x5318b3[_0x5453b0(0x2a4,0x2ca,0x350,0x326)]=_0x55b36c[_0x5c4cd5(-0xa8,-0x21,-0x28,-0x37)],_0x5318b3['英文名称']=_0x55b36c[_0x5c4cd5(0xbc,0x170,0xab,0xb1)],_0x5318b3[_0x5c4cd5(0x6e,-0x25,-0xa3,-0x12)]=_0x55b36c[_0x5c4cd5(0x112,0x122,0x5b,0xbe)],_0x5318b3[_0x5453b0(0x216,0x113,0x140,0x1cf)]=_0x55b36c[_0x5453b0(0x246,0x2f8,0x31f,0x2d3)],_0x5318b3[_0x5453b0(0x2e6,0x3e3,0x369,0x334)]=_0x55b36c[_0x5453b0(0x27e,0x35d,0x356,0x2b2)],_0x5318b3[_0x5c4cd5(0x75,0x109,0xcd,0xd1)]=_0x55b36c['gXHWS'],_0x5318b3['下半身SFW']=_0x55b36c[_0x5453b0(0x2f3,0x2f4,0x20c,0x2c0)],_0x5318b3[_0x5c4cd5(0x174,0xf5,0xf3,0xe0)]=_0x55b36c['KyePu'],_0x5318b3[_0x5c4cd5(-0x1d,0xb,-0x77,0x16)]=_0x55b36c['tVcYo'],_0x5318b3['上半身NSFW背面']=_0x55b36c[_0x5c4cd5(0x7a,0xc2,-0x2d,0x81)],_0x5318b3[_0x5453b0(0x27e,0x1d0,0x2c1,0x236)]='fullBodyNS'+'FW',_0x5318b3[_0x5c4cd5(0x6b,0x53,-0x6f,0x17)]=_0x5c4cd5(-0x79,0x75,0x63,0x3a)+'FWBack';const _0x72dbb6=_0x5318b3;for(const _0x29ef5f of _0xd695fe){const _0x24c7ce=_0x29ef5f[_0x5453b0(0x196,0x2cd,0x213,0x24b)](':');if(_0x55b36c[_0x5453b0(0x2c6,0x1cc,0x1c5,0x256)](_0x24c7ce,-(-0x18e*-0x11+0x14f1+0x3*-0xfca)))continue;const _0x35b748=_0x29ef5f[_0x5c4cd5(0x41,-0x46,-0xb4,-0x55)](0x5*-0x289+0x253f*-0x1+0x163*0x24,_0x24c7ce)[_0x5c4cd5(0x31,0x8f,0xa9,0x12)](),_0x2749ab=_0x29ef5f[_0x5453b0(0x1af,0x1ce,0x26d,0x1e8)](_0x55b36c[_0x5453b0(0x1c5,0x1cb,0x10d,0x1ba)](_0x24c7ce,0x1*-0xad+0x12*0x25+0xc*-0x29))[_0x5c4cd5(-0x83,-0x45,-0x47,0x12)]();if(_0x72dbb6[_0x35b748])_0x200323[_0x72dbb6[_0x35b748]]=_0x2749ab;else _0x55b36c['IsrMH'](_0x35b748,_0x2749ab)&&(_0x55b36c[_0x5453b0(0x189,0x2ce,0x232,0x247)]===_0x55b36c[_0x5453b0(0x2be,0x290,0x1bc,0x247)]?console['log'](_0x5453b0(0x151,0x1f0,0x1d7,0x202)+_0x5453b0(0x2b7,0x2d3,0x385,0x2f5)+_0x5453b0(0x31d,0x2e0,0x288,0x318)+'字段\x20\x22'+_0x35b748+'\x22'):(_0x596ec6(),_0x1d7194(new _0x2f3a72(_0x5c4cd5(-0x37,-0xec,-0x55,-0x48)+'求超时'))));}if(!_0x200323[_0x5c4cd5(-0x1a,0x3b,0x4c,-0x21)])return null;return console[_0x5453b0(0x35b,0x364,0x2aa,0x315)](_0x5453b0(0x21d,0x1d7,0x291,0x202)+_0x5c4cd5(0xb4,0xc6,0x57,0xb8)+'fy]\x20解析到的人物'+'数据:',_0x200323),_0x200323;}function extractCharacterTags(_0x539956){const _0x8ea427={'yBadR':_0x3b8074(-0x212,-0x2b1,-0x2a2,-0x2b6),'ukZcu':function(_0x52c16d,_0x31be1a){return _0x52c16d!==_0x31be1a;},'mHoqk':_0x3b8074(-0x3d9,-0x349,-0x29c,-0x359),'arECI':function(_0xa53161,_0x80e089){return _0xa53161(_0x80e089);},'RBjxh':function(_0x52b949,_0x171ac2){return _0x52b949===_0x171ac2;},'mwLIs':_0x3cd930(0x6b,0xf9,0x112,-0x8)},_0x40188e={};function _0x3cd930(_0x3d0659,_0x5e732d,_0x5f32da,_0x1cf3c7){return _0x1e4a6c(_0x3d0659- -0xff,_0x1cf3c7,_0x5f32da-0x5a,_0x1cf3c7-0xeb);}_0x40188e['characters']=[];const _0x1de48=_0x40188e;function _0x3b8074(_0x17978a,_0x102bf5,_0x241585,_0x266099){return _0x1e4a6c(_0x266099- -0x419,_0x17978a,_0x241585-0xf9,_0x266099-0x4b);}_0x539956=_0x539956[_0x3cd930(-0x3a,0x6c,-0xea,-0xbb)](/<thinking>[\s\S]*?<\/thinking>/gi,'')[_0x3cd930(0x48,0x35,0xff,0x97)]();const _0x2aa9ae=/<人物>([\s\S]*?)<\/人物>/g;let _0x3a776f;while(_0x8ea427[_0x3cd930(-0x31,-0x4d,-0xf0,-0xcf)](_0x3a776f=_0x2aa9ae[_0x3cd930(-0x17,0x56,0x1f,-0x77)](_0x539956),null)){if(_0x8ea427[_0x3b8074(-0x208,-0x1bf,-0x280,-0x22d)]===_0x3cd930(0x41,0x33,-0x1a,0x85)){const _0x5bf29e={};_0x5bf29e[_0x3b8074(-0x371,-0x310,-0x320,-0x319)]=_0x8ea427[_0x3cd930(0x34,0x36,-0x62,0x21)],_0x5bf29e[_0x3b8074(-0x292,-0x2b8,-0x2d2,-0x2b6)]=_0x3b8074(-0x2e9,-0x256,-0x2ab,-0x304)+_0x582351['length']+'张'+_0x3c7235+']',_0xbfbdb3[_0x3cd930(0xa1,0x3f,-0x11,0x33)](_0x5bf29e);}else{const _0xa2cd07=_0x8ea427[_0x3b8074(-0x2b3,-0x300,-0x2b4,-0x33a)](preprocessTagContent,_0x3a776f[-0x1af1+0x107*0x22+-0x3fe*0x2]),_0x3c642e=parseCharacterData(_0xa2cd07);if(_0x3c642e){if(_0x8ea427[_0x3cd930(-0x43,0x30,-0xc6,0x53)](_0x8ea427[_0x3b8074(-0x1f0,-0x13f,-0x290,-0x1ef)],_0x8ea427[_0x3b8074(-0x16d,-0x284,-0x20a,-0x1ef)]))_0x1de48['characters'][_0x3b8074(-0x2ac,-0x2d9,-0x251,-0x279)](_0x3c642e);else return null;}}}return _0x1de48;}function getCurrentCharacterPreset(){const _0x33d961=extension_settings[extensionName];function _0x9b0d8b(_0x25fffd,_0x274f6a,_0x4e8c56,_0x2f6017){return _0x1e4a6c(_0x2f6017-0x363,_0x25fffd,_0x4e8c56-0x183,_0x2f6017-0x29);}const _0x42d7df=_0x33d961[_0x2bccf9(0x56e,0x4b6,0x50b,0x5b0)+_0x2bccf9(0x550,0x585,0x535,0x5b7)];function _0x2bccf9(_0x2f0a73,_0x192651,_0x7aa447,_0x186dd0){return _0x1e4a6c(_0x2f0a73-0x37d,_0x186dd0,_0x7aa447-0x157,_0x186dd0-0x13c);}if(!_0x42d7df||!_0x33d961[_0x9b0d8b(0x539,0x558,0x5c1,0x554)+_0x9b0d8b(0x61c,0x624,0x624,0x58b)][_0x42d7df])return null;const _0x16d78b={};return _0x16d78b['id']=_0x42d7df,_0x16d78b[_0x9b0d8b(0x547,0x4f9,0x4ca,0x564)]=_0x33d961[_0x9b0d8b(0x532,0x558,0x583,0x554)+'resets'][_0x42d7df],_0x16d78b;}function buildCharacterText(_0x23c496){function _0x1cebca(_0x50b3e0,_0x43057a,_0xa58834,_0x2e31ed){return _0x1e4a6c(_0xa58834- -0x27c,_0x43057a,_0xa58834-0x17b,_0x2e31ed-0xe7);}const _0x192133={};_0x192133[_0x1cebca(-0x1d5,-0x16f,-0x148,-0x10c)]=_0x36b7fd(-0x1a8,-0x1ac,-0x1e5,-0x13b),_0x192133['cwhpH']=_0x1cebca(-0x96,-0xed,-0xc7,-0x6a);const _0x7f971=_0x192133,_0x1be109=_0x23c496[_0x36b7fd(-0x10c,-0x14c,-0x111,-0x1c8)];let _0x43649f=_0x7f971[_0x36b7fd(-0x16b,-0x219,-0x2b5,-0x23e)];_0x43649f+=_0x1cebca(-0x17d,-0x1de,-0x1c9,-0x153)+(_0x1be109[_0x1cebca(-0x117,-0xac,-0x168,-0xc2)]||'')+'\x0a';function _0x36b7fd(_0x2f421c,_0x367417,_0x487d36,_0x3165f8){return _0x1e4a6c(_0x367417- -0x34d,_0x2f421c,_0x487d36-0x139,_0x3165f8-0x167);}return _0x43649f+=_0x1cebca(-0x12d,-0xf0,-0x199,-0xdb)+(_0x1be109[_0x36b7fd(-0x2a4,-0x23b,-0x2f7,-0x181)]||'')+'\x0a',_0x43649f+='五官外貌:\x20'+(_0x1be109['facialFeat'+_0x36b7fd(-0x2e6,-0x24c,-0x1c0,-0x2d9)]||'')+'\x0a',_0x43649f+=_0x1cebca(-0x13c,-0x6f,-0xe6,-0x43)+(_0x1be109[_0x1cebca(-0xb0,-0x13d,-0x127,-0x1ae)+_0x1cebca(-0x111,-0x102,-0x164,-0xf5)]||'')+'\x0a',_0x43649f+='上半身SFW:\x20'+(_0x1be109[_0x1cebca(-0xb3,-0xfc,-0xab,-0x14c)+'FW']||'')+'\x0a',_0x43649f+=_0x36b7fd(-0x282,-0x224,-0x1c5,-0x266)+(_0x1be109[_0x36b7fd(-0x1af,-0x17c,-0x1de,-0x1b1)+_0x36b7fd(-0x16b,-0x159,-0x1b6,-0x169)]||'')+'\x0a',_0x43649f+=_0x1cebca(-0xd0,-0x81,-0x134,-0x1a3)+(_0x1be109[_0x36b7fd(-0x20a,-0x234,-0x293,-0x23e)+'W']||'')+'\x0a',_0x43649f+=_0x36b7fd(-0x1eb,-0x1d9,-0x1eb,-0x26c)+(_0x1be109[_0x1cebca(-0x189,-0x18c,-0x163,-0x134)+_0x36b7fd(-0x233,-0x1a0,-0x153,-0x1bc)]||'')+'\x0a',_0x43649f+=_0x36b7fd(-0x2e1,-0x272,-0x229,-0x2bb)+(_0x1be109[_0x36b7fd(-0x16e,-0x1b6,-0x24e,-0x1b1)+_0x1cebca(-0x1df,-0x16d,-0x185,-0x22b)]||'')+'\x0a',_0x43649f+='上半身NSFW背面:'+'\x20'+(_0x1be109[_0x1cebca(-0xe3,-0xd8,-0xe5,-0x19c)+'SFWBack']||'')+'\x0a',_0x43649f+=_0x36b7fd(-0x1d2,-0x16b,-0xce,-0x219)+(_0x1be109[_0x36b7fd(-0x24f,-0x1de,-0x1c0,-0x197)+'FW']||'')+'\x0a',_0x43649f+='下半身NSFW背面:'+'\x20'+(_0x1be109[_0x1cebca(-0x163,-0x1b2,-0x10d,-0x127)+_0x1cebca(-0x48,-0x41,-0x88,-0x49)]||'')+'\x0a',_0x43649f+=_0x7f971[_0x36b7fd(-0x2f2,-0x274,-0x327,-0x31a)],_0x43649f;}export async function handleCharacterPromptModify(_0x2b63f3,_0x220870=[]){function _0x4b69f9(_0x360b05,_0x3cd505,_0x37acf1,_0x534599){return _0x1e4a6c(_0x360b05-0x69,_0x37acf1,_0x37acf1-0x47,_0x534599-0x11c);}const _0x4d81e2={'vFwax':function(_0x30b9d8,_0x2ac199){return _0x30b9d8(_0x2ac199);},'oadpE':function(_0x3cda33,_0x1dfbdc){return _0x3cda33(_0x1dfbdc);},'brszr':'[character'+'PromptModi'+'fy]\x20Starti'+_0x2f7e11(0x1e1,0x28e,0x308,0x24c)+_0x2f7e11(0x113,0x1dc,0x17a,0x196)+_0x2f7e11(0x233,0x187,0x26c,0x233)+'uest...','cHnIC':function(_0x2bf6b1){return _0x2bf6b1();},'XtWLh':_0x4b69f9(0x1bc,0xfd,0x20f,0x1ad),'CzSSs':_0x2f7e11(0xd3,0xc0,0x86,0x129)+'PromptModi'+_0x4b69f9(0x1e6,0x1c1,0x298,0x212)+_0x2f7e11(0xfe,0x1e9,0x1fd,0x145),'YMDdd':_0x4b69f9(0x163,0xc2,0x205,0x12b)+_0x4b69f9(0x256,0x2c9,0x2ec,0x2ed)+_0x2f7e11(0x1a4,0x2b7,0x23b,0x22d)+_0x2f7e11(0x1ee,0x2ae,0x1e2,0x232)+':','KOkoI':_0x2f7e11(0xb1,0x194,0x1a6,0x129)+_0x4b69f9(0x256,0x25e,0x25a,0x1a7)+'fy]\x20Saved\x20'+_0x2f7e11(0x17a,0x20a,0x2d3,0x234),'HWPwl':function(_0x41688e,_0x3de125){return _0x41688e||_0x3de125;},'veMBZ':function(_0x50274c,_0x28c31d){return _0x50274c!==_0x28c31d;},'Hrkfh':_0x2f7e11(0x84,0x15d,0x106,0x111),'BiDPP':_0x4b69f9(0x163,0xae,0x11b,0xe5)+_0x4b69f9(0x256,0x1b7,0x2d5,0x25f)+'fy]\x20Charac'+'ter\x20trigge'+'r\x20text:','GnQln':function(_0x2cd9f5,_0x206256,_0x44d0d4){return _0x2cd9f5(_0x206256,_0x44d0d4);},'uidOA':function(_0x1bb830){return _0x1bb830();},'kFvJL':function(_0x44c88e){return _0x44c88e();},'LKWsR':_0x2f7e11(0x1db,0x11f,0xe4,0x129)+'PromptModi'+_0x2f7e11(0xe0,0xc0,0x1ac,0x15a)+_0x4b69f9(0x237,0x2f2,0x177,0x2d2)+_0x2f7e11(0x16f,0xe0,0x141,0x11d)+'ered):','VcVWE':function(_0x2ab1c5,_0x1f765c){return _0x2ab1c5(_0x1f765c);},'hdVRk':_0x2f7e11(0xf0,0x1b6,0x187,0x129)+_0x4b69f9(0x256,0x238,0x239,0x29e)+_0x4b69f9(0x1ae,0x156,0x17d,0x203)+'后:','EfWPM':_0x2f7e11(0x2ac,0x248,0x1b4,0x245),'OERPV':_0x4b69f9(0x163,0x1f6,0x183,0x19c)+_0x2f7e11(0x26b,0x1ec,0x26a,0x21c)+'fy]\x20User\x20r'+_0x2f7e11(0x1f3,0x170,0x227,0x17f)+_0x2f7e11(0x261,0x170,0x1ba,0x1b6)+'ndex:','ThXsZ':function(_0x3fb35a,_0x4098ce,_0x56d786,_0x2f8fcf,_0x42e007){return _0x3fb35a(_0x4098ce,_0x56d786,_0x2f8fcf,_0x42e007);},'eUMyD':_0x4b69f9(0x1ee,0x227,0x28d,0x154),'fYVWP':_0x4b69f9(0x163,0x21c,0xc8,0x17d)+_0x2f7e11(0x2bc,0x1ba,0x1d3,0x21c)+_0x2f7e11(0xe7,0x222,0x167,0x169)+_0x2f7e11(0x1ea,0x2a6,0x176,0x219),'KxHPr':function(_0xea40dc,_0x47adf8){return _0xea40dc>_0x47adf8;},'jLAPp':_0x2f7e11(0x81,0x48,0x95,0xf5),'TktWT':function(_0xf87203,_0x925e89){return _0xf87203>_0x925e89;},'YGLDi':function(_0x43e9ee,_0x496bed){return _0x43e9ee!==_0x496bed;},'myoiT':_0x4b69f9(0x21d,0x230,0x1d2,0x217),'NBSZB':_0x2f7e11(0x29e,0x29d,0x290,0x240),'bDNZD':_0x4b69f9(0x163,0x137,0x136,0x133)+'PromptModi'+_0x2f7e11(0x1d0,0x27e,0x1bb,0x1eb)+'ed','hViGB':'images\x20to\x20'+_0x2f7e11(0x1c4,0x296,0x1be,0x22b)+_0x4b69f9(0x230,0x1f0,0x25e,0x29e),'mZdjI':function(_0x34c65d,_0x2087c1,_0x571426){return _0x34c65d(_0x2087c1,_0x571426);},'eMpbQ':_0x4b69f9(0x163,0x114,0x1ae,0x18e)+'PromptModi'+'fy]\x20LLM\x20ou'+_0x4b69f9(0x283,0x274,0x31b,0x1c9),'TZeOb':'LLM\x20返回结果为空','aLqmS':function(_0x46b156,_0x11d80a){return _0x46b156===_0x11d80a;},'hdkav':_0x2f7e11(0x1a5,0xc5,0xbd,0x142),'bVDPP':_0x4b69f9(0x163,0x155,0x214,0xf8)+_0x4b69f9(0x256,0x1ae,0x288,0x2ab)+'fy]\x20Raw\x20LL'+_0x4b69f9(0x1cb,0x1a2,0x17a,0x221)+_0x4b69f9(0x1b2,0x1e8,0x10e,0x1fc)+_0x4b69f9(0x176,0x1ac,0x1df,0x1f3),'XIBAl':_0x4b69f9(0x163,0x1c5,0xc8,0xbe)+_0x2f7e11(0x226,0x222,0x1e6,0x21c)+_0x4b69f9(0x259,0x238,0x29e,0x2fb)+'ted\x20data:','gksSY':function(_0x1ee951,_0x3bb943,_0x2e7b12){return _0x1ee951(_0x3bb943,_0x2e7b12);},'VrXmz':'角色提示词修改完成！','KahYr':'[character'+_0x4b69f9(0x256,0x237,0x1f7,0x25d)+'fy]\x20Error:'};console[_0x2f7e11(0x2b5,0x20d,0x242,0x23c)](_0x4d81e2[_0x2f7e11(0x2d2,0x170,0x1b5,0x217)]);function _0x2f7e11(_0x19e5fe,_0x24cdd3,_0x1aa412,_0x216f6c){return _0x1e4a6c(_0x216f6c-0x2f,_0x19e5fe,_0x1aa412-0x1b4,_0x216f6c-0x71);}toastr[_0x4b69f9(0x206,0x221,0x25d,0x25f)]('[character'+_0x2f7e11(0x19c,0x195,0x2ad,0x21c)+_0x2f7e11(0x1d8,0x1ca,0x109,0x140)+'提示词修改请求...');try{const _0x2cc8da=_0x4d81e2[_0x2f7e11(0x1dd,0x227,0x2ac,0x24a)](getContext),_0x30a620=extension_settings[extensionName],_0x2cc416=getCurrentCharacterPreset();if(!_0x2cc416){toastr[_0x2f7e11(0x255,0x2cc,0x25f,0x21e)](_0x4d81e2[_0x4b69f9(0x228,0x21d,0x231,0x2cd)]);return;}console[_0x4b69f9(0x276,0x227,0x211,0x1b6)](_0x4d81e2[_0x4b69f9(0x1a6,0x1fa,0x1cb,0x1ae)],_0x2cc416['id']);const _0x3b878d=_0x2cc416[_0x4b69f9(0x26a,0x1b7,0x30d,0x30c)][_0x2f7e11(0x119,0x9d,0xf1,0x110)+_0x2f7e11(0x1bd,0x191,0x2bc,0x216)]||'',_0x32e0f6=_0x2cc416[_0x2f7e11(0x1cc,0x25f,0x22a,0x230)][_0x4b69f9(0x14a,0xc9,0x147,0x1b7)+_0x2f7e11(0xf8,0x241,0x255,0x1b3)]||'',_0x27c9c2=_0x2cc416[_0x2f7e11(0x287,0x266,0x26d,0x230)][_0x2f7e11(0xbf,0xa2,0x101,0x110)+'Variables']||{};console[_0x2f7e11(0x2b4,0x1b7,0x1e3,0x23c)](_0x4b69f9(0x163,0x168,0x221,0x1f8)+_0x4b69f9(0x256,0x271,0x27f,0x1bf)+_0x4b69f9(0x267,0x1ae,0x2c4,0x255)+_0x2f7e11(0x134,0x24c,0x264,0x1c3),_0x3b878d),console[_0x2f7e11(0x1d4,0x1b5,0x257,0x23c)](_0x4d81e2[_0x2f7e11(0x109,0x158,0x19f,0x12a)],_0x32e0f6),console[_0x4b69f9(0x276,0x2d0,0x311,0x1be)](_0x4d81e2['KOkoI'],_0x27c9c2);const _0x301f52=_0x4d81e2[_0x4b69f9(0x271,0x2dd,0x31c,0x276)](_0x2b63f3,''),_0x23befc=[];_0x2b63f3&&(_0x4d81e2['veMBZ'](_0x4d81e2['Hrkfh'],_0x4b69f9(0x14b,0xae,0x18b,0x181))?_0x4d81e2['vFwax'](_0x26075f,_0xb04ae0):_0x23befc[_0x4b69f9(0x209,0x282,0x203,0x2ba)](_0x2b63f3));_0x3b878d&&_0x23befc[_0x2f7e11(0x140,0x239,0x232,0x1cf)](_0x3b878d);_0x32e0f6&&_0x23befc['push'](_0x32e0f6);const _0xd31b34=_0x23befc[_0x2f7e11(0x13d,0xa7,0x103,0xfa)]('\x0a');console[_0x4b69f9(0x276,0x1ce,0x2e5,0x203)](_0x4d81e2['BiDPP'],_0xd31b34);let _0x81e8bd=_0x4d81e2[_0x4b69f9(0x1e4,0x16d,0x295,0x201)](buildPromptForRequestType,_0x2f7e11(0x26b,0x1cc,0x275,0x1c1)+'y',_0x301f52);const _0xdf60f5=_0x4d81e2[_0x2f7e11(0x117,0x185,0xd6,0x12e)](generateCharacterListText,_0xd31b34),_0x468d0a=_0x4d81e2[_0x4b69f9(0x18d,0x1c4,0x169,0x245)](generateOutfitEnableListText),_0x3d9acf=_0x4d81e2[_0x4b69f9(0x18f,0x1de,0x211,0x213)](generateCommonCharacterListText);console[_0x4b69f9(0x276,0x309,0x217,0x30a)](_0x4d81e2[_0x2f7e11(0x1d2,0x163,0xe4,0x15f)],_0xdf60f5);const _0x47f2c0=_0x2cc8da[_0x2f7e11(0x140,0x1f4,0x1cc,0x146)+'ta']?.['variables']||{},_0x4852ab=_0x4d81e2['VcVWE'](buildCharacterText,_0x2cc416);_0x81e8bd=_0x4d81e2['oadpE'](mergeAdjacentMessages,_0x81e8bd),console[_0x2f7e11(0x1bf,0x1a9,0x2e4,0x23c)](_0x4d81e2[_0x2f7e11(0x111,0xa4,0x3e,0xfb)],_0x81e8bd);const _0x225fef=findMessageIndexWithPlaceholder(_0x81e8bd,_0x4d81e2['EfWPM']);console[_0x2f7e11(0x22a,0x19f,0x1a2,0x23c)](_0x4d81e2['OERPV'],_0x225fef);const _0xd3b404={..._0x27c9c2,..._0x47f2c0},_0x4a2e4c={'context':_0x3b878d,'worldBookContent':_0x32e0f6,'variables':_0xd3b404,'userDemand':_0x4d81e2[_0x4b69f9(0x271,0x2bc,0x23a,0x25b)](_0x2b63f3,''),'characterListText':_0xdf60f5,'outfitEnableListText':_0x468d0a,'commonCharacterListText':_0x3d9acf},{messages:_0x251e2b,replacedVariables:_0x5cd16f}=replaceAllPlaceholders(_0x81e8bd,_0x4a2e4c);_0x81e8bd=_0x251e2b,_0x81e8bd=_0x4d81e2[_0x4b69f9(0x261,0x2be,0x1d3,0x2b8)](_0x23b5c1,_0x81e8bd,_0x4d81e2['eUMyD'],_0x4852ab,_0x5cd16f),console['log'](_0x4d81e2[_0x4b69f9(0x1a1,0x115,0x139,0x1cd)],_0x81e8bd);let _0x352762='';_0x4d81e2[_0x4b69f9(0x1f9,0x1f2,0x264,0x1c2)](_0x5cd16f[_0x2f7e11(0x1fd,0x12e,0x1ba,0x19c)],-0x44b+0x15*-0xa8+0x1*0x1213)&&(_0x4d81e2['veMBZ'](_0x4d81e2[_0x4b69f9(0x212,0x15c,0x177,0x161)],_0x4d81e2[_0x2f7e11(0x1f0,0x16c,0x234,0x1d8)])?(_0x1f0629[_0x4b69f9(0x201,0x250,0x220,0x259)]=_0x4201a9[_0x57c5f3],_0x4d81e2['oadpE'](_0x3d8a49,_0x32dba5)['trigger']('input')):_0x352762=_0x4b69f9(0x128,0x1ae,0x13f,0x182)+'被使用：'+[..._0x5cd16f]['join']('、')+'\x0a');if(_0x220870&&_0x4d81e2[_0x4b69f9(0x274,0x1bb,0x289,0x25b)](_0x220870['length'],0x1*0xf41+0x15d2+-0x1*0x2513)&&_0x225fef>=0x110d+0x1*-0x2b0+-0xe5d){if(_0x4d81e2['YGLDi']('pmRQo',_0x4d81e2[_0x2f7e11(0x18b,0x195,0xbc,0x11b)]))_0x81e8bd=attachImagesToMessage(_0x81e8bd,_0x225fef,_0x220870,_0x4d81e2['NBSZB']),console['log'](_0x4d81e2['bDNZD'],_0x220870[_0x4b69f9(0x273,0x244,0x22e,0x285)],_0x4d81e2[_0x2f7e11(0x132,0x262,0x21f,0x1e8)],_0x225fef);else{const _0x341f37=_0x4d81e2[_0x4b69f9(0x168,0xc1,0x140,0xdf)](_0x1786df,_0x3f4d44[0x31*0x15+0x467+0x5*-0x1af]),_0x253bfb=_0x4d81e2[_0x2f7e11(0x15e,0x169,0xfd,0x12e)](_0x45c3bc,_0x341f37);_0x253bfb&&_0x271643[_0x2f7e11(0x1f8,0x1d0,0xd5,0x173)]['push'](_0x253bfb);}}_0x4d81e2[_0x2f7e11(0x156,0x23d,0x226,0x1db)](updateCombinedPrompt,_0x81e8bd,_0x352762);const _0x3cc1a8={};_0x3cc1a8[_0x2f7e11(0x125,0x18f,0x1b0,0x113)]=0x493e0;const _0x5a80aa=await _0x4d81e2[_0x2f7e11(0x1f6,0x162,0x20f,0x1db)](LLM_CHAR_MODIFY,_0x81e8bd,_0x3cc1a8);console['log'](_0x4d81e2[_0x2f7e11(0xad,0x87,0x165,0xf3)],_0x5a80aa);if(!_0x5a80aa){toastr[_0x4b69f9(0x258,0x2bc,0x2b4,0x1ba)](_0x4d81e2[_0x4b69f9(0x16b,0x1e6,0x190,0x212)]);return;}const _0xa28564=_0x4d81e2[_0x4b69f9(0x1a2,0x17b,0x217,0x182)](extractCharacterTags,_0x5a80aa);if(_0xa28564['characters'][_0x2f7e11(0x20c,0x2d8,0x1ae,0x239)]===-0x108e*-0x2+0xa07+0x1b*-0x199){if(_0x4d81e2[_0x2f7e11(0x1a2,0xb5,0x7f,0x119)](_0x4b69f9(0x270,0x283,0x238,0x305),_0x4d81e2[_0x2f7e11(0x15e,0x26d,0x1ab,0x1f8)]))_0x307955[_0x4b69f9(0x209,0x1a6,0x1f6,0x254)](_0x43d400);else{toastr[_0x4b69f9(0x218,0x1d8,0x19b,0x19d)]('未在\x20LLM\x20输出中'+_0x2f7e11(0x1fe,0x267,0x21f,0x24b)),console[_0x4b69f9(0x276,0x2c4,0x1fc,0x299)](_0x4b69f9(0x163,0x1bb,0x1c0,0x1ad)+_0x4b69f9(0x256,0x2b6,0x2c1,0x307)+_0x4b69f9(0x19a,0x10b,0x1cd,0x190)+'racter\x20tag'+_0x2f7e11(0xed,0x14d,0x93,0x106)+_0x2f7e11(0x1e3,0x153,0x206,0x188)),console[_0x4b69f9(0x276,0x293,0x2ad,0x1fb)](_0x4d81e2['bVDPP'],_0x5a80aa);return;}}console['log'](_0x4d81e2[_0x2f7e11(0x200,0x119,0x182,0x1a4)],_0xa28564);const _0x3603a8=_0xa28564[_0x2f7e11(0x167,0x147,0x213,0x173)][0x2*-0x3c2+-0x5bd*-0x4+0x4c*-0x34];await _0x4d81e2[_0x2f7e11(0x272,0x1e9,0x294,0x251)](updateCharacterPresetFromLLM,_0x2cc416['id'],_0x3603a8),toastr['success'](_0x4d81e2[_0x2f7e11(0x1f2,0x1b7,0x181,0x149)]);}catch(_0x2c56f8){console[_0x4b69f9(0x258,0x21f,0x29a,0x300)](_0x4d81e2[_0x2f7e11(0x145,0x157,0x173,0x189)],_0x2c56f8),toastr[_0x2f7e11(0x1a9,0x268,0x286,0x21e)](_0x2f7e11(0xec,0x7e,0xc1,0x104)+'\x20'+_0x2c56f8[_0x2f7e11(0xf4,0xe7,0x1f9,0x195)]);}}async function updateCharacterPresetFromLLM(_0x346849,_0x163452){const _0xf6c762={'hUUQR':_0x42c894(0x516,0x574,0x4b9,0x4be),'HhNox':function(_0x2562b8,_0x51ddfc){return _0x2562b8===_0x51ddfc;},'gmiyv':'text','vXprd':_0x5d2f99(-0x309,-0x2e1,-0x2a2,-0x319),'MJbkj':'中文名称','XvCHc':'五官外貌','dkTPF':_0x5d2f99(-0x2a7,-0x323,-0x2b7,-0x3a4),'sZOZs':_0x5d2f99(-0x137,-0x1be,-0x175,-0x1d2),'qgzbp':'下半身SFW','vxdCM':_0x5d2f99(-0x273,-0x29f,-0x1ee,-0x2e5),'vzGOi':_0x5d2f99(-0x202,-0x1db,-0x1b6,-0x1c1),'fncwZ':function(_0x4f500b,_0x554bb2){return _0x4f500b===_0x554bb2;},'HDHXc':_0x5d2f99(-0x2f1,-0x282,-0x314,-0x2d5),'LaBDs':function(_0x256f97,_0x1d48b3){return _0x256f97!==_0x1d48b3;},'GoLty':_0x5d2f99(-0x229,-0x28f,-0x340,-0x211),'EyZyt':_0x5d2f99(-0x25b,-0x28e,-0x29f,-0x219),'ykBRO':function(_0x3d75da,_0xa8dae7){return _0x3d75da>_0xa8dae7;},'zoJKn':function(_0x258deb,_0x4a1c05){return _0x258deb(_0x4a1c05);},'KAQyZ':function(_0x4a369a,_0x406189){return _0x4a369a===_0x406189;},'FyLlY':_0x42c894(0x4f1,0x52a,0x5c3,0x4c2),'ajxCp':'NaBNj','ISITq':function(_0x2f9beb){return _0x2f9beb();},'sJPzD':function(_0x395e60,_0x21f287){return _0x395e60(_0x21f287);},'KlWrM':function(_0x268b04,_0x4ca9c7){return _0x268b04(_0x4ca9c7);}},_0x30a234=extension_settings[extensionName],_0x415da3=_0x30a234['characterP'+_0x42c894(0x4ed,0x56f,0x570,0x4c8)][_0x346849];if(!_0x415da3){toastr[_0x42c894(0x4fc,0x536,0x495,0x500)](_0xf6c762[_0x5d2f99(-0x23d,-0x2a4,-0x231,-0x31e)]);return;}let _0x3bae18=_0x42c894(0x4e9,0x468,0x464,0x506)+_0x346849+_0x5d2f99(-0x2a1,-0x2be,-0x299,-0x303);const _0x3fbb09={};_0x3fbb09[_0x5d2f99(-0x308,-0x2d6,-0x35a,-0x312)]=_0xf6c762[_0x42c894(0x44f,0x4d6,0x4a7,0x556)],_0x3fbb09['nameEN']=_0x42c894(0x5b5,0x53e,0x4b9,0x49b),_0x3fbb09[_0x5d2f99(-0x1dd,-0x295,-0x1fb,-0x280)+_0x5d2f99(-0x2d4,-0x2e9,-0x251,-0x394)]=_0xf6c762[_0x5d2f99(-0x264,-0x2b8,-0x36f,-0x240)],_0x3fbb09['facialFeat'+_0x5d2f99(-0x371,-0x2d2,-0x34d,-0x28c)]=_0xf6c762[_0x42c894(0x517,0x517,0x466,0x4cb)],_0x3fbb09[_0x5d2f99(-0x1d3,-0x219,-0x2c3,-0x1eb)+'FW']=_0xf6c762[_0x42c894(0x395,0x44f,0x4c4,0x4f0)],_0x3fbb09[_0x42c894(0x49e,0x518,0x568,0x528)+'FWBack']=_0x5d2f99(-0x19b,-0x1e4,-0x135,-0x1b4),_0x3fbb09['fullBodySF'+'W']=_0xf6c762[_0x5d2f99(-0x27f,-0x1f8,-0x233,-0x275)],_0x3fbb09[_0x42c894(0x4db,0x460,0x4d6,0x3c8)+'WBack']=_0x42c894(0x501,0x55c,0x53e,0x4ef),_0x3fbb09[_0x5d2f99(-0x227,-0x253,-0x1b7,-0x198)+_0x5d2f99(-0x262,-0x2f3,-0x374,-0x33b)]=_0xf6c762[_0x5d2f99(-0x355,-0x2ce,-0x32f,-0x37e)];function _0x42c894(_0x2ddebe,_0x1f96da,_0x1fa3ce,_0x5502d0){return _0x1e4a6c(_0x1f96da-0x347,_0x2ddebe,_0x1fa3ce-0xeb,_0x5502d0-0x76);}_0x3fbb09['upperBodyN'+'SFWBack']=_0xf6c762['vzGOi'],_0x3fbb09['fullBodyNS'+'FW']=_0x5d2f99(-0x25c,-0x2bc,-0x322,-0x2b8),_0x3fbb09[_0x42c894(0x52c,0x4b6,0x55b,0x53a)+_0x42c894(0x4cb,0x53b,0x536,0x53d)]=_0x42c894(0x4bc,0x493,0x4e0,0x43c);const _0x488ffb=_0x3fbb09;let _0x3d83b7=-0x2b*-0x2b+-0x438*-0x5+-0x1c51;for(const _0x2d594f in _0x488ffb){if(_0xf6c762[_0x42c894(0x44f,0x49d,0x515,0x4dd)](_0xf6c762[_0x42c894(0x3f9,0x401,0x378,0x416)],_0xf6c762['HDHXc'])){if(_0x163452[_0x2d594f]&&_0xf6c762[_0x5d2f99(-0x1e8,-0x20e,-0x175,-0x1c7)](_0x163452[_0x2d594f],_0x415da3[_0x2d594f])){const _0x48bf56=_0x415da3[_0x2d594f]||_0xf6c762['GoLty'],_0x5a4aaa=_0x163452[_0x2d594f];_0x3bae18+='•\x20'+_0x488ffb[_0x2d594f]+':\x0a',_0x3bae18+=_0x42c894(0x536,0x482,0x503,0x3cd)+_0x48bf56[_0x42c894(0x4bc,0x427,0x4e1,0x4c8)](0xb48+-0x2617+0x1acf,-0x1*-0x2bf+-0x2706+0x2479)+(_0x48bf56[_0x5d2f99(-0x1a9,-0x1e0,-0x17f,-0x1bd)]>-0x237c+0x2011+0x39d?_0xf6c762['EyZyt']:'')+'\x0a',_0x3bae18+='\x20\x20新:\x20'+_0x5a4aaa[_0x5d2f99(-0x3a6,-0x30a,-0x323,-0x2c0)](-0x4cd*-0x8+0x11*0x1c+-0x35b*0xc,-0x1116+0x75*0x29+-0x175)+(_0xf6c762[_0x5d2f99(-0x3a8,-0x33a,-0x3d7,-0x2af)](_0x5a4aaa['length'],-0x111c+-0x133a+0x2488)?_0xf6c762[_0x5d2f99(-0x1af,-0x227,-0x21a,-0x197)]:'')+'\x0a\x0a',_0x3d83b7++;}}else{_0x16afda[_0x5d2f99(-0x2b1,-0x1fb,-0x281,-0x213)](_0xf6c762['hUUQR']);return;}}if(_0x3d83b7===0x102c+0x8f*0x13+0x1*-0x1ac9){toastr[_0x5d2f99(-0x28b,-0x24d,-0x248,-0x2b6)]('没有检测到需要更新的'+'内容');return;}_0x3bae18+='共\x20'+_0x3d83b7+'\x20项更改,是否应用?';const _0x1208cd=await _0xf6c762[_0x42c894(0x594,0x56b,0x552,0x4b2)](stylishConfirm,_0x3bae18);function _0x5d2f99(_0x43e1bc,_0xf9c328,_0x1f5cb3,_0x5c5b8a){return _0x1e4a6c(_0xf9c328- -0x3ea,_0x1f5cb3,_0x1f5cb3-0x181,_0x5c5b8a-0x1e4);}if(!_0x1208cd){toastr[_0x42c894(0x472,0x4e4,0x541,0x528)](_0xf6c762[_0x42c894(0x3bf,0x3fe,0x498,0x458)]);return;}for(const _0xc11827 in _0x488ffb){if(_0xf6c762[_0x5d2f99(-0x1a9,-0x20c,-0x202,-0x186)](_0xf6c762[_0x42c894(0x58f,0x53d,0x56e,0x5ae)],_0x42c894(0x501,0x489,0x4cb,0x468))){if(_0xf6c762[_0x42c894(0x493,0x41f,0x3b5,0x42d)](_0x5554ec[_0x42c894(0x415,0x447,0x4d0,0x396)],_0xf6c762[_0x42c894(0x56d,0x4ef,0x52e,0x4f1)])&&_0x5cd44f[_0x42c894(0x4b1,0x4aa,0x437,0x4ad)][_0x5d2f99(-0x146,-0x1f1,-0x204,-0x237)](_0x49df85))return _0x510d52;}else{if(_0x163452[_0xc11827]){if(_0xf6c762['ajxCp']!==_0x42c894(0x4fa,0x4d3,0x4e4,0x4aa)){_0x361a7d[_0x42c894(0x43c,0x4e4,0x509,0x4f7)](_0xf6c762['vXprd']);return;}else _0x415da3[_0xc11827]=_0x163452[_0xc11827];}}}_0xf6c762[_0x42c894(0x4bd,0x50d,0x4fd,0x529)](saveSettingsDebounced);const _0x2326f0=_0xf6c762[_0x42c894(0x584,0x56b,0x4bf,0x4ec)]($,_0x42c894(0x408,0x4b0,0x458,0x42e)+_0x42c894(0x3f3,0x43f,0x482,0x3ee)+_0x5d2f99(-0x275,-0x23f,-0x18a,-0x215));_0x2326f0[_0x42c894(0x5c5,0x551,0x544,0x573)]&&_0xf6c762[_0x5d2f99(-0x286,-0x244,-0x229,-0x240)](refreshCharacterSettings,_0x2326f0),_0xf6c762[_0x5d2f99(-0x1d3,-0x23c,-0x27a,-0x194)](updateFormFields,_0x163452),console['log'](_0x42c894(0x4e6,0x441,0x42a,0x4fd)+_0x5d2f99(-0x1b5,-0x1fd,-0x17d,-0x1df)+_0x42c894(0x365,0x425,0x3b3,0x3ae)+_0x42c894(0x515,0x547,0x4c1,0x5a4)+_0x346849+'\x22');}function updateFormFields(_0x44b50a){const _0x309fb5={'jzkQU':function(_0xb42ded,_0x3c475f){return _0xb42ded===_0x3c475f;},'TAlNx':_0x14eb56(-0x171,-0x1b3,-0x122,-0x117),'QOXUh':function(_0xc4ed31,_0x196b07){return _0xc4ed31===_0x196b07;},'lbEiO':_0x260e0b(0x77,0x37,0xbe,0x15d),'IljbN':_0x14eb56(-0x1e4,-0x183,-0x1b8,-0xdf),'TwrHt':function(_0x40db69,_0x4a0710){return _0x40db69(_0x4a0710);},'WkyVe':_0x14eb56(-0x15f,-0x15a,-0x17b,-0xb4),'dBRDz':_0x14eb56(-0x160,-0x117,-0x68,-0x129)+_0x260e0b(0xb4,0x101,0xc6,0x71),'znRne':_0x260e0b(0xaa,0x167,0x11a,0x194)+_0x14eb56(-0x143,-0x154,-0x103,-0xef),'xPXwf':_0x260e0b(0xe7,0x134,0x196,0x24d)+'FW','pDFVG':_0x14eb56(-0x3f,-0x9b,-0xaf,-0xa3)+_0x260e0b(0x147,0x201,0x1b9,0x1e6),'gysuz':_0x260e0b(0xda,0x16e,0xde,0x10f)+'W','ahvNs':_0x260e0b(0x11c,0xea,0xde,0x75)+'WBack','ZlqPZ':'upperBodyN'+'SFW','Aynxp':_0x14eb56(-0xe0,-0xd5,-0x175,-0x111)+_0x14eb56(-0xa1,-0x59,-0xe0,-0xfe),'zgSaw':_0x260e0b(0xe5,0x92,0x134,0x1b6)+'FW','yAgrM':'fullBodyNS'+_0x260e0b(0x181,0x102,0x1b9,0x240)};function _0x14eb56(_0x1d8066,_0x4b09f9,_0x2edc74,_0x2a4e50){return _0x1e4a6c(_0x4b09f9- -0x26c,_0x2edc74,_0x2edc74-0x195,_0x2a4e50-0xb6);}function _0x260e0b(_0x591fde,_0x3e4a1b,_0x4347f1,_0x387793){return _0x1e4a6c(_0x4347f1- -0x3b,_0x387793,_0x4347f1-0x155,_0x387793-0x5c);}const _0x204b2a=[_0x260e0b(0xaa,0x50,0xd9,0x16a),_0x309fb5['WkyVe'],_0x309fb5[_0x14eb56(-0x190,-0x15e,-0x1d1,-0xfb)],_0x309fb5[_0x260e0b(0x1f,0x19,0x9b,-0x1)],_0x309fb5['xPXwf'],_0x309fb5[_0x260e0b(0x111,0xac,0x8e,0x148)],_0x309fb5[_0x14eb56(-0x10c,-0xde,-0x82,-0x4f)],_0x309fb5[_0x14eb56(-0x175,-0x10e,-0xb0,-0x19f)],_0x309fb5[_0x260e0b(0x9c,0x42,0x92,0x6a)],_0x309fb5[_0x260e0b(0x165,0x105,0x1a5,0x241)],_0x309fb5[_0x260e0b(0xd4,0xa,0x96,-0x1)],_0x309fb5[_0x14eb56(-0x1cc,-0x186,-0x1ae,-0x19a)]];_0x204b2a[_0x260e0b(0xab,0x88,0xfa,0x56)](_0x793175=>{function _0xa6ea40(_0x1f3586,_0x3827b4,_0x479960,_0x20a34b){return _0x260e0b(_0x1f3586-0x10,_0x3827b4-0x74,_0x1f3586- -0x348,_0x20a34b);}function _0x50bced(_0x324521,_0x17175e,_0x18b756,_0x236a78){return _0x260e0b(_0x324521-0x4c,_0x17175e-0x59,_0x236a78-0x19d,_0x17175e);}if(_0x309fb5['jzkQU'](_0x309fb5[_0x50bced(0x2a4,0x2d3,0x2a1,0x2ed)],_0x309fb5[_0x50bced(0x242,0x294,0x265,0x2ed)])){if(_0x44b50a[_0x793175]){if(_0x309fb5[_0x50bced(0x2cb,0x2d1,0x394,0x33d)](_0x309fb5['lbEiO'],_0x309fb5[_0x50bced(0x257,0x36b,0x382,0x2f5)]))_0x37717d[_0x37a60f[_0x328226]]=_0x5702dc;else{const _0xf30821=document[_0xa6ea40(-0x184,-0x115,-0x22a,-0x227)+_0x50bced(0x2b0,0x1fa,0x1e6,0x28f)](_0xa6ea40(-0x160,-0x182,-0x198,-0x17a)+_0x793175);_0xf30821&&(_0xf30821[_0xa6ea40(-0x1eb,-0x1d2,-0x1fe,-0x257)]=_0x44b50a[_0x793175],_0x309fb5['TwrHt']($,_0xf30821)[_0x50bced(0x2da,0x1ad,0x199,0x225)](_0xa6ea40(-0x218,-0x1a1,-0x178,-0x285)));}}}else _0x4c1fe=_0xa6ea40(-0x2c1,-0x354,-0x306,-0x236)+_0x50bced(0x328,0x27a,0x2b0,0x307)+'4,'+_0x34b84a;});}