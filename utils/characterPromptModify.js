(function(_0x2cc3a9,_0x3edda1){const _0x52cb30=_0x2cc3a9();function _0x40d94b(_0x5581c2,_0xd94220,_0x49f7e2,_0x33b9be){return _0x2238(_0x33b9be- -0x3e8,_0x5581c2);}function _0x2f11f6(_0x49749c,_0x318356,_0x3066b7,_0x3e70c8){return _0x2238(_0x3066b7- -0x201,_0x318356);}while(!![]){try{const _0x21d28b=parseInt(_0x40d94b(-0x336,-0x3df,-0x3d2,-0x30e))/(-0xb71+-0x1327*0x2+0x31c0)+parseInt(_0x40d94b(-0x21a,-0x236,-0x21c,-0x2d7))/(-0x1*-0x102f+-0x1*0x750+-0x8dd*0x1)+parseInt(_0x2f11f6(-0x5b,-0xd5,0x0,-0x21))/(-0x20d3*0x1+-0x1*0x244d+-0x1*-0x4523)+-parseInt(_0x40d94b(-0x1e0,-0x1b4,-0xed,-0x16b))/(0x202f+-0x8*0x1b8+-0x126b)*(parseInt(_0x2f11f6(-0x73,-0x1fe,-0x145,-0x12e))/(0x1900+-0x2*0xfce+0x6a1))+-parseInt(_0x40d94b(-0x1cd,-0x1d5,-0x1c1,-0x21d))/(-0xf9*-0x1+0x1715+-0x1808)+-parseInt(_0x40d94b(-0x24c,-0x1f3,-0x207,-0x16a))/(0x19af+-0x544+-0x1464)+parseInt(_0x40d94b(-0x2f8,-0x2b3,-0x266,-0x257))/(-0xa74+0x6*-0x1f+-0x5*-0x23e)*(parseInt(_0x2f11f6(-0x14f,-0x3,-0xb0,-0x9b))/(0x1*-0x25eb+0x11*-0x1ab+0x61*0xaf));if(_0x21d28b===_0x3edda1)break;else _0x52cb30['push'](_0x52cb30['shift']());}catch(_0xae74c8){_0x52cb30['push'](_0x52cb30['shift']());}}}(_0x4512,-0x19b86+0x1*-0x23df5+-0x68f*-0x1b4));const _0x26a3fe=(function(){let _0x5397ab=!![];return function(_0x2477f1,_0x24b0d4){const _0x51161a=_0x5397ab?function(){if(_0x24b0d4){const _0x52bc1e=_0x24b0d4['apply'](_0x2477f1,arguments);return _0x24b0d4=null,_0x52bc1e;}}:function(){};return _0x5397ab=![],_0x51161a;};}()),_0x1dd326=_0x26a3fe(this,function(){function _0x3f6b55(_0xcace5f,_0x3831b5,_0x3c9f08,_0x18ab67){return _0x2238(_0x18ab67-0x2d0,_0x3c9f08);}const _0x2b3291={};_0x2b3291[_0x3f6b55(0x36e,0x377,0x4e9,0x42f)]=_0x33f656(0x312,0x35e,0x2c4,0x231)+'+$';function _0x33f656(_0x26a4c4,_0x11999e,_0x1c00e4,_0x49b3f6){return _0x2238(_0x26a4c4-0x1f2,_0x49b3f6);}const _0x161203=_0x2b3291;return _0x1dd326['toString']()[_0x33f656(0x373,0x3c1,0x45d,0x442)](_0x33f656(0x312,0x2cc,0x2ea,0x2e4)+'+$')[_0x3f6b55(0x578,0x52a,0x573,0x48c)]()[_0x3f6b55(0x50a,0x57d,0x517,0x49e)+'r'](_0x1dd326)[_0x33f656(0x373,0x342,0x2e3,0x343)](_0x161203[_0x3f6b55(0x376,0x4bc,0x443,0x42f)]);});_0x1dd326();function _0x4512(){const _0x3c15c0=['wNrRAu0','Ewn1t1O','CMvWBgfJzufSBa','AMviwhC','Dg9tDhjPBMC','C1r0suC','y0Lfwvm','t0rjrLLFuKvtua','ufjptvbux1jfuW','D1fyB08','Dg9mB3DLCKnHCW','Duvkww4','wLrIr0y','6iUX5PAh5zcn56EW','wKXArvG','BMfTzuno','5lIk5y2k6lQRu0zx6iom6z2IoIa','zxH0','yxvbtuy','mZe1mdm5mhDIwhjpqG','teXnioIVT+AXGUwKSEI0Pq','Aw5KzxHpzG','y29UC3rYDwn0BW','A0zPtwe','5A6m5OIq77Yb','BwvZC2fNzq','DNPtDMm','sM5dEfu','DwvZDc4UlG','zNLDifjHDYbmta','CMznBui','i3n0lwnOyxr1oa','rwj1uhe','BMfTzuvo','6kEs6iMY54M55B6boIa','C3vIC3rYAw5N','zgf0yq','ue5iCxC','zgLHuKm','A2nhrNG','BfjbtM4','wfD4zKi','zNvSBejVzhK','rercvKK','vg9Mq2e','AhrgvuK','zNLDienOyxjHyW','uhjVBxb0tw9KAq','5PYQ5zYOieXmtsdOVPpLH7RKUk0','DLLxvwy','ywnR','zNvSBejVzhLcyq','zxHLyW','C09JugS','5lIl5y2k6lQRtLngvZOG','zNLDiev4DhjHyW','t2rdDvq','B3v0zML0rw5HyG','Evzsq2q','DxbWzxjcB2r5','y29UDgvUDa','DKD3r1q','zgDpvxO','DKXzDva','zNLDie5VignOyq','AfnStMK','zwDpCuK','tfH2C1G','DxnZAue','DxvnzM0','B3v0zML0','C3bSAxq','D29esKC','mtKWmdC4mK1vDwTpCa','5Qoa5Rwl5yIW6kEs6iMYici','seLiBuq','s05OueO','qMTIALa','zgf0ytPPBwfNzq','Axn0vgv4Da','Cg9ZAxrPB24','Cgvmve8','yMXYAM8','vKTWCxy','B3DUzxi','uMnrD2i','t2P6A00','C2L6zq','wg1fuK0','zwferey','uwLzrha','zLLnA08','tLfKtha','C3rHCNrZv2L0Aa','yMfZzty0','uM5gww0','rLbtCfa','y2HHCMfJDgvYva','DxnLCKrLBwfUza','iIdLT7lLVzlLSz7LIldOP5lOIBiGiG','Dgv4Da','ue9ou0u','Agnds3a','DMHdA1O','5lIT5PAh5zcn56EW','B2jQzwn0','CMvXDwvZDcaOsq','rNHAz2W','CMvWBgfJzq','DhjPz2DLCG','5lIk5y2k6lQR','AwDtz0S','wvr3r2m','wK9fEhq','5lIk5y2k6lQRtLngv+IdJoMDOJO','wxPAzxa','5lIl5y2k6lQRtLngv+IdJoMDOJO','uvP2AgG','z0njEe8','t2DbCKW','5lIk5y2k6lQRtLngvW','Aw9oBKG','tsbVDxrWDxqGzG','C2Xoquu','ANblrM4','zNDlu0i','tKf0sxa','vKTXD1q','sfvdC2u','EM5LqNa','AKXgr2K','ChjVBxb0oG','wgHHzMi','Dgv6sxK','ig1LC3nHz2uGAq','B1jUr2y','5O+q56s66k+n5l+U5Ps56k+35RgclI4U','DwPkz0S','v3DPuMK','Aw5MBW','DgfkuvG','tMLyt2S','rMzJCKW','AfLsz1u','CNruExa','B250zw50','B3v0zML0uhjLCW','ug5WAMm','ExjovuS','z2v0rwXLBwvUDa','5lIl5y2k6lQRtLngv+IdJoMDOG','DxjLCW','y2HhDKu','tgnnru4','y2HHCMfJDgvYua','vNbOs3O','5lIk5y2k6lQR6iom6z2I','vwvqs1y','5lQu5A6y5Asw6lkm6iom6z2IoIa','zNvSBejVzhLouW','zNLDiow3SUwiM+w7UUACJEIJHEMIHa','zNLDief0DgfJAa','CIb0zxH0oG','EKn5DMq','5Qoa5Rwl5yIW5PYn6kofici','zxH0icH0CMLNzW','BwvZC2fNzsbHDa','BNDJAfm','tMPdzLO','q01usvu','C29YDa','zNLDiev4zwn1Da','C3vJy2vZCW','5y+c6icd5zU+54Mh','5lQu5A6y5Asw6lkm6iom6z2I','zNLDien1CNjLBG','AvvfCe4','DMfSDwu','u3HJz1K','ExnYsg0','A2PRreO','yvDrreS','zw1PDa','5lIl5y2k6lQRu0zx6iom6z2I','zNLDioACQUIVHUwiQ+EAHoACJEIJHq','5lIk5y2k6lQRu0zxoIa','D2fYBMLUzW','zvrbv2y','Aw5JBhvKzxm','zfPUqNG','r2noyNm','rgTAAKm','D29YBgrcB29RqW','sxfMuMS','wM9fAfm','5lIl5y2k6lQR6iom6z2I','sgnewe8','mti2ofHVwLfzuW','mta0ntfHALLUq2u','sxzzwLq','5lIk5y2k6lQRu0zx6iom6z2I','AgPMBuG','Aunpzwm','DvPTuwG','B1bmAxa','5PwW5O2UoG','qLnfzwm','qurKrue','5Rgc6lAf5PE2','wNDKvNq','y3rLCG','v05nufi','DxbWzxjcB2r5qG','DMfYAwfIBgvZ','zNLDifjLCxvLCW','CMvZzxrZ','q1nlvwK','y1jJq0u','vuvtva','u0zx','5A2x5Q61ici','rLDcywnR','whfyyuG','C21oy24','EfrczK4','q29UDgv4Da','y29UDgv4DdO','w2nOyxjHy3rLCG','vM5lzee','DhjPBq','CMzwyNO','BKDmqwi','ywrK','mtm4nJvzyKfku3e','ChjVBxb0','rLvoywq','igLUzgv4','EKL4t0u','A0Xfthi','zNvSBejVzhLtrG','A1PUsNC','CMfUzg9T','wenAEfy','zxjYB3i','BMrLEdO','DMfYAwfIBgvZoG','Aw1Hz2vZihrVia','Ahjts2y','Dev2sfi','s3HmEKC','y1zgwuy','6i635y+w6kEs6iMY5l+U5Ps55O+q56s66k+n6lAf','qLPwD3C','y1vYywW','BgvmAxn0vgv4Da','zKjnBgC','D2fnuMO','A0TMCMi','uLbfruq','yMvZrLC','zxjLzcK6','ENL6AhO','yxbWBhK','mZKXntK3D1f3A1be','Exj2Cwm','D3j4z1e','y3D5Efe','rwzPAgm','ww9qzKe','wfvStMO','Dhb1Da','s3zuvhC','z3DyD2u','zxiGChjVBxb0ia','uwTPq2W','DhLWzq','Bw9KAwz5ihbYBW','B3v0zML0CW','E3VNLkJMIlFPNidMSyj9Fq','q0jHCuu','qxfeBw0','pos6UUEjQt4k','vxvfD0q','iIdMNiKG','zgf0ytO','A2XKthO','wgrMque','Bhzozxq','6k+35ywi6ycj5OUP5lIa5lIQ6kEs6iMY6Ake6k6+','CMfUzg9Tvvvjra','zML0ihrHz3mGzG','6kEs6iMY5O+q56s66k+n5l+U5Ps55AsX6lsLoG','teXnx0niqvjFtq','DgLTzw91De1Z','qMDlrLy','zNLDifvZzxiGCG','5lQu5A6y5Asw6lkmoIa','Agzdt20','A2z0r2e','zwL6Bei','rgL0Awu','zNLDiow3SUABToAwSoACJEIJHEMIHa','Aw5WDxq','yxDiDMi','vMfYAwfIBgvZ','AuDMrNi','6kEs6iMY54M55B6b','D1zUs1i','uMflCMW','uwnrEMS','zNLDioACJEIJHsaI','y1HlzeS','v29YBgrcB29R','wNLotg0','zMLSDgvY','zw50CMLLCW','y2HHCMfJDgvY','5BEY5y+w5RAi5PU05PAW','mtm2oti4nMTwteLVzG','z2D2tKq','uuvMu0C','qKLmv0W','l3bUzZTIyxnLnG','zMf0A3e','5lQu5A6y5Asw6lkm','y25LC0S','twrkv0u','zhPbEhm','tLfVuuS','DxfNDK4','rvrKzg4','E3VLVzpLIy3OP5lOIBj9Fq','vMf1rLq','kcGOlISPkYKRkq','BLHQsLG','uLH1svO','sLDVEvq','Bg9N','BvHeDfi','zxrZ','CMPqA3u','zwPxvwG','DgvYigXPC3qGDa','t05trq','zNLDioATO+wCQowKHoEqHUINKUIjSG','ioMHUEABToAuUsZMMk/LKkBLUPtNLkG/','tKrgreC','qvzTs1u','D2DOyKm','DvnjuwO','DxbWzxjcB2r5uW','DxjLC0jHy2S','zM1QEfO','AeDmENi','ChvZAa','Aw5KzxG','whvVDuS','5lIl5y2k6lQRu0zx6iom6z2IoIa','y2HHCL8','Bu1du24','r3HruNa','zeTxsey','rvjruhe','sNLVufy','zw5LCG','vwXzDva','6kEs6iMY5l+U5Ps5ieXmtsdOR7C','BMfTzq','teXnioI/LowBNUE7K+AENos4UUEPUG','uw96C2m','5OM+5lIn5yIW5OYh5A6A55Qe6kEs6iMY6Ake6k6+','BvrjBwq','uKLXrfG','CMvTB3zLtgLZDa','AM9PBG','Efvdsuu','A0Peue0','z291Bgy','r1n1sxy','AxnbCNjHEq','yMzLs04','Ew5gAuu','nJa3ntLlCMHPC20','Bwf0y2HLze91Da','Bw9KAwz5ihjLCq','BwfW','rvLsBgu','B3vUzcbPBIbVDq','C1f1zwG','AuDVuxu','ANPJAei','DxbWzxjcB2r5tG','5lIl5y2k6lQRu0zx','CMfJDgvYl291Da','AM1OwNi','q1fjsxC','ru9VBNu','tvbfy3m','uvbHBg4','uKn6z2W','zM9YrwfJAa','uwTZthC','A3HXy0u','5lIl5y2k6lQRu0zxoIa','5lIl5y2k6lQR','BMfPDxC','6k+k5PAT77YA5Qoa5Rwl5yIW5lUL5lIl5y+y6yEp','DMPgyKK','DcbWCMvZzxq6','yNvpt0O','tKfNq2W','qNLjza','iIdMSQhMNiNLJ5JMM7q','y25xwLy','q3vuuue','5lIk5y2k6lQRtLngv+IdJoMDOG','DgLUzYbJAgfYia','y05JELm','v2DStNu','zw5krui','u0zxqMfJAW','zNLDiezPBMfSia','t09ks28','uerptwe','rvnu','EePAu2q','D29YBgqGyM9VAW','6k6+ici','y2HHCL9TB2rPzG','5B2s5BgE5lQ6','C2vHCMnO','t1Lty1q','CMfPDhm','v0jHy2S','qwXkuxi','5lIl5y2k6lQRtLngvW','tNLvEK0','AwLmvLG','DgvYihrYAwDNzq','BxLRre0','Du9wwgy','DgvKigrHDge6','q1bmt1q','C01IrK8','zML0CW','C3rYAw5N','mJa4twnJwuPV','y2HHCMfJDgvYCW','5Qoa5Rwl5yIW6kEs6iMY5OIw5PYn6kof5Qch562+','DxjS','Aw1Hz2vFDxjS','CM9RDw0','DgrrCNK','yKDUDw0','s2X4qM0','BgvUz3rO','Dhb1DdO','qwnxBuK','tvnmsw0','zNLDioACQUIVHUwiQ+EAHos6UUEjQq','6kkR5l2/55sO77YA','CMvZDwX0','vMrYrvG','t0rjrLLFr0vuxW','zvbmv1y','B2rPzNKGteXnia','5lIk5y2k6lQRu0zx','y29TBw9Uq2HHCG','zNLDifn0yxj0Aq','EfbgywS','zMfJAwfSrMvHDa','lxrHyI1JAgfYyq','tgniEgK','zNLDifnHDMvKia','yxv0BW','D2zjtMy','rgngBfK','q29vDfO','wwnbBw4','y3n3Cfa','pc/KURRNIAK+','BMC6','vxjKrKO','iIZMMk/LKkBLVzxLHAu/','DNPYs1u'];_0x4512=function(){return _0x3c15c0;};return _0x4512();}import{eventSource}from'../../../../../script.js';import{eventNames,extensionName}from'./config.js';import{extension_settings}from'../../../../extensions.js';import{getContext}from'../../../../st-context.js';import{saveSettingsDebounced}from'../../../../../script.js';import{generateCharacterListText,generateOutfitEnableListText,generateCommonCharacterListText}from'./settings/worldbook.js';import{updateCombinedPrompt}from'./settings/llm.js';function _0x2238(_0x15b3ae,_0x370a29){_0x15b3ae=_0x15b3ae-(-0x1*-0xf25+-0x70e+-0xe*0x88);const _0xedd3d7=_0x4512();let _0x2d7724=_0xedd3d7[_0x15b3ae];if(_0x2238['ToDmAD']===undefined){var _0x125907=function(_0x4df90f){const _0x1dad3f='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x30b004='',_0x584cfa='',_0x3302df=_0x30b004+_0x125907;for(let _0xeb8472=0x187b+-0x25b3+0xd38,_0x312bf3,_0x254f97,_0x491241=0x247f+-0x5c1+-0x1ebe;_0x254f97=_0x4df90f['charAt'](_0x491241++);~_0x254f97&&(_0x312bf3=_0xeb8472%(0x1219+-0x261+-0xfb4)?_0x312bf3*(0x2402+-0x551*0x1+0x1*-0x1e71)+_0x254f97:_0x254f97,_0xeb8472++%(-0x25d6+-0xfd9*0x1+-0x3b*-0xe9))?_0x30b004+=_0x3302df['charCodeAt'](_0x491241+(0x25*0x11+-0xd12+0x3*0x38d))-(-0x1*-0x1ca3+-0x43*0x59+-0x54e)!==-0x9*-0x2bc+0x1779+0xb*-0x45f?String['fromCharCode'](-0x1*0x216d+-0x2b6+0x2522&_0x312bf3>>(-(0xc5b*0x2+-0x75c+-0x8*0x22b)*_0xeb8472&0x1c18+-0x13e2+0x830*-0x1)):_0xeb8472:-0x1701+0x7*-0x1d5+0x23d4){_0x254f97=_0x1dad3f['indexOf'](_0x254f97);}for(let _0x38f419=0x14f*0x13+0x2*0x462+-0x1*0x21a1,_0xed367b=_0x30b004['length'];_0x38f419<_0xed367b;_0x38f419++){_0x584cfa+='%'+('00'+_0x30b004['charCodeAt'](_0x38f419)['toString'](0x5*0x47+-0x1067+0xf14))['slice'](-(0x9f2+-0x1c19+0x1229));}return decodeURIComponent(_0x584cfa);};_0x2238['nhAyDO']=_0x125907,_0x2238['XGNMay']={},_0x2238['ToDmAD']=!![];}const _0x3e43c3=_0xedd3d7[-0xb0b*0x3+0x5f2*-0x4+0x38e9],_0x44c8b9=_0x15b3ae+_0x3e43c3,_0x1e1d27=_0x2238['XGNMay'][_0x44c8b9];if(!_0x1e1d27){const _0x1bbf80=function(_0x4ba84b){this['bpXtha']=_0x4ba84b,this['cthRNx']=[0x1*0x1dd5+-0x3*-0x746+-0x4b2*0xb,0xc*0xcd+-0x8af+-0xed,-0x6fa+0x191c+-0x1a6*0xb],this['WQncwF']=function(){return'newState';},this['VOKzix']='\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*',this['llUNnb']='[\x27|\x22].+[\x27|\x22];?\x20*}';};_0x1bbf80['prototype']['ffpkGM']=function(){const _0x23b900=new RegExp(this['VOKzix']+this['llUNnb']),_0x1a479d=_0x23b900['test'](this['WQncwF']['toString']())?--this['cthRNx'][0x2560+-0x11cb*0x1+-0x1394]:--this['cthRNx'][0x2bb*-0x5+-0x193a+-0x1*-0x26e1];return this['hkPLaj'](_0x1a479d);},_0x1bbf80['prototype']['hkPLaj']=function(_0x5f5c28){if(!Boolean(~_0x5f5c28))return _0x5f5c28;return this['kkITJb'](this['bpXtha']);},_0x1bbf80['prototype']['kkITJb']=function(_0x4ef98c){for(let _0x46463f=-0x1ce6+0x1af1+-0x1f5*-0x1,_0x26832b=this['cthRNx']['length'];_0x46463f<_0x26832b;_0x46463f++){this['cthRNx']['push'](Math['round'](Math['random']())),_0x26832b=this['cthRNx']['length'];}return _0x4ef98c(this['cthRNx'][-0x9f5*0x1+0x5*0x7c6+-0x1ce9]);},new _0x1bbf80(_0x2238)['ffpkGM'](),_0x2d7724=_0x2238['nhAyDO'](_0x2d7724),_0x2238['XGNMay'][_0x44c8b9]=_0x2d7724;}else _0x2d7724=_0x1e1d27;return _0x2d7724;}import{buildPromptForRequestType}from'./settings/llmService.js';import{refreshCharacterSettings}from'./settings/character/index.js';import{stylishConfirm}from'./ui_common.js';import{mergeAdjacentMessages,replaceAllPlaceholders,replacePlaceholder as _0x2eeb87}from'./promptProcessor.js';function replacePlaceholder(_0x5ae2f5,_0x3d6c00,_0x3f1782,_0x14e6b5){const _0xbba80e={};_0xbba80e[_0x5adf54(-0xb8,-0x187,-0xef,0x33)]=function(_0x343d73,_0x5bcbfa){return _0x343d73===_0x5bcbfa;},_0xbba80e[_0x523a88(0x415,0x4af,0x442,0x486)]=_0x523a88(0x5de,0x48a,0x544,0x4f7),_0xbba80e[_0x523a88(0x607,0x57c,0x5b5,0x576)]=function(_0x4fb5b5,_0x5d5974){return _0x4fb5b5===_0x5d5974;},_0xbba80e[_0x5adf54(-0xb5,-0x4f,-0x12c,-0xec)]=_0x523a88(0x3f9,0x4dd,0x3ea,0x44e);const _0x464885=_0xbba80e;if(_0x464885[_0x523a88(0x3cb,0x419,0x48a,0x49f)](typeof _0x5ae2f5,_0x523a88(0x45d,0x4ba,0x423,0x4d2)))return _0x3f1782&&_0x5ae2f5['includes'](_0x3d6c00)&&(_0x14e6b5&&_0x14e6b5[_0x523a88(0x498,0x315,0x382,0x3fd)](_0x3d6c00)),_0x5ae2f5[_0x5adf54(-0x5b,-0x123,0x92,-0xc8)](_0x3d6c00,_0x3f1782);function _0x5adf54(_0x3af3a6,_0x313436,_0x302827,_0x239546){return _0x2238(_0x3af3a6- -0x215,_0x239546);}if(Array[_0x5adf54(-0xc7,0x13,-0x10,-0x171)](_0x5ae2f5)){if(_0x464885[_0x523a88(0x4cd,0x438,0x570,0x486)]===_0x5adf54(-0x3d,0x28,-0x5f,-0x60))_0x5241e4[_0x5adf54(-0xc3,-0xb,-0x1ac,0x2f)+_0x5adf54(-0x86,-0x8b,0x3c,-0x15f)]&&_0x5e8bbf[_0x523a88(0x55a,0x4b3,0x4d1,0x494)+_0x5adf54(-0x86,0x52,-0xbc,-0x17)][_0x5adf54(-0x7b,-0x128,-0x4f,-0x6a)]>0x29d*-0x2+-0x455+-0x1*-0x98f&&_0x1259af[_0x523a88(0x3e5,0x55c,0x4a1,0x477)](..._0x56a8e1[_0x5adf54(-0xc3,-0xe3,-0x11c,-0x168)+_0x523a88(0x4eb,0x526,0x4a1,0x4d1)]);else return _0x5ae2f5[_0x523a88(0x4a7,0x569,0x405,0x496)](_0xa9ddae=>replacePlaceholder(_0xa9ddae,_0x3d6c00,_0x3f1782,_0x14e6b5));}function _0x523a88(_0xc3128f,_0x5509d0,_0xd64940,_0x2d7c71){return _0x2238(_0x2d7c71-0x342,_0xd64940);}if(_0x5ae2f5&&_0x464885[_0x523a88(0x60f,0x600,0x582,0x576)](typeof _0x5ae2f5,_0x523a88(0x491,0x4b4,0x633,0x563))){if('ZyNLm'!==_0x464885[_0x5adf54(-0xb5,-0x88,-0xc3,-0x117)])_0x10312c[_0x5adf54(-0x12d,-0x5c,-0x3d,-0x87)]['push'](_0x185e2d),_0x4c2346[_0x523a88(0x51a,0x3c2,0x413,0x466)](_0x5adf54(-0x15f,-0x233,-0x217,-0x245)+'PromptModi'+_0x5adf54(-0x10c,-0xd3,-0x1f1,-0x12d)+_0x28a408+_0x5adf54(0x6,0x31,-0x78,0x2a)+_0x28bfeb+'\x22');else{const _0x537b8d={};for(const _0x4174f6 in _0x5ae2f5){_0x537b8d[_0x4174f6]=replacePlaceholder(_0x5ae2f5[_0x4174f6],_0x3d6c00,_0x3f1782,_0x14e6b5);}return _0x537b8d;}}return _0x5ae2f5;}function attachImagesToMessage(_0x112f41,_0x1bcf4d,_0x6075fc,_0x8a256b='参考图片'){const _0x25e873={'HUCse':function(_0x2555ec,_0x3c925d){return _0x2555ec(_0x3c925d);},'goulf':_0x2ca2d2(0x44f,0x344,0x360,0x3df),'NDFDG':'outfit','YcAmn':function(_0xbf48ae,_0x13fbff){return _0xbf48ae!==_0x13fbff;},'DkZjC':'kAGeH','ADdEA':function(_0x3f8405,_0x4d9ab9){return _0x3f8405===_0x4d9ab9;},'wrxgQ':_0x2ca2d2(0x3ca,0x4c9,0x4e2,0x46e),'kZnJw':function(_0x506c16,_0x5735d1){return _0x506c16===_0x5735d1;},'RCzgl':function(_0x38f96a,_0x466948){return _0x38f96a+_0x466948;},'RIqDX':'text','VnKdA':_0x2ca2d2(0x4b1,0x3cc,0x48a,0x3cd),'fmjxZ':'jeHXw','ujJgK':function(_0x2fd382,_0x128c2e){return _0x2fd382<_0x128c2e;},'OOJKo':function(_0x501363,_0x43f2fb){return _0x501363>=_0x43f2fb;},'KxLzG':_0x52f1bd(-0x76,-0x7d,-0x40,0xd),'bOivL':_0x2ca2d2(0x437,0x3fb,0x4dd,0x4bd)};if(!_0x6075fc||_0x25e873[_0x52f1bd(0xc0,0x137,0x1b0,0x218)](_0x6075fc['length'],-0x85f+-0x90f*-0x4+-0x1bdd)||_0x25e873[_0x2ca2d2(0x4f9,0x457,0x52b,0x51f)](_0x1bcf4d,-0x1*0x513+-0x1986+-0x7*-0x45f)||_0x25e873[_0x2ca2d2(0x51f,0x4ae,0x531,0x457)](_0x1bcf4d,_0x112f41['length']))return _0x112f41;const _0x18b222=[..._0x112f41],_0x122bf0=_0x18b222[_0x1bcf4d],_0x324d9d=[];if(_0x25e873[_0x2ca2d2(0x650,0x548,0x47c,0x565)](typeof _0x122bf0[_0x2ca2d2(0x479,0x56f,0x54f,0x4d2)],_0x25e873['wrxgQ'])){const _0x527550={};_0x527550[_0x2ca2d2(0x3bd,0x33d,0x432,0x3c4)]=_0x52f1bd(0xa7,0xcc,0xf8,-0xd),_0x527550['text']=_0x122bf0['content'],_0x324d9d[_0x52f1bd(0x4c,-0x1b,-0x9e,-0x27)](_0x527550);}else{if(Array[_0x52f1bd(-0x5b,-0x2,0x4d,0xe3)](_0x122bf0[_0x2ca2d2(0x406,0x59f,0x41a,0x4d2)])){if(_0x25e873['YcAmn'](_0x25e873[_0x2ca2d2(0x46b,0x306,0x477,0x3aa)],_0x25e873['bOivL']))_0x324d9d[_0x2ca2d2(0x459,0x450,0x3e5,0x413)](..._0x122bf0['content']);else{if(_0x2236fe[_0x18ab84]){const _0x6dc7bb=_0xe280fd[_0x52f1bd(0x128,0xfd,0x168,0x67)+_0x2ca2d2(0x374,0x52d,0x487,0x44c)](_0x2ca2d2(0x394,0x403,0x3c6,0x417)+_0x16097d);_0x6dc7bb&&(_0x6dc7bb['value']=_0x34f6d3[_0xbef0eb],_0x25e873[_0x52f1bd(0xab,0xe8,0x129,0x167)](_0xf73aa5,_0x6dc7bb)['trigger'](_0x25e873[_0x52f1bd(0x2,-0x4,-0xbd,0xa6)]));}}}}function _0x2ca2d2(_0x12aede,_0x4258f4,_0x249989,_0x4f99bb){return _0x2238(_0x4f99bb-0x2de,_0x4258f4);}if(_0x6075fc['length']>-0xfe+-0x3a*0x97+0x2334){const _0x3ba498={};_0x3ba498[_0x52f1bd(-0x107,-0x6a,0x59,-0xa7)]=_0x25e873[_0x2ca2d2(0x452,0x4d1,0x424,0x425)],_0x3ba498[_0x52f1bd(0x109,0xcc,0x1ae,0x104)]='\x0a[以下是用户上传的'+_0x6075fc[_0x52f1bd(-0x60,0x4a,0xfa,0xce)]+'张'+_0x8a256b+']',_0x324d9d[_0x2ca2d2(0x379,0x330,0x47e,0x413)](_0x3ba498);}_0x6075fc[_0x2ca2d2(0x447,0x50c,0x3f1,0x441)]((_0x523697,_0x5b2aa7)=>{function _0x4293a3(_0x132ff8,_0x2cb8ea,_0x29318a,_0xc0d265){return _0x2ca2d2(_0x132ff8-0x132,_0x132ff8,_0x29318a-0x46,_0xc0d265- -0x698);}function _0x422a7c(_0x2d6e5d,_0x294f6b,_0x867fbf,_0x1b0ea8){return _0x52f1bd(_0x2d6e5d-0x45,_0x1b0ea8-0x464,_0x867fbf-0x1bc,_0x2d6e5d);}if(_0x25e873[_0x422a7c(0x44b,0x535,0x5a8,0x4c5)](_0x25e873[_0x422a7c(0x66c,0x543,0x52e,0x58b)],_0x25e873[_0x4293a3(-0x1e5,-0xb8,-0x156,-0x143)]))_0x404bfa[_0x3c0ab6[_0x3acfb1]]=_0x59db4e;else{const _0x31ba68=_0x25e873[_0x4293a3(-0x19f,-0x1d5,-0x102,-0x133)](typeof _0x523697,_0x25e873[_0x422a7c(0x451,0x323,0x39e,0x3f0)])?_0x523697:_0x523697[_0x422a7c(0x458,0x56b,0x5eb,0x52a)],_0x4190d2=_0x25e873[_0x422a7c(0x48f,0x360,0x321,0x3d7)](typeof _0x523697,_0x422a7c(0x56a,0x599,0x5cc,0x535))&&_0x523697['name']?_0x523697[_0x4293a3(-0x22d,-0x1b1,-0x1bf,-0x278)]:''+_0x8a256b+_0x25e873[_0x4293a3(-0x1bb,-0x32a,-0x2a0,-0x258)](_0x5b2aa7,-0x20*-0x76+0x236*-0x1+-0xc89),_0x1dc25b={};_0x1dc25b[_0x422a7c(0x457,0x496,0x36e,0x3fa)]=_0x25e873[_0x4293a3(-0x19e,-0x196,-0x1ce,-0x273)],_0x1dc25b[_0x4293a3(-0x271,-0x13b,-0x1c7,-0x19e)]='['+_0x4190d2+']',_0x324d9d[_0x4293a3(-0x317,-0x324,-0x1d6,-0x285)](_0x1dc25b);let _0x547efd=_0x31ba68;if(!_0x31ba68[_0x4293a3(-0x247,-0x26f,-0x207,-0x1a5)](_0x25e873[_0x4293a3(-0x304,-0x36d,-0x25d,-0x303)])){if(_0x25e873['kZnJw'](_0x4293a3(-0x1f1,-0x2b8,-0x113,-0x1ff),_0x25e873[_0x422a7c(0x414,0x4f5,0x3bf,0x447)]))_0x547efd=_0x422a7c(0x444,0x45c,0x462,0x51a)+_0x4293a3(-0x1c3,-0x27d,-0x291,-0x2a5)+'4,'+_0x31ba68;else{const _0x23ede6=_0x39cd95(_0x5bfe77);if(_0x23ede6){const _0x472551={};_0x472551['type']=_0x25e873[_0x4293a3(-0x2be,-0x27f,-0x2d1,-0x28d)],_0x472551[_0x422a7c(0x4aa,0x4a0,0x457,0x4f0)]=_0x23ede6,_0x472551['position']=_0x31dce7,_0x2118c7[_0x422a7c(0x3fd,0x461,0x4d3,0x449)](_0x472551);}}}const _0x23cac6={};_0x23cac6[_0x4293a3(-0x150,-0x185,-0x22f,-0x226)]=_0x547efd,_0x23cac6['detail']=_0x4293a3(-0x16f,-0x269,-0x23c,-0x20d);const _0x4429c1={};_0x4429c1[_0x422a7c(0x31d,0x404,0x3e9,0x3fa)]=_0x4293a3(-0x30a,-0x134,-0x1ea,-0x225),_0x4429c1['image_url']=_0x23cac6,_0x324d9d['push'](_0x4429c1);}});const _0x4b95c6={..._0x122bf0};_0x4b95c6[_0x2ca2d2(0x53e,0x58d,0x504,0x4d2)]=_0x324d9d,_0x18b222[_0x1bcf4d]=_0x4b95c6;function _0x52f1bd(_0x2a3aa1,_0x27c419,_0x5cc90f,_0x4c656b){return _0x2238(_0x27c419- -0x150,_0x4c656b);}return _0x18b222;}function findMessageIndexWithPlaceholder(_0x222e25,_0x2619be){const _0x1fc753={};_0x1fc753[_0x392846(0x613,0x701,0x615,0x67a)]=_0x2f4b7b(-0x59,-0xd2,-0x76,0x7b),_0x1fc753[_0x2f4b7b(-0x177,-0x107,-0xbb,0x24)]=function(_0x437090,_0x50d5d7){return _0x437090===_0x50d5d7;},_0x1fc753['CoUtZ']=_0x392846(0x5ba,0x687,0x5ad,0x645),_0x1fc753['HcDXO']=function(_0x3a27e3,_0x116718){return _0x3a27e3<_0x116718;},_0x1fc753[_0x392846(0x52b,0x4e3,0x581,0x4b6)]=function(_0x56d5f9,_0x222ef3){return _0x56d5f9===_0x222ef3;};function _0x2f4b7b(_0x67455b,_0x2fda57,_0x35c0da,_0x303ee0){return _0x2238(_0x35c0da- -0x186,_0x303ee0);}_0x1fc753[_0x2f4b7b(-0x10d,-0x133,-0x96,-0x172)]=function(_0x1621b8,_0x40bfe6){return _0x1621b8!==_0x40bfe6;},_0x1fc753[_0x2f4b7b(0xc,0xcd,0x1d,0x104)]=_0x392846(0x574,0x5fd,0x658,0x634),_0x1fc753[_0x392846(0x502,0x5bd,0x473,0x592)]='XMgGk',_0x1fc753['enJEB']=function(_0xadb60f,_0x440883){return _0xadb60f===_0x440883;},_0x1fc753['cUral']='NyUzM';const _0x59bfd9=_0x1fc753;for(let _0xa39162=0xc8b+-0x2140+0x14b5;_0x59bfd9[_0x392846(0x61a,0x65e,0x639,0x543)](_0xa39162,_0x222e25['length']);_0xa39162++){const _0x31a0b9=_0x222e25[_0xa39162];if(_0x59bfd9['CPLOT'](typeof _0x31a0b9[_0x392846(0x592,0x5a3,0x680,0x600)],_0x2f4b7b(-0xbe,0x6e,0xa,0x85))&&_0x31a0b9['content'][_0x2f4b7b(0x1be,0x1e0,0xee,0x2)](_0x2619be)){if(_0x59bfd9['kldLz'](_0x59bfd9['ePLWV'],_0x59bfd9[_0x392846(0x541,0x4b4,0x4e8,0x4cd)])){_0x3c4720[_0x392846(0x5e1,0x5e8,0x5a4,0x542)](_0x59bfd9['dZnBx']);return;}else return _0xa39162;}else{if(Array[_0x2f4b7b(0x88,-0xcc,-0x38,-0x16)](_0x31a0b9[_0x392846(0x592,0x59f,0x4d7,0x637)]))for(const _0x5412ca of _0x31a0b9[_0x2f4b7b(-0x48,0x12a,0x6e,0x51)]){if(_0x59bfd9['CPLOT'](_0x59bfd9['QksLw'],_0x392846(0x463,0x399,0x453,0x530)))for(const _0x3f394b of _0x169c44[_0x392846(0x592,0x4a5,0x4e3,0x588)]){if(_0x59bfd9['tEvHR'](_0x3f394b[_0x2f4b7b(-0x146,-0xe8,-0xa0,0x52)],_0x59bfd9[_0x392846(0x54e,0x510,0x572,0x4e3)])&&_0x3f394b['text'][_0x2f4b7b(0xd1,0x12,0xee,0x1b9)](_0x1473ca))return _0x6d1c71;}else{if(_0x59bfd9[_0x392846(0x514,0x52c,0x541,0x5da)](_0x5412ca[_0x392846(0x484,0x556,0x489,0x566)],_0x2f4b7b(0xd7,0x38,0x96,0x116))&&_0x5412ca[_0x392846(0x5ba,0x5b4,0x51d,0x670)][_0x392846(0x612,0x698,0x6b9,0x5e5)](_0x2619be)){if(_0x59bfd9['CPLOT'](_0x59bfd9[_0x392846(0x46e,0x396,0x4a1,0x439)],_0x392846(0x525,0x5f3,0x5e6,0x5c8)))return _0xa39162;else{_0x41a435[_0x2f4b7b(-0x11e,-0x21,-0xc0,-0x132)]('找不到指定的角色预设');return;}}}}}}function _0x392846(_0x1b9e92,_0x155f89,_0x217e93,_0x5098fb){return _0x2238(_0x1b9e92-0x39e,_0x5098fb);}return-(-0x353+0x2*-0x1369+-0x1*-0x2a26);}function generateRequestId(){const _0x4328ee={};function _0x15512b(_0x5e2926,_0x1cd9e2,_0x10fa8a,_0x1bb9d9){return _0x2238(_0x1cd9e2- -0xe0,_0x10fa8a);}_0x4328ee['YzZep']=function(_0x4591ca,_0x3d8682){return _0x4591ca+_0x3d8682;};const _0x23b0f9=_0x4328ee;function _0x348723(_0x2e4f5a,_0x5baa6e,_0x14cd5c,_0x2e5865){return _0x2238(_0x2e5865- -0x207,_0x14cd5c);}if(crypto&&crypto[_0x15512b(0x3a,0x14,-0x55,-0xd1)])return crypto[_0x15512b(0x49,0x14,-0x5a,-0xd2)]();return _0x23b0f9[_0x15512b(0x21c,0x14b,0x190,0x116)](Date['now']()[_0x348723(-0x2,-0x128,0x5e,-0x4b)](-0x1*0x2538+-0x4*-0x428+0x14bc),Math[_0x348723(-0xa4,-0x1e8,-0x18c,-0x143)]()[_0x15512b(0xee,0xdc,0x11,0x193)](0xb*0xaf+0x1*0x1712+-0x617*0x5)[_0x348723(0xa1,-0x5c,-0xe6,-0x2c)](0x15*0xef+0x5d2+-0x196b));}export function LLM_CHAR_MODIFY_GET_PROMPT(){const _0x199bdf={'oRnGf':function(_0x14602a,_0x4d1a75){return _0x14602a(_0x4d1a75);},'VauFT':'获取角色修改提示词超'+'时','oqNEw':function(_0x524059,_0x4a4bf5){return _0x524059===_0x4a4bf5;},'CsNoP':function(_0x5cc25b,_0x2d8e56){return _0x5cc25b!==_0x2d8e56;},'AqDmm':function(_0xd97c1f,_0x541c4f){return _0xd97c1f(_0x541c4f);},'dgOUz':function(_0x3e4a2d,_0x3f4751,_0x5c41d9){return _0x3e4a2d(_0x3f4751,_0x5c41d9);}};return new Promise((_0x5e8a74,_0x4fb7b3)=>{const _0x32c980={'Pnpjc':function(_0x1ddac4,_0x2b1f7d){return _0x1ddac4+_0x2b1f7d;},'FPSpP':function(_0x185322,_0x55f7f7){return _0x199bdf['oqNEw'](_0x185322,_0x55f7f7);},'slNAE':function(_0x5af522,_0x9c98a6){return _0x199bdf['CsNoP'](_0x5af522,_0x9c98a6);},'GOdfj':function(_0x667f4b,_0x5ba894){function _0x3ad2d7(_0x124eb1,_0x5056e2,_0x4ab983,_0x299d5d){return _0x2238(_0x124eb1-0x35c,_0x4ab983);}return _0x199bdf[_0x3ad2d7(0x447,0x4c7,0x46f,0x373)](_0x667f4b,_0x5ba894);}},_0x1b0ba5=generateRequestId();function _0x590f70(_0x2855ff,_0x4b7892,_0x3b72b6,_0x1863c6){return _0x2238(_0x3b72b6-0x313,_0x4b7892);}console['log']('[character'+_0x590f70(0x531,0x48c,0x4fa,0x5b1)+_0x590f70(0x468,0x314,0x3bc,0x32b)+_0x322ec7(-0x1e6,-0x185,-0xed,-0x1b5)+'modify\x20pro'+'mpt\x20(ID:\x20'+_0x1b0ba5+')');const _0x836a8b=_0x4f74b6=>{const _0x46e018={'diaRC':function(_0x104405,_0x3bf8b0){function _0x476787(_0x2a4d0e,_0x31cc6b,_0x1a47d6,_0x3a1f01){return _0x2238(_0x1a47d6- -0x79,_0x31cc6b);}return _0x32c980[_0x476787(0x188,0x198,0x1d2,0x269)](_0x104405,_0x3bf8b0);}};function _0x363b6a(_0x32c68d,_0x156cbf,_0x479b9c,_0x3a6b8f){return _0x322ec7(_0x32c68d-0x1ce,_0x156cbf-0xd2,_0x479b9c,_0x32c68d- -0x58);}function _0x3e7494(_0x3fdd67,_0x686f7,_0x270899,_0x6ef8bc){return _0x590f70(_0x3fdd67-0xcd,_0x686f7,_0x270899- -0x36b,_0x6ef8bc-0x15b);}if(_0x32c980[_0x3e7494(0x26f,0xee,0x1c0,0x1cd)]('UHXZS',_0x363b6a(-0x276,-0x24a,-0x1c6,-0x25a))){if(_0x47c0fc&&_0x136a72[_0x3e7494(0x14e,0xc4,0x9c,0xfe)])return _0x1888c6['randomUUID']();return _0x46e018[_0x363b6a(-0x1a2,-0x202,-0x22f,-0x26e)](_0x577490['now']()[_0x363b6a(-0x1c4,-0x1a6,-0x1bf,-0xe1)](0x2e*-0x8b+0x12d8+0x2*0x323),_0x17c96e[_0x363b6a(-0x2bc,-0x2e2,-0x1ca,-0x383)]()[_0x363b6a(-0x1c4,-0x187,-0xfb,-0x235)](-0x1*-0x216b+0x266+-0x23ad)[_0x363b6a(-0x1a5,-0x1a7,-0x183,-0x1ef)](0x4*0x46f+0x309+-0x14c3));}else{if(_0x32c980[_0x3e7494(0x231,0x29a,0x1db,0x22e)](_0x4f74b6['id'],_0x1b0ba5))return;eventSource[_0x3e7494(0x88,0xb9,0xf0,0x155)+'ener'](eventNames[_0x3e7494(0x189,-0x44,0x9f,0x126)+_0x3e7494(0x209,0xd3,0x14a,0x17a)+_0x3e7494(0x158,0x107,0x168,0x1c2)+_0x363b6a(-0x163,-0x11a,-0x1fd,-0x77)],_0x836a8b),_0x32c980['GOdfj'](_0x5e8a74,_0x4f74b6[_0x3e7494(-0x8c,0xd9,0x65,0x124)]);}};eventSource['on'](eventNames[_0x590f70(0x440,0x441,0x40a,0x428)+_0x590f70(0x425,0x40e,0x4b5,0x4ed)+_0x322ec7(-0x80,-0x24b,-0x133,-0x168)+_0x322ec7(-0xd3,-0x1cd,-0x119,-0x10b)],_0x836a8b);function _0x322ec7(_0x568f7c,_0xea469e,_0x478ace,_0x36dd7b){return _0x2238(_0x36dd7b- -0x328,_0x478ace);}const _0x2615c2={};_0x2615c2['id']=_0x1b0ba5,eventSource[_0x590f70(0x63a,0x663,0x581,0x521)](eventNames[_0x590f70(0x35a,0x39d,0x40a,0x39b)+_0x590f70(0x45e,0x4bd,0x4b5,0x552)+'PROMPT_REQ'+_0x590f70(0x2ff,0x455,0x3c0,0x484)],_0x2615c2),_0x199bdf[_0x590f70(0x520,0x57e,0x509,0x452)](setTimeout,()=>{function _0x56a94b(_0x34461a,_0xc1fbfd,_0x5bc1f4,_0x53665a){return _0x590f70(_0x34461a-0x1c2,_0xc1fbfd,_0x5bc1f4- -0x10e,_0x53665a-0x169);}eventSource['removeList'+_0x56a94b(0x2ec,0x40a,0x344,0x30e)](eventNames[_0x5345d8(0xb3,-0x3,0x2,0x57)+_0x5345d8(0x7b,0x101,0x1e1,0x102)+_0x56a94b(0x424,0x48b,0x3c5,0x337)+'PONSE'],_0x836a8b);function _0x5345d8(_0x4729f0,_0x199af9,_0xf5815a,_0x381f02){return _0x322ec7(_0x4729f0-0x182,_0x199af9-0x64,_0x199af9,_0x381f02-0x288);}_0x199bdf[_0x56a94b(0x3ae,0x49f,0x444,0x36e)](_0x4fb7b3,new Error(_0x199bdf[_0x56a94b(0x2d1,0x362,0x324,0x33c)]));},-0x4*0x31d+0x1*-0x72b+0x3aaf);});}export function LLM_CHAR_MODIFY(_0x29b181,_0x1097c8={}){function _0x1af235(_0x125eb5,_0xe703a,_0x25c458,_0x4243e0){return _0x2238(_0x4243e0-0x93,_0x25c458);}function _0x2d37d2(_0x5cab4f,_0x218576,_0x5243b9,_0x2e1ed9){return _0x2238(_0x5cab4f-0x13d,_0x2e1ed9);}const _0x1be7ab={'MdJWE':'outfit','kJDPM':function(_0x3682c5,_0x50e54b){return _0x3682c5===_0x50e54b;},'xzmvD':_0x2d37d2(0x262,0x212,0x220,0x1b0),'uDMHx':function(_0x8ae0f4,_0x25e66c){return _0x8ae0f4(_0x25e66c);},'vwlcy':_0x2d37d2(0x27e,0x247,0x1de,0x364)+_0x1af235(0x336,0x351,0x3c0,0x31b),'chGvE':function(_0x30658e,_0x2af7b7){return _0x30658e!==_0x2af7b7;},'JyoPV':function(_0x4385df){return _0x4385df();},'nXjJX':function(_0x4d49bd,_0x2e45bb){return _0x4d49bd(_0x2e45bb);},'zneBp':_0x2d37d2(0x309,0x337,0x398,0x3d4),'BSEec':_0x1af235(0x1be,0x300,0x2f0,0x277),'fwKSB':_0x2d37d2(0x20f,0x16d,0x244,0x120),'oPLip':_0x2d37d2(0x2b9,0x2e4,0x290,0x38b),'xMAUv':function(_0x2896e1,_0x38cc1b){return _0x2896e1(_0x38cc1b);},'sOcPk':_0x2d37d2(0x2ad,0x338,0x21a,0x1f9),'EYRle':_0x2d37d2(0x3a7,0x34e,0x438,0x465),'naiuw':_0x1af235(0x222,0x16c,0x1d6,0x1a9)};return new Promise((_0x326b96,_0x5b8efd)=>{function _0x93765d(_0x4c3b50,_0x1d7cc6,_0x244adb,_0x4ec9e1){return _0x1af235(_0x4c3b50-0x160,_0x1d7cc6-0x1d2,_0x244adb,_0x1d7cc6-0x339);}const _0x3f7a6d={'HIHmD':function(_0x440652,_0x2fbdbb){function _0x480ce5(_0x43ef7f,_0x651ae4,_0x4a58bb,_0x3f0674){return _0x2238(_0x43ef7f- -0x135,_0x4a58bb);}return _0x1be7ab[_0x480ce5(0x11b,0xb6,0xcb,0x1c5)](_0x440652,_0x2fbdbb);},'OYScT':_0x1be7ab[_0x93765d(0x5db,0x652,0x5d3,0x6f3)],'AVmKU':_0x1be7ab[_0x93765d(0x514,0x601,0x5f3,0x6c6)],'CMTIU':function(_0x2d2735,_0x15cba4){return _0x2d2735!==_0x15cba4;},'ussiA':_0x1be7ab[_0x93765d(0x5dd,0x650,0x703,0x671)],'OgArL':_0x48bd28(0x1ee,0xe,0xfd,0xb3),'JLblE':function(_0x207c93,_0x5bcd00){return _0x1be7ab['xMAUv'](_0x207c93,_0x5bcd00);},'JWoyT':_0x1be7ab[_0x93765d(0x5e1,0x5b9,0x4c9,0x5ff)],'YTwGc':_0x1be7ab[_0x48bd28(0x119,-0x16,0x3e,-0x2a)],'vzSvc':function(_0x176906,_0x44a037){function _0x2bc0ed(_0x3e296d,_0x354ba2,_0x11d8ce,_0x472a41){return _0x48bd28(_0x3e296d-0xc6,_0x472a41,_0x354ba2-0x3a6,_0x472a41-0x3f);}return _0x1be7ab[_0x2bc0ed(0x38f,0x3b0,0x388,0x374)](_0x176906,_0x44a037);},'mTImd':_0x93765d(0x66a,0x598,0x592,0x5cd)};function _0x48bd28(_0x58d1ef,_0x35aa66,_0x47729c,_0x1c85d4){return _0x1af235(_0x58d1ef-0x104,_0x35aa66-0x190,_0x35aa66,_0x47729c- -0x1aa);}if(_0x1be7ab[_0x48bd28(0x123,0x88,0x51,-0x9b)]!==_0x93765d(0x635,0x603,0x539,0x5e4)){const _0x396a8c=_0x1be7ab['JyoPV'](generateRequestId),_0x228902=_0x1097c8['timeoutMs']||-0x1*-0x7690+0x81*-0x14c+0x2*0x8d8e;let _0x4ad9a4=null;console[_0x48bd28(0xa6,-0xc8,0xd,-0xe)](_0x48bd28(-0x5c,0x8b,-0x61,-0xf7)+_0x48bd28(0x8,0x11f,0xd0,-0xa)+_0x48bd28(0xfb,0xd7,0x14c,0x7f)+'ing\x20char\x20m'+_0x93765d(0x581,0x570,0x507,0x61e)+_0x48bd28(0x10a,0x1a,0x10b,0x83)+'D:\x20'+_0x396a8c+')');const _0x1c6ac5=()=>{const _0xa2069f={};function _0x20e541(_0x4418fc,_0x2cacf1,_0x90d3b4,_0x14f290){return _0x48bd28(_0x4418fc-0x114,_0x2cacf1,_0x4418fc-0x3f6,_0x14f290-0x33);}_0xa2069f['auAMF']=_0x1be7ab[_0x17ae47(-0x113,0x35,-0x159,-0x6b)];const _0xfa41d1=_0xa2069f;eventSource[_0x20e541(0x427,0x439,0x47a,0x3ef)+_0x20e541(0x41e,0x42c,0x3c8,0x48c)](eventNames[_0x17ae47(-0x16b,-0x16b,-0xe7,-0x8d)+_0x17ae47(0x7,0xd0,-0xa2,0x3b)+_0x20e541(0x409,0x3b7,0x4f2,0x37a)],_0x315b2a);function _0x17ae47(_0x133141,_0x28e1ee,_0x3359ab,_0x4ef0bf){return _0x93765d(_0x133141-0x30,_0x4ef0bf- -0x550,_0x28e1ee,_0x4ef0bf-0x134);}if(_0x4ad9a4){if(_0x1be7ab[_0x20e541(0x42a,0x3f6,0x3b4,0x46f)](_0x17ae47(0x39,0x14,-0xbe,-0x5f),_0x1be7ab['xzmvD']))_0x1be7ab['uDMHx'](clearTimeout,_0x4ad9a4),_0x4ad9a4=null;else{const _0xeea819={};_0xeea819[_0x17ae47(0x17,-0xd4,-0x175,-0x9e)]=_0xfa41d1[_0x20e541(0x4a9,0x54d,0x429,0x587)],_0xeea819[_0x20e541(0x4bb,0x3ce,0x50c,0x5a1)]=_0xc4033d,_0xeea819[_0x17ae47(-0x13,0xe1,0x10e,0x84)]=_0x77f6ae,_0x2fd6d4[_0x20e541(0x414,0x402,0x4df,0x429)](_0xeea819);}}},_0x315b2a=_0x427319=>{function _0x334a08(_0x4f31b6,_0x4b2834,_0x511bab,_0x2ff874){return _0x93765d(_0x4f31b6-0x118,_0x4f31b6- -0x2e0,_0x4b2834,_0x2ff874-0x146);}function _0x21849a(_0x3a8551,_0x52f7ee,_0x358654,_0x16446a){return _0x93765d(_0x3a8551-0xd9,_0x52f7ee- -0x452,_0x3a8551,_0x16446a-0x10b);}if(_0x3f7a6d[_0x334a08(0x2ef,0x38f,0x218,0x2b3)](_0x3f7a6d[_0x334a08(0x26e,0x1d1,0x1b6,0x1b7)],_0x3f7a6d[_0x334a08(0x21a,0x25c,0x2ae,0x1d4)])){if(_0x3f7a6d[_0x21849a(0x1c5,0x1db,0x19d,0x1c3)](_0x427319['id'],_0x396a8c))return;_0x1c6ac5(),_0x427319[_0x334a08(0x350,0x297,0x2af,0x2a0)]?_0x3f7a6d[_0x21849a(0x1ed,0x176,0x1f1,0x161)]===_0x3f7a6d[_0x21849a(0x164,0x1a9,0x1f6,0x189)]?_0x3a6299&&_0x31e872[_0x334a08(0x1a7,0x22d,0x278,0x29a)](_0x32eb59):_0x3f7a6d['JLblE'](_0x326b96,_0x427319[_0x21849a(0x56,0x11a,0x173,0x169)]):_0x3f7a6d[_0x334a08(0x20f,0x2ba,0x214,0x287)]!==_0x3f7a6d[_0x21849a(0x1c0,0x1a2,0x27f,0x15a)]?_0x3f7a6d[_0x21849a(0x1b6,0x14c,0x192,0x1aa)](_0x5b8efd,new Error(_0x427319[_0x21849a(0xb4,0x11a,0x37,0x8d)]||_0x3f7a6d[_0x21849a(0xb5,0xc0,0x2,0xeb)])):_0x6fd45e[_0x334a08(0x221,0x1cd,0x27e,0x311)](_0x3fb91b);}else _0x25e8b8[_0x21849a(0x163,0x1c4,0x1a7,0x21b)+'ets']={};};eventSource['on'](eventNames[_0x93765d(0x4a0,0x4c3,0x419,0x5a3)+_0x93765d(0x5c9,0x58b,0x502,0x49f)+'ONSE'],_0x315b2a);const _0x432dfe={};_0x432dfe[_0x93765d(0x4d2,0x489,0x3b3,0x3c9)]=_0x29b181,_0x432dfe['id']=_0x396a8c,eventSource[_0x48bd28(0xa8,0x205,0x157,0x91)](eventNames['LLM_CHAR_M'+'ODIFY_REQU'+_0x93765d(0x57b,0x547,0x5a2,0x5af)],_0x432dfe),_0x4ad9a4=setTimeout(()=>{_0x1c6ac5(),_0x5b8efd(new Error(_0x1be7ab['vwlcy']));},_0x228902);}else{if(_0x1be7ab[_0x93765d(0x6fe,0x61c,0x64d,0x6be)](_0x1c0df0['id'],_0x333fff))return;_0x1be7ab[_0x93765d(0x534,0x50a,0x5a1,0x581)](_0x252681),_0x12abcb[_0x93765d(0x543,0x630,0x53f,0x5f7)]?_0x1be7ab['nXjJX'](_0x199635,_0x4a03fc[_0x93765d(0x61c,0x56c,0x57c,0x5d1)]):_0x2391a8(new _0x35225f(_0x1911b5[_0x93765d(0x531,0x56c,0x611,0x647)]||_0x1be7ab[_0x93765d(0x6f8,0x605,0x67d,0x654)]));}});}function preprocessTagContent(_0x130ef8){const _0x3263a1={};_0x3263a1[_0x4b1421(0x24f,0x30f,0x2d8,0x17e)]=_0x208df3(0x2e1,0x2fe,0x1d7,0x223),_0x3263a1['WwiRi']=_0x4b1421(0x20c,0x127,0x1cd,0x261);const _0x4a4478=_0x3263a1;let _0x254e99=_0x130ef8[_0x4b1421(0x206,0x291,0x1cd,0x1dc)](/:/g,':')['replace'](/,/g,',');function _0x208df3(_0x26413d,_0x16a6f2,_0x210c8f,_0x152abf){return _0x2238(_0x152abf- -0x9,_0x16a6f2);}_0x254e99=_0x254e99['replace'](/下半身NSWebcam:/g,'下半身NSFW背面:'),_0x254e99=_0x254e99[_0x208df3(0x159,0x215,0x1c0,0x21b)](/下半身NSFW_背面:/g,_0x4a4478['aWQDK']),_0x254e99=_0x254e99[_0x4b1421(0x206,0x177,0x1c5,0x2ca)](/上半身NSFW_背面:/g,_0x4a4478[_0x208df3(0x29e,0x18a,0x150,0x239)]);function _0x4b1421(_0x18e7e5,_0x572878,_0x496fbf,_0x1bcb12){return _0x2238(_0x18e7e5- -0x1e,_0x572878);}return _0x254e99;}function parseCharacterData(_0x258006){const _0x38d5a8={'ywUjE':function(_0x52b4f4,_0x3bda25,_0x1673b0,_0x220452,_0x2557a4){return _0x52b4f4(_0x3bda25,_0x1673b0,_0x220452,_0x2557a4);},'oLUch':_0x10a39b(0xcd,0x85,0x35,0x82),'ZtkiM':_0x2bd41f(0x3fd,0x362,0x32a,0x42f),'iGfFr':'characterT'+_0x10a39b(0x96,-0x3a,0x52,0x3e),'hrSKf':_0x10a39b(0x6a,0x128,0x42,0x64)+_0x2bd41f(0x37d,0x2bb,0x3a5,0x2cf),'cwyxQ':_0x10a39b(0x4e,0x5,0x62,-0x14)+'FW','rtTyp':_0x2bd41f(0x24b,0x2ba,0x2d5,0x37d)+'FWBack','wQXoO':_0x2bd41f(0x17f,0x24b,0x2e6,0x163)+'W','RcQwb':'fullBodySF'+_0x2bd41f(0x2e4,0x30d,0x2a7,0x31a),'INrWM':'upperBodyN'+'SFW','NAgCl':_0x2bd41f(0x345,0x2e3,0x376,0x203)+_0x2bd41f(0x246,0x300,0x306,0x329),'eaDDF':'fullBodyNS'+'FW','rokum':_0x2bd41f(0x3c2,0x3e0,0x37d,0x382)+'FWBack','taJQX':function(_0x286793,_0x46164f){return _0x286793===_0x46164f;},'UmYiv':function(_0x4701d3,_0x19edc0){return _0x4701d3+_0x19edc0;},'kxqcE':function(_0x1cb29d,_0x270a9f){return _0x1cb29d===_0x270a9f;},'LcHxi':'CSKUi','PNHqw':_0x2bd41f(0x1cf,0x282,0x230,0x255)},_0x2a6bdb=_0x258006[_0x2bd41f(0x44e,0x388,0x2af,0x2ee)]('\x0a')[_0x10a39b(-0x22,0xe,-0x37,0xf)](_0x122848=>_0x122848[_0x2bd41f(0x265,0x241,0x1e7,0x222)]())[_0x2bd41f(0x281,0x296,0x357,0x1ae)](_0x46546d=>_0x46546d),_0x3e50d6={};_0x3e50d6[_0x10a39b(0x119,0x118,0x49,0x82)]='',_0x3e50d6['nameEN']='',_0x3e50d6[_0x2bd41f(0x38c,0x3a2,0x3f7,0x3f4)+'raits']='',_0x3e50d6[_0x10a39b(0xd7,0x63,-0x27,0x64)+_0x10a39b(0x99,0xf0,0x17f,0x10a)]='',_0x3e50d6['facialFeat'+_0x2bd41f(0x3a2,0x2bb,0x34e,0x3a1)]='',_0x3e50d6['upperBodyS'+'FW']='',_0x3e50d6[_0x2bd41f(0x2b5,0x2ba,0x328,0x23b)+_0x10a39b(-0x52,0x5c,-0xb2,-0x95)]='',_0x3e50d6[_0x2bd41f(0x2eb,0x24b,0x15a,0x258)+'W']='',_0x3e50d6[_0x10a39b(-0x14e,-0x158,-0x152,-0x83)+'WBack']='',_0x3e50d6[_0x2bd41f(0x288,0x2e3,0x3a5,0x2f0)+_0x10a39b(0x56,-0xbf,-0x25,-0x97)]='',_0x3e50d6[_0x2bd41f(0x36d,0x2e3,0x20e,0x32b)+_0x10a39b(-0x2,0x8,-0x29,0x32)]='',_0x3e50d6['fullBodyNS'+'FW']='',_0x3e50d6[_0x2bd41f(0x323,0x3e0,0x2fa,0x456)+_0x10a39b(-0xb4,-0x96,-0x180,-0x95)]='';const _0x316057=_0x3e50d6,_0xc9cf2a={};_0xc9cf2a[_0x2bd41f(0x380,0x3a9,0x2d5,0x2e7)]=_0x38d5a8['oLUch'],_0xc9cf2a[_0x2bd41f(0x31f,0x34e,0x337,0x2ff)]=_0x38d5a8[_0x10a39b(0x4e,-0x26,0xd1,0x73)],_0xc9cf2a[_0x2bd41f(0x1f3,0x28e,0x1be,0x217)]=_0x38d5a8[_0x10a39b(-0x109,-0xa8,-0xfc,-0x41)],_0xc9cf2a[_0x10a39b(-0x9c,0x58,-0x46,-0x2e)]=_0x10a39b(0x140,0xc9,0x23,0x64)+_0x2bd41f(0x44c,0x3d8,0x387,0x469),_0xc9cf2a[_0x10a39b(0x14c,0xa4,0x151,0x121)]=_0x38d5a8[_0x10a39b(-0xf2,-0x13e,-0x167,-0x7b)],_0xc9cf2a[_0x10a39b(0x6a,0x14c,0xe0,0x60)]=_0x38d5a8[_0x2bd41f(0x34a,0x266,0x1e0,0x1ec)];function _0x2bd41f(_0x27a436,_0x15d055,_0xaa0479,_0x1dff24){return _0x2238(_0x15d055-0x189,_0xaa0479);}_0xc9cf2a['上半身SFW背面']=_0x38d5a8[_0x10a39b(0x192,0xfb,0x170,0x103)],_0xc9cf2a[_0x10a39b(0x103,0x41,0xd6,0x16)]=_0x38d5a8[_0x2bd41f(0x3ad,0x34a,0x313,0x2fd)],_0xc9cf2a[_0x10a39b(0x1d7,0xa0,0x131,0x12a)]=_0x38d5a8[_0x2bd41f(0x2ca,0x396,0x41d,0x3cf)];function _0x10a39b(_0x895c3e,_0x4633ec,_0x5b8236,_0x502bf7){return _0x2238(_0x502bf7- -0x145,_0x4633ec);}_0xc9cf2a[_0x10a39b(0xca,0x140,0x11a,0xeb)]=_0x38d5a8['INrWM'],_0xc9cf2a[_0x10a39b(0x65,-0x32,0x1b,0x2d)]=_0x38d5a8[_0x10a39b(0xf8,-0xa3,-0x2f,0x28)],_0xc9cf2a[_0x2bd41f(0x3c6,0x30f,0x350,0x397)]=_0x38d5a8[_0x10a39b(0x7c,0x15a,0xbc,0xcc)],_0xc9cf2a[_0x2bd41f(0x325,0x3d7,0x343,0x2f7)]=_0x38d5a8[_0x2bd41f(0x35b,0x31f,0x300,0x323)];const _0x1a203a=_0xc9cf2a;for(const _0x148d5d of _0x2a6bdb){const _0x1c230e=_0x148d5d[_0x2bd41f(0x295,0x356,0x3f3,0x3b4)](':');if(_0x38d5a8[_0x2bd41f(0x2f2,0x3cd,0x451,0x33c)](_0x1c230e,-(0x340+-0x1a5*-0x6+-0xd1d)))continue;const _0x5c19aa=_0x148d5d[_0x10a39b(0x18,0x57,0x43,0x96)](-0x212c+0x1c9*-0x15+0x46a9,_0x1c230e)[_0x2bd41f(0x2ad,0x241,0x252,0x2fd)](),_0x13d2bc=_0x148d5d[_0x2bd41f(0x307,0x364,0x347,0x31a)](_0x38d5a8['UmYiv'](_0x1c230e,0x14d0+0xee1+-0x23b*0x10))['trim']();if(_0x1a203a[_0x5c19aa])_0x38d5a8[_0x2bd41f(0x3dd,0x2ee,0x27d,0x285)](_0x10a39b(-0x146,-0x16,-0x87,-0x9a),_0x38d5a8[_0x10a39b(0xad,0xb5,0x1e,0x66)])?_0x316057[_0x1a203a[_0x5c19aa]]=_0x13d2bc:_0x84cf0b[_0x2bd41f(0x319,0x2be,0x2f2,0x28a)](_0x166989);else _0x5c19aa&&_0x13d2bc&&console[_0x10a39b(-0xa1,0x69,0x80,-0x21)](_0x10a39b(0x27,-0x150,-0x13,-0x8f)+'PromptModi'+_0x10a39b(0x9b,-0x6b,0x123,0x59)+_0x10a39b(-0xba,-0xac,-0x11e,-0x96)+_0x5c19aa+'\x22');}if(!_0x316057['nameCN']){if(_0x2bd41f(0x33b,0x26b,0x2d7,0x1c5)===_0x38d5a8[_0x10a39b(0x7f,0xab,0x54,0x98)]){const _0x5b1a0b={};for(const _0x321b8d in _0x3ea51c){_0x5b1a0b[_0x321b8d]=_0x38d5a8['ywUjE'](_0x2804ba,_0x5d66c2[_0x321b8d],_0xcb966a,_0x5d4eb5,_0x19f8cc);}return _0x5b1a0b;}else return null;}return console[_0x10a39b(-0xad,-0x13,0x29,-0x21)](_0x10a39b(-0x11,0x18,-0x7f,-0x8f)+'PromptModi'+'fy]\x20解析到的人物'+_0x2bd41f(0x3e5,0x40e,0x322,0x450),_0x316057),_0x316057;}function parseOutfitData(_0x1ae14a){const _0x4417fb={'RaKrl':function(_0x40fd19,_0x15933f){return _0x40fd19(_0x15933f);},'WglNu':_0x34428c(0x45e,0x54e,0x3a9,0x45f),'OdCuT':_0x1f85b2(0x588,0x550,0x4a0,0x555),'wVnKR':_0x34428c(0x32c,0x332,0x369,0x406)+_0x1f85b2(0x50a,0x56a,0x4ea,0x5bc)+_0x1f85b2(0x57c,0x5df,0x4eb,0x4f9)+'ed','tdQry':_0x34428c(0x3eb,0x4a9,0x326,0x419)+_0x34428c(0x672,0x5d1,0x585,0x5ae)+'\x20index','sMbFO':function(_0x1b433e){return _0x1b433e();},'CQIIw':_0x1f85b2(0x52f,0x500,0x57d,0x458),'cGqrG':'upperBody','usEti':_0x1f85b2(0x3ca,0x468,0x4b6,0x326)+'ack','uOVXf':_0x1f85b2(0x505,0x578,0x4b8,0x553),'RxurR':_0x34428c(0x4c0,0x561,0x49b,0x53b)+'ck','yrvqc':_0x1f85b2(0x3d4,0x4ab,0x485,0x49f),'XdfAA':'USTpl','JtRql':function(_0x26b930,_0x35e7c2){return _0x26b930+_0x35e7c2;},'ZLZEX':function(_0x4b7379,_0x113170){return _0x4b7379!==_0x113170;},'ZoEhS':_0x34428c(0x450,0x540,0x59a,0x4ca),'gwXwe':'GaCOk','ZTbGF':_0x34428c(0x6a9,0x555,0x56b,0x5db),'fsjUX':_0x34428c(0x536,0x5dd,0x48a,0x4ec),'FxZgl':'CUuJR','cnesK':_0x1f85b2(0x3d9,0x4b3,0x2fa,0x482)+_0x1f85b2(0x50a,0x420,0x466,0x5d9)+'fy]\x20解析到的服装'+_0x1f85b2(0x5a8,0x5ed,0x539,0x4e3)},_0x38ef73=_0x1ae14a[_0x1f85b2(0x522,0x5e1,0x587,0x51a)]('\x0a')['map'](_0x269b38=>_0x269b38['trim']())['filter'](_0x37b70e=>_0x37b70e),_0xe5daf8={};_0xe5daf8[_0x34428c(0x4b7,0x46c,0x5d6,0x517)]='',_0xe5daf8[_0x1f85b2(0x4fc,0x56e,0x53a,0x552)]='',_0xe5daf8[_0x34428c(0x5f5,0x5f4,0x63b,0x55c)]='',_0xe5daf8[_0x1f85b2(0x516,0x55c,0x456,0x4ac)]='',_0xe5daf8['upperBodyB'+_0x1f85b2(0x50d,0x58b,0x41f,0x4d2)]='',_0xe5daf8[_0x34428c(0x519,0x4cc,0x59e,0x532)]='';function _0x34428c(_0x3cbcb2,_0x479ecf,_0x337722,_0x4e0011){return _0x2238(_0x4e0011-0x350,_0x3cbcb2);}_0xe5daf8[_0x1f85b2(0x50e,0x473,0x429,0x4ed)+'ck']='';const _0x2d0f60=_0xe5daf8,_0x543610={};_0x543610[_0x1f85b2(0x4a3,0x3f1,0x40b,0x3d5)]=_0x4417fb[_0x34428c(0x3ce,0x44a,0x4c6,0x4ae)];function _0x1f85b2(_0x405288,_0x3b6db3,_0x129251,_0x4940a5){return _0x2238(_0x405288-0x323,_0x129251);}_0x543610['中文名称']=_0x34428c(0x5b9,0x4e5,0x450,0x517),_0x543610[_0x34428c(0x4c4,0x4e9,0x544,0x515)]='nameEN',_0x543610['上半身']=_0x4417fb['cGqrG'],_0x543610['上半身背面']=_0x4417fb['usEti'],_0x543610[_0x34428c(0x4b6,0x45a,0x4e6,0x4b7)]=_0x4417fb[_0x1f85b2(0x4ae,0x40e,0x4a3,0x470)],_0x543610[_0x34428c(0x5db,0x644,0x585,0x5cb)]=_0x4417fb['RxurR'];const _0x4045ef=_0x543610;for(const _0x1a6a0f of _0x38ef73){if(_0x4417fb[_0x1f85b2(0x3fe,0x32e,0x4a6,0x3f8)]!==_0x4417fb[_0x34428c(0x49a,0x461,0x402,0x441)]){const _0x2d1b9e=_0x1a6a0f['indexOf'](':');if(_0x2d1b9e===-(0x1468+0x23d4+-0x383b))continue;const _0x2b5b4f=_0x1a6a0f[_0x1f85b2(0x4fe,0x5ee,0x577,0x5dd)](0x1051+0x61f*-0x4+0x1*0x82b,_0x2d1b9e)[_0x34428c(0x49b,0x4eb,0x4c9,0x408)](),_0x2879ff=_0x1a6a0f['substring'](_0x4417fb['JtRql'](_0x2d1b9e,-0xa89+0x1a48+-0xfbe))[_0x1f85b2(0x3db,0x3ef,0x41f,0x391)]();if(_0x4045ef[_0x2b5b4f]){if(_0x4417fb[_0x34428c(0x584,0x46b,0x4fe,0x516)](_0x4417fb[_0x1f85b2(0x59d,0x5c3,0x57f,0x4d0)],_0x4417fb['ZoEhS'])){const _0x12b396=_0x4417fb[_0x34428c(0x4f9,0x3db,0x51d,0x457)](_0xc1b89f,_0x36ca7b);if(_0x12b396){const _0x270fa3={};_0x270fa3[_0x34428c(0x460,0x4ee,0x527,0x436)]=_0x4417fb[_0x34428c(0x42e,0x577,0x49a,0x4c5)],_0x270fa3[_0x1f85b2(0x4ff,0x52f,0x4e1,0x4db)]=_0x12b396,_0x270fa3['position']=_0x2a5601,_0x270fa3[_0x34428c(0x3b9,0x3b7,0x4f2,0x4a2)+'fits']=[],_0x5e938d['push'](_0x270fa3);}}else _0x2d0f60[_0x4045ef[_0x2b5b4f]]=_0x2879ff;}else _0x2b5b4f&&_0x2879ff&&(_0x4417fb[_0x34428c(0x4ee,0x515,0x34c,0x433)]!==_0x4417fb[_0x34428c(0x575,0x4f6,0x530,0x514)]?console[_0x34428c(0x4fc,0x41e,0x4b6,0x474)](_0x34428c(0x382,0x432,0x34e,0x406)+_0x1f85b2(0x50a,0x437,0x5d5,0x4ce)+_0x34428c(0x6a1,0x4fd,0x5ee,0x5c0)+_0x34428c(0x4c4,0x3bd,0x357,0x3ff)+_0x2b5b4f+'\x22'):(_0x58e842=_0x2c9f33(_0x38051c,_0x24d3c3,_0x139904,_0x4417fb[_0x34428c(0x500,0x539,0x4c1,0x540)]),_0x2178aa[_0x34428c(0x4cb,0x42f,0x48f,0x474)](_0x4417fb[_0x1f85b2(0x429,0x4c5,0x406,0x459)],_0x3e4863['length'],_0x4417fb[_0x1f85b2(0x4ba,0x4d6,0x476,0x482)],_0x3547c0)));}else return null;}if(!_0x2d0f60[_0x1f85b2(0x4ea,0x537,0x4f0,0x599)]){if(_0x4417fb['fsjUX']!==_0x4417fb[_0x34428c(0x582,0x4e0,0x4c8,0x573)])return null;else _0x4417fb[_0x1f85b2(0x4b1,0x425,0x4c3,0x563)](_0x4b0ff5),_0x4417fb[_0x1f85b2(0x42a,0x4c6,0x47c,0x3b7)](_0x2cbf1f,new _0x607dd1(_0x1f85b2(0x464,0x3a3,0x45b,0x43f)+_0x34428c(0x51d,0x5bb,0x6c4,0x5d8)));}return console['log'](_0x4417fb[_0x1f85b2(0x43b,0x48f,0x469,0x37b)],_0x2d0f60),_0x2d0f60;}function extractCharacterAndOutfitTags(_0x1c1566){const _0x5bc809={'NjCfZ':function(_0x279bed,_0x390aa9){return _0x279bed(_0x390aa9);},'ETddn':function(_0x15fdb5,_0x304f37){return _0x15fdb5===_0x304f37;},'hjfmH':function(_0x4ecccd,_0xce20bd){return _0x4ecccd!==_0xce20bd;},'KlxBm':_0x4da1a9(0x37,-0x3f,0x4f,0x21),'buOOJ':_0x12918b(0x178,0x10c,0x205,0x173),'cswpP':function(_0x27a822,_0x3e5aff){return _0x27a822===_0x3e5aff;},'ZwdVt':'mbivL','jzchB':_0x12918b(0x26e,0x29f,0x304,0x262),'zCyvd':function(_0x4aa74d,_0x495d0f){return _0x4aa74d!==_0x495d0f;},'bGnum':'rYLYR','rjPku':function(_0x1ae89f,_0x16a0df){return _0x1ae89f===_0x16a0df;},'eTAWf':_0x4da1a9(0x139,0x4c,0xc1,0x180),'hfCOm':function(_0x1fb18a,_0xc90f9b){return _0x1fb18a===_0xc90f9b;},'QkiCl':_0x12918b(0x254,0x2fc,0x2d5,0x2cf),'IOOlO':_0x12918b(0x2ea,0x16b,0x1a1,0x21b)},_0xcf39d1=[];_0x1c1566=_0x1c1566['replace'](/<thinking>[\s\S]*?<\/thinking>/gi,'')['trim']();const _0x164866=/<(人物|服装)>([\s\S]*?)<\/\1>/g;let _0x3b90c7;function _0x12918b(_0x21a753,_0x12dded,_0x1344f5,_0x191ea0){return _0x2238(_0x191ea0-0x64,_0x1344f5);}function _0x4da1a9(_0x36c759,_0x1a0f70,_0x1d2d29,_0x3e28a1){return _0x2238(_0x36c759- -0xc7,_0x3e28a1);}while((_0x3b90c7=_0x164866[_0x12918b(0x245,0x1d3,0x163,0x250)](_0x1c1566))!==null){const _0x39f1c3=_0x3b90c7[0x11*0xe9+0x98*0x24+0x83*-0x48],_0x34c6fa=_0x5bc809['NjCfZ'](preprocessTagContent,_0x3b90c7[0x1ff7+0xb74+0x1*-0x2b69]),_0x2f37d0=_0x3b90c7[_0x12918b(0x1ac,0x143,0x1b1,0x19a)];if(_0x5bc809[_0x4da1a9(0x56,0x138,0x65,0x123)](_0x39f1c3,'人物')){if(_0x5bc809['hjfmH']('eizlB',_0x5bc809[_0x4da1a9(0xd2,0xe3,0x19b,0x45)])){const _0xbd9ab9=_0x1866d2['data'];let _0x108499=_0x12918b(0x1a4,0x1f9,0xff,0x150);return _0x108499+='中文名称:\x20'+(_0xbd9ab9[_0x12918b(0x2c5,0x2aa,0x2ec,0x22b)]||'')+'\x0a',_0x108499+='英文名称:\x20'+(_0xbd9ab9[_0x12918b(0x155,0x300,0x1a3,0x23d)]||'')+'\x0a',_0x108499+=_0x4da1a9(0x113,0x1ed,0x106,0x1cd)+(_0xbd9ab9['characterT'+_0x4da1a9(0xbc,0x1a1,0x1b,0xa8)]||'')+'\x0a',_0x108499+='五官外貌:\x20'+(_0xbd9ab9[_0x12918b(0x232,0x24f,0x12e,0x20d)+_0x4da1a9(0x188,0x235,0x18a,0x23f)]||'')+'\x0a',_0x108499+=_0x4da1a9(0x18f,0x1cb,0xb6,0x1e4)+(_0xbd9ab9[_0x4da1a9(0xe2,0x1af,0x1c9,0x1d)+_0x4da1a9(0x6b,0xad,0xb4,-0x3b)]||'')+'\x0a',_0x108499+=_0x12918b(0x396,0x35c,0x384,0x2d5)+(_0xbd9ab9[_0x12918b(0x241,0x119,0xdc,0x195)+'FW']||'')+'\x0a',_0x108499+='上半身SFW背面:\x20'+(_0xbd9ab9['upperBodyS'+_0x4da1a9(-0x17,0xd4,-0xec,-0xf4)]||'')+'\x0a',_0x108499+=_0x4da1a9(0x9f,0x45,0x140,0xa0)+(_0xbd9ab9[_0x4da1a9(-0x5,0xea,-0xa0,0x47)+'W']||'')+'\x0a',_0x108499+=_0x4da1a9(0x71,0x5e,0xe0,0x105)+(_0xbd9ab9[_0x4da1a9(-0x5,0xa0,-0x94,0x4e)+_0x4da1a9(0xbd,0x22,0x1a0,0x78)]||'')+'\x0a',_0x108499+='上半身NSFW:\x20'+(_0xbd9ab9['upperBodyN'+_0x12918b(0x17f,0x6e,0x180,0x112)]||'')+'\x0a',_0x108499+=_0x12918b(0x1e3,0x256,0x1f0,0x28e)+'\x20'+(_0xbd9ab9[_0x4da1a9(0x93,0x4b,0x10a,0xd6)+'SFWBack']||'')+'\x0a',_0x108499+=_0x4da1a9(0x127,0x39,0x157,0x1b0)+(_0xbd9ab9['fullBodyNS'+'FW']||'')+'\x0a',_0x108499+=_0x12918b(0x205,0x285,0x310,0x290)+'\x20'+(_0xbd9ab9[_0x12918b(0x225,0x1f6,0x35b,0x2bb)+_0x12918b(0xbd,0xa4,0x4a,0x114)]||'')+'\x0a',_0x108499+=_0x4da1a9(0xec,0x143,0xaf,0x19f),_0x108499;}else{const _0x2f5766=parseCharacterData(_0x34c6fa);if(_0x2f5766){const _0x5776ef={};_0x5776ef[_0x12918b(0xf2,0x69,0x71,0x14a)]=_0x5bc809[_0x4da1a9(0xa5,0x14c,0x110,-0x23)],_0x5776ef[_0x4da1a9(0x115,0x2b,0x202,0x87)]=_0x2f5766,_0x5776ef['position']=_0x2f37d0,_0x5776ef[_0x12918b(0x15b,0x291,0xd5,0x1b6)+_0x12918b(0x2c2,0x1d3,0x1cb,0x1f3)]=[],_0xcf39d1[_0x4da1a9(0x6e,0x34,-0x69,-0x3c)](_0x5776ef);}}}else{if(_0x39f1c3==='服装'){const _0x2aae67=_0x5bc809[_0x12918b(0x1f3,0x2ef,0x363,0x2c4)](parseOutfitData,_0x34c6fa);if(_0x2aae67){if(_0x5bc809[_0x12918b(0x25c,0x12d,0x254,0x216)](_0x5bc809[_0x12918b(0x210,0x319,0x23f,0x2ed)],_0x5bc809[_0x4da1a9(0x1c2,0x116,0x294,0x1c3)])){const _0x4232ac={};_0x4232ac['type']=_0x5bc809[_0x12918b(0x251,0x28f,0x100,0x1bd)],_0x4232ac[_0x12918b(0x1c7,0x32a,0x23a,0x240)]=_0x2aae67,_0x4232ac[_0x12918b(0x208,0x229,0x304,0x26c)]=_0x2f37d0,_0xcf39d1['push'](_0x4232ac);}else _0x116755[_0x35b278]&&(_0x3c6f1e[_0x3ea4c6]=_0x1c08aa[_0x3cf6c0]);}}}}_0xcf39d1[_0x4da1a9(0x19b,0x17c,0xb9,0x24b)]((_0x316edb,_0x1670d6)=>_0x316edb[_0x4da1a9(0x141,0x21b,0x14a,0x1d7)]-_0x1670d6[_0x12918b(0x23e,0x260,0x233,0x26c)]);let _0x415e7e=null;const _0x5f2c17=[],_0x188932=[];for(const _0x43c676 of _0xcf39d1){if(_0x5bc809[_0x4da1a9(0x194,0x1d4,0x126,0x16a)](_0x12918b(0x221,0x172,0x231,0x156),_0x5bc809[_0x4da1a9(0xd1,0x170,0x11a,-0x1f)])){if(_0x5bc809['cswpP'](_0x43c676[_0x12918b(0x1e0,0x197,0x13a,0x14a)],_0x12918b(0x1cd,0x1c9,0x1c5,0x173)))_0x415e7e=_0x43c676,_0x5f2c17[_0x4da1a9(0x6e,0x7f,0x14e,0x8d)](_0x43c676);else _0x5bc809[_0x4da1a9(0x60,0xf,0x141,-0x35)](_0x43c676['type'],_0x5bc809['jzchB'])&&(_0x415e7e?_0x5bc809[_0x12918b(0x3b2,0x2c7,0x20e,0x2e5)](_0x5bc809[_0x12918b(0x255,0x31f,0x2c2,0x2d7)],_0x5bc809['eTAWf'])?_0xdfdc7b[_0x4241a4[_0x4b91c9]]=_0x338794:_0x415e7e[_0x12918b(0x150,0xc5,0x110,0x1b6)+_0x12918b(0x244,0x2b1,0x1bb,0x1f3)][_0x4da1a9(0x6e,0x5,0xce,-0x52)](_0x43c676[_0x12918b(0x277,0x20e,0x170,0x240)]):_0x5bc809[_0x12918b(0x17b,0x9d,0x1e8,0x160)](_0x5bc809[_0x12918b(0x10a,0x126,0x135,0x149)],_0x5bc809['IOOlO'])?_0x27f9ec[_0x4da1a9(0x5d,0x35,0xd8,0xbc)](_0x12918b(0x1a5,0x9a,0x31,0x11a)+_0x12918b(0x252,0x1a8,0x289,0x24b)+_0x4da1a9(0xd7,0x5,0x14e,0x5b)+_0x12918b(0x112,0xe9,0x165,0x113)+_0x30b8d8+'\x22'):_0x188932[_0x12918b(0xaf,0x251,0xed,0x199)](_0x43c676[_0x12918b(0x325,0x162,0x297,0x240)]));}else return _0xd6565d[_0x12918b(0x142,0x19f,0x17f,0x1b8)](_0x46bd10=>_0x12a996(_0x46bd10,_0x56af46,_0x910791,_0x52fdcd));}return{'characters':_0x5f2c17[_0x12918b(0x217,0x259,0x19e,0x1b8)](_0x1a9f60=>({..._0x1a9f60[_0x4da1a9(0x115,0xc5,0x18e,0x1a9)],'matchedOutfits':_0x1a9f60[_0x4da1a9(0x8b,0x23,-0x42,0xf3)+'fits']})),'outfits':_0x188932};}function getCurrentCharacterPreset(){const _0x281dd7=extension_settings[extensionName],_0x3c4ca3=_0x281dd7[_0x3bc0a6(0x31,-0x41,0x53,0xa0)+'resetId'];if(!_0x3c4ca3||!_0x281dd7[_0x469b41(0x43b,0x533,0x562,0x4fd)+_0x3bc0a6(-0xb5,-0x21f,-0x155,-0x169)][_0x3c4ca3])return null;const _0x4969b0={};function _0x469b41(_0x2f06b5,_0x254533,_0x3fdde4,_0x16d259){return _0x2238(_0x16d259-0x2ab,_0x254533);}_0x4969b0['id']=_0x3c4ca3,_0x4969b0['data']=_0x281dd7[_0x469b41(0x533,0x536,0x4bd,0x4fd)+_0x3bc0a6(-0x102,-0x1ae,-0x155,-0x74)][_0x3c4ca3];function _0x3bc0a6(_0x3072f7,_0x28bf14,_0x46a3d1,_0x152f08){return _0x2238(_0x46a3d1- -0x1ff,_0x152f08);}return _0x4969b0;}function buildCharacterText(_0x290478){const _0x4561b5={};_0x4561b5[_0x552706(-0x1bb,-0x227,-0xcd,-0x1e0)]=_0x2aad32(0x525,0x4aa,0x3cd,0x45b);const _0xbd8953=_0x4561b5,_0x2f90df=_0x290478[_0x2aad32(0x51c,0x532,0x5f8,0x54b)];let _0xa8f8a9=_0xbd8953[_0x552706(-0x1bb,-0x21c,-0x1db,-0x1a6)];_0xa8f8a9+='中文名称:\x20'+(_0x2f90df[_0x552706(-0xa6,-0x198,-0x30,-0x47)]||'')+'\x0a';function _0x2aad32(_0x370ce3,_0x390a94,_0x269fb0,_0x438de6){return _0x2238(_0x438de6-0x36f,_0x370ce3);}_0xa8f8a9+='英文名称:\x20'+(_0x2f90df['nameEN']||'')+'\x0a',_0xa8f8a9+=_0x552706(-0x93,-0x5d,0x29,-0x10d)+(_0x2f90df[_0x552706(-0x54,-0x102,-0x9b,0x79)+_0x552706(-0xea,-0x12a,-0xf4,-0x93)]||'')+'\x0a';function _0x552706(_0x537f6a,_0xaf23fb,_0x22ec91,_0xd89249){return _0x2238(_0x537f6a- -0x26d,_0xd89249);}return _0xa8f8a9+=_0x552706(-0x172,-0x186,-0x88,-0xc0)+(_0x2f90df[_0x552706(-0xc4,-0x16f,-0x130,-0x190)+_0x2aad32(0x5f5,0x54e,0x4ea,0x5be)]||'')+'\x0a',_0xa8f8a9+=_0x2aad32(0x601,0x5ca,0x66e,0x5c5)+(_0x2f90df[_0x2aad32(0x45f,0x46c,0x4d4,0x518)+_0x2aad32(0x4a8,0x4f4,0x3f0,0x4a1)]||'')+'\x0a',_0xa8f8a9+=_0x552706(0x4,0xb,0x55,-0x93)+(_0x2f90df[_0x552706(-0x13c,-0x108,-0x1ba,-0x1af)+'FW']||'')+'\x0a',_0xa8f8a9+=_0x552706(-0xa5,-0x6c,-0x140,-0x12)+(_0x2f90df[_0x552706(-0x13c,-0x5f,-0x17b,-0x1a8)+_0x2aad32(0x49b,0x489,0x4b1,0x41f)]||'')+'\x0a',_0xa8f8a9+=_0x2aad32(0x4f3,0x56d,0x48b,0x4d5)+(_0x2f90df['fullBodySF'+'W']||'')+'\x0a',_0xa8f8a9+='下半身SFW背面:\x20'+(_0x2f90df[_0x2aad32(0x475,0x447,0x522,0x431)+_0x2aad32(0x469,0x45f,0x5b4,0x4f3)]||'')+'\x0a',_0xa8f8a9+='上半身NSFW:\x20'+(_0x2f90df[_0x2aad32(0x55b,0x455,0x5ae,0x4c9)+_0x2aad32(0x392,0x36d,0x3a7,0x41d)]||'')+'\x0a',_0xa8f8a9+=_0x552706(-0x43,-0x9b,0x87,0x21)+'\x20'+(_0x2f90df[_0x2aad32(0x3db,0x502,0x41f,0x4c9)+_0x2aad32(0x51e,0x488,0x408,0x4e6)]||'')+'\x0a',_0xa8f8a9+='下半身NSFW:\x20'+(_0x2f90df['fullBodyNS'+'FW']||'')+'\x0a',_0xa8f8a9+=_0x552706(-0x41,0x7a,0x5d,-0xcb)+'\x20'+(_0x2f90df[_0x552706(-0x16,0xb8,-0x23,-0x102)+_0x552706(-0x1bd,-0x1bf,-0x17a,-0x239)]||'')+'\x0a',_0xa8f8a9+=_0x552706(-0xba,-0x14f,-0x19,-0x2a),_0xa8f8a9;}export async function handleCharacterPromptModify(_0x333742,_0xe359bc=[]){function _0x5ab98d(_0x5e62cf,_0xdf90a,_0x3dd1aa,_0x7fa54c){return _0x2238(_0x7fa54c-0x8b,_0xdf90a);}const _0x4ea45c={'uqgvN':_0x5ab98d(0x23c,0x17f,0x145,0x1ce),'hGLzr':_0x5ab98d(0x1a2,0x1ce,0xf3,0x19a),'YoPfA':_0x5ab98d(0x11c,0x176,0x22e,0x141)+'PromptModi'+_0x5ab98d(0x28c,0x219,0x1dd,0x232)+'ng\x20charact'+_0x5ab98d(0x1fc,0x17c,0x1b0,0x16f)+_0x5ab98d(0x2c0,0x279,0x1c6,0x1de)+_0x15566d(0x4c7,0x543,0x58b,0x4c1),'bvHba':function(_0x4f4c1c){return _0x4f4c1c();},'ycuOZ':_0x15566d(0x3e6,0x4b4,0x4af,0x3f5),'uSIQj':_0x15566d(0x3a9,0x457,0x305,0x495)+'PromptModi'+_0x15566d(0x55a,0x61e,0x5f2,0x5ef)+_0x15566d(0x45e,0x3a4,0x448,0x4ca),'hYRgU':_0x15566d(0x3a9,0x2c3,0x3a9,0x3f2)+_0x15566d(0x4da,0x438,0x49d,0x54f)+_0x15566d(0x49f,0x535,0x3b0,0x3d4)+_0x15566d(0x3a8,0x47d,0x3ea,0x45f),'kKfrb':_0x5ab98d(0x1e2,0x202,0x1d8,0x141)+_0x15566d(0x4da,0x4e1,0x4bc,0x56d)+_0x15566d(0x49f,0x3f8,0x44f,0x450)+_0x15566d(0x3bb,0x32c,0x3cc,0x459),'yXbWj':function(_0x5e72c9,_0x5c853b){return _0x5e72c9||_0x5c853b;},'vhCkZ':function(_0xc12573,_0x239837){return _0xc12573!==_0x239837;},'iUEpN':_0x15566d(0x4d6,0x558,0x56b,0x42c),'iGoQu':_0x15566d(0x4e8,0x589,0x45b,0x5aa),'ZrVLX':function(_0x505c3d,_0x436596){return _0x505c3d===_0x436596;},'blrjo':'dtrzZ','besFW':'[character'+'PromptModi'+'fy]\x20Charac'+_0x15566d(0x47c,0x3aa,0x3b4,0x48d)+_0x5ab98d(0x396,0x350,0x35c,0x2e5),'vLYuP':_0x5ab98d(0x12c,0x2bc,0x2db,0x20a)+'y','NlURo':function(_0x5896be){return _0x5896be();},'NQoQK':'[character'+_0x15566d(0x4da,0x5a5,0x49c,0x507)+_0x5ab98d(0x25c,0x214,0x1a3,0x271)+_0x15566d(0x41c,0x50b,0x480,0x410)+_0x15566d(0x550,0x5ba,0x5e0,0x588)+_0x15566d(0x3ca,0x3fa,0x47f,0x325),'QiYDp':function(_0x20a78b,_0x561d19){return _0x20a78b(_0x561d19);},'sQueh':function(_0x303ae4,_0x4bffcc){return _0x303ae4(_0x4bffcc);},'yVRCd':_0x5ab98d(0x7a,0x217,0x120,0x141)+'PromptModi'+'fy]\x20合并相邻消息'+'后:','mfMTp':function(_0x37e4c7,_0x569ea9,_0x2800f3){return _0x37e4c7(_0x569ea9,_0x2800f3);},'UePKV':_0x15566d(0x3dc,0x317,0x3cc,0x3b4),'GcNbs':function(_0x322131,_0x6d473a,_0x310972){return _0x322131(_0x6d473a,_0x310972);},'FUNad':function(_0x103d02,_0x16fb64,_0x1bde37,_0xfc45ac,_0x1021cd){return _0x103d02(_0x16fb64,_0x1bde37,_0xfc45ac,_0x1021cd);},'XWxfB':_0x5ab98d(0x1a8,0x153,0x215,0x1a9),'hcCKp':_0x15566d(0x3a9,0x34d,0x324,0x2fd)+'PromptModi'+_0x5ab98d(0x251,0x14e,0x19d,0x203)+_0x15566d(0x52e,0x4d2,0x5e1,0x5f6),'iCOec':function(_0x9ea5d9,_0x2ef23b){return _0x9ea5d9>_0x2ef23b;},'mzAEj':function(_0x2ffa55,_0x30b08f){return _0x2ffa55>=_0x30b08f;},'xPFak':function(_0x18bd32,_0x4a3e7e){return _0x18bd32===_0x4a3e7e;},'IvYZT':_0x5ab98d(0x176,0x106,0x107,0x1b3),'QPaln':_0x15566d(0x558,0x623,0x53f,0x4b9),'RXuIZ':'[character'+_0x15566d(0x4da,0x516,0x543,0x47b)+_0x5ab98d(0x209,0x28b,0x22b,0x2e4)+'ed','CBaqE':_0x15566d(0x3a9,0x419,0x3b1,0x44c)+_0x5ab98d(0x283,0x2ba,0x29b,0x272)+'fy]\x20LLM\x20ou'+_0x5ab98d(0x215,0x1b4,0x2ca,0x226),'frjQx':_0x15566d(0x3b3,0x32e,0x39e,0x34f),'zyzhz':function(_0x3f9a8b,_0xdc7897){return _0x3f9a8b===_0xdc7897;},'PzYjZ':_0x5ab98d(0x18f,0x184,0x1c3,0x169),'KNhPJ':'LxdUQ','uuMfm':_0x5ab98d(0xe8,0x221,0x122,0x141)+_0x15566d(0x4da,0x4c0,0x4dc,0x4a2)+_0x5ab98d(0x2b0,0x28d,0x371,0x283)+_0x15566d(0x44f,0x482,0x444,0x4c4)+_0x15566d(0x3e8,0x324,0x3ef,0x320)+_0x5ab98d(0x131,0x28c,0x168,0x1e1)+_0x15566d(0x3d4,0x3a0,0x2fd,0x314),'VdrEX':_0x15566d(0x3a9,0x383,0x463,0x3f3)+'PromptModi'+_0x15566d(0x4c8,0x42d,0x442,0x587)+_0x15566d(0x525,0x597,0x476,0x47f)+'or\x20debuggi'+_0x15566d(0x4a7,0x58a,0x465,0x422),'tezIy':_0x15566d(0x3a9,0x34b,0x394,0x2f7)+_0x15566d(0x4da,0x4fb,0x456,0x4e7)+_0x15566d(0x4e2,0x588,0x50d,0x577)+_0x5ab98d(0x1c1,0x2c8,0x20a,0x217),'IqfRk':function(_0x4bc462,_0x13fdfd){return _0x4bc462>_0x13fdfd;},'ioNnH':'角色/服装提示词修改'+_0x5ab98d(0x251,0x2bb,0x311,0x25b),'rNsWa':function(_0x3f278c,_0x4b5a68){return _0x3f278c!==_0x4b5a68;},'MqVez':_0x5ab98d(0x2a0,0x30c,0x243,0x284),'ZTGxd':_0x5ab98d(0x71,0xbf,0x1e8,0x141)+_0x5ab98d(0x2d0,0x2d6,0x18f,0x272)+'fy]\x20Error:'};console[_0x5ab98d(0xef,0xe0,0xd9,0x1af)](_0x4ea45c[_0x15566d(0x3d2,0x3bd,0x357,0x3d1)]);function _0x15566d(_0x1e0597,_0xe7a66e,_0x47a7cd,_0x37b970){return _0x2238(_0x1e0597-0x2f3,_0x37b970);}toastr[_0x5ab98d(0x383,0x2eb,0x2ba,0x2ce)](_0x15566d(0x3a9,0x333,0x437,0x420)+'PromptModi'+_0x15566d(0x41e,0x36f,0x4d2,0x32f)+_0x5ab98d(0x1ef,0x39b,0x252,0x2cb));try{const _0x939d3e=_0x4ea45c['bvHba'](getContext),_0x89d1fa=extension_settings[extensionName],_0x29dd08=getCurrentCharacterPreset();if(!_0x29dd08){toastr[_0x5ab98d(0x7f,0x16a,0xc6,0x151)](_0x4ea45c[_0x5ab98d(0x1b0,0x1c9,0x23a,0x244)]);return;}console[_0x15566d(0x417,0x46e,0x4c2,0x508)](_0x4ea45c[_0x5ab98d(0x1d7,0x173,0x1d2,0x1bb)],_0x29dd08['id']);const _0x34e085=_0x29dd08[_0x5ab98d(0x197,0x1ff,0x2ae,0x267)]['generation'+_0x15566d(0x3a7,0x479,0x2fd,0x2cf)]||'',_0x308262=_0x29dd08[_0x15566d(0x4cf,0x40c,0x454,0x4be)]['generation'+_0x5ab98d(0x277,0x137,0x27d,0x196)]||'',_0x16d9a4=_0x29dd08['data']['generation'+_0x5ab98d(0x202,0x258,0x248,0x18e)]||{};console[_0x5ab98d(0x22d,0xef,0x108,0x1af)](_0x4ea45c[_0x5ab98d(0x336,0x350,0x269,0x2d2)],_0x34e085),console[_0x15566d(0x417,0x3f0,0x36e,0x375)](_0x5ab98d(0x1a1,0x17b,0x184,0x141)+'PromptModi'+_0x5ab98d(0x22e,0x174,0x327,0x237)+_0x5ab98d(0x1e7,0x296,0x128,0x208)+':',_0x308262),console[_0x15566d(0x417,0x424,0x4ea,0x352)](_0x4ea45c[_0x15566d(0x3c7,0x421,0x3f8,0x37a)],_0x16d9a4);const _0x3b2e7f=_0x4ea45c['yXbWj'](_0x333742,''),_0x3d8cfa=[];_0x333742&&_0x3d8cfa[_0x5ab98d(0x238,0x1db,0x133,0x1c0)](_0x333742);if(_0x34e085){if(_0x4ea45c[_0x15566d(0x512,0x4b4,0x504,0x544)](_0x4ea45c[_0x5ab98d(0x27e,0x2c3,0x214,0x2f3)],_0x4ea45c[_0x5ab98d(0x169,0x226,0x28e,0x1e3)]))_0x3d8cfa[_0x5ab98d(0x211,0x275,0xf2,0x1c0)](_0x34e085);else{_0x3ac3e4['error'](_0x4ea45c[_0x5ab98d(0xfb,0x147,0xb7,0x1a7)]);return;}}if(_0x308262){if(_0x4ea45c['ZrVLX'](_0x4ea45c[_0x15566d(0x4fd,0x5aa,0x494,0x5a9)],_0x4ea45c[_0x15566d(0x4fd,0x5d7,0x5d5,0x5d5)]))_0x3d8cfa[_0x5ab98d(0x167,0x1e6,0x281,0x1c0)](_0x308262);else{const _0x511d3d=_0x107f94?function(){function _0x454cbf(_0x47509a,_0x49e36c,_0x165d99,_0x218395){return _0x5ab98d(_0x47509a-0xe2,_0x47509a,_0x165d99-0x70,_0x165d99- -0x448);}if(_0x5affc0){const _0x6bdbec=_0x182cff[_0x454cbf(-0x2de,-0x289,-0x2e4,-0x27c)](_0x1c58ea,arguments);return _0x1440ee=null,_0x6bdbec;}}:function(){};return _0x2c6195=![],_0x511d3d;}}const _0x568908=_0x3d8cfa[_0x5ab98d(0x15f,0x244,0x119,0x1d4)]('\x0a');console[_0x5ab98d(0x28c,0x23a,0x285,0x1af)](_0x4ea45c[_0x5ab98d(0x230,0xa7,0xea,0x161)],_0x568908);let _0x1eb7a9=buildPromptForRequestType(_0x4ea45c[_0x5ab98d(0x1c5,0x233,0x35a,0x282)],_0x3b2e7f);const _0x247288=generateCharacterListText(_0x568908),_0x25129c=generateOutfitEnableListText(),_0x2e8e6a=_0x4ea45c['NlURo'](generateCommonCharacterListText);console[_0x15566d(0x417,0x3b0,0x44b,0x4d4)](_0x4ea45c[_0x5ab98d(0x1c5,0xfe,0x1af,0x1a6)],_0x247288);const _0x2e3756=_0x939d3e['chatMetada'+'ta']?.[_0x5ab98d(0x1df,0x16d,0x64,0x133)]||{},_0x428538=_0x4ea45c[_0x15566d(0x505,0x560,0x45c,0x56a)](buildCharacterText,_0x29dd08);_0x1eb7a9=_0x4ea45c[_0x15566d(0x44a,0x37b,0x524,0x40d)](mergeAdjacentMessages,_0x1eb7a9),console[_0x15566d(0x417,0x32a,0x399,0x40b)](_0x4ea45c[_0x5ab98d(0x198,0x2dd,0x1d9,0x27d)],_0x1eb7a9);const _0x864d3d=_0x4ea45c['mfMTp'](findMessageIndexWithPlaceholder,_0x1eb7a9,_0x4ea45c[_0x15566d(0x548,0x5e0,0x5eb,0x469)]);console[_0x5ab98d(0x156,0xbc,0x19c,0x1af)](_0x5ab98d(0x1f2,0x16f,0x175,0x141)+_0x5ab98d(0x231,0x1d9,0x25e,0x272)+_0x15566d(0x3ed,0x302,0x4ce,0x42a)+'equirement'+_0x15566d(0x531,0x61d,0x53f,0x590)+_0x15566d(0x3ba,0x3b8,0x47e,0x376),_0x864d3d);const _0x1f9baa={..._0x16d9a4,..._0x2e3756},_0x3a5e24={};_0x3a5e24['context']=_0x34e085,_0x3a5e24[_0x5ab98d(0x270,0x32d,0x2b6,0x303)+_0x5ab98d(0x2ce,0x3a2,0x35c,0x2d4)]=_0x308262,_0x3a5e24['variables']=_0x1f9baa,_0x3a5e24[_0x5ab98d(0x354,0x326,0x22a,0x2a5)]=_0x333742||'',_0x3a5e24['characterL'+_0x15566d(0x4fa,0x590,0x450,0x5bb)]=_0x247288,_0x3a5e24[_0x15566d(0x4e4,0x53f,0x55e,0x45f)+_0x5ab98d(0xe0,0x1e3,0x1b6,0x15c)]=_0x25129c,_0x3a5e24[_0x5ab98d(0x252,0x231,0x224,0x231)+'acterListT'+_0x5ab98d(0x28e,0x275,0x239,0x254)]=_0x2e8e6a;const _0x2fa402=_0x3a5e24,{messages:_0x49b151,replacedVariables:_0x15a233}=_0x4ea45c[_0x5ab98d(0x320,0x2cf,0x319,0x301)](replaceAllPlaceholders,_0x1eb7a9,_0x2fa402);_0x1eb7a9=_0x49b151,_0x1eb7a9=_0x4ea45c[_0x5ab98d(0x7c,0x1c2,0x6c,0x149)](_0x2eeb87,_0x1eb7a9,_0x4ea45c[_0x15566d(0x4d4,0x496,0x47a,0x580)],_0x428538,_0x15a233),console['log'](_0x4ea45c[_0x15566d(0x511,0x501,0x5cd,0x462)],_0x1eb7a9);let _0x561323='';_0x4ea45c[_0x5ab98d(0x26d,0x372,0x378,0x30d)](_0x15a233[_0x15566d(0x502,0x51d,0x43a,0x48b)],-0xa*-0x226+-0xd*0xaf+-0x5*0x285)&&(_0x4ea45c['vhCkZ']('RFxqs',_0x5ab98d(0x125,0x159,0x186,0x14c))?_0x561323=_0x15566d(0x45c,0x522,0x3bf,0x386)+_0x5ab98d(0x260,0x27e,0x281,0x22a)+[..._0x15a233][_0x5ab98d(0x292,0x24a,0x19e,0x1d4)]('、')+'\x0a':_0x56ee8e[_0x5ab98d(0x1f2,0x26b,0x157,0x1c0)](..._0x4c1175[_0x15566d(0x445,0x356,0x3a6,0x3b8)+'fits']));if(_0xe359bc&&_0x4ea45c['iCOec'](_0xe359bc[_0x5ab98d(0x266,0x308,0x14b,0x225)],-0x13aa+0xc54+0x756)&&_0x4ea45c['mzAEj'](_0x864d3d,0x1*0x175+0x1e3*0x3+-0x71e)){if(_0x4ea45c[_0x5ab98d(0x256,0x29e,0x292,0x233)](_0x4ea45c[_0x5ab98d(0x2a4,0x316,0x342,0x30a)],_0x4ea45c[_0x5ab98d(0x35c,0x3f4,0x3da,0x30a)]))_0x1eb7a9=_0x4ea45c[_0x5ab98d(0x92,0xe6,0x11e,0x149)](attachImagesToMessage,_0x1eb7a9,_0x864d3d,_0xe359bc,_0x4ea45c[_0x5ab98d(0x287,0x280,0x115,0x1ec)]),console['log'](_0x4ea45c[_0x15566d(0x415,0x481,0x36e,0x32f)],_0xe359bc[_0x5ab98d(0x2f5,0x26a,0x22e,0x225)],_0x15566d(0x3bc,0x406,0x479,0x30e)+_0x5ab98d(0x34e,0x2c2,0x389,0x2e9)+_0x15566d(0x3b2,0x46d,0x490,0x479),_0x864d3d);else{const _0x530279={};_0x530279[_0x5ab98d(0x250,0x1d9,0xe9,0x171)]=_0x4ea45c[_0x5ab98d(0x20a,0x266,0x24c,0x1bf)],_0x530279[_0x5ab98d(0x281,0x30c,0x200,0x267)]=_0x185dc4,_0x530279[_0x15566d(0x4fb,0x5a4,0x40e,0x4da)]=_0x3f6812,_0x530279[_0x5ab98d(0x1ec,0x101,0x151,0x1dd)+_0x15566d(0x482,0x55b,0x51c,0x3c0)]=[],_0x16ccc0[_0x15566d(0x428,0x45d,0x467,0x3c0)](_0x530279);}}_0x4ea45c['mfMTp'](updateCombinedPrompt,_0x1eb7a9,_0x561323);const _0x830c2b={};_0x830c2b[_0x5ab98d(0x1f1,0x1d3,0xa3,0x183)]=0x493e0;const _0x114c72=await LLM_CHAR_MODIFY(_0x1eb7a9,_0x830c2b);console['log'](_0x4ea45c[_0x5ab98d(0x222,0x24d,0xd5,0x175)],_0x114c72);if(!_0x114c72){if(_0x5ab98d(0x2fa,0x32a,0x399,0x2ea)!==_0x4ea45c['frjQx']){toastr[_0x15566d(0x3b9,0x364,0x427,0x384)](_0x4ea45c[_0x15566d(0x40f,0x347,0x45f,0x3dd)]);return;}else _0x3fd1c7[_0x59ac99]&&_0x42d0fe[_0x17926a]!==_0x58c789[_0x372857]&&_0x33af8e++;}const _0x23e4fa=_0x4ea45c[_0x15566d(0x505,0x59e,0x41e,0x56d)](extractCharacterAndOutfitTags,_0x114c72);if(_0x4ea45c[_0x5ab98d(0x194,0x1c2,0x20e,0x163)](_0x23e4fa['characters'][_0x15566d(0x48d,0x46f,0x4a8,0x509)],-0x11fc+0x4bb+-0x3*-0x46b)&&_0x23e4fa['outfits'][_0x15566d(0x48d,0x42d,0x457,0x536)]===-0x1*0x1869+-0x6*0x5b+-0x5*-0x54f){if(_0x4ea45c[_0x15566d(0x512,0x505,0x518,0x48d)](_0x4ea45c['PzYjZ'],_0x4ea45c[_0x15566d(0x4f7,0x47b,0x591,0x4ed)])){toastr[_0x15566d(0x565,0x636,0x626,0x4e2)](_0x15566d(0x4db,0x464,0x538,0x505)+_0x5ab98d(0x1c2,0x1c4,0x2bb,0x21e)),console['log'](_0x4ea45c[_0x15566d(0x4f0,0x413,0x4d3,0x53a)]),console[_0x15566d(0x417,0x412,0x3bd,0x3c0)](_0x4ea45c[_0x15566d(0x494,0x51f,0x54d,0x40c)],_0x114c72);return;}else _0x54150e=_0x15566d(0x4f9,0x585,0x497,0x4e5)+'/png;base6'+'4,'+_0x26c283;}console['log'](_0x4ea45c[_0x5ab98d(0x324,0x2d2,0x2cd,0x2c8)],_0x23e4fa);if(_0x23e4fa[_0x5ab98d(0x2d6,0x1bb,0x1a7,0x21d)]['length']>-0x4a*-0x47+0x35*-0x97+0xabd*0x1){const _0x5ac133=_0x23e4fa[_0x15566d(0x485,0x4b2,0x494,0x3af)][-0xa41*0x1+0x1009*0x2+-0x1*0x15d1];await updateCharacterPresetFromLLM(_0x29dd08['id'],_0x5ac133);}const _0x36ea10=[..._0x23e4fa[_0x15566d(0x3db,0x400,0x32a,0x351)]];for(const _0x156ff0 of _0x23e4fa[_0x5ab98d(0x1e0,0x237,0x2c2,0x21d)]){_0x156ff0[_0x5ab98d(0x2a3,0x2c9,0x1a2,0x1dd)+_0x15566d(0x482,0x3bc,0x532,0x461)]&&_0x4ea45c['iCOec'](_0x156ff0[_0x5ab98d(0x1ee,0x229,0x107,0x1dd)+_0x5ab98d(0x1ea,0x2d3,0x2b0,0x21a)][_0x5ab98d(0x15c,0x2a5,0x236,0x225)],-0x20e1+0xba7+0x153a)&&_0x36ea10[_0x15566d(0x428,0x427,0x3f3,0x481)](..._0x156ff0[_0x15566d(0x445,0x38f,0x36d,0x495)+_0x5ab98d(0x233,0x1fd,0x30c,0x21a)]);}_0x4ea45c[_0x5ab98d(0x3b2,0x2e3,0x34d,0x304)](_0x36ea10[_0x15566d(0x48d,0x45b,0x43f,0x57d)],0x201+0xf38*0x2+-0x2071)&&await _0x4ea45c[_0x5ab98d(0xf8,0x1bc,0x206,0x1e2)](updateOutfitPresetsFromLLM,_0x36ea10),toastr[_0x15566d(0x557,0x60f,0x4ea,0x5a1)](_0x4ea45c[_0x5ab98d(0x1fd,0x215,0x31a,0x2bc)]);}catch(_0x5c2079){_0x4ea45c['rNsWa'](_0x15566d(0x4ec,0x521,0x4d6,0x4d0),_0x4ea45c['MqVez'])?_0x420959++:(console['error'](_0x4ea45c['ZTGxd'],_0x5c2079),toastr['error'](_0x5ab98d(0x18c,0x191,0x271,0x181)+'\x20'+_0x5c2079[_0x5ab98d(0x2a0,0x27a,0x25a,0x25c)]));}}async function updateCharacterPresetFromLLM(_0x225735,_0x504882){const _0x36ad44={'kftGa':_0x871f6a(0x27b,0x1a8,0x217,0x1d6),'XmERM':function(_0x4728dc,_0x1d5fc6){return _0x4728dc(_0x1d5fc6);},'mykDM':function(_0x23df13,_0x3eecee){return _0x23df13!==_0x3eecee;},'UmrLf':function(_0x592e7d,_0x1fea41){return _0x592e7d(_0x1fea41);},'LcMEN':function(_0x6b5d22){return _0x6b5d22();},'uZmQh':function(_0x2c4f4b,_0x168b1d,_0x168968){return _0x2c4f4b(_0x168b1d,_0x168968);},'BkbjP':_0x871f6a(0x2cd,0x2a6,0x2b4,0x27e),'VphKz':_0x130f07(0x456,0x4da,0x434,0x3cc),'rfVbz':_0x871f6a(0x34d,0x396,0x320,0x284),'DLOLx':_0x871f6a(0x29f,0x2b1,0x297,0x1e2),'JnCxU':_0x130f07(0x41e,0x3f2,0x47a,0x3e5),'Ditie':_0x871f6a(0x408,0x33e,0x3c2,0x44c),'wghbC':'下半身SFW背面','iiLVX':_0x130f07(0x3c2,0x49b,0x444,0x47d),'CuTQA':_0x130f07(0x41e,0x2f2,0x39a,0x443),'QEfSG':_0x130f07(0x4a3,0x3b1,0x462,0x52a),'RPEED':function(_0x392fad,_0xff4c9a){return _0x392fad!==_0xff4c9a;},'cIEYS':function(_0x226ed9,_0x40b9d7){return _0x226ed9===_0x40b9d7;},'VKpqv':_0x871f6a(0x2c4,0x1de,0x286,0x1f3),'FfcrL':_0x130f07(0x250,0x389,0x326,0x2f4),'UlYuP':function(_0x1ea0d5,_0x7854fc){return _0x1ea0d5===_0x7854fc;},'mMCSn':'ocuhM','BILWL':_0x871f6a(0x2c3,0x2e0,0x34b,0x2c2),'cNczS':function(_0x3fb7e5,_0x35c002){return _0x3fb7e5(_0x35c002);},'XuouK':'已取消更新','uEJYn':function(_0x5e4a49,_0x345119){return _0x5e4a49!==_0x345119;},'ZOExt':_0x871f6a(0x28a,0x1d2,0x1c0,0x344),'QcQzk':_0x130f07(0x41d,0x36b,0x3c2,0x332),'UuEwD':function(_0x16e871,_0x3c928a){return _0x16e871(_0x3c928a);}},_0x45cd1e=extension_settings[extensionName],_0x56059f=_0x45cd1e[_0x130f07(0x54c,0x468,0x466,0x492)+_0x130f07(0x1ed,0x32a,0x2be,0x319)][_0x225735];if(!_0x56059f){toastr[_0x130f07(0x2f3,0x2fe,0x2da,0x31d)](_0x36ad44[_0x871f6a(0x38d,0x3a4,0x388,0x3db)]);return;}const _0x391d54={};_0x391d54[_0x871f6a(0x34f,0x273,0x2ee,0x273)]=_0x36ad44[_0x871f6a(0x3db,0x438,0x37a,0x393)],_0x391d54[_0x871f6a(0x361,0x34d,0x2fd,0x3b0)]=_0x36ad44[_0x871f6a(0x241,0x212,0x2e0,0x2aa)],_0x391d54[_0x130f07(0x3aa,0x3a6,0x42d,0x4a8)+_0x871f6a(0x30b,0x240,0x3db,0x3a9)]='角色特征',_0x391d54['facialFeat'+_0x130f07(0x532,0x3cb,0x463,0x458)]=_0x36ad44['DLOLx'],_0x391d54[_0x871f6a(0x331,0x350,0x2f0,0x34c)+_0x130f07(0x259,0x28c,0x346,0x279)]=_0x36ad44[_0x871f6a(0x35b,0x39c,0x3ea,0x34a)],_0x391d54[_0x130f07(0x42b,0x371,0x345,0x2c6)+'FW']=_0x130f07(0x2ea,0x439,0x3b9,0x336),_0x391d54[_0x130f07(0x35b,0x2a1,0x345,0x406)+'FWBack']=_0x36ad44[_0x130f07(0x31d,0x31d,0x313,0x2e2)],_0x391d54[_0x130f07(0x329,0x2b2,0x2d6,0x328)+'W']=_0x130f07(0x3ea,0x36c,0x36f,0x44b),_0x391d54['fullBodySF'+_0x871f6a(0x30c,0x371,0x31e,0x381)]=_0x36ad44[_0x871f6a(0x2b7,0x2e1,0x2f1,0x322)],_0x391d54[_0x871f6a(0x2e2,0x288,0x3bf,0x2f4)+'SFW']=_0x36ad44[_0x871f6a(0x310,0x2c7,0x2ed,0x3c2)],_0x391d54[_0x871f6a(0x2e2,0x313,0x2c0,0x39f)+'SFWBack']='上半身NSFW背面',_0x391d54[_0x871f6a(0x3df,0x469,0x477,0x4af)+'FW']=_0x36ad44[_0x871f6a(0x2f9,0x254,0x384,0x3e5)],_0x391d54['fullBodyNS'+_0x130f07(0x260,0x2b3,0x2c4,0x35b)]=_0x36ad44[_0x130f07(0x34b,0x334,0x327,0x2e2)];const _0x47ef85=_0x391d54;let _0x50b31c=-0x268f+-0xa4+0x2733;for(const _0x21b864 in _0x47ef85){if(_0x504882[_0x21b864]&&_0x36ad44[_0x130f07(0x25c,0x251,0x2e9,0x29a)](_0x504882[_0x21b864],_0x56059f[_0x21b864])){if(_0x36ad44[_0x871f6a(0x346,0x3d4,0x3d4,0x2da)](_0x36ad44[_0x130f07(0x50b,0x3ba,0x41f,0x341)],_0x36ad44[_0x871f6a(0x3ce,0x34e,0x466,0x4c0)])){_0x16041b['error'](_0x36ad44[_0x130f07(0x2f2,0x30e,0x311,0x261)]);return;}else _0x50b31c++;}}if(_0x50b31c===-0x30e*0x4+0x1fb*0x12+-0x176e){if(_0x36ad44[_0x871f6a(0x2c8,0x276,0x2eb,0x3ae)](_0x36ad44[_0x130f07(0x405,0x2c6,0x34e,0x3af)],_0x36ad44[_0x871f6a(0x29c,0x1b3,0x327,0x202)]))_0x36ad44[_0x130f07(0x467,0x3f7,0x424,0x48c)](_0x3641fe,_0x523cf3),_0x250cb2=null;else{toastr['info']('没有检测到需要更新的'+'内容');return;}}const _0x2c0f43=_0x130f07(0x3e0,0x470,0x416,0x482)+_0x225735+_0x871f6a(0x276,0x28e,0x2fe,0x2ac)+_0x50b31c+_0x130f07(0x39c,0x317,0x340,0x27b),_0x123c81=await _0x36ad44[_0x871f6a(0x2fc,0x2cb,0x228,0x263)](stylishConfirm,_0x2c0f43);if(!_0x123c81){toastr[_0x130f07(0x459,0x4aa,0x457,0x3fc)](_0x36ad44[_0x130f07(0x2e0,0x3a1,0x34b,0x42f)]);return;}for(const _0x41448a in _0x47ef85){if(_0x36ad44[_0x130f07(0x2e9,0x318,0x3d7,0x460)](_0x36ad44['ZOExt'],_0x36ad44[_0x871f6a(0x3b1,0x3a4,0x378,0x325)])){const _0x3f5bc6={'BttyV':function(_0x3d6129,_0x530916){function _0x39b8d5(_0x52a29f,_0x484a8f,_0x3dfc56,_0x5446fd){return _0x130f07(_0x52a29f-0x1dc,_0x5446fd,_0x484a8f-0x5d,_0x5446fd-0x1b7);}return _0x36ad44[_0x39b8d5(0x49b,0x3fb,0x34b,0x4bb)](_0x3d6129,_0x530916);},'FyPsg':function(_0x56cc70,_0x392986){return _0x36ad44['UmrLf'](_0x56cc70,_0x392986);}},_0x16cb9d=_0x36ad44[_0x130f07(0x3b2,0x37b,0x465,0x452)](_0xdcde47);_0x16e5f4[_0x130f07(0x2ad,0x29b,0x338,0x2f2)](_0x130f07(0x347,0x38f,0x2ca,0x36d)+_0x871f6a(0x36f,0x43c,0x42c,0x3ab)+_0x871f6a(0x231,0x304,0x2a5,0x22e)+_0x871f6a(0x2fb,0x277,0x323,0x20a)+_0x871f6a(0x26f,0x2f9,0x23e,0x24b)+'mpt\x20(ID:\x20'+_0x16cb9d+')');const _0x3208c4=_0xeec0ce=>{if(_0x3f5bc6['BttyV'](_0xeec0ce['id'],_0x16cb9d))return;_0x2a7132['removeList'+_0x1f35c9(0x179,0xba,0xf3,0x1d5)](_0x2a8c79[_0x264bec(0x45a,0x3ea,0x447,0x41b)+_0x264bec(0x592,0x52f,0x4f2,0x4cd)+'PROMPT_RES'+'PONSE'],_0x3208c4);function _0x264bec(_0x512fe7,_0x4487ab,_0x5052e8,_0x42e164){return _0x871f6a(_0x5052e8-0x1c8,_0x4487ab-0xc9,_0x5052e8-0x179,_0x512fe7);}function _0x1f35c9(_0xcae734,_0x2c607c,_0x587eb4,_0xfd3926){return _0x871f6a(_0xcae734- -0x14e,_0x2c607c-0x183,_0x587eb4-0x16f,_0x2c607c);}_0x3f5bc6['FyPsg'](_0x25a3aa,_0xeec0ce[_0x1f35c9(0xf7,0x7,0x5c,0x131)]);};_0x160dfb['on'](_0x2fb543[_0x130f07(0x3a6,0x294,0x30b,0x30f)+_0x130f07(0x392,0x47d,0x3b6,0x491)+'PROMPT_RES'+_0x871f6a(0x3a5,0x3c8,0x34f,0x326)],_0x3208c4);const _0x5d1e30={};_0x5d1e30['id']=_0x16cb9d,_0x18f48d['emit'](_0x58e040[_0x871f6a(0x27f,0x371,0x2e8,0x1bc)+'ODIFY_GET_'+'PROMPT_REQ'+'UEST'],_0x5d1e30),_0x36ad44[_0x130f07(0x465,0x45b,0x497,0x3fd)](_0x4b6b4a,()=>{_0x5d17e8[_0x5e5d07(0xef,0x149,0x1d6,0x21b)+'ener'](_0x4af4b6[_0x5e5d07(0x2c,0xf8,0x61,0xd0)+_0x5e5d07(0x20c,0x1a3,0x108,0x19c)+_0x5e5d07(0x11c,0x1c1,0x1c2,0x10c)+_0x5e5d07(0x140,0x21e,0x2a0,0x310)],_0x3208c4);function _0x38fa03(_0x54fed7,_0x4b0bf8,_0x2b2431,_0x500aca){return _0x130f07(_0x54fed7-0x13,_0x4b0bf8,_0x54fed7- -0x37b,_0x500aca-0x164);}function _0x5e5d07(_0x353adf,_0xa6e483,_0xf476,_0x915a10){return _0x130f07(_0x353adf-0x58,_0x353adf,_0xa6e483- -0x213,_0x915a10-0xd8);}_0x4e1d5a(new _0x3c4f36('获取角色修改提示词超'+'时'));},0x79*0x4+0x4624+-0x20f8);}else _0x504882[_0x41448a]&&(_0x36ad44[_0x130f07(0x26f,0x2ab,0x31c,0x3d4)]!==_0x36ad44[_0x871f6a(0x290,0x312,0x32c,0x264)]?_0x3161e7[_0x130f07(0x276,0x337,0x2cf,0x2c7)](_0x1babbb):_0x56059f[_0x41448a]=_0x504882[_0x41448a]);}_0x36ad44['LcMEN'](saveSettingsDebounced);const _0x34ddfe=$(_0x130f07(0x3d4,0x47c,0x3eb,0x38b)+_0x130f07(0x3c1,0x3fb,0x3be,0x3f7)+_0x871f6a(0x412,0x388,0x4f9,0x36e));_0x34ddfe['length']&&_0x36ad44[_0x130f07(0x4d3,0x34e,0x424,0x4de)](refreshCharacterSettings,_0x34ddfe);function _0x871f6a(_0x528025,_0x411a1a,_0x246a34,_0x31e387){return _0x2238(_0x528025-0x188,_0x31e387);}_0x36ad44[_0x130f07(0x214,0x2f6,0x301,0x22a)](updateFormFields,_0x504882);function _0x130f07(_0x24ff74,_0x1e3065,_0x44bef0,_0x1e1469){return _0x2238(_0x44bef0-0x214,_0x1e3065);}console[_0x130f07(0x3ed,0x270,0x338,0x39a)](_0x871f6a(0x23e,0x289,0x1c8,0x2e5)+_0x871f6a(0x36f,0x2f3,0x2a2,0x3c3)+'fy]\x20已更新角色预'+_0x130f07(0x33b,0x3c0,0x392,0x3fe)+_0x225735+'\x22');}async function updateOutfitPresetsFromLLM(_0x3aed96){const _0x3a109d={'NAtIp':function(_0x1605ad,_0x3043ec){return _0x1605ad(_0x3043ec);},'vMWNO':function(_0x287ce7,_0x48b277){return _0x287ce7(_0x48b277);},'RnFYm':'(((.+)+)+)'+'+$','ynFiE':_0x496fda(0x1fa,0x1c4,0x1c1,0x12e),'unjoc':'归属人','XUlNj':_0x52bbf9(0x3a2,0x46d,0x44e,0x467),'dzAxs':'下半身','xTBfN':_0x496fda(0x2b0,0x356,0x24e,0x221),'sTtIG':function(_0x9e7adf,_0x5521ec){return _0x9e7adf!==_0x5521ec;},'GSuIv':_0x52bbf9(0x31d,0x24e,0x28e,0x2e9),'AlJQr':function(_0x3f1b2d,_0x489f05){return _0x3f1b2d!==_0x489f05;},'MSLIm':function(_0x5109e7,_0x25d54a){return _0x5109e7===_0x25d54a;},'yrNUK':function(_0x513daf,_0x237b1a){return _0x513daf===_0x237b1a;},'ERQPq':_0x496fda(0x263,0x1a4,0x1da,0x2b7),'KksWV':_0x52bbf9(0x21b,0x2df,0x216,0x23b),'nGLAb':function(_0x551cea,_0x381d11){return _0x551cea!==_0x381d11;},'fewrZ':_0x52bbf9(0x348,0x274,0x267,0x2ba),'vYWUf':_0x52bbf9(0x1fa,0x224,0x13a,0x19e),'htFUI':'#st-chatu8'+_0x496fda(0x1df,0x23f,0x285,0x1c2)+_0x496fda(0x2bf,0x1cd,0x28c,0x3a3)},_0x3912aa=extension_settings[extensionName],_0x367917={};_0x367917[_0x496fda(0x1fc,0x109,0x2e1,0x180)]=_0x52bbf9(0x36e,0x3a1,0x2ef,0x3a6),_0x367917[_0x52bbf9(0x327,0x3e0,0x2fd,0x352)]=_0x3a109d[_0x52bbf9(0x29e,0x266,0x35b,0x26a)],_0x367917[_0x52bbf9(0x35a,0x42b,0x288,0x351)]=_0x3a109d['unjoc'],_0x367917[_0x496fda(0x228,0x293,0x2c5,0x20a)]=_0x52bbf9(0x374,0x421,0x344,0x30a),_0x367917[_0x496fda(0xdc,0x14b,0x17c,0x8d)+_0x496fda(0x21f,0x2fd,0x29e,0x241)]=_0x3a109d[_0x496fda(0x115,0xa8,0x8f,0x76)],_0x367917[_0x496fda(0x217,0x251,0x155,0x12c)]=_0x3a109d[_0x52bbf9(0x268,0x326,0x204,0x262)];function _0x52bbf9(_0x522b24,_0x5bd3a9,_0x1198cf,_0x58e01f){return _0x2238(_0x522b24-0x14e,_0x1198cf);}_0x367917['fullBodyBa'+'ck']=_0x3a109d[_0x52bbf9(0x201,0x1b7,0x129,0x1d6)];const _0x17d74e=_0x367917;for(const _0x25c0be of _0x3aed96){const _0xde94de=_0x25c0be[_0x496fda(0x1fc,0x24e,0x12b,0x1c8)];if(!_0xde94de)continue;const _0x190978=_0x3912aa[_0x496fda(0x27f,0x310,0x2c0,0x2de)+_0x496fda(0x15b,0x11a,0x22d,0x170)]?.[_0xde94de];if(_0x190978){let _0xb8d863=-0x3*0x4d7+-0xdcf+0x1c54;for(const _0x5302ef in _0x17d74e){if(_0x3a109d[_0x52bbf9(0x30b,0x224,0x235,0x361)](_0x3a109d['GSuIv'],_0x3a109d[_0x52bbf9(0x29b,0x332,0x33f,0x1f6)])){if(_0x41f422){const _0x4bb756=_0x39d359[_0x52bbf9(0x227,0x156,0x2af,0x287)](_0x52a3bd,arguments);return _0x13423b=null,_0x4bb756;}}else _0x25c0be[_0x5302ef]&&_0x3a109d[_0x496fda(0x1ba,0x29c,0x28a,0x11f)](_0x25c0be[_0x5302ef],_0x190978[_0x5302ef])&&_0xb8d863++;}if(_0x3a109d[_0x496fda(0x1d2,0x2b7,0x1f6,0x14c)](_0xb8d863,-0x181b+0x102d*-0x1+0x1*0x2848)){console[_0x496fda(0x159,0x20a,0x1d7,0xff)](_0x496fda(0xeb,0xae,0x5e,0x171)+_0x52bbf9(0x335,0x339,0x282,0x330)+_0x52bbf9(0x257,0x311,0x2d5,0x31d)+_0xde94de+_0x52bbf9(0x2bd,0x2c6,0x28c,0x21b));continue;}const _0x464f9b=_0x496fda(0x291,0x2c2,0x35f,0x1c6)+_0xde94de+_0x496fda(0x123,0x37,0x111,0xf1)+_0xb8d863+_0x52bbf9(0x27a,0x21e,0x326,0x2ca),_0x93f7b8=await stylishConfirm(_0x464f9b);if(!_0x93f7b8){if(_0x3a109d[_0x52bbf9(0x39a,0x2f5,0x42e,0x445)](_0x3a109d[_0x52bbf9(0x28b,0x327,0x1dd,0x329)],_0x3a109d['KksWV']))_0x3a109d[_0x496fda(0x26b,0x348,0x17d,0x204)](_0x46253e,_0x3c11a9);else continue;}for(const _0x5f535d in _0x17d74e){_0x25c0be[_0x5f535d]&&(_0x190978[_0x5f535d]=_0x25c0be[_0x5f535d]);}console[_0x52bbf9(0x272,0x337,0x201,0x354)]('[character'+_0x496fda(0x21c,0x292,0x17c,0x164)+_0x496fda(0x135,0x66,0x148,0x160)+'设\x20\x22'+_0xde94de+'\x22');}else{const _0x2a03c3='检测到新服装\x20\x22'+_0xde94de+_0x496fda(0x1eb,0x1fa,0x152,0x1fd),_0x503aa1=await _0x3a109d['vMWNO'](stylishConfirm,_0x2a03c3);if(!_0x503aa1){if(_0x52bbf9(0x393,0x450,0x458,0x3e4)!=='fPbVN')continue;else return null;}!_0x3912aa[_0x496fda(0x27f,0x1d2,0x2da,0x22b)+_0x52bbf9(0x274,0x242,0x24f,0x21f)]&&(_0x3912aa[_0x496fda(0x27f,0x21a,0x1df,0x19e)+_0x52bbf9(0x274,0x267,0x353,0x1d2)]={});const _0x3a7838={};_0x3a7838[_0x52bbf9(0x315,0x387,0x3e1,0x3ae)]=_0x25c0be[_0x496fda(0x1fc,0x115,0x1bd,0x194)],_0x3a7838['nameEN']=_0x25c0be[_0x496fda(0x20e,0x2b9,0x152,0x161)]||'',_0x3a7838[_0x52bbf9(0x35a,0x3d7,0x43c,0x42f)]=_0x25c0be[_0x496fda(0x241,0x26f,0x1eb,0x25b)]||'',_0x3a7838[_0x496fda(0x228,0x265,0x233,0x1c2)]=_0x25c0be['upperBody']||'',_0x3a7838[_0x52bbf9(0x1f5,0x2cd,0x1be,0x12b)+_0x496fda(0x21f,0x231,0x22d,0x264)]=_0x25c0be[_0x496fda(0xdc,0x1b9,0x3e,0x20)+'ack']||'',_0x3a7838[_0x496fda(0x217,0x283,0x268,0x127)]=_0x25c0be[_0x52bbf9(0x330,0x251,0x33e,0x370)]||'',_0x3a7838[_0x52bbf9(0x339,0x327,0x260,0x2e3)+'ck']=_0x25c0be['fullBodyBa'+'ck']||'',_0x3912aa[_0x52bbf9(0x398,0x33f,0x31c,0x39c)+_0x52bbf9(0x274,0x191,0x2e1,0x30a)][_0xde94de]=_0x3a7838,console[_0x496fda(0x159,0x1f1,0xff,0x187)](_0x496fda(0xeb,0xc8,0xbe,0x19a)+_0x496fda(0x21c,0x2bd,0x17a,0x12a)+_0x496fda(0x28d,0x2ae,0x1aa,0x1ed)+'设\x20\x22'+_0xde94de+'\x22');if(_0x25c0be[_0x496fda(0x241,0x158,0x1d4,0x2cc)]&&_0x25c0be[_0x52bbf9(0x35a,0x2d8,0x2fc,0x36a)][_0x52bbf9(0x206,0x1ba,0x170,0x139)]()){if(_0x3a109d[_0x496fda(0xef,0x22,0x176,0xf7)](_0x3a109d['fewrZ'],_0x3a109d[_0x496fda(0x21e,0x1fe,0x228,0x2b2)])){const _0x1f6c74=_0x25c0be['owner']['trim']()[_0x52bbf9(0x310,0x28a,0x3c9,0x231)+'e']()[_0x496fda(0x259,0x2c3,0x232,0x34b)](/\s+/g,'');for(const [_0x5e2e9b,_0x32843a]of Object[_0x496fda(0x143,0x197,0xce,0x1e2)](_0x3912aa['characterP'+'resets']||{})){if(_0x32843a[_0x52bbf9(0x327,0x28d,0x29c,0x24a)]&&_0x32843a[_0x52bbf9(0x327,0x3c2,0x273,0x343)][_0x496fda(0x1f7,0x1c7,0x18e,0x1ed)+'e']()['replace'](/\s+/g,'')===_0x1f6c74){!_0x32843a[_0x496fda(0x11d,0x54,0x20b,0x19f)]&&(_0x32843a['outfits']=[]);!_0x32843a[_0x52bbf9(0x236,0x2ca,0x2b4,0x22e)][_0x496fda(0x2a9,0x2a3,0x34e,0x285)](_0xde94de)&&(_0x32843a['outfits'][_0x52bbf9(0x283,0x2c1,0x27a,0x288)](_0xde94de),console[_0x496fda(0x159,0x1d8,0x248,0x16c)]('[character'+'PromptModi'+_0x496fda(0x13e,0x122,0x7b,0xa5)+_0xde94de+'\x22\x20已归属到角色\x20\x22'+_0x5e2e9b+'\x22'));break;}}}else _0x3fbe62[_0x496fda(0x17d,0x10e,0x11b,0x152)+_0x52bbf9(0x28d,0x2f4,0x1f6,0x319)](_0x539cce[_0x52bbf9(0x245,0x276,0x1b4,0x1e2)+_0x52bbf9(0x2f0,0x256,0x23f,0x344)+_0x496fda(0x1f5,0x241,0x2b2,0x27c)+'PONSE'],_0x3cb333),_0x3a109d['vMWNO'](_0x4970d3,new _0x472faf(_0x52bbf9(0x21c,0x188,0x1de,0x292)+'时'));}}}function _0x496fda(_0xddc6cb,_0x23687f,_0x569b6c,_0x26f9da){return _0x2238(_0xddc6cb-0x35,_0x569b6c);}saveSettingsDebounced();const _0x517b02=_0x3a109d[_0x496fda(0x26b,0x343,0x182,0x29a)]($,_0x3a109d[_0x496fda(0x21a,0x150,0x163,0x2f1)]);if(_0x517b02[_0x496fda(0x1cf,0x272,0x1bd,0x265)]){if(_0x496fda(0x2a1,0x2a6,0x1fe,0x27f)!==_0x52bbf9(0x3ba,0x356,0x431,0x36c))return _0x425aee[_0x52bbf9(0x30a,0x27f,0x3c6,0x367)]()['search'](RNDzvx[_0x496fda(0x24c,0x293,0x312,0x2ba)])[_0x52bbf9(0x30a,0x2a4,0x3d6,0x243)]()[_0x52bbf9(0x31c,0x251,0x30b,0x372)+'r'](_0x408f9a)[_0x52bbf9(0x2cf,0x220,0x322,0x2f8)](RNDzvx['RnFYm']);else refreshCharacterSettings(_0x517b02);}}function updateFormFields(_0x3c1c84){function _0x19b21a(_0x4671f4,_0x2f7da5,_0x1efed8,_0x378820){return _0x2238(_0x378820- -0x11f,_0x2f7da5);}function _0x1df7cb(_0x1f20df,_0x39075c,_0x17a914,_0x457816){return _0x2238(_0x457816- -0x14f,_0x39075c);}const _0x3ce2ec={'lRANn':function(_0x557663,_0xeb571c){return _0x557663===_0xeb571c;},'xUCIE':_0x19b21a(-0xf7,-0x81,0x84,-0x50),'LXvsX':'TvJyM','nADVX':_0x19b21a(-0x90,0x3c,-0xa5,0x30),'NIgBN':_0x1df7cb(0x72,0x37,0x19,0xba),'igSgK':function(_0x30a4fb,_0x362860){return _0x30a4fb(_0x362860);},'jLFGi':_0x1df7cb(-0x73,0x6c,-0x11c,-0x4e),'fYMkO':'nameCN','DcFlY':_0x1df7cb(0x14b,0x19d,0x103,0xca)+'raits','vjFbI':_0x19b21a(0x14a,0x70,0x13,0x8a)+_0x1df7cb(-0xc0,-0xa2,-0x5b,-0x1d),'QZvhh':_0x19b21a(0x48,0x29,-0x38,0x12)+'FWBack','Xhafb':_0x19b21a(0x1c,0x37,-0x7c,-0x5d)+'W','JgMKH':'fullBodySF'+_0x1df7cb(0x120,0x89,0x42,0x35),'cyezY':_0x1df7cb(0xc4,0x7d,0xb0,0xb)+_0x19b21a(0x6c,0x5a,-0x93,-0x71),'ORGrK':_0x1df7cb(0x1f,0xb1,-0x50,0xb)+_0x19b21a(0x5d,0x5e,0xe,0x58),'mYrUo':_0x1df7cb(0x36,0x88,0x65,0x108)+'FW','OjzkM':_0x19b21a(0x211,0x17b,0x107,0x138)+_0x19b21a(-0x2e,-0x86,0x83,-0x6f)},_0x4331ec=[_0x3ce2ec[_0x19b21a(0x50,0x19f,0xb2,0xf4)],_0x1df7cb(0xdc,0x89,0x7,0x8a),_0x3ce2ec[_0x19b21a(0x9b,-0x2f,0xa6,0x90)],_0x19b21a(-0xd,0x3d,0x5b,0x8a)+_0x1df7cb(0x19b,0xac,0xd3,0x100),_0x3ce2ec[_0x1df7cb(0xc6,0x6c,-0x1e,0x1b)],'upperBodyS'+'FW',_0x3ce2ec[_0x1df7cb(0x66,0x197,0x144,0xde)],_0x3ce2ec[_0x1df7cb(0x162,0x1da,0x1b,0xed)],_0x3ce2ec['JgMKH'],_0x3ce2ec['cyezY'],_0x3ce2ec['ORGrK'],_0x3ce2ec['mYrUo'],_0x3ce2ec[_0x1df7cb(-0x30,0x6d,0x4c,0xbf)]];_0x4331ec[_0x1df7cb(0x81,0x9d,0x2f,0x14)](_0x4d5251=>{function _0x2b1bf7(_0x3a7919,_0x342a9d,_0x5e6398,_0x1afd62){return _0x19b21a(_0x3a7919-0x160,_0x5e6398,_0x5e6398-0x195,_0x3a7919- -0x10e);}function _0x249a10(_0x4597c8,_0x5d7a0f,_0x15db30,_0x2c6315){return _0x1df7cb(_0x4597c8-0x1ef,_0x4597c8,_0x15db30-0xed,_0x15db30- -0x27c);}if(_0x3c1c84[_0x4d5251]){if(_0x3ce2ec[_0x2b1bf7(-0x4d,-0x8f,-0xf0,-0x2b)](_0x3ce2ec[_0x2b1bf7(-0xe3,-0xf2,-0x1d,-0x10a)],_0x3ce2ec[_0x249a10(-0x26d,-0x23f,-0x1d0,-0xf9)]))return _0x51c447&&_0x24ee10[_0x249a10(-0x7c,-0xa5,-0x157,-0x1d3)](_0x380092)&&(_0x5bb68d&&_0x29b721[_0x249a10(-0x339,-0x288,-0x310,-0x289)](_0x5d075f)),_0x14f52a[_0x249a10(-0x2bd,-0x20c,-0x211,-0x1ab)](_0x847b7a,_0x3e34e6);else{const _0x27ffa3=document[_0x249a10(-0x185,-0x183,-0x17e,-0x1e6)+'ById'](_0x2b1bf7(-0xf4,-0x7f,-0x149,-0x1b9)+_0x4d5251);_0x27ffa3&&(_0x3ce2ec['nADVX']===_0x3ce2ec['NIgBN']?_0x5a087b[_0x249a10(-0x315,-0x311,-0x2e3,-0x2fc)]=[]:(_0x27ffa3[_0x249a10(-0xab,-0x1d7,-0x162,-0x239)]=_0x3c1c84[_0x4d5251],_0x3ce2ec[_0x2b1bf7(-0x6,0x1b,-0x90,-0x40)]($,_0x27ffa3)[_0x249a10(-0x25b,-0x1bf,-0x1a6,-0x10f)](_0x3ce2ec[_0x2b1bf7(0xd,0x31,-0x78,0xbe)])));}}});}