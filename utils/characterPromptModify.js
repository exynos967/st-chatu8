(function(_0x446696,_0xbfaba3){function _0x38b2ba(_0x494b28,_0x168adf,_0x20518e,_0x1b538c){return _0x7b35(_0x168adf- -0x32d,_0x20518e);}function _0x59bb3c(_0x563afd,_0x1d4898,_0x2780ed,_0x4d0834){return _0x7b35(_0x1d4898- -0x317,_0x2780ed);}const _0x4b3af7=_0x446696();while(!![]){try{const _0x3658ad=-parseInt(_0x59bb3c(0xd,-0x43,-0x27,-0x61))/(-0x11d9+0x2512+-0x1338)*(-parseInt(_0x38b2ba(-0x84,0xb,-0x11,-0x8a))/(-0x18*-0x14e+0x1f20+-0x3e6e))+parseInt(_0x59bb3c(-0x17,-0x64,0x24,-0x102))/(-0x2*-0xca7+-0x1d9*0x5+-0x5*0x336)*(-parseInt(_0x38b2ba(0x1d,-0x92,-0xf0,0x1f))/(-0x1a1e+-0x1085+0x2aa7))+-parseInt(_0x59bb3c(-0x98,-0x55,-0xef,-0xe7))/(0x31*0x45+0x1*0x1ca3+-0x29d3)+parseInt(_0x38b2ba(-0x57,-0x10e,-0x133,-0x1a8))/(-0x443+-0x184b+0xe4a*0x2)*(-parseInt(_0x38b2ba(-0xb3,-0x114,-0x19b,-0x15b))/(-0x5*-0x7ae+0x722+-0x2d81))+parseInt(_0x38b2ba(-0x70,-0x46,-0x58,-0xdc))/(-0x12d+-0x1fe*0x1+0x111*0x3)+parseInt(_0x59bb3c(-0x4b,0x16,0x59,0x30))/(-0x7*-0x2fc+-0xb7a+0x7*-0x157)+parseInt(_0x38b2ba(-0xbe,-0x75,-0x66,-0x115))/(-0x16db*-0x1+-0x489*-0x2+-0x1fe3);if(_0x3658ad===_0xbfaba3)break;else _0x4b3af7['push'](_0x4b3af7['shift']());}catch(_0x59ed60){_0x4b3af7['push'](_0x4b3af7['shift']());}}}(_0x1270,-0x5591+0x11b146+-0x83f6e));const _0x3ed038=(function(){let _0x44f7a2=!![];return function(_0x2a7083,_0x249079){const _0x49b314=_0x44f7a2?function(){if(_0x249079){const _0x9cfc00=_0x249079['apply'](_0x2a7083,arguments);return _0x249079=null,_0x9cfc00;}}:function(){};return _0x44f7a2=![],_0x49b314;};}()),_0x26d3fb=_0x3ed038(this,function(){const _0x1e7e66={};_0x1e7e66[_0x2e44e6(0x1e7,0x237,0x2b8,0x2e5)]=_0x2e44e6(0x335,0x293,0x2f6,0x22f)+'+$';function _0x2e44e6(_0x552279,_0x3e6a27,_0xd05db,_0x455e56){return _0x7b35(_0x3e6a27-0x56,_0xd05db);}function _0x5d9307(_0x437667,_0x595212,_0x26e05b,_0x1a3db1){return _0x7b35(_0x26e05b- -0xa8,_0x1a3db1);}const _0x5aa8d7=_0x1e7e66;return _0x26d3fb['toString']()[_0x5d9307(0x12f,0x1d8,0x1c5,0x1f6)](_0x5d9307(0x175,0x189,0x195,0x177)+'+$')['toString']()[_0x5d9307(0x287,0x270,0x24b,0x19c)+'r'](_0x26d3fb)[_0x2e44e6(0x334,0x2c3,0x23c,0x23a)](_0x5aa8d7[_0x2e44e6(0x2d0,0x237,0x289,0x284)]);});_0x26d3fb();import{eventSource}from'../../../../../script.js';import{eventNames,extensionName}from'./config.js';import{extension_settings}from'../../../../extensions.js';import{getContext}from'../../../../st-context.js';import{saveSettingsDebounced}from'../../../../../script.js';import{generateCharacterListText,generateOutfitEnableListText,generateCommonCharacterListText}from'./settings/worldbook.js';import{updateCombinedPrompt}from'./settings/llm.js';import{buildPromptForRequestType}from'./settings/llmService.js';import{refreshCharacterSettings}from'./settings/character/index.js';import{stylishConfirm}from'./ui_common.js';import{mergeAdjacentMessages,replaceAllPlaceholders,replacePlaceholder as _0x21db4b}from'./promptProcessor.js';function replacePlaceholder(_0x1a9435,_0x342d9a,_0x2cc40d,_0x2f19f4){function _0x427b0d(_0x3fe62a,_0x3907af,_0x994eb4,_0x3fa11f){return _0x7b35(_0x3907af- -0x19a,_0x994eb4);}const _0x7444f8={'QThqX':function(_0x24df7f,_0x57c2c3){return _0x24df7f===_0x57c2c3;},'ONcIp':_0x427b0d(0x14e,0x1a2,0x172,0x139),'XerYF':function(_0x21cec7,_0x3cd3b8){return _0x21cec7===_0x3cd3b8;},'ZuGZl':_0x2cb8d5(0x324,0x3c3,0x2cf,0x349),'eJtZi':_0x427b0d(0x152,0x138,0x15a,0x1b4),'nItJu':_0x427b0d(0xf5,0x7b,0x1d,0x115),'uQSNT':function(_0x4d6f2c,_0x4cdd1a,_0x4abe5d,_0x16863b,_0x3b3246){return _0x4d6f2c(_0x4cdd1a,_0x4abe5d,_0x16863b,_0x3b3246);}};if(_0x7444f8[_0x427b0d(0x143,0x155,0x1a5,0x116)](typeof _0x1a9435,_0x7444f8[_0x427b0d(0x178,0xfb,0x71,0x46)])){if(_0x2cc40d&&_0x1a9435['includes'](_0x342d9a)){if(_0x2f19f4){if(_0x7444f8[_0x2cb8d5(0x445,0x4d5,0x519,0x4a8)](_0x7444f8[_0x427b0d(0x194,0x17c,0x148,0x231)],_0x7444f8[_0x427b0d(0xf0,0x64,0xb,0x68)]))return _0x510f89;else _0x2f19f4[_0x2cb8d5(0x343,0x40c,0x403,0x3e0)](_0x342d9a);}}return _0x1a9435[_0x427b0d(0xd2,0x116,0xe0,0x174)](_0x342d9a,_0x2cc40d);}function _0x2cb8d5(_0x2970b9,_0x13667f,_0x2966fb,_0x1f88f1){return _0x7b35(_0x1f88f1-0x166,_0x13667f);}if(Array[_0x2cb8d5(0x484,0x44d,0x4de,0x46e)](_0x1a9435))return _0x1a9435['map'](_0xc8518c=>replacePlaceholder(_0xc8518c,_0x342d9a,_0x2cc40d,_0x2f19f4));if(_0x1a9435&&typeof _0x1a9435===_0x7444f8[_0x427b0d(0x17f,0xf8,0x16a,0x87)]){const _0x2c1f06={};for(const _0x501141 in _0x1a9435){_0x2c1f06[_0x501141]=_0x7444f8[_0x427b0d(0x16d,0x169,0x1ba,0xe0)](replacePlaceholder,_0x1a9435[_0x501141],_0x342d9a,_0x2cc40d,_0x2f19f4);}return _0x2c1f06;}return _0x1a9435;}function _0x7b35(_0x5f3aab,_0x3f84fb){_0x5f3aab=_0x5f3aab-(0x2ae+-0xb9a+-0x4f*-0x23);const _0x119026=_0x1270();let _0x43f49c=_0x119026[_0x5f3aab];if(_0x7b35['wKsDTD']===undefined){var _0x4467c0=function(_0x8f1268){const _0x489125='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0xf0633b='',_0x40d59c='',_0x20775e=_0xf0633b+_0x4467c0;for(let _0xd7c22b=-0x20c3*0x1+-0x3*-0x29b+-0xce*-0x1f,_0x120f02,_0x48d1a0,_0x15d0ab=0x27*-0x84+0x1551+-0x67*0x3;_0x48d1a0=_0x8f1268['charAt'](_0x15d0ab++);~_0x48d1a0&&(_0x120f02=_0xd7c22b%(0x1750*0x1+-0x6da+-0x1072)?_0x120f02*(-0x1208+-0x2*0xe15+0x122*0x29)+_0x48d1a0:_0x48d1a0,_0xd7c22b++%(-0xe*-0x1df+-0x20a7+0x679))?_0xf0633b+=_0x20775e['charCodeAt'](_0x15d0ab+(-0x19a4+-0x1*0xa9e+-0x913*-0x4))-(-0x1673*0x1+-0x1456+0x2ad3)!==0x1*0x1d30+0x67*-0x31+-0x61*0x19?String['fromCharCode'](-0x25c4+-0x1*-0x679+0x204a&_0x120f02>>(-(-0x2*0x423+-0x3b+-0x1*-0x883)*_0xd7c22b&0xa1*-0x28+0x1b1*0xb+0x21*0x33)):_0xd7c22b:-0x1854+0x85a*-0x4+0x1cde*0x2){_0x48d1a0=_0x489125['indexOf'](_0x48d1a0);}for(let _0x18f904=-0xb*-0x21b+0x290*-0x9+-0x19,_0x45192d=_0xf0633b['length'];_0x18f904<_0x45192d;_0x18f904++){_0x40d59c+='%'+('00'+_0xf0633b['charCodeAt'](_0x18f904)['toString'](0x15c8+0xd*0x1f3+-0x2f0f))['slice'](-(-0x1191+0xd*0x213+-0x964));}return decodeURIComponent(_0x40d59c);};_0x7b35['vNcusK']=_0x4467c0,_0x7b35['KyaoLC']={},_0x7b35['wKsDTD']=!![];}const _0x5c1680=_0x119026[-0x2211+-0x307*-0xc+-0x3*0xc1],_0x31a67e=_0x5f3aab+_0x5c1680,_0x97eb50=_0x7b35['KyaoLC'][_0x31a67e];if(!_0x97eb50){const _0x39fb02=function(_0x336466){this['OqCJdc']=_0x336466,this['TsyEXs']=[-0xb9+-0x2*-0x135e+-0x23*0x116,0x263a+-0x2275*-0x1+-0x48af*0x1,-0x25d6+-0x1175*0x2+-0xc0*-0x61],this['eyFXPq']=function(){return'newState';},this['fejdXv']='\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*',this['jhZRKq']='[\x27|\x22].+[\x27|\x22];?\x20*}';};_0x39fb02['prototype']['fWMnLS']=function(){const _0x597a6d=new RegExp(this['fejdXv']+this['jhZRKq']),_0x1688e2=_0x597a6d['test'](this['eyFXPq']['toString']())?--this['TsyEXs'][0x1832+-0x1f8a+-0xab*-0xb]:--this['TsyEXs'][-0x99d+-0x2166+-0x625*-0x7];return this['MbDzuq'](_0x1688e2);},_0x39fb02['prototype']['MbDzuq']=function(_0x12f6eb){if(!Boolean(~_0x12f6eb))return _0x12f6eb;return this['Yuaozy'](this['OqCJdc']);},_0x39fb02['prototype']['Yuaozy']=function(_0x4284b7){for(let _0x27aa76=0x1fb5+-0x391+-0x1c24,_0x5ea826=this['TsyEXs']['length'];_0x27aa76<_0x5ea826;_0x27aa76++){this['TsyEXs']['push'](Math['round'](Math['random']())),_0x5ea826=this['TsyEXs']['length'];}return _0x4284b7(this['TsyEXs'][0x2335+0x1ae8+0x3e1d*-0x1]);},new _0x39fb02(_0x7b35)['fWMnLS'](),_0x43f49c=_0x7b35['vNcusK'](_0x43f49c),_0x7b35['KyaoLC'][_0x31a67e]=_0x43f49c;}else _0x43f49c=_0x97eb50;return _0x43f49c;}function attachImagesToMessage(_0x19749f,_0x5edcb6,_0x4552a9,_0x56be1b=_0x50d534(0x1af,0x15e,0x1c7,0x177)){const _0x2f4b81={'auEGO':function(_0x38e4f2,_0x17d36a,_0x48be87,_0x1f2c17,_0x3a3037){return _0x38e4f2(_0x17d36a,_0x48be87,_0x1f2c17,_0x3a3037);},'Ysihx':function(_0x36835b,_0x48b3c9){return _0x36835b===_0x48b3c9;},'ldyir':_0x4ab1c1(0x1b2,0x1f0,0x256,0x189),'WcqGI':_0x5d0c29(0x20e,0x318,0x2b7,0x2a8),'vXQVz':function(_0x6e7c10,_0x2d9f2d){return _0x6e7c10===_0x2d9f2d;},'HiLZa':'string','qLWFe':_0x4ab1c1(0xb8,0x135,0x143,0x7c),'lpnJV':'data:','pNmXa':_0x4ab1c1(0x1e2,0x12d,0x1d1,0x21a),'YPAej':_0x5d0c29(0x1f3,0x294,0x294,0x23a),'taTZv':'image_url','yGMqv':_0x5d0c29(0x26f,0x271,0x2ff,0x2f9),'lmivX':function(_0x1f23bb,_0xa383a1){return _0x1f23bb<_0xa383a1;},'FIpCB':function(_0x18f2b2,_0x11d77e){return _0x18f2b2>=_0x11d77e;},'CHgap':function(_0x2854bd,_0x1bd5fc){return _0x2854bd===_0x1bd5fc;},'ipGUv':_0x4ab1c1(0xe8,0x11c,0x7f,0x153),'NWiwn':function(_0x2a0638,_0x292435){return _0x2a0638>_0x292435;}};if(!_0x4552a9||_0x2f4b81['vXQVz'](_0x4552a9[_0x4ab1c1(0x113,0x1ad,0x145,0x161)],0x1*-0x127d+-0xfdb+-0x2258*-0x1)||_0x2f4b81[_0x4ab1c1(0xd1,0xe4,0x23,0xa5)](_0x5edcb6,0x1b5e+-0x45*0x76+0x470)||_0x2f4b81[_0x5d0c29(0x1ae,0x273,0x2a0,0x25a)](_0x5edcb6,_0x19749f[_0x5d0c29(0x289,0x1ca,0x1f9,0x281)]))return _0x19749f;const _0x48319d=[..._0x19749f],_0x56dcef=_0x48319d[_0x5edcb6],_0x4e95c3=[];if(_0x2f4b81[_0x4ab1c1(0x1c3,0x198,0x228,0x163)](typeof _0x56dcef['content'],_0x2f4b81[_0x4ab1c1(0x1c9,0x124,0x16c,0x1b8)])){const _0x14578a={};_0x14578a[_0x4ab1c1(0x154,0x163,0xbd,0x150)]=_0x2f4b81['ipGUv'],_0x14578a[_0x4ab1c1(0xe8,0x18f,0xf3,0xf0)]=_0x56dcef[_0x5d0c29(0x350,0x306,0x27e,0x2f3)],_0x4e95c3[_0x5d0c29(0x2c8,0x2d5,0x24b,0x261)](_0x14578a);}else Array[_0x5d0c29(0x2b1,0x336,0x29b,0x319)](_0x56dcef[_0x5d0c29(0x382,0x397,0x2c5,0x2f3)])&&_0x4e95c3[_0x5d0c29(0x308,0x1d9,0x1d1,0x261)](..._0x56dcef[_0x5d0c29(0x23e,0x34e,0x283,0x2f3)]);if(_0x2f4b81['NWiwn'](_0x4552a9[_0x5d0c29(0x314,0x2eb,0x2c4,0x281)],0x251*-0x5+0x161e+0x383*-0x3)){const _0x4b374b={};_0x4b374b[_0x4ab1c1(0x154,0x181,0x134,0xc7)]=_0x2f4b81['ipGUv'],_0x4b374b[_0x4ab1c1(0xe8,0x62,0xb0,0x77)]=_0x5d0c29(0x1d2,0x2b7,0x163,0x205)+_0x4552a9[_0x4ab1c1(0x113,0x9c,0x156,0xdc)]+'张'+_0x56be1b+']',_0x4e95c3[_0x5d0c29(0x238,0x1db,0x230,0x261)](_0x4b374b);}function _0x5d0c29(_0x476039,_0x4591c7,_0x57a759,_0x33a595){return _0x50d534(_0x476039-0xd,_0x4591c7-0x6f,_0x4591c7,_0x33a595-0x1bd);}_0x4552a9[_0x5d0c29(0x2b2,0x392,0x384,0x323)]((_0x493982,_0x4df116)=>{function _0x689239(_0x492369,_0x314b51,_0x3085d6,_0x123554){return _0x4ab1c1(_0x123554- -0x253,_0x314b51-0x78,_0x3085d6-0xd2,_0x314b51);}function _0x281643(_0x55256b,_0x23fd0a,_0x863324,_0x3c3c51){return _0x4ab1c1(_0x3c3c51- -0x276,_0x23fd0a-0x17f,_0x863324-0x50,_0x23fd0a);}if(_0x2f4b81['Ysihx'](_0x2f4b81['ldyir'],_0x2f4b81[_0x281643(-0xff,-0x189,-0x212,-0x1ac)]))_0x46cbb9[_0xd66aa9]=_0x2f4b81[_0x281643(-0xae,-0x7,-0x62,-0x8c)](_0x23f408,_0x6ecfb0[_0x11c98f],_0x101a74,_0x55bc26,_0x433de5);else{const _0x3f41df=_0x2f4b81[_0x689239(-0x105,-0xf6,-0xbe,-0x6c)](typeof _0x493982,_0x2f4b81[_0x281643(-0xb3,-0x102,-0xad,-0xad)])?_0x493982:_0x493982['base64'],_0x4f2dc2=typeof _0x493982===_0x2f4b81['qLWFe']&&_0x493982['name']?_0x493982[_0x281643(-0xcb,-0xba,-0x129,-0x110)]:''+_0x56be1b+(_0x4df116+(-0x42*0x4b+0x168*0x9+-0x1d*-0x3b)),_0x3b3a62={};_0x3b3a62[_0x281643(-0x133,-0x121,-0xea,-0x122)]=_0x689239(-0x141,-0x156,-0x196,-0x16b),_0x3b3a62[_0x689239(-0xc3,-0x173,-0x1e9,-0x16b)]='['+_0x4f2dc2+']',_0x4e95c3['push'](_0x3b3a62);let _0x239205=_0x3f41df;if(!_0x3f41df[_0x281643(-0xcf,-0xd7,-0x34,-0xd6)](_0x2f4b81[_0x689239(-0xc2,-0x118,-0xd9,-0xfe)])){if(_0x2f4b81[_0x281643(-0xf4,-0x125,0x28,-0x8f)](_0x2f4b81[_0x281643(-0xe6,-0x11d,-0x206,-0x176)],_0x2f4b81[_0x689239(-0x132,-0xeb,-0x1e0,-0x18d)])){_0x43d979[_0x281643(-0xc6,-0x16f,-0x1a2,-0xf0)](_0x689239(-0x177,-0x104,-0x18a,-0x135));return;}else _0x239205='data:image'+_0x281643(-0x21c,-0x245,-0x150,-0x1d0)+'4,'+_0x3f41df;}const _0x480a22={};_0x480a22[_0x689239(-0x197,-0x4f,-0x57,-0xff)]=_0x2f4b81[_0x689239(-0xb6,-0x12d,-0x12e,-0x16a)],_0x480a22[_0x281643(-0x146,-0xd1,-0xe9,-0x11e)]={},_0x480a22[_0x281643(-0x146,-0xd1,-0xe9,-0x11e)][_0x689239(-0x17a,-0x153,-0x220,-0x181)]=_0x239205,_0x480a22[_0x281643(-0x146,-0xd1,-0xe9,-0x11e)]['detail']=_0x2f4b81[_0x689239(-0x11d,-0x1ff,-0xa4,-0x150)],_0x4e95c3[_0x281643(-0x17f,-0x14b,-0x16c,-0x183)](_0x480a22);}});function _0x4ab1c1(_0x90ddd,_0x39b83e,_0x4fa37d,_0x3147b1){return _0x50d534(_0x90ddd-0x142,_0x39b83e-0x158,_0x3147b1,_0x90ddd-0x4f);}const _0x5c7cc7={..._0x56dcef};return _0x5c7cc7['content']=_0x4e95c3,_0x48319d[_0x5edcb6]=_0x5c7cc7,_0x48319d;}function findMessageIndexWithPlaceholder(_0x491f1e,_0x38d914){const _0x59129d={};_0x59129d[_0x452dd7(0x35,-0x40,-0x74,-0x8a)]=function(_0x24cefd,_0x27a840){return _0x24cefd!==_0x27a840;},_0x59129d[_0x452dd7(-0x34,0x44,-0x6e,-0x2c)]=_0x452dd7(-0x91,-0xc5,-0x14b,-0x11e),_0x59129d[_0x8a096e(0x537,0x5d8,0x49d,0x59a)]=function(_0x5c401a,_0x2b24dc){return _0x5c401a>_0x2b24dc;},_0x59129d['gBiRn']=_0x452dd7(-0xef,-0x74,-0x8f,-0x90),_0x59129d['mFyYb']=function(_0x2be042,_0x27e79d){return _0x2be042<_0x27e79d;},_0x59129d[_0x8a096e(0x47f,0x442,0x40c,0x4ed)]=_0x452dd7(-0x65,-0xcd,-0x9d,-0x17e);function _0x8a096e(_0x95aea,_0x2a9995,_0x19c42e,_0x25e1b1){return _0x50d534(_0x95aea-0x1ac,_0x2a9995-0x1ad,_0x19c42e,_0x95aea-0x419);}_0x59129d[_0x8a096e(0x47e,0x4a0,0x4b2,0x50d)]=function(_0x2d76cd,_0x5703ad){return _0x2d76cd===_0x5703ad;},_0x59129d[_0x8a096e(0x523,0x498,0x475,0x4c2)]='string',_0x59129d[_0x8a096e(0x489,0x535,0x3d6,0x45a)]=function(_0x2b6074,_0x4a7c24){return _0x2b6074!==_0x4a7c24;};function _0x452dd7(_0x30f021,_0x1c443d,_0x254f89,_0x4f76fb){return _0x50d534(_0x30f021-0x29,_0x1c443d-0x178,_0x30f021,_0x1c443d- -0x127);}_0x59129d['pOrIR']='LCbxU',_0x59129d[_0x452dd7(-0xad,-0xd2,-0xaf,-0x98)]=_0x452dd7(-0x9d,-0xd1,-0xe7,-0x6c),_0x59129d[_0x452dd7(-0x12e,-0xd6,-0x118,-0x18d)]=function(_0x283330,_0x43e96f){return _0x283330===_0x43e96f;},_0x59129d[_0x8a096e(0x581,0x623,0x5ec,0x5bc)]=_0x452dd7(-0x65,-0x8e,-0xeb,-0x139);const _0x2bb70c=_0x59129d;for(let _0x137508=0x1*-0xd86+0x1*-0x1754+0x24da;_0x2bb70c[_0x8a096e(0x539,0x54e,0x502,0x5d3)](_0x137508,_0x491f1e[_0x452dd7(-0x43,-0x63,-0x2f,-0xaa)]);_0x137508++){if(_0x2bb70c[_0x8a096e(0x500,0x4d4,0x495,0x548)](_0x2bb70c[_0x452dd7(-0x5e,-0xc1,-0xf,-0x13e)],_0x2bb70c[_0x452dd7(-0xae,-0xc1,-0xe6,-0x92)])){_0x3f5b83[_0x8a096e(0x574,0x53b,0x614,0x510)](_0x452dd7(0x89,0x4e,0xb5,-0xe)+'内容');return;}else{const _0x41adc4=_0x491f1e[_0x137508];if(_0x2bb70c[_0x8a096e(0x47e,0x43b,0x3fc,0x52d)](typeof _0x41adc4[_0x8a096e(0x54f,0x602,0x5a0,0x5ed)],_0x2bb70c['gXaiT'])&&_0x41adc4[_0x8a096e(0x54f,0x54d,0x4f5,0x5ce)]['includes'](_0x38d914))return _0x137508;else{if(Array[_0x452dd7(-0x63,0x35,0xc1,0x7c)](_0x41adc4[_0x8a096e(0x54f,0x571,0x606,0x51a)]))for(const _0xd7963b of _0x41adc4[_0x452dd7(0x20,0xf,-0x8f,-0x5d)]){if(_0x2bb70c[_0x452dd7(-0x37,-0xb7,-0x80,-0x12a)](_0x2bb70c[_0x452dd7(-0xf6,-0xe1,-0x117,-0x45)],_0x2bb70c[_0x452dd7(-0x11e,-0xd2,-0xa5,-0xbe)])){if(_0x2bb70c[_0x452dd7(-0x184,-0xd6,-0x9f,-0x49)](_0xd7963b[_0x452dd7(-0xf,-0x22,-0x47,-0x5)],_0x2bb70c[_0x452dd7(0x7a,0x41,0xec,0x70)])&&_0xd7963b['text'][_0x452dd7(-0x133,-0x9a,-0x29,-0x57)](_0x38d914))return _0x137508;}else{if(_0x390267[_0x12f731]&&_0x2bb70c[_0x452dd7(0x0,-0x40,-0x13,0xf)](_0x147341[_0x46103d],_0x43e6ef[_0x5ca23f])){const _0x53e208=_0x1c1ba8[_0x25d3c8]||_0x2bb70c['kPPyd'],_0x4f0251=_0x49b946[_0x77930c];_0x2a34bf+='•\x20'+_0x370feb[_0x22a0f9]+':\x0a',_0x1db860+='\x20\x20旧:\x20'+_0x53e208['substring'](-0x1bb*0x7+-0xaca+0x16e7,0x7*0x474+-0x12cf+-0xc2b)+(_0x2bb70c['lGxhU'](_0x53e208[_0x452dd7(0x41,-0x63,-0x89,-0xb8)],0xeab+0x299*0x5+-0x172*0x13)?_0x8a096e(0x4cc,0x51f,0x473,0x44e):'')+'\x0a',_0x38bd4a+='\x20\x20新:\x20'+_0x4f0251[_0x8a096e(0x55d,0x52a,0x587,0x4cb)](-0x229e+-0x1*-0x21b+0x2083,0xa42+-0x11*0x3b+-0x625)+(_0x4f0251[_0x452dd7(-0x4e,-0x63,0x12,-0xde)]>-0x114e+0x133d+0x1*-0x1bd?_0x2bb70c['gBiRn']:'')+'\x0a\x0a',_0x1a68ac++;}}}}}}return-(-0x5*-0x67e+-0x1683+0x43*-0x26);}function _0x1270(){const _0x4a8b78=['CMfUzg9T','BgvUz3rO','zNvSBejVzhLtrG','5lIT5PAh5zcn56EW','y2HHCL9TB2rPzG','zNLDioINO+AEKowiSoEAHos6UUEjQq','A2TYzMi','ALrXquS','sg1puwu','zNLDief0DgfJAa','5lQu5A6y5Asw6lkm6iom6z2IoIa','ywrK','6k+35ywi6ycj5OUP5lIa5lIQ6kEs6iMY6Ake6k6+','EwD5A3e','teXnioIVT+AXGUwKSEI0Pq','zxf1AxjLBwvUDa','AezkEfm','v29YBgrcB29R','serwCuu','qw9ft2y','z2v0rwXLBwvUDa','zNvSBejVzhLouW','BLzYt1K','DgvYihrYAwDNzq','t3vtBKG','zNLDie5VignOyq','5lIl5y2k6lQRtLngvW','ChjVBxb0oG','zNLDifnHDMvKia','EwvbDuq','DfnYDMq','5lIT5PAh5zcn56EWoIa','u0zxqMfJAW','ELHOCvG','DNH3uNm','BKL0sNu','A2XLq1O','B2rPzNKGteXnia','t05Jsxa','zw5LCG','qNPdq0K','qMfyBNi','zgf0yq','z3fRqNy','mJq4mtjIrvnjwuC','Bxb0icHjrdOG','y2HHDe1LDgfKyq','vfrAvuy','wuzNEwu','Dhz4C3m','D1nut2K','B2TYzKO','BenhsLa','zNLDioATO+wCQowKHoEqHUINKUIjSG','Bfvoze0','z3fmsgy','AvLRDxG','EwTAtxK','q0XWsxe','CMvTB3zLtgLZDa','ChjVBxb0','suH5EfG','Curxz2m','BMCGy2HHCMfJDa','quH0tMW','CMvWBgfJzufSBa','DhLWzq','BhbUsLy','ntaXBvDIwLf6','sLPQsM0','Aw1Hz2vFDxjS','z1HHAvq','wgnTzM8','mJGYnJqYmfbuA3rova','C3vJy2vZCW','5A2x5Q61ici','q3bTCfC','v0LKAKS','uxPmquC','wLLxqKK','5lIk5y2k6lQRtLngvZOG','Dgroseq','zwvzuge','mJq4nZKWA2LzDMjX','BMfTzq','BM93','5lIl5y2k6lQRtLngvZOG','sNfWyLu','vvjwwNa','ugD0txi','zNLDifjHDYbmta','BeD4Afu','uNfXs2G','Buz5wwi','vuvtva','BMfTzuno','wKrNtNy','DMfSDwu','5lIk5y2k6lQRu0zx6iom6z2IoIa','zfbOrNK','rxnjwxa','otC3mufxEKjHvW','5lIl5y2k6lQRu0zx6iom6z2IoIa','icdMLRa6ia','uxbZDM8','5lIl5y2k6lQRu0zx','A05IChq','pc/KURRNIAK+','q29UDgv4Da','5O+q56s66k+n5l+U5Ps56k+35RgclI4U','ig91Dhb1Da','zNLDiowqIow5TUEBUoMcU+A2IoAbRW','DcbWCMvZzxq6','wKnzC0y','AuDoqLO','y29UDgvUDa','zxjYB3i','t0rjrLLFuKvrvq','wwrWCMu','uhfpqKm','ndC4ntuYmgvstMfgua','yxv0BW','CMvZzxrjza','y2HHCL8','CIb0zxH0oG','zNLDifvZzxiGCG','t05trq','5OM+5lIn5yIW5OYh5A6A55Qe6kEs6iMY6Ake6k6+','uvrOCvG','C3vIC3rYAw5N','Bw9KAwz5ihjLCq','DwvZDc4UlG','y29UC3rYDwn0BW','DhnTsMu','t0rjrLLFr0vuxW','qNP1AwS','s3b5DuO','v1zxwe4','teXnx0niqvjFtq','y2HHCMfJDgvYCW','yK5ms3y','zNLDiev4zwn1Da','C3rHCNrZv2L0Aa','BM1UC2y','BgXdvfy','uwzKuvy','D1b1A0u','5lIl5y2k6lQRu0zx6iom6z2I','DvfttLq','BwfW','ugnUEu4','tezYCw4','Aw5MBW','AxnbCNjHEq','CMvXDwvZDcaOsq','rdOG','z3vts2O','tML4DhK','zNLDifn0yxj0Aq','6k+k5PAT77YA5Qoa5Rwl5yIW5lUL5lIl5y+y6yEp','rMrNzfy','A1DnuwO','zxH0icH0CMLNzW','zM9YrwfJAa','qNPNsxu','DwzkuNO','DxbWzxjcB2r5uW','wNvhwMW','A1bqEwq','DhjPBq','DxbWzxjcB2r5tG','vhzWDgy','D29YBgqGyM9VAW','D2fYBMLUzW','Dg9tDhjPBMC','5lIl5y2k6lQRtLngv+IdJoMDOJO','wuTmyNi','q0HNyxa','5RkH5PYj5Qoa5Rwl5yIW6zYa6kAb5PU05PAW55Qe','BKHMtum','5y+c6icd5zU+54Mh','tuvzyvm','5PwW5O2UoG','sgLmwMe','Bunqz0O','C2L6zq','zNLDioACQUIVHUwiQ+EAHos6UUEjQq','CgzJAhG','z2vUzxjHDgLVBG','ufjptvbux1jfuW','nJqXmty1ngfQuNviva','lxrHyI1JAgfYyq','C1vWwLa','CMvZzxrZ','rMjKEg8','BMfTzuvo','C3bSAxq','Dhrey2W','6kEs6iMY5O+q56s66k+n5l+U5Ps55AsX6lsLoG','Aw5KzxHpzG','AgDcwhe','mtKWtxr4s0vf','6kEs6iMY5l+U5Ps5ieXmtsdOR7C','DgLTzw91De1Z','Bu5Yufq','C3rYAw5N','Eg9YAKW','5lIl5y2k6lQRu0zxoIa','r05irNO','yMfZzty0','ww9KtLC','wgvYwuy','AM9PBG','DLHrvNO','5lIk5y2k6lQRtLngv+IdJoMDOJO','zLPczMG','yxvfr08','ufjptvbux1jfuq','rKD0rMi','zw1PDa','t1H4y3m','5lIl5y2k6lQRtLngv+IdJoMDOG','BwvZC2fNzsbHDa','zNLDiev4DhjHyW','ugr6DMO','r3HPswW','yxnYCxi','BfHHuxu','CMvWBgfJzq','Buv5DeG','zxiGChjVBxb0ia','uvn5zMC','zNLDieXmtsbVDq','zgf0ytPPBwfNzq','CefSA3C','yuHqv3O','uxHzExe','5Rgc6lAf5PE2','yvv4Efy','zgf0ytO','5lQu5A6y5Asw6lkm','Ce9Ysvi','B3iGzgvIDwDNAq','cLVKU6xKUiVMMk/NLkJMIlFKUiRKVkdNMOq','sgnlu3q','igLUzgv4','BMC6','AefzB0i','vefiDLO','zNLDien1CNjLBG','C3jNEhO','rNf5r1G','AMPAD1C','zuP0wMK','5lIk5y2k6lQRtLngv+IdJoMDOG','5Qoa5Rwl5yIW6kEs6iMY5Qch562+','BKTNAgW','uurUq00','l3bUzZTIyxnLnG','wK9RALO','u256teu','swH6quC','6i635y+w6kEs6iMY5l+U5Ps55O+q56s66k+n6lAf','C2LYDwO','s1LRA1O','q0zeq3O','r3rzt2O','i3n0lwnOyxr1oa','DxjLC0jHy2S','koEPUIK','zNLDiow3SUABToAwSoINKUIjSUMIHa','iIdNMOtKU6xKUiVMLBdMJA46cGO','EhzOswm','EujJEuq','BgDoq0G','tsbVDxrWDxqGzG','B2jQzwn0','wKnjDLe','CMfUzg9Tvvvjra','5lIk5y2k6lQRtLngvW','mtC3ote5sMr6CgPp','uhjVBxb0tw9KAq','rKPrwLq','vNL5EM8','twHyD0K','zM13q3O','mtK4twrby1nI','re14uMi','v0jHy2S','zNLDienOyxjHyW','wvbbzwO','Be5TBKC','qNLjza','t0H0B1m','v2nXr0K','CMvZDwX0','D0ThDhm','BKTXBvm','A2rzse0','EvL3s0K','vgjdtMW','Bg1PDLG','DxjS','vNjhCLq','vMHOqK0','5lQu5A6y5Asw6lkmoIa','v3fnC1e','CYbMB3vUzcbPBG','w2nOyxjHy3rLCG','rLDcywnR','y29UDgv4DdO','Bg9N','Aw5JBhvKzxm','5BEY5y+w5RAi5PU05PAW','6iUX5PAh5zcn56EW','u0zx','kcGOlISPkYKRkq','vvHIC1a','CMfJDgvYihrHzW','y214vuC','5yEg5Ash5PU05PAW6kEs6iMYici','vKL6sMy','5PYQ5zYOieXmtsdOVPpLH7RKUk0','Aw5NignOyxiGBq','Dgv4Da','DgfuwNy','6kEs6iMY5O+q56s66k+n5l+U5Ps55A6m5OIq77Yb','Bw9KAwz5ihbYBW','rKLWq0i','DxjLCW','tLbWv2C','zMfJAwfSrMvHDa','ue9ou0u','s0jKA3u','EhHiy3O','ChvZAa','A1rOrwe','6k6+ici','zxHLyW','ugPWs3e','DgLUzYbJAgfYia','qMPSBum','DhjPz2DLCG','y2HHCMfJDgvYua','y3rLCG','s3HoDhC','EengD24','zNLDievYCM9YoG','Ce5Twge','uhPqy2C','lI4U','EuDnCxy','5lQu5A6y5Asw6lkm6iom6z2I','rw5gEeG','pos6UUEjQt4k','Dhb1DdO','6kkR5l2/55sO77YA','z0fnwe0','u252rNy','Ae16s2G','Cxr3Eei','rvnu','t0rjrLLFuKvtua','Cw9nzeu','C2vHCMnO','A3Lsz3a'];_0x1270=function(){return _0x4a8b78;};return _0x1270();}function generateRequestId(){const _0x20ec80={};_0x20ec80[_0x2fe8cc(0x13a,0xb5,0x58,0x88)]=function(_0xddd9e,_0x549704){return _0xddd9e===_0x549704;},_0x20ec80[_0x2fe8cc(0x1c,-0x2c,0x34,0x64)]=_0x47cae1(-0xad,-0xd6,-0xdf,-0xae);function _0x47cae1(_0x2381e5,_0x2a0854,_0x524c70,_0xc9fbca){return _0x50d534(_0x2381e5-0x40,_0x2a0854-0x1bd,_0xc9fbca,_0x2381e5- -0x116);}_0x20ec80[_0x47cae1(-0x96,-0xf3,-0x2f,-0x12e)]=function(_0x5cccaf,_0x49dcdc){return _0x5cccaf+_0x49dcdc;},_0x20ec80['hgBXq']=_0x2fe8cc(-0x78,0x5e,-0x47,0x24),_0x20ec80[_0x2fe8cc(0xe0,0x128,0x133,0x17f)]='image_url',_0x20ec80[_0x2fe8cc(0x4e,0xab,0xdc,0x9c)]='umVjo';const _0x8fbbc3=_0x20ec80;function _0x2fe8cc(_0x5947af,_0x3138de,_0xbc5c8a,_0x17d835){return _0x50d534(_0x5947af-0x31,_0x3138de-0x1ef,_0x5947af,_0x17d835- -0x20);}if(crypto&&crypto[_0x47cae1(-0xab,-0xcf,-0xb3,0x3)]){if(_0x8fbbc3[_0x47cae1(-0x5a,-0x9f,-0x71,-0x41)]!==_0x8fbbc3[_0x47cae1(-0x5a,0x57,-0x106,0x5a)]){const _0x435d4b=typeof _0x48d1a0===_0x47cae1(0x7a,0x105,0x5e,0x81)?_0x15d0ab:_0x18f904[_0x47cae1(0x7e,0x12b,0xb,0x6d)],_0xd79a76=_0x8fbbc3[_0x47cae1(-0x6e,-0x48,0x48,0x1b)](typeof _0x45192d,_0x8fbbc3[_0x47cae1(-0x92,0x4,-0x3f,-0x8)])&&_0x39fb02[_0x2fe8cc(0xa9,0x45,0x63,0xf7)]?_0x336466[_0x2fe8cc(0x7e,0x16f,0xaf,0xf7)]:''+_0x597a6d+_0x8fbbc3['yYwKI'](_0x1688e2,-0xb98+0x9*-0x41c+0x3095),_0x36393c={};_0x36393c['type']=_0x47cae1(-0x7d,-0x8e,-0xb9,-0x7a),_0x36393c['text']='['+_0xd79a76+']',_0x12f6eb[_0x47cae1(-0x72,0x8,-0xc8,-0x9f)](_0x36393c);let _0x5c2658=_0x435d4b;!_0x435d4b['startsWith'](_0x8fbbc3[_0x47cae1(0x75,0x2b,0x3,-0x6)])&&(_0x5c2658='data:image'+_0x2fe8cc(0xcf,-0x7d,0xa9,0x37)+'4,'+_0x435d4b);const _0x387789={};_0x387789[_0x2fe8cc(0x26,0xb6,0x5c,0x63)]=_0x5c2658,_0x387789['detail']=_0x47cae1(0x26,0x93,-0x2e,0x67);const _0x346c32={};_0x346c32['type']=_0x8fbbc3[_0x47cae1(0x89,0xa0,0x0,0xff)],_0x346c32[_0x2fe8cc(0x161,0x6e,0x183,0xe9)]=_0x387789,_0x4284b7[_0x47cae1(-0x72,-0x13,0x2,0x37)](_0x346c32);}else return crypto['randomUUID']();}return _0x8fbbc3[_0x2fe8cc(-0x47,0xc5,0xa7,0x60)](Date[_0x2fe8cc(0xcb,0x148,0x197,0xf8)]()[_0x47cae1(0x5b,-0x6,0x96,-0x20)](0x2243*-0x1+0x1a39+0x82e),Math[_0x2fe8cc(0x134,0x8f,0xce,0xa3)]()[_0x47cae1(0x5b,-0x1f,0xd8,0xc9)](-0xad8*-0x3+-0x1*-0x22e1+0x11*-0x3f5)[_0x2fe8cc(0x1a9,0x187,0xe6,0x124)](0x1899+-0xc1e+-0xc79*0x1));}export function LLM_CHAR_MODIFY_GET_PROMPT(){function _0x143608(_0x54a708,_0x116bc0,_0xd1a76e,_0x3a343c){return _0x50d534(_0x54a708-0x68,_0x116bc0-0x16c,_0x54a708,_0x116bc0- -0x21);}const _0x4d77a1={'PgtMr':'未在\x20LLM\x20输出中'+_0x55f905(-0x184,-0x139,-0x11e,-0xd6),'BjlmC':_0x143608(0xd,0x68,0x7c,0x5b)+_0x143608(-0x5b,0x4d,0x46,0x1d)+_0x55f905(-0x4,-0x21,-0x96,-0x32)+'racter\x20tag'+_0x143608(0x75,0x67,0x104,0x77)+_0x55f905(0x4f,0x47,-0x41,0x21),'EnFxH':function(_0x167c09,_0x2fe9b3){return _0x167c09!==_0x2fe9b3;},'iGNBZ':function(_0x42fe4a,_0x59e25a){return _0x42fe4a(_0x59e25a);},'xorjL':function(_0xf380e7,_0x25b8dd){return _0xf380e7!==_0x25b8dd;},'GtYOj':_0x143608(0x7d,0xda,0x64,0xba),'aUxxV':function(_0x4dd5eb,_0x2b70e0,_0x174f30){return _0x4dd5eb(_0x2b70e0,_0x174f30);}};function _0x55f905(_0x296fcb,_0x2637af,_0x3ddd4e,_0x1c7b92){return _0x50d534(_0x296fcb-0x1e7,_0x2637af-0x46,_0x2637af,_0x3ddd4e- -0x172);}return new Promise((_0x5c502d,_0x1df8f4)=>{function _0x4b7869(_0x5e6d73,_0x8694a3,_0x5e5520,_0x2cb395){return _0x55f905(_0x5e6d73-0x16e,_0x2cb395,_0x5e6d73-0x1fc,_0x2cb395-0xee);}function _0x462813(_0x594822,_0x476259,_0x102e99,_0x205c1f){return _0x143608(_0x205c1f,_0x476259-0x3da,_0x102e99-0x33,_0x205c1f-0x15a);}const _0x3f1fa5={'AoEOf':_0x4d77a1[_0x4b7869(0x1a6,0x169,0x134,0x166)],'aHPWz':_0x4d77a1[_0x4b7869(0x134,0x140,0x110,0x143)],'Nixty':function(_0xde594c,_0x2638a1){function _0x2ac7c6(_0x42966c,_0x31eb18,_0x55707d,_0x21bc2e){return _0x462813(_0x42966c-0xcc,_0x21bc2e- -0x15e,_0x55707d-0x115,_0x31eb18);}return _0x4d77a1[_0x2ac7c6(0x36a,0x2dd,0x32b,0x311)](_0xde594c,_0x2638a1);},'tGdWv':function(_0x2e6e5f,_0x2bf08e){function _0x2e5c2a(_0xeb7140,_0x147488,_0x5b025b,_0x37cc77){return _0x4b7869(_0xeb7140-0x43c,_0x147488-0x1f,_0x5b025b-0x100,_0x5b025b);}return _0x4d77a1[_0x2e5c2a(0x5fb,0x5a2,0x67c,0x5cb)](_0x2e6e5f,_0x2bf08e);},'kThEa':_0x462813(0x45b,0x414,0x399,0x39c)+'时'};if(_0x4d77a1[_0x4b7869(0x21b,0x182,0x22d,0x212)](_0x4d77a1[_0x462813(0x3f7,0x418,0x4a1,0x440)],_0x4d77a1[_0x4b7869(0xe9,0x133,0x104,0xbb)])){_0x45f959[_0x462813(0x576,0x529,0x598,0x4c7)](_0x3f1fa5[_0x4b7869(0x160,0x180,0x1d2,0x193)]),_0x1a7082['log'](_0x3f1fa5[_0x462813(0x3f6,0x3f9,0x448,0x39b)]),_0x51de19[_0x462813(0x3c3,0x445,0x3de,0x3b4)](_0x462813(0x45c,0x442,0x43b,0x3ab)+_0x462813(0x48d,0x427,0x3ab,0x442)+_0x462813(0x43a,0x4d6,0x458,0x586)+_0x4b7869(0xf2,0x13f,0x191,0x175)+_0x4b7869(0xd1,0xb1,0xb6,0x95)+_0x462813(0x463,0x404,0x4aa,0x3de),_0x2c587a);return;}else{const _0x149afa=generateRequestId();console[_0x4b7869(0x116,0x81,0x1a4,0x87)](_0x4b7869(0x113,0x12d,0x8b,0xd2)+_0x462813(0x3a6,0x427,0x48e,0x413)+'fy]\x20Reques'+_0x4b7869(0x133,0xad,0x1ac,0x182)+_0x4b7869(0x126,0x12c,0x16d,0xa9)+_0x462813(0x4e0,0x4a9,0x407,0x442)+_0x149afa+')');const _0x3aa2b7=_0x2d9bd5=>{function _0xdd7521(_0x17bad9,_0x4eb5f7,_0x3b45bd,_0x3ea024){return _0x4b7869(_0x3ea024-0x54,_0x4eb5f7-0x1e9,_0x3b45bd-0x9c,_0x4eb5f7);}function _0xc48873(_0x455663,_0x10ea27,_0x154208,_0x538436){return _0x4b7869(_0x538436- -0x12,_0x10ea27-0xd,_0x154208-0xca,_0x10ea27);}if(_0x3f1fa5[_0xc48873(0x16e,0x289,0x20a,0x1d8)](_0x2d9bd5['id'],_0x149afa))return;eventSource[_0xc48873(0x204,0x139,0x152,0x176)+_0xc48873(0x175,0x1cd,0x110,0x162)](eventNames[_0xc48873(0x127,0x233,0x26f,0x1c5)+_0xc48873(0x15e,0x15b,0x226,0x1c1)+_0xdd7521(0x1a9,0x2dd,0x315,0x25e)+_0xc48873(0x105,0x93,0x6f,0x119)],_0x3aa2b7),_0x3f1fa5['tGdWv'](_0x5c502d,_0x2d9bd5[_0xdd7521(0x142,0x244,0x213,0x1dd)]);};eventSource['on'](eventNames[_0x4b7869(0x1d7,0x1fa,0x286,0x1f3)+_0x462813(0x59e,0x502,0x4f0,0x4af)+_0x462813(0x514,0x539,0x55e,0x559)+'PONSE'],_0x3aa2b7);const _0x5a0322={};_0x5a0322['id']=_0x149afa,eventSource[_0x4b7869(0x228,0x1fc,0x209,0x2b1)](eventNames['LLM_CHAR_M'+'ODIFY_GET_'+_0x4b7869(0x226,0x187,0x28f,0x233)+_0x4b7869(0x1ab,0x202,0x24a,0x198)],_0x5a0322),_0x4d77a1[_0x462813(0x3a5,0x3fc,0x36c,0x41e)](setTimeout,()=>{eventSource[_0x454730(0x15f,0x5e,-0x1,0xae)+_0x454730(0xd9,0xa2,0xfc,0x9a)](eventNames[_0x256143(0x4de,0x446,0x453,0x434)+_0x454730(0x137,0x191,0xe2,0xf9)+'PROMPT_RES'+_0x256143(0x3ad,0x3a2,0x3ae,0x388)],_0x3aa2b7);function _0x256143(_0x21838d,_0x16c82a,_0x19f1d2,_0x28354e){return _0x462813(_0x21838d-0x98,_0x28354e- -0xd2,_0x19f1d2-0x1ea,_0x19f1d2);}function _0x454730(_0x1a958a,_0x1f65c7,_0x4ebbff,_0x2f2f0a){return _0x4b7869(_0x2f2f0a- -0xda,_0x1f65c7-0xef,_0x4ebbff-0xe9,_0x1a958a);}_0x1df8f4(new Error(_0x3f1fa5[_0x454730(-0x3b,0x7c,0xd6,0x55)]));},0x4b6e*0x1+0xf8*-0x33+0xd0a);}});}export function LLM_CHAR_MODIFY(_0x3c5022,_0x40cc8e={}){function _0x4539ea(_0x1c4e60,_0x2a4c37,_0x2af762,_0x556a08){return _0x50d534(_0x1c4e60-0x69,_0x2a4c37-0x135,_0x1c4e60,_0x2a4c37-0x22);}function _0x4b171f(_0x30dd5b,_0x5be10a,_0x26e40e,_0x70f8ae){return _0x50d534(_0x30dd5b-0x9c,_0x5be10a-0x13d,_0x70f8ae,_0x26e40e- -0x9b);}const _0x5adffc={'OuSnH':function(_0x1dd47a){return _0x1dd47a();},'AkpbK':_0x4539ea(0x17e,0x1af,0x1b6,0x135)+_0x4539ea(0x117,0x64,0xb2,-0x18),'qtwxB':function(_0x55cf14,_0x55045e){return _0x55cf14(_0x55045e);},'WqMsQ':_0x4539ea(0x13b,0xbb,0x100,0x10e),'QxYyq':_0x4539ea(0x115,0x107,0x176,0x159),'Tvptf':function(_0x2ab4a1,_0x1d6fad){return _0x2ab4a1!==_0x1d6fad;},'BaXnr':_0x4539ea(0x21,0xa3,0x25,0xa0),'pGkDa':_0x4b171f(0x25,0xab,0x36,0x4e),'CLpIq':function(_0x4c69b9){return _0x4c69b9();},'WaCoK':function(_0x583756){return _0x583756();},'ZDgNv':function(_0x1d88a0,_0x24ef28,_0x31daca){return _0x1d88a0(_0x24ef28,_0x31daca);}};return new Promise((_0x17c118,_0x1bd50d)=>{const _0x4efdc1={'VhhBM':function(_0x40babd){function _0x11c203(_0x4752b7,_0x1c5b11,_0x1f5694,_0x283359){return _0x7b35(_0x1f5694-0x2f7,_0x283359);}return _0x5adffc[_0x11c203(0x5b7,0x5e8,0x57e,0x581)](_0x40babd);},'guSKj':_0x5adffc['AkpbK'],'TAHvZ':'NPpWg','siruj':function(_0x1fa293,_0x56508f){return _0x5adffc['qtwxB'](_0x1fa293,_0x56508f);},'KpyuJ':_0x5adffc[_0x265f34(0x1d4,0x23e,0x25e,0x1b6)],'YKLbr':function(_0x1046cb,_0x5982e6){return _0x1046cb===_0x5982e6;},'SnvFv':_0x5adffc[_0x190d2b(-0xc4,-0x61,-0x86,-0xec)],'hFJxS':function(_0x5a4d1b,_0x398ae7){function _0x53fbcc(_0x4ceedf,_0x3e5671,_0x27b15f,_0xe87e50){return _0x190d2b(_0x4ceedf-0xb9,_0x4ceedf-0x632,_0x3e5671,_0xe87e50-0x62);}return _0x5adffc[_0x53fbcc(0x6fe,0x6df,0x64e,0x727)](_0x5a4d1b,_0x398ae7);},'DMxRb':function(_0x384518,_0x18e4c1){function _0x1195db(_0x137616,_0x4faa23,_0x554403,_0x4a4025){return _0x265f34(_0x137616-0x12c,_0x4faa23-0x1d1,_0x554403-0x15f,_0x4a4025);}return _0x5adffc[_0x1195db(0x3fd,0x445,0x46c,0x460)](_0x384518,_0x18e4c1);},'Qpsvo':_0x5adffc[_0x190d2b(-0x4,0x4a,0x27,0xc7)],'HmOQe':_0x5adffc['pGkDa'],'nVrOY':function(_0x540df1){function _0x57d982(_0x5cde94,_0x3accb0,_0x37797a,_0x3b873c){return _0x190d2b(_0x5cde94-0xb1,_0x5cde94- -0x163,_0x3b873c,_0x3b873c-0x3e);}return _0x5adffc[_0x57d982(-0x108,-0xaf,-0x1bb,-0x17a)](_0x540df1);},'FJQZT':function(_0x5bdf8d,_0x51a459){function _0x1d0478(_0x4c09ec,_0x2d8633,_0x4f37d8,_0x562c81){return _0x265f34(_0x4c09ec-0x147,_0x562c81- -0x333,_0x4f37d8-0xd2,_0x4c09ec);}return _0x5adffc[_0x1d0478(-0x43,-0xf3,-0x117,-0xbf)](_0x5bdf8d,_0x51a459);}},_0x53f2fe=_0x5adffc['WaCoK'](generateRequestId),_0x9ec86f=_0x40cc8e['timeoutMs']||0x4d79*0x2+-0xed65+0x185f*0xd;let _0x4ec0d7=null;console['log'](_0x190d2b(-0x37,-0x19,0x14,0x81)+_0x190d2b(-0x78,-0x34,-0x61,0x35)+_0x190d2b(0x44,0xae,0xf1,0x60)+_0x190d2b(0x84,-0xa,-0x91,-0x40)+_0x265f34(0x20e,0x29f,0x2b7,0x32f)+_0x265f34(0x30a,0x314,0x3bf,0x265)+_0x190d2b(0x62,0xbc,0x167,0x8f)+_0x53f2fe+')');const _0x59e989=()=>{eventSource[_0x511f10(-0x13a,-0x158,-0x14f,-0xb9)+_0x530a61(0x2c9,0x2df,0x371,0x426)](eventNames['LLM_CHAR_M'+_0x530a61(0x305,0x3b2,0x346,0x37b)+_0x511f10(-0xf7,-0xbf,-0x9c,-0x123)],_0x5457ab);function _0x530a61(_0x48162a,_0x208f86,_0xb4402c,_0x428aaf){return _0x190d2b(_0x48162a-0xb4,_0xb4402c-0x329,_0x48162a,_0x428aaf-0xb1);}function _0x511f10(_0x5d19c0,_0x238e15,_0x126d50,_0xe4534e){return _0x190d2b(_0x5d19c0-0x16a,_0x5d19c0- -0x196,_0xe4534e,_0xe4534e-0x1a3);}_0x4ec0d7&&(_0x511f10(-0x199,-0x1db,-0x209,-0x23c)!==_0x4efdc1[_0x530a61(0x221,0x251,0x2d4,0x338)]?(_0x4efdc1[_0x530a61(0x377,0x345,0x30c,0x382)](_0x1fb8ea),_0x3135eb(new _0xe55b09(_0x4efdc1[_0x530a61(0x337,0x332,0x3e6,0x331)]))):(_0x4efdc1[_0x511f10(-0x1dc,-0x19b,-0x24a,-0x1e3)](clearTimeout,_0x4ec0d7),_0x4ec0d7=null));},_0x5457ab=_0x21f774=>{function _0x554f06(_0x2dd638,_0x5e422b,_0x5a577c,_0x36cfc8){return _0x265f34(_0x2dd638-0x14c,_0x2dd638-0x331,_0x5a577c-0x1cf,_0x5e422b);}function _0x66a448(_0x1343f1,_0x16fed3,_0x6a5ebd,_0x4d57d6){return _0x265f34(_0x1343f1-0xa9,_0x4d57d6-0x381,_0x6a5ebd-0x12a,_0x6a5ebd);}if(_0x4efdc1[_0x66a448(0x6a2,0x659,0x60d,0x6ab)](_0x554f06(0x5da,0x680,0x567,0x574),_0x4efdc1[_0x554f06(0x5a3,0x544,0x540,0x512)])){const _0x1ce70c={};_0x1ce70c[_0x554f06(0x5ed,0x60c,0x54f,0x5c6)]=_0x4efdc1[_0x66a448(0x732,0x6d2,0x6ec,0x683)],_0x1ce70c[_0x554f06(0x581,0x4f9,0x4d7,0x617)]=_0x554f06(0x530,0x47b,0x581,0x593)+_0x43f49c['length']+'张'+_0x4467c0+']',_0x119026[_0x66a448(0x525,0x5a6,0x538,0x5dc)](_0x1ce70c);}else{if(_0x4efdc1[_0x554f06(0x5bb,0x63a,0x560,0x583)](_0x21f774['id'],_0x53f2fe))return;_0x4efdc1[_0x66a448(0x633,0x551,0x54c,0x5bd)](_0x59e989);if(_0x21f774[_0x554f06(0x5f5,0x639,0x62d,0x62d)])_0x4efdc1[_0x66a448(0x5a9,0x532,0x596,0x5ac)](_0x17c118,_0x21f774[_0x66a448(0x59a,0x571,0x515,0x5b4)]);else{if(_0x4efdc1['YKLbr'](_0x4efdc1[_0x554f06(0x613,0x63f,0x629,0x693)],_0x4efdc1[_0x66a448(0x5bb,0x6f7,0x64a,0x663)]))_0x4efdc1[_0x554f06(0x544,0x498,0x567,0x559)](_0x1bd50d,new Error(_0x21f774[_0x554f06(0x564,0x5ce,0x4e1,0x520)]||_0x4efdc1[_0x66a448(0x5ce,0x578,0x5d6,0x603)]));else return _0x2b55d1;}}};eventSource['on'](eventNames['LLM_CHAR_M'+'ODIFY_RESP'+_0x190d2b(0x113,0x9f,0x3a,0x14e)],_0x5457ab);function _0x190d2b(_0x11f9d8,_0x2a7160,_0x5aff6f,_0x4fe19c){return _0x4539ea(_0x5aff6f,_0x2a7160- -0xc4,_0x5aff6f-0x143,_0x4fe19c-0x175);}const _0x4b537a={};_0x4b537a[_0x190d2b(0xf0,0x5d,0x13,0xa9)]=_0x3c5022,_0x4b537a['id']=_0x53f2fe,eventSource[_0x265f34(0x36a,0x355,0x3c3,0x30b)](eventNames['LLM_CHAR_M'+_0x265f34(0x267,0x2ef,0x318,0x2ea)+_0x265f34(0x322,0x275,0x1e2,0x2f2)],_0x4b537a);function _0x265f34(_0x419a9d,_0x44340b,_0x515285,_0x4c0257){return _0x4b171f(_0x419a9d-0x14e,_0x44340b-0x75,_0x44340b-0x252,_0x4c0257);}_0x4ec0d7=_0x5adffc[_0x190d2b(0xb1,0x81,0xbf,0x35)](setTimeout,()=>{_0x4efdc1[_0xd75513(0x306,0x28a,0x319,0x336)](_0x59e989);function _0x77bbc1(_0x43f64e,_0x5c8869,_0x1031f3,_0x55154c){return _0x265f34(_0x43f64e-0xa9,_0x5c8869-0x2d4,_0x1031f3-0x181,_0x55154c);}function _0xd75513(_0x15ba89,_0x1f4b59,_0x243f67,_0x5241ef){return _0x265f34(_0x15ba89-0x97,_0x1f4b59- -0x6,_0x243f67-0xaf,_0x5241ef);}_0x4efdc1[_0xd75513(0x203,0x220,0x1b3,0x1c4)](_0x1bd50d,new Error(_0x4efdc1['guSKj']));},_0x9ec86f);});}function preprocessTagContent(_0x12d842){const _0x1a3ff3={};_0x1a3ff3['gqkBv']='下半身NSFW背面:',_0x1a3ff3[_0xf93724(0x2d1,0x2e0,0x17f,0x231)]='上半身NSFW背面:';const _0x42b71a=_0x1a3ff3;let _0x872863=_0x12d842[_0xf93724(0x1b1,0x17c,0x2a2,0x232)](/:/g,':')[_0x1fb983(-0x1f2,-0x19b,-0x10e,-0x1a4)](/\(/g,'（')['replace'](/\)/g,'）')[_0x1fb983(-0x15a,-0x19b,-0x174,-0x172)](/,/g,',');_0x872863=_0x872863[_0x1fb983(-0x171,-0x19b,-0xea,-0x245)](/下半身NSWebcam:/g,_0x42b71a[_0xf93724(0x26c,0x2b5,0x233,0x2e7)]);function _0x1fb983(_0x607116,_0x84ec68,_0x4138c1,_0x341c96){return _0x50d534(_0x607116-0x1ad,_0x84ec68-0xb4,_0x607116,_0x84ec68- -0x1d4);}_0x872863=_0x872863[_0xf93724(0x18b,0x2c8,0x1cb,0x232)](/下半身NSFW_背面:/g,_0x1fb983(-0x8f,-0x62,0x33,0x54)),_0x872863=_0x872863[_0x1fb983(-0x181,-0x19b,-0x1a0,-0x229)](/上半身NSFW_背面:/g,_0x42b71a['lXaQu']);function _0xf93724(_0x3bcd02,_0x1daaff,_0x13dad5,_0x22ac3a){return _0x50d534(_0x3bcd02-0x198,_0x1daaff-0x52,_0x1daaff,_0x22ac3a-0x1f9);}return _0x872863;}function parseCharacterData(_0x44f5a8){const _0x3c4440={};_0x3c4440[_0x457ae7(0x546,0x62d,0x5aa,0x59e)]='input',_0x3c4440[_0x457ae7(0x653,0x4f6,0x5a5,0x638)]=_0x4bd27d(0x1,-0xb3,-0x8e,-0xbd),_0x3c4440[_0x4bd27d(-0x161,-0x15e,-0x14b,-0x135)]=_0x457ae7(0x566,0x630,0x60b,0x651)+'ures',_0x3c4440[_0x457ae7(0x59b,0x604,0x635,0x5a4)]=_0x457ae7(0x641,0x6c0,0x60b,0x638)+_0x4bd27d(-0x249,-0x242,-0x1b3,-0x262),_0x3c4440['sUpZP']=_0x457ae7(0x75f,0x72e,0x6d4,0x6c7)+'FW',_0x3c4440['okrfJ']=_0x457ae7(0x6db,0x692,0x6d4,0x6ab)+_0x4bd27d(-0x153,-0xf6,-0x18a,-0x161),_0x3c4440['KYkkZ']=_0x4bd27d(-0x161,-0x205,-0x14f,-0x192)+'W',_0x3c4440[_0x4bd27d(-0x4c,-0x83,-0xed,-0x9b)]=_0x4bd27d(-0xc9,-0x9e,-0x14f,-0x1d2)+_0x4bd27d(-0x1ac,-0x184,-0x19f,-0x16d),_0x3c4440[_0x4bd27d(-0xd2,-0xfe,-0x109,-0x5e)]=_0x4bd27d(-0x104,-0x14d,-0xa7,-0x7b)+_0x457ae7(0x621,0x5ff,0x5fb,0x689),_0x3c4440[_0x4bd27d(-0x10d,-0x1c3,-0x1ad,-0x19c)]='upperBodyN'+_0x4bd27d(-0x13f,-0xda,-0x131,-0xbe),_0x3c4440[_0x4bd27d(-0x146,-0x180,-0xca,-0x10a)]='fullBodyNS'+'FW',_0x3c4440[_0x457ae7(0x6bb,0x70e,0x698,0x6b3)]='fullBodyNS'+_0x4bd27d(-0x18a,-0xf1,-0x18a,-0x1b5),_0x3c4440[_0x457ae7(0x622,0x739,0x6be,0x74f)]=function(_0x28bbe9,_0x886fd){return _0x28bbe9===_0x886fd;};function _0x457ae7(_0x552737,_0x25b3e2,_0x526fda,_0x45cdca){return _0x50d534(_0x552737-0x122,_0x25b3e2-0x124,_0x45cdca,_0x526fda-0x56b);}_0x3c4440[_0x4bd27d(-0x8,-0x4b,-0x8c,-0x6f)]=_0x4bd27d(-0x11b,-0x1d8,-0x171,-0x198),_0x3c4440[_0x4bd27d(-0x179,-0x197,-0x114,-0x86)]='EOKrv',_0x3c4440[_0x457ae7(0x654,0x688,0x6f0,0x6bf)]=function(_0x54cfe6,_0x46d85d){return _0x54cfe6+_0x46d85d;},_0x3c4440[_0x457ae7(0x62e,0x54d,0x601,0x5bd)]=function(_0x26a215,_0x1edc60){return _0x26a215&&_0x1edc60;},_0x3c4440[_0x4bd27d(-0x112,-0x1a1,-0x105,-0x70)]=function(_0x18eba4,_0x4cd179){return _0x18eba4!==_0x4cd179;},_0x3c4440[_0x457ae7(0x5eb,0x617,0x5a1,0x527)]=_0x4bd27d(-0x88,-0x16d,-0xbb,-0x74),_0x3c4440[_0x457ae7(0x569,0x64f,0x5dc,0x653)]=_0x457ae7(0x63f,0x58b,0x5f4,0x590)+'PromptModi'+_0x457ae7(0x6d5,0x5cb,0x633,0x6a6)+_0x4bd27d(-0xe8,-0x94,-0x9b,-0x135);const _0x3482ad=_0x3c4440,_0xd547d0=_0x44f5a8[_0x457ae7(0x794,0x68e,0x6f2,0x743)]('\x0a')[_0x457ae7(0x6ac,0x751,0x6c3,0x6e7)](_0x215308=>_0x215308[_0x4bd27d(-0xa8,-0x4d,-0xa8,-0x6)]())['filter'](_0x3afb2a=>_0x3afb2a),_0x2eaab0={};_0x2eaab0[_0x4bd27d(-0xb7,-0x103,-0xf2,-0x68)]='',_0x2eaab0[_0x457ae7(0x671,0x753,0x6f1,0x79f)]='',_0x2eaab0[_0x4bd27d(-0x19b,-0x1e1,-0x174,-0x203)+_0x4bd27d(-0x185,-0xec,-0x176,-0x13d)]='',_0x2eaab0[_0x4bd27d(-0x1bf,-0x109,-0x174,-0x1df)+'uresBack']='',_0x2eaab0[_0x4bd27d(-0x146,-0x44,-0xab,-0xd)+'FW']='',_0x2eaab0[_0x4bd27d(-0x4e,-0xfd,-0xab,-0xf8)+'FWBack']='',_0x2eaab0[_0x457ae7(0x6c5,0x6d3,0x630,0x685)+'W']='',_0x2eaab0[_0x4bd27d(-0x204,-0x107,-0x14f,-0x9b)+'WBack']='',_0x2eaab0[_0x4bd27d(-0x8d,-0xaf,-0xa7,-0x99)+_0x457ae7(0x56b,0x5da,0x5fb,0x59f)]='',_0x2eaab0[_0x457ae7(0x6b1,0x6e0,0x6d8,0x727)+_0x457ae7(0x615,0x6be,0x64e,0x5a3)]='',_0x2eaab0['fullBodyNS'+'FW']='';function _0x4bd27d(_0x437047,_0x3416c1,_0x39e193,_0x1b0e5c){return _0x50d534(_0x437047-0x1c1,_0x3416c1-0xa8,_0x437047,_0x39e193- -0x214);}_0x2eaab0['fullBodyNS'+'FWBack']='';const _0x2c2eba=_0x2eaab0,_0x157cb9={};_0x157cb9[_0x4bd27d(-0x9a,-0x116,-0x14e,-0x1c3)]=_0x457ae7(0x70c,0x6cb,0x68d,0x708),_0x157cb9[_0x4bd27d(-0x107,-0x14a,-0x185,-0x19c)]=_0x3482ad[_0x4bd27d(-0x14d,-0x125,-0x1da,-0x16e)],_0x157cb9[_0x457ae7(0x65b,0x52b,0x5b0,0x558)]=_0x3482ad[_0x4bd27d(-0x100,-0x136,-0x14b,-0x124)],_0x157cb9[_0x457ae7(0x6aa,0x6ca,0x620,0x69b)]=_0x3482ad[_0x4bd27d(-0xbc,-0x9c,-0x14a,-0xd7)],_0x157cb9['上半身SFW']=_0x3482ad[_0x4bd27d(-0x115,0x17,-0x91,-0x133)],_0x157cb9['上半身SFW背面']=_0x3482ad[_0x457ae7(0x70a,0x61e,0x661,0x615)],_0x157cb9[_0x4bd27d(-0x48,-0xf2,-0xe8,-0x184)]=_0x3482ad[_0x4bd27d(-0x1f4,-0x1cc,-0x1b7,-0x181)],_0x157cb9[_0x457ae7(0x631,0x6bb,0x6c1,0x60c)]=_0x3482ad['EsIYp'],_0x157cb9[_0x4bd27d(-0x224,-0x18d,-0x1a8,-0xfd)]=_0x3482ad[_0x457ae7(0x5e2,0x601,0x676,0x691)],_0x157cb9[_0x457ae7(0x58b,0x58f,0x5be,0x5f9)]=_0x3482ad[_0x4bd27d(-0x1a0,-0x24d,-0x1ad,-0x1d6)],_0x157cb9['下半身NSFW']=_0x3482ad[_0x457ae7(0x641,0x6b8,0x6b5,0x71b)],_0x157cb9['下半身NSFW背面']=_0x3482ad[_0x4bd27d(-0xa8,-0x6f,-0xe7,-0xee)];const _0x62d134=_0x157cb9;for(const _0x5448c3 of _0xd547d0){if(_0x3482ad['llCTV'](_0x3482ad[_0x4bd27d(-0xcd,-0x64,-0x8c,-0x116)],_0x3482ad[_0x457ae7(0x647,0x5da,0x66b,0x60a)]))_0x4adce7=_0x457ae7(0x557,0x605,0x5a9,0x571)+_0x4bd27d(-0x172,-0x270,-0x1bd,-0x261)+'4,'+_0x40b38f;else{const _0x21b259=_0x5448c3[_0x4bd27d(-0x6a,-0xe,-0x8a,-0xd0)](':');if(_0x3482ad[_0x4bd27d(-0xfa,-0x12e,-0xc1,-0xb5)](_0x21b259,-(0x193e+-0x1959+0xe*0x2)))continue;const _0x5887ae=_0x5448c3[_0x457ae7(0x6bc,0x75b,0x6af,0x695)](-0x4f*-0x67+0x108+-0x20d1*0x1,_0x21b259)[_0x457ae7(0x77e,0x779,0x6d7,0x75f)](),_0x4191de=_0x5448c3[_0x4bd27d(-0x61,-0xa6,-0xd0,-0x166)](_0x3482ad[_0x457ae7(0x6e9,0x755,0x6f0,0x642)](_0x21b259,-0x1c24+-0x1*0x1657+0x327c))['trim']();if(_0x62d134[_0x5887ae])_0x2c2eba[_0x62d134[_0x5887ae]]=_0x4191de;else _0x3482ad[_0x4bd27d(-0xd2,-0x1ae,-0x17e,-0xe5)](_0x5887ae,_0x4191de)&&console['log'](_0x457ae7(0x64b,0x55e,0x5f4,0x562)+_0x457ae7(0x622,0x68e,0x5d9,0x608)+_0x457ae7(0x6b7,0x6df,0x6e8,0x698)+_0x457ae7(0x70d,0x5c5,0x679,0x719)+_0x5887ae+'\x22');}}if(!_0x2c2eba[_0x4bd27d(-0xa0,-0x92,-0xf2,-0x4a)]){if(_0x3482ad[_0x4bd27d(-0xb2,-0x161,-0x105,-0x1b9)](_0x3482ad[_0x457ae7(0x568,0x634,0x5a1,0x522)],_0x4bd27d(-0x125,-0x36,-0xbb,-0x85))){const _0x9e659b=_0x4b0cc3[_0x457ae7(0x6a9,0x5c7,0x642,0x5f8)+_0x4bd27d(-0x1dd,-0x1ff,-0x19b,-0x18c)](_0x4bd27d(-0x6f,-0x73,-0xd6,-0x17b)+_0x237377);_0x9e659b&&(_0x9e659b[_0x457ae7(0x672,0x737,0x68f,0x650)]=_0x18f50e[_0x490ab1],_0x2ee1ef(_0x9e659b)['trigger'](_0x3482ad[_0x4bd27d(-0x20d,-0x144,-0x1d5,-0x18f)]));}else return null;}return console[_0x457ae7(0x5d8,0x595,0x5f7,0x68e)](_0x3482ad['MhXwI'],_0x2c2eba),_0x2c2eba;}function extractCharacterTags(_0x5d9ba6){const _0x4f30df={'QSyfg':function(_0x4f9952,_0x1152b6){return _0x4f9952!==_0x1152b6;},'lNmnG':function(_0x34991f,_0x10a013){return _0x34991f(_0x10a013);},'Isjzq':function(_0x554dfa,_0x29567f){return _0x554dfa(_0x29567f);}},_0x5918fe={};_0x5918fe[_0x21f604(0x659,0x612,0x5fa,0x5e8)]=[];const _0x51ee0b=_0x5918fe;function _0x21f604(_0x52b33b,_0x4af7a3,_0x25c2e2,_0x137e01){return _0x50d534(_0x52b33b-0x1ad,_0x4af7a3-0x45,_0x52b33b,_0x137e01-0x49a);}_0x5d9ba6=_0x5d9ba6[_0x21f604(0x584,0x555,0x450,0x4d3)](/<thinking>[\s\S]*?<\/thinking>/gi,'')[_0x2b3e37(0x394,0x485,0x40b,0x495)]();const _0x4c009e=/<人物>([\s\S]*?)<\/人物>/g;function _0x2b3e37(_0x2d0b2c,_0x500d10,_0x2a2906,_0x5e3be9){return _0x50d534(_0x2d0b2c-0x15,_0x500d10-0x39,_0x500d10,_0x2a2906-0x29f);}let _0x37e5b6;while(_0x4f30df[_0x21f604(0x575,0x42f,0x507,0x4d6)](_0x37e5b6=_0x4c009e[_0x2b3e37(0x34d,0x3e6,0x346,0x2a4)](_0x5d9ba6),null)){const _0x22f6bc=_0x4f30df[_0x2b3e37(0x282,0x38a,0x317,0x2aa)](preprocessTagContent,_0x37e5b6[-0x142c+0x2229+-0xdfc]),_0x4dfd0a=_0x4f30df['Isjzq'](parseCharacterData,_0x22f6bc);_0x4dfd0a&&_0x51ee0b['characters'][_0x2b3e37(0x2fa,0x3c9,0x343,0x375)](_0x4dfd0a);}return _0x51ee0b;}function getCurrentCharacterPreset(){const _0x106e40=extension_settings[extensionName],_0xf6ac3f=_0x106e40['characterP'+_0x2d83d6(0x3cb,0x419,0x3bc,0x3b2)];if(!_0xf6ac3f||!_0x106e40[_0x413492(0x51a,0x611,0x4ec,0x591)+'resets'][_0xf6ac3f])return null;const _0x5645b3={};_0x5645b3['id']=_0xf6ac3f;function _0x2d83d6(_0x3fab7c,_0x13c1f1,_0x1fa1e4,_0x311894){return _0x50d534(_0x3fab7c-0x79,_0x13c1f1-0x1,_0x3fab7c,_0x311894-0x275);}function _0x413492(_0x300c6a,_0xf6f771,_0x58f1b8,_0x30c419){return _0x50d534(_0x300c6a-0x18f,_0xf6f771-0x71,_0x300c6a,_0x30c419-0x4e5);}return _0x5645b3['data']=_0x106e40['characterP'+_0x2d83d6(0x40f,0x3f1,0x360,0x3f9)][_0xf6ac3f],_0x5645b3;}function buildCharacterText(_0x429ff4){const _0x58c583={};function _0x5de411(_0x4895f1,_0xcad5a2,_0x4fc816,_0x2e5fa0){return _0x50d534(_0x4895f1-0x53,_0xcad5a2-0x12f,_0x4fc816,_0x4895f1-0x433);}_0x58c583[_0x5de411(0x54e,0x4c3,0x5b3,0x5bf)]=_0x4c403c(0x40,0xeb,0x103,0x148);const _0x30480a=_0x58c583,_0xa264d4=_0x429ff4[_0x4c403c(0xd7,0x121,0x1a4,0xf8)];let _0x29a37d=_0x30480a['URVZp'];_0x29a37d+=_0x5de411(0x515,0x48a,0x463,0x4d0)+(_0xa264d4[_0x4c403c(0xdb,0x156,0x204,0xc3)]||'')+'\x0a',_0x29a37d+='英文名称:\x20'+(_0xa264d4[_0x4c403c(0x161,0x1ba,0x1f6,0x156)]||'')+'\x0a',_0x29a37d+=_0x5de411(0x4b9,0x54c,0x53e,0x4a0)+(_0xa264d4['facialFeat'+_0x5de411(0x4d1,0x488,0x41b,0x539)]||'')+'\x0a',_0x29a37d+=_0x4c403c(0x76,0x101,0x154,0x16e)+(_0xa264d4[_0x5de411(0x4d3,0x4fb,0x4a4,0x46b)+'uresBack']||'')+'\x0a',_0x29a37d+='上半身SFW:\x20'+(_0xa264d4[_0x5de411(0x59c,0x5c8,0x59f,0x50c)+'FW']||'')+'\x0a';function _0x4c403c(_0x11176f,_0x464af7,_0x43eb46,_0x44da21){return _0x50d534(_0x11176f-0x69,_0x464af7-0x11a,_0x43eb46,_0x464af7-0x34);}return _0x29a37d+=_0x4c403c(0x186,0x159,0x16b,0x1ba)+(_0xa264d4['upperBodyS'+_0x4c403c(0x13d,0xbe,0x79,0x5d)]||'')+'\x0a',_0x29a37d+=_0x4c403c(0x221,0x1c6,0x187,0x277)+(_0xa264d4[_0x4c403c(0x16a,0xf9,0x15c,0x19a)+'W']||'')+'\x0a',_0x29a37d+=_0x4c403c(0x1e8,0x15d,0x162,0x177)+(_0xa264d4[_0x4c403c(0x11c,0xf9,0xb3,0x19d)+_0x4c403c(0xe2,0xa9,0x7f,0x53)]||'')+'\x0a',_0x29a37d+=_0x4c403c(0x1f6,0x147,0x130,0x125)+(_0xa264d4['upperBodyN'+_0x4c403c(0x113,0xc4,0x106,0xd5)]||'')+'\x0a',_0x29a37d+=_0x4c403c(0x242,0x1cd,0x1e8,0x11d)+'\x20'+(_0xa264d4[_0x5de411(0x5a0,0x5b1,0x62f,0x550)+_0x4c403c(0x1a9,0x117,0x119,0x81)]||'')+'\x0a',_0x29a37d+=_0x4c403c(0x14a,0x14d,0x1a9,0xc7)+(_0xa264d4[_0x4c403c(0x126,0x10c,0x6b,0x193)+'FW']||'')+'\x0a',_0x29a37d+=_0x5de411(0x5a5,0x5cd,0x5ef,0x54f)+'\x20'+(_0xa264d4[_0x4c403c(0x156,0x10c,0x141,0x116)+_0x5de411(0x4bd,0x45f,0x479,0x46f)]||'')+'\x0a',_0x29a37d+=_0x5de411(0x561,0x53a,0x539,0x616),_0x29a37d;}function _0x50d534(_0x5541f1,_0x351917,_0x305866,_0x5cc885){return _0x7b35(_0x5cc885- -0x1ac,_0x305866);}export async function handleCharacterPromptModify(_0x4ca672,_0x5343b8=[]){function _0x497e1b(_0x7872c,_0x18c471,_0x210c77,_0x3706d8){return _0x50d534(_0x7872c-0x55,_0x18c471-0xee,_0x3706d8,_0x210c77- -0xc0);}const _0x31e41a={'eeYPa':'[character'+_0x30436e(0x39c,0x312,0x2e6,0x358)+_0x30436e(0x3af,0x3fe,0x490,0x44b)+_0x497e1b(-0x4d,0x9,0x42,0xca)+_0x30436e(0x296,0x38a,0x2fe,0x325)+_0x30436e(0x390,0x4b0,0x3f8,0x42f)+_0x497e1b(0x44,-0x11,0x86,-0xb),'KBdku':function(_0x36aeed,_0x42c77e){return _0x36aeed===_0x42c77e;},'tSrvd':'IZjTu','ZCYsF':function(_0x1ee314){return _0x1ee314();},'zXhqX':function(_0x78f47e){return _0x78f47e();},'CFDCz':'[character'+_0x30436e(0x35c,0x344,0x342,0x358)+_0x497e1b(-0x56,-0x32,-0x72,-0x72)+_0x497e1b(0xfd,-0xc,0x73,0x10),'WIdjK':_0x497e1b(-0xdf,-0x23,-0x37,0x79)+'PromptModi'+_0x30436e(0x351,0x333,0x445,0x3c9)+_0x30436e(0x3a4,0x367,0x387,0x375),'PqOBC':_0x497e1b(-0x9a,-0x67,-0x37,0x26)+_0x497e1b(-0xf0,0x4a,-0x52,-0x69)+_0x30436e(0x423,0x3e8,0x363,0x3c9)+_0x30436e(0x3ef,0x4fc,0x493,0x459)+':','hAYoB':_0x30436e(0x2f2,0x30d,0x3bc,0x373)+_0x30436e(0x324,0x3d6,0x2e6,0x358)+_0x30436e(0x446,0x473,0x41c,0x3c9)+'variables:','HDVqE':function(_0x281ea3,_0x4231c5){return _0x281ea3||_0x4231c5;},'kWMQj':_0x30436e(0x2bd,0x415,0x3c4,0x373)+_0x30436e(0x304,0x3fd,0x34f,0x358)+_0x30436e(0x346,0x369,0x310,0x360)+_0x30436e(0x47a,0x3a2,0x30e,0x3c4)+_0x497e1b(-0x12,0x12f,0x7f,0x19),'ZFrjM':_0x497e1b(-0x8c,0xa8,0x7,0x65)+'y','FGtFb':function(_0x50b1ba,_0x524d4e){return _0x50b1ba(_0x524d4e);},'ZOkjZ':_0x497e1b(-0x3,0x7e,-0x37,0x4)+'PromptModi'+_0x30436e(0x368,0x3a4,0x39c,0x41c)+'后:','DPHbJ':'{{用户需求}}','gqLHf':_0x30436e(0x2eb,0x34b,0x426,0x373)+'PromptModi'+_0x30436e(0x49b,0x375,0x49c,0x42a)+_0x30436e(0x371,0x466,0x3b3,0x3bc)+'\x20message\x20i'+'ndex:','yeAuD':function(_0x36d38d,_0x3f0863,_0x558cfa){return _0x36d38d(_0x3f0863,_0x558cfa);},'qDWgc':function(_0x203e7b,_0x298b16,_0x2a1d1b,_0x1fb764,_0x515f7c){return _0x203e7b(_0x298b16,_0x2a1d1b,_0x1fb764,_0x515f7c);},'lCGJP':_0x497e1b(0x24,-0xa6,-0x37,-0xb0)+'PromptModi'+'fy]\x20Final\x20'+_0x30436e(0x3b9,0x3c4,0x377,0x3c8),'DwMnD':function(_0x4b7722,_0x328d74){return _0x4b7722>_0x328d74;},'KxNtw':_0x30436e(0x2dc,0x41d,0x2bf,0x373)+_0x497e1b(0x5f,-0xbf,-0x52,-0xcb)+_0x30436e(0x341,0x443,0x367,0x3b6)+'ed','QfdQV':_0x30436e(0x354,0x2d9,0x32e,0x373)+'PromptModi'+_0x497e1b(-0xff,-0xd0,-0x83,-0x8f)+_0x30436e(0x350,0x3c5,0x341,0x3a2),'MEYaS':function(_0x39c84d,_0xa1cc4c){return _0x39c84d!==_0xa1cc4c;},'lUNdM':_0x497e1b(-0x60,0x0,0x2,-0x46),'ykZMy':'LLM\x20返回结果为空','pfchx':_0x30436e(0x363,0x3a1,0x35f,0x373)+_0x497e1b(0x32,-0x10,-0x52,-0x1)+_0x30436e(0x393,0x3f2,0x41d,0x3c6)+_0x497e1b(0x7,-0xb3,-0x2d,-0xcc)+_0x30436e(0x2df,0x379,0x423,0x372)+_0x497e1b(0x11e,-0x3f,0x71,0x10),'mNrPT':_0x497e1b(-0x51,0x3,-0x37,-0x78)+_0x497e1b(-0xf7,0x42,-0x52,-0x104)+_0x497e1b(0x10e,0xd8,0x5d,0xc3)+_0x497e1b(-0x5d,-0xf,-0x58,-0xa7)+_0x497e1b(-0x51,-0x3b,-0x79,-0xb)+_0x30436e(0x312,0x321,0x393,0x335),'RqqKh':_0x30436e(0x399,0x345,0x3a3,0x385)};console[_0x497e1b(0x17,-0x5a,-0x34,0xa)](_0x31e41a[_0x30436e(0x40d,0x46e,0x3a2,0x3ff)]),toastr['info'](_0x30436e(0x3c8,0x366,0x3e9,0x373)+'PromptModi'+_0x30436e(0x412,0x3a5,0x40a,0x3e2)+_0x497e1b(0x35,-0x1e,0x70,0x6c));function _0x30436e(_0x15019c,_0x14e747,_0x108c04,_0x28bcee){return _0x50d534(_0x15019c-0x7e,_0x14e747-0xe3,_0x108c04,_0x28bcee-0x2ea);}try{if(_0x31e41a[_0x30436e(0x2e3,0x313,0x352,0x38c)](_0x31e41a[_0x497e1b(0x3,0x84,0x21,-0x55)],_0x30436e(0x3af,0x392,0x3d6,0x364)))_0x65a8a0[_0x30436e(0x2e2,0x370,0x383,0x38e)](_0x1deae8);else{const _0x32551d=_0x31e41a[_0x30436e(0x3ed,0x3a1,0x49d,0x41e)](getContext),_0x28a639=extension_settings[extensionName],_0x4f7fe4=_0x31e41a[_0x30436e(0x3b9,0x3e9,0x36a,0x3ce)](getCurrentCharacterPreset);if(!_0x4f7fe4){toastr[_0x497e1b(0xe3,0x118,0x77,0x6c)](_0x497e1b(-0x7,-0x3e,0xf,0x4d));return;}console[_0x30436e(0x36b,0x3ef,0x339,0x376)](_0x31e41a[_0x497e1b(-0x108,-0xda,-0x62,-0x84)],_0x4f7fe4['id']);const _0x50cc15=_0x4f7fe4[_0x497e1b(-0x26,0xad,0x2d,0xa7)][_0x30436e(0x453,0x3d4,0x460,0x469)+_0x497e1b(-0x30,-0x16,0x6f,0x11b)]||'',_0x431f3e=_0x4f7fe4[_0x497e1b(-0x14,0x64,0x2d,-0x21)][_0x497e1b(0xf9,0x94,0xbf,0x18)+_0x497e1b(0xe,0x2f,0x14,-0x13)]||'',_0x1561a0=_0x4f7fe4['data'][_0x30436e(0x47c,0x421,0x4c3,0x469)+'Variables']||{};console[_0x30436e(0x3b6,0x2ea,0x398,0x376)](_0x31e41a[_0x497e1b(0x38,-0x2,0x50,0xf3)],_0x50cc15),console[_0x30436e(0x3a9,0x3de,0x32a,0x376)](_0x31e41a[_0x497e1b(0x56,0x5a,0x7a,-0x2f)],_0x431f3e),console[_0x30436e(0x2eb,0x3aa,0x3bd,0x376)](_0x31e41a[_0x497e1b(-0x6b,-0xb5,-0x74,-0x61)],_0x1561a0);const _0x57caa5=_0x31e41a['HDVqE'](_0x4ca672,''),_0x109fca=[];_0x4ca672&&_0x109fca[_0x30436e(0x399,0x2e9,0x328,0x38e)](_0x4ca672);_0x50cc15&&_0x109fca[_0x30436e(0x41a,0x2e3,0x3ed,0x38e)](_0x50cc15);_0x431f3e&&_0x109fca[_0x497e1b(0x69,0x93,-0x1c,-0x20)](_0x431f3e);const _0x92601b=_0x109fca[_0x497e1b(0x13b,0x8c,0xd7,0x3e)]('\x0a');console[_0x30436e(0x2fa,0x2f9,0x346,0x376)](_0x31e41a[_0x30436e(0x422,0x442,0x3af,0x44e)],_0x92601b);let _0x4ad3ca=buildPromptForRequestType(_0x31e41a['ZFrjM'],_0x57caa5);const _0x2e6446=_0x31e41a[_0x30436e(0x4aa,0x504,0x527,0x487)](generateCharacterListText,_0x92601b),_0x150da4=generateOutfitEnableListText(),_0x3eb44d=generateCommonCharacterListText();console[_0x30436e(0x343,0x2fb,0x32d,0x376)](_0x30436e(0x33d,0x2d1,0x3e6,0x373)+'PromptModi'+'fy]\x20Charac'+'ter\x20list\x20t'+_0x30436e(0x41f,0x470,0x4a8,0x44f)+'ered):',_0x2e6446);const _0x2ab742=_0x32551d[_0x30436e(0x46e,0x3eb,0x390,0x3db)+'ta']?.['variables']||{},_0x1e2c26=_0x31e41a['FGtFb'](buildCharacterText,_0x4f7fe4);_0x4ad3ca=_0x31e41a[_0x30436e(0x46a,0x461,0x429,0x487)](mergeAdjacentMessages,_0x4ad3ca),console[_0x497e1b(-0xb7,-0xb4,-0x34,0x8)](_0x31e41a[_0x497e1b(-0x71,-0x9e,-0x68,-0x8c)],_0x4ad3ca);const _0x2312dc=findMessageIndexWithPlaceholder(_0x4ad3ca,_0x31e41a['DPHbJ']);console['log'](_0x31e41a[_0x30436e(0x35e,0x36e,0x48a,0x3e4)],_0x2312dc);const _0x304b08={..._0x1561a0,..._0x2ab742},_0x301889={'context':_0x50cc15,'worldBookContent':_0x431f3e,'variables':_0x304b08,'userDemand':_0x31e41a[_0x30436e(0x3d5,0x422,0x45b,0x3bf)](_0x4ca672,''),'characterListText':_0x2e6446,'outfitEnableListText':_0x150da4,'commonCharacterListText':_0x3eb44d},{messages:_0x3aeb37,replacedVariables:_0x4912b8}=_0x31e41a[_0x497e1b(0x8e,-0x56,0x20,0xf)](replaceAllPlaceholders,_0x4ad3ca,_0x301889);_0x4ad3ca=_0x3aeb37,_0x4ad3ca=_0x31e41a[_0x497e1b(0x81,0xc0,0x41,-0x2c)](_0x21db4b,_0x4ad3ca,'{{当前角色}}',_0x1e2c26,_0x4912b8),console[_0x497e1b(0x3f,-0xe5,-0x34,-0x9)](_0x31e41a[_0x497e1b(0x70,0x64,0x37,-0x70)],_0x4ad3ca);let _0x511999='';_0x4912b8[_0x497e1b(0xa4,0x7c,0xbc,0x66)]>0x4*0x53+-0x2a9*0xd+-0x1*-0x2149&&(_0x511999=_0x497e1b(0x9a,0xc6,0xa2,0xed)+_0x497e1b(0x76,0x3e,-0x7,0x91)+[..._0x4912b8][_0x30436e(0x45b,0x4e1,0x4bc,0x481)]('、')+'\x0a');_0x5343b8&&_0x31e41a['DwMnD'](_0x5343b8[_0x30436e(0x437,0x33a,0x43a,0x3ae)],0xdda+0x14d1+-0x22ab)&&_0x2312dc>=0xa93*0x3+0x1*0xba5+-0x2b5e&&(_0x4ad3ca=_0x31e41a[_0x497e1b(0x49,0x8f,0x41,-0x3a)](attachImagesToMessage,_0x4ad3ca,_0x2312dc,_0x5343b8,_0x497e1b(0x120,0x4,0xb7,0xe5)),console[_0x30436e(0x370,0x347,0x35a,0x376)](_0x31e41a[_0x497e1b(-0xb7,-0xaa,-0x12,-0x87)],_0x5343b8[_0x497e1b(-0x36,0xb4,0x4,-0x22)],'images\x20to\x20'+_0x30436e(0x3e0,0x4fd,0x524,0x48b)+_0x497e1b(-0x18,0x2c,-0x76,0x15),_0x2312dc));_0x31e41a[_0x497e1b(-0x67,-0x59,0x20,0x57)](updateCombinedPrompt,_0x4ad3ca,_0x511999);const _0x19c864={};_0x19c864[_0x30436e(0x4a1,0x492,0x48d,0x478)]=0x493e0;const _0x1f1e1a=await LLM_CHAR_MODIFY(_0x4ad3ca,_0x19c864);console[_0x30436e(0x369,0x40c,0x40b,0x376)](_0x31e41a[_0x497e1b(0x133,0xb6,0x94,0xb7)],_0x1f1e1a);if(!_0x1f1e1a){if(_0x31e41a[_0x497e1b(0x129,0xf,0xb8,0x93)](_0x31e41a[_0x30436e(0x3d4,0x45c,0x40c,0x3e3)],_0x31e41a[_0x497e1b(0x3f,-0x3e,0x39,0x6f)]))_0x138a00[_0x497e1b(-0x63,0x5f,0xe,0x54)](_0x52571d);else{toastr[_0x497e1b(-0x2d,-0xa,0x77,0x104)](_0x31e41a[_0x497e1b(0x47,-0x54,0x3c,-0x40)]);return;}}const _0x286847=extractCharacterTags(_0x1f1e1a);if(_0x31e41a['KBdku'](_0x286847['characters'][_0x30436e(0x315,0x39e,0x457,0x3ae)],0x11*0xb9+0x1dd+-0xe26)){toastr[_0x497e1b(0x9a,0x96,0xb0,0xcf)](_0x497e1b(-0x45,0x5d,-0x29,-0x45)+'检测到角色标签'),console[_0x30436e(0x419,0x405,0x2ce,0x376)](_0x31e41a[_0x497e1b(0x1c,0x5a,0xbe,0xb4)]),console[_0x497e1b(-0x37,0x44,-0x34,-0x7)](_0x31e41a[_0x497e1b(0x47,0x129,0xcf,0x121)],_0x1f1e1a);return;}console[_0x497e1b(-0xb3,0xa,-0x34,0x20)](_0x30436e(0x304,0x2d4,0x368,0x373)+_0x497e1b(0x14,-0xc8,-0x52,-0x72)+_0x497e1b(0x177,0x166,0xe2,0x65)+'ted\x20data:',_0x286847);const _0x3759f6=_0x286847[_0x30436e(0x48b,0x491,0x3f0,0x438)][-0x1809+-0x94f+0x2158];await updateCharacterPresetFromLLM(_0x4f7fe4['id'],_0x3759f6),toastr[_0x30436e(0x37f,0x3b5,0x3b4,0x3f7)](_0x31e41a[_0x497e1b(-0x9,0x111,0x5f,0x25)]);}}catch(_0x438c8e){console[_0x497e1b(0x12b,0x11,0x77,0xba)](_0x497e1b(-0x2,0x5a,-0x37,-0x55)+_0x30436e(0x3cc,0x2b6,0x2d8,0x358)+_0x30436e(0x446,0x3ae,0x35d,0x39a),_0x438c8e),toastr[_0x30436e(0x435,0x48f,0x483,0x421)](_0x497e1b(0x103,0x36,0xc9,0x114)+'\x20'+_0x438c8e['message']);}}async function updateCharacterPresetFromLLM(_0x27c337,_0x5a9b3c){function _0x3a79a2(_0x4b3dcc,_0x258bb2,_0x5f57dc,_0x2084f9){return _0x50d534(_0x4b3dcc-0x15c,_0x258bb2-0xbb,_0x2084f9,_0x258bb2-0x9d);}const _0x5e1d05={'kdYHM':function(_0x903ac7,_0x487b96){return _0x903ac7===_0x487b96;},'SiYVr':_0x250c2a(0x170,0x1c4,0x243,0x176),'tsmJe':_0x250c2a(0x185,0x1bc,0x1ed,0x1e0)+'+$','uezGz':function(_0x17c906,_0x6c51){return _0x17c906!==_0x6c51;},'YFgye':function(_0x2b4b69,_0x59243c){return _0x2b4b69(_0x59243c);},'ZYWBI':_0x250c2a(0x165,0x1bd,0x1b6,0x1b5),'JZjJm':_0x250c2a(0x230,0x1f1,0x298,0x229),'IfpCK':_0x3a79a2(0x16d,0x12c,0xae,0x119),'JyVlh':'五官外貌','fmwCz':'五官外貌背面','BzgIu':'上半身SFW背面','AHtNl':_0x250c2a(0x21a,0x257,0x21e,0x2e8),'srgxz':_0x3a79a2(0xfb,0x109,0x71,0x122),'tvxss':_0x250c2a(0x116,0x17e,0x1fa,0xc7),'wPukE':_0x250c2a(0x29b,0x208,0x26a,0x272),'qlKNU':_0x250c2a(0x371,0x2cb,0x284,0x355),'HcKSt':_0x250c2a(0x174,0x1da,0x265,0x1a7),'tdNHD':function(_0x12dfbc,_0x30b125){return _0x12dfbc!==_0x30b125;},'cmxUG':_0x250c2a(0x2ec,0x2a1,0x299,0x2c9),'nmnsf':'pMtyp','SnzLE':'(空)','CvcrS':_0x3a79a2(0xff,0x150,0xe2,0x1dd),'nidTb':function(_0x13afb6,_0x511251){return _0x13afb6>_0x511251;},'PLGlh':function(_0x4bdb5d,_0x39cf6e){return _0x4bdb5d===_0x39cf6e;},'Ydpre':_0x3a79a2(0xac,0x15d,0x155,0x19a),'PzPcg':_0x3a79a2(0x8c,0x12b,0x1d7,0x1b3),'WVWXN':_0x3a79a2(0x103,0xfd,0xf5,0x50)+_0x3a79a2(0x285,0x21f,0x1f4,0x1b9)+_0x3a79a2(0x152,0x14a,0xb6,0x176)},_0x988071=extension_settings[extensionName],_0x14dd9d=_0x988071['characterP'+_0x3a79a2(0x2c3,0x221,0x294,0x1fa)][_0x27c337];if(!_0x14dd9d){if(_0x5e1d05[_0x250c2a(0x23d,0x1aa,0x191,0x261)](_0x5e1d05[_0x3a79a2(0x120,0x1af,0x12b,0x1be)],_0x5e1d05['ZYWBI'])){toastr[_0x3a79a2(0x1e4,0x1d4,0x24d,0x20e)](_0x3a79a2(0x27b,0x1df,0x25d,0x194));return;}else for(const _0x6a7f03 of _0x417fe8[_0x3a79a2(0x205,0x1d3,0x11d,0x143)]){if(_0x5e1d05[_0x3a79a2(0x165,0x11c,0x1ad,0x7f)](_0x6a7f03[_0x250c2a(0x2a5,0x230,0x240,0x1d0)],_0x5e1d05['SiYVr'])&&_0x6a7f03['text']['includes'](_0x452c61))return _0xe03551;}}let _0x29654b=_0x250c2a(0x209,0x1c0,0x18c,0x246)+_0x27c337+_0x250c2a(0x1cd,0x18f,0x1a5,0x199);const _0x4a129a={};_0x4a129a[_0x3a79a2(0x1ae,0x1bf,0x239,0x1ad)]=_0x5e1d05[_0x3a79a2(0x22c,0x1a5,0x224,0x105)],_0x4a129a[_0x3a79a2(0x199,0x223,0x25e,0x1b2)]=_0x5e1d05['IfpCK'],_0x4a129a[_0x3a79a2(0x1c7,0x13d,0x15e,0x1d2)+_0x3a79a2(0x128,0x13b,0x1b7,0x17a)]=_0x5e1d05['JyVlh'],_0x4a129a[_0x3a79a2(0x1ee,0x13d,0x17c,0x155)+'uresBack']=_0x5e1d05[_0x3a79a2(0xf4,0x10f,0x118,0x1a9)],_0x4a129a[_0x250c2a(0x320,0x294,0x32c,0x260)+'FW']='上半身SFW',_0x4a129a[_0x250c2a(0x1f2,0x294,0x23e,0x21d)+_0x250c2a(0x1d6,0x1b5,0x255,0x13f)]=_0x5e1d05[_0x3a79a2(0x267,0x204,0x269,0x1e5)],_0x4a129a[_0x250c2a(0x13a,0x1f0,0x193,0x26f)+'W']=_0x5e1d05[_0x3a79a2(0x191,0x1a0,0x14d,0x10b)],_0x4a129a[_0x3a79a2(0x177,0x162,0x162,0x1c8)+'WBack']='下半身SFW背面',_0x4a129a[_0x250c2a(0x2ea,0x298,0x231,0x259)+_0x3a79a2(0x121,0x12d,0x12a,0x182)]=_0x5e1d05[_0x3a79a2(0x114,0xec,0x19e,0x3e)],_0x4a129a[_0x3a79a2(0x15e,0x20a,0x1b9,0x189)+'SFWBack']=_0x5e1d05[_0x3a79a2(0x14e,0x191,0x215,0x18a)],_0x4a129a[_0x250c2a(0x1c5,0x203,0x187,0x1ea)+'FW']=_0x5e1d05[_0x250c2a(0x2d0,0x280,0x203,0x263)],_0x4a129a[_0x3a79a2(0x1d3,0x175,0x1d0,0x181)+'FWBack']=_0x5e1d05['qlKNU'];const _0x3fdee9=_0x4a129a;let _0x2a791e=-0x9b8+-0x1f8f+0x2947;for(const _0x47b5d3 in _0x3fdee9){if(_0x5e1d05[_0x250c2a(0x164,0x174,0x123,0x216)]===_0x5e1d05['HcKSt']){if(_0x5a9b3c[_0x47b5d3]&&_0x5e1d05[_0x250c2a(0x1d6,0x23f,0x24f,0x204)](_0x5a9b3c[_0x47b5d3],_0x14dd9d[_0x47b5d3])){if(_0x5e1d05[_0x250c2a(0x23c,0x23f,0x2b9,0x248)](_0x5e1d05[_0x250c2a(0x1f7,0x1bf,0x1de,0x152)],_0x5e1d05[_0x250c2a(0x27a,0x27d,0x2bd,0x2e1)])){const _0x4e31b0=_0x14dd9d[_0x47b5d3]||_0x5e1d05[_0x250c2a(0x203,0x184,0x1c4,0x113)],_0x11f0ed=_0x5a9b3c[_0x47b5d3];_0x29654b+='•\x20'+_0x3fdee9[_0x47b5d3]+':\x0a',_0x29654b+='\x20\x20旧:\x20'+_0x4e31b0[_0x3a79a2(0x13c,0x1e1,0x295,0x255)](-0x13e0+-0x1b83+0x2f63,0xf9b+0x1501*-0x1+-0x598*-0x1)+(_0x4e31b0['length']>0x1*-0x1c8f+0x1883+0x43e?_0x5e1d05['CvcrS']:'')+'\x0a',_0x29654b+=_0x250c2a(0x2ea,0x255,0x1dc,0x1ae)+_0x11f0ed[_0x3a79a2(0x13e,0x1e1,0x25e,0x226)](0xb14*-0x3+-0x257*-0xc+0x14*0x42,-0x139*0x5+0x11c*-0x12+0x1a47)+(_0x5e1d05['nidTb'](_0x11f0ed[_0x250c2a(0x259,0x1ef,0x295,0x1ce)],0x9d7*-0x1+0x13c*0x1b+-0x174b)?_0x5e1d05['CvcrS']:'')+'\x0a\x0a',_0x2a791e++;}else return _0x581b8c[_0x3a79a2(0x1ab,0x20e,0x1d8,0x18c)]()[_0x3a79a2(0x17a,0x15e,0xcd,0x111)](gpxnjd[_0x3a79a2(0x150,0x1e5,0x267,0x141)])[_0x250c2a(0x24e,0x29c,0x310,0x235)]()[_0x250c2a(0x279,0x272,0x247,0x245)+'r'](_0x334066)['search'](gpxnjd['tsmJe']);}}else{_0x2c9548['error']('找不到指定的角色预设');return;}}if(_0x5e1d05['PLGlh'](_0x2a791e,-0xd4e*-0x1+-0x2084+0x1336)){toastr[_0x250c2a(0x251,0x286,0x267,0x208)](_0x3a79a2(0x15c,0x212,0x25b,0x298)+'内容');return;}_0x29654b+='共\x20'+_0x2a791e+'\x20项更改,是否应用?';const _0x12c24c=await _0x5e1d05[_0x250c2a(0x2a4,0x21e,0x2d0,0x18f)](stylishConfirm,_0x29654b);if(!_0x12c24c){if(_0x5e1d05[_0x3a79a2(0x14c,0x11c,0x76,0x6d)](_0x5e1d05['Ydpre'],_0x5e1d05[_0x250c2a(0x22b,0x264,0x1d9,0x217)])){toastr[_0x3a79a2(0x158,0x1f8,0x15a,0x168)](_0x5e1d05[_0x3a79a2(0x169,0x14f,0xcf,0x17f)]);return;}else{const _0xa44105={};_0xa44105[_0x3a79a2(0x197,0x1eb,0x21c,0x206)]=[];const _0x1329fa=_0xa44105;_0x16f3cd=_0x4f52e4[_0x250c2a(0xee,0x164,0x1b7,0x1d0)](/<thinking>[\s\S]*?<\/thinking>/gi,'')[_0x250c2a(0x345,0x297,0x2d7,0x293)]();const _0x51b604=/<人物>([\s\S]*?)<\/人物>/g;let _0x19c845;while(_0x5e1d05['uezGz'](_0x19c845=_0x51b604['exec'](_0x159908),null)){const _0x1a2b5d=_0x4eb9cd(_0x19c845[-0x25ae+-0x484+0x2a33]),_0x51b54d=_0x5e1d05[_0x250c2a(0x2c2,0x21e,0x1ad,0x2cb)](_0x5aa605,_0x1a2b5d);_0x51b54d&&_0x1329fa[_0x3a79a2(0x184,0x1eb,0x262,0x17a)][_0x250c2a(0x13e,0x1cf,0x1f1,0x24d)](_0x51b54d);}return _0x1329fa;}}function _0x250c2a(_0x394237,_0x23c7de,_0x3fb160,_0x3fa671){return _0x50d534(_0x394237-0x2b,_0x23c7de-0x1f3,_0x3fa671,_0x23c7de-0x12b);}for(const _0x214a9b in _0x3fdee9){_0x5a9b3c[_0x214a9b]&&(_0x14dd9d[_0x214a9b]=_0x5a9b3c[_0x214a9b]);}saveSettingsDebounced();const _0x2f5a4a=_0x5e1d05[_0x3a79a2(0x23b,0x190,0x12f,0x1c2)]($,_0x5e1d05[_0x3a79a2(0x1a9,0x1e9,0x1b8,0x263)]);_0x2f5a4a['length']&&refreshCharacterSettings(_0x2f5a4a),_0x5e1d05['YFgye'](updateFormFields,_0x5a9b3c),console['log']('[character'+'PromptModi'+_0x250c2a(0xf1,0x18e,0x1e3,0x13e)+_0x3a79a2(0xe7,0x143,0xad,0x115)+_0x27c337+'\x22');}function updateFormFields(_0x566d3e){const _0x1103dc={'QzLAG':function(_0x176588,_0x1037e0){return _0x176588(_0x1037e0);},'ygykq':_0xb5c489(0x4e6,0x505,0x41e,0x48f),'YodNW':function(_0x2052a9,_0x189975){return _0x2052a9===_0x189975;},'ZucJF':'bNLKv','ZCIvQ':'input','UtZaD':_0x2cf995(0x481,0x49c,0x541,0x4d0),'FqyGX':_0xb5c489(0x49d,0x3f1,0x3d5,0x43a)+'ures','DPRVZ':_0xb5c489(0x387,0x394,0x42b,0x43a)+'uresBack','gAMXM':_0xb5c489(0x469,0x561,0x528,0x503)+_0xb5c489(0x3b8,0x3f1,0x384,0x424),'fZBfh':_0x2cf995(0x45c,0x44f,0x3f4,0x473)+_0x2cf995(0x417,0x375,0x36e,0x423),'LFrqn':_0xb5c489(0x569,0x4a7,0x4aa,0x507)+_0x2cf995(0x3e0,0x3c8,0x423,0x43e),'JqpbU':_0xb5c489(0x56e,0x57b,0x47a,0x507)+'SFWBack','mCPgJ':_0x2cf995(0x498,0x3e0,0x3d2,0x486)+'FW','nKqmS':_0x2cf995(0x523,0x3e7,0x471,0x486)+_0x2cf995(0x3af,0x40e,0x3d7,0x438)};function _0xb5c489(_0xc430c7,_0x2bb7e9,_0x3cbf48,_0x8c967d){return _0x50d534(_0xc430c7-0x115,_0x2bb7e9-0x94,_0x2bb7e9,_0x8c967d-0x39a);}function _0x2cf995(_0x2f6953,_0x524d0c,_0x39aeea,_0x25bad0){return _0x50d534(_0x2f6953-0x165,_0x524d0c-0x1b2,_0x2f6953,_0x25bad0-0x3ae);}const _0x51fd81=[_0x1103dc['UtZaD'],_0xb5c489(0x57a,0x52a,0x53d,0x520),_0x1103dc[_0x2cf995(0x362,0x3a5,0x3d8,0x3fe)],_0x1103dc['DPRVZ'],_0x2cf995(0x514,0x4ab,0x563,0x517)+'FW',_0x1103dc[_0xb5c489(0x46e,0x3c0,0x4df,0x454)],_0x2cf995(0x4f0,0x526,0x44f,0x473)+'W',_0x1103dc[_0x2cf995(0x4c2,0x49f,0x4af,0x548)],_0x1103dc[_0xb5c489(0x56c,0x466,0x4b3,0x4f4)],_0x1103dc[_0xb5c489(0x543,0x468,0x4e6,0x4b4)],_0x1103dc[_0xb5c489(0x5a4,0x520,0x4e4,0x515)],_0x1103dc[_0xb5c489(0x41a,0x385,0x3cb,0x418)]];_0x51fd81[_0x2cf995(0x5aa,0x523,0x4d2,0x514)](_0x43ad94=>{function _0x45117f(_0x5a6c35,_0x4363ea,_0x108683,_0x32ec55){return _0xb5c489(_0x5a6c35-0x9c,_0x5a6c35,_0x108683-0x55,_0x108683- -0x525);}function _0x42d6f1(_0x13ac55,_0x5775bd,_0x5c9c7a,_0x2c22e2){return _0xb5c489(_0x13ac55-0x13b,_0x2c22e2,_0x5c9c7a-0x46,_0x13ac55- -0x186);}if(_0x1103dc[_0x45117f(-0x14,-0x114,-0xbb,-0xa)]===_0x1103dc[_0x42d6f1(0x2e4,0x29c,0x330,0x2e4)]){if(_0x566d3e[_0x43ad94]){const _0x526023=document[_0x42d6f1(0x2eb,0x362,0x2dd,0x251)+_0x45117f(-0x16e,-0x159,-0x112,-0x1b7)]('char_'+_0x43ad94);_0x526023&&(_0x1103dc[_0x42d6f1(0x3a9,0x391,0x2fb,0x3b2)](_0x1103dc['ZucJF'],_0x45117f(0x63,-0x52,-0x3c,-0x57))?(_0x526023[_0x45117f(-0x2d,-0xb3,-0x67,-0x105)]=_0x566d3e[_0x43ad94],_0x1103dc[_0x45117f(-0x26,-0x78,-0x7a,-0x90)]($,_0x526023)[_0x42d6f1(0x2bf,0x29b,0x365,0x254)](_0x1103dc[_0x45117f(-0x7e,-0x105,-0x121,-0x114)])):(_0x12ecdf['removeList'+_0x42d6f1(0x2fe,0x28a,0x385,0x2c6)](_0x10e566['LLM_CHAR_M'+'ODIFY_RESP'+_0x45117f(-0x22,0x30,-0x4a,-0xa3)],_0x3897a9),_0x4975cf&&(_0xff7674(_0x35e028),_0x4fea3a=null)));}}else _0x1103dc[_0x45117f(-0x100,-0xb7,-0x7a,-0x80)](_0x3e1190,_0x11384a),_0x211cb7=null;});}