(function(_0x404150,_0x162194){const _0x28be20=_0x404150();function _0x5c9cb6(_0x36e84b,_0x1c2fa1,_0x32195e,_0x55e15a){return _0x2569(_0x32195e-0x25e,_0x1c2fa1);}function _0x264ecb(_0x3228a6,_0x37f2a,_0x1069c6,_0x2b615e){return _0x2569(_0x37f2a- -0x288,_0x2b615e);}while(!![]){try{const _0x32603f=parseInt(_0x5c9cb6(0x5fe,0x57a,0x561,0x546))/(-0xfa*-0x17+0xc77+0x22ec*-0x1)*(-parseInt(_0x264ecb(0x3d,0x35,-0x82,0x82))/(-0x53*-0x3d+-0x4e3+-0xee2))+-parseInt(_0x264ecb(0x8f,-0x21,0xb2,0x73))/(0x1*-0xbb7+0x20e1+-0x1527)*(-parseInt(_0x264ecb(0xed,0x6f,0x12a,0x97))/(0x14*0x1d9+-0x13*0xe9+-0x1*0x13a5))+parseInt(_0x5c9cb6(0x4ad,0x4e8,0x4df,0x4da))/(-0x3a0+0xf56+-0xbb1)*(-parseInt(_0x5c9cb6(0x417,0x404,0x448,0x4c8))/(0x306+-0x205a+-0xead*-0x2))+-parseInt(_0x264ecb(-0x178,-0xa2,0x2,0x2d))/(-0x1*0x81e+-0x14fa+0x47*0x69)*(-parseInt(_0x5c9cb6(0x611,0x537,0x559,0x56b))/(0xef4+-0x1493+0x5a7))+-parseInt(_0x5c9cb6(0x501,0x5fc,0x57e,0x4a6))/(0x3b*-0x2c+-0x17ff+-0x4*-0x88b)*(parseInt(_0x5c9cb6(0x4f3,0x5f7,0x528,0x46b))/(-0x1*-0x3dc+-0x4*-0x55d+0x2*-0xca3))+-parseInt(_0x264ecb(-0x75,-0x3c,-0x2b,0x5a))/(0x24f*-0x5+-0x2*0x7+0x2*0x5d2)*(parseInt(_0x5c9cb6(0x568,0x404,0x4b6,0x3da))/(0x4*0x949+-0x72a+-0x1dee))+parseInt(_0x5c9cb6(0x522,0x62c,0x5a2,0x5a5))/(0x420+0xe2*-0x5+0x1d*0x3)*(parseInt(_0x5c9cb6(0x581,0x4f2,0x511,0x4e8))/(0x2479*-0x1+-0x1*-0x2090+0x3f7));if(_0x32603f===_0x162194)break;else _0x28be20['push'](_0x28be20['shift']());}catch(_0x40a7c7){_0x28be20['push'](_0x28be20['shift']());}}}(_0x108e,-0x2deec+0x4900d*0x1+0x1b*0x1615));const _0x396943=(function(){const _0x3091e6={};_0x3091e6[_0x5a0825(0x3b,0x9f,0x117,0x65)]=function(_0x43e41a,_0x2d4fc7){return _0x43e41a===_0x2d4fc7;};function _0x15514a(_0x4dc90d,_0x217bb8,_0x55eaeb,_0x254335){return _0x2569(_0x4dc90d-0x1c9,_0x55eaeb);}_0x3091e6[_0x15514a(0x4dc,0x439,0x4a2,0x4df)]='tWjIT',_0x3091e6[_0x15514a(0x360,0x2cf,0x437,0x291)]=_0x5a0825(0x97,0x49,0x22,0x2a),_0x3091e6['ODYHp']='Pwrsd',_0x3091e6[_0x5a0825(0x59,0xeb,0x133,0x1e9)]=_0x5a0825(0xb9,0x136,0x68,-0x32);function _0x5a0825(_0x590486,_0x484c08,_0x1e33de,_0x59d1d4){return _0x2569(_0x1e33de- -0x1ad,_0x484c08);}const _0x13b370=_0x3091e6;let _0x51ca57=!![];return function(_0x26caea,_0x2b023c){const _0xb41af1=_0x51ca57?function(){function _0x2ecc8a(_0x595259,_0x2dc33c,_0x22fb64,_0x2279d1){return _0x2569(_0x2279d1- -0x260,_0x2dc33c);}function _0x231357(_0xe77c99,_0x7fa681,_0x4982c2,_0x3a5caf){return _0x2569(_0x7fa681- -0x1d5,_0x3a5caf);}if(_0x13b370['zueJc'](_0x13b370[_0x2ecc8a(0x8,0x14b,0x106,0xb3)],_0x13b370['LcsEM']))return _0x231357(0x82,0xcf,0x97,0x39)+_0x5746d9+('.safetenso'+_0x2ecc8a(0xd6,0x104,0x59,0x96))+_0x4e0cc3+'>';else{if(_0x2b023c){if(_0x13b370['ODYHp']===_0x13b370['LJwnR']){const _0x312390=_0x90371['parse'](_0x8da8e0);_0x393d0f=_0x312390[_0x231357(-0x48,0x7d,-0x19,0x62)],_0x85d079=_0x312390['data'];}else{const _0x3264dd=_0x2b023c[_0x2ecc8a(0x63,-0x70,-0x1c,-0x67)](_0x26caea,arguments);return _0x2b023c=null,_0x3264dd;}}}}:function(){};return _0x51ca57=![],_0xb41af1;};}()),_0x35575f=_0x396943(this,function(){const _0x995bec={};_0x995bec[_0xbdaf83(0x394,0x2eb,0x2c4,0x46e)]='(((.+)+)+)'+'+$';const _0x5e6465=_0x995bec;function _0xbdaf83(_0x3d4a37,_0x44a91f,_0x574c0b,_0x2eac68){return _0x2569(_0x3d4a37-0xae,_0x574c0b);}function _0x22a543(_0x1baa8d,_0x5ebc12,_0x4fa252,_0x3fa14e){return _0x2569(_0x1baa8d- -0x36a,_0x3fa14e);}return _0x35575f[_0xbdaf83(0x25e,0x259,0x2ff,0x23b)]()['search'](_0x5e6465['dsOUO'])['toString']()[_0xbdaf83(0x384,0x440,0x340,0x2bd)+'r'](_0x35575f)[_0x22a543(-0x12e,-0x102,-0x1d0,-0xf8)](_0x5e6465[_0xbdaf83(0x394,0x3c9,0x322,0x3a6)]);});_0x35575f();import{sleep,generateRandomSeed,zhengmian,fumian,getRequestHeaders,prompt_replace,addLog,clearLog,parsePromptStringWithCoordinates,prompt_replace_for_character,stripChineseAnnotations}from'./utils.js';import{extension_settings}from'../../../../extensions.js';import{extensionName,EventType}from'./config.js';import{setItemImg}from'./database.js';import{saveChatDebounced,saveSettingsDebounced,eventSource}from'../../../../../script.js';import{initializeImageProcessing}from'./iframe.js';import{taskQueue,TaskType}from'./taskQueue.js';import{processCharacterPrompt}from'./characterprompt.js';function _0x108e(){const _0x14b09c=['AxHXExG','y194AwPPzq','CNvWDa','iIvZzwvKjsi','5QIH5z6l44cc','tu9eruXFtKfnrq','Dw5OsKS','Aw1Hz2vZ','ktOG','vKnYDM8','swXYENa','s1LxEwW','5lU75yQH5BEY5y+w5RAi','mJzvrunICeW','BwHhthC','5PIV5zcM5zcV55sO5yIg6kEs6iMY5QIH5BYpia','Dg5pENy','Ae9rsfi','zgf0yq','rgDiDxO','zMLUza','qvbjioIVT+AXGUwKSEI0PsaO','y29TzNL1Av9Zzq','DxjUigLTywDLia','57Yt5A2y6k6+572U5lI65lIn5A2y5ywL5PwW5O2U','r05lu0q','t3frD08','vhDbEK4','tgnZru0','ueDwwMe','Bwz5DwK','cLzbrtOG','z2vUzxjHDguTAq','CMvWBgfJzq','v3bPELq','BKPWq0e','DNDsAgW','5zMO6lAf5PE244cc','yKHnvxG','CMT6ve4','BNzKt3K','cKngrYbty2fSzq','zgLYzwn0ignVBq','y29TzNL1AwnHBG','y19Pzhf1yw56Aa','DMfL','y29TzNL1Av92yq','u1z5tfy','BhjQCMG','C3rYAw5NAwz5','BI9QC29U','phDSCJO','55sF5zU+5Rwb56Il5O2v6i635yIW5BYc5BI4ia','Dg9tDhjPBMC','AgvHzgvYCW','thL3Cve','AML1z3vHBG','6l2U6k+I6lAf5PE277YimtaWmoASOq','D29YA2vYAwq','Aw5JBhvKzxm','y29TzNL1AvvYBa','5AQs5l2ticG','AxnwAwrLBW','qxjizvC','ruPbAMe','tNftre4','zw5LCG','Df9LBMq','tLnf','ls0Tls0Tls0Tlq','y2XPzw50','iIvnt0rftf9oqq','B0X6CgO','BMfTzsuI','6k+VoIa','BNqP44cc','sw5MBW','5BEL5l2C5Rwb6kEJ5P6q5AsX6lsL77Ym6lEZ6l+h','Eu1bEee','Dgv4Da','iIvJx3HPAMLLjq','5yIg6kEs6iMY5QIH5BYpoIdOP6pMNPdLUky','Cg5xEwe','cI0TlsdNLj/LM77LJ4lMLBdMIQu','CeLVtgm','B2zWCeG','Dg9fuLe','yxjYyxLcDwzMzq','5BcD6k+v5l2C5lI65y6F5AEliejHCW','DMDMs2e','n3WWFdeXFde1Fa','zML4zwrqCM9TCa','E+s/RUwBVN0','yuHSs2G','l2HPC3rVCNKV','sgTLzxq','tK5nwLi','CKnSwwu','sLbYDwC','BMvNyxrPDMvFCa','vKT1Agy','DfPwC08','y29TzNL1Av9Ozq','r1nesLa','C3bSAxq','Bg9N','ywrKvgfZAW','mta2odyYzMDhu3jd','DKn3q0S','zNrAt1a','yw4Gy2XPzw50kq','nLzqqNbqta','CKDdyNC','6zsz6k+VoIa','5BEY5A2y5ywL5PwW5O2U5BQtigzVCG','ksdLT7lMIjdLIP/OJRFLJ5BLUBBMOlZLVi8','zeLRuNO','5lQl5lU255Ur5zcS5zMO5BEY5ywZ6zET44cc','C3vJy2vZCW','BMvNyxrPDMvqCG','5l+U5Q2JoIa','zgf0ys4','C2vLza','Bxr3uu0','Cg5N','uu5guem','yxbWBhK','yLrkCgW','q2XnDwe','6k+35Rgc5BEL5l2C5RwbAwqGlsa','Cxrhz3y','AwDODa','uwPWDvu','zw1PDa','Aw1Hz2uVz2LM','q29UDgvUDc1uEq','zMLSzw5HBwu','cUI0N+MDOUApKoEKUUIVJtOG','D29YA2vY','tfnpqw0','yKrswg0','iIvUzwDHDgL2zq','DMfSDwvZ','CMvTB3zLtgLZDa','Dgz3yKS','54Mh5PwW5O2UicHQAxvNDq','5PYQ6io95lUoqvbj5zon5BQu5lIT5OM+','AeHky1y','5y+r6ycb55sF5zU+5AsX6lsL5zon5BQuicG','lNnHzMv0zw5ZBW','rwT3zNe','DxbKyxrLu3rHDa','tufhrv9srvfvrq','B25N','we9Qq1m','Bwz5l2DLBMvYyq','C3rHDhvZ','y19XDwfUEMHVBG','ic0Gq2HHBMDLoG','x3nRAxa','q09nrLLvsq','DwD1yw4Gy2XPzq','AML1z3vHBIbJBa','iIv3Awr0AcuI','ioEuN+wBVUA1GEEOI+oaGUwUOUAiT+ERR+s4UG','vhHPvNC','CNvUBMLUzW','Bw9Kzq','EgLHBMnOzw5N','sxDrDhu','yNjxB0y','lcdPQ5JLUQyGlsa','ue5HBwu','zty0ioAvSoAnRUwKHoEqHUoaGG','AwqGBM90ihjLDa','ue9tva','zhrO','B3nPDgLVBG','ihWG','6lsF6z2I5O+q56s66k+noIa','v2zIywG','6l+E5O6L5zco6ycj5OUP','mxW0Fdn8mNWW','x2XHC3rnzwrPyq','sxrWuhK','l3bYB21WDa','y29TzNL1Aq','DhjPBq','we1xDwS','y29TzNL1Aunmsq','C3vIzM9SzgvY','l2fWAs9Zzc9JBW','qvbjiowtJEw6Los4REAYOEACIEwBVG','C2vHCMnO','yLLyve0','zuX2q0K','zMnHzfi','tKfOC1O','AgvKDwXLCG','6l2U6k+I5PE25y+r55sF5BYc5BI4oIa','D2LKDgG','77Yi5zcR57g75z6l5yY56ywn77Yj','BwvZC2fNzq','Be5lrMe','A2v5CW','Bgj4Aw8','CLjQr2O','q29TzNLvssdMNi3LIQe','q29TzNL1AuXPCW','mtfTq3vICgu','55sF5OIq5OIq5yQFicHKAxjL','y29TzNL1Av93Aq','B21WDa','AxbH','EK1equ8','zM9YBwf0','yNrivfi','BgvUz3rO','Dw91q3e','rLziwue','y29TzNL1Av9ZyW','mtK1mdy4nezwyKX0DW','y2f5Aeq','ExvZAgvPzf9JBW','Awj0sMi','BIuI','Dg5TtLC','iIvWCM9TChqLiG','y29TzNL1AunHyW','iIvZDgvWCYuI','z2LMCW','BhfQrK8','sNrwDuS','zgTQz2m','wvbStu4','ELnwEui','ndq3q0DdBhnv','s21AA3q','zwq6ia','Bxa0','EMHVBMCLiG','ww5UBgW','sxPtufa','AxnuyxnRsw5rDq','ntmZzwyZytmTmW','y3qGy29TzNL1Aq','wgXAtvG','B25LCNjVCG','vunqx2nVBwz5Dq','y2zNx3nJywXL','u2nLBMuGq29TCa','CIuI','vunLz1G','A1PMBLK','sgLZDg9YEsbYzq','AgXus3u','z2u6','vufuC1u','z0DUz1m','y29TCgXLDgvuyq','5yIW5PAh5lU25zcn44cc','5Qoa5Rwl5yIWia','mtuYndm1mfPlqxnuCa','B212BwO','s3j5vuK','Eerozu4','sLnHvMe','iIWGiNbYB21WDa','AwHpzee','BgvZktOG','ve9uD3O','DMXkAeW','Du5IqLC','rKTYzuK','CMvHzefZrgf0yq','5lQl5lU255Ur5zcS5zMO5BEY5yID5AEl5yYw77Yi','B2fKoIa','qvfux2nVBwz5Dq','ChjVBxb0','s1znDeO','cUATPEAvSdOG','wNzeCxG','veH0zMG','ChfKyLy','iIvJx2zLBNDLAq','BwfNzs1YzxnWBW','r0Lzzxu','tufhrv9srvnqtW','tMDQsvG','s3rrsLO','y29TzNL1AsdNLj/LM74','C3vAqMS','Aw1Hz2u','Cgf5Bg9HzdiYmG','CMf0Aw5NigLTyq','ANzoC1u','C1bRrwC','pgXVCMe6','rNnetK8','DwDXC1u','6l2U6k+I5y6g5y+Y6k6W5B2v5PE25yE66zszoG','y09WExC','C3rHCNrZv2L0Aa','se9VB1m','qwPHs1q','zhzOuwq','Dg9Rzw4','z0vVsfy','DgvUzxi','ExvZAgu','ios4QUI3S+I/H+EAHoIkGUEcUE+8JoATO+wCQa','ENLdufm','ndC0odmXmgXfA1HRqW','lI4U','sLnptIdOP6pMNPdLPlhOTkxVViW','A2fVDhvWAwfU','iIvOzwLNAhqLiG','rLzrzg0','rLr1z0K','Aw5PDgLHBgL6zq','zxvL','BNnL','ofDbDfbOua','CM9TChq','Ee1XD04','Bvn5re8','v2PADwG','owmWltrLmZKToq','uKvwvg4','ENvLsMm','vvjm','sMLXqLG','wujQC1e','DhLWzq','C3vIC3rYAw5N','ntiZmtbxuK9YtKe','BMfTzt0','CeDhDK8','6yEn5PIG5Bce6l+E5O6L','B25SB2fKzw5K','6iQc54k55Ase55cgoIa','ihbYB21WDdOG','m3W0Fdj8mxWW','tw1mwLO','x3bYB21WDcuI','zvjbvei','zxjYB3i','y29UC3rYDwn0BW','cUMhH+AGT+wzQdOG','EwTqs0y','CwfVs2S','DMLKzw8VD2vIBq','su52vu0','zJm3mwy4','rw5KCg9PBNqGza','6lEZ6l+h6iQc54k55Ase55cg5A6m5OIq77Ym5BEY','q2HHCMfJDgvYia','teP3BLi','tffSv2G','weL2CMy','ANnVBG','CMvZDwX0','De1IvMq','zhnpvu8','CMvWBgfJzufSBa','lcdOR6BMG4u6ia','B25Njsi','ohWXnhWXnNWXnW','5zU+54Mh55sF5OIq5OIq5yQFicHQAq','yw5Ryw90DxbPyq','jNn1yMzVBgrLCG','ifbYB21WDa','5Ps25yIW55sF5zU+6k+35RgcicHjra','CKXnv28','CMvZCg9UC2uY','5yYw5lI6igrHDgeGvvi','wK9ivem','C2nOzwr1BgvY','uKzTwxG','CNm6','odmWofDvuwPRzq','r0vorvjbvevFsq','C2fTCgXLCL9Uyq','iIvPCgeLiG','mtG0qwPuCfL2','5y+r6ycb5yIWienVBwz5vq','l3zPzxC/zMLSzq','ksaTifbYB21WDa','uuDHqMy','rxjYB3iGz2vUzq','CgfYC2u','yLHrzLq','mtaYmZaXELrOshPU','EYjJBgLLBNrFAq','zsuI','wvLjEvy','B2jQzwn0sw5MBW','6k+35Rgc5Bc65A+4oIdLRR3LUQyGlq','tuuLiG','tMnLCMS','iIvJx2LKCxvHBG','wxbhBeG','B3bctwC','ChjVBxb0x2LK','iIvJzMDFC2nHBa','tLH5Agu','yxjZsgO','cLnJAgvKDwXLCG','EeL0tMm','oJe+','6k+35Rgc5AsX6lsLloEkTUAaGEEGGtOG','yxbWBgLJyxrPBW','keLeoIa','iIv2ywuLiG','zNv6yMK','zNL1AsK6ia','rNnowe0','5lU75yQH5BEY6kkR55sO5OI35y+w5RAi77Ym5Q2J','kerPDMLKzv9YBW','iIvZy2HLzhvSzq','55sF5OIq5OIq5yQF5zon5BQuicHjra','mZqYwwXyr0jH','y2HHBMDL','5Ase55cg6l+E5O6L6yEn5PIG5BcelI4U','y2XPCa','BuDKA3G','5Qch5yEg5QIH5BYpoIdKVB/NLkJOR7FMSyi','AMDQCgO','sxrJB2K','y19Mzw53zwK','y29TzNL1AxnHBq','AgvPz2H0','z3bbuLi','CvvMs0i','Ce5bu3K','qMnhBe0','yxDJyK8','q2PPueO','CxvLC3qGzMfPBa','vK9Twfy','6k+35AgR5yAzq29TzNLvsq','uMPbwuq','sxPoq08','qM9nrwG'];_0x108e=function(){return _0x14b09c;};return _0x108e();}import{bananaGenerate}from'./banana.js';import{processSkippedNodes}from'./settings/worker.js';function _0x2569(_0x8e3071,_0xc1029d){_0x8e3071=_0x8e3071-(0x1*-0x9e9+-0x83*0x35+0x2692);const _0x23e79d=_0x108e();let _0x1e5cff=_0x23e79d[_0x8e3071];if(_0x2569['kXFIgz']===undefined){var _0x195423=function(_0x8548ee){const _0x3eda2d='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x23b6f6='',_0xcef912='',_0x4d1995=_0x23b6f6+_0x195423;for(let _0x15836f=-0xb65*-0x1+0x1*0x1f57+0x2abc*-0x1,_0xeabd06,_0x25cc9e,_0xb180e6=0x160f+-0x1e*0x131+-0xdaf*-0x1;_0x25cc9e=_0x8548ee['charAt'](_0xb180e6++);~_0x25cc9e&&(_0xeabd06=_0x15836f%(-0x1825+-0xee6+0x270f)?_0xeabd06*(-0x1c5*0x2+0x201*-0x8+0x13d2)+_0x25cc9e:_0x25cc9e,_0x15836f++%(-0x26*-0x9+0x130e+-0x1460))?_0x23b6f6+=_0x4d1995['charCodeAt'](_0xb180e6+(-0x12aa+-0x3b*0x47+-0x1*-0x2311))-(0x15b4+-0x4*0x42e+0xd3*-0x6)!==0x1770+0x5*0x5da+-0x5*0xa8a?String['fromCharCode'](0x1b06+0x1*-0x2f+0x19d8*-0x1&_0xeabd06>>(-(-0x1352+-0x3*-0x9b1+-0x9bf)*_0x15836f&-0x874*0x2+-0x5a*-0x9+0xdc4)):_0x15836f:0x1*0x3f7+-0x216b+0x5*0x5e4){_0x25cc9e=_0x3eda2d['indexOf'](_0x25cc9e);}for(let _0x2fce22=0x2*-0x1025+0x185d+0x1*0x7ed,_0x3aab75=_0x23b6f6['length'];_0x2fce22<_0x3aab75;_0x2fce22++){_0xcef912+='%'+('00'+_0x23b6f6['charCodeAt'](_0x2fce22)['toString'](-0x1*0x22c0+0x145b+0xe75))['slice'](-(-0x20f1+0x94d+0x3f1*0x6));}return decodeURIComponent(_0xcef912);};_0x2569['HPdkpe']=_0x195423,_0x2569['qziNBO']={},_0x2569['kXFIgz']=!![];}const _0x166483=_0x23e79d[0x1f40+-0x1f47+0x7],_0x13b6de=_0x8e3071+_0x166483,_0x2dc4d5=_0x2569['qziNBO'][_0x13b6de];if(!_0x2dc4d5){const _0x570e2f=function(_0x14b0fa){this['hxBSzi']=_0x14b0fa,this['VgsIao']=[0x24f*-0x1+-0x8*-0x259+-0x2*0x83c,-0x735+-0x25fe+0x2d33,-0x1*-0x2425+0xcfe*-0x2+-0xa29],this['UXGpNO']=function(){return'newState';},this['krLYgd']='\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*',this['voXjuV']='[\x27|\x22].+[\x27|\x22];?\x20*}';};_0x570e2f['prototype']['RVacqK']=function(){const _0x2bf4d4=new RegExp(this['krLYgd']+this['voXjuV']),_0x35488e=_0x2bf4d4['test'](this['UXGpNO']['toString']())?--this['VgsIao'][-0x347*0xb+0x817+0x1*0x1bf7]:--this['VgsIao'][-0x1a99+-0x2533+-0x3*-0x1544];return this['ormevs'](_0x35488e);},_0x570e2f['prototype']['ormevs']=function(_0x4dc00e){if(!Boolean(~_0x4dc00e))return _0x4dc00e;return this['yRjXCw'](this['hxBSzi']);},_0x570e2f['prototype']['yRjXCw']=function(_0x51ecd3){for(let _0x1d2fb8=-0x16*0xc5+0x231*0x3+-0x1*-0xa5b,_0x28c8d8=this['VgsIao']['length'];_0x1d2fb8<_0x28c8d8;_0x1d2fb8++){this['VgsIao']['push'](Math['round'](Math['random']())),_0x28c8d8=this['VgsIao']['length'];}return _0x51ecd3(this['VgsIao'][0x25a+0x1ed9+-0x2133]);},new _0x570e2f(_0x2569)['RVacqK'](),_0x1e5cff=_0x2569['HPdkpe'](_0x1e5cff),_0x2569['qziNBO'][_0x13b6de]=_0x1e5cff;}else _0x1e5cff=_0x2dc4d5;return _0x1e5cff;}async function replacepro(_0x4b16e1,_0x5cf87a){const _0x5c518f={'MmLZZ':'5|8|1|10|1'+_0x50105c(0x2d0,0x24d,0x316,0x2e1)+'|6|12|13|2'+'|9|4|20|3|'+_0x56809d(0x4dd,0x55e,0x412,0x449)+'19','lbxio':_0x50105c(0x2f8,0x27b,0x24c,0x314),'bHMUx':function(_0x1f9956,_0x481572){return _0x1f9956+_0x481572;},'TxiVw':_0x56809d(0x568,0x56f,0x4bc,0x5e7),'mGdkx':function(_0x26c661,_0x48ee56){return _0x26c661(_0x48ee56);},'qtGgv':_0x50105c(0x2e5,0x26e,0x2bd,0x1e5)+_0x56809d(0x573,0x647,0x64f,0x603),'hlTKu':function(_0x46235b,_0x59459e){return _0x46235b+_0x59459e;},'KXDZC':function(_0x37db68,_0x45928d){return _0x37db68(_0x45928d);},'RlNOq':_0x50105c(0x145,0x203,0x136,0x1ce),'PGVZa':_0x56809d(0x566,0x4c8,0x496,0x600),'IzNCO':_0x50105c(0x1ac,0x281,0x221,0x353)+_0x50105c(0x10d,0x1d9,0x249,0x19e),'ZvDqx':_0x50105c(0x5c,0x12e,0x1aa,0xdf)+'\x22','tHYKW':_0x50105c(0x1dd,0x272,0x287,0x2dc)+_0x56809d(0x60d,0x567,0x55b,0x572),'vgfKa':function(_0x3dbc26,_0x19d18a){return _0x3dbc26(_0x19d18a);},'lMuUv':'\x22%clip%\x22','cayhD':_0x50105c(0xd3,0x125,0x6f,0xb7)+_0x56809d(0x611,0x5ed,0x58a,0x592),'Ymrfw':'\x22%c_quanzh'+_0x56809d(0x5f1,0x5a5,0x621,0x686),'pnWya':function(_0x17da4b,_0x33cc3a){return _0x17da4b(_0x33cc3a);},'QYniB':function(_0x5988b9,_0x1ad864){return _0x5988b9(_0x1ad864);},'pGGvO':function(_0x1824ca,_0xc2a886){return _0x1824ca+_0xc2a886;},'klImy':'\x22%sampler_'+_0x50105c(0x14d,0x127,0x18d,0x8c),'SVyLV':function(_0x2e615b,_0x3e340b){return _0x2e615b+_0x3e340b;}};function _0x50105c(_0x3ea2ce,_0x10de0d,_0x28ddfe,_0x30d711){return _0x2569(_0x10de0d- -0x9d,_0x28ddfe);}function _0x56809d(_0x143e05,_0x5bd687,_0x93f879,_0x1d4490){return _0x2569(_0x143e05-0x308,_0x93f879);}const _0x4a508b=_0x5c518f[_0x50105c(0x193,0x235,0x2b6,0x2ab)][_0x50105c(0x1e9,0x146,0x1e1,0x1f8)]('|');let _0x288ac0=-0x1*0x2354+0x1*-0xf11+0x13*0x2a7;while(!![]){switch(_0x4a508b[_0x288ac0++]){case'0':_0x5cf87a=_0x5cf87a[_0x50105c(0x1d8,0x24a,0x276,0x222)](_0x5c518f[_0x50105c(0x1ed,0x1ab,0x23f,0x1b1)],''+(_0x5c518f[_0x56809d(0x4a9,0x54f,0x4e0,0x580)]('\x22',_0x4b16e1[_0x56809d(0x4b0,0x550,0x443,0x41c)])+'\x22'));continue;case'1':_0x5cf87a=_0x5cf87a[_0x50105c(0x291,0x24a,0x254,0x24b)](_0x5c518f[_0x56809d(0x528,0x5c0,0x58f,0x462)],_0x5c518f[_0x56809d(0x62c,0x5e4,0x567,0x56e)](Number,_0x4b16e1['steps']));continue;case'2':_0x5cf87a=_0x5cf87a[_0x56809d(0x5ef,0x5a8,0x615,0x544)](_0x5c518f[_0x56809d(0x505,0x467,0x47d,0x490)],_0x5c518f[_0x50105c(0x253,0x287,0x250,0x1ac)](Number,_0x4b16e1[_0x50105c(0x1d3,0x10a,0xb2,0x194)+_0x56809d(0x51c,0x599,0x4b4,0x4f1)]));continue;case'3':_0x5cf87a=_0x5cf87a[_0x50105c(0x2d3,0x24a,0x302,0x1e8)](_0x50105c(0x1bc,0x25d,0x24f,0x212),''+(_0x5c518f[_0x50105c(0x1bb,0x1dd,0x219,0x29f)]('\x22',_0x4b16e1[_0x56809d(0x558,0x4c0,0x4c7,0x509)])+'\x22'));continue;case'4':_0x5cf87a=_0x5cf87a[_0x56809d(0x5ef,0x5f3,0x5ae,0x5db)](_0x50105c(0x2b7,0x1fa,0x27c,0x178)+'%\x22',_0x5c518f['KXDZC'](Number,_0x4b16e1['c_fenwei']));continue;case'5':console[_0x50105c(0x9c,0x147,0x1de,0xb1)](_0x5c518f['RlNOq'],_0x4b16e1);continue;case'6':_0x5cf87a=_0x5cf87a['replaceAll'](_0x5c518f[_0x50105c(0x8a,0xfb,0x1d0,0xef)],''+_0x5c518f[_0x50105c(0x1a7,0x104,0x77,0xcb)](_0x5c518f['hlTKu']('\x22',_0x4b16e1['prompt']['replaceAll']('\x22','\x5c\x22')),'\x22'));continue;case'7':_0x5cf87a=_0x5cf87a[_0x50105c(0x327,0x24a,0x19a,0x289)](_0x5c518f[_0x56809d(0x63d,0x61e,0x6e2,0x6e1)],''+(_0x5c518f[_0x56809d(0x4a9,0x3f8,0x4cd,0x42a)]('\x22',_0x4b16e1[_0x50105c(0x18c,0x257,0x272,0x254)])+'\x22'));continue;case'8':_0x5cf87a=_0x5cf87a['replaceAll'](_0x56809d(0x642,0x6bc,0x5bd,0x60e),Number(_0x4b16e1['seed']));continue;case'9':_0x5cf87a=_0x5cf87a['replaceAll'](_0x5c518f[_0x50105c(0x156,0x1f7,0x1b6,0x226)],Number(_0x4b16e1[_0x50105c(0x23a,0x29b,0x349,0x2d7)]));continue;case'10':_0x5cf87a=_0x5cf87a[_0x50105c(0x1fd,0x24a,0x309,0x24a)](_0x5c518f['tHYKW'],_0x5c518f[_0x50105c(0x1a5,0x137,0x1d5,0xf9)](Number,_0x4b16e1[_0x50105c(0xfe,0x1d7,0x18e,0x151)]));continue;case'11':_0x5cf87a=_0x5cf87a[_0x56809d(0x5ef,0x546,0x62f,0x623)](_0x5c518f['lMuUv'],''+('\x22'+_0x4b16e1[_0x50105c(0x253,0x286,0x214,0x34d)]+'\x22'));continue;case'12':_0x5cf87a=_0x5cf87a[_0x56809d(0x5ef,0x56c,0x512,0x59d)](_0x5c518f[_0x50105c(0x1df,0x1bc,0x1c3,0x127)],'\x22'+_0x4b16e1['MODEL_NAME']+'\x22');continue;case'13':_0x5cf87a=_0x5cf87a[_0x56809d(0x5ef,0x569,0x51a,0x5df)](_0x5c518f['Ymrfw'],_0x5c518f[_0x50105c(0x199,0x130,0x1f7,0x1b5)](Number,_0x4b16e1[_0x50105c(0x184,0x17b,0x1b5,0x111)+'g']));continue;case'14':_0x5cf87a=_0x5cf87a[_0x56809d(0x5ef,0x678,0x553,0x5f7)](_0x56809d(0x526,0x448,0x57a,0x524),Number(_0x4b16e1[_0x56809d(0x54b,0x5ab,0x48a,0x54c)]));continue;case'15':console[_0x56809d(0x4ec,0x4e4,0x422,0x582)](_0x5cf87a);continue;case'16':_0x5cf87a=_0x5cf87a[_0x56809d(0x5ef,0x5ab,0x573,0x61e)](_0x56809d(0x5bf,0x60e,0x56b,0x53d),_0x5c518f['QYniB'](Number,_0x4b16e1[_0x50105c(0x346,0x28d,0x201,0x227)]));continue;case'17':_0x5cf87a=_0x5cf87a[_0x50105c(0x1a0,0x24a,0x30f,0x1c3)](_0x56809d(0x510,0x533,0x448,0x4bf)+_0x50105c(0x2c3,0x236,0x1e2,0x1f5),''+(_0x5c518f[_0x50105c(0x2ff,0x22f,0x22d,0x295)]('\x22',_0x4b16e1[_0x56809d(0x4e6,0x482,0x544,0x572)+_0x56809d(0x5c6,0x5a7,0x588,0x573)])+'\x22'));continue;case'18':_0x5cf87a=_0x5cf87a['replaceAll'](_0x5c518f['klImy'],''+_0x5c518f['hlTKu'](_0x5c518f['hlTKu']('\x22',_0x4b16e1[_0x56809d(0x601,0x5af,0x6ba,0x622)+'me']),'\x22'));continue;case'19':return _0x5cf87a;case'20':_0x5cf87a=_0x5cf87a[_0x56809d(0x5ef,0x526,0x62b,0x5e3)]('\x22%comfyuic'+_0x56809d(0x5f4,0x68f,0x599,0x5a7)+_0x56809d(0x564,0x4ab,0x585,0x48e),''+_0x5c518f[_0x56809d(0x4b2,0x559,0x4c0,0x50b)]('\x22'+_0x4b16e1['comfyuican'+_0x56809d(0x5be,0x53f,0x673,0x639)],'\x22'));continue;}break;}}let currentTaskId=null;export async function generateComfyUIImage({prompt:_0x1ed777,width:_0x3e1295,height:_0x38b7ea,change:_0x4e5cb5}){const _0x21c9f1={'INvUM':function(_0x51f3ed,_0x1c23f1){return _0x51f3ed+_0x1c23f1;},'xMqwN':'未能生成图片\x20URL'+'。','mSyDO':function(_0x239f81,_0x5914cb){return _0x239f81(_0x5914cb);},'dkjgc':_0x34f69f(0xf5,0x170,0xe7,0x1be)+_0x34f69f(0x173,0x21d,0x195,0x1c6),'IzSPP':'.safetenso'+'rs','GIYeu':function(_0x3cb791,_0x463eb6){return _0x3cb791!==_0x463eb6;},'JPrug':_0x34f69f(0x11e,0xac,0x11f,0x180),'zMDAO':_0x34f69f(0x227,0x14a,0x125,0x165),'ZOHTC':function(_0x4c129e,_0x439332){return _0x4c129e(_0x439332);},'vlJhL':function(_0x5a35ad,_0x4dc726,_0x525254){return _0x5a35ad(_0x4dc726,_0x525254);},'cOpyw':function(_0x541e3f,_0x4fe448){return _0x541e3f(_0x4fe448);},'unhJK':_0x34f69f(0x3a,0x19e,0x19b,0xcf),'YPlMN':function(_0x10f7f5,_0x43216d){return _0x10f7f5(_0x43216d);},'rkzTN':'JSON\x20解析失败，'+_0x105836(0x2bf,0x37c,0x3f8,0x354)+_0x34f69f(0xc5,0xf,0x53,0xb3),'eLvCI':_0x34f69f(0x1ab,0x5b,0x11e,0x12a),'NgjIX':function(_0x1d1ea2){return _0x1d1ea2();},'VKuhf':'<lora:','QNFPC':_0x105836(0x272,0x2cb,0x33b,0x32f),'UCegX':function(_0xf4725e,_0x5ba318){return _0xf4725e(_0x5ba318);},'HOooS':_0x34f69f(0x17e,0x193,0x1b1,0x18b)+_0x34f69f(0x87,0x1fa,0x1c5,0x12c)+_0x105836(0x4ae,0x4b0,0x36a,0x3fc),'UATsU':function(_0x12d284,_0x29f081){return _0x12d284===_0x29f081;},'HVVMC':'wGFPD','pNASy':_0x34f69f(0x141,0xfc,0x60,0x108),'exEtY':function(_0x5b3065,_0x1cc604){return _0x5b3065>_0x1cc604;},'ihOdA':_0x105836(0x2df,0x427,0x416,0x388),'mmPJj':_0x34f69f(0x176,0x1f9,0x11f,0x197),'kZfnY':'video/','Ekwfq':_0x105836(0x41d,0x41a,0x318,0x382),'REVTn':function(_0x4f77e7,_0x2b3169){return _0x4f77e7(_0x2b3169);},'Ilrzp':_0x34f69f(0x1a0,0x9f,0xa9,0x168)+_0x105836(0x355,0x373,0x3e2,0x3aa)+_0x105836(0x25d,0x2d1,0x246,0x313)+_0x34f69f(0x2c,0xe4,0x14c,0x7f),'FKreI':_0x34f69f(0xf,0x17b,0x15a,0xb8),'gEoHV':function(_0xe11981,_0x373f0e){return _0xe11981(_0x373f0e);},'nJpCA':function(_0x589f9e){return _0x589f9e();},'BcGlM':function(_0x2dc78c,_0x807beb){return _0x2dc78c+_0x807beb;},'KmZkt':function(_0xebaab3,_0x5b50e4){return _0xebaab3||_0x5b50e4;},'toERQ':_0x105836(0x4a9,0x3ac,0x397,0x435),'brWoF':'link','RjAYD':function(_0x498438,_0x2760a6){return _0x498438(_0x2760a6);},'Nsoqg':function(_0x21d5cc,_0x338ed2){return _0x21d5cc(_0x338ed2);},'AjaKT':function(_0x5c40f2,_0x5a9e20){return _0x5c40f2(_0x5a9e20);},'nchNR':function(_0x34eae4,_0x5666b7){return _0x34eae4(_0x5666b7);},'OqQwO':_0x105836(0x3b3,0x431,0x484,0x3b1),'JtVuK':_0x34f69f(0x9c,0x39,0x20,0xbc),'tZVsO':function(_0x41d71e,_0x1ff6e7){return _0x41d71e(_0x1ff6e7);},'qLJHY':function(_0x2a2e13,_0x2f543b){return _0x2a2e13(_0x2f543b);},'ogqTZ':_0x105836(0x3f5,0x350,0x39c,0x3f6)+_0x34f69f(0xdb,0xc5,0x101,0xb7),'xDNeN':_0x34f69f(0xae,0x120,0x71,0x57)+'坐标的提示词字符串。','EjWLt':function(_0x7a6e12,_0xd8db88){return _0x7a6e12(_0xd8db88);},'btHTR':function(_0x7e10c6,_0x550a71){return _0x7e10c6<=_0x550a71;},'tMbVd':function(_0x3bd4c0,_0x367b48){return _0x3bd4c0===_0x367b48;},'NNMZR':_0x105836(0x4d0,0x3bb,0x3e2,0x413),'oSNJe':function(_0x26ac99,_0x1ea8b1){return _0x26ac99===_0x1ea8b1;},'YBjsQ':_0x105836(0x32b,0x3c1,0x3b9,0x3e3),'opBMg':_0x105836(0x3c1,0x26c,0x3b4,0x30f),'eRATB':function(_0x2ad989,_0x3dbdfb){return _0x2ad989<=_0x3dbdfb;},'GNKSD':_0x34f69f(0x12a,0x18a,0x1ba,0x131),'Ynnll':function(_0xbaa2c2,_0x5d0555){return _0xbaa2c2+_0x5d0555;},'WjZuh':function(_0x5ca57d,_0x488f22,_0x19f489,_0x31b729,_0x39fc42,_0x60a529){return _0x5ca57d(_0x488f22,_0x19f489,_0x31b729,_0x39fc42,_0x60a529);},'mhGLw':'全能提示词编辑器','qUfKB':_0x105836(0x4ab,0x342,0x4c3,0x406),'EJAja':_0x105836(0x43b,0x34e,0x444,0x412),'reqMi':function(_0x385a69,_0x5cc4c2){return _0x385a69(_0x5cc4c2);},'NXyhe':function(_0x519e5b,_0x2e3fcc,_0x45ed38){return _0x519e5b(_0x2e3fcc,_0x45ed38);},'dvhQd':'pURfJ','YYIyV':function(_0xbfeca,_0x26e503){return _0xbfeca(_0x26e503);},'FsNXM':function(_0x32aed0,_0x152b2a){return _0x32aed0===_0x152b2a;},'oLzpj':function(_0x599a08){return _0x599a08();},'ItpPy':function(_0x1e31ed,_0x386d16){return _0x1e31ed(_0x386d16);},'ykPKF':_0x105836(0x3e8,0x334,0x485,0x3f0)+_0x105836(0x394,0x48b,0x375,0x443)+'ced-37d290'+_0x34f69f(0x8f,0x1d8,0x157,0x167),'VOmXV':'omvmj','lrjrh':function(_0x144f41,_0x4e0d4f){return _0x144f41>_0x4e0d4f;},'KYWyl':function(_0x777363,_0xf703ee){return _0x777363(_0xf703ee);},'pqdbV':_0x34f69f(0x249,0x1a8,0x16b,0x18a),'DUTsr':_0x34f69f(0x90,0x5c,-0x13,0x63),'VCrvo':_0x105836(0x474,0x2fb,0x394,0x3a2),'AHRvZ':function(_0x3f88d3,_0x4a7e71){return _0x3f88d3===_0x4a7e71;},'ArHeW':_0x34f69f(0x57,-0x6a,-0x7e,0x3e),'pIwFf':_0x34f69f(0x17d,-0x6,0x10d,0xc5)+_0x105836(0x368,0x361,0x46d,0x397)+'te','GSDJP':_0x34f69f(0x93,0x95,0xf2,0xb5),'zyCPS':function(_0x14dab6,_0x49bd76){return _0x14dab6===_0x49bd76;},'sPkEg':_0x105836(0x468,0x424,0x51c,0x4a7),'FVHYA':_0x105836(0x2ce,0x2e1,0x395,0x378),'Itcoi':function(_0x5475c2,_0x127474){return _0x5475c2===_0x127474;},'suZBk':_0x105836(0x2dd,0x41f,0x286,0x35b),'bYXTM':_0x105836(0x474,0x435,0x329,0x3bc)+_0x105836(0x30c,0x46b,0x408,0x38d)+'an\x20client)'+'。','rLMWo':_0x34f69f(0x1b9,0x136,0x102,0x176)+_0x105836(0x3ff,0x365,0x2c0,0x39d)+_0x34f69f(-0x3,0xa1,0xdc,0x51),'TOTwz':function(_0x400e3d,_0xabbbb1){return _0x400e3d||_0xabbbb1;},'eAQqH':function(_0x10ba00,_0x24ae69){return _0x10ba00!==_0x24ae69;},'WoKFQ':_0x34f69f(0x190,0x199,0xba,0xbf),'ZbrEe':'QIQJS','tfwbK':function(_0x50c089,_0x2c2c9d){return _0x50c089===_0x2c2c9d;},'ClMua':'umiQD','FsDNO':_0x105836(0x453,0x50b,0x4fe,0x49d)+'在中断\x20ComfyU'+'I...','mtwQM':function(_0x4a3818,_0x4da72d){return _0x4a3818===_0x4da72d;},'jvNsU':'fWNhf','vwRhl':function(_0x48fcd3,_0x1b7944,_0x560ed5){return _0x48fcd3(_0x1b7944,_0x560ed5);},'LQlWh':'[ComfyUI]\x20'+'中断请求失败:','FVQdm':_0x34f69f(0x1d5,0x281,0x215,0x1ce),'bjcrB':function(_0x3a868e,_0x1ba345){return _0x3a868e(_0x1ba345);},'THtfh':_0x105836(0x412,0x541,0x4fa,0x472),'qaoKk':function(_0x4051ed,_0x38bfc6){return _0x4051ed(_0x38bfc6);},'yXEZg':'outputs','awcbO':_0x105836(0x3cc,0x403,0x36a,0x368),'BoMEh':_0x34f69f(0x29,0x1a,-0x15,0x98)+_0x105836(0x37c,0x331,0x441,0x400),'LSOAm':function(_0x381f64,_0xd798a3){return _0x381f64(_0xd798a3);},'XlZMX':function(_0x48ca9d,_0x20363f){return _0x48ca9d!==_0x20363f;},'rGCbw':_0x34f69f(0x16d,0x118,0x90,0xe6),'WpizT':_0x34f69f(0x228,0x1b1,0x1c9,0x1a4),'nvdOy':function(_0x585f0b,_0x5df1e0){return _0x585f0b===_0x5df1e0;},'ggMQT':'JcssS','IwQtu':_0x34f69f(-0x23,-0x49,0x75,0x17),'ofppH':'video/mp4','VIvIQ':'webm','fcadR':function(_0x1d5ca1,_0x5d0771){return _0x1d5ca1!==_0x5d0771;},'KryUI':_0x105836(0x3e1,0x42b,0x4cf,0x463),'bXQfT':'atOMU','uNbBW':'rqFuz','Wfbah':function(_0x12d32e,_0x9e369b){return _0x12d32e||_0x9e369b;},'ixqyx':function(_0x5b637c,_0x5cb3f6){return _0x5b637c===_0x5cb3f6;},'yMAxA':_0x34f69f(-0x24,0xe7,0x106,0x99),'CjiPJ':function(_0x8a7f7a,_0x59cc6e){return _0x8a7f7a(_0x59cc6e);}};_0x21c9f1[_0x105836(0x395,0x301,0x2e6,0x31f)](clearLog);const _0x5ef13f=taskQueue[_0x34f69f(0x97,0x30,-0x1,0x70)]({'name':_0x21c9f1[_0x105836(0x523,0x522,0x436,0x4af)](_0x21c9f1['KmZkt'](_0x1ed777,'')[_0x34f69f(0x192,0x138,0x14f,0x154)](0x4*-0x5ce+-0xf4f*0x1+0x2687,-0x1*-0x251d+-0x15b5+-0xf4a),_0x1ed777&&_0x1ed777['length']>0x14de+-0x1*-0x164f+-0x2b0f?_0x21c9f1[_0x34f69f(0x78,-0x51,0x11,0x5c)]:''),'type':TaskType[_0x105836(0x34a,0x409,0x332,0x39c)],'prompt':_0x1ed777});currentTaskId=_0x5ef13f,console[_0x34f69f(-0x20,0x6d,0x59,0x6f)](_0x21c9f1[_0x34f69f(0x131,0x172,0xb8,0xb0)],_0x1ed777),_0x1ed777=_0x21c9f1['RjAYD'](processCharacterPrompt,_0x1ed777),_0x1ed777=await _0x21c9f1['Nsoqg'](stripChineseAnnotations,_0x1ed777);let _0x28e855=_0x4e5cb5;_0x4e5cb5=processCharacterPrompt(_0x4e5cb5),_0x4e5cb5=await stripChineseAnnotations(_0x4e5cb5),_0x21c9f1[_0x105836(0x3d2,0x350,0x4e8,0x42c)](addLog,'开始\x20ComfyUI'+_0x105836(0x405,0x3a9,0x3e9,0x3a0)+extension_settings[extensionName][_0x105836(0x2a7,0x305,0x396,0x342)]),_0x21c9f1['nchNR'](addLog,_0x34f69f(-0x36,0xb2,0x112,0x87)+extension_settings[extensionName][_0x105836(0x355,0x402,0x27f,0x336)]),_0x21c9f1['cOpyw'](addLog,_0x105836(0x4a2,0x40d,0x508,0x489)+'\x20'+_0x21c9f1[_0x34f69f(0x182,0xe8,0x13b,0xf3)](_0x3e1295,'默认')+_0x34f69f(0xff,0x90,0x3c,0xb1)+_0x21c9f1[_0x105836(0x334,0x48e,0x45f,0x3e9)](_0x38b7ea,'默认'));if(_0x21c9f1[_0x105836(0x436,0x453,0x382,0x3fd)](extension_settings[extensionName][_0x34f69f(0x1a9,0x14f,0x21b,0x1c7)][_0x34f69f(0xc3,0x52,0xa4,0xc1)](),_0x21c9f1[_0x34f69f(-0x6a,-0xae,0x8f,0x20)])){const _0xb6bfb1=_0x21c9f1[_0x34f69f(0x128,0xe0,0x52,0xee)][_0x105836(0x3ae,0x32d,0x439,0x364)]('|');let _0x257c36=0x577*-0x6+-0x7*-0xf8+-0x1a02*-0x1;while(!![]){switch(_0xb6bfb1[_0x257c36++]){case'0':return;case'1':_0x21c9f1[_0x34f69f(0x43,0x4e,-0x4e,0x6b)](addLog,_0x21c9f1[_0x34f69f(0x190,0x31,0x17d,0xef)]);continue;case'2':currentTaskId=null;continue;case'3':taskQueue[_0x105836(0x4b8,0x337,0x3b9,0x3ff)+'sk'](_0x5ef13f,![]);continue;case'4':toastr[_0x34f69f(0x232,0x8d,0xc5,0x160)](_0x21c9f1['dkjgc']);continue;}break;}}const _0x3348d3=extension_settings[extensionName][_0x34f69f(-0x17,0x72,-0x16,0x42)][_0x34f69f(0x62,0x12c,0xab,0xc1)](),_0x27b973=_0x4e5cb5&&_0x4e5cb5[_0x34f69f(0xef,0x3f,0xa0,0xc1)]()!==''?_0x4e5cb5:_0x1ed777;_0x21c9f1['qLJHY'](addLog,'用于生成的Tag:\x20'+_0x27b973);function _0x34f69f(_0x442d18,_0x1859de,_0x44df6c,_0x2afb5b){return _0x2569(_0x2afb5b- -0x175,_0x442d18);}let _0x250f3f=![];_0x27b973[_0x34f69f(0xed,-0x78,-0x10,0x41)](_0x21c9f1['ogqTZ'])&&(_0x250f3f=!![]);_0x21c9f1[_0x34f69f(0x180,0x1bd,0x1e1,0x139)](addLog,_0x34f69f(-0xf,-0x79,0x58,0x15)+_0x105836(0x40e,0x47a,0x4e8,0x49e)+_0x34f69f(0xb2,0x152,0x143,0x113)+_0x250f3f);let _0x4e0273={},_0x1a44d0='',_0x235edd='';if(_0x250f3f){_0x21c9f1[_0x105836(0x499,0x479,0x501,0x42f)](addLog,_0x21c9f1[_0x105836(0x386,0x435,0x3c9,0x405)]),_0x4e0273=_0x21c9f1['EjWLt'](parsePromptStringWithCoordinates,_0x27b973),_0x1a44d0=_0x4e0273[_0x21c9f1['ogqTZ']];for(let _0xf0d1c9=-0x24d4+0x1989+0xb4c;_0x21c9f1[_0x105836(0x3b8,0x497,0x395,0x3d4)](_0xf0d1c9,0x16*-0x6c+0x689+0x65*0x7);_0xf0d1c9++){_0x21c9f1[_0x34f69f(0xaf,0xfc,0x98,0x170)](_0x21c9f1[_0x34f69f(0xea,0x117,0x8b,0x66)],_0x21c9f1[_0x105836(0x32f,0x292,0x331,0x35c)])?_0x4e0273[_0x34f69f(0x98,0x134,0x1c6,0x16a)+_0xf0d1c9+_0x34f69f(0xcf,0x10a,0x154,0x179)]&&(_0x21c9f1['oSNJe'](_0x21c9f1[_0x105836(0x372,0x523,0x501,0x448)],_0x21c9f1[_0x105836(0x4f8,0x388,0x3bf,0x448)])?_0x235edd=_0x21c9f1[_0x34f69f(0x149,0x118,0xf4,0x1b9)](_0x21c9f1[_0x34f69f(0x285,0x124,0xf8,0x1b9)](_0x235edd,',\x20'),_0x4e0273['Character\x20'+_0xf0d1c9+_0x34f69f(0x155,0x1c8,0x17e,0x179)]):_0x569726=_0x21c9f1[_0x105836(0x4d2,0x403,0x3ea,0x45c)](_0x42b4ae,',\x20')+_0x39b756[_0x34f69f(0x194,0x1e8,0xfd,0x16a)+_0x500833+_0x105836(0x46f,0x519,0x505,0x46f)]):_0x359c85[_0x105836(0x492,0x40a,0x4d0,0x3ff)+'sk'](_0x2283db,![]);}}else _0x21c9f1['Nsoqg'](addLog,_0x105836(0x551,0x428,0x564,0x4a6)+'中的\x20prompt。'),_0x1a44d0=_0x27b973;let {modifiedPrompt:_0x400198,insertions:_0x4cd2f7}=await prompt_replace(_0x1a44d0,_0x235edd);if(_0x250f3f){if(_0x21c9f1['tMbVd'](_0x21c9f1[_0x34f69f(0x146,0x154,0x264,0x198)],'GIqEe'))throw new _0x580bd7(_0x21c9f1[_0x34f69f(0x112,0x77,0xef,0x14a)]);else for(let _0x573c87=-0x79*0x15+-0x65a*0x6+0x2b*0x11e;_0x21c9f1[_0x105836(0x3d8,0x4c5,0x469,0x455)](_0x573c87,0x2307+-0x7*-0x115+0xed*-0x2e);_0x573c87++){if(_0x21c9f1[_0x105836(0x263,0x258,0x303,0x315)]!==_0x105836(0x34b,0x38a,0x488,0x427)){const _0x5b2afa=_0x105836(0x374,0x501,0x383,0x452)['split']('|');let _0x3c2a1b=0x1dfd+-0xa*-0x3bf+0x22d*-0x1f;while(!![]){switch(_0x5b2afa[_0x3c2a1b++]){case'0':return;case'1':_0x369126=null;continue;case'2':_0x5ec8e2[_0x34f69f(0x14a,0x79,0x19f,0x109)+'sk'](_0x315012,![]);continue;case'3':_0x21c9f1['mSyDO'](_0x12f094,_0x21c9f1['dkjgc']);continue;case'4':_0x34d112['error'](_0x21c9f1[_0x105836(0x496,0x332,0x3d1,0x3e5)]);continue;}break;}}else _0x4e0273['Character\x20'+_0x573c87+'\x20Prompt']&&(_0x400198=_0x21c9f1[_0x105836(0x368,0x483,0x37e,0x3ed)](_0x21c9f1['BcGlM'](_0x400198,_0x21c9f1[_0x34f69f(0x135,0x111,0xdf,0x117)]),_0x21c9f1['RjAYD'](prompt_replace_for_character,_0x4e0273[_0x105836(0x4cb,0x3cc,0x44e,0x460)+_0x573c87+_0x105836(0x4cb,0x4f8,0x3ec,0x46f)])));}}let _0x26bc77=await _0x21c9f1[_0x105836(0x3a7,0x403,0x51a,0x442)](zhengmian,extension_settings[extensionName][_0x34f69f(0xad,0x15c,0xda,0x13b)][extension_settings[extensionName][_0x34f69f(0xbd,0x1b,0x61,0xe5)+'mfyui']][_0x34f69f(0x57,0x24,-0x51,0x61)+'t'],_0x400198,extension_settings[extensionName]['yushe'][extension_settings[extensionName][_0x34f69f(0x1a3,0x1af,0x135,0xe5)+_0x34f69f(-0x4a,0x6,-0x35,0x24)]][_0x34f69f(-0x39,-0x1c,0xec,0x61)+_0x105836(0x2ea,0x262,0x3e5,0x33f)],extension_settings[extensionName][_0x34f69f(0x19a,0x1f1,0xb1,0x11b)+'i'],_0x4cd2f7);_0x26bc77=_0xdd3895(_0x26bc77);function _0xdd3895(_0x5cf1d9){function _0x320157(_0x26880f,_0x2e652f,_0x4da42f,_0x35494d){return _0x34f69f(_0x26880f,_0x2e652f-0x162,_0x4da42f-0x164,_0x4da42f- -0x162);}function _0x554b84(_0x582a38,_0x5c1696,_0x3dd666,_0x184a7f){return _0x34f69f(_0x3dd666,_0x5c1696-0x5d,_0x3dd666-0xae,_0x5c1696- -0x77);}if(_0x21c9f1[_0x554b84(0x16,0xad,0xc0,-0x27)](_0x21c9f1['JPrug'],_0x21c9f1[_0x554b84(0xc6,-0xf,-0x29,-0xc4)]))_0x2af303[_0x554b84(0xe7,0xce,0x9d,0x27)+_0x554b84(-0x2d,0x5f,0x4,0x14)+'tener']&&(_0x1958a1[_0x554b84(0x6e,0x1e,0xb0,-0x27)+_0x554b84(-0xb3,-0x2f,-0xbb,-0x6)](_0x3a34d9['GENERATE_I'+_0x554b84(0x2,0x27,0xe5,0x11)+'ST'],_0xe708fe),_0x28a2f9[_0x554b84(0x4d,0xce,0x42,0x174)+'ComfyuiLis'+_0x554b84(0x13a,0xc3,0xb0,0x5b)]=![],_0x21c9f1['mSyDO'](_0x5b5504,_0x320157(-0xd,-0x32,-0x3a,-0xa3)+_0x320157(-0x92,-0xa9,-0xe7,-0x157)));else{const _0x43ee78=/<lora:([^:]+)(?:\.safetensors)?:([^>]+)(?::1)?>/g;return _0x5cf1d9[_0x320157(-0x1eb,-0x9b,-0x13b,-0x1d9)](_0x43ee78,(_0x549085,_0x585f7b,_0x1e0794)=>{function _0x5996bf(_0x1f6bc6,_0x158b46,_0x6a3789,_0x270810){return _0x320157(_0x6a3789,_0x158b46-0x1e1,_0x158b46-0x57,_0x270810-0x1c6);}if(_0x549085[_0x5996bf(-0x199,-0xca,0x2,-0x58)](_0x21c9f1['IzSPP']))return _0x549085;if(_0x1e0794[_0x5996bf(-0xa7,-0xca,-0x112,-0x55)](':'))return _0x4f7b65(0xcc,0xf3,0x190,0xdb)+_0x585f7b+(_0x5996bf(-0x9c,-0x70,0x7,-0x6)+_0x4f7b65(0x111,0x190,0x1a5,0x12d))+_0x1e0794+'>';function _0x4f7b65(_0x5f0b6d,_0x58335b,_0x2aeaab,_0x12f1bc){return _0x554b84(_0x5f0b6d-0xf,_0x12f1bc-0x23,_0x5f0b6d,_0x12f1bc-0x13e);}return'<lora:'+_0x585f7b+(_0x4f7b65(0xdc,0x3d,-0x5a,0x47)+'rs:')+_0x1e0794+_0x4f7b65(0x6f,0xf5,0x1b2,0x14b);});}}extension_settings[extensionName][_0x34f69f(-0x4,0x57,-0x2a,0x90)][_0x34f69f(0x61,0x6a,0xfc,0x41)](_0x21c9f1[_0x34f69f(0x138,0x257,0x136,0x1d0)])&&(_0x21c9f1[_0x34f69f(0xb0,0x9b,0xfb,0x124)](_0x21c9f1[_0x105836(0x4da,0x4e0,0x51d,0x4ad)],_0x21c9f1[_0x34f69f(0x102,0x26e,0x167,0x1b7)])?_0x1ec50f[_0x105836(0x4e5,0x3c7,0x3a8,0x460)+_0x827773+_0x105836(0x3a5,0x544,0x456,0x46f)]&&(_0x10004a=_0x21c9f1[_0x34f69f(0x103,0xde,0x8c,0x166)](_0x3573c2+',\x20',_0x53d740[_0x105836(0x42a,0x4e7,0x39a,0x460)+_0x417b41+_0x34f69f(0xee,0x198,0x18e,0x179)])):(_0x26bc77=_0x26bc77[_0x105836(0x471,0x40e,0x46e,0x468)](_0x34f69f(0x1e4,0x1ab,0x64,0x12f),_0x21c9f1[_0x105836(0x40e,0x412,0x3d0,0x379)]),_0x26bc77=_0x26bc77[_0x34f69f(0xa7,0x18e,0xbf,0x172)](_0x34f69f(0xa7,0x13,-0x19,0x9b)+'rs','')));console[_0x105836(0x440,0x36a,0x30e,0x365)](_0x21c9f1[_0x105836(0x2ce,0x290,0x2a7,0x33c)],_0x26bc77);function _0x105836(_0x4f4507,_0x294aeb,_0x3b9309,_0x4029fe){return _0x2569(_0x4029fe-0x181,_0x3b9309);}_0x21c9f1['reqMi'](addLog,'正面提示词:\x20'+_0x26bc77);let _0x443db8=await _0x21c9f1[_0x105836(0x3fc,0x4e5,0x472,0x491)](fumian,extension_settings[extensionName][_0x34f69f(0xc0,0x190,0x203,0x13b)][extension_settings[extensionName]['yusheid_co'+_0x34f69f(0x2a,-0xaf,0x2b,0x24)]][_0x34f69f(0x116,-0x2,0x108,0x7d)+_0x34f69f(0x115,0xe7,0x35,0xda)],extension_settings[extensionName][_0x105836(0x3f4,0x383,0x46c,0x3f4)+'i']);extension_settings[extensionName]['worker'][_0x105836(0x3cc,0x2b2,0x291,0x337)](_0x21c9f1[_0x105836(0x4fc,0x407,0x437,0x4c6)])?_0x21c9f1[_0x105836(0x44c,0x3d7,0x3a2,0x42d)]!==_0x21c9f1[_0x34f69f(0x72,0x165,0x85,0x137)]?_0x304839=_0x21c9f1[_0x105836(0x493,0x353,0x434,0x3d2)]:_0x443db8=_0x443db8['replaceAll'](_0x34f69f(0x190,0x15f,0x7a,0x12f),_0x34f69f(0xf1,0x50,0x6a,0x39)):_0x443db8=_0x21c9f1[_0x34f69f(0x196,0x1b3,0x132,0x191)](_0xdd3895,_0x443db8);_0x21c9f1[_0x105836(0x3e7,0x4aa,0x48c,0x441)](addLog,_0x105836(0x329,0x342,0x346,0x3af)+_0x443db8),_0x26bc77=_0x26bc77[_0x105836(0x448,0x3d9,0x3cd,0x468)]('\x0a',',')['replace'](/,{2,}/g,',')[_0x34f69f(0x22b,0x1d2,0x1cf,0x172)]('\x5c\x5c','\x5c')[_0x105836(0x478,0x476,0x3be,0x468)]('\x5c','\x5c\x5c'),_0x443db8=_0x443db8['replaceAll']('\x0a',',')[_0x105836(0x3d9,0x3d4,0x34f,0x31d)](/,{2,}/g,',')[_0x105836(0x51f,0x3c7,0x4e6,0x468)]('\x5c\x5c','\x5c')[_0x105836(0x41e,0x3c2,0x3e8,0x468)]('\x5c','\x5c\x5c');let _0x44b09a={'prompt':_0x26bc77,'negative_prompt':_0x443db8,'steps':extension_settings[extensionName]['comfyui_st'+'eps'],'sampler_name':extension_settings[extensionName][_0x34f69f(0x13c,0x13b,0x203,0x1b4)+'plerName'],'width':_0x3e1295?_0x3e1295:extension_settings[extensionName][_0x34f69f(0xe4,0x12d,0x165,0xd9)+_0x105836(0x3d4,0x38c,0x327,0x3ac)],'height':_0x38b7ea?_0x38b7ea:extension_settings[extensionName][_0x105836(0x33b,0x381,0x3a6,0x362)+_0x105836(0x43e,0x2e3,0x336,0x37f)],'cfg_scale':extension_settings[extensionName]['cfg_comfyu'+'i'],'seed':_0x21c9f1[_0x34f69f(0x14c,0x195,0x45,0x107)](extension_settings[extensionName][_0x105836(0x30b,0x2b3,0x35b,0x312)+'ed'],0x143c+-0x1*-0x1786+-0x2bc2)||extension_settings[extensionName][_0x34f69f(0xbc,0x13,0xbc,0x1c)+'ed']==='0'||extension_settings[extensionName]['comfyui_se'+'ed']===''||_0x21c9f1[_0x34f69f(0x224,0xea,0x283,0x1a6)](extension_settings[extensionName][_0x34f69f(-0xb9,-0xc,0x99,0x1c)+'ed'],-(-0xe*-0xc0+0x48b*0x2+-0x1395))||extension_settings[extensionName][_0x34f69f(0x1e,-0xbc,0x61,0x1c)+'ed']==='-1'?_0x21c9f1[_0x105836(0x2d8,0x2fa,0x3e7,0x344)](generateRandomSeed):extension_settings[extensionName][_0x34f69f(0x15,0xee,0xb0,0x1c)+'ed'],'MODEL_NAME':extension_settings[extensionName][_0x34f69f(0x25f,0x1ce,0x1a1,0x1c7)],'c_quanzhong':extension_settings[extensionName]['c_quanzhon'+'g'],'c_idquanzhong':extension_settings[extensionName][_0x105836(0x2ba,0x3de,0x24c,0x328)+'ong'],'c_xijie':extension_settings[extensionName][_0x105836(0x4e9,0x58c,0x509,0x4b9)],'c_fenwei':extension_settings[extensionName][_0x34f69f(0x20d,0x138,0xf0,0x1b3)],'comfyuicankaotupian':window[_0x34f69f(0xa1,-0x57,-0x70,0x31)+_0x34f69f(0xe7,0x20b,0x170,0x141)],'ipa':extension_settings[extensionName][_0x34f69f(0x104,0x9e,0xc5,0xdb)],'scheduler':extension_settings[extensionName][_0x34f69f(0xfe,0x9d,0x42,0xe2)+_0x105836(0x344,0x3d7,0x45c,0x3c2)],'vae':extension_settings[extensionName][_0x34f69f(-0x65,0x82,0x12,0x34)+'e'],'clip':extension_settings[extensionName][_0x105836(0x2dd,0x315,0x339,0x3b9)+_0x105836(0x433,0x420,0x2d8,0x3a8)]};const _0x1bb0b4=_0x105836(0x398,0x281,0x35d,0x34f)+'告\x20---\x0a正面提示'+'词:\x20'+_0x44b09a[_0x34f69f(0x165,0x46,0x171,0x11c)]+_0x34f69f(0x97,-0x4f,0x73,0x8f)+_0x44b09a[_0x105836(0x367,0x376,0x34b,0x35f)+'rompt']+'\x0a模型:\x20'+_0x44b09a['MODEL_NAME']+_0x34f69f(0x1cf,0xab,0x23e,0x162)+_0x44b09a[_0x105836(0x4c6,0x52f,0x533,0x47a)+'me']+_0x105836(0x4ac,0x4a5,0x497,0x414)+_0x44b09a['steps']+(_0x105836(0x3c0,0x398,0x338,0x325)+':\x20')+_0x44b09a[_0x105836(0x360,0x4a7,0x45d,0x3f5)]+'\x0a种子:\x20'+_0x44b09a[_0x105836(0x324,0x302,0x303,0x376)]+'\x0a尺寸:\x20'+_0x44b09a[_0x34f69f(0x4e,0xea,0x16a,0xce)]+'x'+_0x44b09a[_0x105836(0x583,0x53d,0x550,0x4ab)]+_0x105836(0x2ec,0x302,0x261,0x31b)+_0x44b09a[_0x34f69f(-0x61,-0xa5,0xad,0x33)]+(_0x105836(0x41c,0x3fa,0x45d,0x493)+':\x20')+_0x44b09a[_0x105836(0x53d,0x545,0x3be,0x475)]+('\x0a---------'+_0x34f69f(-0x34,-0x62,-0x4e,0x4b)+'-\x0a');_0x21c9f1['ItpPy'](addLog,_0x1bb0b4);const _0x42bbb7=_0x21c9f1[_0x105836(0x413,0x3c9,0x38f,0x459)];let _0x2a55a0=extension_settings[extensionName][_0x105836(0x3dd,0x373,0x45c,0x386)];try{const _0x70d797=JSON[_0x34f69f(0x187,0x1df,0x16c,0x18c)](_0x2a55a0),_0x1f7628=Object[_0x34f69f(0x170,0xab,0x25,0x94)](_0x70d797)['filter'](_0x58c244=>_0x58c244&&_0x58c244[_0x34f69f(0x151,0xf,0xa,0xa5)])[_0x105836(0x484,0x2fe,0x475,0x3d5)];if(_0x1f7628>0xe95+-0x39*-0x22+0x35*-0x6b){if(_0x21c9f1['FsNXM'](_0x21c9f1[_0x34f69f(0x208,0x1e3,0x18e,0x1bd)],_0x105836(0x3fa,0x388,0x345,0x403))){_0x21c9f1['Nsoqg'](addLog,_0x105836(0x48a,0x349,0x402,0x401)+_0x1f7628+(_0x105836(0x462,0x3ac,0x3a2,0x432)+_0x34f69f(0x211,0x197,0x104,0x1ad)));const _0x203b82=extension_settings[extensionName]?.['comfyuiCac'+'he']?.['objectInfo']||{},_0x434a30=_0x21c9f1['NXyhe'](processSkippedNodes,_0x70d797,_0x203b82);_0x2a55a0=JSON[_0x34f69f(-0x97,0xf1,0xbd,0x37)](_0x434a30),addLog(_0x34f69f(0x232,0x222,0x224,0x169)+'重映射连接'+(_0x21c9f1[_0x105836(0x2e1,0x269,0x2d2,0x32c)](Object[_0x105836(0x433,0x2ef,0x395,0x3c8)](_0x203b82)[_0x105836(0x334,0x3df,0x3e6,0x3d5)],0xe7b+-0x1*0x254f+-0x3ce*-0x6)?_0x21c9f1[_0x34f69f(0x260,0x292,0x207,0x1c8)]:''));}else _0x21c9f1[_0x34f69f(0x181,0x237,0x163,0x17e)](_0x8eb1a4,'缓存设置为不存入数据'+'库');}}catch(_0x180069){_0x21c9f1[_0x105836(0x411,0x571,0x481,0x4c3)](addLog,_0x34f69f(0x110,0x111,0x6b,0x53)+_0x105836(0x4c7,0x4e7,0x3c2,0x450)+_0x180069[_0x34f69f(-0xe,0x18e,0x15b,0xd0)]);}_0x44b09a=await _0x21c9f1[_0x105836(0x432,0x42d,0x3b4,0x40b)](replacepro,_0x44b09a,_0x2a55a0),_0x44b09a=_0x105836(0x4c7,0x4d4,0x491,0x485)+'d\x22:\x22'+_0x42bbb7+(_0x34f69f(0xd3,0xe5,0x6f,0x111)+'\x22:')+_0x44b09a+'}',_0x21c9f1[_0x105836(0x3c3,0x361,0x3d3,0x3b4)](addLog,_0x34f69f(0x1ef,0x225,0x1db,0x187)+'I\x20的最终\x20payl'+_0x105836(0x4ec,0x492,0x3b5,0x410)+_0x44b09a);let _0x34403b=!![];while(_0x34403b){if(window[_0x105836(0x380,0x42c,0x466,0x3a4)]){if(_0x21c9f1['GIYeu'](_0x21c9f1[_0x105836(0x48b,0x40e,0x3cc,0x417)],'qKHRB'))_0x34403b=![];else{if(_0x1c5bc4){const _0x2137a9=_0x205052[_0x34f69f(0x10,0x16,0x15c,0x84)](_0x4ea128,arguments);return _0x1f0d7f=null,_0x2137a9;}}}else await _0x21c9f1[_0x34f69f(0x184,0x11c,0xed,0x1bf)](sleep,0xa*0x1a1+-0xb92*0x3+0x1654);};try{if(_0x21c9f1[_0x34f69f(0xd1,0x19b,0xd0,0x170)](_0x34f69f(0x15b,0x67,0x3a,0xe0),_0x21c9f1['DUTsr'])){const _0x411ff5={};_0x411ff5[_0x105836(0x4ec,0x49d,0x4be,0x41d)]=_0x21c9f1[_0x105836(0x4c1,0x43c,0x443,0x3ee)];const _0x551f13=_0x411ff5,_0x9338af=/<lora:([^:]+)(?:\.safetensors)?:([^>]+)(?::1)?>/g;return _0x105ea1[_0x34f69f(0xc3,0x8c,0xc7,0x27)](_0x9338af,(_0x27c598,_0x53b9ff,_0x146760)=>{function _0x16bd94(_0x55f3fe,_0x20f477,_0x4fecbe,_0x1ffdd2){return _0x34f69f(_0x20f477,_0x20f477-0x7b,_0x4fecbe-0x165,_0x55f3fe-0x262);}function _0x1f43eb(_0x1026f1,_0x1d77c9,_0x4b7ec2,_0x49a9fa){return _0x105836(_0x1026f1-0x13,_0x1d77c9-0x12,_0x1d77c9,_0x1026f1- -0x259);}if(_0x27c598[_0x16bd94(0x2a3,0x1f4,0x265,0x28a)](_0x551f13[_0x16bd94(0x389,0x2bf,0x41d,0x3ba)]))return _0x27c598;if(_0x146760['includes'](':'))return _0x1f43eb(0x1cc,0x1b3,0x193,0x2a2)+_0x53b9ff+(_0x1f43eb(0x138,0x1db,0xb7,0x1d9)+_0x1f43eb(0x21e,0x1d0,0x2ce,0x26d))+_0x146760+'>';return _0x1f43eb(0x1cc,0x27e,0x1c1,0x250)+_0x53b9ff+(_0x16bd94(0x2fd,0x349,0x26a,0x393)+_0x1f43eb(0x21e,0x27d,0x2b1,0x194))+_0x146760+_0x16bd94(0x401,0x3e2,0x414,0x47f);});}else{window[_0x34f69f(0x4e,0xf8,-0x2c,0xae)]=!![],taskQueue[_0x105836(0x2e7,0x300,0x45b,0x393)+'us'](_0x5ef13f,_0x21c9f1[_0x105836(0x48e,0x571,0x58f,0x4c1)]);let _0x39e912;if(_0x21c9f1['AHRvZ'](extension_settings[extensionName][_0x105836(0x402,0x306,0x308,0x342)],_0x21c9f1[_0x105836(0x3c4,0x313,0x2c3,0x33b)])){const _0x206950={};_0x206950['url']=_0x3348d3,_0x206950[_0x105836(0x3bd,0x488,0x3f3,0x412)]=_0x44b09a;const _0x381a31=await _0x21c9f1[_0x34f69f(0x14d,0x152,0x186,0x19b)](fetch,_0x21c9f1['pIwFf'],{'method':_0x21c9f1[_0x105836(0x393,0x407,0x292,0x363)],'body':JSON[_0x105836(0x277,0x371,0x333,0x32d)](_0x206950),'headers':_0x21c9f1[_0x34f69f(0x1b5,0xad,0x109,0x136)](getRequestHeaders,window[_0x105836(0x381,0x506,0x3a8,0x42e)])});if(!_0x381a31['ok']){const _0x1066db=await _0x381a31[_0x34f69f(0x27,0x7d,0xd1,0x55)]();addLog(_0x105836(0x235,0x3a8,0x261,0x311)+_0x34f69f(0xff,0xee,0xce,0xa8)+'ient):\x20'+_0x1066db);throw new Error(_0x105836(0x56a,0x479,0x561,0x496)+_0x381a31[_0x34f69f(0x1b,0xfc,-0x2d,0xa2)]+_0x34f69f(0xb5,0x207,0x117,0x173)+_0x1066db);}const _0x2bd12c=await _0x381a31[_0x105836(0x2ea,0x3e9,0x348,0x34b)]();let _0x2600cf,_0x30ef07;try{const _0x1f218d=JSON[_0x34f69f(0x172,0x11c,0x180,0x18c)](_0x2bd12c);_0x2600cf=_0x1f218d[_0x34f69f(0x170,0x40,0x197,0xdd)],_0x30ef07=_0x1f218d[_0x105836(0x232,0x3c2,0x3e7,0x30e)];}catch(_0x5ace72){if(_0x21c9f1[_0x105836(0x3e3,0x449,0x4cd,0x433)](_0x21c9f1['sPkEg'],_0x21c9f1[_0x105836(0x3f6,0x42c,0x415,0x424)]))addLog(_0x105836(0x4f1,0x40b,0x3bb,0x436)+_0x34f69f(0x1,0xae,0x2b,0x5e)+_0x34f69f(-0x22,0x49,0xd7,0xb3)),_0x2600cf=_0x21c9f1[_0x34f69f(0x111,0xb6,0x159,0xe1)],_0x30ef07=_0x2bd12c;else{_0x21c9f1[_0x34f69f(0x15f,0x119,0x185,0x17e)](_0x48354f,_0x34f69f(0x18c,0x17c,0xd3,0x10b)+_0x2399f0+('\x20个跳过的节点，正在'+'处理连接重映射...'));const _0x5cfc5e=_0x20471f[_0x2f7a6c]?.[_0x105836(0x30d,0x436,0x357,0x3e0)+'he']?.[_0x34f69f(0x1af,0xfa,0x138,0x192)]||{},_0x1064ba=_0x21c9f1['vlJhL'](_0x8d3ac3,_0x444b4f,_0x5cfc5e);_0x4bd9ca=_0x5138b5[_0x34f69f(0x10a,-0x82,0x96,0x37)](_0x1064ba),_0x21c9f1[_0x34f69f(0x157,0x1d3,0x105,0x133)](_0x1feb90,_0x34f69f(0x1cb,0x13d,0x1cb,0x169)+_0x105836(0x44d,0x4e5,0x527,0x44e)+(_0x24489a[_0x105836(0x365,0x412,0x48b,0x3c8)](_0x5cfc5e)['length']>-0xd*-0x77+0x1*-0xb1b+0x510?_0x21c9f1[_0x105836(0x4ef,0x4f9,0x593,0x4be)]:''));}}if(!_0x30ef07){if(_0x21c9f1[_0x105836(0x4fc,0x43c,0x4c9,0x4a8)](_0x21c9f1['suZBk'],_0x21c9f1[_0x105836(0x4de,0x3b6,0x4e2,0x41f)])){_0x21c9f1[_0x105836(0x4a3,0x49a,0x320,0x3e6)](addLog,_0x21c9f1[_0x105836(0x2ee,0x2e3,0x337,0x3be)]);throw new Error(_0x21c9f1[_0x105836(0x47d,0x4d1,0x438,0x4c2)]);}else _0x21c9f1[_0x105836(0x316,0x3ef,0x30d,0x3e6)](_0x7b44de,_0x21c9f1[_0x105836(0x310,0x328,0x328,0x323)]),_0x3de902=_0x34f69f(0xcf,0xc7,0xa4,0x82),_0x536893=_0x1b93c5;}return _0x21c9f1[_0x34f69f(0x27,0x88,0x135,0x102)](addLog,_0x21c9f1[_0x34f69f(0x153,0x17f,0x18c,0x17b)]),_0x39e912='data:image'+'/'+_0x2600cf+';base64,'+_0x30ef07,taskQueue[_0x105836(0x3d9,0x345,0x3d6,0x3ff)+'sk'](_0x5ef13f,!![]),currentTaskId=null,{'image':_0x39e912,'change':_0x21c9f1[_0x105836(0x39c,0x3f0,0x4a8,0x40a)](_0x28e855,''),'isVideo':![],'format':_0x2600cf};}else{if(_0x21c9f1['eAQqH'](_0x34f69f(-0x2e,0x16,0xb9,0x67),_0x34f69f(0x8a,-0x52,-0x56,0x16))){const _0x4ff567=new URL(_0x3348d3+_0x21c9f1['WoKFQ']),_0x5bdd20={};_0x5bdd20[_0x105836(0x432,0x3f0,0x30c,0x383)+'pe']=_0x105836(0x44f,0x3fd,0x3fe,0x497)+_0x34f69f(0x109,-0x77,0xbe,0x38);const _0x423654={};_0x423654['method']=_0x21c9f1['GSDJP'],_0x423654['body']=_0x44b09a,_0x423654[_0x105836(0x40a,0x26a,0x2ef,0x332)]=_0x5bdd20;const _0x404d3b=await fetch(_0x4ff567,_0x423654);if(!_0x404d3b['ok']){if('FQbwA'!==_0x21c9f1['ZbrEe']){const _0x573943=await _0x404d3b[_0x34f69f(0x9d,0xee,0x2e,0x55)]();_0x21c9f1[_0x34f69f(0x25e,0x201,0x160,0x1bf)](addLog,_0x34f69f(-0x8d,0x35,0x5a,0x1b)+_0x105836(0x2c2,0x3c3,0x24e,0x326)+_0x34f69f(0x179,0x1b5,0xe7,0x1a5)+_0x573943);throw new Error(_0x105836(0x455,0x3bb,0x42a,0x496)+_0x404d3b['status']+_0x105836(0x528,0x4b6,0x45a,0x469)+_0x573943);}else{const _0x59cbd6={};return _0x59cbd6[_0x105836(0x326,0x401,0x2cd,0x384)]=_0x153ebb['filename'],_0x59cbd6['subfolder']=_0x2b9a5d[_0x34f69f(0x134,0x85,0xcd,0xc4)]||'',_0x59cbd6['isVideo']=![],_0x59cbd6['format']=_0x21c9f1['eLvCI'],_0x59cbd6;}}const _0x5d2f77=await _0x404d3b[_0x34f69f(0xe6,0x169,0x9e,0x16e)]();let _0x477073=_0x5d2f77[_0x34f69f(0x241,0x1e9,0x22c,0x199)],_0x33420d=0xe8d+0x1367*-0x1+-0xcf*-0x6;while(!![]){if(_0x21c9f1[_0x34f69f(0x13d,-0x22,0x8b,0x96)](_0x21c9f1[_0x34f69f(-0x1d,0x156,0xcc,0x86)],_0x105836(0x365,0x362,0x3dc,0x3c7)))_0x329996=![];else try{if(!taskQueue[_0x105836(0x443,0x40b,0x32b,0x3ef)+_0x34f69f(0x10a,0x195,0x1d6,0x146)](_0x5ef13f)){addLog(_0x21c9f1[_0x105836(0x4a2,0x3f1,0x47e,0x426)]);try{_0x21c9f1[_0x34f69f(0xfb,0xb,0xc5,0x81)](_0x21c9f1[_0x34f69f(0x1c8,0xc3,0x1fb,0x12d)],_0x21c9f1[_0x34f69f(0x64,0x1f3,0x17c,0x12d)])?await _0x21c9f1[_0x34f69f(0xdb,0x92,-0x54,0x2a)](fetch,_0x3348d3+('/api/inter'+_0x105836(0x4c3,0x472,0x551,0x4ba)),{'method':_0x21c9f1['GSDJP']}):(!_0x18fca0[_0x105836(0x40a,0x3f4,0x435,0x43b)+_0x34f69f(0x6e,0xa5,0x42,0xd6)+_0x105836(0x364,0x4bc,0x508,0x430)]&&(_0x143c55[_0x34f69f(0xf4,0x14e,0xdb,0x145)+_0x105836(0x49f,0x305,0x388,0x3cc)+'tener']=!![],_0x21c9f1[_0x34f69f(0xde,0x1b1,0x202,0x126)](_0x76de8b)),_0x1dbe9e());}catch(_0x4dbce7){console['warn'](_0x21c9f1[_0x105836(0x4a7,0x533,0x401,0x462)],_0x4dbce7);}throw new Error(_0x21c9f1['FVQdm']);}const _0x5e6f9c=await _0x21c9f1['bjcrB'](fetch,_0x3348d3+_0x34f69f(0xf4,0x12e,-0x74,0x64)+_0x477073);if(!_0x5e6f9c['ok']){_0x21c9f1[_0x105836(0x3ca,0x506,0x375,0x429)](addLog,_0x105836(0x3c8,0x4ad,0x447,0x428)+'\x20'+_0x5e6f9c['status']);throw new Error(_0x105836(0x362,0x340,0x451,0x3fa)+_0x34f69f(0x202,0x187,0x215,0x1bc)+_0x105836(0x38d,0x358,0x416,0x3ea)+_0x5e6f9c[_0x34f69f(0xa,0x26,0x8e,0xa2)]);}let _0x3f6a8e=await _0x5e6f9c[_0x34f69f(0xb6,0x124,0x19e,0x16e)]();console['log'](_0x21c9f1[_0x105836(0x427,0x4a3,0x3eb,0x416)],_0x3f6a8e);if(_0x3f6a8e['hasOwnProp'+'erty'](_0x477073)){function _0x4c4867(_0xfcdc40){function _0x1c62e7(_0x5eb05d,_0x10cafa,_0x20d740,_0x115892){return _0x34f69f(_0x115892,_0x10cafa-0xe,_0x20d740-0xd0,_0x20d740- -0x102);}const _0x301683={'LbHCc':function(_0x26723f,_0x4174ea){return _0x21c9f1['UCegX'](_0x26723f,_0x4174ea);},'ftZOP':_0x21c9f1['HOooS']};function _0x3e2407(_0x3cb592,_0x5ec94b,_0x23a566,_0x4b4d1f){return _0x34f69f(_0x5ec94b,_0x5ec94b-0x129,_0x23a566-0x1b3,_0x23a566- -0x2f);}if(_0x21c9f1['UATsU'](_0x21c9f1['HVVMC'],_0x21c9f1[_0x3e2407(0x1bd,0x1d0,0x189,0xb0)]))_0x295be6=_0x3c1090[_0x1c62e7(0x53,0x8b,0x70,0x1c)](_0x21c9f1[_0x1c62e7(-0x8f,0x1f,-0x98,-0x152)],_0x21c9f1[_0x3e2407(-0x79,0x6a,0x54,0x25)]);else{for(const _0x5475aa in _0xfcdc40){const _0x5aca90=_0xfcdc40[_0x5475aa];if(_0x5aca90[_0x3e2407(0x21c,0x198,0x19a,0x14b)]&&_0x21c9f1['exEtY'](_0x5aca90[_0x1c62e7(0x183,0x7f,0xc7,0x165)][_0x3e2407(0x133,0xa5,0xb0,0xdd)],-0x12fa+0xb*-0x92+0x1940)){if(_0x21c9f1[_0x1c62e7(0x2f,0x78,0x10,0xe7)]!==_0x21c9f1['mmPJj']){const _0x471c0e=_0x5aca90[_0x3e2407(0x1e4,0x1a9,0x19a,0xe4)][_0x1c62e7(-0xa5,-0x1a,-0xe8,-0xad)](_0x5d48a7=>_0x5d48a7[_0x3e2407(0x156,0x80,0x124,0x68)]==='output');if(_0x471c0e){const _0x3e3696={};return _0x3e3696[_0x1c62e7(-0x2a,-0x55,-0x74,-0x104)]=_0x471c0e[_0x3e2407(-0x49,0xb4,0x5f,0xa5)],_0x3e3696[_0x3e2407(-0x20,0x137,0x95,0x70)]=_0x471c0e['subfolder']||'',_0x3e3696[_0x3e2407(0xbd,-0x9c,0x15,0xc9)]=![],_0x3e3696[_0x1c62e7(-0x1,0x49,-0x25,-0x49)]=_0x21c9f1[_0x3e2407(0x1d,0x153,0x9a,0x38)],_0x3e3696;}continue;}else{const _0x415ea4=_0x1c62e7(-0xd4,-0x8d,-0xc8,-0x80)+_0x3e2407(0x231,0x236,0x173,0xe0)+_0x4f24e7+'):\x20'+_0x55aae9[_0x3e2407(-0x11,0x166,0xa1,-0x1)];_0x301683['LbHCc'](_0x55cde0,'错误:\x20'+_0x415ea4),_0x4513a2['error'](_0x301683[_0x3e2407(-0x85,0x105,0x44,-0x58)],_0x2c19e2);const _0x36f1c8={};_0x36f1c8['id']=_0x142fba,_0x36f1c8[_0x3e2407(-0x49,0x120,0x4d,-0x59)]=![],_0x36f1c8['error']=_0x266e2a['message'],_0x36f1c8[_0x1c62e7(0xf6,0x50,0x1a,0xd5)]=_0x1679a5,_0x3c6949['emit'](_0x9f0633['GENERATE_I'+_0x1c62e7(-0x11,0x4b,0x23,0xce)+_0x3e2407(-0x98,-0x6b,0x1b,0xce)],_0x36f1c8);const _0x4d1d82={};_0x4d1d82['id']=_0x1bc7a3,_0x4d1d82['success']=![],_0x4d1d82[_0x1c62e7(0x37,0xd2,0x5e,0x6d)]=_0x2c9141[_0x1c62e7(0x1a,-0x17,-0x32,0xa9)],_0x4d1d82[_0x1c62e7(0x4d,-0xc2,0x1a,0x71)]=_0xae75d5,_0x499dd[_0x3e2407(0xd2,0x127,0x5c,0x69)](_0x3e2407(0x3d,0x93,-0x9,-0x26)+_0x1c62e7(-0x99,-0x1d,0x21,0x89)+'nse',_0x4d1d82),_0x19cf04(_0x3e2407(0x108,0x13d,0x6b,-0x35)+'ID:\x20'+_0x1cf12b+')');}}if(_0x5aca90['gifs']&&_0x5aca90[_0x1c62e7(-0x47,-0x22,-0x16,-0x4c)][_0x1c62e7(-0x28,0xb9,-0x23,-0x28)]>0x161*0x1+-0xa7c+0x1*0x91b){const _0x80cd43=_0x5aca90[_0x1c62e7(-0x1b,-0x12,-0x16,0xc6)][0x165b*-0x1+-0xbf3+-0x224e*-0x1],_0x5189c7=_0x80cd43[_0x1c62e7(0x6e,0x4,-0x25,-0x99)]&&_0x80cd43[_0x1c62e7(-0x6d,0x0,-0x25,0x30)][_0x3e2407(0x1d0,0xbc,0x105,0xbc)](_0x21c9f1[_0x3e2407(0x15b,0x91,0xd4,0xc4)]),_0x27e9d8={};return _0x27e9d8['filename']=_0x80cd43[_0x1c62e7(-0x51,0x52,-0x74,0x0)],_0x27e9d8['subfolder']=_0x80cd43[_0x1c62e7(0x11,0x21,-0x3e,0x50)]||'',_0x27e9d8[_0x3e2407(0x82,-0x17,0x15,0x63)]=_0x5189c7,_0x27e9d8['format']=_0x80cd43[_0x1c62e7(0xae,0x67,-0x25,0x75)]||_0x21c9f1[_0x3e2407(0xe7,-0x36,0x6d,-0x50)],_0x27e9d8;}}return null;}}let _0x2f0605=_0x21c9f1[_0x105836(0x47a,0x4a0,0x461,0x45a)](_0x4c4867,_0x3f6a8e[_0x477073][_0x21c9f1['yXEZg']]);if(!_0x2f0605){if(_0x21c9f1[_0x34f69f(0x20d,0x22a,0x1f0,0x1ba)]!==_0x21c9f1[_0x34f69f(0x15c,0x26d,0x25d,0x1ba)]){_0x21c9f1['YPlMN'](_0x3963e8,_0x34f69f(0x54,0xc2,0x9f,0xcd)+_0x4def9b);throw _0x4c10aa;}else throw new Error(_0x21c9f1[_0x105836(0x483,0x4af,0x40b,0x4b7)]);}window['_lastMedia'+_0x105836(0x2d1,0x33d,0x3d4,0x348)]=_0x2f0605;const _0x864fee=_0x2f0605['isVideo']?'视频':'图片';_0x21c9f1[_0x105836(0x528,0x523,0x52c,0x4c3)](addLog,_0x864fee+(_0x105836(0x33d,0x39f,0x45b,0x3ce)+_0x105836(0x3c0,0x38d,0x4a9,0x3f1)+')。'));let _0x1944c8=_0x3348d3+(_0x105836(0x429,0x4c6,0x40a,0x47e)+_0x105836(0x3b0,0x50b,0x3fc,0x44c))+_0x2f0605[_0x105836(0x35e,0x3b4,0x39a,0x384)]+(_0x105836(0x428,0x399,0x48c,0x46e)+'=')+_0x21c9f1['LSOAm'](encodeURIComponent,_0x2f0605[_0x105836(0x497,0x2eb,0x3ce,0x3ba)])+('&type=outp'+'ut');const _0x15df70=await fetch(_0x1944c8);if(!_0x15df70['ok']){if(_0x21c9f1[_0x105836(0x3bb,0x468,0x326,0x3f2)](_0x21c9f1[_0x34f69f(0x47,0x3c,0x6a,0x76)],_0x21c9f1[_0x34f69f(0x9a,-0x8,0xcd,0x28)]))throw new Error('获取图片失败,状态码'+':\x20'+_0x15df70[_0x34f69f(0x2b,-0x3b,0x16d,0xa2)]);else{_0x21c9f1[_0x105836(0x409,0x41a,0x367,0x444)](_0x249637,_0x105836(0x36e,0x46d,0x456,0x3bc)+'片数据\x20(jiugu'+_0x34f69f(-0x23,0xd4,0x10f,0x74)+'。');throw new _0x3d6d03(_0x21c9f1[_0x34f69f(0x27b,0x253,0x1f8,0x1cc)]);}}let _0x478276=await _0x15df70['blob']();if(_0x2f0605['isVideo']){if(_0x21c9f1[_0x34f69f(0x7e,0x11,0xb9,0x2e)](_0x21c9f1['ggMQT'],_0x21c9f1[_0x105836(0x408,0x338,0x3fd,0x3a5)]))_0x21c9f1[_0x34f69f(0x14e,0x1ef,0x19c,0x14b)](_0x3b3d41,_0x34f69f(0x83,0x86,0x0,0x53)+'节点处理:\x20'+_0x3782e1[_0x105836(0x41a,0x42f,0x381,0x3c6)]);else{let _0x2ac56c=_0x21c9f1[_0x34f69f(0x14,0x132,0xbf,0x5b)];if(_0x2f0605[_0x105836(0x454,0x466,0x365,0x3d3)]){if(_0x2f0605[_0x34f69f(0x1a6,0x1a5,0xb5,0xdd)]['includes'](_0x21c9f1['VIvIQ']))_0x2ac56c=_0x34f69f(0xa4,0x113,0xc2,0x165);else(_0x2f0605['format']['includes'](_0x34f69f(0x61,0x1ce,0x17d,0xf5))||_0x2f0605[_0x105836(0x375,0x4a7,0x2f7,0x3d3)][_0x105836(0x31a,0x266,0x2b3,0x337)]('h264'))&&(_0x21c9f1[_0x105836(0x368,0x39f,0x3d7,0x3c0)](_0x21c9f1[_0x105836(0x3c0,0x435,0x4c9,0x404)],_0x21c9f1[_0x105836(0x3f0,0x3d2,0x443,0x483)])?_0x2ac56c=_0x21c9f1['ofppH']:_0x2c9d91[_0x105836(0x51b,0x39e,0x51d,0x460)+_0x182a1e+'\x20Prompt']&&(_0x79f974=_0x26f0bd+_0x21c9f1[_0x105836(0x4a3,0x3e0,0x3c4,0x40d)]+_0x21c9f1[_0x34f69f(0x9e,0x12f,0x204,0x139)](_0x3133f9,_0x456223[_0x105836(0x457,0x4f4,0x501,0x460)+_0x1c2801+_0x105836(0x47a,0x4f6,0x4c1,0x46f)])));}const _0x283265=await _0x478276[_0x34f69f(0x1d,0x58,0x50,0x5d)+'r'](),_0x1d4866={};_0x1d4866['type']=_0x2ac56c,_0x478276=new Blob([_0x283265],_0x1d4866),console[_0x34f69f(0x29,0x101,-0x46,0x6f)]('[ComfyUI]\x20'+'视频\x20MIME\x20类型'+_0x34f69f(0x7c,-0x33,0x71,0x7e)+_0x2f0605['format']+'\x20->\x20'+_0x2ac56c);}}_0x39e912=await new Promise((_0x28d686,_0x2a1873)=>{const _0x165f52=new FileReader();function _0x346679(_0x156563,_0x427913,_0x4c8a88,_0x3476cd){return _0x105836(_0x156563-0xf9,_0x427913-0x9d,_0x3476cd,_0x4c8a88- -0xf5);}function _0x2ba780(_0x59b62b,_0x1127a8,_0x402a6b,_0x37aa83){return _0x105836(_0x59b62b-0x6d,_0x1127a8-0x37,_0x37aa83,_0x1127a8-0x1d4);}_0x165f52['onloadend']=()=>_0x28d686(_0x165f52[_0x2ba780(0x58b,0x639,0x6a6,0x6dd)]),_0x165f52[_0x346679(0x3c9,0x349,0x2fe,0x2a7)]=_0x2a1873,_0x165f52[_0x2ba780(0x588,0x5e2,0x670,0x5fa)+_0x2ba780(0x555,0x61a,0x661,0x59a)](_0x478276);});break;}await sleep(-0x2573+0x64*-0xd+0x2e6f*0x1),_0x33420d++;if(_0x21c9f1['lrjrh'](_0x33420d,0x572+-0x22ae+0x2124)){_0x21c9f1[_0x105836(0x383,0x3ed,0x324,0x3e6)](addLog,_0x105836(0x315,0x2f7,0x377,0x335)+'），服务器可能已断开'+'连接。');throw new Error(_0x105836(0x372,0x417,0x3aa,0x3cb)+_0x105836(0x26d,0x2de,0x265,0x321));}}catch(_0xc67b76){if(_0x21c9f1[_0x34f69f(-0x14,0x107,0xb5,0x81)](_0x21c9f1[_0x34f69f(0xbe,0x157,0x81,0x116)],_0x34f69f(0x1a3,0x10a,0x11,0xd4))){_0x1c5961(_0x105836(0x486,0x4d4,0x402,0x428)+'\x20'+_0x59afd0[_0x34f69f(0x152,-0xc,0xab,0xa2)]);throw new _0x422ed6(_0x34f69f(0x151,0xbd,0x171,0x104)+'quest\x20fail'+_0x34f69f(0x17e,0xdc,0x8d,0xf4)+_0x2af426['status']);}else{addLog('轮询时发生异常:\x20'+_0xc67b76);throw _0xc67b76;}}}window[_0x105836(0x345,0x357,0x2cf,0x3a4)]=!![];if(!_0x39e912)throw new Error(_0x21c9f1[_0x105836(0x3da,0x398,0x3d9,0x440)]);const _0x809bd3=window[_0x105836(0x484,0x445,0x441,0x3b3)+_0x105836(0x30f,0x39a,0x3f5,0x348)]?.[_0x105836(0x386,0x3b8,0x3de,0x33a)]||![],_0x584d07=window[_0x105836(0x3bc,0x2ee,0x45b,0x3b3)+_0x105836(0x2c7,0x272,0x286,0x348)]?.['format']||_0x21c9f1[_0x34f69f(0x17b,0x18a,0xb3,0xc9)];return _0x21c9f1[_0x105836(0x321,0x3e0,0x44c,0x387)](addLog,_0x105836(0x304,0x2f0,0x297,0x339)+(_0x809bd3?'视频':'图片')+(_0x34f69f(0x80,0x12e,0xa,0x79)+_0x34f69f(0x1bf,0x130,0x151,0x17d)+'L。')),taskQueue['completeTa'+'sk'](_0x5ef13f,!![]),currentTaskId=null,{'image':_0x39e912,'change':_0x21c9f1[_0x105836(0x38d,0x3f4,0x32f,0x3b0)](_0x28e855,''),'isVideo':_0x809bd3,'format':_0x584d07};}else{const _0x1eea65=new _0x43c0c9();_0x1eea65[_0x105836(0x50a,0x38e,0x474,0x44f)]=()=>_0x2df830(_0x1eea65['result']),_0x1eea65[_0x105836(0x452,0x41e,0x3c9,0x3f3)]=_0x497bf5,_0x1eea65[_0x34f69f(0x1e4,0x5c,0x141,0x118)+_0x34f69f(0x167,0x79,0x206,0x150)](_0x48b1b8);}}}}catch(_0x49a770){window[_0x105836(0x372,0x3c7,0x2ea,0x3a4)]=!![];if(_0x21c9f1[_0x105836(0x476,0x500,0x4b9,0x4b8)](_0x49a770[_0x105836(0x31f,0x335,0x3ac,0x3c6)],_0x21c9f1[_0x34f69f(0x1ef,0x92,0x75,0x143)])){}else{if(_0x21c9f1[_0x105836(0x378,0x47f,0x4ca,0x41a)](_0x21c9f1['yMAxA'],_0x21c9f1[_0x105836(0x3f4,0x3a8,0x3fd,0x34a)]))return _0x719de9;else taskQueue[_0x34f69f(0x1ad,0x1aa,0x193,0x109)+'sk'](_0x5ef13f,![]);}currentTaskId=null,_0x21c9f1[_0x34f69f(0x1bb,0x267,0x10c,0x1bb)](addLog,'图片生成过程中发生错'+_0x105836(0x372,0x344,0x37d,0x346)+_0x49a770[_0x105836(0x44e,0x37d,0x480,0x3c6)]),console[_0x34f69f(0x15f,0xee,0x145,0x160)](_0x21c9f1[_0x34f69f(0x1a8,0x74,0x119,0x135)],_0x49a770);throw _0x49a770;}}async function comfyuigenerate(_0x5a3c1b){const _0x3a0abb={'bTJpl':function(_0x4ce8fc,_0x460495){return _0x4ce8fc(_0x460495);},'wcSZx':_0x1bde63(0x395,0x41d,0x3e1,0x348),'pLyTp':function(_0x46860a,_0xc7f077,_0xc4187f,_0x329256){return _0x46860a(_0xc7f077,_0xc4187f,_0x329256);},'NqSDN':function(_0x1eaa88,_0x52b928){return _0x1eaa88(_0x52b928);},'FTugI':function(_0x5d0ccc,_0x547e45){return _0x5d0ccc(_0x547e45);},'zSVyB':function(_0x41e732,_0x3bbbba){return _0x41e732||_0x3bbbba;},'tnmNW':_0x1bde63(0x3d9,0x372,0x2c7,0x30c)+_0x1bde63(0x4c8,0x3f1,0x34b,0x409)+_0x44d196(0x2be,0x2e8,0x2c9,0x220),'NAhsZ':function(_0x332c9c,_0x16f09d){return _0x332c9c||_0x16f09d;},'arsHj':_0x1bde63(0x39d,0x34b,0x4c0,0x410),'dIkRz':function(_0xf8582a,_0x32e3c8){return _0xf8582a(_0x32e3c8);},'LywqQ':function(_0x55c321,_0x130240){return _0x55c321(_0x130240);},'Ncerk':'Error\x20gene'+'rating\x20ima'+_0x44d196(0x27d,0x248,0x305,0x2eb)};let {id:_0x439211,prompt:_0x3da512,width:_0x271557,height:_0x3928a0,change:_0x4a56e0}=_0x5a3c1b;_0x3a0abb['bTJpl'](addLog,_0x44d196(0x2f1,0x227,0x2a8,0x313)+':\x20'+_0x439211+(_0x44d196(0x300,0x3c9,0x239,0x23c)+':\x20')+_0x3da512+(_0x4a56e0?_0x44d196(0x21b,0x292,0x2ab,0x2e5)+'\x20'+_0x4a56e0:''));if(_0x4a56e0&&_0x4a56e0[_0x1bde63(0x29e,0x3a4,0x256,0x327)](_0x3a0abb['wcSZx'])){bananaGenerate(_0x5a3c1b);return;}function _0x44d196(_0x1cdb07,_0x5893dd,_0x696292,_0x1c2f9c){return _0x2569(_0x1cdb07-0x2,_0x5893dd);}function _0x1bde63(_0x17ce2e,_0xe72542,_0x3a5881,_0x17f236){return _0x2569(_0x17f236-0x171,_0x3a5881);}try{const {image:_0x36567a,change:_0xe21612,isVideo:_0x34a464,format:_0x4d1b64}=await _0x3a0abb[_0x44d196(0x1fc,0x1e2,0x144,0x20b)](generateComfyUIImage,{'prompt':_0x3da512,'width':_0x271557,'height':_0x3928a0,'change':_0x4a56e0});if(extension_settings[extensionName]['cache']!='0'){const _0x305517={};_0x305517[_0x1bde63(0x3ce,0x511,0x538,0x492)]=_0xe21612,_0x305517[_0x1bde63(0x3ed,0x25c,0x297,0x32a)]=_0x34a464,_0x305517[_0x44d196(0x254,0x1e9,0x1ba,0x274)]=_0x4d1b64,await _0x3a0abb['pLyTp'](setItemImg,_0x3da512,_0x36567a,_0x305517),_0x3a0abb[_0x44d196(0x1be,0x12f,0x27b,0x226)](addLog,(_0x34a464?'视频':'图像')+(_0x1bde63(0x3f8,0x327,0x3a2,0x35e)+_0x44d196(0x2d2,0x313,0x239,0x248))+_0x3da512);}else _0x3a0abb[_0x1bde63(0x3e1,0x35b,0x38d,0x42a)](addLog,_0x1bde63(0x2a8,0x30a,0x241,0x304)+'库');eventSource[_0x1bde63(0x2e6,0x3cf,0x416,0x371)](EventType[_0x1bde63(0x45f,0x458,0x4e6,0x469)+_0x44d196(0x29c,0x1d1,0x2cd,0x33c)+_0x1bde63(0x328,0x26f,0x2e1,0x330)],{'id':_0x439211,'success':!![],'imageData':_0x36567a,'prompt':_0x3da512,'change':_0xe21612,'isVideo':_0x3a0abb[_0x1bde63(0x482,0x382,0x333,0x3d7)](_0x34a464,![]),'format':_0x4d1b64||_0x1bde63(0x357,0x41f,0x39a,0x410)}),eventSource[_0x1bde63(0x360,0x385,0x29f,0x371)](_0x3a0abb[_0x1bde63(0x428,0x480,0x456,0x3ce)],{'id':_0x439211,'success':!![],'imageData':_0x36567a,'prompt':_0x3da512,'change':_0xe21612,'isVideo':_0x3a0abb['NAhsZ'](_0x34a464,![]),'format':_0x3a0abb[_0x44d196(0x242,0x1e5,0x2e3,0x21d)](_0x4d1b64,_0x3a0abb[_0x44d196(0x313,0x285,0x254,0x23f)])}),_0x3a0abb[_0x44d196(0x1f1,0x1ec,0x277,0x1d9)](addLog,'发送'+(_0x34a464?'视频':'图片')+(_0x1bde63(0x4c0,0x3e5,0x4f5,0x490)+':\x20')+_0x439211+')');}catch(_0x3e6850){const _0x1fa52f='生图流程捕获到异常\x20'+_0x44d196(0x319,0x26b,0x30d,0x364)+_0x439211+_0x1bde63(0x574,0x56a,0x3f8,0x4b0)+_0x3e6850['message'];_0x3a0abb[_0x44d196(0x1b4,0x177,0x16e,0x13c)](addLog,_0x44d196(0x1ee,0x21b,0x21d,0x1fc)+_0x1fa52f),console[_0x1bde63(0x424,0x4d2,0x4bb,0x446)](_0x3a0abb[_0x1bde63(0x48b,0x4d9,0x520,0x47b)],_0x3e6850);const _0x2f39ad={};_0x2f39ad['id']=_0x439211,_0x2f39ad[_0x44d196(0x1f3,0x25c,0x179,0x277)]=![],_0x2f39ad['error']=_0x3e6850[_0x1bde63(0x355,0x382,0x3b4,0x3b6)],_0x2f39ad[_0x1bde63(0x46e,0x405,0x44c,0x402)]=_0x3da512,eventSource[_0x1bde63(0x43f,0x3b8,0x329,0x371)](EventType[_0x1bde63(0x405,0x3ad,0x53b,0x469)+_0x1bde63(0x42b,0x4a8,0x3d4,0x40b)+_0x44d196(0x1c1,0x239,0x15c,0x289)],_0x2f39ad);const _0x568f85={};_0x568f85['id']=_0x439211,_0x568f85[_0x44d196(0x1f3,0x24c,0x2a3,0x2ad)]=![],_0x568f85[_0x44d196(0x2d7,0x224,0x2cd,0x29c)]=_0x3e6850[_0x44d196(0x247,0x31a,0x1e6,0x21a)],_0x568f85[_0x44d196(0x293,0x299,0x278,0x361)]=_0x3da512,eventSource[_0x44d196(0x202,0x1c9,0x28a,0x138)](_0x44d196(0x19d,0x207,0x1e2,0x1de)+'mage-respo'+_0x44d196(0x2be,0x207,0x2f5,0x2af),_0x568f85),addLog('发送生图失败响应\x20('+'ID:\x20'+_0x439211+')');}}function initializeComfyuiListener(){const _0x1f1d9f={'XMWuk':function(_0x391ac4,_0x181ee6){return _0x391ac4(_0x181ee6);}};eventSource['on'](EventType[_0x4606ba(0x226,0x24a,0x1e6,0x1a8)+_0x2f5521(-0x154,-0xe2,-0xd3,-0x9f)+'ST'],comfyuigenerate);function _0x4606ba(_0x54b58b,_0x469d7d,_0x1f6793,_0x231b25){return _0x2569(_0x231b25- -0x150,_0x469d7d);}function _0x2f5521(_0x128a61,_0x4368a7,_0x3e5e36,_0x50414b){return _0x2569(_0x4368a7- -0x2f5,_0x128a61);}_0x1f1d9f[_0x2f5521(-0x7a,-0xbe,-0x18a,-0x129)](addLog,_0x2f5521(-0xf5,-0x58,-0xa3,0x53)+_0x4606ba(0x148,0x110,0x12a,0x13e)+'含旧版兼容）。');}export async function replaceWithcomfyui(){const _0x29c8ea={'QjpuU':function(_0x4d1dcf,_0x221fae){return _0x4d1dcf==_0x221fae;},'gpARR':_0xbf2e47(0xf1,0x8b,0xa1,0x13b),'JiqBX':function(_0x4d83a1){return _0x4d83a1();},'TwAzN':'comfyui\x20生图'+_0xbf2e47(0xad,0x32,0x8f,0xf6)};function _0x76a15c(_0x526eac,_0x5ae453,_0x4fe7bb,_0x4739f6){return _0x2569(_0x4fe7bb-0x24,_0x526eac);}function _0xbf2e47(_0x241f9d,_0x10ac31,_0x510db6,_0x2e3994){return _0x2569(_0x2e3994- -0xfa,_0x10ac31);}_0x29c8ea[_0xbf2e47(0x185,0x44,0x12c,0x105)](extension_settings[extensionName][_0x76a15c(0x1e9,0x1ea,0x246,0x252)],_0x29c8ea[_0x76a15c(0x32d,0x2c3,0x34f,0x37d)])?(!window[_0xbf2e47(0x139,0x238,0x232,0x1c0)+_0x76a15c(0x1eb,0x1c1,0x26f,0x270)+'tener']&&(window[_0xbf2e47(0x1ce,0x113,0x17f,0x1c0)+_0xbf2e47(0x75,0xa6,0x1db,0x151)+_0x76a15c(0x274,0x213,0x2d3,0x311)]=!![],_0x29c8ea[_0x76a15c(0x2cf,0x2cd,0x2ea,0x235)](initializeComfyuiListener)),initializeImageProcessing()):window[_0xbf2e47(0x218,0x28f,0x1bb,0x1c0)+_0xbf2e47(0x82,0x1e6,0x12e,0x151)+'tener']&&(eventSource['removeList'+_0xbf2e47(0x123,0xc1,0x34,0xc3)](EventType[_0x76a15c(0x37b,0x349,0x31c,0x287)+_0xbf2e47(0x187,0xa0,0x145,0x119)+'ST'],comfyuigenerate),window[_0x76a15c(0x325,0x218,0x2de,0x39c)+_0x76a15c(0x1f4,0x270,0x26f,0x2dc)+_0xbf2e47(0x179,0x1e1,0x268,0x1b5)]=![],addLog(_0x29c8ea[_0xbf2e47(0x135,-0x7,0xa4,0x9c)]));}