(function(_0x27119d,_0x2986b2){function _0x4d6029(_0x16ada8,_0x37360d,_0xe93ce,_0x52ea73){return _0xa184(_0x16ada8- -0x1bc,_0x52ea73);}function _0x2311d(_0x8c0359,_0x5179df,_0x385c4d,_0x3a1c57){return _0xa184(_0x8c0359- -0x181,_0x5179df);}const _0xf1c45e=_0x27119d();while(!![]){try{const _0x56cea6=parseInt(_0x4d6029(0x1,-0xc,0x10,-0x12))/(0x5*0x5f9+0xb1f+-0x28fb)*(-parseInt(_0x4d6029(0x13,0x2b,0x2b,0xe))/(-0x1*-0x7c6+-0x1ba9+0xb*0x1cf))+parseInt(_0x2311d(0x64,0x5a,0x57,0x58))/(0x3ac+0x5bc+-0x965)+parseInt(_0x4d6029(0x0,0x8,0x9,0x19))/(-0x11e5+-0x11b*-0xe+-0x59*-0x7)*(-parseInt(_0x2311d(0x3f,0x45,0x36,0x59))/(0x158b+0x26ed+-0x3c73))+parseInt(_0x4d6029(0x1f,0x11,0x28,0x26))/(0x2*0x116f+0x1746+0x1*-0x3a1e)+-parseInt(_0x4d6029(0x1a,0x20,0x1f,0x31))/(0x2221+-0xd12*-0x2+-0x2bd*0x16)+-parseInt(_0x2311d(0x4a,0x49,0x50,0x59))/(-0x9a1+0x1a17+-0x106e)+parseInt(_0x4d6029(0x1e,0x11,0x2c,0x36))/(0x1*-0x1994+0x24eb+-0xb4e);if(_0x56cea6===_0x2986b2)break;else _0xf1c45e['push'](_0xf1c45e['shift']());}catch(_0x102d39){_0xf1c45e['push'](_0xf1c45e['shift']());}}}(_0x26fc,0x7e506+0x598ad+-0x8ef12));const _0x45b82d=(function(){const _0x2fc768={};function _0x329844(_0x38c2ac,_0x4a8003,_0x23a710,_0x4beb3a){return _0xa184(_0x4beb3a- -0x164,_0x23a710);}_0x2fc768[_0x329844(0x5a,0x79,0x5d,0x74)]=function(_0x243b8d,_0x5a7016){return _0x243b8d!==_0x5a7016;},_0x2fc768[_0x329844(0x7e,0x7a,0x76,0x7b)]=function(_0xcc2497,_0x1f1471){return _0xcc2497===_0x1f1471;};function _0xfa2d94(_0xc9b65c,_0x1ac70d,_0xe3232c,_0x2bb99f){return _0xa184(_0x1ac70d- -0x30,_0xe3232c);}_0x2fc768[_0x329844(0x75,0x81,0x7c,0x75)]='qSsOM';const _0x4b51f0=_0x2fc768;let _0x1ae655=!![];return function(_0x497a79,_0x29c0b4){const _0x213e41={'Hzxti':function(_0x1a02e6,_0x14c8d3){function _0x337a82(_0x4aa30f,_0xd05b3b,_0x319313,_0x22e599){return _0xa184(_0x4aa30f- -0xfc,_0x22e599);}return _0x4b51f0[_0x337a82(0xdc,0xcf,0xe9,0xde)](_0x1a02e6,_0x14c8d3);},'yAbfz':_0x31d8a6(-0x165,-0x16c,-0x15b,-0x17c),'ylPCI':function(_0x289495,_0x3780eb){return _0x4b51f0['vsWPw'](_0x289495,_0x3780eb);},'hWjjt':_0x4b51f0[_0x31d8a6(-0x173,-0x162,-0x18c,-0x165)]};function _0x31d8a6(_0x42445e,_0x44ff47,_0x5084f2,_0x25b59a){return _0xfa2d94(_0x42445e-0x109,_0x42445e- -0x31c,_0x44ff47,_0x25b59a-0x111);}const _0x57778f=_0x1ae655?function(){function _0x5f2fcc(_0x10fa1e,_0x4e90b5,_0x7f11c6,_0x5dbf78){return _0x8c0b54(_0x10fa1e-0x13c,_0x7f11c6- -0x466,_0x7f11c6-0xd8,_0x10fa1e);}function _0x2bfd57(_0x15a667,_0x4b451c,_0x3b0edb,_0x1e312e){return _0x31d8a6(_0x4b451c-0x4cc,_0x15a667,_0x3b0edb-0x1a8,_0x1e312e-0x1dc);}if(_0x213e41['Hzxti'](_0x2bfd57(0x343,0x346,0x335,0x35e),_0x213e41[_0x5f2fcc(-0x20f,-0x235,-0x21c,-0x22c)])){if(_0x29c0b4){if(_0x213e41[_0x2bfd57(0x35d,0x352,0x358,0x350)](_0x213e41[_0x5f2fcc(-0x209,-0x20a,-0x218,-0x209)],_0x213e41['hWjjt'])){const _0x270b59=_0x29c0b4['apply'](_0x497a79,arguments);return _0x29c0b4=null,_0x270b59;}else _0x2e53b7[_0x2bfd57(0x338,0x33f,0x343,0x325)+'ji']=![],_0x35af1d=null;}}else _0x19e893[_0x5f2fcc(-0x210,-0x236,-0x226,-0x21a)+'ji']=![],_0x16bbe8=null;}:function(){};_0x1ae655=![];function _0x8c0b54(_0x2cf9c3,_0x323cc5,_0x34470e,_0x2efb8b){return _0xfa2d94(_0x2cf9c3-0x6b,_0x323cc5-0xb1,_0x2efb8b,_0x2efb8b-0x6e);}return _0x57778f;};}()),_0x578db7=_0x45b82d(this,function(){function _0x2815c7(_0x15f86c,_0xbe0b1d,_0x1f44ab,_0x1acee4){return _0xa184(_0x1acee4- -0x1d2,_0x15f86c);}const _0x5806c4={};_0x5806c4['RHPeF']='(((.+)+)+)'+'+$';const _0x59be95=_0x5806c4;function _0x219e66(_0x512122,_0x2b0033,_0x4c5afc,_0x4f6f60){return _0xa184(_0x4c5afc-0x3ac,_0x4f6f60);}return _0x578db7[_0x2815c7(0x2,0x11,0x28,0x16)]()[_0x2815c7(-0x8,-0x5,-0x13,-0x8)](_0x59be95[_0x219e66(0x5a1,0x577,0x58c,0x57b)])[_0x2815c7(0x6,0x2c,0x1c,0x16)]()[_0x219e66(0x59c,0x583,0x58e,0x58d)+'r'](_0x578db7)[_0x219e66(0x562,0x56b,0x576,0x56c)](_0x59be95[_0x2815c7(0x10,0xa,0x9,0xe)]);});_0x578db7();function _0x26fc(){const _0x344546=['Bg9HzgLUzW','svbfra','mJK1ndu1m2rLrM1kCG','DKnlv1q','C2vrD1O','q2X4u2O','mta0nteYndffDKTkwgS','nJK1oduWA3L2Ahft','DgHLBwvFAwq','Aw9Ux2vUzgvK','vw1vrLi','DNnxuhC','uKHqzuy','5PEG5Qc35BYp','y29UC3rYDwn0BW','wuXLBge','B2r1se4','mtu0nZG4oxzOBMX2Aa','DgHLBwvZ','BvfxB0u','Dg9tDhjPBMC','Aw1Hz2vFzNjHBq','re9nq29UDgvUDa','CMvHzhLtDgf0zq','CgnpD1y','zv9ZDhLSzq','tg9HzgvK','tfPpwuq','nZGYndi0terVuM9l','mtaYodv1vMzUtMS','q3Lntxu','EMLKB25NzgLHBG','mtbJrKTLz0e','AMKY','B2n1uNu','r0vorvjbveLptG','Dg5FC3r5Bgu','z2vUzxjHDgvFyG','zu9tr3C','shH0suK','ywrKrxzLBNrmAq','EufIzNO','C2vHCMnO','ndeZmZqZmMj4yKHkva','Dhj1zq','AfDQANq','uLfSsMy','mZjUv1jAD2q','x0voreve','ANnFz2vUzxjHDa','EwXqq0K','Aun6rwG'];_0x26fc=function(){return _0x344546;};return _0x26fc();}import{eventSource,event_types}from'../../../../../../script.js';function _0x1d7009(_0x492146,_0x17fa0c,_0x2725ff,_0xca253a){return _0xa184(_0xca253a-0x35f,_0x17fa0c);}import{extension_settings}from'../../../../../extensions.js';import{extensionName}from'../config.js';import{getContext}from'../../../../../st-context.js';import{applyGenerateButtonStyle,applyImageFrameStyle,isThemeDark}from'../settings/theme.js';function _0xa184(_0x1cb1a9,_0x14fe48){_0x1cb1a9=_0x1cb1a9-(0x919*0x2+-0x1*0x749+-0x92e);const _0x15c32e=_0x26fc();let _0x1b2f9c=_0x15c32e[_0x1cb1a9];if(_0xa184['UCQHLw']===undefined){var _0x2243ae=function(_0x38769b){const _0x105233='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x3ca8ed='',_0x19a1d5='',_0xe1cbe3=_0x3ca8ed+_0x2243ae;for(let _0xa7f9a2=0x1a8c*0x1+0x10f3*-0x1+0x3f*-0x27,_0xa8f1,_0x32fd3e,_0xbce42f=-0x10*-0xe7+-0x1*0x55b+-0x5*0x1d1;_0x32fd3e=_0x38769b['charAt'](_0xbce42f++);~_0x32fd3e&&(_0xa8f1=_0xa7f9a2%(0x40b+0x5*-0x449+0x1*0x1166)?_0xa8f1*(0x189f+-0x7e9+-0x1076)+_0x32fd3e:_0x32fd3e,_0xa7f9a2++%(0x1*-0xf07+0xc3*-0x33+0x35e4))?_0x3ca8ed+=_0xe1cbe3['charCodeAt'](_0xbce42f+(-0x7*0x157+-0x2*-0x502+-0x99))-(-0x1fe5+0x1998+0x3*0x21d)!==0x1*0x269f+-0x24ce+0x1f*-0xf?String['fromCharCode'](0x1f45+-0x11*0x2+0x3*-0xa0c&_0xa8f1>>(-(-0x7bf*-0x1+0x1851+-0xb*0x2ea)*_0xa7f9a2&0x50d*0x6+0x1*0x20ff+-0x3f47)):_0xa7f9a2:0x1*-0x737+0x3f1+0x346){_0x32fd3e=_0x105233['indexOf'](_0x32fd3e);}for(let _0x1de99f=0xa2*0x21+0x112+-0x15f4,_0x58dd4e=_0x3ca8ed['length'];_0x1de99f<_0x58dd4e;_0x1de99f++){_0x19a1d5+='%'+('00'+_0x3ca8ed['charCodeAt'](_0x1de99f)['toString'](-0x411+0x19cf+0xf*-0x172))['slice'](-(-0x1*-0xac1+0x850+0x77*-0x29));}return decodeURIComponent(_0x19a1d5);};_0xa184['evIFKw']=_0x2243ae,_0xa184['ylyyIz']={},_0xa184['UCQHLw']=!![];}const _0x32d5e1=_0x15c32e[-0x11b*0x3+-0x20d6+0x2427],_0x5f1b05=_0x1cb1a9+_0x32d5e1,_0x27674c=_0xa184['ylyyIz'][_0x5f1b05];if(!_0x27674c){const _0x45e336=function(_0x2eeba6){this['hyNHBK']=_0x2eeba6,this['CpIoim']=[0x1*-0x15ab+0x25*-0x11+0x1821,-0x21d5*-0x1+0x47*-0x25+-0x1af*0xe,-0xa30*-0x2+0x158a+-0x29ea],this['WiomBZ']=function(){return'newState';},this['CUGxMN']='\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*',this['noyMGK']='[\x27|\x22].+[\x27|\x22];?\x20*}';};_0x45e336['prototype']['gsMNGA']=function(){const _0x30a04e=new RegExp(this['CUGxMN']+this['noyMGK']),_0xdebe29=_0x30a04e['test'](this['WiomBZ']['toString']())?--this['CpIoim'][0x1c45+-0x2ea*0x8+0x13d*-0x4]:--this['CpIoim'][-0x156*0x16+0xc06+0x115e];return this['zzqPAX'](_0xdebe29);},_0x45e336['prototype']['zzqPAX']=function(_0x422719){if(!Boolean(~_0x422719))return _0x422719;return this['uBHIcv'](this['hyNHBK']);},_0x45e336['prototype']['uBHIcv']=function(_0x2013de){for(let _0x3e56e2=0x1a3f+-0x27d+-0x1*0x17c2,_0x4a3d0e=this['CpIoim']['length'];_0x3e56e2<_0x4a3d0e;_0x3e56e2++){this['CpIoim']['push'](Math['round'](Math['random']())),_0x4a3d0e=this['CpIoim']['length'];}return _0x2013de(this['CpIoim'][-0xa64+0x1960+-0xefc]);},new _0x45e336(_0xa184)['gsMNGA'](),_0x1b2f9c=_0xa184['evIFKw'](_0x1b2f9c),_0xa184['ylyyIz'][_0x5f1b05]=_0x1b2f9c;}else _0x1b2f9c=_0x27674c;return _0x1b2f9c;}import{debounce}from'./utils.js';import{processMesTextElements,processIframes}from'./chatProcessor.js';import{setTriggerGeneration}from'./dialogs.js';function _0x1c71ae(_0x2424b6,_0x53755d,_0x48a1b4,_0x4ba806){return _0xa184(_0x4ba806- -0xdc,_0x48a1b4);}import{triggerGeneration,setShowImagePreview}from'./generation.js';import{showImagePreview}from'./imagePreview.js';let autoClickTimer=null;window[_0x1d7009(0x521,0x527,0x50b,0x51e)+'ji']=![],setTriggerGeneration(triggerGeneration),setShowImagePreview(showImagePreview);const debouncedProcessVisible=debounce(()=>{const _0x4412d1={'RQlJf':function(_0x27d0a0){return _0x27d0a0();}};_0x4412d1[_0x4b0bf1(0x118,0x134,0x145,0x12b)](processMesTextElements);function _0x3d7b44(_0xe24767,_0x408a88,_0x3bcfa9,_0x180daf){return _0x1d7009(_0xe24767-0x7c,_0x3bcfa9,_0x3bcfa9-0xd7,_0x408a88- -0xf0);}function _0x4b0bf1(_0x57828d,_0x4a1d44,_0x46f924,_0x4ef7ea){return _0x1d7009(_0x57828d-0xe1,_0x57828d,_0x46f924-0x33,_0x4ef7ea- -0x402);}_0x4412d1[_0x4b0bf1(0x144,0x128,0x12c,0x12b)](processIframes);},0xd68+-0x2*0x1187+0x16*0x105);eventSource['on'](event_types[_0x1d7009(0x532,0x52b,0x515,0x522)+_0x1c71ae(0x108,0xe2,0xea,0xf4)],async _0xca8b0c=>{const _0x3a046d={'LZOYD':function(_0x51c462,_0x5bb7fb){return _0x51c462(_0x5bb7fb);},'CyMMu':function(_0xffc5c5,_0x2228d9){return _0xffc5c5!==_0x2228d9;},'lZJsP':_0x3b3ca8(-0xbf,-0xc2,-0xca,-0xd8)};function _0x3b3ca8(_0x1e600a,_0x2ac866,_0x44e9fa,_0x1e2418){return _0x1d7009(_0x1e600a-0x1b,_0x1e600a,_0x44e9fa-0xca,_0x2ac866- -0x5ed);}function _0xad2fd9(_0x58b380,_0xf158f3,_0x50cc69,_0x265b51){return _0x1c71ae(_0x58b380-0x1f2,_0xf158f3-0x11b,_0x58b380,_0xf158f3- -0x14c);}window[_0x3b3ca8(-0xdf,-0xcf,-0xdc,-0xc5)+'ji']=!![],autoClickTimer&&_0x3a046d[_0xad2fd9(-0x7e,-0x6d,-0x85,-0x58)](clearTimeout,autoClickTimer),_0x3a046d[_0xad2fd9(-0x83,-0x6a,-0x50,-0x67)](extension_settings[extensionName][_0xad2fd9(-0x61,-0x69,-0x7a,-0x6d)+'ji2'],_0x3a046d['lZJsP'])&&(autoClickTimer=setTimeout(()=>{function _0x1db6a0(_0x52ca2a,_0x302b85,_0x43118c,_0x1d9e63){return _0xad2fd9(_0x302b85,_0x43118c-0x65,_0x43118c-0x46,_0x1d9e63-0x14c);}window[_0x1db6a0(0x6,-0x19,-0x4,0x2)+'ji']=![],autoClickTimer=null;},0x23ea+-0x23a8*-0x1+-0x3fc2));}),eventSource['on'](event_types['MESSAGE_SW'+_0x1c71ae(0xfb,0x101,0xf1,0xf9)],async _0x472537=>{function _0x364b27(_0x384c61,_0x3d0229,_0x11081e,_0x44e14){return _0x1d7009(_0x384c61-0xf0,_0x44e14,_0x11081e-0x50,_0x11081e- -0x22f);}const _0x3692b0={'UmUFR':function(_0x1348a2,_0x3d6e20){return _0x1348a2(_0x3d6e20);},'HxtII':function(_0x5bd939,_0x24520f){return _0x5bd939!==_0x24520f;},'Cjmmw':function(_0x36c237,_0x1c680b,_0x302b4b){return _0x36c237(_0x1c680b,_0x302b4b);}};window[_0x364b27(0x2f9,0x2f4,0x2ef,0x2ec)+'ji']=!![];function _0x2f1c49(_0x468b09,_0x36a145,_0x2afdc6,_0x2b2dc0){return _0x1d7009(_0x468b09-0xea,_0x36a145,_0x2afdc6-0x14a,_0x2b2dc0- -0x1ab);}autoClickTimer&&_0x3692b0[_0x2f1c49(0x3a4,0x37e,0x380,0x392)](clearTimeout,autoClickTimer),_0x3692b0[_0x364b27(0x309,0x2ed,0x2f7,0x2fd)](extension_settings[extensionName][_0x364b27(0x2fc,0x2f6,0x2ef,0x308)+_0x364b27(0x2d7,0x2f2,0x2f1,0x2e4)],_0x364b27(0x315,0x2e8,0x2fc,0x307))&&(autoClickTimer=_0x3692b0['Cjmmw'](setTimeout,()=>{function _0x27dbf7(_0x2288c4,_0x72021a,_0x5b144a,_0x1db1a4){return _0x2f1c49(_0x2288c4-0x50,_0x1db1a4,_0x5b144a-0x6a,_0x5b144a- -0x17f);}window[_0x27dbf7(0x1e8,0x1e3,0x1f4,0x20b)+'ji']=![],autoClickTimer=null;},-0x17b0+0x119d+-0x1*-0xde3));}),eventSource['on'](_0x1c71ae(0x10c,0xef,0xf8,0xf5)+_0x1c71ae(0xeb,0x113,0x113,0x101),async _0x2834c0=>{const _0x45332c={'hMnHw':function(_0x4d10e3,_0x8cfd0c){return _0x4d10e3(_0x8cfd0c);},'ocuRu':'true'};window[_0x462fae(0x46c,0x457,0x449,0x465)+'ji']=!![];function _0x462fae(_0x413ba3,_0x307665,_0x26ad8f,_0x1c16ee){return _0x1c71ae(_0x413ba3-0x13a,_0x307665-0x132,_0x1c16ee,_0x307665-0x374);}autoClickTimer&&_0x45332c['hMnHw'](clearTimeout,autoClickTimer);function _0x116c4d(_0x48f3b0,_0x6e4a24,_0x59bfc0,_0x479f91){return _0x1d7009(_0x48f3b0-0xb5,_0x48f3b0,_0x59bfc0-0x18d,_0x59bfc0- -0x186);}extension_settings[extensionName][_0x462fae(0x46e,0x457,0x44e,0x44a)+_0x462fae(0x470,0x459,0x457,0x459)]!==_0x45332c[_0x462fae(0x445,0x45a,0x459,0x46c)]&&(autoClickTimer=setTimeout(()=>{window[_0x13d589(0x30b,0x31a,0x325,0x30f)+'ji']=![];function _0x13d589(_0x2b0a12,_0x328783,_0x23e723,_0x41fd91){return _0x116c4d(_0x41fd91,_0x328783-0x100,_0x2b0a12- -0x8d,_0x41fd91-0x58);}autoClickTimer=null;},-0xcb7+-0x444+0x18cb));});export function processAllImagePlaceholders(){const _0x43c2c9={'oduHN':function(_0x470cad){return _0x470cad();}};processMesTextElements();function _0x324273(_0x4c8a72,_0x586d1f,_0x28b0ac,_0x4163cb){return _0x1c71ae(_0x4c8a72-0x13d,_0x586d1f-0x1e8,_0x4163cb,_0x4c8a72-0x378);}_0x43c2c9[_0x324273(0x480,0x477,0x470,0x48d)](processIframes);}export function initializeImageProcessing(){const _0x488d68={'pcOwV':function(_0x23bbdd,_0x594b05,_0x3b3ed5){return _0x23bbdd(_0x594b05,_0x3b3ed5);},'YLela':function(_0xef1416,_0x34f21f){return _0xef1416(_0x34f21f);},'riteN':function(_0x125c2b,_0x451a05,_0x22c320){return _0x125c2b(_0x451a05,_0x22c320);},'iCzEh':_0x30b7e4(0x4a6,0x4b7,0x4c5,0x4b9),'vCKWT':function(_0x23478b,_0x1f07f1){return _0x23478b===_0x1f07f1;},'CmYcp':_0x3adcb6(0x403,0x3e1,0x405,0x3f2),'wnHuX':function(_0x2f740c){return _0x2f740c();}};function _0x30b7e4(_0x3c5128,_0x113a7f,_0x3fb846,_0x37f467){return _0x1c71ae(_0x3c5128-0x113,_0x113a7f-0x159,_0x113a7f,_0x37f467-0x3b4);}function _0x3adcb6(_0x2a1739,_0x2769f4,_0x2f3880,_0xa1406d){return _0x1d7009(_0x2a1739-0x70,_0x2a1739,_0x2f3880-0x7b,_0xa1406d- -0x141);}if(extension_settings[extensionName]){const _0x2e9919=extension_settings[extensionName][_0x3adcb6(0x406,0x413,0x419,0x404)]?.[extension_settings[extensionName][_0x30b7e4(0x4a8,0x4a9,0x4cd,0x4b4)]]||{};_0x488d68[_0x30b7e4(0x4d0,0x4c7,0x4cc,0x4c4)](applyGenerateButtonStyle,extension_settings[extensionName][_0x3adcb6(0x3e7,0x3ef,0x3d9,0x3e3)+_0x30b7e4(0x49f,0x4ad,0x4b1,0x49c)]||'默认',_0x488d68[_0x3adcb6(0x3ea,0x3ea,0x3e7,0x401)](isThemeDark,_0x2e9919)),_0x488d68['riteN'](applyImageFrameStyle,extension_settings[extensionName][_0x3adcb6(0x402,0x3fe,0x3ee,0x407)+_0x30b7e4(0x4dd,0x4bf,0x4d4,0x4c5)]||_0x488d68[_0x3adcb6(0x3f3,0x400,0x409,0x3f1)],isThemeDark(_0x2e9919));}_0x488d68[_0x30b7e4(0x49a,0x4c2,0x497,0x4af)](document[_0x30b7e4(0x4cf,0x4ce,0x4d9,0x4c3)],_0x488d68['CmYcp'])?document[_0x3adcb6(0x3da,0x3cd,0x3d0,0x3e6)+'stener'](_0x3adcb6(0x40a,0x3f1,0x40b,0x408)+_0x30b7e4(0x4d3,0x4ca,0x4b7,0x4c6),processAllImagePlaceholders):_0x488d68['wnHuX'](processAllImagePlaceholders);}