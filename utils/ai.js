(function(_0x47b1de,_0x499ebf){const _0x3f929e=_0x47b1de();function _0x2ac35c(_0x38012b,_0x288f78,_0x391a91,_0x522978){return _0x3370(_0x391a91- -0x2be,_0x522978);}function _0x1cf902(_0x27d140,_0x83277d,_0x4a2a31,_0x6148f3){return _0x3370(_0x83277d- -0x5f,_0x6148f3);}while(!![]){try{const _0x5258bc=parseInt(_0x1cf902(0xea,0x130,0x127,0x148))/(-0x13f6+-0x83*-0x7+-0x2*-0x831)+-parseInt(_0x2ac35c(-0xfd,-0x147,-0x15c,-0x166))/(0x19be+0x2325*-0x1+0x969)*(-parseInt(_0x1cf902(0xaa,0xe0,0xaf,0xab))/(0x15c*-0x4+0x17*0x3b+-0x13*-0x2))+parseInt(_0x1cf902(0x5f,0x92,0x68,0x80))/(-0xe*0xd+0x1227+-0x116d*0x1)+-parseInt(_0x2ac35c(-0x1e5,-0x18e,-0x1db,-0x1c4))/(0x511*0x1+0x1858*0x1+-0x1d64)+parseInt(_0x1cf902(0xa5,0xec,0xf7,0x119))/(0x90e+-0x1b19+0x1211)*(parseInt(_0x2ac35c(-0x17a,-0x15a,-0x179,-0x156))/(-0x1d65*-0x1+-0x1*-0xd6f+-0x2acd))+parseInt(_0x1cf902(0x101,0xdc,0x9f,0x10d))/(0xdbb+0x233*0x11+0x1a*-0x1f7)*(-parseInt(_0x1cf902(0xfe,0x126,0x172,0x174))/(-0x1428+0x4*0x5bb+0x3*-0xe9))+parseInt(_0x2ac35c(-0x157,-0x121,-0x12d,-0x13f))/(0x350*-0x2+0xd57+-0x6ad*0x1)*(-parseInt(_0x2ac35c(-0x154,-0x187,-0x16f,-0x116))/(-0x29*0xc7+-0x12ba+0x32a4));if(_0x5258bc===_0x499ebf)break;else _0x3f929e['push'](_0x3f929e['shift']());}catch(_0x4a9ca3){_0x3f929e['push'](_0x3f929e['shift']());}}}(_0x4011,-0xc*-0xe14a+0x67513+-0x81981));const _0x46927a=(function(){let _0x477687=!![];return function(_0x2c14a5,_0x329c66){const _0x1aec0d=_0x477687?function(){function _0x279a54(_0xf62771,_0x594924,_0x46f2e0,_0x3b9198){return _0x3370(_0x3b9198-0x1d9,_0xf62771);}if(_0x329c66){const _0x4ef39e=_0x329c66[_0x279a54(0x312,0x295,0x2c4,0x2ba)](_0x2c14a5,arguments);return _0x329c66=null,_0x4ef39e;}}:function(){};return _0x477687=![],_0x1aec0d;};}()),_0x381092=_0x46927a(this,function(){const _0x18471b={};function _0x2358ad(_0x394a92,_0x1d7648,_0x65d6f8,_0x3db4a4){return _0x3370(_0x1d7648-0x1d1,_0x65d6f8);}function _0x2db161(_0x5770fa,_0x523826,_0x48fbe9,_0x7e207b){return _0x3370(_0x5770fa- -0xf2,_0x48fbe9);}_0x18471b[_0x2db161(0x3f,0x45,0x5a,0x69)]=_0x2358ad(0x313,0x2d7,0x283,0x2be)+'+$';const _0xdfbb56=_0x18471b;return _0x381092[_0x2db161(0x27,0x48,0x57,-0x4)]()[_0x2358ad(0x386,0x32c,0x353,0x388)](_0xdfbb56[_0x2db161(0x3f,0x8f,0x2c,0x6e)])[_0x2358ad(0x33d,0x2ea,0x2af,0x30a)]()[_0x2db161(0x62,0x1e,0xa8,0x4a)+'r'](_0x381092)[_0x2db161(0x69,0x7a,0x81,0x9b)](_0x2db161(0x14,0x5c,-0x28,0x5e)+'+$');});_0x381092();import{extension_settings}from'../../../../extensions.js';import{saveSettingsDebounced,eventSource}from'../../../../../script.js';import{extensionName,eventNames}from'./config.js';import{addLog}from'./utils.js';import{updateCombinedPrompt}from'./settings/llm.js';import{buildPromptForRequestType}from'./settings/llmService.js';import{mergeAdjacentMessages}from'./promptProcessor.js';let settings;const SD_SYMBOL_PATTERN=/^([\(\[\{<]+)?(.*?)([\)\]\}>]+)?(:[\d.]+)?$/,SKIP_PATTERNS=[/^<lora:/i,/^<lyco:/i,/^<hypernet:/i,/^[\d.:]+$/,/^$/,/^\$.*\$$/];function _0x4011(){const _0x44477e=['iow3SUIoT+wpLUE/U+IVKEApKoEKUUIVJsa','BwvZC2fNzq','ww1tuNG','EuvRuwy','AxnbCNjHEq','qwjVCNrfCNjVCG','zvP0D2i','q2Tbr08','twzACNy','BNLfq2C','yKrtD1G','zxjYB3i','vNDlr1y','r21evui','6i635y+w57+76k+r5O+q56s66k+n6lAf5PE2','57+76k+r5AsX6lsLoIa','Afjnthu','Dg9mB3DLCKnHCW','ohfKsu1xDq','ChvZAa','DNnwBLy','D2fYBG','mtaWnZDktKHsDu0','rLrJwMW','iefjioIUVUE9RUw3SUE7N+s4GowiSa','v0HPthu','BgXWA04','teXnx1rsqu5tta','n0HHANjnrG','B0TtALy','wNPnwKy','CM9Szq','v0DbChq','BwfW','mJGWmte3ogv5vvniBa','zgLZCgXHEvrLEa','DgvZDa','rvnu','mJmYndyZvvr4B3DX','vuvtva','CMfUzg9Tvvvjra','uxnKDha','D0XmyKy','y29UC3rYDwn0BW','EhzSzMe','C3bSAxq','DxnLCG','CwXgAxi','CgfYC2u','zMLSDgvY','C2vHCMnO','vwffu0y','AMvdt0i','ywX0BKO','y29UDgvUDa','CvvtAhK','BM93','mZaYvgPys1zm','uwnOuLG','BgvUz3rO','C3qTy2HHDhu4oG','zw1PDa','sw1LDMC','ue9ou0u','keLeoIa','B3jPz2LUywW','vKLfC3m','CMvTB3zLtgLZDa','yLz2tfu','r2rtzwO','ieXmtsdORR7NVA7POBxPNAi','rMnnqwq','C3rYAw5NAwz5','wePXq1e','A1LQr2W','zw5LCG','CMfUzg9T','CK9wEfu','zw50CMLLCW','CMvZDwX0CW','Aw5KzxHpzG','tw5Mr2y','BMfTzq','Bg9N','wM96uhi','DLj2qve','rvbPqLO','y2XLyw5Lza','qvrjt05FuKvtua','zvflvLO','C2v0','zuLJAvq','mZG4mJi5nhzythHtrq','suH1CgC','wMr2rgm','tNzLDMi','vNjpDNm','BuPTvxq','u2zNveC','B2jQzwn0','t05trq','y2zAD1K','nta1nJm4ufn3qKru','D09xvLm','ndeWuLDxuxvc','icHjrdOG','rNftq3e','57+76k+r5AsX6lsLoG','sM1Mvhm','AgHyEMW','Bvzsrvi','zwfNCvy','iePtt07OP6pMNPdLPlhOTkxVViW','zufgq0i','ruz2wNi','AM9PBG','DhjPBq','yxbWBhK','A0P4CuO','mJeZoda5nuPzqM1syW','ufjptvbux1jfuW','sKL3vLK','DMjkA0K','ALrhqKe','swX5s1y','A29vyNy','D3v5ENu','wLPkuvi','vLDVwe0','wvHbDK4','iow3SUAuTUwiSoE/U+IVKsbmte0','uuLgy24','C2TPChbLza','mZmYmdC0ngL0wfPAAq','ioIVT+AXGUIoT+wpLUE/U+IVKEApKoEKUUIVJq','CurJyuG','CMvZDwX0','AejLrMW','C2v3wfu','D1PisLO','BxpVViK','BLL1r1K','u0LlENC','u05oALG','qMrrz1e','C3rYAw5N','t1Hvt04','qvrjt05Fr0vuxW','q1zeEvm','sMTIs3e','q1nzz3O','weDwvLu','DvDqDhq','u3noqwu','kcGOlISPkYKRkq','ioE/U+IVKEApKoEKUUIVJEAGH+ETVUwKSEI0Pq','qvrjt05FuKvrvq','C3vIC3rYAw5N','uurmrgG','vg14yxa','qwfUuuS','CuHYt3G','y3fmC2q','y1vYs2q','ufjptvbux1jfuq','v1LOqw4','CLvjqNa','svzirKS','wuvMuKK','C2XPy2u','ELPnsMy','yNbzBuO','C29Tzq','Dg9tDhjPBMC','vwXPANu','z2vXthy','DhjHBNnSyxrPBW','B3jPz2LUywXuyq','DgfjEKO','qu9ewfC','CMvWBgfJzq','BffAANy','rgnQtuq','wgPrEuC','57+76k+rieXmtsdMIAFOOyZOTOu','BMfvqM4','v09tBMq','Bwf0y2G','C2TPCa'];_0x4011=function(){return _0x44477e;};return _0x4011();}function shouldSkipTranslation(_0x5d8699){function _0x399349(_0x3dd0ab,_0x41e4d5,_0x2d09e8,_0x220643){return _0x3370(_0x220643-0x3c,_0x3dd0ab);}function _0x13a29c(_0x59267e,_0x2f149e,_0x5f79dd,_0x4bf2a4){return _0x3370(_0x4bf2a4- -0x171,_0x2f149e);}return SKIP_PATTERNS[_0x399349(0x10c,0x184,0x173,0x154)](_0x149787=>_0x149787[_0x399349(0x1b2,0x1d2,0x1c3,0x189)](_0x5d8699[_0x13a29c(-0xe5,-0xb2,-0xcd,-0x91)]()));}export function tagsToJsonString(_0x4d9de8){function _0x50aff1(_0xa2869a,_0x395cb7,_0x1f112e,_0xfad888){return _0x3370(_0xfad888- -0x3e6,_0xa2869a);}if(!Array[_0x510460(0x484,0x4d9,0x4da,0x46f)](_0x4d9de8))return'[]';function _0x510460(_0x357353,_0x3d3e16,_0x1b75d7,_0x5dac78){return _0x3370(_0x357353-0x357,_0x3d3e16);}return JSON[_0x50aff1(-0x296,-0x2d2,-0x2ab,-0x275)](_0x4d9de8[_0x50aff1(-0x2c3,-0x299,-0x2be,-0x28c)](_0x598c4b=>_0x598c4b&&typeof _0x598c4b===_0x510460(0x454,0x453,0x405,0x463)));}export function preprocessPromptForTranslation(_0x17b174){const _0x2e4f9c={'kJxqJ':function(_0x2dbb0a,_0x58128e){return _0x2dbb0a===_0x58128e;},'hhXzl':_0x599d74(-0x206,-0x1aa,-0x1ae,-0x1fb),'cfZwY':function(_0x21d91e,_0x33cff5){return _0x21d91e(_0x33cff5);},'uWPtt':_0x599d74(-0x1de,-0x1b6,-0x1f7,-0x1f8),'vbJkI':function(_0x19be77,_0x303555){return _0x19be77<_0x303555;},'NBxEf':_0x599d74(-0xf1,-0x170,-0x14c,-0x137),'kzrVV':'SQuZa','AanQK':function(_0x2f03c5,_0x146fa8){return _0x2f03c5===_0x146fa8;},'llpkN':function(_0x387117,_0x9dd085){return _0x387117===_0x9dd085;},'hBeFl':_0x599d74(-0x210,-0x1fc,-0x1e6,-0x1d8),'hRMLu':_0x3d951f(0x224,0x245,0x29a,0x295),'taIzJ':function(_0x24e531,_0x1cd98a){return _0x24e531!==_0x1cd98a;},'lQZjv':_0x3d951f(0x209,0x1ad,0x1f7,0x1e7),'YXAvN':function(_0x1a3a5f,_0x419f70){return _0x1a3a5f(_0x419f70);},'FcMAd':function(_0x237b3c,_0xda3460){return _0x237b3c!==_0xda3460;},'CSYgz':'wLLbF','qDcaH':function(_0x58bf4f,_0x51829a){return _0x58bf4f(_0x51829a);}};if(!_0x17b174||_0x2e4f9c[_0x3d951f(0x1ce,0x1ce,0x190,0x1c8)](typeof _0x17b174,_0x2e4f9c[_0x599d74(-0x1e7,-0x20c,-0x1bb,-0x1e1)]))return{'originalTags':[],'cleanedTags':[],'cleanedText':'','tagMap':new Map()};const _0x2769df=_0x3f7ae2=>{const _0x4c9838={'YEfRI':function(_0x69e4c8,_0x3fc859){function _0x3ea1d9(_0x177712,_0x4a74ae,_0x2ba888,_0x1a908b){return _0x3370(_0x1a908b- -0x15c,_0x177712);}return _0x2e4f9c[_0x3ea1d9(-0x8f,-0x6b,-0x38,-0x7a)](_0x69e4c8,_0x3fc859);},'GdSej':_0x2e4f9c[_0x1b23a5(0x8,0xc,0x14,0x25)],'JkbKq':function(_0x50605b,_0x5721cc){function _0x184e05(_0xcb567a,_0x3f0aea,_0x227b54,_0x3b485c){return _0x1b23a5(_0xcb567a-0xa4,_0x3b485c,_0x227b54-0x38,_0x3f0aea-0x2ba);}return _0x2e4f9c[_0x184e05(0x327,0x2d7,0x2a8,0x296)](_0x50605b,_0x5721cc);},'mVRER':function(_0x35efbc,_0x67d20a){return _0x35efbc(_0x67d20a);}};function _0x1b23a5(_0x3b8e07,_0x3de8c6,_0x4698d5,_0x531ba0){return _0x599d74(_0x3b8e07-0xd5,_0x3de8c6-0x1d8,_0x531ba0-0x16b,_0x3de8c6);}function _0x58d475(_0x390f1a,_0x50d0a3,_0x36d009,_0x3d8de7){return _0x599d74(_0x390f1a-0x36,_0x50d0a3-0x1e8,_0x50d0a3-0x469,_0x3d8de7);}if(_0x1b23a5(-0x83,-0x92,-0x1b,-0x4f)!==_0x2e4f9c[_0x1b23a5(-0xcb,-0x19,-0x47,-0x6d)]){const _0x52e600=[];let _0x27ef52='',_0x56e92b=![];for(let _0x33ae58=0x1*0x256b+-0x11*-0x19+-0x2714;_0x2e4f9c[_0x1b23a5(-0xb0,-0x9a,-0x6a,-0x8b)](_0x33ae58,_0x3f7ae2[_0x1b23a5(-0x66,0x4d,-0x5a,-0xd)]);_0x33ae58++){if(_0x2e4f9c['kJxqJ'](_0x2e4f9c['NBxEf'],_0x2e4f9c['kzrVV']))for(const [_0x5d70c8,_0x7cd3c6]of _0x2a3e9a[_0x1b23a5(0x59,-0x2f,0xb,0x6)](_0x354698)){_0x36b78d[_0x5d70c8['toLowerCas'+'e']()]=_0x7cd3c6;}else{const _0x4d2a5d=_0x3f7ae2[_0x33ae58];if(_0x2e4f9c[_0x1b23a5(-0x20,-0xa8,-0x2f,-0x65)](_0x4d2a5d,'$')){if(_0x2e4f9c[_0x58d475(0x2c2,0x2d0,0x28b,0x2a0)](_0x2e4f9c[_0x1b23a5(-0x82,-0x5e,-0x56,-0x7c)],_0x2e4f9c[_0x58d475(0x30b,0x2c6,0x2be,0x308)])){if(_0x499eaf['error']&&_0x4c9838[_0x58d475(0x27f,0x2a1,0x2ed,0x292)](_0x1bae53[_0x58d475(0x2db,0x2c1,0x294,0x266)][_0x1b23a5(0x55,0x5a,0x66,0xa)],'AbortError')){const _0x14ec54=new _0x154066(_0x3b2ac4['error']['message']);_0x14ec54[_0x1b23a5(0x56,0x4f,0x20,0xa)]=_0x4c9838[_0x58d475(0x2b0,0x2fb,0x353,0x34d)],_0x32b5e3(_0x14ec54);}else _0x1d4cdf(new _0x429e71(_0x352376[_0x58d475(0x2ac,0x281,0x272,0x22c)]));}else _0x56e92b=!_0x56e92b,_0x27ef52+=_0x4d2a5d;}else{if((_0x4d2a5d===','||_0x2e4f9c[_0x1b23a5(0x2f,-0x42,0x24,-0x2e)](_0x4d2a5d,'，'))&&!_0x56e92b){const _0x530d28=_0x27ef52['trim']();if(_0x530d28)_0x52e600[_0x58d475(0x2d5,0x2c9,0x280,0x2c5)](_0x530d28);_0x27ef52='';}else _0x27ef52+=_0x4d2a5d;}}}if(_0x27ef52[_0x1b23a5(-0x97,-0x49,-0x96,-0x91)]())_0x52e600[_0x1b23a5(-0x2,-0x23,-0x50,-0x35)](_0x27ef52[_0x58d475(0x280,0x26d,0x23f,0x2c2)]());return _0x52e600;}else{const _0x294b54=_0x1bb6db[0xb76+-0x711+-0x464]||'',_0x2ee1e9=(_0x5eb9e0[0x31f*-0x2+0x511*0x1+0x12f]||'')[_0x1b23a5(-0xcc,-0xa9,-0xaa,-0x91)](),_0x25298f=_0x5687d5[-0x26d9+0xa3+0x2639]||'',_0x43bd44=_0x4f7d37[0x1cf6+0x717+0x1*-0x2409]||'',_0x3d6710={'original':_0x2a467a,'cleaned':_0x2ee1e9,'prefix':_0x294b54,'suffix':_0x25298f,'weight':_0x43bd44,'skip':_0x4c9838[_0x1b23a5(-0x80,-0x5d,-0x7e,-0x70)](_0xe489c9,_0x210082)||_0x4c9838[_0x58d475(0x2d0,0x324,0x2d5,0x340)](_0x4a24e5,_0x2ee1e9)};_0x1f870c['push'](_0x3d6710),!_0x3d6710[_0x1b23a5(-0x9c,0xc,-0x87,-0x49)]&&_0x2ee1e9&&(_0x23e071[_0x58d475(0x2bd,0x2c9,0x273,0x2c6)](_0x2ee1e9),_0x367819[_0x58d475(0x32a,0x310,0x2be,0x33f)](_0x2ee1e9['toLowerCas'+'e'](),_0x3d6710));}};function _0x599d74(_0x12ee46,_0x5eca7f,_0xfe435f,_0x5c47ff){return _0x3370(_0xfe435f- -0x2dc,_0x5c47ff);}const _0xc36a92=_0x2769df(_0x17b174),_0x278e22=[],_0x13c5b7=[];function _0x3d951f(_0x4c4416,_0x166258,_0x37b9fa,_0x314d1b){return _0x3370(_0x166258-0xb0,_0x37b9fa);}const _0x407749=new Map();for(const _0x148cda of _0xc36a92){const _0x3d386a=_0x148cda['match'](SD_SYMBOL_PATTERN);if(_0x3d386a){const _0x1f38b2=_0x3d386a[0x1452+-0x282+0x2f*-0x61]||'',_0x53bab7=(_0x3d386a[-0x2b4+-0x1a1b+0x1cd1]||'')[_0x3d951f(0x1b5,0x190,0x152,0x139)](),_0x4f92e2=_0x3d386a[0x682+0x2115+0x13ca*-0x2]||'',_0x49ba5a=_0x3d386a[0x1*0xe12+-0xfb3*-0x1+-0x1dc1]||'',_0x11be49={'original':_0x148cda,'cleaned':_0x53bab7,'prefix':_0x1f38b2,'suffix':_0x4f92e2,'weight':_0x49ba5a,'skip':_0x2e4f9c['cfZwY'](shouldSkipTranslation,_0x148cda)||_0x2e4f9c[_0x3d951f(0x1dc,0x19d,0x143,0x1eb)](shouldSkipTranslation,_0x53bab7)};_0x278e22[_0x599d74(-0x1cd,-0x151,-0x1a0,-0x1c8)](_0x11be49);if(!_0x11be49['skip']&&_0x53bab7){if(_0x2e4f9c[_0x3d951f(0x272,0x220,0x1da,0x1c5)](_0x3d951f(0x24a,0x203,0x1b5,0x22c),_0x2e4f9c[_0x3d951f(0x1bb,0x1b2,0x19a,0x15f)])){_0x3b7cd9[_0x599d74(-0x1bf,-0x118,-0x170,-0x163)+_0x3d951f(0x26c,0x224,0x27f,0x1d0)](_0x3fc079['LLM_TRANSL'+_0x599d74(-0x133,-0x1b6,-0x15b,-0x16f)+_0x3d951f(0x265,0x23d,0x239,0x21d)],_0x1b9647);if(_0x2f9756)_0x2e4f9c[_0x3d951f(0x1f1,0x23e,0x229,0x267)](_0xde119,_0x4c7f9d);}else _0x13c5b7['push'](_0x53bab7),_0x407749[_0x3d951f(0x255,0x233,0x1fa,0x265)](_0x53bab7[_0x599d74(-0x1b7,-0x17b,-0x1a2,-0x1f8)+'e'](),_0x11be49);}}else{const _0x1effe4={'original':_0x148cda,'cleaned':_0x148cda,'prefix':'','suffix':'','weight':'','skip':_0x2e4f9c[_0x599d74(-0x19f,-0x207,-0x1e9,-0x1d7)](shouldSkipTranslation,_0x148cda)};_0x278e22[_0x3d951f(0x22a,0x1ec,0x209,0x23b)](_0x1effe4),!_0x1effe4[_0x599d74(-0x1ed,-0x15a,-0x1b4,-0x1b1)]&&_0x148cda&&(_0x13c5b7[_0x3d951f(0x22b,0x1ec,0x1eb,0x233)](_0x148cda),_0x407749[_0x599d74(-0x11b,-0xfd,-0x159,-0x149)](_0x148cda[_0x3d951f(0x1d4,0x1ea,0x222,0x1d6)+'e'](),_0x1effe4));}}return{'originalTags':_0x278e22,'cleanedTags':_0x13c5b7,'cleanedText':tagsToJsonString(_0x13c5b7),'tagMap':_0x407749};}export function combineTranslationResult(_0xe96e68,_0x2fd063){function _0x24bcfc(_0x17e3c3,_0x39146b,_0x528ffb,_0x2a3d21){return _0x3370(_0x39146b-0x51,_0x17e3c3);}const _0x2296c9={'QIFcn':function(_0xeefe42,_0x5ebe31){return _0xeefe42(_0x5ebe31);},'eIciT':_0x24bcfc(0x22e,0x1e5,0x21b,0x220),'YQyJW':_0x24bcfc(0x1e0,0x1b6,0x1d7,0x178)+_0x24bcfc(0x154,0x192,0x163,0x1de)+_0x24bcfc(0x1f1,0x1c0,0x209,0x1de),'xvlfa':function(_0x51b65b,_0x563f30){return _0x51b65b===_0x563f30;},'utisN':_0x3b9236(0x1d,0x65,0x2f,0x1f),'WGApt':function(_0x1a2e74,_0x1c3b49){return _0x1a2e74!==_0x1c3b49;},'cNFzt':_0x3b9236(0x12,0xf,0xc,0x2),'OXUON':_0x24bcfc(0x180,0x167,0x13e,0x138),'SIKzw':_0x24bcfc(0x1cb,0x18e,0x138,0x172),'ZzMZF':function(_0x43f12d,_0x2b9170){return _0x43f12d===_0x2b9170;},'HmnHn':_0x24bcfc(0x120,0x177,0x189,0x1a1)};function _0x3b9236(_0x896559,_0x3dfb36,_0x900969,_0x5a68c2){return _0x3370(_0x5a68c2- -0x10d,_0x3dfb36);}if(!_0xe96e68||!Array['isArray'](_0xe96e68))return _0x2296c9[_0x24bcfc(0x1d2,0x19a,0x180,0x19c)](_0x2296c9['cNFzt'],_0x24bcfc(0x1f8,0x1c7,0x1b5,0x1a2))?[]:_0x33bed7?_0x5510a2[_0x24bcfc(0x1e4,0x1bb,0x200,0x169)]:'';const _0x32a67a={};if(_0x2fd063&&_0x2296c9[_0x3b9236(0x50,0x53,0x31,0x48)](typeof _0x2fd063,_0x24bcfc(0x1fb,0x1dd,0x1b6,0x1c6))){if(_0x2296c9[_0x3b9236(0x60,0x47,0x91,0x48)](_0x2296c9[_0x24bcfc(0x156,0x14f,0x185,0xf2)],_0x2296c9[_0x24bcfc(0x11e,0x14b,0x172,0x18f)])){_0x2296c9[_0x24bcfc(0x139,0x140,0xe4,0x14f)](_0x1fa314,'翻译失败:\x20'+_0x5e1a29[_0x3b9236(0x3,0x64,-0x21,0x1d)]),_0x393112[_0x24bcfc(0x137,0x185,0x132,0x141)](_0x2296c9[_0x3b9236(0x59,0x40,0x92,0x77)],_0x29a5ab);throw _0x2e3117;}else for(const [_0x20650b,_0x332a7e]of Object['entries'](_0x2fd063)){_0x2296c9[_0x3b9236(0x54,0x81,0x1e,0x3a)](_0x2296c9['HmnHn'],'xHxbw')?(_0x5800c1['log'](_0x2296c9['YQyJW']),_0x5babbe=!![]):_0x32a67a[_0x20650b[_0x24bcfc(0x1e9,0x18b,0x135,0x1a3)+'e']()]=_0x332a7e;}}return _0xe96e68[_0x3b9236(0x59,0x42,0x2,0x3d)](_0x80ad7d=>{const {original:_0x258d5b,cleaned:_0x54db24,skip:_0x20866d}=_0x80ad7d;function _0x30aba1(_0x2c5e2f,_0x25b793,_0x2eaad9,_0x401f0a){return _0x24bcfc(_0x2eaad9,_0x25b793- -0x1dc,_0x2eaad9-0x1bc,_0x401f0a-0x178);}if(_0x20866d){if(_0x2296c9['xvlfa'](_0x2296c9['utisN'],_0x2296c9['utisN'])){const _0x4afe2e={};return _0x4afe2e[_0x30aba1(-0x5b,-0x21,0x21,-0x71)]=_0x258d5b,_0x4afe2e[_0x30aba1(-0xaf,-0x6f,-0x25,-0x60)+'n']='',_0x4afe2e['cleaned']=_0x54db24,_0x4afe2e['skipped']=!![],_0x4afe2e;}else _0x22d2c6['warn'](_0xbb83ad(0x1b8,0x1cd,0x172,0x16a)+_0xbb83ad(0x1ec,0x1e5,0x23b,0x248)+'尝试旧格式:',_0x541459['message']);}const _0x5e2736=_0x32a67a[_0x54db24[_0xbb83ad(0x18d,0x19b,0x1e8,0x1e8)+'e']()]||'',_0x5f4dc2={};function _0xbb83ad(_0x363c56,_0x5061cd,_0x527705,_0x25fb4c){return _0x3b9236(_0x363c56-0x48,_0x25fb4c,_0x527705-0x1e6,_0x363c56-0x160);}return _0x5f4dc2['original']=_0x258d5b,_0x5f4dc2[_0x30aba1(-0x15,-0x6f,-0x72,-0xaf)+'n']=_0x5e2736,_0x5f4dc2[_0xbb83ad(0x1d3,0x210,0x1a9,0x1eb)]=_0x54db24,_0x5f4dc2[_0xbb83ad(0x143,0x16b,0x141,0x12f)]=![],_0x5f4dc2;});}export function formatTranslationDisplay(_0x2f646f,_0x16c435={}){const _0x2df6da={};_0x2df6da[_0xff4b98(0x14f,0xec,0x15f,0x118)]=function(_0x24579e,_0x29325b){return _0x24579e+_0x29325b;},_0x2df6da['qlFir']=function(_0x291d60,_0xab26ec){return _0x291d60===_0xab26ec;};function _0x5b0bc8(_0x248f12,_0x5592b7,_0x5439e3,_0x557b5c){return _0x3370(_0x5439e3- -0xdc,_0x557b5c);}_0x2df6da['ZozPr']=_0x5b0bc8(0x69,0x59,0xab,0x62),_0x2df6da[_0xff4b98(0xba,0x107,0xae,0xb2)]=_0xff4b98(0xac,0xd2,0xd7,0x7a),_0x2df6da[_0xff4b98(0xa1,0x93,0xfd,0xeb)]=_0x5b0bc8(0x2e,0x6a,0x6a,0x32),_0x2df6da[_0x5b0bc8(0x83,0x3a,0x64,0x57)]=function(_0x40ebbb,_0xc32ddf){return _0x40ebbb!==_0xc32ddf;},_0x2df6da['QDLDh']=_0xff4b98(0x14e,0xd9,0xdc,0xef);const _0x439a36=_0x2df6da,{separator:separator=',\x20',showOriginal:showOriginal=!![],showTranslation:showTranslation=!![]}=_0x16c435;function _0xff4b98(_0x244117,_0x5a5164,_0x5db2e9,_0x1f8135){return _0x3370(_0x1f8135- -0x71,_0x5a5164);}if(!_0x2f646f||!Array[_0xff4b98(0x8f,0xc7,0xd7,0xbc)](_0x2f646f)){if(_0x439a36[_0x5b0bc8(0x52,0x86,0x64,0x40)](_0x5b0bc8(0x81,0x51,0x84,0x7f),_0x439a36[_0x5b0bc8(0xe,-0x19,0x2e,0x1)]))_0x15fdf3['push']('('+_0x350b38[_0xff4b98(0xd8,0xa5,0xad,0xab)+'n']+')');else return'';}return _0x2f646f[_0xff4b98(0xff,0xaf,0xb2,0xd9)](_0x21e215=>{const _0x235188={'FqigQ':function(_0x154951,_0x532a50){function _0x50ee92(_0x345fb9,_0x5dada1,_0x451abe,_0x47f862){return _0x3370(_0x5dada1-0x182,_0x345fb9);}return _0x439a36[_0x50ee92(0x364,0x30b,0x2d2,0x336)](_0x154951,_0x532a50);}};function _0x1d3bad(_0x10aa30,_0x1e8fad,_0x4c66be,_0x4658e9){return _0xff4b98(_0x10aa30-0x56,_0x4c66be,_0x4c66be-0x1b8,_0x4658e9- -0x133);}function _0x554040(_0x47af0c,_0x1b3bb2,_0x2a74ec,_0x93edd8){return _0xff4b98(_0x47af0c-0x92,_0x1b3bb2,_0x2a74ec-0x13c,_0x93edd8-0x255);}if(_0x439a36[_0x1d3bad(0x5,-0x4c,0x6,-0x4c)](_0x1d3bad(0x10,-0x2c,-0x60,-0x1e),_0x554040(0x326,0x393,0x37a,0x36a))){if(_0x21e215[_0x554040(0x30d,0x2b0,0x2c8,0x2d4)]){if(_0x439a36[_0x554040(0x367,0x331,0x2f6,0x33c)](_0x439a36[_0x1d3bad(-0x21,-0x24,-0x70,-0x27)],_0x439a36[_0x1d3bad(-0xc9,-0x9b,-0x59,-0x81)])){const _0xb86d79=_0x4a34e0[_0x554040(0x290,0x276,0x283,0x2c4)]();if(_0xb86d79)_0x56ca94['push'](_0xb86d79);_0x2c6caa='';}else return showOriginal?_0x21e215[_0x554040(0x2fd,0x318,0x32f,0x34e)]:'';}const _0x4ef3a6=[];if(showOriginal)_0x4ef3a6['push'](_0x21e215['original']);if(showTranslation&&_0x21e215['translatio'+'n']){if('oKSjV'!==_0x439a36[_0x554040(0x380,0x2f4,0x39c,0x340)]){if(!_0xd30995['isArray'](_0x1d4a21))return'[]';return _0x4225f4[_0x554040(0x3b3,0x3b0,0x311,0x355)](_0x54e7be[_0x1d3bad(-0x25,-0x15,-0x22,-0x4a)](_0x119e0b=>_0x119e0b&&typeof _0x119e0b==='string'));}else _0x4ef3a6['push']('('+_0x21e215[_0x1d3bad(-0x54,-0x9c,-0x43,-0x88)+'n']+')');}return _0x4ef3a6[_0x1d3bad(-0x2c,-0x63,0x32,-0x8)]('\x20');}else{const _0x566a4d=_0x146595[_0x554040(0x315,0x2aa,0x31f,0x2f9)](0x1ad8+-0xd19+-0xdbf,_0x45c931)[_0x1d3bad(-0x111,-0x92,-0x7f,-0xc4)](),_0x5bb576=_0x3db150['slice'](_0x235188['FqigQ'](_0x585682,-0x797+-0x31*0x9e+0x25d6))['trim']();if(_0x566a4d)_0x44731f[_0x566a4d]=_0x5bb576;}})[_0x5b0bc8(0x7f,0x87,0x7e,0x94)](Boolean)[_0x5b0bc8(0xc1,0x96,0xc0,0x6a)](separator);}function _0x3370(_0x51223e,_0xb4fc4c){_0x51223e=_0x51223e-(0x3*-0x82f+0x4*-0x4e1+-0xb1*-0x41);const _0x244243=_0x4011();let _0x1cd3fa=_0x244243[_0x51223e];if(_0x3370['joJPwB']===undefined){var _0x598bec=function(_0x18272e){const _0x14f7fa='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0xae266='',_0x107fff='',_0x513a89=_0xae266+_0x598bec;for(let _0xe8b0e4=0xcd3+-0x2314+0x1641,_0x24ad51,_0x4beba3,_0x5c3159=0x10ba+0xecd+-0x1f87;_0x4beba3=_0x18272e['charAt'](_0x5c3159++);~_0x4beba3&&(_0x24ad51=_0xe8b0e4%(-0xad1+-0xd26+0x17fb)?_0x24ad51*(0x4d7*-0x2+-0x100b+0x19f9*0x1)+_0x4beba3:_0x4beba3,_0xe8b0e4++%(-0xb6d+-0x1f8b+-0xe*-0x312))?_0xae266+=_0x513a89['charCodeAt'](_0x5c3159+(0x1dae+0x1e56+-0x13fe*0x3))-(0x13f2+-0x13b1+-0x37)!==0xc2d+-0x6*-0xf8+-0x11fd?String['fromCharCode'](-0x1d8b*0x1+0x1863+0x627&_0x24ad51>>(-(0x47*0x7d+0x8c3*-0x4+-0x9*-0xb)*_0xe8b0e4&-0x96c*0x3+-0xf13+0x2b5d)):_0xe8b0e4:-0x77c*0x1+-0x1fa2+-0x2*-0x138f){_0x4beba3=_0x14f7fa['indexOf'](_0x4beba3);}for(let _0x2b4080=-0x156b+0x15d7*0x1+-0x6c,_0x4e4d98=_0xae266['length'];_0x2b4080<_0x4e4d98;_0x2b4080++){_0x107fff+='%'+('00'+_0xae266['charCodeAt'](_0x2b4080)['toString'](-0x1*0x1d47+0x166e+0x6e9))['slice'](-(-0x43b+0x1df*-0x12+0x25eb));}return decodeURIComponent(_0x107fff);};_0x3370['JaGQJs']=_0x598bec,_0x3370['EnHQgW']={},_0x3370['joJPwB']=!![];}const _0x5daef6=_0x244243[-0x1319*-0x1+0x365*0xb+-0x102*0x38],_0x51b4b4=_0x51223e+_0x5daef6,_0x322060=_0x3370['EnHQgW'][_0x51b4b4];if(!_0x322060){const _0x1cfae8=function(_0x3952ee){this['waIgSh']=_0x3952ee,this['jLAdXx']=[-0x680+0x3*0x64b+-0xc6*0x10,-0x2*-0xedf+0x15ba+0x1e8*-0x1b,0x3*-0x715+-0x2604+0x3b43],this['CaSAnH']=function(){return'newState';},this['cVCAGd']='\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*',this['AiXvQe']='[\x27|\x22].+[\x27|\x22];?\x20*}';};_0x1cfae8['prototype']['AMHZXW']=function(){const _0xa6d308=new RegExp(this['cVCAGd']+this['AiXvQe']),_0xe198bc=_0xa6d308['test'](this['CaSAnH']['toString']())?--this['jLAdXx'][0x9e3*0x1+0x767*0x1+-0x1149]:--this['jLAdXx'][0x346*-0x5+0x268a+-0x162c];return this['VcEMnr'](_0xe198bc);},_0x1cfae8['prototype']['VcEMnr']=function(_0x5d6c74){if(!Boolean(~_0x5d6c74))return _0x5d6c74;return this['Oiqjbr'](this['waIgSh']);},_0x1cfae8['prototype']['Oiqjbr']=function(_0x594e94){for(let _0x3daeac=-0xc08+0x15ad+-0x9a5,_0x10666b=this['jLAdXx']['length'];_0x3daeac<_0x10666b;_0x3daeac++){this['jLAdXx']['push'](Math['round'](Math['random']())),_0x10666b=this['jLAdXx']['length'];}return _0x594e94(this['jLAdXx'][-0x1*0x9ad+0x58e+0x41f]);},new _0x1cfae8(_0x3370)['AMHZXW'](),_0x1cd3fa=_0x3370['JaGQJs'](_0x1cd3fa),_0x3370['EnHQgW'][_0x51b4b4]=_0x1cd3fa;}else _0x1cd3fa=_0x322060;return _0x1cd3fa;}export async function translatePromptTags(_0x4b7431){const _0x50a906={'QchRX':function(_0x187b1c,_0x52e024){return _0x187b1c(_0x52e024);},'qHrOx':function(_0x14269e,_0x11b22b,_0x39399a){return _0x14269e(_0x11b22b,_0x39399a);},'trhUk':function(_0x1d57f8,_0x460823){return _0x1d57f8(_0x460823);}},{originalTags:_0x536fa1,cleanedText:_0x50385f}=_0x50a906['QchRX'](preprocessPromptForTranslation,_0x4b7431);if(!_0x50385f){const _0x5d99bd={};return _0x5d99bd[_0x3fde28(-0x36,-0x29,0x1f,0x20)]=[],_0x5d99bd[_0x106282(0x41b,0x450,0x42b,0x3f3)+'t']='',_0x5d99bd['originalTa'+'gs']=[],_0x5d99bd;}function _0x106282(_0xfefedf,_0x2cdb60,_0x22f7b8,_0x13929a){return _0x3370(_0x2cdb60-0x304,_0x13929a);}function _0x3fde28(_0x422352,_0x291067,_0x508f4a,_0x8173e1){return _0x3370(_0x508f4a- -0x159,_0x291067);}try{const _0x430807=await _0x50a906[_0x3fde28(0x5a,0x39,0xa,0x1b)](callTranslation,_0x50385f),_0x5edf9f=_0x50a906[_0x106282(0x4a6,0x467,0x45e,0x47a)](parseTranslationResult,_0x430807),_0x366d08=_0x50a906[_0x3fde28(-0x4c,-0x8c,-0x4c,-0x4d)](combineTranslationResult,_0x536fa1,_0x5edf9f),_0x2f08ae=_0x50a906['trhUk'](formatTranslationDisplay,_0x366d08),_0x5932dc={};return _0x5932dc[_0x3fde28(-0x3d,-0x2b,0x1f,0x5a)]=_0x366d08,_0x5932dc[_0x3fde28(0x4d,0x33,-0xd,-0x3e)+'t']=_0x2f08ae,_0x5932dc[_0x106282(0x46d,0x421,0x46b,0x459)+'gs']=_0x536fa1,_0x5932dc;}catch(_0x4e35a0){console['error'](_0x3fde28(0x1f,-0x2a,0xc,0xa)+_0x106282(0x3e5,0x40b,0x438,0x3f2)+':',_0x4e35a0);throw _0x4e35a0;}}export function parseTranslationResult(_0x3b4f26){function _0x4562f1(_0x51cd41,_0x14d9bd,_0x371cac,_0x5b7bea){return _0x3370(_0x371cac- -0x27d,_0x14d9bd);}const _0x1ddeb3={'SsNAe':function(_0x11dc0f,_0x24bfdc){return _0x11dc0f(_0x24bfdc);},'Imevg':_0x4562f1(-0x103,-0x148,-0x14b,-0x1a8),'AODXW':_0x4562f1(-0x9e,-0x90,-0xea,-0xf4),'jeCOB':_0x3b541a(0x2b,0x1c,0x17,0x9),'vRvAQ':function(_0x1c8c0c,_0x45f764){return _0x1c8c0c===_0x45f764;},'rUIBp':_0x4562f1(-0xf8,-0x112,-0xf1,-0x114),'VIEss':function(_0x204659,_0x40fecf){return _0x204659!==_0x40fecf;},'Qsdtp':function(_0x599ee9,_0x1f73da){return _0x599ee9(_0x1f73da);},'IlyKV':function(_0x4badc3,_0x722b03){return _0x4badc3>_0x722b03;},'wuyzu':function(_0x3ed7a3,_0x378617){return _0x3ed7a3===_0x378617;},'VWoXM':_0x3b541a(-0x7c,-0x50,-0xa8,-0x67),'bDSwX':function(_0x18c90e,_0x80608d){return _0x18c90e+_0x80608d;}};if(!_0x3b4f26)return{};try{if(_0x1ddeb3[_0x3b541a(-0x47,-0x1e,-0xf,-0x3)]===_0x1ddeb3[_0x4562f1(-0xdb,-0x135,-0x116,-0x13e)]){const _0x1a1454=_0x3b4f26[_0x4562f1(-0x13d,-0x17c,-0x156,-0x153)](/\{[\s\S]*\}/);if(_0x1a1454){if(_0x1ddeb3[_0x3b541a(-0xd,0x4,-0x1f,-0x4b)]===_0x1ddeb3[_0x3b541a(-0x50,0x17,0x51,-0xd)])_0x1ddeb3[_0x3b541a(-0x4d,-0xab,-0xa,-0x65)](_0x41b952,_0x28ed99[_0x3b541a(-0x85,-0x66,-0xc4,-0x76)]);else{const _0x3a31d4=JSON[_0x4562f1(-0x12a,-0x128,-0x124,-0x154)](_0x1a1454[0x2403+0x9aa+0x2dad*-0x1]);if(_0x1ddeb3[_0x3b541a(0x0,-0x1f,-0xa,0x14)](typeof _0x3a31d4,_0x1ddeb3[_0x3b541a(-0x82,-0x33,-0x8e,-0x58)])&&_0x1ddeb3[_0x4562f1(-0x100,-0x137,-0x112,-0x16a)](_0x3a31d4,null))return _0x3a31d4;}}}else return{'originalTags':[],'cleanedTags':[],'cleanedText':'','tagMap':new _0x268da4()};}catch(_0x2ffdc9){console[_0x4562f1(-0x102,-0xfe,-0x13f,-0xe8)](_0x3b541a(0x32,0x4b,0x34,-0x5)+_0x3b541a(-0x26,0x7d,0x31,0x2f)+'尝试旧格式:',_0x2ffdc9['message']);}const _0x1cb0c4=_0x1ddeb3[_0x3b541a(0x4,-0x38,0x2d,-0x18)](String,_0x3b4f26)[_0x4562f1(-0x180,-0x136,-0x15d,-0x14c)](/[\r\n]+/g,'\x20')[_0x4562f1(-0x129,-0x1b6,-0x15d,-0x19e)](/^[\s"'`]+|[\s"'`]+$/g,'')[_0x4562f1(-0x163,-0x15c,-0x19d,-0x180)](),_0x438810=_0x1cb0c4[_0x4562f1(-0xe9,-0x137,-0x127,-0xca)](/[,，]/)['map'](_0x796bae=>_0x796bae[_0x3b541a(-0x6d,-0xd8,-0x9d,-0x8a)]())[_0x3b541a(-0x4f,0x29,0x14,-0x10)](Boolean),_0x3f5998={};function _0x3b541a(_0x34278e,_0x16894b,_0x103c48,_0x35b46e){return _0x3370(_0x35b46e- -0x16a,_0x16894b);}for(const _0x9a2237 of _0x438810){const _0x4bb5cc=_0x9a2237[_0x3b541a(-0x7,0x5a,-0x2a,0xf)]('\x5c');if(_0x1ddeb3[_0x4562f1(-0x1d7,-0x1a3,-0x195,-0x1c9)](_0x4bb5cc,-0x171f+-0x1*-0x719+0x1006)){if(_0x1ddeb3[_0x3b541a(-0x33,-0x9b,-0xba,-0x80)](_0x4562f1(-0x125,-0x164,-0x16a,-0x1b2),_0x1ddeb3[_0x3b541a(-0xc0,-0xa0,-0x34,-0x7e)]))_0x27a8f0[_0x3d205f['toLowerCas'+'e']()]=_0x1b29b5;else{const _0x4e79a0=_0x9a2237['slice'](-0xbd4+-0x7f*0x4a+0x1*0x308a,_0x4bb5cc)['trim'](),_0x2d1787=_0x9a2237[_0x3b541a(-0xf,-0x7,-0x6e,-0x55)](_0x1ddeb3[_0x4562f1(-0x143,-0x158,-0x14a,-0x112)](_0x4bb5cc,-0x1f46+-0x1023+0x7e7*0x6))[_0x3b541a(-0xa9,-0xa0,-0x5c,-0x8a)]();if(_0x4e79a0)_0x3f5998[_0x4e79a0]=_0x2d1787;}}}return _0x3f5998;}function generateRequestId(){const _0x2a0484={};_0x2a0484[_0x273dee(0x1c4,0x175,0x16c,0x184)]=_0x55419a(0x25,0x5a,0xd,0x52),_0x2a0484[_0x273dee(0x1d5,0x1e1,0x19b,0x216)]=function(_0x4c140d,_0x2d9375){return _0x4c140d===_0x2d9375;},_0x2a0484[_0x55419a(0x89,0x86,0x59,0x23)]=_0x55419a(-0x64,0x21,-0x25,-0x50);function _0x273dee(_0x5e7929,_0x48ef7c,_0x11d321,_0x5adeb9){return _0x3370(_0x5e7929-0x9f,_0x5adeb9);}function _0x55419a(_0x3fc7fd,_0x34db46,_0x2519d9,_0x4893eb){return _0x3370(_0x2519d9- -0x121,_0x34db46);}const _0x1b9d3f=_0x2a0484;if(crypto&&crypto[_0x55419a(0x27,0x29,0x30,0x7b)]){if(_0x1b9d3f['GmDUB'](_0x1b9d3f[_0x273dee(0x219,0x21b,0x226,0x25e)],_0x55419a(-0x36,-0x7b,-0x25,-0x58)))return crypto[_0x273dee(0x1f0,0x1ba,0x222,0x1d9)]();else{const _0x25f3af=new _0x11cb1e(_0x5bc29d[_0x55419a(0x54,-0x42,0x13,0x42)][_0x55419a(0x3d,-0x46,0x9,-0xa)]);_0x25f3af[_0x273dee(0x21a,0x21b,0x25d,0x1c2)]=_0x1b9d3f['naUBn'],_0x3770e7(_0x25f3af);}}return Date[_0x273dee(0x200,0x220,0x24e,0x1d6)]()['toString'](0xd*-0x217+0x200b+-0x4*0x12f)+Math[_0x273dee(0x214,0x1f6,0x269,0x225)]()[_0x55419a(0x3b,-0x34,-0x8,-0x29)](-0x631+0x1*0x1a15+-0x13c0)[_0x273dee(0x1a8,0x195,0x17f,0x169)](0xd7e+-0x15*-0x6e+0x2b*-0x86);}export function LLM_TRANSLATION_GET_PROMPT(){const _0x1895ab={'geqLv':function(_0x3f9ee4,_0x21da5c){return _0x3f9ee4!==_0x21da5c;},'WHiLu':function(_0x495e58,_0xff76a9){return _0x495e58(_0xff76a9);},'nYuGY':function(_0x1124b6,_0x140b48){return _0x1124b6(_0x140b48);},'jTGBA':function(_0x39263f){return _0x39263f();}};return new Promise((_0x67a835,_0xd2473c)=>{function _0x1ac8fa(_0x258708,_0x323c80,_0x54b9d9,_0x6bab90){return _0x3370(_0x54b9d9- -0x27,_0x6bab90);}function _0x39eda7(_0x28ca04,_0x442218,_0x528475,_0x176905){return _0x3370(_0x442218-0x99,_0x176905);}const _0x50d147={'WYhAn':function(_0xef3dee,_0x2bb4fc){function _0x1ab167(_0x596edd,_0x27c230,_0x412b98,_0x2e17cf){return _0x3370(_0x27c230-0x11f,_0x2e17cf);}return _0x1895ab[_0x1ab167(0x1fc,0x218,0x20a,0x253)](_0xef3dee,_0x2bb4fc);},'EFvZr':_0x39eda7(0x195,0x1d0,0x1df,0x1bf)};if(_0x1ac8fa(0xfa,0xdd,0xf0,0xc3)===_0x39eda7(0x1e1,0x1b0,0x1de,0x1e3)){const _0x1e6f02=_0x1895ab[_0x1ac8fa(0xdc,0x7b,0xc0,0xd2)](generateRequestId);console[_0x39eda7(0x241,0x215,0x1cc,0x214)](_0x1ac8fa(0x14c,0x10e,0x13e,0x138)+_0x39eda7(0x154,0x18b,0x13f,0x153)+_0x1ac8fa(0x185,0x1ba,0x16b,0x154)+_0x1e6f02+')');const _0x3940fe=_0x16d74e=>{if(_0x1895ab[_0x4c143b(0x3ca,0x3dd,0x3d7,0x3dc)](_0x16d74e['id'],_0x1e6f02))return;eventSource[_0x477218(0x4c8,0x4ff,0x47b,0x49b)+_0x477218(0x4d0,0x506,0x4e1,0x4f6)](eventNames[_0x4c143b(0x3b3,0x407,0x400,0x45c)+_0x4c143b(0x3cf,0x3de,0x3bb,0x372)+'PROMPT_RES'+'PONSE'],_0x3940fe);function _0x4c143b(_0x561019,_0x4753a4,_0xd642e8,_0x5c6c28){return _0x1ac8fa(_0x561019-0x136,_0x4753a4-0xb6,_0xd642e8-0x2e3,_0x561019);}function _0x477218(_0x47a107,_0x500ec2,_0x320e25,_0x4ebc7a){return _0x39eda7(_0x47a107-0x130,_0x47a107-0x2c3,_0x320e25-0x93,_0x320e25);}const {prompt:_0x3f65a0}=_0x16d74e;console[_0x477218(0x4d8,0x4ab,0x508,0x525)](_0x477218(0x4c1,0x46e,0x4e2,0x513)+_0x477218(0x485,0x498,0x4bc,0x4d6)+'(ID:\x20'+_0x1e6f02+'):',_0x3f65a0),_0x1895ab[_0x477218(0x49e,0x475,0x47b,0x4a5)](_0x67a835,_0x3f65a0);};eventSource['on'](eventNames[_0x1ac8fa(0x13b,0xe8,0x11d,0x143)+'ATION_GET_'+_0x39eda7(0x1c0,0x17d,0x152,0x179)+_0x1ac8fa(0xf2,0x14c,0x141,0x110)],_0x3940fe);const _0x2a93a1={};_0x2a93a1['id']=_0x1e6f02,eventSource[_0x1ac8fa(0xef,0xe9,0x13f,0x119)](eventNames[_0x1ac8fa(0x165,0x107,0x11d,0xf8)+_0x39eda7(0x16b,0x198,0x150,0x1f3)+_0x39eda7(0x1f0,0x1a9,0x1d5,0x1e4)+_0x1ac8fa(0x172,0xe4,0x129,0xe0)],_0x2a93a1),setTimeout(()=>{function _0x1dccce(_0x206c15,_0x42aba6,_0x6be657,_0x29c428){return _0x39eda7(_0x206c15-0x146,_0x29c428- -0x360,_0x6be657-0x1d3,_0x6be657);}eventSource[_0x1dccce(-0x182,-0x11e,-0x100,-0x15b)+_0x71ae1f(0x228,0x1ca,0x1b9,0x1cd)](eventNames[_0x1dccce(-0x1c7,-0x1a1,-0x190,-0x183)+'ATION_GET_'+'PROMPT_RES'+'PONSE'],_0x3940fe);function _0x71ae1f(_0x29fad9,_0x3118a4,_0x1986f5,_0x312716){return _0x1ac8fa(_0x29fad9-0x1c0,_0x3118a4-0x48,_0x312716-0x80,_0x29fad9);}_0x50d147['WYhAn'](_0xd2473c,new Error(_0x50d147[_0x71ae1f(0x230,0x1d1,0x24c,0x1f4)]));},0x31e5+-0x2*0x1d8a+0x17*0x219);}else{const _0x4c6997={'original':_0xa6d308,'cleaned':_0xe198bc,'prefix':'','suffix':'','weight':'','skip':_0x50d147[_0x1ac8fa(0xff,0x10d,0xea,0xfe)](_0x5d6c74,_0x594e94)};_0x3daeac[_0x1ac8fa(0xd5,0x16d,0x115,0x120)](_0x4c6997),!_0x4c6997['skip']&&_0x10666b&&(_0x984e71[_0x1ac8fa(0x122,0x13b,0x115,0xe5)](_0x907d24),_0x5f003d['set'](_0x13427c['toLowerCas'+'e'](),_0x4c6997));}});}export function LLM_TRANSLATION(_0x373ef4,{timeoutMs:timeoutMs=0x1*0x9fa3+0x3252+0x7*0x37d}={}){function _0x227666(_0x572dd5,_0x34d48b,_0x1d2003,_0xc3e81b){return _0x3370(_0x34d48b-0x1c2,_0xc3e81b);}const _0x2fda3a={'koUbv':function(_0x4f564c,_0x4cac29){return _0x4f564c(_0x4cac29);},'cqLsd':function(_0x2919e1){return _0x2919e1();},'mJmUt':_0x457b7a(0x246,0x23d,0x227,0x1d9),'CkAGO':function(_0x400cad,_0x441217){return _0x400cad===_0x441217;},'VwKGV':_0x457b7a(0x21d,0x1e8,0x1f7,0x215),'Uliju':'VMhWn','ADRKx':_0x457b7a(0x25e,0x290,0x254,0x2b2),'MjLWJ':function(_0xc6bf2d,_0x3a283f){return _0xc6bf2d(_0x3a283f);},'LjDPo':function(_0x560222,_0x33aeaf){return _0x560222(_0x33aeaf);},'eQKVZ':function(_0x3c27fa,_0x5e8274,_0x56e086){return _0x3c27fa(_0x5e8274,_0x56e086);}};function _0x457b7a(_0x860604,_0x564d5b,_0x3019b4,_0x5c68a6){return _0x3370(_0x3019b4-0xc9,_0x5c68a6);}return new Promise((_0x58b916,_0x3a8dac)=>{function _0xd9f792(_0x54cf98,_0x540dbf,_0x508bbd,_0x154f02){return _0x457b7a(_0x54cf98-0x1bb,_0x540dbf-0x43,_0x54cf98-0x2cf,_0x508bbd);}function _0x203211(_0x4569f5,_0x4ccd5b,_0x496a4d,_0x29de69){return _0x457b7a(_0x4569f5-0x44,_0x4ccd5b-0xe,_0x4ccd5b- -0x494,_0x4569f5);}const _0x1c728d={'Tmxap':function(_0x2f50a1){function _0x4519ed(_0x4e9985,_0x36f2c8,_0x234c1f,_0x341eea){return _0x3370(_0x4e9985- -0x3d9,_0x36f2c8);}return _0x2fda3a[_0x4519ed(-0x2cb,-0x306,-0x2b3,-0x2b1)](_0x2f50a1);},'Nvevb':function(_0x19f5f1,_0x66b0a1){return _0x2fda3a['LjDPo'](_0x19f5f1,_0x66b0a1);}},_0x10c114=_0x2fda3a[_0xd9f792(0x4a6,0x499,0x49c,0x457)](generateRequestId);console[_0x203211(-0x230,-0x24f,-0x223,-0x260)](_0xd9f792(0x4fd,0x511,0x4b7,0x518)+'\x20请求翻译\x20LLM\x20'+_0xd9f792(0x501,0x4f9,0x4d3,0x55f)+_0x10c114+')');let _0xb505c1=null;const _0x166b93=()=>{eventSource['removeList'+_0x26a57b(0x46e,0x48d,0x48e,0x432)](eventNames[_0x38d50a(-0x1cd,-0x21e,-0x274,-0x25d)+_0x38d50a(-0x1e2,-0x1e1,-0x23d,-0x1a8)+'ONSE'],_0x125702);function _0x26a57b(_0x3aac63,_0xe5340,_0x512431,_0x122eca){return _0xd9f792(_0xe5340- -0x7f,_0xe5340-0x1a6,_0x122eca,_0x122eca-0xec);}function _0x38d50a(_0x1a2c0c,_0x17144e,_0x3af64a,_0xd793e8){return _0xd9f792(_0x17144e- -0x6fa,_0x17144e-0x1bc,_0xd793e8,_0xd793e8-0x64);}if(_0xb505c1)_0x2fda3a[_0x26a57b(0x406,0x402,0x458,0x3be)](clearTimeout,_0xb505c1);},_0x125702=_0x2828b7=>{const _0x2dad56={};_0x2dad56[_0x298884(0x509,0x4d2,0x501,0x4e2)]='(((.+)+)+)'+'+$';const _0x23c7a0=_0x2dad56;if(_0x2828b7['id']!==_0x10c114)return;function _0x51f3b0(_0x29aa95,_0x300d93,_0x29bbb5,_0x4638ad){return _0x203211(_0x29aa95,_0x300d93-0x583,_0x29bbb5-0x92,_0x4638ad-0x76);}function _0x298884(_0x8ea540,_0x450e18,_0x46b99d,_0x6b65d3){return _0x203211(_0x8ea540,_0x450e18-0x71e,_0x46b99d-0x188,_0x6b65d3-0x38);}_0x2fda3a[_0x298884(0x4b8,0x461,0x443,0x482)](_0x166b93),console[_0x298884(0x51b,0x4cf,0x4cc,0x4e5)](_0x298884(0x4be,0x4b8,0x4ed,0x4d3)+_0x51f3b0(0x2a7,0x2a6,0x29b,0x2bc)+'\x20执行结果\x20(ID:'+'\x20'+_0x10c114+'):',_0x2828b7);if(_0x2828b7['success']){if(_0x2fda3a['mJmUt']!==_0x2fda3a[_0x298884(0x4fc,0x4dd,0x50f,0x4db)])return _0x49bea0[_0x51f3b0(0x2f3,0x2d1,0x289,0x2f3)]()[_0x51f3b0(0x2ca,0x313,0x319,0x306)](byFrrC['EPiBZ'])[_0x298884(0x441,0x46c,0x42a,0x42a)]()[_0x51f3b0(0x316,0x30c,0x2d7,0x315)+'r'](_0x42db3f)['search']('(((.+)+)+)'+'+$');else _0x58b916(_0x2828b7['result']);}else{if(_0x2828b7[_0x51f3b0(0x2e0,0x2ec,0x332,0x2a0)]&&_0x2fda3a[_0x298884(0x4a4,0x483,0x4c2,0x4a1)](_0x2828b7['error'][_0x51f3b0(0x388,0x333,0x36c,0x388)],_0x2fda3a[_0x51f3b0(0x31e,0x2ed,0x340,0x28f)])){const _0x541c5d=new Error(_0x2828b7[_0x298884(0x458,0x487,0x47c,0x429)][_0x51f3b0(0x2ee,0x2e2,0x326,0x2fe)]);_0x541c5d[_0x51f3b0(0x36b,0x333,0x34c,0x38e)]=_0x2fda3a[_0x51f3b0(0x2a9,0x2ed,0x2fa,0x320)],_0x3a8dac(_0x541c5d);}else{if(_0x2fda3a[_0x51f3b0(0x276,0x2d2,0x311,0x2c3)]!==_0x2fda3a['ADRKx'])_0x2fda3a['MjLWJ'](_0x3a8dac,new Error(_0x2828b7[_0x298884(0x48d,0x447,0x41b,0x3f6)]));else return _0x632c51;}}};eventSource['on'](eventNames[_0xd9f792(0x4dc,0x512,0x499,0x53b)+_0xd9f792(0x519,0x55c,0x53b,0x4c7)+'ONSE'],_0x125702);const _0x547ef9={};_0x547ef9['prompt']=_0x373ef4,_0x547ef9['id']=_0x10c114,eventSource['emit'](eventNames[_0x203211(-0x287,-0x287,-0x28a,-0x264)+_0xd9f792(0x4a0,0x452,0x490,0x4b3)+_0x203211(-0x25b,-0x27d,-0x23e,-0x294)],_0x547ef9),_0xb505c1=_0x2fda3a[_0x203211(-0x1ff,-0x249,-0x243,-0x23a)](setTimeout,()=>{function _0x5ba94a(_0x4e0b23,_0x5da663,_0xaa17c6,_0x19335a){return _0xd9f792(_0xaa17c6- -0x72b,_0x5da663-0x1e8,_0x19335a,_0x19335a-0x1c);}function _0x530964(_0xa10185,_0x31de8b,_0x412b0a,_0xe87cab){return _0x203211(_0xe87cab,_0x31de8b-0x382,_0x412b0a-0xc1,_0xe87cab-0x97);}_0x1c728d[_0x5ba94a(-0x27c,-0x2b4,-0x288,-0x2ba)](_0x166b93),_0x1c728d[_0x530964(0x157,0x13f,0x198,0x10e)](_0x3a8dac,new Error(_0x5ba94a(-0x2c3,-0x24f,-0x26f,-0x215)+'时（'+timeoutMs+_0x5ba94a(-0x24b,-0x2db,-0x29b,-0x241)));},timeoutMs);});}export async function callTranslation(_0x57635d){function _0x52b78e(_0x5f01a8,_0x415be7,_0x1cefea,_0x155434){return _0x3370(_0x155434- -0x26e,_0x415be7);}function _0x2e3823(_0x16073e,_0x336b5b,_0x711970,_0x44bb6d){return _0x3370(_0x336b5b-0x2e6,_0x44bb6d);}const _0x4b71c9={'DTwgP':_0x52b78e(-0x13e,-0x122,-0x14e,-0x109)+'\x20翻译提示词标签失败'+':','wZHJZ':function(_0x3d7d43,_0x424041,_0x30f5f2){return _0x3d7d43(_0x424041,_0x30f5f2);},'bVvLU':function(_0x33c9f2,_0x5058dc){return _0x33c9f2||_0x5058dc;},'CVDyS':_0x2e3823(0x3ec,0x43d,0x462,0x484),'CFuYL':function(_0x221d48,_0x341673){return _0x221d48(_0x341673);},'SNNjX':function(_0x400a8c,_0x217ead){return _0x400a8c(_0x217ead);},'YmSRx':function(_0x2d64ef,_0x13e1cb){return _0x2d64ef===_0x13e1cb;},'jbRUE':_0x2e3823(0x451,0x47e,0x4b3,0x4b0),'eAFCB':function(_0x3093a2,_0x10b10d){return _0x3093a2(_0x10b10d);},'eZtwb':_0x2e3823(0x42f,0x47a,0x444,0x4b3)};try{let _0x31af14=_0x4b71c9[_0x2e3823(0x3f4,0x3dd,0x3ce,0x3a2)](buildPromptForRequestType,_0x52b78e(-0x19a,-0x19b,-0xff,-0x152)+'n',_0x4b71c9[_0x2e3823(0x48f,0x453,0x475,0x47e)](_0x57635d,''));_0x31af14=mergeAdjacentMessages(_0x31af14);const _0x3c9dfa={};_0x3c9dfa[_0x52b78e(-0x161,-0x124,-0x112,-0x126)]=_0x4b71c9[_0x52b78e(-0x171,-0x1a2,-0x169,-0x16e)],_0x3c9dfa[_0x2e3823(0x43f,0x445,0x455,0x438)]=_0x57635d||'';const _0x63df98=[..._0x31af14,_0x3c9dfa];_0x4b71c9['CFuYL'](updateCombinedPrompt,_0x63df98);const _0x2af4af=await _0x4b71c9[_0x2e3823(0x3e7,0x3e1,0x39a,0x3e0)](LLM_TRANSLATION,_0x63df98);return _0x2af4af;}catch(_0x57e18c){if(_0x4b71c9[_0x2e3823(0x40a,0x411,0x446,0x43c)](_0x2e3823(0x4c1,0x47e,0x45b,0x436),_0x4b71c9['jbRUE'])){_0x4b71c9[_0x52b78e(-0x91,-0x8c,-0x111,-0xd4)](addLog,_0x2e3823(0x436,0x41e,0x44a,0x428)+_0x57e18c[_0x52b78e(-0x17f,-0xf2,-0x175,-0x144)]),console[_0x52b78e(-0x150,-0x170,-0x170,-0x13a)](_0x4b71c9[_0x2e3823(0x413,0x415,0x442,0x43c)],_0x57e18c);throw _0x57e18c;}else{_0x34ee39[_0x52b78e(-0x147,-0xe0,-0x117,-0x13a)](_0x4b71c9['DTwgP'],_0xa178d9);throw _0x5a33a6;}}}let isAiInitialized=![];export function initAiSettings(_0x9def74){const _0x4a9d2c={};_0x4a9d2c[_0x3d9559(0xe,-0x19,-0x26,-0x51)]=_0x3d9559(-0x55,-0x39,-0x33,0x18)+_0x3d9559(-0x22,-0xb3,-0x57,-0x67)+_0x4357af(-0x1d1,-0x171,-0x187,-0x1cf);function _0x3d9559(_0x5018e3,_0x42041d,_0xeb732,_0x178b08){return _0x3370(_0xeb732- -0x198,_0x42041d);}const _0x5776ad=_0x4a9d2c;function _0x4357af(_0x37c201,_0x122e90,_0x371a22,_0x4e0a06){return _0x3370(_0x4e0a06- -0x33e,_0x37c201);}!isAiInitialized&&(console[_0x4357af(-0x1c7,-0x18a,-0x1b9,-0x1c2)](_0x5776ad['XJqCQ']),isAiInitialized=!![]);}