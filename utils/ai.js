(function(_0x8746f5,_0x2b56fe){function _0xe74932(_0x42b849,_0x52ab31,_0x59d1a8,_0x298562){return _0x429d(_0x52ab31- -0x2bb,_0x298562);}function _0x57cfb9(_0x352d16,_0x4c11ca,_0x38f8eb,_0x3a570f){return _0x429d(_0x38f8eb- -0xa5,_0x3a570f);}const _0x572c10=_0x8746f5();while(!![]){try{const _0x39847f=parseInt(_0x57cfb9(0x27,0x1e,-0x2a,-0x3c))/(-0x1*-0x315+-0x1f9f+0x1c8b)+parseInt(_0x57cfb9(-0x8,-0x21,0x39,0x60))/(-0x2*-0x83c+-0x1279+-0x203*-0x1)+parseInt(_0xe74932(-0x230,-0x238,-0x228,-0x21a))/(-0xa06*-0x1+-0x7d4*-0x1+-0x11d7)+-parseInt(_0x57cfb9(-0x2e,-0x44,0x8,-0x1b))/(-0x5*0x7c6+-0x2621+0x4d03)*(-parseInt(_0x57cfb9(0xbc,0x6c,0x7d,0x81))/(-0x1d42+0xd79+0xfce))+parseInt(_0xe74932(-0x1e1,-0x1b7,-0x17b,-0x1ca))/(0x270b+-0x68a+-0x5*0x67f)+-parseInt(_0xe74932(-0x1dc,-0x1a7,-0x1ad,-0x1c7))/(-0x1eab*0x1+-0x1aca+-0x4*-0xe5f)*(-parseInt(_0xe74932(-0x167,-0x192,-0x180,-0x15d))/(0x2273+-0x26f3+0x8*0x91))+parseInt(_0x57cfb9(0x49,0x34,-0x7,-0x5d))/(0x3*-0x6e8+0x1eb7+0x66*-0x19)*(-parseInt(_0xe74932(-0x1be,-0x1d7,-0x195,-0x1ba))/(0x757*0x4+-0x10d6+-0xc7c));if(_0x39847f===_0x2b56fe)break;else _0x572c10['push'](_0x572c10['shift']());}catch(_0x473664){_0x572c10['push'](_0x572c10['shift']());}}}(_0x3e1f,-0x386e5+0x1cd94+0x3ed3f*0x1));const _0x57eba6=(function(){let _0x17ae71=!![];return function(_0x1bf10e,_0x4f9449){const _0x46e31b=_0x17ae71?function(){function _0x56784c(_0x4700ca,_0x49f771,_0x466140,_0x436d73){return _0x429d(_0x4700ca-0x10b,_0x49f771);}if(_0x4f9449){const _0x28709a=_0x4f9449[_0x56784c(0x1bf,0x188,0x1d1,0x1b2)](_0x1bf10e,arguments);return _0x4f9449=null,_0x28709a;}}:function(){};return _0x17ae71=![],_0x46e31b;};}()),_0x266903=_0x57eba6(this,function(){function _0x43bdd5(_0x552f4f,_0x2e33f9,_0x3fae62,_0x5c6387){return _0x429d(_0x552f4f-0x2f3,_0x5c6387);}function _0x1bd610(_0x292ad9,_0x2faa39,_0x14545c,_0x4b311b){return _0x429d(_0x14545c-0x386,_0x4b311b);}const _0x16216f={};_0x16216f[_0x43bdd5(0x3b7,0x40e,0x409,0x38f)]=_0x43bdd5(0x373,0x355,0x36a,0x39a)+'+$';const _0x428319=_0x16216f;return _0x266903[_0x1bd610(0x4ba,0x47f,0x47c,0x47a)]()[_0x1bd610(0x4a3,0x427,0x452,0x488)](_0x428319[_0x43bdd5(0x3b7,0x40e,0x3d0,0x3ee)])[_0x1bd610(0x46c,0x434,0x47c,0x4d2)]()[_0x43bdd5(0x3ef,0x3f6,0x41b,0x416)+'r'](_0x266903)[_0x1bd610(0x425,0x4ac,0x452,0x430)](_0x43bdd5(0x373,0x378,0x3cb,0x3a1)+'+$');});_0x266903();import{extension_settings}from'../../../../extensions.js';import{saveSettingsDebounced,eventSource}from'../../../../../script.js';import{extensionName,eventNames}from'./config.js';import{addLog}from'./utils.js';import{updateCombinedPrompt}from'./settings/llm.js';import{buildPromptForRequestType}from'./settings/llmService.js';import{mergeAdjacentMessages}from'./promptProcessor.js';let settings;const SD_SYMBOL_PATTERN=/^([\(\[\{<]+)?(.*?)([\)\]\}>]+)?(:[\d.]+)?$/,SKIP_PATTERNS=[/^<lora:/i,/^<lyco:/i,/^<hypernet:/i,/^[\d.:]+$/,/^$/,/^\$.*\$$/];function shouldSkipTranslation(_0x45e294){function _0x2ff06e(_0x53cd6d,_0x1d4d3f,_0x3c80ad,_0x577df5){return _0x429d(_0x1d4d3f-0x203,_0x3c80ad);}return SKIP_PATTERNS[_0x2ff06e(0x301,0x2bd,0x2c5,0x2ba)](_0xee2062=>_0xee2062['test'](_0x45e294['trim']()));}export function tagsToJsonString(_0x3f3752){function _0x57dda0(_0x45f8ca,_0x4d1738,_0x495762,_0x1e02d8){return _0x429d(_0x4d1738- -0x3b7,_0x495762);}if(!Array[_0x57dda0(-0x2ae,-0x2b9,-0x273,-0x304)](_0x3f3752))return'[]';function _0x378b39(_0x565879,_0x4eb71c,_0x2bf650,_0x38c086){return _0x429d(_0x2bf650- -0x1fa,_0x565879);}return JSON[_0x378b39(-0xbe,-0x139,-0xe8,-0xec)](_0x3f3752[_0x378b39(-0x87,-0xc4,-0xd4,-0x8a)](_0x35337a=>_0x35337a&&typeof _0x35337a==='string'));}export function preprocessPromptForTranslation(_0x44d359){const _0x2018c8={'eHzRL':function(_0x592239,_0x329bcb){return _0x592239<_0x329bcb;},'wcgWy':function(_0x3807a7,_0x5b1ff1){return _0x3807a7===_0x5b1ff1;},'ZXMnp':function(_0x1120dd,_0x421682){return _0x1120dd!==_0x421682;},'pBgiW':_0x30e0c0(-0x6,0x38,0x4a,0x7),'quqpY':function(_0x194148,_0x30d2d9){return _0x194148(_0x30d2d9);},'wmnaR':function(_0x1fc531,_0x5540da){return _0x1fc531(_0x5540da);}};if(!_0x44d359||_0x2018c8[_0x199082(0x200,0x24e,0x20a,0x209)](typeof _0x44d359,_0x2018c8[_0x199082(0x202,0x26c,0x251,0x226)]))return{'originalTags':[],'cleanedTags':[],'cleanedText':'','tagMap':new Map()};const _0xf48878=_0x5c7419=>{function _0x127b0c(_0x4c3ee5,_0x2d934a,_0x2db3c9,_0x4ced5c){return _0x30e0c0(_0x4c3ee5-0x66,_0x2d934a-0x155,_0x4ced5c,_0x2db3c9- -0x17e);}const _0x28a38d=[];let _0x575119='';function _0x34d0dd(_0x29a81d,_0x18a73c,_0x206c80,_0x25781e){return _0x30e0c0(_0x29a81d-0x10a,_0x18a73c-0x25,_0x18a73c,_0x29a81d- -0xf2);}let _0x3b9c3c=![];for(let _0x551598=-0x26c9+-0x89a+0x2f63;_0x2018c8[_0x127b0c(-0x14e,-0x1b8,-0x15f,-0x12e)](_0x551598,_0x5c7419[_0x34d0dd(-0xfa,-0xa3,-0xd2,-0xf0)]);_0x551598++){const _0x289ee8=_0x5c7419[_0x551598];if(_0x289ee8==='$')_0x3b9c3c=!_0x3b9c3c,_0x575119+=_0x289ee8;else{if((_0x289ee8===','||_0x2018c8['wcgWy'](_0x289ee8,'，'))&&!_0x3b9c3c){const _0x393868=_0x575119[_0x34d0dd(-0xda,-0xb5,-0xfd,-0xe5)]();if(_0x393868)_0x28a38d[_0x127b0c(-0x1f0,-0x191,-0x1a2,-0x1d9)](_0x393868);_0x575119='';}else _0x575119+=_0x289ee8;}}if(_0x575119[_0x34d0dd(-0xda,-0x12f,-0x105,-0xa8)]())_0x28a38d[_0x127b0c(-0x1cb,-0x181,-0x1a2,-0x1e5)](_0x575119[_0x34d0dd(-0xda,-0xb2,-0x121,-0x81)]());return _0x28a38d;},_0x3cc1a6=_0xf48878(_0x44d359),_0x543345=[],_0x405372=[],_0x632f6c=new Map();function _0x199082(_0x23ff17,_0x4ba027,_0x397f60,_0x2d0ada){return _0x429d(_0x397f60-0x181,_0x4ba027);}for(const _0x2eedc7 of _0x3cc1a6){const _0x290cde=_0x2eedc7[_0x30e0c0(-0x25,-0x54,0x35,-0x1d)](SD_SYMBOL_PATTERN);if(_0x290cde){const _0x319fd8=_0x290cde[-0x1*-0x1c6f+0x47*0x67+0x38ff*-0x1]||'',_0x228759=(_0x290cde[-0x12a4*-0x1+-0x308+0xf9a*-0x1]||'')[_0x30e0c0(0xe,0x22,-0x8,0x18)](),_0x3ee567=_0x290cde[-0x1f5f+0x2ee+0x1c74]||'',_0x37036c=_0x290cde[0x3d5*0xa+-0x1df6+0x8*-0x10b]||'',_0x362c27={'original':_0x2eedc7,'cleaned':_0x228759,'prefix':_0x319fd8,'suffix':_0x3ee567,'weight':_0x37036c,'skip':_0x2018c8['quqpY'](shouldSkipTranslation,_0x2eedc7)||_0x2018c8[_0x30e0c0(-0x29,-0xe,0x5,0xd)](shouldSkipTranslation,_0x228759)};_0x543345['push'](_0x362c27),!_0x362c27[_0x199082(0x224,0x228,0x24a,0x286)]&&_0x228759&&(_0x405372['push'](_0x228759),_0x632f6c['set'](_0x228759['toLowerCas'+'e'](),_0x362c27));}else{const _0x574da5={'original':_0x2eedc7,'cleaned':_0x2eedc7,'prefix':'','suffix':'','weight':'','skip':_0x2018c8[_0x199082(0x2b0,0x257,0x26e,0x270)](shouldSkipTranslation,_0x2eedc7)};_0x543345['push'](_0x574da5),!_0x574da5[_0x199082(0x28c,0x272,0x24a,0x282)]&&_0x2eedc7&&(_0x405372[_0x199082(0x1ed,0x240,0x228,0x26e)](_0x2eedc7),_0x632f6c['set'](_0x2eedc7[_0x30e0c0(-0xa,-0x1c,-0x54,-0x18)+'e'](),_0x574da5));}}function _0x30e0c0(_0x17f0f8,_0xc993f4,_0xd578fd,_0x3f15b8){return _0x429d(_0x3f15b8- -0xcb,_0xd578fd);}return{'originalTags':_0x543345,'cleanedTags':_0x405372,'cleanedText':_0x2018c8[_0x30e0c0(0x5e,-0xe,0x40,0x22)](tagsToJsonString,_0x405372),'tagMap':_0x632f6c};}function _0x429d(_0x58ad03,_0x3de92b){_0x58ad03=_0x58ad03-(-0x2*-0x2f6+0x5*0xce+-0x1*0x977);const _0x29f3cc=_0x3e1f();let _0x5c021e=_0x29f3cc[_0x58ad03];if(_0x429d['YspgEI']===undefined){var _0x2c0514=function(_0x326cd7){const _0x5e1c7a='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x39c1eb='',_0x2f5267='',_0xf0350b=_0x39c1eb+_0x2c0514;for(let _0x104d1a=0x1*0xc0e+-0x18b0+0x2*0x651,_0x470134,_0x19988a,_0x3696be=-0x5f*0x31+-0xa78+0x5*0x5bb;_0x19988a=_0x326cd7['charAt'](_0x3696be++);~_0x19988a&&(_0x470134=_0x104d1a%(-0x1328+-0x1*-0x1cd0+-0x9a4)?_0x470134*(0x24d*-0x7+0x1a14+-0x83*0x13)+_0x19988a:_0x19988a,_0x104d1a++%(0x1245+0x15a8+-0x27e9))?_0x39c1eb+=_0xf0350b['charCodeAt'](_0x3696be+(-0x270+0x1664+-0x1*0x13ea))-(0x1*0xc6+0x1b80+-0x4*0x70f)!==-0x16ef+-0x6be+0x1dad?String['fromCharCode'](0xea*-0x9+-0x851*-0x1+0xe8&_0x470134>>(-(-0x5fd+-0x1bbc+-0x9d*-0x37)*_0x104d1a&0x2116+-0x18c3+-0x84d)):_0x104d1a:0x1708+-0x1087+-0x681){_0x19988a=_0x5e1c7a['indexOf'](_0x19988a);}for(let _0x2ee293=0x1fd4+0x107c+-0xc14*0x4,_0x3e6d50=_0x39c1eb['length'];_0x2ee293<_0x3e6d50;_0x2ee293++){_0x2f5267+='%'+('00'+_0x39c1eb['charCodeAt'](_0x2ee293)['toString'](-0x11d9*-0x1+0xb1f*0x1+-0x39d*0x8))['slice'](-(-0x35f*-0x1+-0xc87+0x92a));}return decodeURIComponent(_0x2f5267);};_0x429d['zhcXLC']=_0x2c0514,_0x429d['lSTYMa']={},_0x429d['YspgEI']=!![];}const _0x546b3b=_0x29f3cc[-0x22c5+-0xd9*0x1d+0x3b5a],_0x375a1d=_0x58ad03+_0x546b3b,_0x1dcfc6=_0x429d['lSTYMa'][_0x375a1d];if(!_0x1dcfc6){const _0x15a600=function(_0x572c84){this['rOFKfh']=_0x572c84,this['YEgHTf']=[-0x44*0x17+-0x21d1+0x27ee,-0xde5+-0x22*0x8f+0x20e3,0x1*-0xd1c+0x43f*0x6+0x2*-0x62f],this['AeUHbs']=function(){return'newState';},this['ycoPvk']='\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*',this['YfbCss']='[\x27|\x22].+[\x27|\x22];?\x20*}';};_0x15a600['prototype']['ZPlART']=function(){const _0x33b763=new RegExp(this['ycoPvk']+this['YfbCss']),_0x4b36f0=_0x33b763['test'](this['AeUHbs']['toString']())?--this['YEgHTf'][0x22db+0x807+-0xe4b*0x3]:--this['YEgHTf'][-0x20ab+0x1*0x1903+0x7a8];return this['NoXpYl'](_0x4b36f0);},_0x15a600['prototype']['NoXpYl']=function(_0x29de00){if(!Boolean(~_0x29de00))return _0x29de00;return this['WfYDDI'](this['rOFKfh']);},_0x15a600['prototype']['WfYDDI']=function(_0x445548){for(let _0x1cc097=-0x989+-0x78d*-0x4+-0x25*0x8f,_0x5050a7=this['YEgHTf']['length'];_0x1cc097<_0x5050a7;_0x1cc097++){this['YEgHTf']['push'](Math['round'](Math['random']())),_0x5050a7=this['YEgHTf']['length'];}return _0x445548(this['YEgHTf'][-0x19*0x17+0x1341+-0x1102]);},new _0x15a600(_0x429d)['ZPlART'](),_0x5c021e=_0x429d['zhcXLC'](_0x5c021e),_0x429d['lSTYMa'][_0x375a1d]=_0x5c021e;}else _0x5c021e=_0x1dcfc6;return _0x5c021e;}export function combineTranslationResult(_0x5c7bdb,_0x6c066b){function _0x458f66(_0x4df070,_0x33f253,_0x4be4d9,_0x43a7d3){return _0x429d(_0x4be4d9-0x3a8,_0x33f253);}const _0x520252={'uJIGN':_0x431300(0x194,0x1f4,0x202,0x1ec)+'+$','sYJDl':function(_0x1152b0,_0xe10ce4){return _0x1152b0!==_0xe10ce4;},'AQCQV':function(_0x502989){return _0x502989();},'qZIle':function(_0xfdb6c,_0x389297){return _0xfdb6c(_0x389297);},'gCDPC':_0x458f66(0x488,0x470,0x476,0x4a1),'LcFTY':function(_0x2a3d4e,_0xedd61e){return _0x2a3d4e===_0xedd61e;},'zBqoz':_0x458f66(0x4c7,0x4a0,0x49c,0x44d),'iJnHb':_0x458f66(0x470,0x44b,0x490,0x4ea),'OqnKg':'object','xhJVx':function(_0x10998b,_0x336792){return _0x10998b!==_0x336792;},'bbOXa':_0x431300(0x2b4,0x228,0x2d4,0x27c)};if(!_0x5c7bdb||!Array[_0x431300(0x256,0x234,0x213,0x26a)](_0x5c7bdb))return _0x520252[_0x431300(0x28e,0x273,0x259,0x245)]!==_0x458f66(0x4d1,0x4c3,0x490,0x457)?_0xc7147a[_0x458f66(0x4bc,0x4bd,0x49e,0x4a3)]()[_0x431300(0x1eb,0x1fc,0x28f,0x238)](gnyWjz[_0x458f66(0x425,0x409,0x449,0x440)])['toString']()['constructo'+'r'](_0x13acbc)[_0x458f66(0x4ab,0x43c,0x474,0x445)](_0x431300(0x213,0x1f4,0x22f,0x1ec)+'+$'):[];const _0x12311d={};if(_0x6c066b&&_0x520252[_0x458f66(0x46f,0x3fc,0x453,0x41f)](typeof _0x6c066b,_0x520252[_0x458f66(0x4dd,0x461,0x4a8,0x4a5)])){if(_0x520252[_0x431300(0x230,0x25d,0x213,0x25f)](_0x520252[_0x458f66(0x41d,0x3e8,0x441,0x41c)],_0x431300(0x2d8,0x271,0x249,0x283)))for(const [_0x25cac2,_0x5ca2ee]of Object[_0x431300(0x2c8,0x27b,0x24d,0x284)](_0x6c066b)){_0x12311d[_0x25cac2[_0x458f66(0x485,0x496,0x45b,0x455)+'e']()]=_0x5ca2ee;}else _0x3e5976[_0x541094[_0x431300(0x25f,0x1fb,0x279,0x21f)+'e']()]=_0x1cfa1d;}function _0x431300(_0x5400f1,_0xa22e2b,_0xfd9cea,_0x35f422){return _0x429d(_0x35f422-0x16c,_0xfd9cea);}return _0x5c7bdb[_0x431300(0x270,0x2a9,0x2b9,0x267)](_0x2a71e2=>{function _0x266f52(_0x4a54f6,_0xf902a9,_0x36ccc3,_0x315820){return _0x431300(_0x4a54f6-0x90,_0xf902a9-0xbe,_0x315820,_0xf902a9- -0x481);}const _0x49f16f={'vfYKX':function(_0x51728d,_0x2b6c93){return _0x520252['qZIle'](_0x51728d,_0x2b6c93);},'FgUwx':_0x520252['gCDPC']};function _0x152478(_0x305567,_0x3892ee,_0x322008,_0x1e8aec){return _0x458f66(_0x305567-0x83,_0x3892ee,_0x322008- -0x389,_0x1e8aec-0x2e);}if(_0x520252[_0x152478(0xa8,0xa1,0xca,0x91)](_0x520252[_0x152478(0xc9,0xf2,0xae,0xdf)],_0x520252[_0x266f52(-0x2b8,-0x286,-0x242,-0x294)])){const {original:_0x26bbde,cleaned:_0xc87284,skip:_0x3997c2}=_0x2a71e2;if(_0x3997c2){const _0x3e61d2={};return _0x3e61d2[_0x152478(0x13e,0x112,0xfb,0x10c)]=_0x26bbde,_0x3e61d2[_0x266f52(-0x21e,-0x25f,-0x22a,-0x227)+'n']='',_0x3e61d2['cleaned']=_0xc87284,_0x3e61d2[_0x152478(0x95,0xb2,0x9d,0x6b)]=!![],_0x3e61d2;}const _0x48dc85=_0x12311d[_0xc87284['toLowerCas'+'e']()]||'',_0x43f779={};return _0x43f779[_0x152478(0xa5,0x12d,0xfb,0xe8)]=_0x26bbde,_0x43f779[_0x266f52(-0x263,-0x25f,-0x22e,-0x2b6)+'n']=_0x48dc85,_0x43f779[_0x152478(0xc9,0xce,0xd6,0xda)]=_0xc87284,_0x43f779[_0x152478(0xa7,0xb9,0x9d,0xe5)]=![],_0x43f779;}else{const _0x588c19={'MZAAk':function(_0x144e51,_0x4862d2){function _0x3f0d1e(_0x465b58,_0xa7e05a,_0x25745f,_0x9a2d13){return _0x266f52(_0x465b58-0x1b3,_0x25745f-0x5f9,_0x25745f-0x21,_0xa7e05a);}return _0x520252[_0x3f0d1e(0x359,0x37a,0x38d,0x3bd)](_0x144e51,_0x4862d2);},'vgKcS':function(_0x1d17d7,_0x17a9aa){return _0x1d17d7(_0x17a9aa);}},_0x405fd1=_0x520252[_0x266f52(-0x1f0,-0x202,-0x256,-0x1aa)](_0x3d2474);_0xae2646[_0x152478(0x12f,0x154,0x105,0xe6)](_0x152478(0xf0,0xa9,0xe5,0xbb)+_0x152478(0x140,0x112,0x104,0x153)+_0x152478(0xde,0x60,0xb1,0xf5)+_0x405fd1+')');const _0x204efe=_0x38f624=>{if(_0x588c19[_0x217caf(-0x145,-0xef,-0xfc,-0x13e)](_0x38f624['id'],_0x405fd1))return;_0xe469cc[_0x217caf(-0x124,-0x122,-0x10c,-0xd7)+_0x217caf(-0x140,-0x170,-0x108,-0x196)](_0x46ad7d['LLM_TRANSL'+_0x51c540(0x30a,0x35c,0x332,0x2c5)+_0x51c540(0x33d,0x2f0,0x307,0x37c)+'PONSE'],_0x204efe);function _0x51c540(_0xecdab7,_0x2bfac5,_0x214bfa,_0x2fe756){return _0x152478(_0xecdab7-0x1ad,_0x2fe756,_0xecdab7-0x1f2,_0x2fe756-0x15e);}const {prompt:_0x39f69b}=_0x38f624;_0x35c727[_0x217caf(-0xfa,-0xe4,-0x102,-0xd9)](_0x51c540(0x2d7,0x314,0x30f,0x323)+_0x51c540(0x2db,0x332,0x2d6,0x29c)+_0x217caf(-0xe8,-0x135,-0x11f,-0xa5)+_0x405fd1+'):',_0x39f69b);function _0x217caf(_0x73d7c2,_0x2f57e0,_0x5d67fe,_0x2b6790){return _0x266f52(_0x73d7c2-0xbb,_0x73d7c2-0x135,_0x5d67fe-0xb,_0x2b6790);}_0x588c19[_0x217caf(-0x10b,-0xce,-0xe4,-0xfa)](_0x133aad,_0x39f69b);};_0x159d1b['on'](_0x4c7ac9[_0x152478(0x131,0x8f,0xe0,0xd8)+_0x266f52(-0x246,-0x21c,-0x256,-0x1c9)+_0x266f52(-0x228,-0x1e9,-0x1fb,-0x21b)+_0x266f52(-0x2a9,-0x288,-0x2b8,-0x25a)],_0x204efe);const _0x4bf53a={};_0x4bf53a['id']=_0x405fd1,_0x194b04[_0x152478(0xab,0x137,0xe6,0xa8)](_0x31a013[_0x266f52(-0x255,-0x254,-0x26e,-0x25a)+_0x152478(0x11c,0xe4,0x118,0x14d)+_0x152478(0xe4,0xff,0xdc,0xcb)+_0x152478(0xd1,0x118,0x12b,0x108)],_0x4bf53a),_0x5e49f3(()=>{_0xe0aa4f[_0x47c06d(-0x22f,-0x252,-0x253,-0x232)+_0x47c06d(-0x272,-0x235,-0x26f,-0x217)](_0x14ea86[_0x55fbbf(0x116,0x108,0xe5,0xff)+_0x47c06d(-0x202,-0x1ef,-0x216,-0x1c5)+_0x55fbbf(0x181,0x145,0x130,0x1ad)+'PONSE'],_0x204efe);function _0x55fbbf(_0x26deff,_0x231458,_0x54d0dd,_0x5952a0){return _0x266f52(_0x26deff-0xd2,_0x26deff-0x36a,_0x54d0dd-0x1ee,_0x54d0dd);}function _0x47c06d(_0x1d75b8,_0x2d4d75,_0x8c587d,_0x2a3ecb){return _0x266f52(_0x1d75b8-0x12e,_0x8c587d-0x6,_0x8c587d-0x3c,_0x1d75b8);}_0x49f16f[_0x55fbbf(0x180,0x176,0x184,0x163)](_0x2152b4,new _0x3a726d(_0x49f16f[_0x55fbbf(0x179,0x14b,0x130,0x16a)]));},-0x16*0x34d+-0x2bb6+0x9b64);}});}export function formatTranslationDisplay(_0x1bb269,_0x30d9fb={}){const _0x5e3390={};function _0x1fb240(_0x1c6637,_0x4b98cf,_0x1772d5,_0xedd6a4){return _0x429d(_0x1772d5-0x283,_0x1c6637);}_0x5e3390[_0x1fb240(0x31c,0x359,0x32d,0x328)]='XvBzD';const _0x23d290=_0x5e3390,{separator:separator=',\x20',showOriginal:showOriginal=!![],showTranslation:showTranslation=!![]}=_0x30d9fb;if(!_0x1bb269||!Array[_0x54b811(0x328,0x31f,0x323,0x2d1)](_0x1bb269))return'';function _0x54b811(_0x225e94,_0xdf5446,_0x1fc2b,_0x3b60ed){return _0x429d(_0x225e94-0x22a,_0xdf5446);}return _0x1bb269[_0x54b811(0x325,0x2cb,0x2eb,0x308)](_0x52f05b=>{function _0x3294fd(_0x34d22a,_0x1d9aca,_0x518724,_0x9e2784){return _0x54b811(_0x34d22a- -0x468,_0x1d9aca,_0x518724-0xdc,_0x9e2784-0x2b);}if(_0x52f05b[_0x3294fd(-0x1c0,-0x186,-0x1bf,-0x1a2)])return showOriginal?_0x52f05b['original']:'';const _0x3b2c30=[];if(showOriginal)_0x3b2c30[_0x3294fd(-0x197,-0x195,-0x192,-0x18d)](_0x52f05b[_0x29af80(-0x2c8,-0x28b,-0x295,-0x2f2)]);if(showTranslation&&_0x52f05b[_0x3294fd(-0x188,-0x153,-0x187,-0x16b)+'n']){if(_0x23d290['ZHnLq']!==_0x23d290[_0x3294fd(-0x194,-0x1a6,-0x156,-0x1b5)]){const _0x11f460=_0x188219['trim']();if(_0x11f460)_0x26379a['push'](_0x11f460);_0x3b00e1='';}else _0x3b2c30[_0x29af80(-0x2fd,-0x2cd,-0x2f2,-0x2d2)]('('+_0x52f05b[_0x3294fd(-0x188,-0x1bf,-0x1b3,-0x139)+'n']+')');}function _0x29af80(_0x5d416e,_0x337044,_0x15e6f2,_0x55bfb8){return _0x1fb240(_0x55bfb8,_0x337044-0x7,_0x5d416e- -0x627,_0x55bfb8-0xab);}return _0x3b2c30[_0x29af80(-0x2d3,-0x28d,-0x307,-0x2e5)]('\x20');})[_0x54b811(0x350,0x31f,0x33f,0x353)](Boolean)['join'](separator);}export async function translatePromptTags(_0x8b54b9){const _0x3f35ff={'uNzoh':function(_0x22e71a){return _0x22e71a();},'tRrUm':function(_0x23b607,_0x4d6a8d){return _0x23b607(_0x4d6a8d);},'lDikK':function(_0x118dad,_0x30c67c){return _0x118dad(_0x30c67c);},'RURwH':_0x4965a5(0x76,0x4c,0x50,0x40),'jnhQr':_0x550edc(0x26a,0x24d,0x269,0x210),'FwubI':function(_0x13c0bd,_0x19609c){return _0x13c0bd===_0x19609c;},'oRFSb':'ioIhT','ocEfn':function(_0x3881fa,_0x13fc27){return _0x3881fa(_0x13fc27);},'eDjpX':function(_0x3a42ee,_0x4583bd){return _0x3a42ee(_0x4583bd);},'iTPKB':function(_0x2fab37,_0x2f54c4,_0x26bef4){return _0x2fab37(_0x2f54c4,_0x26bef4);},'bJAdw':_0x550edc(0x22b,0x221,0x1eb,0x1e7)+'\x20翻译提示词标签失败'+':'};function _0x550edc(_0x1638df,_0x298f56,_0x3f1f2a,_0x5e0dcb){return _0x429d(_0x5e0dcb-0x121,_0x298f56);}const {originalTags:_0x50f695,cleanedText:_0x15c657}=_0x3f35ff[_0x550edc(0x220,0x197,0x1d9,0x1f0)](preprocessPromptForTranslation,_0x8b54b9);if(!_0x15c657){if(_0x3f35ff[_0x4965a5(-0xc,0x2a,-0x23,-0xc)]===_0x3f35ff[_0x550edc(0x1c1,0x18f,0x164,0x1ac)])_0x3f35ff[_0x4965a5(0x65,0x6d,0x47,0x91)](_0x30a070),_0x3f35ff[_0x550edc(0x1b1,0x208,0x241,0x1f0)](_0x3d1fc6,new _0x3b80f8(_0x550edc(0x279,0x25c,0x1db,0x229)+'时（'+_0x36d3a6+_0x4965a5(0x74,0x52,0x2a,0x25)));else{const _0x4b0923={};return _0x4b0923[_0x550edc(0x1d7,0x238,0x1d0,0x1f4)]=[],_0x4b0923[_0x550edc(0x215,0x1ed,0x297,0x242)+'t']='',_0x4b0923['originalTa'+'gs']=[],_0x4b0923;}}function _0x4965a5(_0x355846,_0x110815,_0x17c67b,_0x13e79a){return _0x429d(_0x355846- -0xb1,_0x13e79a);}try{if(_0x3f35ff[_0x550edc(0x201,0x251,0x27a,0x241)]('ioIhT',_0x3f35ff[_0x550edc(0x23d,0x21d,0x21e,0x201)])){const _0x351c04=await _0x3f35ff[_0x4965a5(-0x23,0xc,0x28,0x35)](callTranslation,_0x15c657),_0x5babe3=_0x3f35ff[_0x550edc(0x1b6,0x221,0x212,0x208)](parseTranslationResult,_0x351c04),_0x383b4f=_0x3f35ff[_0x550edc(0x1c0,0x230,0x24e,0x216)](combineTranslationResult,_0x50f695,_0x5babe3),_0x1b6842=formatTranslationDisplay(_0x383b4f),_0x200522={};return _0x200522['results']=_0x383b4f,_0x200522[_0x550edc(0x24e,0x296,0x208,0x242)+'t']=_0x1b6842,_0x200522['originalTa'+'gs']=_0x50f695,_0x200522;}else _0x3f35ff['lDikK'](_0x4cf824,_0x45e189['result']);}catch(_0x25fca6){console[_0x550edc(0x28c,0x286,0x1f0,0x23e)](_0x3f35ff[_0x550edc(0x222,0x24f,0x250,0x226)],_0x25fca6);throw _0x25fca6;}}export function parseTranslationResult(_0x2c4ce1){function _0x3ed0e1(_0x2581bc,_0x194423,_0xfe455a,_0x53f3f6){return _0x429d(_0x194423-0x60,_0x53f3f6);}const _0x1c3f6a={'jKBBn':'object','wgsTV':function(_0x4e6e1f,_0x16a127){return _0x4e6e1f!==_0x16a127;},'EOXqC':function(_0x304d8b,_0x4d3ea5){return _0x304d8b===_0x4d3ea5;},'ptPQL':'oWwab','SHnaU':_0x3ed0e1(0xfe,0x126,0x113,0x114)+_0x16761d(0x220,0x27a,0x277,0x20c)+_0x3ed0e1(0x13f,0xfd,0xd0,0xe6),'rBFmP':function(_0x542e88,_0x121b09){return _0x542e88(_0x121b09);},'RrMTT':function(_0x43a15b,_0x513c16){return _0x43a15b>_0x513c16;},'inuTR':function(_0x29592e,_0x32a0c0){return _0x29592e+_0x32a0c0;}};if(!_0x2c4ce1)return{};try{const _0xcf6aea=_0x2c4ce1[_0x3ed0e1(0x123,0x10e,0x164,0xf7)](/\{[\s\S]*\}/);if(_0xcf6aea){const _0x31de5d=JSON[_0x3ed0e1(0x1bc,0x16b,0x147,0x1c5)](_0xcf6aea[0x4b3*0x2+-0x1920+0xfba]);if(typeof _0x31de5d===_0x1c3f6a[_0x16761d(0x1fb,0x1f3,0x1db,0x1b5)]&&_0x1c3f6a[_0x3ed0e1(0x13a,0x17e,0x198,0x130)](_0x31de5d,null))return _0x31de5d;}}catch(_0xab9320){if(_0x1c3f6a[_0x16761d(0x1ec,0x1ee,0x1c3,0x1f1)](_0x1c3f6a['ptPQL'],_0x1c3f6a[_0x16761d(0x20b,0x1d4,0x1ec,0x246)]))console[_0x3ed0e1(0x1e3,0x18a,0x1ad,0x1b0)](_0x1c3f6a['SHnaU'],_0xab9320['message']);else{const _0x19346e={};return _0x19346e[_0x3ed0e1(0x15f,0x13c,0x13a,0xff)]=_0x1130b9,_0x19346e[_0x3ed0e1(0x160,0x116,0x140,0x12e)+'n']='',_0x19346e[_0x3ed0e1(0xf5,0x117,0xe5,0x113)]=_0x4b3747,_0x19346e['skipped']=!![],_0x19346e;}}const _0x40a576=_0x1c3f6a[_0x3ed0e1(0x149,0xf5,0xb7,0xdb)](String,_0x2c4ce1)['replace'](/[\r\n]+/g,'\x20')[_0x3ed0e1(0x151,0x161,0x146,0x13e)](/^[\s"'`]+|[\s"'`]+$/g,'')[_0x16761d(0x211,0x1de,0x214,0x23b)]();function _0x16761d(_0x354eb6,_0x18acda,_0x3757d3,_0x250220){return _0x429d(_0x354eb6-0x12e,_0x3757d3);}const _0x16a04f=_0x40a576[_0x16761d(0x251,0x229,0x26d,0x202)](/[,，]/)[_0x3ed0e1(0x189,0x15b,0x13b,0x10b)](_0x2774c9=>_0x2774c9[_0x3ed0e1(0x172,0x143,0x19b,0x162)]())[_0x3ed0e1(0x1bb,0x186,0x1b4,0x12d)](Boolean),_0x67e6c3={};for(const _0x2d03c9 of _0x16a04f){const _0x27ad29=_0x2d03c9[_0x16761d(0x1f6,0x212,0x217,0x227)]('\x5c');if(_0x1c3f6a[_0x3ed0e1(0x18c,0x13a,0x15b,0x131)](_0x27ad29,0x4*-0x2ae+-0xb*0x62+-0xe*-0x111)){const _0x5da386=_0x2d03c9['slice'](0x5c*-0x22+0x2*-0x653+0x18de,_0x27ad29)[_0x3ed0e1(0x15a,0x143,0x148,0xf5)](),_0x31de84=_0x2d03c9[_0x16761d(0x1c2,0x195,0x16f,0x210)](_0x1c3f6a[_0x16761d(0x231,0x26f,0x258,0x1e7)](_0x27ad29,0x214d+-0x1*0x1471+0x3*-0x449))[_0x16761d(0x211,0x21c,0x216,0x249)]();if(_0x5da386)_0x67e6c3[_0x5da386]=_0x31de84;}}return _0x67e6c3;}function generateRequestId(){const _0x96b473={};_0x96b473[_0x5eb7c6(0x198,0x1b5,0x1a4,0x16f)]=function(_0x52852c,_0x28e769){return _0x52852c!==_0x28e769;};function _0x5eb7c6(_0xf662d3,_0x12b4ac,_0x2eaae7,_0x1ce7ff){return _0x429d(_0xf662d3-0xfc,_0x2eaae7);}_0x96b473[_0x3200f4(-0x142,-0x142,-0x12b,-0x172)]=_0x3200f4(-0xee,-0x13b,-0x18c,-0x127);function _0x3200f4(_0x276ccf,_0x27f713,_0x5bef49,_0x2b79e8){return _0x429d(_0x27f713- -0x1cc,_0x5bef49);}_0x96b473[_0x5eb7c6(0x218,0x232,0x231,0x1e0)]='TeTIp',_0x96b473[_0x3200f4(-0x152,-0x117,-0x167,-0xd1)]=function(_0xec9914,_0x447237){return _0xec9914+_0x447237;};const _0x56f03f=_0x96b473;if(crypto&&crypto[_0x5eb7c6(0x1a2,0x1b8,0x193,0x1f2)]){if(_0x56f03f['aCcOy'](_0x56f03f[_0x3200f4(-0x17b,-0x142,-0xff,-0x17b)],_0x56f03f[_0x5eb7c6(0x218,0x200,0x1d3,0x268)]))return crypto[_0x5eb7c6(0x1a2,0x1fb,0x16b,0x18d)]();else{if(!_0x1ad4ce[_0x3200f4(-0xaa,-0xce,-0x9a,-0x114)](_0x159220))return'[]';return _0x484ab3[_0x5eb7c6(0x20e,0x1dc,0x20a,0x1d9)](_0x1499d3['filter'](_0x1b24ce=>_0x1b24ce&&typeof _0x1b24ce===_0x5eb7c6(0x1ce,0x199,0x189,0x1db)));}}return _0x56f03f[_0x3200f4(-0xdf,-0x117,-0x11f,-0x114)](Date[_0x5eb7c6(0x180,0x12a,0x15a,0x154)]()[_0x5eb7c6(0x1f2,0x239,0x19c,0x1cb)](0x5*0x51e+0x1*0x23d3+-0xc41*0x5),Math[_0x3200f4(-0x175,-0x146,-0x12e,-0x11a)]()[_0x5eb7c6(0x1f2,0x219,0x1e1,0x21f)](0x268b+-0x192b+-0xd3c)['substring'](0x1151+-0xe01+-0x9*0x5e));}export function LLM_TRANSLATION_GET_PROMPT(){function _0x1a3caf(_0x5a9b25,_0x1c4f50,_0x4e52dc,_0x1b9140){return _0x429d(_0x5a9b25- -0x3a3,_0x4e52dc);}const _0x2da2c0={'GUpAj':function(_0x64df58,_0x39f877){return _0x64df58!==_0x39f877;},'RjgIC':'获取翻译提示词超时','ITPnb':_0x1a3caf(-0x299,-0x2a9,-0x2ac,-0x240),'vcgOT':function(_0x2f03fb){return _0x2f03fb();},'xTWQs':function(_0x18c682,_0x20d35a,_0x25320b){return _0x18c682(_0x20d35a,_0x25320b);}};return new Promise((_0x25dd6e,_0x5a327c)=>{const _0x7df8c9={'iGbYU':function(_0x40a219,_0x46efbe){function _0x4dbe74(_0x146fda,_0x5ebe82,_0x1ae833,_0x3ce5f9){return _0x429d(_0x5ebe82- -0x332,_0x1ae833);}return _0x2da2c0[_0x4dbe74(-0x248,-0x25b,-0x210,-0x28e)](_0x40a219,_0x46efbe);},'uXFFJ':function(_0x113f3f,_0x2c3a17){return _0x113f3f(_0x2c3a17);},'RyZuN':_0x2da2c0[_0x5a54d6(0x1b6,0x1f8,0x1ad,0x1f7)],'OIBVr':_0x5a54d6(0x182,0x19a,0x1a8,0x1d7),'RXtrH':_0x2da2c0[_0x5a54d6(0x11a,0x13c,0x105,0x159)]},_0x446335=_0x2da2c0[_0x5a54d6(0x1ac,0x1b5,0x191,0x14c)](generateRequestId);function _0xfd6804(_0xe70839,_0x3b425f,_0x1c50bd,_0x358672){return _0x1a3caf(_0x1c50bd-0x5f8,_0x3b425f-0xd3,_0x358672,_0x358672-0x12d);}console[_0xfd6804(0x2f6,0x2f1,0x33b,0x334)](_0x5a54d6(0x134,0x14d,0x146,0x15a)+_0xfd6804(0x2e3,0x2f3,0x33a,0x345)+'\x20(ID:\x20'+_0x446335+')');const _0xce9e43=_0x8c757a=>{if(_0x7df8c9['iGbYU'](_0x8c757a['id'],_0x446335))return;eventSource[_0x3402d2(-0xa3,-0xb1,-0xca,-0xaf)+_0x3402d2(-0xbf,-0x81,-0xc1,-0x69)](eventNames[_0x39797e(0x3d0,0x415,0x3e5,0x40d)+_0x3402d2(-0x66,-0x38,-0x37,-0x23)+_0x39797e(0x43b,0x470,0x41e,0x46c)+'PONSE'],_0xce9e43);function _0x39797e(_0x447968,_0x543ddc,_0x166e1d,_0x32053d){return _0x5a54d6(_0x447968-0xd1,_0x166e1d,_0x447968-0x28f,_0x32053d-0x6a);}const {prompt:_0x844564}=_0x8c757a;function _0x3402d2(_0x3e4d1c,_0x3da4f6,_0x4ba8e5,_0x5c3447){return _0xfd6804(_0x3e4d1c-0x94,_0x3da4f6-0x5b,_0x3e4d1c- -0x3b4,_0x4ba8e5);}console[_0x39797e(0x3f5,0x414,0x420,0x3f1)](_0x3402d2(-0x99,-0x43,-0xd9,-0xa2)+'\x20已获取翻译提示词\x20'+_0x3402d2(-0x67,-0x1a,-0x1a,-0x57)+_0x446335+'):',_0x844564),_0x7df8c9[_0x3402d2(-0xe0,-0xb3,-0x117,-0x111)](_0x25dd6e,_0x844564);};eventSource['on'](eventNames[_0x5a54d6(0x101,0xfe,0x141,0x18b)+_0xfd6804(0x345,0x37c,0x34e,0x37f)+'PROMPT_RES'+_0x5a54d6(0x147,0xc4,0x10d,0x15c)],_0xce9e43);const _0x4740cd={};function _0x5a54d6(_0x3d8322,_0x2c7af0,_0x22368f,_0xdc49ab){return _0x1a3caf(_0x22368f-0x423,_0x2c7af0-0x1ef,_0x2c7af0,_0xdc49ab-0x1cf);}_0x4740cd['id']=_0x446335,eventSource[_0x5a54d6(0x14e,0x182,0x147,0x186)](eventNames['LLM_TRANSL'+_0x5a54d6(0x123,0x194,0x179,0x17f)+_0x5a54d6(0x174,0x113,0x13d,0x107)+'UEST'],_0x4740cd),_0x2da2c0[_0xfd6804(0x2ef,0x310,0x30e,0x2c2)](setTimeout,()=>{function _0xa8a35c(_0xbdcd3d,_0xaf5314,_0x4dc919,_0x484cb7){return _0x5a54d6(_0xbdcd3d-0x58,_0x4dc919,_0xaf5314- -0x37c,_0x484cb7-0xca);}function _0x205233(_0x4fac4a,_0x30155c,_0x5f091a,_0x2534ef){return _0xfd6804(_0x4fac4a-0xa3,_0x30155c-0x4f,_0x4fac4a-0x162,_0x2534ef);}const _0x467955={'IojaF':function(_0x59af69,_0x5c27bb){return _0x7df8c9['uXFFJ'](_0x59af69,_0x5c27bb);},'KbDag':_0x7df8c9['RyZuN']};_0x7df8c9[_0xa8a35c(-0x26b,-0x237,-0x224,-0x1fa)](_0x7df8c9[_0xa8a35c(-0x285,-0x23a,-0x1f3,-0x235)],_0x7df8c9['RXtrH'])?(eventSource[_0x205233(0x473,0x485,0x475,0x4c2)+_0x205233(0x457,0x480,0x4a7,0x474)](eventNames[_0xa8a35c(-0x1ff,-0x23b,-0x21f,-0x28f)+_0x205233(0x4b0,0x45a,0x493,0x4f8)+_0x205233(0x4e3,0x4e3,0x4b5,0x4d4)+_0xa8a35c(-0x2c8,-0x26f,-0x237,-0x21a)],_0xce9e43),_0x7df8c9[_0xa8a35c(-0x278,-0x27d,-0x274,-0x2a0)](_0x5a327c,new Error(_0x7df8c9[_0xa8a35c(-0x1e7,-0x21b,-0x205,-0x206)]))):(_0x4f248f[_0xa8a35c(-0x22f,-0x240,-0x284,-0x1eb)+_0x205233(0x457,0x4a2,0x495,0x440)](_0xa264fc[_0x205233(0x478,0x47f,0x453,0x46f)+'ATION_GET_'+'PROMPT_RES'+_0x205233(0x444,0x417,0x457,0x438)],_0x501caa),_0x467955[_0x205233(0x434,0x463,0x3f1,0x464)](_0x1430bb,new _0x28e0e5(_0x467955[_0x205233(0x4a0,0x4e9,0x4f3,0x4ce)])));},-0xd*-0x25+-0x6df*0x5+-0x478a*-0x1);});}export function LLM_TRANSLATION(_0x3d96de,{timeoutMs:timeoutMs=0xa6b+-0x3d*-0x187+0x82ca}={}){const _0x18b80a={'vlnZv':function(_0x3ecaa1,_0x620fa7){return _0x3ecaa1===_0x620fa7;},'QacBB':_0x47a2a5(0x83,0x95,0x6f,0x8d),'ITfkS':_0x47a2a5(0x5c,0x90,0x63,0x8a),'FYpvr':function(_0x250917,_0x398e36){return _0x250917!==_0x398e36;},'dFZxT':function(_0x3f2496,_0x208054){return _0x3f2496(_0x208054);},'wtwSA':_0x47a2a5(0x6c,0x53,0xa1,0x94),'ixIRu':_0x47a2a5(0xc1,0xc3,0x88,0xe1),'DcdHF':function(_0x595e76){return _0x595e76();},'RZOVQ':function(_0x19cb24,_0x392512){return _0x19cb24+_0x392512;},'aALZD':function(_0x4e08b3,_0x35503d){return _0x4e08b3!==_0x35503d;},'AGuOj':function(_0x41ee45,_0x53bd27){return _0x41ee45(_0x53bd27);},'ebywx':function(_0x4b9e30){return _0x4b9e30();},'iKJuD':function(_0x11c22c,_0x1ae823,_0x1b6cb3){return _0x11c22c(_0x1ae823,_0x1b6cb3);}};function _0x11098b(_0x1f16ad,_0x4f7e4e,_0x2f94cf,_0x24aad0){return _0x429d(_0x4f7e4e-0x7e,_0x2f94cf);}function _0x47a2a5(_0x2e49cb,_0x30088e,_0x35aa6b,_0x3bef82){return _0x429d(_0x35aa6b- -0x33,_0x30088e);}return new Promise((_0x2775d0,_0x25b44e)=>{const _0x4a08c3={'LkGMX':function(_0x495e40,_0x36cc0b){function _0x8de8a1(_0x85321a,_0x2eb8e7,_0x16ab71,_0x103e9f){return _0x429d(_0x16ab71-0xfd,_0x85321a);}return _0x18b80a[_0x8de8a1(0x1ab,0x24a,0x1ff,0x1c7)](_0x495e40,_0x36cc0b);},'ZIllp':function(_0x4d9d6d,_0x3950c4){function _0x3ec3a9(_0xfe90e4,_0x56eaf7,_0x4f4f86,_0x16ebb5){return _0x429d(_0x16ebb5- -0x263,_0xfe90e4);}return _0x18b80a[_0x3ec3a9(-0x14c,-0x1e3,-0x19c,-0x1a3)](_0x4d9d6d,_0x3950c4);},'VOLOr':_0x39e779(0x9a,0xea,0x95,0xc1),'HMUIn':function(_0x3feba1,_0x28cd51){function _0x24185c(_0x942451,_0x4a4e58,_0x5574a2,_0x55da38){return _0x39e779(_0x4a4e58,_0x5574a2-0x1b6,_0x5574a2-0x13f,_0x55da38-0x79);}return _0x18b80a[_0x24185c(0x250,0x20d,0x264,0x26d)](_0x3feba1,_0x28cd51);},'rhUvd':_0x18b80a[_0x39e779(0x159,0x10a,0x107,0xb4)],'UbdkI':function(_0x2cb8d6,_0x2e55dd){function _0x4b5f20(_0x3e63a6,_0xdcb157,_0x750eb9,_0x2bbd5f){return _0x39e779(_0x3e63a6,_0xdcb157- -0x27a,_0x750eb9-0x1c9,_0x2bbd5f-0xe6);}return _0x18b80a[_0x4b5f20(-0x1ba,-0x1fd,-0x229,-0x211)](_0x2cb8d6,_0x2e55dd);}},_0x43b9a0=_0x18b80a[_0xeef96(-0x73,-0x37,-0x65,-0x1)](generateRequestId);function _0x39e779(_0x216438,_0x3cdb9a,_0x27fe4f,_0x6952c0){return _0x11098b(_0x216438-0x10,_0x3cdb9a- -0x82,_0x216438,_0x6952c0-0x167);}console[_0xeef96(-0x7b,-0x3d,0x1a,-0x80)](_0x39e779(0xb0,0xc2,0x9e,0x110)+_0x39e779(0x6a,0x94,0xe8,0xd9)+_0x39e779(0xdc,0xf4,0xd0,0x10c)+_0x43b9a0+')');let _0x65cf07=null;function _0xeef96(_0x50760e,_0x59d6d1,_0x5675c9,_0x2f48ae){return _0x47a2a5(_0x50760e-0x1b,_0x5675c9,_0x59d6d1- -0xf0,_0x2f48ae-0x32);}const _0x4f5dc8=()=>{function _0x42cf63(_0x31f309,_0x43ad98,_0x125c68,_0x565541){return _0xeef96(_0x31f309-0x12f,_0x125c68- -0x23a,_0x565541,_0x565541-0xa3);}function _0x533db3(_0x477567,_0x1a3682,_0x261cc3,_0x2cd168){return _0x39e779(_0x2cd168,_0x1a3682- -0x90,_0x261cc3-0x1a1,_0x2cd168-0x4e);}const _0x488961={'qgoEY':function(_0x24023d,_0x32c689){return _0x4a08c3['LkGMX'](_0x24023d,_0x32c689);}};if(_0x4a08c3[_0x533db3(-0xd,0x1c,0x23,-0x1)]('lVdeC',_0x4a08c3[_0x533db3(0x1f,0x63,0x4e,0x82)])){eventSource[_0x42cf63(-0x257,-0x27f,-0x2a1,-0x2e2)+_0x42cf63(-0x2f7,-0x2e9,-0x2bd,-0x2b5)](eventNames[_0x42cf63(-0x26e,-0x2c9,-0x29c,-0x2c9)+_0x533db3(-0x4d,0x3,-0x43,0x1)+'ONSE'],_0x523b83);if(_0x65cf07)_0x4a08c3['HMUIn'](clearTimeout,_0x65cf07);}else{if(_0x474440&&_0x2ced84[_0x42cf63(-0x297,-0x2ae,-0x2b7,-0x2e1)])return _0x318ead[_0x42cf63(-0x2af,-0x309,-0x2b7,-0x297)]();return _0x488961[_0x42cf63(-0x247,-0x250,-0x254,-0x23d)](_0x363a26[_0x42cf63(-0x297,-0x331,-0x2d9,-0x28d)]()[_0x533db3(0xb4,0x62,0x27,0x48)](-0x1ee7+0x1a*-0x107+-0xb8d*-0x5),_0x3fbe42[_0x533db3(0x1d,-0xe,-0x47,-0x41)]()[_0x533db3(0x96,0x62,0x98,0xbb)](-0x62e+0x121b+0x1*-0xbc9)[_0x42cf63(-0x2ae,-0x2dc,-0x2ae,-0x2ee)](-0x1b63+-0xec7+0xa8b*0x4));}},_0x523b83=_0x328b60=>{function _0x2eb6d3(_0x1c5a14,_0xd1ee06,_0x3657cd,_0x3fdd6){return _0xeef96(_0x1c5a14-0x38,_0xd1ee06-0x447,_0x1c5a14,_0x3fdd6-0xa0);}function _0x1baa21(_0x1ecc95,_0x2e3c78,_0x34a91d,_0x47ac92){return _0x39e779(_0x34a91d,_0x2e3c78-0xd7,_0x34a91d-0x24,_0x47ac92-0x1a1);}if(_0x18b80a[_0x1baa21(0x22b,0x1f2,0x1a4,0x1bc)](_0x18b80a[_0x2eb6d3(0x3e4,0x3ef,0x413,0x3c4)],_0x18b80a[_0x2eb6d3(0x3de,0x3dc,0x389,0x433)])){const _0x5f2789=new _0x802ca7(_0x2460d9['error']['message']);_0x5f2789[_0x2eb6d3(0x3bb,0x415,0x419,0x3f0)]=_0x4a08c3[_0x2eb6d3(0x37c,0x3c3,0x3c7,0x3ab)],_0x4a08c3[_0x2eb6d3(0x403,0x423,0x3fb,0x45a)](_0x2755ea,_0x5f2789);}else{if(_0x18b80a[_0x1baa21(0x21f,0x1ed,0x1c8,0x198)](_0x328b60['id'],_0x43b9a0))return;_0x4f5dc8(),console['log'](_0x2eb6d3(0x436,0x3ea,0x440,0x39d)+_0x2eb6d3(0x42e,0x431,0x416,0x451)+_0x2eb6d3(0x373,0x3c8,0x417,0x415)+'\x20'+_0x43b9a0+'):',_0x328b60);if(_0x328b60[_0x1baa21(0x172,0x1ae,0x1b3,0x1d7)])_0x18b80a[_0x1baa21(0xfb,0x154,0x1a6,0x11a)](_0x2775d0,_0x328b60[_0x2eb6d3(0x37b,0x3ab,0x404,0x375)]);else{if(_0x18b80a[_0x1baa21(0x1dd,0x1f2,0x1ff,0x212)](_0x18b80a[_0x2eb6d3(0x3bb,0x3fa,0x3b7,0x3c9)],_0x1baa21(0x11e,0x15b,0x111,0x11e))){if(_0x36f043['id']!==_0x204f0c)return;_0x157f36[_0x1baa21(0x194,0x18f,0x18e,0x168)+_0x1baa21(0x159,0x173,0x15d,0x162)](_0x28af80[_0x1baa21(0x169,0x194,0x17f,0x1aa)+'ATION_GET_'+_0x1baa21(0x226,0x1ff,0x1bb,0x217)+'PONSE'],_0x30b15f);const {prompt:_0x47e740}=_0x49559f;_0x318702['log'](_0x2eb6d3(0x397,0x3ea,0x42f,0x409)+_0x1baa21(0x19a,0x19d,0x1a0,0x1a9)+'(ID:\x20'+_0x4baa78+'):',_0x47e740),_0x311762(_0x47e740);}else{if(_0x328b60[_0x1baa21(0x19c,0x1f0,0x1ca,0x1ec)]&&_0x18b80a[_0x2eb6d3(0x46b,0x443,0x426,0x415)](_0x328b60[_0x1baa21(0x19e,0x1f0,0x21b,0x1f5)][_0x2eb6d3(0x425,0x415,0x42d,0x430)],_0x18b80a['ixIRu'])){const _0x10c1fb=new Error(_0x328b60[_0x1baa21(0x1e3,0x1f0,0x19c,0x1d8)][_0x1baa21(0x13b,0x155,0x183,0x10a)]);_0x10c1fb['name']=_0x18b80a[_0x1baa21(0x1ee,0x1e1,0x20f,0x236)],_0x18b80a[_0x1baa21(0x177,0x154,0x10d,0x104)](_0x25b44e,_0x10c1fb);}else _0x18b80a['dFZxT'](_0x25b44e,new Error(_0x328b60[_0x1baa21(0x19b,0x15a,0x1ae,0x1a7)]));}}}};eventSource['on'](eventNames[_0x39e779(0x80,0xbd,0x79,0x80)+_0xeef96(-0x86,-0x8c,-0x79,-0xcb)+_0x39e779(0x117,0xf9,0x134,0xff)],_0x523b83);const _0x4a97d1={};_0x4a97d1[_0xeef96(-0x37,-0x8,-0x5d,0x41)]=_0x3d96de,_0x4a97d1['id']=_0x43b9a0,eventSource['emit'](eventNames[_0xeef96(-0x36,-0x62,-0x50,-0x46)+_0x39e779(0xf7,0xbb,0x82,0x109)+_0xeef96(-0x100,-0xa7,-0xf5,-0xfa)],_0x4a97d1),_0x65cf07=_0x18b80a['iKJuD'](setTimeout,()=>{function _0x331977(_0x5acae5,_0x444fee,_0x2e75c4,_0x292a7d){return _0xeef96(_0x5acae5-0xf2,_0x444fee-0xc7,_0x2e75c4,_0x292a7d-0x1ac);}function _0x3cd9ff(_0x3b31a2,_0x304528,_0x2e407c,_0x1daacc){return _0xeef96(_0x3b31a2-0x1bc,_0x3b31a2-0xbd,_0x1daacc,_0x1daacc-0x1e9);}_0x18b80a['DcdHF'](_0x4f5dc8),_0x18b80a['dFZxT'](_0x25b44e,new Error(_0x331977(0x5d,0xac,0x58,0xcc)+'时（'+timeoutMs+_0x331977(0x92,0xc9,0x9e,0xdf)));},timeoutMs);});}export async function callTranslation(_0x42a3a0){function _0x88d227(_0x38471c,_0x3421dd,_0xbe454d,_0x4959d9){return _0x429d(_0x4959d9- -0x111,_0x38471c);}function _0x118485(_0x11598a,_0x111950,_0x2bd046,_0x57d65f){return _0x429d(_0x57d65f-0x2ab,_0x111950);}const _0x245716={'ikmQt':_0x88d227(-0x3b,0x8,-0x84,-0x4b)+_0x118485(0x37c,0x34b,0x35c,0x33e)+_0x118485(0x3b2,0x400,0x3b1,0x3ba),'dQnVf':function(_0xcacafe,_0x10b29c){return _0xcacafe!==_0x10b29c;},'sTAil':_0x88d227(-0x56,-0x44,0x10,-0x2f),'SpYvW':'translatio'+'n','mECbM':function(_0x18810b,_0x509f16){return _0x18810b(_0x509f16);},'BBPDH':_0x118485(0x368,0x367,0x2fe,0x357),'ovSRd':function(_0x26a064,_0x10fef5){return _0x26a064||_0x10fef5;},'GdJeI':_0x88d227(-0x94,-0x94,-0xc6,-0x85),'hobJq':'翻译失败:'};try{if(_0x245716[_0x118485(0x3db,0x3e6,0x3d9,0x3c4)](_0x245716[_0x118485(0x377,0x317,0x344,0x33b)],'qdxZt'))_0x2c0514[_0x118485(0x322,0x310,0x2fb,0x352)](_0x546b3b),_0x375a1d[_0x88d227(-0x5,-0x63,-0x5f,-0x21)](_0x1dcfc6['toLowerCas'+'e'](),_0x326cd7);else{let _0x36a9cd=buildPromptForRequestType(_0x245716[_0x88d227(-0x31,-0x99,-0x9b,-0x60)],_0x42a3a0||'');_0x36a9cd=_0x245716[_0x118485(0x3d3,0x3d1,0x35f,0x3b2)](mergeAdjacentMessages,_0x36a9cd);const _0x34dbeb=[..._0x36a9cd,{'role':_0x245716[_0x88d227(0x2d,-0x30,-0x31,-0x26)],'content':_0x245716[_0x88d227(-0x13,-0x49,0x19,-0xb)](_0x42a3a0,'')}];updateCombinedPrompt(_0x34dbeb);const _0x30386d=await _0x245716[_0x88d227(-0x35,-0x33,-0x17,-0xa)](LLM_TRANSLATION,_0x34dbeb);return _0x30386d;}}catch(_0x1d94ab){if(_0x118485(0x34d,0x336,0x3b0,0x38a)!==_0x245716[_0x118485(0x3da,0x38e,0x384,0x3a5)]){_0x245716[_0x88d227(-0x40,-0x30,-0xe,-0xa)](addLog,_0x118485(0x309,0x31e,0x30b,0x345)+_0x1d94ab[_0x88d227(-0xb5,-0xb0,-0x9a,-0x8f)]),console[_0x88d227(0x30,0x1f,-0x24,0xc)](_0x245716[_0x118485(0x3e1,0x3b6,0x40a,0x3c0)],_0x1d94ab);throw _0x1d94ab;}else _0x1d8c01['log'](_0x245716[_0x88d227(-0x3e,-0x91,-0x9c,-0x69)]),_0x1175e0=!![];}}let isAiInitialized=![];function _0x3e1f(){const _0x4c719c=['y3j1t3O','ioAjP+IHJoE7K+AENcaOsuq6','uLvsD0G','CMfUzg9Tvvvjra','ChvZAa','AwTTuxq','C1LkrgW','wKHUthe','tgngvfK','DxnLCG','ntK1nKHSy0TdAa','Bwf0y2G','C3vIC3rYAw5N','wKLSBha','u3bzDLC','quD1t2O','Dg9mB3DLCKnHCW','yxbWBhK','sfjbywi','DhjHBNnSyxrPBW','y2XLyw5Lza','svrMA1m','Efrxuxm','C29Tzq','qwjVCNrfCNjVCG','CMvTB3zLtgLZDa','ufjptvbux1jfuq','ru9yCum','qvrjt05FuKvrvq','yufmwKq','teXnx1rsqu5tta','t0LcvNi','BgvUz3rO','CLztBKG','AuDIwvu','C3qTy2HHDhu4oG','zw1PDa','Aw5KzxHpzG','C2TPCa','iow3SUIoT+wpLUE/U+IVKEApKoEKUUIVJsa','uwfJqKi','C2vHCMnO','AKTcqM4','6i635y+w57+76k+r5O+q56s66k+n6lAf5PE2','DfjYvw0','CejNAvC','AM9PBG','C3rYAw5N','CMvZDwX0CW','u0vPB2y','DMDly1m','D3r3u0e','r1vWqwO','CxvXCfK','AuPUsgi','uNjnvfq','C3vJy2vZCW','B3jPz2LUywW','ChrquuW','mJm5mg9JwxLbBq','DLjhrxy','B1jgu2i','uNLADu4','Cwr4wNq','DhjPBq','nteZmJuWyuLpyuLg','ioIVT+AXGUIoT+wpLUE/U+IVKEApKoEKUUIVJq','Bg9N','zurQCfG','qLzmCu8','s2jeywC','zuH6uKW','qKjqreG','zwj5D3G','D21Uyvi','r1rHsgK','wvDWvvO','C2v0','BMfTzq','iePtt07OP6pMNPdLPlhOTkxVViW','EgHkvNG','uMztEuS','Avrqs0i','Dg9tDhjPBMC','vK9mt3i','keLeoIa','qvrjt05Fr0vuxW','r2rkzuK','BwfW','y29UC3rYDwn0BW','t05trq','AxnbCNjHEq','vwjKA0K','t3fUs2C','CMvWBgfJzq','uLPpvLe','Aw51vfi','ntG0otuYz3bArLf3','yKPbzhC','B3ztuMq','BuvdyK0','57+76k+rieXmtsdMIAFOOyZOTOu','CwDVrvK','zgnvvxe','CgfYC2u','vuvtva','iow3SUAuTUwiSoE/U+IVKsbmte0','AxHjuNu','ieXmtsdORR7NVA7POBxPNAi','tKv4z2W','DMnNt1q','C3rYAw5NAwz5','qvfduvy','nJGXohfVANDXsW','Ag9IsNe','Du56B2G','vw5Utfi','zw50CMLLCW','zffUvMy','rLLWDNi','ChjVBxb0','q2rzvNy','zxjYB3i','D2DZvfy','DMXUwNy','rND1yKK','zgLZCgXHEvrLEa','mJyWsfzbz3n3','C3bSAxq','rMDvD3G','BxpVViK','zMLSDgvY','ALbWvwK','ELPiuLe','nJmYswjfuLbf','D2fYBG','DMzzs1G','ufjptvbux1jfuW','uMPNsum','otmYntDHBwPXCMy','rvnu','sw9Qyuy','C2TPChbLza','DvHgrKO','kcGOlISPkYKRkq','zezAEfq','BwvZC2fNzq','mZe3otK0vuTLBKjR','BM93','svrqBMi','CMfUzg9T','CMvZDwX0','wuLRrue','wLHnBNa','D29kAwm','AM5Ouxi','zNnkCeu','ue9ou0u','B2nfzM4','EKjXB3O','C1rbAwW','wwvvr0S','icHjrdOG','iefjioIUVUE9RUw3SUE7N+s4GowiSa','C2XPy2u','CKjgBva','CMTIEMK','qvrjt05FuKvtua','ioIVT+AXGUE/U+IVKsbmte0G','yMjpwge','57+76k+r5AsX6lsLoIa','tvPbqwS','yunJt3K','5BcD6k+v5PEN5Qc85BYpoG','ntrUzKr3Be4','CMHvDMq','zw5LCG','DuPjr04','wfbTv1a'];_0x3e1f=function(){return _0x4c719c;};return _0x3e1f();}export function initAiSettings(_0x102e38){const _0x58eedf={};_0x58eedf[_0x6396e7(-0xf9,-0x112,-0xf8,-0xc2)]=_0x6396e7(-0x99,-0xae,-0x81,-0x9f)+'\x20AI\x20设置已统一到'+_0x6396e7(-0x4a,-0x66,-0x2c,-0x56);const _0x555f1e=_0x58eedf;function _0x26d799(_0x3ef6f8,_0xe56718,_0x3a2335,_0x3dd949){return _0x429d(_0x3ef6f8- -0x8e,_0xe56718);}function _0x6396e7(_0x567d98,_0x3c0f4f,_0x233e82,_0x52ab51){return _0x429d(_0x52ab51- -0x165,_0x3c0f4f);}!isAiInitialized&&(console[_0x6396e7(-0x3d,-0x28,-0xab,-0x7f)](_0x555f1e[_0x26d799(0x15,-0x2c,-0x32,0x10)]),isAiInitialized=!![]);}