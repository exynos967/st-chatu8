function _0x5176(_0x25217e,_0x1e031e){_0x25217e=_0x25217e-(-0xef*-0xa+-0xf07*0x1+-0x3ce*-0x2);const _0x6c4e32=_0x1a76();let _0x34749d=_0x6c4e32[_0x25217e];if(_0x5176['fCNiei']===undefined){var _0x3a3272=function(_0x44777a){const _0x1265b0='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x2eb7e9='',_0x24eff9='',_0x47319f=_0x2eb7e9+_0x3a3272;for(let _0x342c8c=-0x19d0+-0x3*-0x923+-0x199,_0x29668a,_0x306619,_0x162033=0x21cc*-0x1+-0x1*0xecd+0x3099;_0x306619=_0x44777a['charAt'](_0x162033++);~_0x306619&&(_0x29668a=_0x342c8c%(-0x8*0xda+-0x162+0x836)?_0x29668a*(0x7b*-0x2e+0xb6d+0xaed)+_0x306619:_0x306619,_0x342c8c++%(0x1c4f+-0x1e1b+0x4*0x74))?_0x2eb7e9+=_0x47319f['charCodeAt'](_0x162033+(0xf2d+-0x1f5c+0x1039))-(-0x1ee9+-0x1*-0x8e+0x1e65)!==-0x1e*0x25+0x55*-0xb+0x7fd?String['fromCharCode'](-0x19*-0x8a+0x1fc0+-0x1*0x2c3b&_0x29668a>>(-(-0x2aa*0x5+0x365+0x1*0x9ef)*_0x342c8c&-0xe*-0xe5+-0xa0f+0x1*-0x271)):_0x342c8c:0x24a1+0x3*0xfb+0x5*-0x7ea){_0x306619=_0x1265b0['indexOf'](_0x306619);}for(let _0x151d7f=-0xae0+0x1*0x1f4b+-0x146b,_0x2a8c82=_0x2eb7e9['length'];_0x151d7f<_0x2a8c82;_0x151d7f++){_0x24eff9+='%'+('00'+_0x2eb7e9['charCodeAt'](_0x151d7f)['toString'](-0x1e59*-0x1+0x1*0x2601+-0x444a*0x1))['slice'](-(-0x15*0x1d+-0xbf*-0x19+0x1*-0x1044));}return decodeURIComponent(_0x24eff9);};_0x5176['phpWdz']=_0x3a3272,_0x5176['mhKvXM']={},_0x5176['fCNiei']=!![];}const _0x3f3d52=_0x6c4e32[-0x1fdd+-0x121*0x1d+0x409a],_0x12fd82=_0x25217e+_0x3f3d52,_0x168b21=_0x5176['mhKvXM'][_0x12fd82];if(!_0x168b21){const _0x2a008b=function(_0xf64ce6){this['NPhftr']=_0xf64ce6,this['IbECXM']=[0x1d2b*0x1+0x1*-0x14e7+-0x843,0x6eb+-0x1db2+-0x16c7*-0x1,0x1aaf*-0x1+-0x16a*-0x16+-0x46d],this['QPFFfo']=function(){return'newState';},this['dswbgc']='\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*',this['tzHyhn']='[\x27|\x22].+[\x27|\x22];?\x20*}';};_0x2a008b['prototype']['uRVhiU']=function(){const _0xcea402=new RegExp(this['dswbgc']+this['tzHyhn']),_0x3c7867=_0xcea402['test'](this['QPFFfo']['toString']())?--this['IbECXM'][-0x846+-0x42e*0x7+0x2589]:--this['IbECXM'][-0x1925+-0x4f*0x2+0x19c3];return this['leEItV'](_0x3c7867);},_0x2a008b['prototype']['leEItV']=function(_0x222465){if(!Boolean(~_0x222465))return _0x222465;return this['qJmgfn'](this['NPhftr']);},_0x2a008b['prototype']['qJmgfn']=function(_0x3bb8c7){for(let _0x54c15a=-0x1911+0xf7b+0x996,_0x3be693=this['IbECXM']['length'];_0x54c15a<_0x3be693;_0x54c15a++){this['IbECXM']['push'](Math['round'](Math['random']())),_0x3be693=this['IbECXM']['length'];}return _0x3bb8c7(this['IbECXM'][-0xed1+0x689*-0x4+0x28f5]);},new _0x2a008b(_0x5176)['uRVhiU'](),_0x34749d=_0x5176['phpWdz'](_0x34749d),_0x5176['mhKvXM'][_0x12fd82]=_0x34749d;}else _0x34749d=_0x168b21;return _0x34749d;}(function(_0x3f3ab8,_0x278152){function _0x535967(_0x17c70e,_0x89ceb3,_0x40b4c4,_0x4092e2){return _0x5176(_0x89ceb3- -0x2a9,_0x17c70e);}function _0x5bd27f(_0x24e07f,_0x1e651a,_0x28612c,_0x28ec85){return _0x5176(_0x28612c-0x311,_0x1e651a);}const _0x494503=_0x3f3ab8();while(!![]){try{const _0x24248d=-parseInt(_0x5bd27f(0x559,0x54d,0x58d,0x53c))/(-0xf2b+-0x1003*-0x2+0x10da*-0x1)+-parseInt(_0x535967(-0x23,-0x29,0x12,-0x68))/(-0xfc7*-0x1+-0xe*0x180+0x53b*0x1)+parseInt(_0x5bd27f(0x4f4,0x562,0x53a,0x562))/(-0x1*-0x20ca+-0x2562+0x83*0x9)*(parseInt(_0x5bd27f(0x585,0x5d2,0x58c,0x573))/(-0xec1+0x164*0x9+0x241*0x1))+parseInt(_0x535967(-0x72,-0x2b,-0x49,-0x59))/(-0x2349*-0x1+0x2166+-0x2*0x2255)+parseInt(_0x5bd27f(0x520,0x569,0x56b,0x57e))/(0xcf1*0x1+0x2*0x952+-0x1f8f)+parseInt(_0x535967(-0x6b,-0x63,-0x9f,-0xa3))/(0xf*-0xb+0x53c*-0x4+0x159c)*(parseInt(_0x5bd27f(0x522,0x5c1,0x56d,0x598))/(0x2*-0x680+-0x268e+0x3*0x1132))+-parseInt(_0x535967(-0x12,-0x32,-0x78,-0x51))/(-0x1182+0x1*0xace+0x19*0x45)*(parseInt(_0x535967(-0x6,-0x46,-0xa,0x4))/(-0x1*-0x17b+0x1ad8*0x1+-0x22d*0xd));if(_0x24248d===_0x278152)break;else _0x494503['push'](_0x494503['shift']());}catch(_0x4180a1){_0x494503['push'](_0x494503['shift']());}}}(_0x1a76,0x1*0x395d1+-0xb195+0x129d*-0xc));const _0x5ee872=(function(){const _0x2ba3dd={'eHuGw':function(_0xbb3b04,_0x36f181){return _0xbb3b04(_0x36f181);},'JxuCL':function(_0x1e2b51){return _0x1e2b51();}};let _0x5c49e8=!![];return function(_0x1a0041,_0x22cf88){const _0x37e1c7={'qkgLG':function(_0x29035b,_0xd18565){function _0x5367f6(_0x50f66f,_0x47d644,_0x5e930e,_0xd12031){return _0x5176(_0x5e930e-0x2ed,_0xd12031);}return _0x2ba3dd[_0x5367f6(0x4d7,0x560,0x526,0x4e2)](_0x29035b,_0xd18565);},'GLpkH':function(_0x2e5a12){function _0x419e00(_0x1fd16e,_0x140aea,_0x587ab4,_0x59fe44){return _0x5176(_0x1fd16e- -0x1f6,_0x140aea);}return _0x2ba3dd[_0x419e00(0x68,0x14,0x41,0x75)](_0x2e5a12);},'KVGrY':'获取翻译提示词超时'},_0x1927b7=_0x5c49e8?function(){function _0x22f022(_0xc0aaef,_0x3c8099,_0x5f12e8,_0x5ad098){return _0x5176(_0xc0aaef- -0x1be,_0x3c8099);}const _0x2c85ed={'Ldppf':function(_0x5ae78d,_0x505edd){return _0x37e1c7['qkgLG'](_0x5ae78d,_0x505edd);},'rxzfO':function(_0xf242){function _0x47ac06(_0x3b8b46,_0xc1fe98,_0x6e416,_0x4f5273){return _0x5176(_0x3b8b46-0x186,_0x6e416);}return _0x37e1c7[_0x47ac06(0x3ce,0x405,0x3ba,0x3bc)](_0xf242);},'fWFCl':function(_0x5e525d,_0x2c025c,_0x2a1cd1){return _0x5e525d(_0x2c025c,_0x2a1cd1);},'jkuIV':_0x37e1c7[_0x570417(0x3e1,0x3ee,0x3e7,0x419)]};function _0x570417(_0x1fc7e2,_0xac096,_0x2eb71e,_0x3c0b3c){return _0x5176(_0x3c0b3c-0x224,_0xac096);}if(_0x22f022(0x8e,0x89,0x96,0xbe)!==_0x570417(0x4b0,0x4a8,0x4ac,0x4a8)){if(_0x22cf88){const _0x2bab54=_0x22cf88[_0x570417(0x3f8,0x427,0x480,0x433)](_0x1a0041,arguments);return _0x22cf88=null,_0x2bab54;}}else{const _0x13c142={};_0x13c142[_0x22f022(0x39,0x3d,0x4,0x61)]=_0x2c85ed[_0x570417(0x44f,0x479,0x488,0x453)];const _0x22be53=_0x13c142;return new _0x291d20((_0x353533,_0x40fedd)=>{const _0x513d75={'pYvay':function(_0x2959d8,_0x2324f2){return _0x2959d8!==_0x2324f2;},'HhPJw':function(_0x861f62,_0x3d2303){return _0x2c85ed['Ldppf'](_0x861f62,_0x3d2303);}};function _0x47d8ee(_0x3519a4,_0x3a0246,_0x543769,_0x3eca07){return _0x570417(_0x3519a4-0x9b,_0x3519a4,_0x543769-0x3a,_0x3eca07- -0x503);}const _0x5d6c0b=_0x2c85ed['rxzfO'](_0x2c20ff);_0x1365e1[_0x2a9f4a(-0x1ae,-0x1d5,-0x195,-0x1b2)](_0x47d8ee(-0x93,-0xaf,-0xb5,-0x86)+'\x20请求获取翻译提示词'+_0x47d8ee(-0x70,-0xc4,-0xca,-0x8f)+_0x5d6c0b+')');const _0x21bbad=_0xb20b4c=>{function _0x52ffe6(_0x5c67b7,_0x4f8f3,_0x402f91,_0x4c1df3){return _0x2a9f4a(_0x5c67b7,_0x4f8f3-0x3,_0x402f91-0x55,_0x4c1df3-0x4);}if(_0x513d75['pYvay'](_0xb20b4c['id'],_0x5d6c0b))return;function _0x37d0a0(_0x28ece3,_0x353f92,_0x4d3ea9,_0x2c9284){return _0x47d8ee(_0x4d3ea9,_0x353f92-0x128,_0x4d3ea9-0xc5,_0x2c9284-0x412);}_0x1b7980[_0x37d0a0(0x333,0x377,0x381,0x35f)+'ener'](_0x59acf8[_0x37d0a0(0x397,0x331,0x35f,0x35a)+'ATION_GET_'+_0x37d0a0(0x3a9,0x3de,0x3ba,0x395)+_0x52ffe6(-0x116,-0x183,-0x15f,-0x126)],_0x21bbad);const {prompt:_0x25c698}=_0xb20b4c;_0x521d54[_0x52ffe6(-0xf7,-0x156,-0x140,-0x11d)](_0x37d0a0(0x35f,0x3d2,0x353,0x38c)+'\x20已获取翻译提示词\x20'+_0x52ffe6(-0x18c,-0x13b,-0x13d,-0x124)+_0x5d6c0b+'):',_0x25c698),_0x513d75[_0x52ffe6(-0x14a,-0x152,-0x14e,-0x12d)](_0x353533,_0x25c698);};_0x57804c['on'](_0x2fb916[_0x47d8ee(-0xe3,-0x81,-0xaa,-0xb8)+_0x47d8ee(-0xcc,-0xda,-0xec,-0xf0)+_0x47d8ee(-0xb3,-0x41,-0x2f,-0x7d)+_0x2a9f4a(-0x1f3,-0x1f0,-0x1b4,-0x19c)],_0x21bbad);const _0x408b48={};_0x408b48['id']=_0x5d6c0b,_0x23d76f[_0x2a9f4a(-0x191,-0x1a9,-0x1da,-0x1a2)](_0x3fd30e[_0x47d8ee(-0x98,-0xa1,-0xbd,-0xb8)+_0x2a9f4a(-0x23c,-0x1b5,-0x1f5,-0x1b6)+'PROMPT_REQ'+_0x2a9f4a(-0x11e,-0x129,-0x167,-0x15e)],_0x408b48);function _0x2a9f4a(_0x71e384,_0x82965a,_0x5ca0fa,_0xc79b01){return _0x22f022(_0x5ca0fa- -0x226,_0x71e384,_0x5ca0fa-0x12d,_0xc79b01-0xdc);}_0x2c85ed[_0x2a9f4a(-0x1d3,-0x172,-0x191,-0x1d5)](_0x1de12a,()=>{function _0x48fe04(_0x328418,_0x5c3d3e,_0x135b4d,_0x4e28d2){return _0x2a9f4a(_0x135b4d,_0x5c3d3e-0x75,_0x328418-0x721,_0x4e28d2-0xfa);}function _0x558cb4(_0x49e871,_0x3be742,_0x30a9e3,_0x263b71){return _0x47d8ee(_0x3be742,_0x3be742-0x5e,_0x30a9e3-0x3b,_0x30a9e3-0x2ea);}_0x49f1cc[_0x48fe04(0x569,0x567,0x561,0x581)+_0x558cb4(0x277,0x2a1,0x29c,0x250)](_0x56cc03[_0x48fe04(0x564,0x568,0x593,0x530)+_0x48fe04(0x52c,0x4fc,0x57f,0x529)+_0x558cb4(0x277,0x246,0x26d,0x269)+_0x48fe04(0x56d,0x57a,0x559,0x57a)],_0x21bbad),_0x40fedd(new _0x32850a(_0x22be53[_0x48fe04(0x534,0x579,0x519,0x560)]));},0x1484*-0x1+-0x1791+-0x58b*-0xf);});}}:function(){};return _0x5c49e8=![],_0x1927b7;};}()),_0x15c0a6=_0x5ee872(this,function(){function _0x4d48ae(_0x26cad6,_0xb8df47,_0x4c07e2,_0x2c23f5){return _0x5176(_0xb8df47-0x6c,_0x26cad6);}function _0x4546a9(_0x37defc,_0x4bfbb1,_0x1486e5,_0x4361d7){return _0x5176(_0x4bfbb1-0x179,_0x37defc);}return _0x15c0a6[_0x4546a9(0x3c4,0x3c2,0x3b2,0x37a)]()['search']('(((.+)+)+)'+'+$')[_0x4d48ae(0x2cf,0x2b5,0x2b6,0x2a8)]()[_0x4d48ae(0x263,0x262,0x25a,0x27c)+'r'](_0x15c0a6)[_0x4546a9(0x393,0x385,0x380,0x3da)]('(((.+)+)+)'+'+$');});_0x15c0a6();import{extension_settings}from'../../../../extensions.js';import{saveSettingsDebounced,eventSource}from'../../../../../script.js';import{extensionName,eventNames}from'./config.js';import{addLog}from'./utils.js';import{updateCombinedPrompt}from'./settings/llm.js';import{buildPromptForRequestType}from'./settings/llmService.js';import{mergeAdjacentMessages}from'./promptProcessor.js';let settings;const SD_SYMBOL_PATTERN=/^([\(\[\{<]+)?(.*?)([\)\]\}>]+)?(:[\d.]+)?$/,SKIP_PATTERNS=[/^<lora:/i,/^<lyco:/i,/^<hypernet:/i,/^[\d.:]+$/,/^$/,/^\$.*\$$/];function shouldSkipTranslation(_0x3299be){function _0x3ac884(_0x1ed331,_0x3b83ca,_0x31f0d5,_0x3c19f1){return _0x5176(_0x3c19f1- -0x159,_0x31f0d5);}function _0x4a3592(_0x42a05d,_0x5aeacf,_0x324542,_0x5cbe72){return _0x5176(_0x5aeacf- -0x2e9,_0x5cbe72);}return SKIP_PATTERNS[_0x3ac884(0xca,0xd6,0x120,0xcc)](_0x157263=>_0x157263[_0x4a3592(-0xdf,-0xaf,-0xc3,-0xdb)](_0x3299be[_0x3ac884(0x77,0xe2,0xad,0x97)]()));}export function tagsToJsonString(_0x4f8657){function _0x9be836(_0x610f9,_0x3cc428,_0x37b5a9,_0x1dc511){return _0x5176(_0x3cc428-0x31c,_0x37b5a9);}if(!Array[_0x9be836(0x5c5,0x5a1,0x57c,0x5b2)](_0x4f8657))return'[]';function _0x483f50(_0xf7864,_0x3c17aa,_0x5b66e4,_0x29ced4){return _0x5176(_0x3c17aa-0x21f,_0x29ced4);}return JSON[_0x483f50(0x438,0x463,0x469,0x465)](_0x4f8657[_0x9be836(0x5ad,0x5a5,0x5e6,0x562)](_0x80b9d5=>_0x80b9d5&&typeof _0x80b9d5==='string'));}export function preprocessPromptForTranslation(_0xd3bc3d){const _0x176cf5={'PkSDM':function(_0x125bf1,_0x2f62e1){return _0x125bf1(_0x2f62e1);},'sPtpR':'获取翻译提示词超时','bPyfe':function(_0x2d1ce1,_0x1b94a8){return _0x2d1ce1<_0x1b94a8;},'lPrwI':function(_0x2d9089,_0x138395){return _0x2d9089===_0x138395;},'sWToE':function(_0x88eb2e,_0x57bf7f){return _0x88eb2e!==_0x57bf7f;},'mvjAI':function(_0x1290f5,_0x37b79d){return _0x1290f5===_0x37b79d;},'izybs':_0x417e1f(0x46f,0x4a9,0x46b,0x4d9)};if(!_0xd3bc3d||_0x176cf5[_0x2fd7f7(0x3cc,0x3f4,0x442,0x407)](typeof _0xd3bc3d,'string')){if(_0x176cf5[_0x2fd7f7(0x445,0x419,0x426,0x451)](_0x176cf5['izybs'],_0x176cf5[_0x2fd7f7(0x3ef,0x3f6,0x3ab,0x401)]))return{'originalTags':[],'cleanedTags':[],'cleanedText':'','tagMap':new Map()};else _0xf9c6dc[_0x2fd7f7(0x45a,0x428,0x411,0x404)+_0x417e1f(0x54f,0x502,0x4f4,0x506)](_0x824cf2[_0x417e1f(0x497,0x498,0x4bd,0x45b)+_0x2fd7f7(0x3e2,0x3eb,0x3d7,0x433)+_0x2fd7f7(0x42a,0x45e,0x438,0x46e)+_0x417e1f(0x4b9,0x4a1,0x46c,0x473)],_0x2b163a),_0x176cf5[_0x2fd7f7(0x405,0x409,0x3f7,0x3d8)](_0xf4c3e,new _0x5073e5(_0x176cf5['sPtpR']));}function _0x2fd7f7(_0x559755,_0x3a727c,_0x4c647b,_0x51b45c){return _0x5176(_0x3a727c-0x1fc,_0x559755);}const _0x155988=_0x87a191=>{const _0x5ac1d4=[];let _0x582d90='';function _0x3c8313(_0x4a629e,_0x5af090,_0x39cc98,_0x595ac6){return _0x417e1f(_0x39cc98,_0x595ac6- -0x632,_0x39cc98-0x13a,_0x595ac6-0x117);}let _0x37b141=![];function _0x46e435(_0x47249c,_0x293127,_0x2ac556,_0x153547){return _0x417e1f(_0x293127,_0x47249c- -0x21c,_0x2ac556-0xf5,_0x153547-0x82);}for(let _0x10c3c1=0x2f9*0x3+-0x1749+0x2*0x72f;_0x176cf5[_0x46e435(0x2c0,0x2c5,0x2d2,0x2ec)](_0x10c3c1,_0x87a191['length']);_0x10c3c1++){const _0x346b28=_0x87a191[_0x10c3c1];if(_0x176cf5[_0x46e435(0x2b4,0x283,0x306,0x26a)](_0x346b28,'$'))_0x37b141=!_0x37b141,_0x582d90+=_0x346b28;else{if((_0x176cf5[_0x46e435(0x2b4,0x2c9,0x298,0x2ea)](_0x346b28,',')||_0x176cf5[_0x46e435(0x2b4,0x2aa,0x2fc,0x2c3)](_0x346b28,'，'))&&!_0x37b141){const _0x2188d4=_0x582d90[_0x46e435(0x245,0x1f2,0x259,0x28d)]();if(_0x2188d4)_0x5ac1d4['push'](_0x2188d4);_0x582d90='';}else _0x582d90+=_0x346b28;}}if(_0x582d90[_0x3c8313(-0x194,-0x1ca,-0x1b8,-0x1d1)]())_0x5ac1d4[_0x3c8313(-0x1c1,-0x1e4,-0x1a2,-0x1cf)](_0x582d90['trim']());return _0x5ac1d4;},_0x437bdc=_0x155988(_0xd3bc3d);function _0x417e1f(_0x3a96fb,_0x5395f6,_0x219c53,_0x47efb7){return _0x5176(_0x5395f6-0x271,_0x3a96fb);}const _0x2620ac=[],_0x27bdc0=[],_0x399fbe=new Map();for(const _0x506e42 of _0x437bdc){const _0xedd035=_0x506e42['match'](SD_SYMBOL_PATTERN);if(_0xedd035){const _0x4fbb58=_0xedd035[-0xfeb+0x1c3c*-0x1+0x2c28]||'',_0x212bae=(_0xedd035[-0x100d*0x1+-0xc04+0x1c13]||'')[_0x2fd7f7(0x422,0x3ec,0x3a8,0x3ba)](),_0x1cf8ad=_0xedd035[0x11b6+0x9a*-0x1d+0x1*-0x41]||'',_0x36901a=_0xedd035[0x2ec+0x1*-0x1903+0x161b]||'',_0x65ed17={'original':_0x506e42,'cleaned':_0x212bae,'prefix':_0x4fbb58,'suffix':_0x1cf8ad,'weight':_0x36901a,'skip':shouldSkipTranslation(_0x506e42)||_0x176cf5['PkSDM'](shouldSkipTranslation,_0x212bae)};_0x2620ac[_0x2fd7f7(0x3db,0x3ee,0x3f6,0x3ea)](_0x65ed17),!_0x65ed17['skip']&&_0x212bae&&(_0x27bdc0['push'](_0x212bae),_0x399fbe[_0x2fd7f7(0x428,0x438,0x439,0x436)](_0x212bae['toLowerCas'+'e'](),_0x65ed17));}else{const _0xf6f6b5={'original':_0x506e42,'cleaned':_0x506e42,'prefix':'','suffix':'','weight':'','skip':_0x176cf5[_0x417e1f(0x440,0x47e,0x438,0x4a2)](shouldSkipTranslation,_0x506e42)};_0x2620ac[_0x417e1f(0x41c,0x463,0x436,0x4a7)](_0xf6f6b5),!_0xf6f6b5[_0x417e1f(0x4d5,0x4e6,0x53b,0x525)]&&_0x506e42&&(_0x27bdc0['push'](_0x506e42),_0x399fbe[_0x2fd7f7(0x47b,0x438,0x46a,0x436)](_0x506e42[_0x417e1f(0x517,0x4f0,0x4ec,0x4d4)+'e'](),_0xf6f6b5));}}return{'originalTags':_0x2620ac,'cleanedTags':_0x27bdc0,'cleanedText':_0x176cf5['PkSDM'](tagsToJsonString,_0x27bdc0),'tagMap':_0x399fbe};}export function combineTranslationResult(_0x5c1268,_0x56d4d4){const _0xb068cf={};_0xb068cf['AbGwy']=_0x4c330e(0x3c3,0x411,0x402,0x43c),_0xb068cf[_0x35b817(0x74,0x45,0x2f,0xbb)]=_0x35b817(0x101,0xae,0xcb,0x121),_0xb068cf[_0x4c330e(0x432,0x393,0x3e3,0x3f3)]=_0x4c330e(0x471,0x40b,0x44e,0x459);function _0x4c330e(_0x2243a1,_0x333c27,_0x69f47e,_0x578601){return _0x5176(_0x69f47e-0x1e1,_0x333c27);}function _0x35b817(_0x1d87cb,_0x599dec,_0x2ef630,_0x11953f){return _0x5176(_0x1d87cb- -0x18f,_0x2ef630);}const _0x348b34=_0xb068cf;if(!_0x5c1268||!Array['isArray'](_0x5c1268)){if(_0x348b34['jKjud']==='MHfou')return[];else{const {original:_0x87c3f,cleaned:_0xae97c1,skip:_0x26ceb3}=_0x52114a;if(_0x26ceb3){const _0x4ad44b={};return _0x4ad44b[_0x4c330e(0x411,0x3bf,0x3e7,0x3df)]=_0x87c3f,_0x4ad44b['translatio'+'n']='',_0x4ad44b['cleaned']=_0xae97c1,_0x4ad44b[_0x4c330e(0x419,0x445,0x3fd,0x43a)]=!![],_0x4ad44b;}const _0x7327e1=_0xbfe0db[_0xae97c1[_0x35b817(0xf0,0xa0,0x142,0x134)+'e']()]||'',_0x4b8526={};return _0x4b8526[_0x35b817(0x77,0x26,0x63,0x5b)]=_0x87c3f,_0x4b8526[_0x35b817(0xb0,0x81,0x9b,0x65)+'n']=_0x7327e1,_0x4b8526['cleaned']=_0xae97c1,_0x4b8526['skipped']=![],_0x4b8526;}}const _0x4c16c4={};if(_0x56d4d4&&typeof _0x56d4d4===_0x348b34[_0x35b817(0x73,0x5d,0xb6,0x48)])for(const [_0x457220,_0x10b376]of Object['entries'](_0x56d4d4)){_0x4c16c4[_0x457220[_0x4c330e(0x430,0x40d,0x460,0x43d)+'e']()]=_0x10b376;}return _0x5c1268['map'](_0x3997ac=>{function _0x287a51(_0x3db24a,_0x157fd8,_0x504809,_0x2a301e){return _0x35b817(_0x2a301e-0x212,_0x157fd8-0x17b,_0x157fd8,_0x2a301e-0x11c);}function _0x328ed7(_0x468afe,_0x4808fc,_0x1d863c,_0x5233a9){return _0x4c330e(_0x468afe-0x137,_0x5233a9,_0x1d863c- -0x130,_0x5233a9-0xdc);}if(_0x348b34[_0x328ed7(0x28e,0x2ae,0x2d1,0x323)]!=='UNlIy'){const {original:_0x285a8c,cleaned:_0x3cf7fc,skip:_0x235bbf}=_0x3997ac;if(_0x235bbf){const _0x4295a4={};return _0x4295a4[_0x328ed7(0x2cb,0x2e2,0x2b7,0x2c8)]=_0x285a8c,_0x4295a4['translatio'+'n']='',_0x4295a4['cleaned']=_0x3cf7fc,_0x4295a4[_0x287a51(0x29e,0x256,0x267,0x29f)]=!![],_0x4295a4;}const _0x330f60=_0x4c16c4[_0x3cf7fc['toLowerCas'+'e']()]||'',_0x54f620={};return _0x54f620[_0x287a51(0x282,0x2c8,0x272,0x289)]=_0x285a8c,_0x54f620[_0x328ed7(0x2a9,0x343,0x2f0,0x2d6)+'n']=_0x330f60,_0x54f620[_0x287a51(0x2a6,0x2dd,0x29e,0x2d0)]=_0x3cf7fc,_0x54f620[_0x328ed7(0x293,0x2da,0x2cd,0x2d5)]=![],_0x54f620;}else{const _0x285cbb=_0x2d459c['apply'](_0x2a65ff,arguments);return _0x2b3a8c=null,_0x285cbb;}});}export function formatTranslationDisplay(_0x15d06b,_0x1ac850={}){const _0x1ab694={'esOTI':_0x11bfb0(-0x78,-0x23,-0x61,-0x3c)+'+$','NqTWH':function(_0x2b8839){return _0x2b8839();},'mXeCH':function(_0x40ed4e,_0x2c0f56){return _0x40ed4e(_0x2c0f56);},'KcqYu':_0x4f886f(-0x2f,0xe,-0x21,-0x34),'hGDKK':function(_0x168376,_0xe5fcf2){return _0x168376!==_0xe5fcf2;},'OusdR':_0x4f886f(-0x117,-0x83,-0xb6,-0xc9)};function _0x4f886f(_0x401dea,_0x10b310,_0x3fbeb0,_0x2a6411){return _0x5176(_0x2a6411- -0x2ba,_0x401dea);}const {separator:separator=',\x20',showOriginal:showOriginal=!![],showTranslation:showTranslation=!![]}=_0x1ac850;function _0x11bfb0(_0x5ef48b,_0x51bd06,_0x9b1dcc,_0x2bccfc){return _0x5176(_0x9b1dcc- -0x2a3,_0x5ef48b);}if(!_0x15d06b||!Array['isArray'](_0x15d06b))return'';return _0x15d06b[_0x4f886f(0x7,-0x53,0x11,-0x37)](_0x53c8b5=>{function _0x13c36f(_0x41e610,_0x3697fb,_0x504fef,_0x423f04){return _0x4f886f(_0x41e610,_0x3697fb-0x108,_0x504fef-0xa6,_0x423f04-0x25b);}function _0x3d87e2(_0x1735ff,_0x3e50d7,_0x1cfdc8,_0x41c915){return _0x4f886f(_0x1cfdc8,_0x3e50d7-0x105,_0x1cfdc8-0x3a,_0x1735ff-0xb5);}if(_0x1ab694[_0x3d87e2(0x26,-0x1a,0x68,0x53)]!==_0x1ab694[_0x13c36f(0x1dc,0x1b9,0x17a,0x1cc)])return _0x515f16[_0x3d87e2(0x44,0x44,0x41,0x56)]()['search'](emAPuy['esOTI'])['toString']()[_0x13c36f(0x19f,0x166,0x1dd,0x197)+'r'](_0x81ee4a)['search'](emAPuy[_0x3d87e2(0x4,0xa,0x2a,0x2d)]);else{if(_0x53c8b5['skipped']){if(_0x1ab694['hGDKK'](_0x1ab694[_0x3d87e2(0x86,0x7a,0x33,0xca)],_0x1ab694[_0x3d87e2(0x86,0xb7,0xbb,0x36)]))_0x1ab694[_0x3d87e2(0xd,-0xf,-0x35,0x20)](_0xb1f428),_0x1ab694['mXeCH'](_0x1d79b0,new _0x3a6a12(_0x3d87e2(0x5f,0x51,0x10,0xe)+'时（'+_0x8e0eea+_0x3d87e2(0x50,0x41,0x41,0x96)));else return showOriginal?_0x53c8b5[_0x13c36f(0x1cf,0x1cf,0x1a3,0x1a7)]:'';}const _0x3ff3a6=[];if(showOriginal)_0x3ff3a6[_0x3d87e2(-0x13,-0x5e,-0x57,-0x18)](_0x53c8b5[_0x3d87e2(0x1,-0x32,-0x49,0x16)]);return showTranslation&&_0x53c8b5[_0x3d87e2(0x3a,0x6d,0x51,0x47)+'n']&&_0x3ff3a6[_0x3d87e2(-0x13,0x30,0x10,-0x3f)]('('+_0x53c8b5[_0x3d87e2(0x3a,0x0,0x13,0x42)+'n']+')'),_0x3ff3a6[_0x13c36f(0x1f9,0x254,0x1b5,0x206)]('\x20');}})[_0x4f886f(0x1,0xa,0x12,-0x31)](Boolean)[_0x4f886f(-0x27,-0x51,-0x84,-0x55)](separator);}export async function translatePromptTags(_0x426b7c){const _0x264737={'uxnlj':'AbortError','oHUhZ':function(_0x30837a,_0x36ff86){return _0x30837a(_0x36ff86);},'GKzpZ':function(_0x691145,_0x5777ad){return _0x691145+_0x5777ad;},'vxSPL':function(_0xa06714,_0x57c786){return _0xa06714(_0x57c786);},'SQrPv':function(_0x33b586,_0x36d593){return _0x33b586!==_0x36d593;},'DkMRX':_0x42f2b2(0x570,0x539,0x5b7,0x580),'djgWl':function(_0x3d0cce,_0x38d16f,_0x469cf4){return _0x3d0cce(_0x38d16f,_0x469cf4);},'mxEtR':function(_0x19b14e,_0x3b3898){return _0x19b14e===_0x3b3898;},'lfXyH':'st-chatu8:'+'\x20翻译提示词标签失败'+':'},{originalTags:_0x2b04e0,cleanedText:_0x5e9c66}=_0x264737['vxSPL'](preprocessPromptForTranslation,_0x426b7c);function _0x1cd88c(_0x6dab31,_0x14f080,_0x31cdca,_0x1a225a){return _0x5176(_0x1a225a-0x1b4,_0x6dab31);}function _0x42f2b2(_0x1b9756,_0x762e0f,_0x1ff1bd,_0x350356){return _0x5176(_0x350356-0x368,_0x1ff1bd);}if(!_0x5e9c66){if(_0x264737[_0x1cd88c(0x3c9,0x433,0x3e9,0x3eb)](_0x264737[_0x42f2b2(0x5d9,0x55f,0x55e,0x5af)],_0x264737['DkMRX'])){const _0x16f4a0=new _0x544c07(_0x3525e4['error'][_0x1cd88c(0x394,0x3c2,0x402,0x3e1)]);_0x16f4a0[_0x1cd88c(0x393,0x3ad,0x363,0x3a1)]=_0x264737[_0x42f2b2(0x62c,0x5e3,0x5d8,0x5ea)],_0x264737['oHUhZ'](_0x135228,_0x16f4a0);}else{const _0x59233b={};return _0x59233b[_0x42f2b2(0x5df,0x550,0x5ae,0x59a)]=[],_0x59233b[_0x42f2b2(0x5c5,0x5f9,0x601,0x5f7)+'t']='',_0x59233b[_0x42f2b2(0x5b8,0x5c4,0x5a8,0x57e)+'gs']=[],_0x59233b;}}try{const _0x481603=await _0x264737[_0x1cd88c(0x429,0x3bc,0x3c1,0x3e8)](callTranslation,_0x5e9c66),_0x8b85ec=_0x264737[_0x1cd88c(0x392,0x3b0,0x3c2,0x3a2)](parseTranslationResult,_0x481603),_0x20ea44=_0x264737[_0x42f2b2(0x635,0x630,0x62a,0x5f6)](combineTranslationResult,_0x2b04e0,_0x8b85ec),_0x56a168=_0x264737[_0x1cd88c(0x3b1,0x36b,0x3ae,0x3a2)](formatTranslationDisplay,_0x20ea44),_0x3472f6={};return _0x3472f6['results']=_0x20ea44,_0x3472f6[_0x42f2b2(0x5a5,0x614,0x5e3,0x5f7)+'t']=_0x56a168,_0x3472f6['originalTa'+'gs']=_0x2b04e0,_0x3472f6;}catch(_0x2e7838){if(_0x264737[_0x1cd88c(0x47b,0x435,0x40d,0x43c)]('jEevF',_0x42f2b2(0x5a8,0x64e,0x5eb,0x5fa))){const _0x5d1c28=_0x2f384e['slice'](-0x3*-0x9f7+-0xda9+-0x103c,_0x5e8cfc)[_0x42f2b2(0x563,0x5a9,0x575,0x558)](),_0x8227eb=_0x2dab70[_0x1cd88c(0x3f8,0x3ca,0x3dd,0x3c4)](_0x264737[_0x42f2b2(0x58c,0x5f4,0x565,0x5b3)](_0x12d9e2,-0xd*0xe+-0x2674+-0x272b*-0x1))['trim']();if(_0x5d1c28)_0x53bc67[_0x5d1c28]=_0x8227eb;}else{console['error'](_0x264737[_0x1cd88c(0x3e8,0x44a,0x407,0x42d)],_0x2e7838);throw _0x2e7838;}}}export function parseTranslationResult(_0x5cac06){function _0x200f6a(_0x4102bd,_0x12a44e,_0x1526a3,_0xf70506){return _0x5176(_0x4102bd-0x359,_0xf70506);}const _0x40096d={'FcUCp':function(_0x1ae96a,_0x113a87){return _0x1ae96a(_0x113a87);},'XmyYJ':_0x100b91(-0x17e,-0x119,-0x166,-0x153),'TaCLh':function(_0x1c6ce3,_0x2019ec){return _0x1c6ce3===_0x2019ec;},'dDPQP':_0x200f6a(0x567,0x589,0x570,0x592),'lmOwg':function(_0x22c300,_0x579860){return _0x22c300!==_0x579860;},'WqOWl':_0x200f6a(0x5b4,0x588,0x570,0x5c9),'tLIRy':'object','HMEDn':function(_0x57e798,_0x2c1bb6){return _0x57e798!==_0x2c1bb6;},'bwXiL':_0x200f6a(0x5b2,0x5f4,0x5f5,0x5ac)+_0x200f6a(0x587,0x596,0x55a,0x53d)+_0x200f6a(0x577,0x548,0x558,0x539),'MBpBd':_0x100b91(-0x16a,-0x1b7,-0x1d1,-0x183),'pnHlO':'rgBhe','LLZHI':function(_0x29d38a,_0x1319e8){return _0x29d38a>_0x1319e8;},'vSTpC':function(_0x4b3ff7,_0x330e3b){return _0x4b3ff7+_0x330e3b;}};if(!_0x5cac06)return{};try{if(_0x40096d['TaCLh'](_0x100b91(-0x1c9,-0x1ca,-0x1e0,-0x1cc),_0x40096d[_0x100b91(-0x169,-0x1aa,-0x18d,-0x16b)])){const _0x6d32a6=_0x5cac06['match'](/\{[\s\S]*\}/);if(_0x6d32a6){if(_0x40096d[_0x100b91(-0x1fb,-0x1bd,-0x1d8,-0x1de)](_0x40096d['WqOWl'],'NNsnZ')){_0x40096d[_0x200f6a(0x58e,0x576,0x5e2,0x5b0)](_0x559cec,_0x200f6a(0x5ec,0x63b,0x5b2,0x5a3)+_0x2ece93['message']),_0x1ba6fe[_0x100b91(-0x14b,-0x1b3,-0x194,-0x179)](_0x40096d[_0x200f6a(0x570,0x5a1,0x59a,0x521)],_0x25b747);throw _0x364b18;}else{const _0x387fee=JSON[_0x100b91(-0x1a2,-0x221,-0x204,-0x1d2)](_0x6d32a6[-0x174c+-0x1dd1+0x1*0x351d]);if(_0x40096d[_0x200f6a(0x594,0x57a,0x5a0,0x59b)](typeof _0x387fee,_0x40096d['tLIRy'])&&_0x40096d[_0x100b91(-0x186,-0x1e8,-0x1c1,-0x1c1)](_0x387fee,null))return _0x387fee;}}}else _0x25d435[_0x100b91(-0x197,-0x1e7,-0x1ba,-0x1e8)]('('+_0xae42b0[_0x100b91(-0x165,-0x14e,-0x19d,-0x19b)+'n']+')');}catch(_0x908fec){if('RlKdT'===_0x100b91(-0x1ef,-0x1da,-0x1f7,-0x1b4))console[_0x200f6a(0x558,0x559,0x522,0x545)](_0x40096d[_0x200f6a(0x544,0x558,0x559,0x53c)],_0x908fec['message']);else{const _0x7d25f={};return _0x7d25f[_0x100b91(-0x216,-0x1a4,-0x180,-0x1d4)]=_0x2d3ad3,_0x7d25f['translatio'+'n']='',_0x7d25f['cleaned']=_0x849922,_0x7d25f[_0x200f6a(0x575,0x538,0x52f,0x524)]=!![],_0x7d25f;}}const _0xb94c5f=String(_0x5cac06)[_0x200f6a(0x574,0x592,0x549,0x596)](/[\r\n]+/g,'\x20')[_0x100b91(-0x1f6,-0x1d4,-0x1e5,-0x1bf)](/^[\s"'`]+|[\s"'`]+$/g,'')[_0x200f6a(0x549,0x511,0x526,0x4f8)](),_0x13f4ab=_0xb94c5f[_0x100b91(-0x177,-0x15d,-0x1aa,-0x1b0)](/[,，]/)[_0x200f6a(0x5dc,0x5f9,0x61e,0x5dc)](_0x1c130f=>_0x1c130f[_0x100b91(-0x1a8,-0x1b2,-0x1c7,-0x1ea)]())['filter'](Boolean),_0x49c0c3={};function _0x100b91(_0x561f78,_0x5e0c5d,_0x566ff0,_0x88ad9c){return _0x5176(_0x88ad9c- -0x3da,_0x566ff0);}for(const _0x1bf8b1 of _0x13f4ab){if(_0x40096d[_0x100b91(-0x184,-0x1bd,-0x19b,-0x19f)](_0x40096d['MBpBd'],_0x40096d[_0x100b91(-0x111,-0x198,-0x194,-0x14e)]))return[];else{const _0x3865af=_0x1bf8b1[_0x200f6a(0x5cf,0x59a,0x5ac,0x5b7)]('\x5c');if(_0x40096d['LLZHI'](_0x3865af,0x262d+0x1b93+-0x41c0*0x1)){const _0x16cd42=_0x1bf8b1['slice'](-0x1*0x1e57+0xbff+0x8*0x24b,_0x3865af)[_0x200f6a(0x549,0x557,0x55f,0x535)](),_0x2b5103=_0x1bf8b1[_0x200f6a(0x569,0x56f,0x59b,0x52e)](_0x40096d[_0x200f6a(0x5b6,0x5d5,0x606,0x583)](_0x3865af,-0x1ab7*-0x1+0x2f*0x46+-0x2790))[_0x200f6a(0x549,0x550,0x51d,0x570)]();if(_0x16cd42)_0x49c0c3[_0x16cd42]=_0x2b5103;}}}return _0x49c0c3;}function _0x1a76(){const _0x3c3725=['ugXls0K','tNfuv0G','C2fotuu','qLLNv2K','v3bIt2O','B3jPz2LUywXuyq','wg15wuO','rwj2Bgy','se1frg4','CMvZDwX0','CMvWBgfJzq','C2TPChbLza','BxzQquK','5BcD6k+v5PEN5Qc85BYpoG','q1ngAu0','qwjhD3K','vxbrzfC','ugXUBLi','q0PxDwy','zMLgrum','C29Tzq','uMXlzfq','teXnx1rsqu5tta','suneCe4','mtaWndfIt3L2Dum','C3bSAxq','s2nXwxu','CMvTB3zLtgLZDa','BwvZC2fNzq','iePtt07OP6pMNPdLPlhOTkxVViW','AMT1svy','ue9ou0u','CMnfwNK','CMvZDwX0CW','ufLuB00','B0HvAfO','rMnvq3a','sMzszui','u1fYuhy','C0XIvgq','zuH1r3C','DgvZDa','vgfdtgG','C2v0','txPZA1K','y2Xeu0S','DhjHBNnSyxrPBW','EfDXve0','sgHqsNC','kcGOlISPkYKRkq','zgf3tKS','C3rYAw5NAwz5','yKTrBLO','nda1mJnksNbSuxa','rgTnuLG','r0XWA0G','Dg9tDhjPBMC','vMjTshK','r0T6CfO','ALHgC3u','y2XLyw5Lza','qvrjt05FuKvtua','Bg9N','icHjrdOG','uMLHrNi','keLeoIa','zLDgq2W','Bw5jzhG','BxpVViK','ioE/U+IVKEApKoEKUUIVJEAGH+ETVUwKSEI0Pq','CKP5r2y','B2zRs1a','C3qTy2HHDhu4oG','mZq3ode0vNPzDefw','tK5ZBLO','mZjtthjArfO','DLnuCem','sNH1q0W','BfbYD0K','zKDZrei','zxjYB3i','ufjptvbux1jfuW','mtbcuhD4AgW','57+76k+rieXmtsdMIAFOOyZOTOu','AM9PBG','vMfYreG','DffOAxK','CMfUzg9Tvvvjra','Dw92wui','ioIVT+AXGUIoT+wpLUE/U+IVKEApKoEKUUIVJq','yLb5zMu','ioAjP+IHJoE7K+AENcaOsuq6','B2jQzwn0','DuPhswO','zerquva','qvrjt05FuKvrvq','C3vIC3rYAw5N','t05trq','qwjVCNrfCNjVCG','C3vJy2vZCW','C2TPCa','Aw5KzxHpzG','ntaZnZnAAhLXuwi','BNbVt3C','BgzyEuG','DxnLCG','mteYy2zlBg1J','mJK4ntvPCgvPEue','vuvtva','mZyWnJm1CefOyMfz','Dg9mB3DLCKnHCW','mtu4mZKYvMndrNPb','rKjztNO','DxHUBgO','BwfW','AMrwzMK','AxnbCNjHEq','qvLWEuW','57+76k+r5AsX6lsLoG','BxHfDfi','zMLSDgvY','iow3SUIoT+wpLUE/U+IVKEApKoEKUUIVJsa','t3vZzfi','Cg5iBe8','qwT3yxC','zgPNv2W','zgLZCgXHEvrLEa','tuHMB3u','zw5LCG','s3fAywi','57+76k+r5AsX6lsLoIa','yNDyAuW','ChjVBxb0','BMfTzq','DNHtueW','qvrjt05Fr0vuxW','DhjPBq','te5qAxK','ChvZAa','uvPUzNi','CMfUzg9T','s1zhCLK','y29UC3rYDwn0BW','tLLqD0m','C1DuB0u','iefjioIUVUE9RUw3SUE7N+s4GowiSa','AxP5yNm','zhvHueC','Bg1pD2C','r0vJshO','z3bKu2O','D2fYBG','zMjxqMm','rvnu','suHVtNy','AKTQDwq','z3bMz1O','DxzHC3i','B3jPz2LUywW','wuPlzee','CgfYC2u','zxnpveK','zw1PDa','sef1v3G','C2vHCMnO','ugTtre0','r2Pby0G','yxbWBhK','C2XPy2u'];_0x1a76=function(){return _0x3c3725;};return _0x1a76();}function generateRequestId(){const _0x3b780d={};_0x3b780d[_0x28ec55(0x292,0x2a7,0x27f,0x2d0)]=function(_0x47311d,_0x250e08){return _0x47311d!==_0x250e08;};function _0x28ec55(_0x4cb8fc,_0xc27f6f,_0x433d58,_0x1c7001){return _0x5176(_0x433d58- -0x2,_0x1c7001);}function _0x43be39(_0x5013c6,_0x5c7c39,_0x1754a0,_0x523626){return _0x5176(_0x523626-0x38,_0x5c7c39);}_0x3b780d[_0x43be39(0x280,0x276,0x2d1,0x29f)]=_0x28ec55(0x22a,0x249,0x221,0x25c);const _0x2d9f73=_0x3b780d;if(crypto&&crypto['randomUUID']){if(_0x2d9f73[_0x43be39(0x281,0x2f5,0x275,0x2b9)](_0x43be39(0x276,0x2de,0x2be,0x28c),_0x2d9f73[_0x28ec55(0x282,0x25a,0x265,0x244)]))return crypto[_0x28ec55(0x24b,0x263,0x266,0x2ac)]();else _0x1c5f3c[_0x44bbe2[_0x43be39(0x2a3,0x2b3,0x2bf,0x2b7)+'e']()]=_0x9bcb95;}return Date['now']()[_0x28ec55(0x1f7,0x24d,0x247,0x1fb)](-0x2234+0xb43+-0x13*-0x137)+Math[_0x28ec55(0x219,0x242,0x1f2,0x21b)]()[_0x28ec55(0x25c,0x28b,0x247,0x24c)](0x1d5e+0x2277+-0x3fb1)[_0x28ec55(0x2b0,0x2a8,0x26f,0x27a)](0x1089+0x5cf*-0x4+0x6b5);}export function LLM_TRANSLATION_GET_PROMPT(){const _0x366326={'JfReB':function(_0x4a3984,_0x11aa3c){return _0x4a3984!==_0x11aa3c;},'fGsDB':function(_0x112452,_0x230c7f){return _0x112452!==_0x230c7f;},'clDSK':_0x4049c2(0x645,0x653,0x612,0x60b),'tPPBH':function(_0x49e16d,_0x2c0a2c){return _0x49e16d(_0x2c0a2c);},'uiRqf':'rcEZy','fbWBc':function(_0x27c4fe){return _0x27c4fe();},'WpbOj':function(_0x4c0d61,_0x1ca261,_0x1b76b5){return _0x4c0d61(_0x1ca261,_0x1b76b5);}};function _0x4049c2(_0x25bf73,_0x3f73e6,_0x536684,_0x3a95da){return _0x5176(_0x536684-0x3ba,_0x3a95da);}return new Promise((_0x5e3f45,_0x556cc7)=>{function _0x30054e(_0x219164,_0x33e9cb,_0x5385df,_0x301073){return _0x4049c2(_0x219164-0xe2,_0x33e9cb-0xdd,_0x5385df- -0x361,_0x301073);}const _0x332779={'PYWLe':function(_0x2d7d30,_0x1515ad){function _0x316bbc(_0x55bb24,_0x162b40,_0x2c07ad,_0x4d4463){return _0x5176(_0x2c07ad- -0x241,_0x4d4463);}return _0x366326[_0x316bbc(0x2d,-0x36,0x1f,0x4f)](_0x2d7d30,_0x1515ad);},'xWqTM':_0x366326[_0x1ba58d(-0xa4,-0xfa,-0xcc,-0xdc)],'PlnnR':function(_0x437b22,_0x224e89){return _0x366326['tPPBH'](_0x437b22,_0x224e89);}};function _0x1ba58d(_0x4ac4b5,_0x41929f,_0xaeb286,_0x30313b){return _0x4049c2(_0x4ac4b5-0x1f3,_0x41929f-0x73,_0x30313b- -0x6d4,_0x4ac4b5);}if(_0x366326['uiRqf']===_0x1ba58d(-0xa6,-0x123,-0x138,-0xe9)){const _0x263a60=_0x366326[_0x30054e(0x29f,0x24e,0x259,0x21d)](generateRequestId);console[_0x30054e(0x2e7,0x289,0x2a8,0x271)](_0x1ba58d(-0xfd,-0x108,-0xcf,-0xc1)+_0x30054e(0x300,0x2d2,0x2c3,0x276)+'\x20(ID:\x20'+_0x263a60+')');const _0x276f3c=_0x12a5ba=>{function _0x31ca8e(_0xcf6aea,_0x31b504,_0x151bea,_0x303ba8){return _0x30054e(_0xcf6aea-0x5a,_0x31b504-0x18a,_0x303ba8-0x9b,_0x31b504);}if(_0x366326[_0x48e45f(0x43d,0x422,0x42c,0x473)](_0x12a5ba['id'],_0x263a60))return;function _0x48e45f(_0x19df3c,_0x5c959c,_0x2ddc2d,_0x2d84f9){return _0x30054e(_0x19df3c-0xd1,_0x5c959c-0x65,_0x2d84f9-0x1e4,_0x2ddc2d);}eventSource[_0x31ca8e(0x2d9,0x2f9,0x344,0x320)+'ener'](eventNames[_0x31ca8e(0x316,0x342,0x301,0x31b)+_0x48e45f(0x44d,0x461,0x439,0x42c)+'PROMPT_RES'+_0x48e45f(0x47e,0x42f,0x4b6,0x46d)],_0x276f3c);const {prompt:_0x54bbcf}=_0x12a5ba;console[_0x31ca8e(0x347,0x2f1,0x379,0x343)](_0x31ca8e(0x366,0x2fb,0x385,0x34d)+_0x31ca8e(0x32a,0x3ac,0x35d,0x37e)+_0x31ca8e(0x343,0x392,0x33d,0x346)+_0x263a60+'):',_0x54bbcf),_0x5e3f45(_0x54bbcf);};eventSource['on'](eventNames[_0x30054e(0x2d0,0x294,0x280,0x24c)+_0x1ba58d(-0x102,-0xd8,-0x11d,-0x12b)+_0x30054e(0x2c5,0x28d,0x2bb,0x2ca)+_0x30054e(0x253,0x2dc,0x289,0x27e)],_0x276f3c);const _0x23aac6={};_0x23aac6['id']=_0x263a60,eventSource['emit'](eventNames[_0x30054e(0x2c8,0x2ad,0x280,0x260)+_0x30054e(0x24d,0x25c,0x248,0x274)+'PROMPT_REQ'+_0x30054e(0x2d7,0x318,0x2d6,0x31d)],_0x23aac6),_0x366326[_0x1ba58d(-0xd0,-0xdc,-0xcf,-0x105)](setTimeout,()=>{function _0x33b1bb(_0x436f9f,_0x1a4f2d,_0x3ece05,_0xa34dcb){return _0x1ba58d(_0xa34dcb,_0x1a4f2d-0x14d,_0x3ece05-0x107,_0x436f9f-0x36a);}function _0x47eb81(_0x598fa8,_0x441a47,_0x126b55,_0x47e7da){return _0x1ba58d(_0x47e7da,_0x441a47-0xbf,_0x126b55-0xcc,_0x126b55-0x1e8);}if(_0x332779['PYWLe'](_0x332779[_0x33b1bb(0x290,0x2a8,0x2b0,0x24c)],_0x332779['xWqTM']))return{'originalTags':[],'cleanedTags':[],'cleanedText':'','tagMap':new _0x3ed40b()};else eventSource[_0x33b1bb(0x27c,0x2bf,0x2b3,0x27a)+'ener'](eventNames['LLM_TRANSL'+_0x33b1bb(0x23f,0x269,0x1ee,0x292)+_0x33b1bb(0x2b2,0x289,0x2e3,0x2c3)+_0x47eb81(0x11a,0x146,0xfe,0x131)],_0x276f3c),_0x332779[_0x33b1bb(0x272,0x23c,0x24b,0x2b3)](_0x556cc7,new Error('获取翻译提示词超时'));},-0x2e4*-0x15+-0x2*-0x26ef+-0x6382);}else{_0x7d1be2[_0x1ba58d(-0xd1,-0x9a,-0x68,-0xb9)]('st-chatu8:'+_0x30054e(0x292,0x270,0x2af,0x2eb)+':',_0x539f66);throw _0x4baa51;}});}export function LLM_TRANSLATION(_0x2e25cf,{timeoutMs:timeoutMs=0x7cfa+0x2b6d+0x41f9}={}){const _0x50725f={'QUTsf':function(_0x3f981f,_0x15645f){return _0x3f981f(_0x15645f);},'BYgWi':function(_0x4214f5,_0x785bd8){return _0x4214f5+_0x785bd8;},'duaPG':function(_0x16cbb9,_0x343445){return _0x16cbb9===_0x343445;},'bKQnZ':_0x26c159(0x3dc,0x436,0x42c,0x3ef),'GEcHz':function(_0xbc9f3e,_0x483085){return _0xbc9f3e(_0x483085);},'MzskY':function(_0x256ba5,_0x2e07a9){return _0x256ba5!==_0x2e07a9;},'ICDpN':function(_0x258f7e){return _0x258f7e();},'ALdbv':function(_0x562224,_0x365460){return _0x562224(_0x365460);},'nwOUp':_0x36ec32(0x4e3,0x4d8,0x468,0x49e)};function _0x26c159(_0x4a4c44,_0x6fdeb4,_0x5bc1f1,_0x2269b2){return _0x5176(_0x2269b2-0x1de,_0x5bc1f1);}function _0x36ec32(_0x50a242,_0x486c70,_0x180f40,_0x319d75){return _0x5176(_0x319d75-0x297,_0x180f40);}return new Promise((_0x40db09,_0x509d79)=>{function _0x260493(_0x4d79cb,_0x4e17d2,_0x143bfb,_0x2a2235){return _0x36ec32(_0x4d79cb-0x122,_0x4e17d2-0x1a1,_0x4e17d2,_0x143bfb-0x117);}const _0x2932ea={'fFLZH':function(_0x17f774,_0x1f34e7){function _0x2e658d(_0x47793c,_0x40a6d9,_0x52f27f,_0x4d7321){return _0x5176(_0x4d7321- -0x31f,_0x52f27f);}return _0x50725f[_0x2e658d(-0xa8,-0x93,-0xeb,-0xe2)](_0x17f774,_0x1f34e7);},'HAuWx':function(_0x55e576){function _0x4a4323(_0x4ef283,_0x4a8fdf,_0x1a3da0,_0x324131){return _0x5176(_0x324131-0x353,_0x4ef283);}return _0x50725f[_0x4a4323(0x5ae,0x52f,0x5b0,0x57b)](_0x55e576);},'RiaFr':function(_0x369b35,_0x3fe8b4){return _0x50725f['duaPG'](_0x369b35,_0x3fe8b4);},'omrSe':function(_0x12f89,_0x32ee86){return _0x50725f['ALdbv'](_0x12f89,_0x32ee86);},'CxJQS':function(_0x4dd027,_0x51af0b){function _0x415684(_0x25e682,_0xc252bb,_0x1f3025,_0x39bba1){return _0x5176(_0x39bba1-0x25b,_0x1f3025);}return _0x50725f[_0x415684(0x455,0x404,0x44d,0x458)](_0x4dd027,_0x51af0b);}};function _0x2c05b6(_0x4bae92,_0x37a01f,_0x50ea98,_0xe57203){return _0x26c159(_0x4bae92-0x1c3,_0x37a01f-0x49,_0x37a01f,_0xe57203-0x13a);}if(_0x50725f[_0x2c05b6(0x4d1,0x517,0x523,0x513)](_0x50725f['nwOUp'],_0x2c05b6(0x4f5,0x51a,0x51f,0x51f))){const _0x8783ed=_0x50725f[_0x2c05b6(0x510,0x53e,0x534,0x540)](generateRequestId);console[_0x2c05b6(0x56e,0x56b,0x54f,0x567)](_0x260493(0x60a,0x64a,0x607,0x5eb)+'\x20请求翻译\x20LLM\x20'+_0x260493(0x5ec,0x5e3,0x600,0x60a)+_0x8783ed+')');let _0x4c6e3b=null;const _0x446984=()=>{function _0x2bff45(_0x262957,_0x1e9238,_0x3f5e36,_0x52e858){return _0x260493(_0x262957-0x52,_0x262957,_0x3f5e36- -0x25d,_0x52e858-0x151);}function _0x354cc9(_0x347628,_0x18cdc8,_0x156abd,_0xa24535){return _0x2c05b6(_0x347628-0x18e,_0x156abd,_0x156abd-0x3f,_0x347628- -0x5a7);}eventSource[_0x2bff45(0x39e,0x38c,0x37d,0x379)+'ener'](eventNames['LLM_TRANSL'+_0x2bff45(0x3d4,0x3d7,0x39f,0x3f4)+_0x2bff45(0x377,0x3e7,0x3c3,0x3b8)],_0x3ef821);if(_0x4c6e3b)_0x50725f['QUTsf'](clearTimeout,_0x4c6e3b);},_0x3ef821=_0x55e956=>{if(_0x2932ea['fFLZH'](_0x55e956['id'],_0x8783ed))return;_0x2932ea[_0xd2b4fb(-0x16e,-0x15b,-0x141,-0x1b6)](_0x446984),console['log']('st-chatu8:'+'\x20已收到翻译\x20LLM'+_0x42e1e0(0x1da,0x1bb,0x1c6,0x1f3)+'\x20'+_0x8783ed+'):',_0x55e956);function _0x42e1e0(_0x3a28f9,_0x333e32,_0x2b2afc,_0x3b8ef8){return _0x2c05b6(_0x3a28f9-0x21,_0x3b8ef8,_0x2b2afc-0x17b,_0x2b2afc- -0x3be);}function _0xd2b4fb(_0x22472c,_0x2660ad,_0x2f8c4c,_0x3e79fc){return _0x260493(_0x22472c-0x1d8,_0x2660ad,_0x22472c- -0x727,_0x3e79fc-0x1de);}if(_0x55e956[_0x42e1e0(0x1fa,0x1da,0x1ce,0x1af)])_0x40db09(_0x55e956[_0x42e1e0(0x158,0x17d,0x174,0x122)]);else{if(_0x55e956[_0x42e1e0(0x19d,0x1ff,0x1bb,0x1d8)]&&_0x2932ea[_0xd2b4fb(-0x128,-0x129,-0xfd,-0x102)](_0x55e956[_0x42e1e0(0x17c,0x1a4,0x1bb,0x1dc)][_0xd2b4fb(-0x18c,-0x172,-0x19f,-0x162)],_0x42e1e0(0x1b1,0x21f,0x1cd,0x1e3))){const _0x5cb38e=new Error(_0x55e956[_0x42e1e0(0x1ae,0x1a7,0x1bb,0x1f8)][_0x42e1e0(0x1bf,0x13f,0x187,0x1ac)]);_0x5cb38e[_0xd2b4fb(-0x18c,-0x13f,-0x19e,-0x13c)]=_0xd2b4fb(-0x106,-0xb2,-0xf0,-0x135),_0x2932ea['omrSe'](_0x509d79,_0x5cb38e);}else _0x2932ea['CxJQS'](_0x509d79,new Error(_0x55e956[_0x42e1e0(0x14d,0x1ab,0x174,0x1c6)]));}};eventSource['on'](eventNames[_0x2c05b6(0x543,0x52d,0x535,0x53f)+_0x2c05b6(0x556,0x537,0x53c,0x566)+'ONSE'],_0x3ef821);const _0x2caac1={};_0x2caac1[_0x2c05b6(0x559,0x511,0x53b,0x504)]=_0x2e25cf,_0x2caac1['id']=_0x8783ed,eventSource[_0x260493(0x5b7,0x5e0,0x5b8,0x5c0)](eventNames[_0x2c05b6(0x4f2,0x53a,0x522,0x53f)+_0x260493(0x64c,0x5d4,0x61e,0x5ec)+_0x2c05b6(0x51f,0x51e,0x525,0x519)],_0x2caac1),_0x4c6e3b=setTimeout(()=>{function _0x5dc832(_0x361eae,_0xeaa6bc,_0x3daae0,_0x36495b){return _0x2c05b6(_0x361eae-0x4f,_0x3daae0,_0x3daae0-0xa9,_0xeaa6bc- -0x69);}const _0x52438a={'PYToM':function(_0x179da3,_0x1fd6f7){function _0x3dfa92(_0x4f50a9,_0x2829fa,_0x4cface,_0x2c7987){return _0x5176(_0x2c7987-0xcc,_0x2829fa);}return _0x50725f[_0x3dfa92(0x2a5,0x300,0x316,0x2e0)](_0x179da3,_0x1fd6f7);}};function _0x3d2144(_0x534a9a,_0x17cb08,_0x2cc83b,_0x2a218c){return _0x260493(_0x534a9a-0xe5,_0x2cc83b,_0x2a218c- -0x618,_0x2a218c-0x130);}if(_0x50725f['duaPG'](_0x50725f['bKQnZ'],_0x50725f[_0x5dc832(0x509,0x4f4,0x51a,0x4ce)]))_0x446984(),_0x50725f[_0x5dc832(0x487,0x4ac,0x467,0x45d)](_0x509d79,new Error('翻译\x20LLM\x20执行超'+'时（'+timeoutMs+_0x5dc832(0x52a,0x504,0x53f,0x4da)));else{const _0x5d0b39=_0x3808d8[_0x5dc832(0x55e,0x525,0x4ed,0x52b)]('\x5c');if(_0x5d0b39>-0x1*0xea2+-0x1*-0xa06+0x49c){const _0x346e78=_0x3a701d[_0x3d2144(-0x59,-0x24,-0x90,-0x5a)](-0x6*-0x40f+0x14e*-0xf+-0x4c8*0x1,_0x5d0b39)['trim'](),_0x964a97=_0x5bcac4[_0x5dc832(0x4e4,0x4bf,0x500,0x49a)](_0x52438a[_0x5dc832(0x508,0x4e2,0x519,0x495)](_0x5d0b39,0x1e4a*-0x1+0xa12+-0xa7*-0x1f))['trim']();if(_0x346e78)_0x3d7867[_0x346e78]=_0x964a97;}}},timeoutMs);}else _0x3821d9+=_0xb71e1e;});}export async function callTranslation(_0x1d4591){const _0x587d07={'dawNK':function(_0x1446cc,_0x1fe086,_0x761135){return _0x1446cc(_0x1fe086,_0x761135);},'fiFEC':function(_0x2778da,_0x1c18a2){return _0x2778da||_0x1c18a2;},'saNME':function(_0x1c0c5c,_0x33febf){return _0x1c0c5c(_0x33febf);},'uvasr':function(_0x6a9457,_0x51f3af){return _0x6a9457===_0x51f3af;},'CSFiM':_0x3c63d4(0x400,0x420,0x453,0x3d3),'VbmHy':_0x2de8b9(0x308,0x343,0x2ca,0x30c),'DomGo':function(_0x2741a0,_0x57f837){return _0x2741a0(_0x57f837);},'uovYB':_0x3c63d4(0x437,0x441,0x3ee,0x415)};function _0x3c63d4(_0x35d38b,_0x4e2231,_0x2f2aba,_0x320f84){return _0x5176(_0x4e2231-0x1ba,_0x2f2aba);}function _0x2de8b9(_0x256d4f,_0xeb0f47,_0x50f2e3,_0x4bf5e9){return _0x5176(_0x256d4f-0x10a,_0xeb0f47);}try{let _0x4eeb9a=_0x587d07[_0x3c63d4(0x3e7,0x3fd,0x3bb,0x409)](buildPromptForRequestType,_0x3c63d4(0x3a9,0x3f9,0x3d1,0x3e6)+'n',_0x587d07[_0x3c63d4(0x41b,0x3de,0x3fc,0x404)](_0x1d4591,''));_0x4eeb9a=_0x587d07[_0x3c63d4(0x3ee,0x3cd,0x393,0x3cf)](mergeAdjacentMessages,_0x4eeb9a);const _0x78b194=[..._0x4eeb9a,{'role':_0x3c63d4(0x447,0x434,0x485,0x468),'content':_0x587d07[_0x2de8b9(0x32e,0x338,0x307,0x321)](_0x1d4591,'')}];_0x587d07[_0x3c63d4(0x382,0x3cd,0x419,0x38b)](updateCombinedPrompt,_0x78b194);const _0x39cc51=await _0x587d07[_0x2de8b9(0x31d,0x352,0x363,0x359)](LLM_TRANSLATION,_0x78b194);return _0x39cc51;}catch(_0x5e2455){if(_0x587d07[_0x3c63d4(0x3e4,0x3bf,0x3e1,0x3a1)](_0x587d07[_0x3c63d4(0x427,0x3d9,0x42b,0x428)],_0x587d07[_0x2de8b9(0x354,0x323,0x30e,0x35d)]))return _0x2ff7d2[_0x2de8b9(0x32f,0x2dc,0x30f,0x37f)](_0x1abd9b=>_0x1abd9b[_0x2de8b9(0x344,0x32c,0x30e,0x32c)](_0x196869[_0x2de8b9(0x2fa,0x32a,0x2d3,0x30a)]()));else{_0x587d07['DomGo'](addLog,_0x2de8b9(0x39d,0x3dc,0x37e,0x397)+_0x5e2455[_0x2de8b9(0x337,0x314,0x310,0x37d)]),console[_0x2de8b9(0x36b,0x387,0x327,0x367)](_0x587d07[_0x3c63d4(0x424,0x423,0x473,0x45a)],_0x5e2455);throw _0x5e2455;}}}let isAiInitialized=![];export function initAiSettings(_0x47bd49){const _0x3ca885={};_0x3ca885['gpfgZ']=_0xf79909(0x566,0x5a4,0x590,0x580)+_0xf79909(0x53c,0x4f9,0x530,0x525)+'\x20LLM\x20设置页面';function _0xf79909(_0x32fd41,_0x320d11,_0x1b0a41,_0x2f9f8a){return _0x5176(_0x1b0a41-0x337,_0x32fd41);}_0x3ca885[_0xf79909(0x609,0x5ef,0x5c4,0x588)]=function(_0x554cef,_0x1e91d9){return _0x554cef!==_0x1e91d9;};function _0x85803c(_0x1da645,_0x30c049,_0x3f4e3d,_0x3e09dc){return _0x5176(_0x30c049-0x3a5,_0x3e09dc);}_0x3ca885['QZnfr']=_0xf79909(0x565,0x592,0x5af,0x5b3);const _0x41234c=_0x3ca885;!isAiInitialized&&(_0x41234c[_0xf79909(0x5b5,0x5f2,0x5c4,0x60e)](_0xf79909(0x5ba,0x5be,0x5a5,0x568),_0x41234c[_0x85803c(0x551,0x598,0x564,0x590)])?(console['log'](_0x41234c['gpfgZ']),isAiInitialized=!![]):!_0x317506&&(_0x35adbb[_0x85803c(0x5a8,0x5f4,0x647,0x608)](_0x41234c[_0x85803c(0x5c6,0x5a9,0x5f9,0x5c9)]),_0x201c9c=!![]));}