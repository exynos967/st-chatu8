(function(_0x123359,_0x261fe1){const _0x647cc9=_0x123359();function _0x3fcf19(_0x17c428,_0x36ce87,_0x1d6b85,_0x25dc63){return _0x4c0a(_0x17c428-0xe0,_0x36ce87);}function _0x3e30f2(_0x338421,_0x17d0c9,_0x7dd66a,_0xeff2bd){return _0x4c0a(_0x7dd66a-0xe8,_0xeff2bd);}while(!![]){try{const _0x3c83f9=-parseInt(_0x3e30f2(0x2c0,0x294,0x2e7,0x2ae))/(0x1123*0x2+-0x21a5+-0xa0)*(-parseInt(_0x3fcf19(0x364,0x320,0x31f,0x349))/(-0x1369+-0x1*0x106f+0x23da))+parseInt(_0x3fcf19(0x320,0x2c8,0x344,0x2ea))/(0x1e*-0x2f+-0x20*0x8+-0x685*-0x1)*(parseInt(_0x3fcf19(0x2f7,0x34b,0x2e0,0x34d))/(-0x72*0x6+0x15fd+-0x134d))+-parseInt(_0x3e30f2(0x32c,0x2f8,0x347,0x35f))/(0x9e3*-0x1+0x1685+-0xc9d)*(parseInt(_0x3fcf19(0x35c,0x30e,0x347,0x35d))/(0xe43+-0x22da+0x149d))+-parseInt(_0x3fcf19(0x2cd,0x303,0x31f,0x2b2))/(-0x1*0x2390+0x2f7+0x2b8*0xc)+-parseInt(_0x3e30f2(0x37e,0x377,0x336,0x370))/(0x1a2d+0x517*0x5+-0x3398)*(parseInt(_0x3e30f2(0x322,0x335,0x33a,0x2f0))/(0x3*0x79b+-0x101*-0x25+-0x3bed))+parseInt(_0x3e30f2(0x37b,0x362,0x338,0x341))/(-0x184d+0x1c75+0x11*-0x3e)*(-parseInt(_0x3e30f2(0x32c,0x369,0x34e,0x3a2))/(0x11aa*0x2+0x1*0x1721+-0x3a6a))+-parseInt(_0x3fcf19(0x310,0x2c1,0x34b,0x2e2))/(-0x1*-0x21d4+0x2*-0x132f+0x496*0x1)*(-parseInt(_0x3fcf19(0x356,0x3a8,0x312,0x38d))/(-0x509*0x5+-0xf6a+0x28a4));if(_0x3c83f9===_0x261fe1)break;else _0x647cc9['push'](_0x647cc9['shift']());}catch(_0x184a51){_0x647cc9['push'](_0x647cc9['shift']());}}}(_0x5840,-0xd76c2+0x66953+0x137549));const _0x4a223e=(function(){function _0x45bef9(_0x1da5cd,_0x1a6755,_0x2e5869,_0x2b57f9){return _0x4c0a(_0x1a6755-0x328,_0x2b57f9);}const _0x43eff9={};_0x43eff9[_0x45bef9(0x537,0x54f,0x58f,0x59d)]=_0x271e06(-0xa0,-0xe1,-0x9a,-0x96);function _0x271e06(_0x24c713,_0x2a8dd6,_0xdb9fcd,_0x38f2d2){return _0x4c0a(_0x24c713- -0x2fc,_0xdb9fcd);}_0x43eff9[_0x271e06(-0x79,-0x3f,-0xb6,-0x2c)]=function(_0x4ca797,_0x3fdfa0){return _0x4ca797!==_0x3fdfa0;},_0x43eff9[_0x45bef9(0x4f7,0x50d,0x4dd,0x51d)]=_0x45bef9(0x587,0x54b,0x529,0x53d),_0x43eff9[_0x271e06(-0xd2,-0xde,-0xb1,-0x106)]='tBScI';const _0x59c21c=_0x43eff9;let _0x2e4a26=!![];return function(_0x25683b,_0x46850a){const _0x2f0412={};_0x2f0412[_0x47aa13(0x21c,0x254,0x1df,0x201)]=function(_0x282f68,_0x133bec){return _0x282f68===_0x133bec;};function _0x47aa13(_0x3efe16,_0x53eb69,_0x2f8e1c,_0x43d544){return _0x271e06(_0x3efe16-0x31a,_0x53eb69-0x104,_0x43d544,_0x43d544-0x6d);}_0x2f0412[_0x158f31(0x15c,0x112,0x12d,0x134)]=_0x59c21c['vBcCZ'];function _0x158f31(_0x46d390,_0x40951f,_0x3e25fa,_0x24c317){return _0x271e06(_0x40951f-0x1fe,_0x40951f-0x1b5,_0x24c317,_0x24c317-0x2c);}const _0x36520c=_0x2f0412;if(_0x59c21c['Opcpz'](_0x59c21c[_0x158f31(0x137,0xe7,0x117,0xd2)],_0x59c21c[_0x47aa13(0x248,0x285,0x244,0x28e)])){const _0x1a0f5b=_0x2e4a26?function(){function _0xefcd0f(_0x4715de,_0x77e63d,_0x3aa136,_0x502ea8){return _0x47aa13(_0x502ea8-0x37c,_0x77e63d-0xea,_0x3aa136-0xa6,_0x3aa136);}function _0x1c9f7e(_0x43bf20,_0x2bcf50,_0x21613d,_0x3f3417){return _0x47aa13(_0x21613d- -0x110,_0x2bcf50-0x16f,_0x21613d-0x1c,_0x2bcf50);}if(_0x46850a){if(_0x36520c['CFxsk'](_0x36520c[_0xefcd0f(0x591,0x5a1,0x5db,0x5aa)],_0x36520c[_0xefcd0f(0x5db,0x5a3,0x56e,0x5aa)])){const _0x5aa1b6=_0x46850a[_0x1c9f7e(0x16a,0x121,0x11a,0x126)](_0x25683b,arguments);return _0x46850a=null,_0x5aa1b6;}else return _0x27e45d;}}:function(){};return _0x2e4a26=![],_0x1a0f5b;}else{_0x1b3a47(_0x47aa13(0x211,0x235,0x1ce,0x218)+_0x55c146[_0x158f31(0x15b,0x13c,0x129,0x153)]),_0x372dcc[_0x47aa13(0x227,0x1db,0x1fe,0x26e)](_0x158f31(0x180,0x188,0x1a4,0x150),_0x482711);throw _0x77cbb5;}};}()),_0x5f14bb=_0x4a223e(this,function(){function _0xe20998(_0x17428c,_0x4b8907,_0x580006,_0x31de84){return _0x4c0a(_0x4b8907-0x21b,_0x31de84);}function _0xbd8223(_0x3fc228,_0x12c2ef,_0x443020,_0x13138b){return _0x4c0a(_0x13138b- -0x11,_0x443020);}const _0x14cbec={};_0x14cbec[_0xe20998(0x44d,0x463,0x41a,0x442)]=_0xbd8223(0x20c,0x247,0x298,0x256)+'+$';const _0x50776a=_0x14cbec;return _0x5f14bb['toString']()['search'](_0x50776a[_0xe20998(0x444,0x463,0x495,0x4b8)])[_0xbd8223(0x2b2,0x221,0x295,0x25e)]()['constructo'+'r'](_0x5f14bb)['search'](_0x50776a[_0xbd8223(0x200,0x20b,0x26e,0x237)]);});_0x5f14bb();import{extension_settings}from'../../../../extensions.js';import{saveSettingsDebounced,eventSource}from'../../../../../script.js';import{extensionName,eventNames}from'./config.js';import{addLog}from'./utils.js';import{updateCombinedPrompt}from'./settings/llm.js';import{buildPromptForRequestType}from'./settings/llmService.js';import{mergeAdjacentMessages}from'./promptProcessor.js';let settings;const SD_SYMBOL_PATTERN=/^([\(\[\{<]+)?(.*?)([\)\]\}>]+)?(:[\d.]+)?$/,SKIP_PATTERNS=[/^<lora:/i,/^<lyco:/i,/^<hypernet:/i,/^[\d.:]+$/,/^$/,/^\$.*\$$/];function shouldSkipTranslation(_0x29e4ea){function _0x5ae0e2(_0x105611,_0x843e42,_0x160350,_0x2a4f7f){return _0x4c0a(_0x2a4f7f- -0x2c1,_0x105611);}function _0x462eda(_0x3e432f,_0x5c6f6e,_0x3e71d6,_0x27f246){return _0x4c0a(_0x3e432f-0x228,_0x5c6f6e);}return SKIP_PATTERNS[_0x5ae0e2(-0x3b,-0xa,0x6,-0x3f)](_0x55fb00=>_0x55fb00['test'](_0x29e4ea[_0x462eda(0x413,0x414,0x43f,0x439)]()));}export function tagsToJsonString(_0x463d93){if(!Array[_0x2761b2(0x2b9,0x280,0x30b,0x2a1)](_0x463d93))return'[]';function _0x409221(_0x2f001f,_0x3133a6,_0x2eb1b2,_0x511dc0){return _0x4c0a(_0x3133a6- -0x3ac,_0x2f001f);}function _0x2761b2(_0x59b99c,_0x3ad30a,_0x2e5c6c,_0x54f25e){return _0x4c0a(_0x59b99c-0x3f,_0x2e5c6c);}return JSON[_0x409221(-0x205,-0x1be,-0x16d,-0x1ec)](_0x463d93['filter'](_0x5f1f21=>_0x5f1f21&&typeof _0x5f1f21===_0x2761b2(0x2cc,0x2ae,0x2ef,0x319)));}export function preprocessPromptForTranslation(_0x4d25c7){const _0x13ffc1={'idFuX':function(_0x38f0ae,_0x8513a8){return _0x38f0ae(_0x8513a8);},'YhtnN':function(_0x1959ea,_0x520fe6,_0x1c469e){return _0x1959ea(_0x520fe6,_0x1c469e);},'EWSIk':function(_0x2584c4,_0x15f146){return _0x2584c4===_0x15f146;},'yKpvD':_0x226cd8(0x4c4,0x4f1,0x4cc,0x4df),'ufjCO':function(_0x488a2d,_0x464a22){return _0x488a2d<_0x464a22;},'pmEUz':function(_0x5e6b2c,_0x3da55b){return _0x5e6b2c===_0x3da55b;},'lfrdn':'plunr','fclWV':function(_0x3c1f98,_0x798eb6){return _0x3c1f98===_0x798eb6;},'KsTpg':_0x226cd8(0x4d0,0x4ed,0x4bc,0x4d7),'mhSjP':function(_0x1e825a,_0x15dd56){return _0x1e825a(_0x15dd56);},'nMJzI':function(_0x4c7ce4,_0x8c5f7f){return _0x4c7ce4===_0x8c5f7f;},'BLcSU':'rtPSC','XpeHL':function(_0x5af9cd,_0x5da742){return _0x5af9cd(_0x5da742);}};if(!_0x4d25c7||typeof _0x4d25c7!==_0x13ffc1['KsTpg'])return{'originalTags':[],'cleanedTags':[],'cleanedText':'','tagMap':new Map()};function _0x226cd8(_0x303a2c,_0x48ab94,_0x84671c,_0x4fe2fa){return _0x4c0a(_0x303a2c-0x243,_0x84671c);}const _0x549843=_0x6b7f9a=>{function _0x2700e9(_0x462388,_0x13a0e0,_0x122e48,_0x2748ae){return _0x226cd8(_0x462388- -0xd8,_0x13a0e0-0x41,_0x13a0e0,_0x2748ae-0x119);}function _0x5e669f(_0x38cb7d,_0x16e4e1,_0x5bd55c,_0x267543){return _0x157fa6(_0x38cb7d-0x1bf,_0x16e4e1-0x185,_0x38cb7d,_0x5bd55c- -0x158);}if(_0x13ffc1[_0x5e669f(0x226,0x27b,0x25c,0x208)](_0x13ffc1[_0x2700e9(0x3a7,0x3f4,0x3c4,0x3b4)],'ajlwE'))_0x2d397d[_0x14aba0['toLowerCas'+'e']()]=_0xbc850d;else{const _0x2421db=[];let _0x314e45='',_0x12f1df=![];for(let _0xcf140d=0xe89+0x1c2e*-0x1+0xda5;_0x13ffc1['ufjCO'](_0xcf140d,_0x6b7f9a[_0x5e669f(0x231,0x218,0x22c,0x1fe)]);_0xcf140d++){if(_0x13ffc1[_0x2700e9(0x3b1,0x3e5,0x388,0x3f4)]('xYAwc',_0x13ffc1[_0x5e669f(0x1c1,0x195,0x1c2,0x1c4)])){const _0x3bc3e0={'UxsHT':_0x2700e9(0x3e4,0x402,0x3a2,0x3b8),'PPWDG':function(_0x36ba96,_0x242173){return _0x36ba96!==_0x242173;},'ekkFY':function(_0x26732e,_0x38e139){function _0x140d44(_0x273268,_0x2fc546,_0x37abd9,_0x48c9c5){return _0x2700e9(_0x2fc546-0xca,_0x37abd9,_0x37abd9-0x9e,_0x48c9c5-0x115);}return _0x13ffc1[_0x140d44(0x4e6,0x493,0x4e8,0x4dd)](_0x26732e,_0x38e139);},'kMcHH':function(_0x352e0d,_0x1bcafd,_0x5480d4){function _0x3c3f57(_0x4c7ae6,_0x4f873f,_0x4ec3e0,_0x19aa6d){return _0x5e669f(_0x4c7ae6,_0x4f873f-0x29,_0x4ec3e0- -0x68,_0x19aa6d-0x178);}return _0x13ffc1[_0x3c3f57(0x1d3,0x1df,0x1a6,0x1cd)](_0x352e0d,_0x1bcafd,_0x5480d4);}};return new _0x3c5635((_0x4c87ac,_0x297c22)=>{const _0x5b4e7e={'qqSkq':function(_0x8fcf80,_0x167bc9){function _0x2d6d3c(_0x91d051,_0x18588d,_0x31aa3b,_0x5497f9){return _0x4c0a(_0x31aa3b- -0x3de,_0x91d051);}return _0x3bc3e0[_0x2d6d3c(-0x199,-0x148,-0x181,-0x1ba)](_0x8fcf80,_0x167bc9);},'sOBVP':function(_0x57da23,_0x699707){return _0x3bc3e0['ekkFY'](_0x57da23,_0x699707);}},_0x543647=_0x480e1a();_0x4e459f[_0x431ab3(0x43b,0x3c3,0x3f6,0x3b4)](_0x431ab3(0x3b5,0x3bf,0x405,0x3ee)+_0x431ab3(0x3d1,0x35e,0x3a0,0x37f)+_0x431ab3(0x370,0x374,0x3c4,0x3c1)+_0x543647+')');function _0x431ab3(_0x5953a0,_0x565b68,_0x49c7c3,_0x352e85){return _0x5e669f(_0x352e85,_0x565b68-0xb0,_0x49c7c3-0x1e0,_0x352e85-0xb4);}const _0xa0e302=_0x317381=>{function _0x229274(_0x141122,_0x278faa,_0x208e17,_0x14240d){return _0x431ab3(_0x141122-0x109,_0x278faa-0x15d,_0x278faa- -0x73,_0x141122);}if(_0x5b4e7e[_0x372fa0(-0x1bc,-0x166,-0x191,-0x1a3)](_0x317381['id'],_0x543647))return;_0x1a5cc6[_0x229274(0x345,0x360,0x3b1,0x359)+_0x229274(0x372,0x3b5,0x382,0x40b)](_0x1b9dda['LLM_TRANSL'+_0x372fa0(-0x18b,-0x171,-0x15e,-0x124)+_0x372fa0(-0x1d8,-0x162,-0x1b8,-0x1d5)+_0x372fa0(-0x1c4,-0x163,-0x18e,-0x1b5)],_0xa0e302);const {prompt:_0x11bf2c}=_0x317381;_0x1e23f4[_0x372fa0(-0x160,-0x15a,-0x17d,-0x1bb)](_0x372fa0(-0x196,-0x156,-0x16e,-0x12d)+_0x229274(0x305,0x352,0x3a0,0x338)+_0x229274(0x392,0x3ac,0x3af,0x3c2)+_0x543647+'):',_0x11bf2c);function _0x372fa0(_0x1f3255,_0x33dc45,_0x23dc27,_0x174685){return _0x144e4c(_0x1f3255-0x1,_0x23dc27- -0x2c1,_0x174685,_0x174685-0x19f);}_0x5b4e7e[_0x372fa0(-0x1c5,-0x224,-0x1ce,-0x1fa)](_0x4c87ac,_0x11bf2c);};_0x384805['on'](_0xc68355[_0x144e4c(0x171,0x13b,0xe3,0x165)+_0x431ab3(0x45c,0x3c7,0x415,0x3f2)+'PROMPT_RES'+_0x431ab3(0x434,0x3e7,0x3e5,0x3de)],_0xa0e302);const _0x2a3927={};_0x2a3927['id']=_0x543647;function _0x144e4c(_0x21deb2,_0x4386ae,_0xeb3e93,_0x2196d7){return _0x2700e9(_0x4386ae- -0x273,_0xeb3e93,_0xeb3e93-0x48,_0x2196d7-0xdc);}_0x10c314['emit'](_0x28d5a0[_0x144e4c(0x16a,0x13b,0xf4,0x148)+_0x144e4c(0x1a4,0x163,0x188,0x11b)+_0x144e4c(0x17a,0x12e,0x16f,0x109)+'UEST'],_0x2a3927),_0x3bc3e0['kMcHH'](_0x2b9093,()=>{function _0x921b60(_0x1faaaf,_0x599cc3,_0x2ec07d,_0x473a37){return _0x144e4c(_0x1faaaf-0x140,_0x473a37- -0x88,_0x2ec07d,_0x473a37-0x1b5);}function _0x1a1fba(_0x188ec4,_0x2b6f9b,_0x25e9fc,_0x48fcc1){return _0x431ab3(_0x188ec4-0x3f,_0x2b6f9b-0x66,_0x188ec4-0x1ab,_0x48fcc1);}_0x3fb5b9[_0x921b60(0x5d,0x9a,0x83,0x99)+_0x1a1fba(0x5d3,0x5bc,0x582,0x5dd)](_0x4f3845[_0x1a1fba(0x598,0x57b,0x5d6,0x5dd)+_0x1a1fba(0x5c0,0x57c,0x5ee,0x5c4)+'PROMPT_RES'+'PONSE'],_0xa0e302),_0x297c22(new _0x2d055f(_0x3bc3e0[_0x921b60(0x3f,0xb0,0x32,0x82)]));},-0x1*-0xe81+0x11*0x422+-0x2db3*0x1);});}else{const _0xf9e655=_0x6b7f9a[_0xcf140d];if(_0x13ffc1['fclWV'](_0xf9e655,'$'))_0x12f1df=!_0x12f1df,_0x314e45+=_0xf9e655;else{if((_0xf9e655===','||_0x13ffc1[_0x2700e9(0x3b6,0x40c,0x370,0x396)](_0xf9e655,'，'))&&!_0x12f1df){const _0x50b0fa=_0x314e45[_0x5e669f(0x187,0x18b,0x1b5,0x1a2)]();if(_0x50b0fa)_0x2421db[_0x2700e9(0x3de,0x3fc,0x3c0,0x412)](_0x50b0fa);_0x314e45='';}else _0x314e45+=_0xf9e655;}}}if(_0x314e45[_0x5e669f(0x19c,0x1f2,0x1b5,0x17e)]())_0x2421db[_0x5e669f(0x206,0x266,0x23d,0x251)](_0x314e45[_0x5e669f(0x1bc,0x1f2,0x1b5,0x1ec)]());return _0x2421db;}},_0x328f63=_0x13ffc1[_0x157fa6(0x33c,0x363,0x35c,0x380)](_0x549843,_0x4d25c7);function _0x157fa6(_0xd5005c,_0x25cd32,_0x15c6f0,_0x2e0f34){return _0x4c0a(_0x2e0f34-0x122,_0x15c6f0);}const _0x2f8442=[],_0x4186bd=[],_0x22759f=new Map();for(const _0x5c5a62 of _0x328f63){const _0x30d42a=_0x5c5a62[_0x157fa6(0x2c6,0x366,0x33d,0x313)](SD_SYMBOL_PATTERN);if(_0x30d42a){const _0x53109b=_0x30d42a[0x13*-0xab+-0x198d+0x263f]||'',_0x24976f=(_0x30d42a[0x66f*0x4+-0x20e5+-0x16f*-0x5]||'')[_0x157fa6(0x34f,0x2e8,0x2ca,0x30d)](),_0x92a204=_0x30d42a[-0xbe9*0x3+-0x6f1*-0x5+0x109]||'',_0x160154=_0x30d42a[-0x1*-0x22fe+0x21b1+-0x44ab*0x1]||'',_0x448da0={'original':_0x5c5a62,'cleaned':_0x24976f,'prefix':_0x53109b,'suffix':_0x92a204,'weight':_0x160154,'skip':_0x13ffc1[_0x157fa6(0x3f1,0x3c5,0x372,0x39d)](shouldSkipTranslation,_0x5c5a62)||_0x13ffc1['mhSjP'](shouldSkipTranslation,_0x24976f)};_0x2f8442[_0x226cd8(0x4b6,0x4ca,0x4a1,0x467)](_0x448da0);if(!_0x448da0[_0x157fa6(0x2d9,0x2d1,0x361,0x325)]&&_0x24976f){if(_0x13ffc1[_0x157fa6(0x352,0x383,0x3a2,0x3aa)](_0x13ffc1[_0x157fa6(0x3b4,0x3b2,0x39c,0x38c)],_0x13ffc1[_0x226cd8(0x4ad,0x459,0x499,0x4ce)]))_0x4186bd['push'](_0x24976f),_0x22759f['set'](_0x24976f[_0x157fa6(0x2d3,0x374,0x330,0x31f)+'e'](),_0x448da0);else{const _0x210290={};return _0x210290[_0x157fa6(0x3db,0x367,0x392,0x393)]=_0x37e2f3,_0x210290[_0x157fa6(0x332,0x37e,0x33a,0x326)+'n']='',_0x210290[_0x226cd8(0x45f,0x472,0x41d,0x457)]=_0x1ba0e2,_0x210290[_0x157fa6(0x33e,0x31c,0x33b,0x311)]=!![],_0x210290;}}}else{const _0x29fb77={'original':_0x5c5a62,'cleaned':_0x5c5a62,'prefix':'','suffix':'','weight':'','skip':_0x13ffc1[_0x226cd8(0x4a1,0x4d8,0x474,0x496)](shouldSkipTranslation,_0x5c5a62)};_0x2f8442[_0x226cd8(0x4b6,0x4e4,0x501,0x4da)](_0x29fb77),!_0x29fb77[_0x157fa6(0x2e9,0x369,0x2db,0x325)]&&_0x5c5a62&&(_0x4186bd[_0x226cd8(0x4b6,0x504,0x4be,0x503)](_0x5c5a62),_0x22759f[_0x226cd8(0x458,0x421,0x475,0x467)](_0x5c5a62[_0x157fa6(0x362,0x2dc,0x2f8,0x31f)+'e'](),_0x29fb77));}}return{'originalTags':_0x2f8442,'cleanedTags':_0x4186bd,'cleanedText':_0x13ffc1[_0x157fa6(0x358,0x34a,0x315,0x347)](tagsToJsonString,_0x4186bd),'tagMap':_0x22759f};}export function combineTranslationResult(_0xff9fa0,_0x3a1ce1){const _0x5770ef={};_0x5770ef[_0x1466ad(0x17,-0x20,-0x42,-0x14)]=_0x263c94(0x16e,0x193,0x1b9,0x1fd),_0x5770ef[_0x263c94(0x1c4,0x1bb,0x1d0,0x21c)]=_0x1466ad(0x27,0x41,0xf,0x61);function _0x1466ad(_0x212d8d,_0x2b4c55,_0x549de2,_0x181c6c){return _0x4c0a(_0x181c6c- -0x20d,_0x549de2);}_0x5770ef[_0x1466ad(0x73,0x77,0xca,0x73)]=function(_0x394596,_0x3b5bee){return _0x394596!==_0x3b5bee;},_0x5770ef[_0x1466ad(0x52,0x71,0xc,0x30)]=function(_0xabef53,_0xc2ee66){return _0xabef53===_0xc2ee66;},_0x5770ef[_0x263c94(0x1f1,0x1f0,0x1cf,0x1c2)]=_0x263c94(0x223,0x1db,0x203,0x1be),_0x5770ef[_0x1466ad(0x1a,-0x20,0x56,0xb)]=_0x263c94(0x1ad,0x1d5,0x1e0,0x18c);const _0x486b3a=_0x5770ef;if(!_0xff9fa0||!Array[_0x263c94(0x1f4,0x206,0x229,0x1e4)](_0xff9fa0)){if(_0x486b3a[_0x263c94(0x258,0x1dd,0x22f,0x1e8)](_0x263c94(0x1ed,0x19d,0x1e1,0x226),_0x263c94(0x222,0x1d9,0x1e1,0x238))){const _0x3e694d=new _0x10b108(_0x13cb67['error'][_0x263c94(0x1b4,0x1b5,0x1e9,0x1b7)]);_0x3e694d['name']=_0x486b3a[_0x1466ad(-0x10,-0x2d,-0x40,-0x14)],_0x334f48(_0x3e694d);}else return[];}const _0x410cfc={};function _0x263c94(_0x517e93,_0x2bfd53,_0x3b0177,_0x16506e){return _0x4c0a(_0x3b0177- -0x51,_0x2bfd53);}if(_0x3a1ce1&&_0x486b3a[_0x1466ad(0x63,0x5,0x6,0x30)](typeof _0x3a1ce1,_0x263c94(0x198,0x1f2,0x1a3,0x14e))){if(_0x486b3a[_0x263c94(0x219,0x280,0x22f,0x26f)](_0x486b3a[_0x1466ad(0x2b,0x4b,0x68,0x13)],_0x486b3a[_0x1466ad(0x2b,-0x1a,-0x14,0x13)])){const _0x3b974a=_0x3e536e?function(){function _0x41bc2e(_0x3227ac,_0x510e49,_0x5547ae,_0x12a2f7){return _0x263c94(_0x3227ac-0x1e1,_0x3227ac,_0x5547ae- -0x307,_0x12a2f7-0xd6);}if(_0x640a85){const _0x19aeef=_0xed695d[_0x41bc2e(-0x137,-0x164,-0x14c,-0x114)](_0x263a57,arguments);return _0x35304b=null,_0x19aeef;}}:function(){};return _0x320d5c=![],_0x3b974a;}else for(const [_0x39e5f2,_0x1897ff]of Object[_0x263c94(0x22c,0x1ad,0x1db,0x1b6)](_0x3a1ce1)){if(_0x486b3a['wSHGt']('OExPD',_0x486b3a[_0x263c94(0x1bb,0x1cb,0x1c7,0x181)]))_0x410cfc[_0x39e5f2[_0x263c94(0x1ce,0x1c0,0x1ac,0x176)+'e']()]=_0x1897ff;else{if(!_0x23cdee[_0x1466ad(0x70,0x9d,0x57,0x6d)](_0x2bc39c))return'[]';return _0x4f315c[_0x263c94(0x14d,0x1c8,0x19d,0x150)](_0x272f67['filter'](_0x315c29=>_0x315c29&&typeof _0x315c29===_0x263c94(0x254,0x1ec,0x23c,0x244)));}}}return _0xff9fa0['map'](_0x313a1b=>{const {original:_0x1e6448,cleaned:_0x63b2b3,skip:_0x3339ce}=_0x313a1b;function _0x4b5c2d(_0x4f8119,_0x579615,_0x3c0125,_0x41e30f){return _0x1466ad(_0x4f8119-0x1,_0x579615-0x12,_0x3c0125,_0x41e30f-0x48);}if(_0x3339ce){if(_0x5031ac(0x29d,0x2af,0x2a9,0x2f1)===_0x486b3a[_0x5031ac(0x250,0x26d,0x242,0x215)]){const _0x19ad68={};return _0x19ad68[_0x4b5c2d(0xfd,0x56,0xbe,0xac)]=_0x1e6448,_0x19ad68[_0x4b5c2d(0x2e,-0xa,0x1,0x3f)+'n']='',_0x19ad68[_0x5031ac(0x24b,0x249,0x23f,0x1fd)]=_0x63b2b3,_0x19ad68[_0x4b5c2d(-0x1a,-0x2b,0x2b,0x2a)]=!![],_0x19ad68;}else return'';}function _0x5031ac(_0x558145,_0x314da2,_0x5206e1,_0x2c6414){return _0x263c94(_0x558145-0x18,_0x314da2,_0x558145-0x80,_0x2c6414-0x152);}const _0x2c538f=_0x410cfc[_0x63b2b3[_0x5031ac(0x22c,0x1ec,0x1df,0x261)+'e']()]||'',_0x542a53={};return _0x542a53['original']=_0x1e6448,_0x542a53['translatio'+'n']=_0x2c538f,_0x542a53[_0x4b5c2d(0xf,0x36,0x5f,0x57)]=_0x63b2b3,_0x542a53[_0x5031ac(0x21e,0x20f,0x20d,0x244)]=![],_0x542a53;});}export function formatTranslationDisplay(_0x2b9c54,_0x345551={}){const _0x254234={};_0x254234[_0x5e9ae3(0x172,0x1be,0x1b0,0x1b8)]=function(_0x15dd14,_0x3ca708){return _0x15dd14>_0x3ca708;};function _0x5e9ae3(_0x586fa8,_0x2b84bc,_0x250325,_0x90f834){return _0x4c0a(_0x90f834- -0x9d,_0x2b84bc);}_0x254234['qIxsy']=function(_0x3d3737,_0x6c22c8){return _0x3d3737===_0x6c22c8;},_0x254234[_0x48cc0e(0x326,0x2e6,0x36f,0x317)]=_0x48cc0e(0x2c3,0x2f4,0x2df,0x2cd),_0x254234[_0x5e9ae3(0x170,0x15a,0x149,0x149)]=function(_0x1183b7,_0x323020){return _0x1183b7!==_0x323020;},_0x254234[_0x5e9ae3(0x18a,0x16d,0x17c,0x1ba)]=_0x48cc0e(0x33d,0x376,0x363,0x356);const _0x20dc52=_0x254234,{separator:separator=',\x20',showOriginal:showOriginal=!![],showTranslation:showTranslation=!![]}=_0x345551;function _0x48cc0e(_0x19c589,_0x400de7,_0x3b8885,_0x48d9f0){return _0x4c0a(_0x19c589-0xd9,_0x48d9f0);}if(!_0x2b9c54||!Array[_0x48cc0e(0x353,0x355,0x330,0x30c)](_0x2b9c54)){if(_0x20dc52[_0x48cc0e(0x2bf,0x2bc,0x2b3,0x285)](_0x48cc0e(0x2e8,0x2a7,0x2b5,0x340),_0x20dc52[_0x48cc0e(0x330,0x2e0,0x2ed,0x319)]))return'';else{const _0x6dcfd0={'original':_0x5d133c,'cleaned':_0x27a656,'prefix':'','suffix':'','weight':'','skip':_0x4ae7d1(_0x5e25f)};_0x2964d9['push'](_0x6dcfd0),!_0x6dcfd0['skip']&&_0x3cf5a8&&(_0x515652[_0x48cc0e(0x34c,0x37f,0x389,0x394)](_0x2b5a08),_0x4710cf[_0x5e9ae3(0x189,0x1bd,0x16a,0x178)](_0x55e981[_0x48cc0e(0x2d6,0x2f0,0x30e,0x29b)+'e'](),_0x6dcfd0));}}return _0x2b9c54[_0x5e9ae3(0x155,0x140,0x16a,0x171)](_0x2a2088=>{function _0xb37de4(_0x2c58bb,_0x29edb4,_0x5acd9a,_0x271b45){return _0x48cc0e(_0x5acd9a-0xc7,_0x29edb4-0x3a,_0x5acd9a-0x128,_0x271b45);}function _0x22bc31(_0x37fbae,_0x72c7ed,_0x23a7af,_0x5e7081){return _0x5e9ae3(_0x37fbae-0x198,_0x5e7081,_0x23a7af-0x18,_0x72c7ed- -0xe5);}const _0x47b135={'dXDak':function(_0x161e32,_0x24aca4){function _0x33b77e(_0x1b8f81,_0xd3c61c,_0x459900,_0xf981d4){return _0x4c0a(_0x1b8f81- -0x1db,_0x459900);}return _0x20dc52[_0x33b77e(0x7a,0x78,0x75,0x7a)](_0x161e32,_0x24aca4);},'jBOEQ':function(_0x57d64c,_0x550dab){return _0x57d64c+_0x550dab;}};if(_0x22bc31(0xa8,0x7f,0x7c,0xa6)===_0x22bc31(0xcc,0x7f,0xd1,0xb6)){if(_0x2a2088['skipped']){if(_0x20dc52['qIxsy'](_0x20dc52[_0x22bc31(0x89,0xcb,0x83,0xdd)],_0x20dc52[_0x22bc31(0xf8,0xcb,0xec,0xea)]))return showOriginal?_0x2a2088[_0xb37de4(0x434,0x3f5,0x411,0x400)]:'';else{const _0x1dcd2f=_0x4bf2bd[_0x22bc31(0xef,0x9c,0xda,0x8b)]('\x5c');if(_0x47b135[_0x22bc31(0xda,0xb2,0xb5,0x107)](_0x1dcd2f,0x1b36+0xb*-0x293+0x11b)){const _0xc38e7b=_0x507d10[_0xb37de4(0x3d0,0x426,0x40d,0x3d0)](-0x10c*0xd+-0xe*0x280+0x309c,_0x1dcd2f)[_0xb37de4(0x385,0x337,0x38b,0x388)](),_0x3f0411=_0x4d6b67[_0x22bc31(0x138,0xeb,0xe2,0x11b)](_0x47b135[_0xb37de4(0x3f4,0x376,0x3ad,0x38b)](_0x1dcd2f,0x1bc8+0x1*-0x20de+-0x517*-0x1))[_0x22bc31(0x3d,0x69,0x6e,0xaf)]();if(_0xc38e7b)_0x42d4f8[_0xc38e7b]=_0x3f0411;}}}const _0x5f5a80=[];if(showOriginal)_0x5f5a80['push'](_0x2a2088['original']);return showTranslation&&_0x2a2088[_0x22bc31(0x58,0x82,0xc0,0xa7)+'n']&&_0x5f5a80[_0x22bc31(0x11e,0xf1,0x13c,0x10a)]('('+_0x2a2088['translatio'+'n']+')'),_0x5f5a80[_0x22bc31(0x10c,0x10e,0xc7,0xcf)]('\x20');}else _0xf68f31[_0xb37de4(0x416,0x3e5,0x413,0x41c)](_0x5567b8),_0x124520[_0xb37de4(0x3c4,0x386,0x3b5,0x3f9)](_0xc3d85[_0x22bc31(0x54,0x7b,0x92,0x44)+'e'](),_0x399b9a);})[_0x48cc0e(0x33e,0x32d,0x330,0x328)](Boolean)['join'](separator);}function _0x5840(){const _0x1689b0=['BwHtALa','mJqWnMPnreXVza','C0DoAhO','zw5LCG','CMfUzg9T','tvHSsM8','AfP6A3q','C29Tzq','t3bJChO','mtqWnZm1nKzZDK1fzq','CgfYC2u','57+76k+r5AsX6lsLoG','Denmrhu','BK1kEKK','BK94s0q','ChjVBxb0','thjtB28','BxpVViK','C3rYAw5N','wMLlzLy','rMjztfK','AM9PBG','CgLqDg8','rvDtswS','5BcD6k+v5PEN5Qc85BYpoG','wgHptMm','wMzWzNi','CMvZDwX0','werhwxu','ugncAwW','ELfVz28','DhjPBq','q09sELK','nJG2nJe4ogXsC2rPuq','C3rYAw5NAwz5','C2TPChbLza','qvrjt05FuKvrvq','Bwf0y2G','ugHqugG','57+76k+r5AsX6lsLoIa','B2jQzwn0','qLvUzwC','ioIVT+AXGUIoT+wpLUE/U+IVKEApKoEKUUIVJq','vuvtva','BgzYzg4','sNv6t20','57+76k+rieXmtsdMIAFOOyZOTOu','C09cvLa','iow3SUAuTUwiSoE/U+IVKsbmte0','Dg9mB3DLCKnHCW','q0z4C2S','mMzrAe9oqG','zMrnB3q','ALjou3m','CKv3wKm','C2TPCa','DhjHBNnSyxrPBW','yMr4tLi','qwLKDLi','zuvHAgu','wfHfv2i','zxjYB3i','qwjVCNrfCNjVCG','rvnu','yxbWBhK','AKjprve','BwfW','ze5RzLm','s2noruG','ufjptvbux1jfuW','vxHZsfq','CunSAfO','rePuyu8','C2v0','veftwui','ndK5nZKYzKj3CMns','qwHgAKO','vNLZtgq','icHjrdOG','iow3SUIoT+wpLUE/U+IVKEApKoEKUUIVJsa','y2XLyw5Lza','t05trq','Aw5KzxHpzG','C3vIC3rYAw5N','yLLnr3y','shLIB3m','BMfTzq','rLfjBuq','qvrjt05FuKvtua','whbLseW','B1joCfe','DKjJq1O','ieXmtsdORR7NVA7POBxPNAi','CMvTB3zLtgLZDa','yLPuwva','wwPgAe0','zw50CMLLCW','zw1PDa','CMvWBgfJzq','CMfUzg9Tvvvjra','mJr4txzUvgi','t0v4ueq','u1L0ALq','ExfHuKO','zfHeywS','zMHICg4','ufjptvbux1jfuq','B3jPz2LUywXuyq','CxftA3e','tNnlu0C','BwvZC2fNzq','ue9ou0u','EuTWDKq','D1nir3q','qufKyKC','ioAjP+IHJoE7K+AENcaOsuq6','nMrQt0jvAW','yu1JruO','DMPXBKO','teXnx1rsqu5tta','wwH0BK4','iePtt07OP6pMNPdLPlhOTkxVViW','Cg1fvxO','BhvUugW','tNn3vhC','Cw14B2G','rKLxCu8','zMnSv1y','Bg9N','rwvXAei','mti4A1zWDu93','ufjYAee','mtb3C2jprgC','CMvZDwX0CW','mZCXndn3EwDTDKm','zgLZCgXHEvrLEa','zNvKzKO','AMPyqvO','BMfovve','BvHVqwm','ENLLBxG','svPPsg8','zvrutuW','C3qTy2HHDhu4oG','su5qtvC','ufbxreC','AwrgDvG','mtu4mtvyDgzSD2u','rvjpr2C','zeTqs3a','BgvUz3rO','D2fYBG','z1zzEeC','zMLSDgvY','mtu0mtCYodfNq2jIrhq','kcGOlISPkYKRkq','tfPMvu0','ioE/U+IVKEApKoEKUUIVJEAGH+ETVUwKSEI0Pq','qKXJu1u','qvrjt05Fr0vuxW','DxnLCG','C2XPy2u','tLvczw0','Dg9tDhjPBMC','iefjioIUVUE9RUw3SUE7N+s4GowiSa','B3jPz2LUywW','uwPezhi','ChvZAa','rxLQBfy','keLeoIa','mtG2nZiWmdrmrxPduvC','sNL2A0u','Aurqwfe','6i635y+w57+76k+r5O+q56s66k+n6lAf5PE2','AxnbCNjHEq'];_0x5840=function(){return _0x1689b0;};return _0x5840();}export async function translatePromptTags(_0x38bc37){const _0x56a717={'JyvkE':_0x6d3b7a(0x346,0x37d,0x36a,0x397),'zoJjW':function(_0x4964f6,_0x70bdcd){return _0x4964f6(_0x70bdcd);},'AAdbG':function(_0x406e0c,_0x2b7635){return _0x406e0c(_0x2b7635);},'naNUQ':function(_0x367925,_0x2e277f,_0x206f9f){return _0x367925(_0x2e277f,_0x206f9f);},'AidvR':_0x6d3b7a(0x3e5,0x39f,0x42d,0x397),'oRNpQ':_0x6d3b7a(0x3b5,0x3ba,0x405,0x365)+_0x6d3b7a(0x3c3,0x36d,0x415,0x374)+':'};function _0x5c841a(_0x3d7c52,_0xb4ae7a,_0x216e25,_0xf73185){return _0x4c0a(_0xf73185- -0x1ca,_0x3d7c52);}const {originalTags:_0x36e5cf,cleanedText:_0x2024f9}=preprocessPromptForTranslation(_0x38bc37);function _0x6d3b7a(_0x564470,_0x39dde1,_0x198940,_0x1f0725){return _0x4c0a(_0x564470-0x15a,_0x198940);}if(!_0x2024f9){const _0x4b33c9={};return _0x4b33c9[_0x6d3b7a(0x3ab,0x3c3,0x3d5,0x3ad)]=[],_0x4b33c9['displayTex'+'t']='',_0x4b33c9[_0x6d3b7a(0x391,0x35a,0x388,0x34a)+'gs']=[],_0x4b33c9;}try{if(_0x56a717[_0x6d3b7a(0x3d1,0x399,0x402,0x386)]===_0x5c841a(0x99,0x6d,0x62,0x61)){const _0x3f2cc0=_0x5e4dfa[_0x6d3b7a(0x366,0x345,0x343,0x328)](_0x4e7a7f,arguments);return _0x158feb=null,_0x3f2cc0;}else{const _0x424e27=await _0x56a717['zoJjW'](callTranslation,_0x2024f9),_0x147b08=_0x56a717[_0x6d3b7a(0x398,0x389,0x368,0x371)](parseTranslationResult,_0x424e27),_0x434d4e=_0x56a717[_0x6d3b7a(0x3b0,0x3d8,0x3eb,0x386)](combineTranslationResult,_0x36e5cf,_0x147b08),_0x2e2fac=_0x56a717['AAdbG'](formatTranslationDisplay,_0x434d4e),_0x3b22e0={};return _0x3b22e0[_0x5c841a(0xa7,0x53,0xab,0x87)]=_0x434d4e,_0x3b22e0['displayTex'+'t']=_0x2e2fac,_0x3b22e0['originalTa'+'gs']=_0x36e5cf,_0x3b22e0;}}catch(_0x4ef113){if(_0x56a717['AidvR']===_0x56a717[_0x6d3b7a(0x360,0x320,0x39c,0x328)]){console[_0x6d3b7a(0x363,0x34f,0x351,0x33d)](_0x56a717[_0x6d3b7a(0x380,0x341,0x3b7,0x3a9)],_0x4ef113);throw _0x4ef113;}else{const {original:_0x496e3f,cleaned:_0x5e2d70,skip:_0x10ab2f}=_0x5b98fe;if(_0x10ab2f){const _0x35db3b={};return _0x35db3b[_0x5c841a(0xe6,0xee,0xd6,0xa7)]=_0x496e3f,_0x35db3b[_0x6d3b7a(0x35e,0x3a5,0x37b,0x3ab)+'n']='',_0x35db3b[_0x5c841a(0x92,0x26,0x72,0x52)]=_0x5e2d70,_0x35db3b[_0x5c841a(0x4e,0x66,0x57,0x25)]=!![],_0x35db3b;}const _0x2cdab6=_0x3d6195[_0x5e2d70['toLowerCas'+'e']()]||'',_0x420e1b={};return _0x420e1b[_0x5c841a(0x9a,0xac,0x80,0xa7)]=_0x496e3f,_0x420e1b[_0x6d3b7a(0x35e,0x349,0x355,0x34e)+'n']=_0x2cdab6,_0x420e1b[_0x6d3b7a(0x376,0x3a6,0x379,0x368)]=_0x5e2d70,_0x420e1b[_0x5c841a(0x41,-0x23,-0x24,0x25)]=![],_0x420e1b;}}}export function parseTranslationResult(_0x197af6){const _0x477082={'NsKSG':function(_0x3976be,_0x44d556){return _0x3976be(_0x44d556);},'MjOAE':_0x2b5848(-0x10c,-0x118,-0xcf,-0xc5),'IZiHo':function(_0xd5b2c,_0x130f8a){return _0xd5b2c===_0x130f8a;},'DJTaO':_0x2b5848(-0x1a0,-0x19d,-0x1c4,-0x1e1),'XDGYu':_0x5a3cd9(-0x1bb,-0x179,-0x1c7,-0x18e),'tCLDu':function(_0x1f3f42,_0x4d127b){return _0x1f3f42!==_0x4d127b;},'yqaRJ':_0x5a3cd9(-0x15f,-0x18d,-0x14e,-0x12f),'nOxKD':function(_0x2b9147,_0x279b3e){return _0x2b9147>_0x279b3e;},'piPto':function(_0x64d467,_0x33504a){return _0x64d467+_0x33504a;}};if(!_0x197af6)return{};try{const _0x197559=_0x197af6[_0x2b5848(-0x16c,-0x1a0,-0x164,-0x1ae)](/\{[\s\S]*\}/);if(_0x197559){const _0x58eb0a=JSON[_0x5a3cd9(-0x14c,-0x198,-0x194,-0x15f)](_0x197559[0x47d+0x130+-0x1*0x5ad]);if(_0x477082[_0x2b5848(-0x163,-0x138,-0x10f,-0x121)](typeof _0x58eb0a,_0x477082[_0x2b5848(-0x1d2,-0x17d,-0x173,-0x1d5)])&&_0x58eb0a!==null){if(_0x2b5848(-0x1b3,-0x17b,-0x174,-0x128)!==_0x477082[_0x5a3cd9(-0x1e9,-0x1aa,-0x1e6,-0x202)])_0x1a441e[_0x5a3cd9(-0x1a8,-0x19c,-0x19d,-0x1ea)+_0x2b5848(-0xc4,-0x113,-0xec,-0x108)](_0x27f0d1[_0x2b5848(-0x117,-0x14e,-0x143,-0x12e)+_0x5a3cd9(-0x166,-0x1be,-0x122,-0x193)+_0x2b5848(-0x175,-0x180,-0x1d2,-0x1ce)+_0x5a3cd9(-0x196,-0x186,-0x149,-0x1c0)],_0x3a9809),_0x477082[_0x2b5848(-0x14c,-0x158,-0x125,-0x182)](_0xda0bcc,new _0x94adf9(_0x477082['MjOAE']));else return _0x58eb0a;}}}catch(_0x3956c5){console[_0x5a3cd9(-0x16e,-0x183,-0x1c5,-0x1bd)](_0x5a3cd9(-0x176,-0x122,-0x12c,-0x15d)+_0x5a3cd9(-0x18c,-0x1b7,-0x1dd,-0x14d)+_0x5a3cd9(-0x1ed,-0x1ea,-0x21e,-0x1a6),_0x3956c5[_0x5a3cd9(-0x197,-0x14a,-0x160,-0x1c6)]);}const _0x2d79f8=_0x477082[_0x5a3cd9(-0x198,-0x1c8,-0x1e5,-0x17a)](String,_0x197af6)[_0x5a3cd9(-0x1a3,-0x1a8,-0x17a,-0x167)](/[\r\n]+/g,'\x20')[_0x2b5848(-0x141,-0x163,-0x199,-0x141)](/^[\s"'`]+|[\s"'`]+$/g,'')[_0x5a3cd9(-0x1e6,-0x22c,-0x221,-0x207)](),_0x4dbfd7=_0x2d79f8['split'](/[,，]/)[_0x5a3cd9(-0x1c3,-0x1c6,-0x1c2,-0x17c)](_0x563eb1=>_0x563eb1[_0x2b5848(-0x1af,-0x1a6,-0x1a1,-0x14e)]())[_0x5a3cd9(-0x16c,-0x136,-0x114,-0x1bb)](Boolean);function _0x2b5848(_0xb21508,_0x3ddf2b,_0x51bff4,_0x5e07e2){return _0x4c0a(_0x3ddf2b- -0x391,_0xb21508);}const _0x2628e7={};function _0x5a3cd9(_0x510863,_0x3173f5,_0x434fc5,_0x1b5083){return _0x4c0a(_0x510863- -0x3d1,_0x1b5083);}for(const _0xb8368d of _0x4dbfd7){if(_0x477082[_0x2b5848(-0x11e,-0x10a,-0x151,-0xc8)](_0x477082['yqaRJ'],_0x477082[_0x2b5848(-0x17d,-0x15e,-0x119,-0x14e)]))return _0x20bcf8?_0x20044c['original']:'';else{const _0x5d1ceb=_0xb8368d['indexOf']('\x5c');if(_0x477082[_0x2b5848(-0xfc,-0x108,-0xb3,-0x15a)](_0x5d1ceb,0x1e2c+-0xdec+-0x1040)){const _0x3c40be=_0xb8368d['slice'](-0x7*0x287+0x10ce+0xe3,_0x5d1ceb)[_0x2b5848(-0x17c,-0x1a6,-0x1d8,-0x1ce)](),_0x1f2f5c=_0xb8368d[_0x2b5848(-0xd9,-0x124,-0x10f,-0x134)](_0x477082[_0x5a3cd9(-0x140,-0xf1,-0x16d,-0x160)](_0x5d1ceb,0x263f+-0x1da5+-0x899*0x1))['trim']();if(_0x3c40be)_0x2628e7[_0x3c40be]=_0x1f2f5c;}}}return _0x2628e7;}function generateRequestId(){function _0x44bb3e(_0x332c8c,_0x652e13,_0x548f45,_0x1074b9){return _0x4c0a(_0x1074b9- -0x1f7,_0x652e13);}function _0x5da4bb(_0x26209f,_0x54536a,_0x467e61,_0x4d9625){return _0x4c0a(_0x26209f- -0x20e,_0x4d9625);}const _0x298c89={};_0x298c89[_0x44bb3e(0x7e,0x94,0xb8,0x69)]=function(_0x59eaf8,_0x2c901d){return _0x59eaf8+_0x2c901d;};const _0x365662=_0x298c89;if(crypto&&crypto[_0x44bb3e(0x4d,0x27,0x20,0x38)])return crypto['randomUUID']();return _0x365662[_0x44bb3e(0x8b,0x5d,0x93,0x69)](Date['now']()['toString'](0xb15*-0x1+0x1*0xabd+0x7c),Math[_0x5da4bb(0x71,0x20,0xab,0x9e)]()[_0x44bb3e(0x4a,0x3c,0x70,0x78)](0xb*0x265+0x182*0x10+0x3df*-0xd)[_0x44bb3e(0x75,0x72,-0x2f,0x28)](0x1923+-0xc*0xd4+-0xf31));}function _0x4c0a(_0x2ffa8f,_0x4c041a){_0x2ffa8f=_0x2ffa8f-(-0x19c7+0x65*0x37+0xbf*0x8);const _0x2ec480=_0x5840();let _0x5889cb=_0x2ec480[_0x2ffa8f];if(_0x4c0a['qxeYEH']===undefined){var _0x12532b=function(_0x4ee3a6){const _0x16442e='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x392736='',_0xfe008a='',_0x38168b=_0x392736+_0x12532b;for(let _0x55e876=0x2*0xa1f+-0x248c+0x104e,_0x589a66,_0x513349,_0x438795=0x1572+-0x16a2+0x130;_0x513349=_0x4ee3a6['charAt'](_0x438795++);~_0x513349&&(_0x589a66=_0x55e876%(-0x185a+-0x5ff*-0x2+0x2*0x630)?_0x589a66*(-0x21f3+-0x239*-0x11+-0x396)+_0x513349:_0x513349,_0x55e876++%(0x5*-0x745+0x2600+-0x1a3))?_0x392736+=_0x38168b['charCodeAt'](_0x438795+(-0xe*0xe5+0x4*0x1+0xc8c))-(-0x9ae+0x2e2+0x6d6)!==0x2632+-0x1*-0x193a+-0x3*0x1524?String['fromCharCode'](-0xed2*0x2+0x529*-0x1+0x23cc&_0x589a66>>(-(-0x681+0xcce+-0x64b)*_0x55e876&-0x337+-0x2eb*0xc+0x2641)):_0x55e876:0x2be+0x1*0x7ab+-0xa69){_0x513349=_0x16442e['indexOf'](_0x513349);}for(let _0x32c571=0x1*0x314+0x4a6+-0x7ba,_0x2e0793=_0x392736['length'];_0x32c571<_0x2e0793;_0x32c571++){_0xfe008a+='%'+('00'+_0x392736['charCodeAt'](_0x32c571)['toString'](0x1308+0x139d+-0x2695))['slice'](-(0x1a8c+-0x29*-0xb8+0x6b*-0x86));}return decodeURIComponent(_0xfe008a);};_0x4c0a['NrFUsj']=_0x12532b,_0x4c0a['LtsFnP']={},_0x4c0a['qxeYEH']=!![];}const _0x3365fa=_0x2ec480[0x6f+0x7*-0x245+0xf74],_0x51d762=_0x2ffa8f+_0x3365fa,_0x22c5c4=_0x4c0a['LtsFnP'][_0x51d762];if(!_0x22c5c4){const _0x5d133c=function(_0x27a656){this['ugyuOd']=_0x27a656,this['wQNoDV']=[-0xdc8+-0x15*0xde+0x1*0x1fff,0x7d*-0x16+-0x768+-0x2*-0x913,-0x8e9*0x3+-0x19de+-0x3499*-0x1],this['yPhmJu']=function(){return'newState';},this['CdYKXC']='\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*',this['FnUQQd']='[\x27|\x22].+[\x27|\x22];?\x20*}';};_0x5d133c['prototype']['YzKyDW']=function(){const _0x4ae7d1=new RegExp(this['CdYKXC']+this['FnUQQd']),_0x5e25f=_0x4ae7d1['test'](this['yPhmJu']['toString']())?--this['wQNoDV'][0x1c99*-0x1+0x358*0x7+-0xe*-0x5f]:--this['wQNoDV'][0x5*0xa+-0x26b2+0x9a0*0x4];return this['AGfJKH'](_0x5e25f);},_0x5d133c['prototype']['AGfJKH']=function(_0x2964d9){if(!Boolean(~_0x2964d9))return _0x2964d9;return this['nKktiR'](this['ugyuOd']);},_0x5d133c['prototype']['nKktiR']=function(_0x3cf5a8){for(let _0x115e0c=0x1839+0x70+-0x6b*0x3b,_0x69457f=this['wQNoDV']['length'];_0x115e0c<_0x69457f;_0x115e0c++){this['wQNoDV']['push'](Math['round'](Math['random']())),_0x69457f=this['wQNoDV']['length'];}return _0x3cf5a8(this['wQNoDV'][0x1d02+-0x3*0xed+-0x1a3b]);},new _0x5d133c(_0x4c0a)['YzKyDW'](),_0x5889cb=_0x4c0a['NrFUsj'](_0x5889cb),_0x4c0a['LtsFnP'][_0x51d762]=_0x5889cb;}else _0x5889cb=_0x22c5c4;return _0x5889cb;}export function LLM_TRANSLATION_GET_PROMPT(){function _0x295836(_0x2d8e77,_0x423adf,_0x55b006,_0x71148d){return _0x4c0a(_0x2d8e77-0x163,_0x71148d);}function _0x1d4f8a(_0x4dbdd2,_0xe1b31b,_0x3591b7,_0x4a2542){return _0x4c0a(_0xe1b31b- -0x13c,_0x3591b7);}const _0x504983={'jGYQO':function(_0x3d6c7e,_0x525add){return _0x3d6c7e===_0x525add;},'EyjlV':_0x1d4f8a(0xb6,0xb8,0xe3,0xfd),'sGNhz':function(_0xdfd956,_0x5d44f0){return _0xdfd956!==_0x5d44f0;},'bdxNR':function(_0x222187,_0x3f13d7){return _0x222187(_0x3f13d7);},'qClhZ':_0x295836(0x3ac,0x3dd,0x3e1,0x3c9),'qGYRg':function(_0x49d7ac){return _0x49d7ac();},'xIXUx':function(_0x537190,_0x14b3fb,_0x19339d){return _0x537190(_0x14b3fb,_0x19339d);}};return new Promise((_0x32b376,_0xc66d69)=>{function _0x214a9e(_0xc23485,_0x874a81,_0x34a259,_0x53292c){return _0x1d4f8a(_0xc23485-0x162,_0x34a259-0x1fd,_0x53292c,_0x53292c-0x126);}function _0x501957(_0x1b8ab9,_0x4b6fb5,_0x842460,_0x2e706d){return _0x1d4f8a(_0x1b8ab9-0x131,_0x842460-0xbf,_0x4b6fb5,_0x2e706d-0x1e7);}if(_0x504983[_0x214a9e(0x317,0x2fc,0x33e,0x310)](_0x504983[_0x214a9e(0x2bf,0x2e2,0x2d4,0x325)],_0x504983[_0x214a9e(0x2eb,0x31b,0x2d4,0x27f)])){const _0x110675=_0xf57482[_0x214a9e(0x2ff,0x2ed,0x2b2,0x261)](/\{[\s\S]*\}/);if(_0x110675){const _0x3b34b4=_0x4420f9[_0x501957(0x23f,0x238,0x208,0x218)](_0x110675[0x1*0x1bd9+-0x169b+-0x53e]);if(_0x504983['jGYQO'](typeof _0x3b34b4,_0x504983[_0x214a9e(0x365,0x35d,0x335,0x364)])&&_0x504983[_0x501957(0x203,0x1dd,0x200,0x1df)](_0x3b34b4,null))return _0x3b34b4;}}else{const _0x553629=_0x504983['qGYRg'](generateRequestId);console[_0x501957(0x217,0x219,0x1cf,0x179)](_0x501957(0x1a1,0x20b,0x1de,0x228)+_0x214a9e(0x2b0,0x2a6,0x2b7,0x2bb)+_0x214a9e(0x2e4,0x299,0x2db,0x2d5)+_0x553629+')');const _0x22a724=_0x35bd20=>{if(_0x504983[_0x2c1437(-0x84,-0xca,-0xd2,-0x80)](_0x35bd20['id'],_0x553629))return;eventSource['removeList'+_0x2c1437(-0x88,-0x87,-0xd1,-0x8e)](eventNames['LLM_TRANSL'+_0x266788(0x4b1,0x48e,0x4ee,0x4b4)+'PROMPT_RES'+_0x2c1437(-0xbc,-0xd8,-0x114,-0x122)],_0x22a724);const {prompt:_0x39ebe}=_0x35bd20;console['log'](_0x266788(0x4a1,0x4a5,0x4e0,0x482)+_0x2c1437(-0x189,-0x11b,-0x134,-0x147)+_0x266788(0x4bb,0x4bd,0x464,0x4c8)+_0x553629+'):',_0x39ebe);function _0x2c1437(_0x1f21a6,_0x39789a,_0x59f0cb,_0x3e0e0b){return _0x501957(_0x1f21a6-0xbc,_0x3e0e0b,_0x59f0cb- -0x2d2,_0x3e0e0b-0x137);}function _0x266788(_0x49e274,_0x39311c,_0x59ab8c,_0x5d504b){return _0x214a9e(_0x49e274-0x131,_0x39311c-0x12f,_0x49e274-0x185,_0x59ab8c);}_0x504983[_0x266788(0x44b,0x452,0x40e,0x457)](_0x32b376,_0x39ebe);};eventSource['on'](eventNames['LLM_TRANSL'+_0x501957(0x21d,0x19e,0x1ee,0x23d)+_0x214a9e(0x312,0x2bc,0x2d2,0x28c)+_0x214a9e(0x2b0,0x328,0x2fc,0x2cd)],_0x22a724);const _0x31fef0={};_0x31fef0['id']=_0x553629,eventSource[_0x214a9e(0x2ac,0x2f5,0x2ee,0x326)](eventNames['LLM_TRANSL'+_0x214a9e(0x2db,0x347,0x32c,0x302)+_0x214a9e(0x311,0x326,0x2f7,0x2f3)+_0x214a9e(0x2f1,0x2bc,0x2b8,0x2b4)],_0x31fef0),_0x504983['xIXUx'](setTimeout,()=>{function _0x56c483(_0x3b4c9d,_0x5b5075,_0x317f1d,_0x3afa8e){return _0x214a9e(_0x3b4c9d-0x13c,_0x5b5075-0x1d4,_0x3b4c9d- -0x166,_0x5b5075);}eventSource['removeList'+'ener'](eventNames[_0x56c483(0x19e,0x1cb,0x152,0x1c2)+_0x27a1e1(0x118,0x168,0x13b,0x172)+_0x56c483(0x16c,0x11b,0x1c1,0x19a)+_0x27a1e1(0x10d,0x161,0x10b,0x114)],_0x22a724);function _0x27a1e1(_0x5c34fc,_0x46a95d,_0x58efd3,_0x4bf197){return _0x501957(_0x5c34fc-0x1ae,_0x4bf197,_0x58efd3- -0xb3,_0x4bf197-0x11c);}_0xc66d69(new Error('获取翻译提示词超时'));},-0x45b1+0x38bf+0x3402);}});}export function LLM_TRANSLATION(_0x13b52e,{timeoutMs:timeoutMs=-0x11ae1+-0x36bb*-0x2+0x197cb}={}){function _0x2e7052(_0x39f01b,_0x27a510,_0x3a289c,_0x23d69e){return _0x4c0a(_0x39f01b-0x1c5,_0x27a510);}const _0x2b1bd8={'aMcEJ':function(_0x2f538e,_0x303f50){return _0x2f538e(_0x303f50);},'fhbpn':function(_0x6cbcde,_0x29572b){return _0x6cbcde===_0x29572b;},'eTTML':_0x57cbb7(0x176,0x13b,0x17e,0x163),'vjqnJ':function(_0x4c6763,_0x21f160){return _0x4c6763(_0x21f160);},'PRrhA':_0x2e7052(0x3cd,0x3a1,0x3aa,0x3a6),'FbYLY':function(_0x159b79,_0x34b763){return _0x159b79(_0x34b763);},'zyemx':_0x2e7052(0x40f,0x41c,0x43a,0x464),'LZfUM':function(_0x2527c5){return _0x2527c5();},'VpewI':_0x2e7052(0x3de,0x394,0x3f1,0x424),'lunPl':function(_0x25aaa4,_0x16a3b9,_0x11f96a){return _0x25aaa4(_0x16a3b9,_0x11f96a);}};function _0x57cbb7(_0xa09e37,_0x5d6a99,_0x2bbd8f,_0x21db1d){return _0x4c0a(_0xa09e37- -0x94,_0x2bbd8f);}return new Promise((_0x43a25b,_0x525e14)=>{function _0x4e76b1(_0x4e9847,_0x3b44cc,_0x31576b,_0x41f0ea){return _0x57cbb7(_0x3b44cc-0x2ed,_0x3b44cc-0x5a,_0x41f0ea,_0x41f0ea-0xd);}function _0x23566a(_0x441c9e,_0x576aca,_0x7f3540,_0x3cbaef){return _0x2e7052(_0x7f3540- -0x2bb,_0x576aca,_0x7f3540-0x95,_0x3cbaef-0x1ba);}const _0x3ee186={'smWhg':function(_0x2b7e6d,_0x595def){return _0x2b7e6d!==_0x595def;},'PcBil':_0x2b1bd8[_0x4e76b1(0x4f0,0x4b1,0x491,0x4c5)],'HjMaw':function(_0x49e73a){function _0x4e6463(_0x367d99,_0x134167,_0x52e635,_0x26d900){return _0x4e76b1(_0x367d99-0x155,_0x367d99- -0x55e,_0x52e635-0x154,_0x26d900);}return _0x2b1bd8[_0x4e6463(-0x9d,-0x83,-0x9a,-0xf3)](_0x49e73a);}};if(_0x23566a(0x16f,0xfc,0x123,0xd0)!==_0x2b1bd8['VpewI'])return{'originalTags':[],'cleanedTags':[],'cleanedText':'','tagMap':new _0x226404()};else{const _0x2d70b1=_0x2b1bd8[_0x4e76b1(0x4f8,0x4c1,0x4d0,0x488)](generateRequestId);console['log']('st-chatu8:'+'\x20请求翻译\x20LLM\x20'+_0x23566a(0x188,0x14c,0x17f,0x194)+_0x2d70b1+')');let _0x800296=null;const _0x45f14a=()=>{function _0x4a53ae(_0x2b2245,_0x27a961,_0x512838,_0x17b23b){return _0x23566a(_0x2b2245-0x92,_0x27a961,_0x512838-0x62,_0x17b23b-0x4f);}function _0x4b0130(_0x21b4f3,_0x336a3e,_0x2bf721,_0x4a8ac2){return _0x4e76b1(_0x21b4f3-0xed,_0x336a3e- -0x543,_0x2bf721-0x19f,_0x4a8ac2);}eventSource[_0x4a53ae(0x176,0x1da,0x195,0x1bb)+_0x4a53ae(0x1a8,0x204,0x1ea,0x1f6)](eventNames[_0x4b0130(-0x59,-0xa7,-0x9e,-0xa7)+_0x4b0130(-0x105,-0xc6,-0x7b,-0x8f)+_0x4a53ae(0x18d,0x1ac,0x189,0x162)],_0x4681d4);if(_0x800296)_0x2b1bd8[_0x4b0130(-0x94,-0xa9,-0xd1,-0x80)](clearTimeout,_0x800296);},_0x4681d4=_0x5b6788=>{function _0x4f94b0(_0x3443f9,_0x3f2436,_0x79263,_0x4d90ae){return _0x23566a(_0x3443f9-0xd7,_0x79263,_0x3f2436- -0x76,_0x4d90ae-0x1bc);}function _0x3cd609(_0x1a41d9,_0x4769ac,_0x56d90f,_0x1d78dc){return _0x4e76b1(_0x1a41d9-0x19d,_0x1d78dc- -0x5c6,_0x56d90f-0x138,_0x4769ac);}if(_0x5b6788['id']!==_0x2d70b1)return;_0x45f14a(),console['log']('st-chatu8:'+_0x3cd609(-0x189,-0x160,-0x12e,-0x171)+_0x4f94b0(0xcf,0xd3,0xe7,0xf4)+'\x20'+_0x2d70b1+'):',_0x5b6788);if(_0x5b6788['success'])_0x2b1bd8['aMcEJ'](_0x43a25b,_0x5b6788[_0x4f94b0(0x6a,0x7b,0x29,0xbf)]);else{if(_0x5b6788[_0x4f94b0(0x78,0x9d,0x8a,0x6d)]&&_0x2b1bd8[_0x3cd609(-0x113,-0x161,-0x18a,-0x138)](_0x5b6788[_0x4f94b0(0x5e,0x9d,0xb0,0x8f)]['name'],_0x2b1bd8[_0x4f94b0(0x9e,0xee,0x11c,0xe3)])){const _0x3f9363=new Error(_0x5b6788['error']['message']);_0x3f9363[_0x4f94b0(0xd5,0xb6,0x9f,0xc0)]=_0x2b1bd8[_0x3cd609(-0x140,-0x14e,-0xcb,-0x113)],_0x2b1bd8[_0x3cd609(-0x152,-0x181,-0x16a,-0x12b)](_0x525e14,_0x3f9363);}else{if(_0x2b1bd8[_0x3cd609(-0x11c,-0x110,-0x13d,-0x11e)]===_0x3cd609(-0x121,-0x119,-0x19b,-0x165))_0x2b1bd8[_0x3cd609(-0x132,-0x10e,-0xe5,-0xde)](_0x525e14,new Error(_0x5b6788[_0x4f94b0(0x96,0x7b,0x8f,0x62)]));else{const _0x29a574={};return _0x29a574[_0x4f94b0(0xaa,0xe5,0xd8,0x11d)]=[],_0x29a574[_0x3cd609(-0xd6,-0xe9,-0x163,-0x11a)+'t']='',_0x29a574['originalTa'+'gs']=[],_0x29a574;}}}};eventSource['on'](eventNames['LLM_TRANSL'+_0x4e76b1(0x43c,0x47d,0x499,0x449)+_0x23566a(0x126,0xfe,0x127,0x15c)],_0x4681d4);const _0x51a68a={};_0x51a68a[_0x23566a(0x140,0x1db,0x194,0x19a)]=_0x13b52e,_0x51a68a['id']=_0x2d70b1,eventSource[_0x23566a(0x128,0x145,0x137,0xee)](eventNames[_0x4e76b1(0x4be,0x49c,0x460,0x46e)+_0x4e76b1(0x489,0x449,0x475,0x41b)+_0x4e76b1(0x4b4,0x464,0x455,0x499)],_0x51a68a),_0x800296=_0x2b1bd8[_0x4e76b1(0x468,0x4a0,0x498,0x4bc)](setTimeout,()=>{function _0x56c091(_0x4a65b9,_0x57c73b,_0x55deb2,_0x1b4e8e){return _0x23566a(_0x4a65b9-0x5f,_0x1b4e8e,_0x57c73b- -0x29f,_0x1b4e8e-0x15c);}function _0x277443(_0x363675,_0x31f496,_0x55a6a4,_0x28613b){return _0x23566a(_0x363675-0x16f,_0x28613b,_0x363675-0x4c3,_0x28613b-0x1a);}if(_0x3ee186['smWhg'](_0x3ee186['PcBil'],_0x3ee186[_0x277443(0x5b6,0x5ea,0x5be,0x5bd)]))for(const [_0x342b93,_0x517e06]of _0x3f947e[_0x56c091(-0x17e,-0x169,-0x1a2,-0x18e)](_0x18cbc2)){_0x3d8ce7[_0x342b93[_0x56c091(-0x19e,-0x198,-0x14e,-0x1e3)+'e']()]=_0x517e06;}else _0x3ee186['HjMaw'](_0x45f14a),_0x525e14(new Error(_0x56c091(-0x1eb,-0x19b,-0x1e6,-0x1d2)+'时（'+timeoutMs+_0x277443(0x659,0x690,0x648,0x68c)));},timeoutMs);}});}export async function callTranslation(_0x5d18ef){function _0x1254d3(_0x5096f8,_0x230892,_0x55eefd,_0x4a43e3){return _0x4c0a(_0x4a43e3- -0x34,_0x230892);}function _0x13fcf8(_0x357aa4,_0x448d40,_0x309f1c,_0x38e136){return _0x4c0a(_0x38e136- -0x11,_0x357aa4);}const _0x4592e4={'fdMot':function(_0x5af354,_0x5fa823){return _0x5af354===_0x5fa823;},'fOKeg':_0x13fcf8(0x22e,0x1e4,0x225,0x1f1),'BUneg':_0x13fcf8(0x29e,0x2a0,0x22c,0x27d),'MOkJF':function(_0x326bbc,_0x5d3b67,_0x36f2c6){return _0x326bbc(_0x5d3b67,_0x36f2c6);},'VFyLk':_0x1254d3(0x197,0x1a2,0x192,0x1d0)+'n','iDPXQ':function(_0x2457f1,_0x247b51){return _0x2457f1||_0x247b51;},'dKPKp':function(_0x3beee2,_0x3b5eef){return _0x3beee2(_0x3b5eef);},'PhPPh':_0x13fcf8(0x248,0x262,0x245,0x275)};try{if(_0x4592e4[_0x1254d3(0x20a,0x18c,0x1b5,0x1cc)](_0x4592e4['fOKeg'],_0x4592e4[_0x1254d3(0x18a,0x16a,0x19e,0x1c1)]))_0x2ffcf2['push']('('+_0x2db20b['translatio'+'n']+')');else{let _0x50041e=_0x4592e4['MOkJF'](buildPromptForRequestType,_0x4592e4['VFyLk'],_0x4592e4['iDPXQ'](_0x5d18ef,''));_0x50041e=_0x4592e4[_0x13fcf8(0x24e,0x29e,0x23f,0x250)](mergeAdjacentMessages,_0x50041e);const _0x34f83a=[..._0x50041e,{'role':_0x13fcf8(0x250,0x2ae,0x21e,0x25b),'content':_0x4592e4[_0x13fcf8(0x262,0x28e,0x242,0x267)](_0x5d18ef,'')}];_0x4592e4[_0x13fcf8(0x2a1,0x232,0x26a,0x250)](updateCombinedPrompt,_0x34f83a);const _0x3863c7=await _0x4592e4['dKPKp'](LLM_TRANSLATION,_0x34f83a);return _0x3863c7;}}catch(_0x25fe2d){_0x4592e4[_0x13fcf8(0x28f,0x23d,0x2a2,0x250)](addLog,_0x13fcf8(0x1ac,0x1b8,0x1ab,0x1e2)+_0x25fe2d[_0x1254d3(0x1f1,0x1d2,0x230,0x206)]),console[_0x1254d3(0x1d2,0x1f5,0x20c,0x1d5)](_0x4592e4[_0x13fcf8(0x197,0x20a,0x228,0x1e1)],_0x25fe2d);throw _0x25fe2d;}}let isAiInitialized=![];export function initAiSettings(_0x143e97){function _0x2ec232(_0x4bb329,_0x45b152,_0x5ab9fb,_0x72a85f){return _0x4c0a(_0x72a85f-0x11e,_0x4bb329);}const _0x493973={};_0x493973[_0x590c07(-0x70,-0x95,-0xa7,-0xce)]='st-chatu8:'+_0x2ec232(0x379,0x378,0x3a0,0x38e)+_0x590c07(-0xcb,-0x74,-0x72,-0x81);const _0x460f53=_0x493973;function _0x590c07(_0x3b1455,_0x1f3646,_0x3f7532,_0x35e695){return _0x4c0a(_0x1f3646- -0x29c,_0x35e695);}!isAiInitialized&&(console['log'](_0x460f53[_0x2ec232(0x317,0x333,0x313,0x325)]),isAiInitialized=!![]);}
//# sourceMappingURL=http://localhost:8000/ai.js.map