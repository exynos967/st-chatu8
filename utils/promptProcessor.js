function _0x5891(_0x16b89d,_0x5bd6f8){_0x16b89d=_0x16b89d-(-0x511*-0x5+-0x13ff*0x1+0x27*-0x1f);const _0x5c2736=_0x8668();let _0x5a60e3=_0x5c2736[_0x16b89d];if(_0x5891['SZprfx']===undefined){var _0x901a6f=function(_0x2593d0){const _0x24454a='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x73666d='',_0x4ac447='',_0x2a8fc4=_0x73666d+_0x901a6f;for(let _0x4b8b9d=-0x1038+0x1475*0x1+0x1*-0x43d,_0x33e82b,_0x306759,_0x46da3b=0x1*0x104+0x51f+-0x1*0x623;_0x306759=_0x2593d0['charAt'](_0x46da3b++);~_0x306759&&(_0x33e82b=_0x4b8b9d%(0x2381+0x8db*-0x1+-0x1*0x1aa2)?_0x33e82b*(0x18e1+-0x407*-0x9+-0x3ce0)+_0x306759:_0x306759,_0x4b8b9d++%(-0x1ce2*-0x1+0x2036+0x1e8a*-0x2))?_0x73666d+=_0x2a8fc4['charCodeAt'](_0x46da3b+(-0x1a2c+-0xb9a+-0x974*-0x4))-(-0xa1d+0x1077+-0x650)!==0x89b*-0x1+-0x2603+0x2e9e?String['fromCharCode'](-0x20e0+-0x33d*0x5+0xb2*0x48&_0x33e82b>>(-(0x1ade+0x14bb+-0x3*0xfdd)*_0x4b8b9d&-0x3*-0x89e+-0x5*0x662+-0x13*-0x52)):_0x4b8b9d:0xaf*0xa+-0x24da+-0x1c4*-0x11){_0x306759=_0x24454a['indexOf'](_0x306759);}for(let _0x5e47ee=-0x2217+-0x1790+0x39a7*0x1,_0x2df3e4=_0x73666d['length'];_0x5e47ee<_0x2df3e4;_0x5e47ee++){_0x4ac447+='%'+('00'+_0x73666d['charCodeAt'](_0x5e47ee)['toString'](-0xca9+0xb*-0x1ef+0x21fe))['slice'](-(0x1efe+-0xb65*0x1+-0x55*0x3b));}return decodeURIComponent(_0x4ac447);};_0x5891['gUITlP']=_0x901a6f,_0x5891['gkffaA']={},_0x5891['SZprfx']=!![];}const _0x5669f8=_0x5c2736[0x1ae3*0x1+0x2665+-0x4148],_0x5f541d=_0x16b89d+_0x5669f8,_0x142bd5=_0x5891['gkffaA'][_0x5f541d];if(!_0x142bd5){const _0x517a0a=function(_0x12205d){this['Icsbji']=_0x12205d,this['kDhiDM']=[-0x1b1a+-0x30f*-0xb+-0x68a,-0x7*0x1f1+-0x6*0x4b+0xf59,0x1*-0x435+0x1343+0x787*-0x2],this['gsdvoX']=function(){return'newState';},this['RZiuIo']='\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*',this['fjVvPW']='[\x27|\x22].+[\x27|\x22];?\x20*}';};_0x517a0a['prototype']['XnjTgu']=function(){const _0x4963a6=new RegExp(this['RZiuIo']+this['fjVvPW']),_0x1ec382=_0x4963a6['test'](this['gsdvoX']['toString']())?--this['kDhiDM'][-0x1*-0x1a73+0x1*-0x1d83+0x9d*0x5]:--this['kDhiDM'][0x2*0x87d+0x16f5+-0x1*0x27ef];return this['bGMFqT'](_0x1ec382);},_0x517a0a['prototype']['bGMFqT']=function(_0x1849b3){if(!Boolean(~_0x1849b3))return _0x1849b3;return this['pSVBBc'](this['Icsbji']);},_0x517a0a['prototype']['pSVBBc']=function(_0x24b509){for(let _0xbd8065=0x5d*-0x3d+-0x1541+-0x1*-0x2b6a,_0x203825=this['kDhiDM']['length'];_0xbd8065<_0x203825;_0xbd8065++){this['kDhiDM']['push'](Math['round'](Math['random']())),_0x203825=this['kDhiDM']['length'];}return _0x24b509(this['kDhiDM'][0x16f+-0x2570+-0x1*-0x2401]);},new _0x517a0a(_0x5891)['XnjTgu'](),_0x5a60e3=_0x5891['gUITlP'](_0x5a60e3),_0x5891['gkffaA'][_0x5f541d]=_0x5a60e3;}else _0x5a60e3=_0x142bd5;return _0x5a60e3;}(function(_0x4c27d6,_0x1e6762){const _0x3d0e98=_0x4c27d6();function _0x75b52c(_0x289b5e,_0x1abcb1,_0x5739e3,_0x181d31){return _0x5891(_0x289b5e-0x31e,_0x1abcb1);}function _0x9c3dae(_0x4bd754,_0x3fa78a,_0x23b856,_0x354746){return _0x5891(_0x23b856- -0x26f,_0x3fa78a);}while(!![]){try{const _0x1cc9e1=-parseInt(_0x9c3dae(-0x160,-0x1ae,-0x173,-0x152))/(-0x2cd+0x8*0x382+0x2*-0xca1)*(-parseInt(_0x75b52c(0x405,0x3ca,0x430,0x430))/(0x28d*0x7+-0x2a+-0x9*0x1f7))+-parseInt(_0x9c3dae(-0x162,-0x186,-0x191,-0x1ba))/(0x2*-0x720+-0xff5+0x1e38)+-parseInt(_0x9c3dae(-0x17b,-0x155,-0x1a2,-0x1e2))/(-0x16b*0x16+-0x1*0x1ee2+0x3e18)*(parseInt(_0x9c3dae(-0x193,-0x1e6,-0x1c1,-0x1b1))/(0x266a+-0xdf2+-0x1*0x1873))+-parseInt(_0x75b52c(0x3d3,0x3ea,0x397,0x38d))/(-0x24ad+0x3cb+0x20e8)+parseInt(_0x9c3dae(-0x183,-0x16f,-0x168,-0x135))/(-0x6b*-0x3d+-0x2b*0x47+-0x1*0xd8b)+-parseInt(_0x9c3dae(-0x194,-0x17a,-0x17b,-0x1bf))/(-0x2648+0x1c18+0xa38)*(-parseInt(_0x9c3dae(-0x1cd,-0x1bb,-0x186,-0x149))/(-0x263d+-0xc11+-0x107*-0x31))+-parseInt(_0x9c3dae(-0x202,-0x20b,-0x1cd,-0x21e))/(0x1fff+0x1670+-0x3665);if(_0x1cc9e1===_0x1e6762)break;else _0x3d0e98['push'](_0x3d0e98['shift']());}catch(_0x4ccb3e){_0x3d0e98['push'](_0x3d0e98['shift']());}}}(_0x8668,-0xa353+-0x7*-0x35c6+0x1d2a4));const _0x33d40c=(function(){const _0xb2de75={'mHXEd':function(_0x2e55a8,_0x22d51c,_0x42fa47,_0x3b01c1,_0x32d34b){return _0x2e55a8(_0x22d51c,_0x42fa47,_0x3b01c1,_0x32d34b);},'RGopj':_0xc1c9ad(0x71,0x21,0x60,0x62),'lwoWQ':function(_0x231d93,_0x10cae8){return _0x231d93!==_0x10cae8;},'CPyBc':_0x87c73(0x183,0x19f,0x162,0x151),'zOMJo':_0xc1c9ad(0x13,0x51,0x60,0x63)};function _0x87c73(_0x297763,_0x59b013,_0x55a8b9,_0x32b30b){return _0x5891(_0x59b013-0xeb,_0x297763);}function _0xc1c9ad(_0x487fd8,_0xc43a94,_0x485bb9,_0xbe6c59){return _0x5891(_0xbe6c59- -0x6f,_0xc43a94);}let _0xc6d0a4=!![];return function(_0x4a6a92,_0xd81883){const _0x232234={'dBVow':function(_0x588110,_0x2f4c7e,_0x5e2325,_0x31ede6,_0x33cde4){function _0x4b3667(_0x1f0fb9,_0x1ae7b4,_0x34bc4d,_0xd700fa){return _0x5891(_0x1ae7b4-0x29d,_0x34bc4d);}return _0xb2de75[_0x4b3667(0x3e5,0x39f,0x383,0x3e3)](_0x588110,_0x2f4c7e,_0x5e2325,_0x31ede6,_0x33cde4);},'pOjTC':function(_0xe33ae0,_0x4fff07){return _0xe33ae0!==_0x4fff07;},'kUpwf':_0xb2de75['RGopj']};function _0x2b2891(_0x4c6bac,_0x7afce4,_0x13f8ff,_0x24c23f){return _0x87c73(_0x4c6bac,_0x13f8ff- -0x1e0,_0x13f8ff-0x96,_0x24c23f-0x1a7);}function _0x453ac1(_0x26d823,_0x4eb978,_0x28e31,_0x59cee6){return _0xc1c9ad(_0x26d823-0x195,_0x28e31,_0x28e31-0x8c,_0x4eb978- -0x2a1);}if(_0xb2de75['lwoWQ'](_0xb2de75[_0x453ac1(-0x269,-0x270,-0x2a2,-0x2a1)],_0xb2de75[_0x2b2891(-0x3c,-0x64,-0x13,-0x43)])){const _0x11438a=_0xc6d0a4?function(){const _0x4e1293={'CRBEU':function(_0x23768f,_0x49aa1b,_0x180c97,_0x4af2a6,_0x3c07cc){function _0x34ef4d(_0x8885ff,_0x23e9e7,_0x5394ba,_0x1163a5){return _0x5891(_0x1163a5-0x17c,_0x8885ff);}return _0x232234[_0x34ef4d(0x228,0x295,0x2c2,0x273)](_0x23768f,_0x49aa1b,_0x180c97,_0x4af2a6,_0x3c07cc);}};function _0x56f292(_0x562e81,_0x43660e,_0xd8a88,_0x1f5699){return _0x453ac1(_0x562e81-0x176,_0x1f5699-0x610,_0xd8a88,_0x1f5699-0x58);}function _0x5156f6(_0x5bf780,_0x43b141,_0x131904,_0x2e756f){return _0x453ac1(_0x5bf780-0x12d,_0x5bf780-0x3af,_0x43b141,_0x2e756f-0xb5);}if(_0x232234['pOjTC'](_0x5156f6(0x170,0x124,0x155,0x19d),_0x232234[_0x56f292(0x3e0,0x3ea,0x40f,0x42e)])){const _0x3f651c={};for(const _0x4cee4f in _0x1f9d90){_0x3f651c[_0x4cee4f]=_0x4e1293[_0x5156f6(0x143,0x17a,0x102,0xf7)](_0x12ef42,_0x464e95[_0x4cee4f],_0x4940f9,_0x53860b,_0x5a4d7a);}return _0x3f651c;}else{if(_0xd81883){const _0x1abbfe=_0xd81883['apply'](_0x4a6a92,arguments);return _0xd81883=null,_0x1abbfe;}}}:function(){};return _0xc6d0a4=![],_0x11438a;}else _0x59ba26['chatMetada'+'ta']={};};}()),_0xdc64e2=_0x33d40c(this,function(){const _0x211fc5={};function _0x160b59(_0x58d487,_0x1d9d4f,_0x540693,_0x404111){return _0x5891(_0x404111-0x39f,_0x58d487);}_0x211fc5[_0x160b59(0x475,0x492,0x48c,0x4b2)]=_0x160b59(0x436,0x451,0x44c,0x44c)+'+$';const _0x11b751=_0x211fc5;function _0x2c87bd(_0x940457,_0x3efa27,_0x1352c0,_0x475b53){return _0x5891(_0x475b53- -0xd7,_0x3efa27);}return _0xdc64e2[_0x160b59(0x42c,0x4a4,0x431,0x455)]()[_0x160b59(0x46e,0x475,0x45a,0x474)](_0x11b751[_0x2c87bd(0x63,0x76,0x61,0x3c)])['toString']()[_0x2c87bd(0x31,0x4c,0x64,0x62)+'r'](_0xdc64e2)[_0x2c87bd(0x2b,0x7,0x21,-0x2)](_0x160b59(0x494,0x46b,0x499,0x44c)+'+$');});_0xdc64e2();import{extension_settings}from'../../../../extensions.js';import{extensionName}from'./config.js';import{getContext}from'../../../../st-context.js';import{getglobalvar,setglobalvar}from'./chatDataUtils.js';import{getworldvar}from'./worldbookProcessor.js';export function checkTriggerWords(_0x358c8d,_0x332b9a){const _0x564a30={};_0x564a30[_0x5913e2(0x295,0x29c,0x2b0,0x2dd)]='tjiAq',_0x564a30[_0x1e8ec2(0x230,0x23d,0x289,0x24f)]=_0x1e8ec2(0x2fc,0x301,0x2de,0x2c3);const _0x598c90=_0x564a30;function _0x5913e2(_0x5b0753,_0x4a63cb,_0xe22d8b,_0x3d3421){return _0x5891(_0x3d3421-0x236,_0x4a63cb);}if(!_0x358c8d||!_0x332b9a){if(_0x598c90[_0x1e8ec2(0x246,0x260,0x275,0x24c)]!==_0x598c90[_0x1e8ec2(0x238,0x206,0x1fa,0x24c)])_0x15b94b['add'](_0x540bcb[0xbce+0x182*0x1+-0xd4f*0x1]);else return![];}const _0x313488=_0x358c8d[_0x5913e2(0x314,0x2ee,0x2d0,0x310)](',')[_0x1e8ec2(0x28d,0x25b,0x216,0x24e)](_0x163200=>_0x163200[_0x5913e2(0x318,0x318,0x33a,0x340)]())[_0x5913e2(0x38d,0x393,0x309,0x34c)](_0x5e266e=>_0x5e266e);if(_0x313488[_0x1e8ec2(0x26a,0x2c6,0x263,0x2aa)]===0x4a*-0x39+-0x1*0x1eb+0x115*0x11){if(_0x598c90[_0x1e8ec2(0x26a,0x287,0x214,0x24f)]!==_0x5913e2(0x384,0x315,0x39f,0x354)){const _0x6e8b22=/\{\{getvar::([^}]+)\}\}/g,_0x1aeff0=_0x56546f[_0x1e8ec2(0x2ae,0x29e,0x294,0x263)](_0x3b96d7),_0x932055=[..._0x1aeff0[_0x1e8ec2(0x284,0x2cb,0x2f8,0x2d2)](_0x6e8b22)],_0x10088a=new _0x26d2fd();for(const _0x22a25f of _0x932055){_0x10088a[_0x5913e2(0x318,0x39b,0x364,0x352)](_0x22a25f[-0x27d+-0xb24*0x3+-0x23ea*-0x1]);}for(const _0x2099ad of _0x10088a){const _0x283f78=_0x5913e2(0x331,0x34b,0x363,0x347)+_0x2099ad+'}}',_0x57a4e9=_0x4b15be[_0x2099ad]||'';_0x495788=_0x1d8d1f(_0x53433c,_0x283f78,_0x57a4e9,_0x179dea);}}else return![];}for(const _0x4b4b2c of _0x313488){if(_0x332b9a[_0x5913e2(0x2b4,0x32b,0x2d9,0x2ef)](_0x4b4b2c))return!![];}function _0x1e8ec2(_0x4ee463,_0x1f21c5,_0x508a31,_0x4af518){return _0x5891(_0x4af518-0x1a5,_0x4ee463);}return![];}export function mergeAdjacentMessages(_0x3dbc32){const _0x31fbb8={'RrMZM':function(_0x5edc66,_0x3b4d1b){return _0x5edc66!==_0x3b4d1b;},'oWIPm':_0xfb66ee(-0xf1,-0x69,-0x62,-0xb6),'Kqnea':function(_0x3d01ce,_0x389d15){return _0x3d01ce!==_0x389d15;},'FuhUa':'tAtAj','YiDYP':function(_0x5a6439,_0x2ebedb,_0x176597){return _0x5a6439(_0x2ebedb,_0x176597);}};if(!_0x3dbc32||_0x3dbc32[_0xfb66ee(-0x8c,-0x23,-0x4f,-0x6d)]===-0x14fe+-0x767*0x3+0x2b33*0x1){if(_0x31fbb8[_0x34e6f7(-0x29a,-0x2c1,-0x29a,-0x2b0)](_0x31fbb8[_0xfb66ee(-0xac,-0x7b,-0x31,-0x71)],_0x31fbb8['oWIPm'])){_0x58c0df['push'](_0x21b22c);const _0x1ee882={..._0xb2afe6};_0x47f4f0=_0x1ee882;}else return[];}function _0xfb66ee(_0x6f7b4e,_0x4ddbbe,_0x5258d5,_0x216cc2){return _0x5891(_0x216cc2- -0x172,_0x6f7b4e);}function _0x34e6f7(_0x46868d,_0x29e651,_0x4ee8b0,_0x366ad0){return _0x5891(_0x366ad0- -0x3e3,_0x4ee8b0);}const _0x316349=[];let _0x1dd72c=null;for(const _0x14a475 of _0x3dbc32){if(_0x31fbb8[_0x34e6f7(-0x369,-0x31f,-0x30d,-0x338)](_0x34e6f7(-0x2f5,-0x31d,-0x328,-0x337),_0x31fbb8['FuhUa'])){if(!_0x1dd72c){const _0x29e3b5={..._0x14a475};_0x1dd72c=_0x29e3b5;}else{if(_0x1dd72c[_0xfb66ee(-0x78,-0xa2,-0x8d,-0xaa)]===_0x14a475[_0x34e6f7(-0x2f9,-0x327,-0x34b,-0x31b)])_0x1dd72c[_0x34e6f7(-0x2f5,-0x322,-0x2c2,-0x2e0)]=_0x31fbb8[_0x34e6f7(-0x2f8,-0x2f0,-0x334,-0x31c)](mergeContent,_0x1dd72c[_0xfb66ee(-0x74,-0x1f,-0x89,-0x6f)],_0x14a475['content']);else{_0x316349[_0x34e6f7(-0x2eb,-0x35f,-0x310,-0x33e)](_0x1dd72c);const _0x156a44={..._0x14a475};_0x1dd72c=_0x156a44;}}}else{const _0x4e908d=_0x43c847[_0xfb66ee(-0x65,-0x57,-0x8f,-0x78)](_0x189a62,arguments);return _0x177fdc=null,_0x4e908d;}}return _0x1dd72c&&_0x316349[_0xfb66ee(-0xe8,-0xee,-0x104,-0xcd)](_0x1dd72c),_0x316349;}function mergeContent(_0x251080,_0x59d19b){function _0x2e87d6(_0x2438b6,_0x4df612,_0x33ab7b,_0x4731cf){return _0x5891(_0x33ab7b-0x1e2,_0x4df612);}const _0x256aa6={'yxUMi':function(_0x116a4f,_0x26b107,_0x4cd5ab){return _0x116a4f(_0x26b107,_0x4cd5ab);},'hmEZI':_0x2e87d6(0x286,0x2cb,0x285,0x2d4),'SDMAA':function(_0x5037d7,_0x1b2342){return _0x5037d7===_0x1b2342;},'Onqdi':function(_0x2752d8,_0xdcc6ab){return _0x2752d8!==_0xdcc6ab;},'Fnxch':_0x19307e(-0x3a,0x18,0x8,0x57),'ReEFf':_0x19307e(0x3f,0x6d,0x92,0x7b),'DDyNr':function(_0x7b1819,_0xe71061){return _0x7b1819+_0xe71061;},'qxWNS':function(_0x59f76f,_0x472734){return _0x59f76f(_0x472734);},'fiNqf':'text'};if(typeof _0x251080===_0x256aa6[_0x2e87d6(0x2d5,0x270,0x29f,0x2ac)]&&_0x256aa6[_0x2e87d6(0x34f,0x32b,0x31a,0x304)](typeof _0x59d19b,_0x256aa6[_0x2e87d6(0x2cd,0x25a,0x29f,0x2e7)])){if(_0x256aa6[_0x19307e(0x45,0x93,0x58,0x9b)](_0x256aa6[_0x2e87d6(0x27a,0x28d,0x2ab,0x281)],_0x256aa6['ReEFf']))return _0x256aa6[_0x19307e(0xb3,0x77,0xb9,0x2c)](_0x251080,'\x0a')+_0x59d19b;else{const _0x5e3737=_0xb7e7cc['trim']();return _0x256aa6[_0x2e87d6(0x337,0x2b1,0x2f7,0x2fa)](_0x18fd2a,_0x5e3737,_0x3e68a5),_0x1a1508&&_0x5b6eb0[_0x2e87d6(0x2af,0x320,0x2fe,0x2bb)](_0x2e87d6(0x323,0x326,0x2d8,0x2fe)+_0x2e87d6(0x2c9,0x2a2,0x2c6,0x2f6)+_0x5e3737+'@}'),'';}}const _0x2e8aea=normalizeToArray(_0x251080),_0x319802=_0x256aa6['qxWNS'](normalizeToArray,_0x59d19b);function _0x19307e(_0x21f1e7,_0x199839,_0x4f9179,_0xed004){return _0x5891(_0x199839- -0xab,_0x21f1e7);}const _0x47ad31={};return _0x47ad31[_0x19307e(0x81,0x92,0x9c,0x81)]=_0x256aa6[_0x19307e(0x24,0x63,0x71,0x57)],_0x47ad31[_0x2e87d6(0x2d8,0x2f2,0x2f9,0x312)]='\x0a',[..._0x2e8aea,_0x47ad31,..._0x319802];}function normalizeToArray(_0x561f8a){const _0x4fd228={};_0x4fd228[_0x59af96(-0x11f,-0x101,-0xe8,-0xf2)]=_0x59af96(-0x117,-0x14c,-0x118,-0x154),_0x4fd228['JphWB']=function(_0x2ceb50,_0x2413d4){return _0x2ceb50||_0x2413d4;};const _0xcc0434=_0x4fd228;function _0x17e683(_0x3f3842,_0x546bca,_0x5eabc6,_0x457efa){return _0x5891(_0x5eabc6-0x118,_0x457efa);}if(Array['isArray'](_0x561f8a))return _0x561f8a;function _0x59af96(_0x3ef718,_0x144ab8,_0x23e43e,_0x3bdefe){return _0x5891(_0x3ef718- -0x22e,_0x23e43e);}return[{'type':_0xcc0434['MeDkX'],'text':_0xcc0434[_0x17e683(0x237,0x217,0x1eb,0x1c6)](_0x561f8a,'')}];}function _0x8668(){const _0x166c2b=['muvosNrgAW','zhjpDxK','zw5HyMXLza','q2PwD20','BeL6thu','B1Djug0','BuHyrwq','y29UDgvUDa','D3r5D3O','BgvUz3rO','rfHhywS','mJi4nJi5mwPVsKT3uq','r0neCLu','Bg5cAva','DhjPBq','EgTzCKW','t0Hcsw0','CMvXDwvZDfr5Ca','zMLoCwy','twveA1G','y1LUufe','E3TNzxr2yxi6oG','tNPWsK8','rLfbEKG','AM9PBG','ExHvtwK','zMLSDgvY','Dgv4Da','yvzKrwe','AMLZuuS','zw9hsM8','s3Liyuq','ywrK','AKfvDxy','reXwtvK','CgHywha','zuvUwNu','vK5ez0S','rer5tNi','t29erha','AgXXs2G','B2jQzwn0','zMLNCW','DMfYAwfIBgvZ','yKDWyNC','DgvZDf9JB250zq','E3VMRApMLOD9Fq','yKv6uLK','E3VOP5lOIBlLKk/NLkJLIjFOOAH9Fq','Bwf0y2HbBgW','A1vWD2y','t050EfO','yMzlAfq','EhrFChjVzMLSzq','DhjPz2DLCLDVCG','uNjnwK0','ugf5wgu','BLHyrfO','y0vxuwi','A1Pkvgm','u0rnque','y29UC3rYDwn0BW','B1niBxy','yK1OzLO','y29UDgv4DerHDa','DhLWzq','t25XzgK','zNL5zeu','D0nNr2y','uMTMz2O','CMLHyMXLCW','AgLZDg9YEq','zw50CMLLCW','zxD2zg0','zenIzNO','wvLYwKi','q1b5qMm','uufbBLy','oti5mduWvM9Itfbx','C3rYAw5N','q1jcrvu','ChvZAa','E3T1C2vYFx0','ENPHswq','sxnRuvO','BwfW','ENjgs3m','s3fUzwe','EuPQCxO','kcGOlISPkYKRkq','nJaWtwjHAMnl','q3PQtvK','E3VKUiRKUiVMLOD9Fq','AxzkreO','B2zPBgu','u294uNK','zvrfA3G','nJq2oti2BhLcqLP3','Dg9tDhjPBMC','yKPYEMK','A0nZt1C','Aw5JBhvKzxm','vNLPCve','BhvSD3C','q3z6wvO','Ag1fwKK','C3rYAw5NAwz5','DhjPz2DLCG','DhjPz2DLCK1Vza','s0rcDgu','DwLgugy','DxbqD28','z1bzz1m','A2v5CW','y29UDgv4Df9WCG','wwLewva','CM9Szq','rM54y2G','CMvWBgfJzufSBa','AxnbCNjHEq','yxnZAxn0yw50','otmXnNnOAxHMCW','s3LtAhK','E3VPGjRNLkJOP5lOIBlLKk/NLkJLIjFOOAG','AwDKD2S','zuj4tu0','servCMC','sNbOv0i','phvZzxi+','C2vHCMnO','qMvtr2y','u3LQz2S','BgXTx3jLCxvLCW','CMvWBgfJzq','C3bSAxq','BwvZC2fNzxm','DwD2qxO','Bfn3Cxq','mtGXmtC5EuH0suvy','uNjrBLq','BgH6B0O','BMfTzte','EK9nsM8','rKDLEMG','BhzHCJO6','qwnqwK0','DxnLCG','ndmZmZq2yKvezMXm','C29etxG','mZG1ndC5rwPcq1L6','BMTHthG','r0zbq0i','y2HHDe1LDgfKyq','A0XLBhy','E0bZzxr2yxi6oG','B3DLsLq','A2XvzNm','tvPMzu0','CLHeweG','CMvWBgfJzwrwyq','mZjeEhnSr3C','sKX3rhu','E0bZzxrNBg9Iyq','zejwB3C','zNrfwNu','E0bNzxr2yxi6oG','yxbWBhK','E3VKUjBNLyZKUABOP6BLJ5f9Fq'];_0x8668=function(){return _0x166c2b;};return _0x8668();}export function replacePlaceholder(_0x121058,_0x3b50b7,_0x3c72c6,_0x4d981c){function _0x4f5634(_0x4c37ae,_0x278c42,_0x5f07a3,_0x5bfbd0){return _0x5891(_0x4c37ae-0x2ab,_0x5f07a3);}const _0x4de6fd={'KyShy':'{{user}}','KDBte':function(_0x58ae26,_0xcc2b00){return _0x58ae26===_0xcc2b00;},'bfKhT':'dNSlT','ugvAz':function(_0x3505eb,_0x4ff9f7){return _0x3505eb||_0x4ff9f7;},'JLwDu':_0x1a2135(-0xb2,-0x77,-0x105,-0xf0),'uiFPf':function(_0x109b35,_0x4cc03){return _0x109b35===_0x4cc03;},'KyHaD':_0x4f5634(0x3ce,0x3e4,0x37d,0x3c3),'AQaGL':function(_0x47453c,_0x2db51d){return _0x47453c!==_0x2db51d;},'QAAnV':'nXXDZ','jisQK':function(_0x39a984,_0x19cc01,_0x5136d1,_0x5906f4,_0x3bc8c6){return _0x39a984(_0x19cc01,_0x5136d1,_0x5906f4,_0x3bc8c6);}};if(_0x4de6fd[_0x4f5634(0x36c,0x3a9,0x344,0x386)](typeof _0x121058,_0x4f5634(0x34e,0x35c,0x339,0x32f)))return _0x3c72c6&&_0x121058[_0x1a2135(-0x11e,-0x14c,-0x12c,-0xca)](_0x3b50b7)&&(_0x4d981c&&(_0x4de6fd[_0x1a2135(-0xa7,-0xa0,-0x56,-0x66)]===_0x4de6fd[_0x4f5634(0x3db,0x3fe,0x3a1,0x3a7)]?_0x4d981c[_0x1a2135(-0xbb,-0xad,-0xd5,-0x91)](_0x3b50b7):(_0xa8887=_0x5e21a7[_0x4f5634(0x375,0x3ba,0x326,0x330)](_0x4de6fd[_0x1a2135(-0x109,-0xfb,-0x120,-0xca)],_0x11b892),_0x5ca657=_0x249f6d[_0x4f5634(0x375,0x3bb,0x360,0x340)](_0x1a2135(-0x103,-0x106,-0x113,-0x143),_0x5d84ba)))),_0x121058[_0x4f5634(0x375,0x37b,0x3c6,0x33f)](_0x3b50b7,_0x4de6fd[_0x4f5634(0x387,0x362,0x3ac,0x3ce)](_0x3c72c6,''));if(Array['isArray'](_0x121058))return _0x121058[_0x4f5634(0x354,0x30b,0x305,0x30d)](_0x5e607c=>replacePlaceholder(_0x5e607c,_0x3b50b7,_0x3c72c6,_0x4d981c));if(_0x121058&&typeof _0x121058===_0x4de6fd[_0x4f5634(0x3a0,0x373,0x3e4,0x38f)]){if(_0x4de6fd[_0x1a2135(-0x115,-0x14d,-0x15e,-0x110)](_0x4f5634(0x3ab,0x39f,0x389,0x385),_0x4de6fd[_0x1a2135(-0xbc,-0xd4,-0xbd,-0xd2)])){if(_0x623d53){const _0x52d1da=_0xfbe73c[_0x4f5634(0x3a5,0x393,0x3aa,0x38d)](_0x21871e,arguments);return _0x15c85d=null,_0x52d1da;}}else{const _0x183fde={};for(const _0x5f5371 in _0x121058){if(_0x4de6fd['AQaGL'](_0x1a2135(-0xa2,-0x6b,-0x4f,-0xc6),_0x4de6fd[_0x1a2135(-0x136,-0x152,-0x160,-0xfb)]))return _0x36519e[_0x4f5634(0x354,0x345,0x326,0x345)](_0x48ea77=>_0x873749(_0x48ea77,_0x1bd5ef,_0xc7461b,_0x376c5e));else _0x183fde[_0x5f5371]=_0x4de6fd[_0x4f5634(0x3c4,0x38a,0x3b1,0x3a7)](replacePlaceholder,_0x121058[_0x5f5371],_0x3b50b7,_0x3c72c6,_0x4d981c);}return _0x183fde;}}function _0x1a2135(_0x49579c,_0x6e0c19,_0x3a977b,_0x106fb8){return _0x5891(_0x49579c- -0x1d7,_0x6e0c19);}return _0x121058;}export function replaceAllPlaceholders(_0x3b19f4,_0x9a4f21){const _0x35d6bb={'gPYgS':function(_0x3b8421,_0x5346f6){return _0x3b8421!==_0x5346f6;},'KXWMG':_0x51c424(0x368,0x3e3,0x395,0x362),'fXrBQ':function(_0x32c0f8){return _0x32c0f8();},'VNDgK':function(_0x5d91d0,_0x56c3df){return _0x5d91d0===_0x56c3df;},'rXDXH':'APxCh','IskQZ':_0x51c424(0x39b,0x39e,0x36f,0x368),'lXpGv':_0x51c424(0x3ac,0x3eb,0x39d,0x3b1),'ONtxZ':_0x51c424(0x36c,0x3b0,0x379,0x348),'DXGak':function(_0x251d79,_0x305f39,_0x5a4b1f,_0x21da34,_0xbf528){return _0x251d79(_0x305f39,_0x5a4b1f,_0x21da34,_0xbf528);},'lhzoJ':_0xf738c1(0x295,0x2cc,0x295,0x2fc),'PayXe':function(_0x37b2e3,_0x51abc0,_0x10f54b,_0x1836d4,_0x3f340a){return _0x37b2e3(_0x51abc0,_0x10f54b,_0x1836d4,_0x3f340a);},'FDGGm':_0x51c424(0x3ee,0x3ee,0x3f5,0x429),'fyydE':'{{通用服装启用列表'+'}}','wCgGf':function(_0xc2ab72,_0x1ce8b6,_0x48e600,_0x26e324,_0x229c01){return _0xc2ab72(_0x1ce8b6,_0x48e600,_0x26e324,_0x229c01);},'bGpbw':_0xf738c1(0x260,0x271,0x2b4,0x225)+'}}','MZfeM':'{{用户需求}}','CjVwm':function(_0x36144d,_0x523d89){return _0x36144d>_0x523d89;},'lSwqt':'HudPZ','YYrZB':function(_0x25df8d,_0x5be411){return _0x25df8d===_0x5be411;},'RJdgd':'UesiY','oiWAF':function(_0x390b63,_0x22625c,_0x38b932,_0x46e874,_0x3324e5){return _0x390b63(_0x22625c,_0x38b932,_0x46e874,_0x3324e5);},'qWZAk':function(_0x397395,_0x1c0b4f,_0x4b9c64){return _0x397395(_0x1c0b4f,_0x4b9c64);}},{context:context='',body:body='',worldBookContent:worldBookContent='',variables:variables={},userDemand:userDemand='',characterListText:characterListText='',outfitEnableListText:outfitEnableListText='',commonCharacterListText:commonCharacterListText=''}=_0x9a4f21,_0x305704=new Set();let _0x1413ee=_0x3b19f4;const _0x105c28=_0x35d6bb['fXrBQ'](getContext),_0x4c2e6b=_0x105c28?.[_0xf738c1(0x263,0x283,0x23c,0x287)]||'';let _0x36f907=worldBookContent;function _0xf738c1(_0x3fd504,_0x561bb9,_0x3774b3,_0x435523){return _0x5891(_0x561bb9-0x1a2,_0x435523);}_0x36f907&&(_0x35d6bb[_0xf738c1(0x2b0,0x2c3,0x2bd,0x2dd)](_0x35d6bb[_0x51c424(0x383,0x3a0,0x3bb,0x3cb)],_0x35d6bb[_0x51c424(0x3d9,0x36e,0x3bb,0x36d)])?(_0x36f907=_0x36f907[_0xf738c1(0x24e,0x26c,0x273,0x250)](_0x35d6bb[_0xf738c1(0x282,0x24a,0x263,0x248)],_0x4c2e6b),_0x36f907=_0x36f907[_0x51c424(0x36d,0x369,0x393,0x374)](_0x35d6bb['lXpGv'],_0x4c2e6b)):_0x2ff1a6['add'](_0x51c424(0x3d8,0x3b7,0x3bf,0x3f4)+_0xf738c1(0x252,0x286,0x235,0x28d)+_0xcc4985+'@}'));_0x1413ee=replacePlaceholder(_0x1413ee,_0x35d6bb[_0xf738c1(0x292,0x2d1,0x2dc,0x303)],context,_0x305704),_0x1413ee=_0x35d6bb[_0x51c424(0x3f6,0x387,0x3cf,0x41c)](replacePlaceholder,_0x1413ee,_0xf738c1(0x25c,0x29d,0x27c,0x263),_0x36f907,_0x305704),_0x1413ee=_0x35d6bb['DXGak'](replacePlaceholder,_0x1413ee,_0x35d6bb[_0xf738c1(0x2cd,0x282,0x262,0x2a1)],body,_0x305704),_0x1413ee=_0x35d6bb['PayXe'](replacePlaceholder,_0x1413ee,_0x35d6bb['FDGGm'],characterListText,_0x305704),_0x1413ee=_0x35d6bb[_0xf738c1(0x2f7,0x2d6,0x291,0x2c5)](replacePlaceholder,_0x1413ee,_0x35d6bb[_0xf738c1(0x2a1,0x2e1,0x2e5,0x291)],outfitEnableListText,_0x305704),_0x1413ee=_0x35d6bb[_0x51c424(0x435,0x413,0x409,0x3d7)](replacePlaceholder,_0x1413ee,_0x35d6bb[_0x51c424(0x418,0x3b9,0x3f1,0x3c7)],commonCharacterListText,_0x305704),_0x1413ee=_0x35d6bb['PayXe'](replacePlaceholder,_0x1413ee,_0x35d6bb[_0xf738c1(0x261,0x293,0x28a,0x249)],userDemand,_0x305704);if(variables&&_0x35d6bb[_0x51c424(0x412,0x3c6,0x3c8,0x405)](Object[_0xf738c1(0x26a,0x267,0x229,0x282)](variables)[_0xf738c1(0x2b2,0x2a7,0x2b0,0x29f)],-0x1bd*0x1+0x8ee+-0x731)){const _0xbf3e4=/\{\{getvar::([^}]+)\}\}/g,_0x85a907=JSON[_0x51c424(0x390,0x36d,0x387,0x354)](_0x1413ee),_0x3262f6=[..._0x85a907[_0xf738c1(0x2c0,0x2cf,0x2ba,0x2d0)](_0xbf3e4)],_0x54ca04=new Set();for(const _0x28abc9 of _0x3262f6){if(_0x35d6bb[_0xf738c1(0x2a7,0x27f,0x2c8,0x271)]===_0x35d6bb[_0x51c424(0x361,0x3ae,0x3a6,0x36f)])_0x54ca04[_0x51c424(0x412,0x3b1,0x3e5,0x3ec)](_0x28abc9[-0x712+0x118*-0x23+0x11*0x2ab]);else for(const _0x5c2125 of _0x13fb75['history']){if(_0x5c2125[_0x51c424(0x3e5,0x3e7,0x3af,0x3fa)]&&_0x35d6bb['gPYgS'](_0x5c2125[_0xf738c1(0x2a8,0x288,0x2d1,0x27c)]['trim'](),'')){const _0xc065de={};_0xc065de[_0xf738c1(0x26f,0x26a,0x283,0x24c)]=_0xf738c1(0x2c0,0x288,0x258,0x2aa),_0xc065de[_0x51c424(0x40f,0x3d7,0x3cc,0x3c8)]=_0x5c2125['user'],_0x2911fb[_0xf738c1(0x280,0x247,0x204,0x25e)](_0xc065de);}if(_0x5c2125[_0xf738c1(0x2b8,0x26e,0x245,0x287)]&&_0x35d6bb[_0x51c424(0x3cd,0x3da,0x38d,0x3dc)](_0x5c2125[_0x51c424(0x3df,0x383,0x395,0x34f)]['trim'](),'')){const _0x185032={};_0x185032[_0xf738c1(0x297,0x26a,0x2ae,0x288)]=_0x35d6bb['KXWMG'],_0x185032['content']=_0x5c2125[_0x51c424(0x3c2,0x3a7,0x395,0x394)],_0x9fa5b3[_0xf738c1(0x26c,0x247,0x1f9,0x220)](_0x185032);}}}for(const _0x23410d of _0x54ca04){if(_0x35d6bb[_0xf738c1(0x235,0x241,0x21b,0x26e)](_0x35d6bb['RJdgd'],'HpLzt'))_0x22382d[_0x51c424(0x422,0x3b7,0x3e5,0x3ff)](_0x51c424(0x3f3,0x371,0x3c2,0x3b0)+_0x165010+'@}');else{const _0x3eddc2=_0x51c424(0x407,0x3bc,0x3da,0x3ed)+_0x23410d+'}}',_0xb228d5=variables[_0x23410d]||'';_0x1413ee=_0x35d6bb['oiWAF'](replacePlaceholder,_0x1413ee,_0x3eddc2,_0xb228d5,_0x305704);}}}_0x1413ee=_0x35d6bb['qWZAk'](processVariablePlaceholdersInMessages,_0x1413ee,_0x305704);const _0x329e29={};function _0x51c424(_0x35183d,_0x3ae65d,_0x569c04,_0x21ceec){return _0x5891(_0x569c04-0x2c9,_0x21ceec);}return _0x329e29[_0x51c424(0x3ec,0x36e,0x3a4,0x3c0)]=_0x1413ee,_0x329e29[_0x51c424(0x368,0x377,0x3bc,0x389)+_0x51c424(0x45e,0x459,0x40b,0x3ec)]=_0x305704,_0x329e29;}function processVariablePlaceholdersInMessages(_0x1ac9ef,_0x3c195f){function _0x1334a6(_0x4ed666,_0x8f9bb4,_0x5c6594,_0x3f9eb0){return _0x5891(_0x5c6594- -0x10c,_0x8f9bb4);}function _0x40f943(_0xe76cb0,_0x15ec29,_0x5acfb9,_0x53ab6b){return _0x5891(_0x5acfb9-0xa0,_0xe76cb0);}const _0xb9241a={'kLelv':function(_0x17c185,_0x3aa241,_0x227b4f){return _0x17c185(_0x3aa241,_0x227b4f);},'VyiqQ':function(_0x212e60,_0x2d65d9){return _0x212e60===_0x2d65d9;},'OHBIm':'PxURW','phXXp':_0x1334a6(-0x10,-0x19,-0x8,-0xa),'ftEZu':function(_0x35537e,_0x173e2a,_0x330aae,_0x3a1ceb){return _0x35537e(_0x173e2a,_0x330aae,_0x3a1ceb);},'NzpJO':function(_0x3549d7){return _0x3549d7();},'uXKTO':function(_0x104dcb,_0x68f096){return _0x104dcb!==_0x68f096;},'jAUuv':'lXGLw','oSHmv':'gZMAW'};if(!_0x1ac9ef||_0xb9241a[_0x1334a6(-0x29,-0x31,-0x52,-0x32)](_0x1ac9ef[_0x40f943(0x1c2,0x1e4,0x1a5,0x1f8)],-0x2455+-0x24bc+0x1*0x4911))return _0x1ac9ef;const _0x554551=_0xb9241a[_0x40f943(0x1a6,0x1f7,0x1b2,0x1d2)](getContext);return!_0x554551['chatMetada'+'ta']&&(_0xb9241a['uXKTO'](_0xb9241a[_0x1334a6(0x39,-0x22,0x11,0x1e)],_0xb9241a[_0x40f943(0x1bf,0x1f3,0x1da,0x1bc)])?_0x554551[_0x40f943(0x17f,0x1ca,0x18c,0x1b3)+'ta']={}:_0x152dc9[_0x40f943(0x186,0x1bd,0x1a3,0x1cb)]=_0xb9241a[_0x40f943(0x153,0x1ac,0x18d,0x1d5)](_0x5081aa,_0x5e8cd3[_0x40f943(0x17c,0x1ce,0x1a3,0x176)],_0x5d8180[_0x1334a6(0x3e,-0x50,-0x9,-0x44)])),!_0x554551[_0x40f943(0x19d,0x16e,0x18c,0x173)+'ta']['variables']&&(_0x554551['chatMetada'+'ta'][_0x1334a6(0x4,0x52,0x1b,-0x32)]={}),_0x1ac9ef['map'](_0x8367f2=>{function _0x61982d(_0x55a740,_0x55dba2,_0x22f356,_0xc3a628){return _0x40f943(_0x22f356,_0x55dba2-0x36,_0xc3a628-0x2fc,_0xc3a628-0xe0);}function _0x439ab5(_0x4d0a76,_0x59fbe3,_0x362df0,_0x30fb66){return _0x40f943(_0x30fb66,_0x59fbe3-0xa1,_0x4d0a76-0x14,_0x30fb66-0xdc);}if(_0xb9241a['VyiqQ'](_0xb9241a[_0x439ab5(0x1c0,0x1df,0x1a2,0x1b2)],_0xb9241a[_0x61982d(0x4f9,0x4b7,0x487,0x4bb)]))_0xb7567c[_0x439ab5(0x1a0,0x1b6,0x1ba,0x183)+'ta'][_0x61982d(0x4f0,0x512,0x48f,0x4c3)]={};else{if(!_0x8367f2||!_0x8367f2[_0x439ab5(0x1b7,0x1c2,0x1ed,0x1da)])return _0x8367f2;return{..._0x8367f2,'content':_0xb9241a[_0x61982d(0x4a4,0x449,0x4cd,0x494)](processContentVariables,_0x8367f2[_0x439ab5(0x1b7,0x18d,0x1ce,0x1a0)],_0x554551,_0x3c195f)};}});}function processContentVariables(_0x225352,_0x501aa3,_0x1dc00a){const _0x46c396={'yrPuD':function(_0x1b6f1a,_0x333ec6){return _0x1b6f1a(_0x333ec6);},'lnBiP':function(_0x127bca,_0x5b5606){return _0x127bca===_0x5b5606;},'LYOEZ':function(_0x29cbbb,_0x4c27cb,_0xd28198){return _0x29cbbb(_0x4c27cb,_0xd28198);},'klUfs':'text','FGezh':function(_0x2cf302,_0x20a756){return _0x2cf302||_0x20a756;},'GCDrU':function(_0x2da1fd,_0xd7b9b){return _0x2da1fd===_0xd7b9b;},'igdwk':function(_0x258c62,_0xe400d1){return _0x258c62===_0xe400d1;},'ewvdm':'string','BeSGf':function(_0x355899,_0x3e1b5b){return _0x355899===_0x3e1b5b;},'eoGJo':function(_0x1d3b30,_0x37fc64,_0x39436d,_0x3eec4a){return _0x1d3b30(_0x37fc64,_0x39436d,_0x3eec4a);},'CzjMY':'aNCVo'};if(_0x46c396[_0x3b029f(0x1a8,0x1b0,0x1dd,0x198)](typeof _0x225352,_0x46c396[_0x3b029f(0x16f,0x1b8,0x159,0x16a)])){if(_0x4b06a2(-0x108,-0x106,-0x143,-0x118)==='qFQjF'){const _0x272aae={};return _0x272aae[_0x4b06a2(-0xec,-0xe1,-0xd5,-0x125)+'e']=_0x70f069,_0x272aae[_0x3b029f(0x20e,0x22e,0x239,0x1e6)+'a']=_0x47118d,_0x46c396['yrPuD'](_0x47d108,_0x272aae);}else return _0x46c396[_0x3b029f(0x1ec,0x238,0x23c,0x1ff)](processStringVariables,_0x225352,_0x501aa3,_0x1dc00a);}function _0x3b029f(_0x5cff63,_0x387c18,_0x4d5c9d,_0x3eff70){return _0x5891(_0x5cff63-0xd2,_0x3eff70);}function _0x4b06a2(_0x2da9d9,_0x2e2446,_0x18b79d,_0x4b190c){return _0x5891(_0x2e2446- -0x1ee,_0x2da9d9);}if(Array[_0x3b029f(0x19d,0x1c4,0x1d0,0x1df)](_0x225352)){if(_0x46c396[_0x4b06a2(-0x102,-0x13f,-0x12d,-0xfb)]!==_0x46c396['CzjMY']){if(!_0x366153){const _0x3ff1bd={..._0x12edd3};_0x614ee4=_0x3ff1bd;}else{if(_0x46c396[_0x3b029f(0x1db,0x1d5,0x225,0x1f5)](_0x26d9f1[_0x4b06a2(-0xde,-0x126,-0x11d,-0x16c)],_0x59fd83['role']))_0x15651b['content']=_0x46c396['LYOEZ'](_0x138375,_0x36e2f3[_0x4b06a2(-0x117,-0xeb,-0x13f,-0xa1)],_0x567b36[_0x4b06a2(-0x13c,-0xeb,-0xa1,-0x105)]);else{_0x203c7f[_0x3b029f(0x177,0x193,0x176,0x192)](_0x15bb04);const _0x78ece5={..._0x3984af};_0x8f0afe=_0x78ece5;}}}else return _0x225352[_0x3b029f(0x17b,0x16d,0x179,0x18a)](_0x59e29a=>{function _0x12a9e5(_0x6072c,_0x376286,_0x1256c1,_0x2e97c3){return _0x4b06a2(_0x6072c,_0x376286-0x4a4,_0x1256c1-0x39,_0x2e97c3-0x11a);}function _0x405599(_0x43cc7c,_0x696cb8,_0xfe71f3,_0xac5bf){return _0x4b06a2(_0x696cb8,_0xfe71f3- -0x89,_0xfe71f3-0x130,_0xac5bf-0x1b6);}const _0x3de106={'cYnPQ':_0x46c396['klUfs'],'bJrzi':function(_0xe67ddc,_0x56d14e){function _0x7c06e8(_0x16662f,_0x4b15fd,_0x46cbfe,_0x51cbcd){return _0x5891(_0x51cbcd-0x1e8,_0x4b15fd);}return _0x46c396[_0x7c06e8(0x292,0x2ca,0x28a,0x2cb)](_0xe67ddc,_0x56d14e);}};if(_0x46c396[_0x12a9e5(0x3a8,0x3be,0x38b,0x36e)]('dCbfz',_0x405599(-0x1b3,-0x1f0,-0x1d9,-0x1bb))){if(_0x59e29a&&_0x46c396[_0x405599(-0x179,-0x179,-0x1a7,-0x164)](_0x59e29a[_0x12a9e5(0x3b4,0x3f3,0x443,0x402)],_0x46c396[_0x405599(-0x164,-0x157,-0x187,-0x13a)])&&_0x46c396['GCDrU'](typeof _0x59e29a['text'],_0x46c396[_0x12a9e5(0x3a1,0x353,0x322,0x323)]))return{..._0x59e29a,'text':processStringVariables(_0x59e29a[_0x12a9e5(0x3b7,0x3cd,0x416,0x3e5)],_0x501aa3,_0x1dc00a)};return _0x59e29a;}else{if(_0x2fc020[_0x12a9e5(0x3b3,0x381,0x3af,0x3be)](_0x4d22bf))return _0x2674d5;return[{'type':_0x3de106[_0x405599(-0x16f,-0x137,-0x167,-0x1a7)],'text':_0x3de106[_0x12a9e5(0x389,0x36d,0x345,0x391)](_0x5540a7,'')}];}});}return _0x225352;}function processStringVariables(_0xd94fce,_0x36465a,_0x51f7e9){const _0x43c221={'GFACB':function(_0x394e36,_0x3082c0){return _0x394e36===_0x3082c0;},'drOuy':'oweJT','AcPZM':function(_0x1ee224,_0x230c3d,_0x2f3ab7){return _0x1ee224(_0x230c3d,_0x2f3ab7);},'Rkfgj':_0x43a79e(0xbd,0xc3,0xaa,0xc2)};function _0x4e1f8c(_0x2ae827,_0x520f86,_0x449425,_0x472bbd){return _0x5891(_0x2ae827- -0x28d,_0x472bbd);}if(!_0xd94fce)return _0xd94fce;let _0x1e9193=_0xd94fce;_0x1e9193=_0x1e9193[_0x4e1f8c(-0x1b4,-0x1cc,-0x1f4,-0x202)](/\{@setvar::([^:@]+)::([\s\S]*?)@\}/g,(_0x2d26db,_0x3e6aad,_0x4b93dd)=>{const _0x5b7c92=_0x3e6aad[_0x49799b(-0x59,-0x7d,-0xa2,-0x92)]();function _0x4e3578(_0x29c70b,_0x294f9e,_0x502330,_0xf1d27e){return _0x4e1f8c(_0x294f9e- -0x59,_0x294f9e-0x1bc,_0x502330-0x124,_0xf1d27e);}function _0x49799b(_0x1665d4,_0x33edd4,_0x105597,_0x585b3c){return _0x43a79e(_0x33edd4,_0x33edd4-0x1ec,_0x105597-0x99,_0x105597- -0x163);}_0x36465a[_0x4e3578(-0x1ee,-0x1fa,-0x1cb,-0x1c9)+'ta'][_0x4e3578(-0x1e4,-0x1bf,-0x1ab,-0x1a9)][_0x5b7c92]=_0x4b93dd;if(_0x51f7e9){if(_0x43c221[_0x4e3578(-0x237,-0x1fb,-0x1fc,-0x1bb)](_0x43c221[_0x4e3578(-0x1f7,-0x1e9,-0x211,-0x1c1)],_0x4e3578(-0x1be,-0x1f7,-0x20a,-0x209)))_0x51f7e9['add'](_0x49799b(-0xf3,-0x9f,-0xbe,-0xf0)+_0x5b7c92+'@}');else{if(_0x78fe3c[_0x49799b(-0xed,-0xfa,-0xf3,-0xbf)](_0x1bed3a))return!![];}}return'';}),_0x1e9193=_0x1e9193[_0x43a79e(0x70,0x51,0x6c,0x90)](/\{@getvar::([^@]+)@\}/g,(_0x1e8c7a,_0x3e9f67)=>{const _0xaa7114=_0x3e9f67['trim'](),_0x42b7f3=_0x36465a[_0xc2f869(-0xcf,-0x97,-0x9f,-0x7d)+'ta'][_0xc2f869(-0x5f,-0x5c,-0x16,-0x56)][_0xaa7114]||'';function _0xc2f869(_0x44b630,_0x21dd67,_0x510bee,_0x1b6ef0){return _0x43a79e(_0x44b630,_0x21dd67-0x13a,_0x510bee-0x16,_0x21dd67- -0x13a);}_0x51f7e9&&_0x51f7e9[_0xc2f869(-0x4a,-0x67,-0x14,-0x14)]('{@getvar::'+_0xaa7114+'@}');function _0x2d4357(_0x2d39ef,_0x5a370c,_0x52afb9,_0x9a69ff){return _0x43a79e(_0x52afb9,_0x5a370c-0x1b2,_0x52afb9-0x19a,_0x2d39ef-0x264);}return _0x42b7f3;}),_0x1e9193=_0x1e9193[_0x4e1f8c(-0x1b4,-0x1da,-0x1e0,-0x1ff)](/\{@setglobalvar::([^:@]+)::([\s\S]*?)@\}/g,(_0x166353,_0x453423,_0x5b44db)=>{const _0x3ed9f5=_0x453423[_0x6f87e0(-0xe8,-0xad,-0xb5,-0xcd)]();function _0x1394dd(_0x56935,_0xfecf48,_0x1af428,_0x3d9377){return _0x4e1f8c(_0x56935-0x21d,_0xfecf48-0x92,_0x1af428-0xf0,_0xfecf48);}function _0x6f87e0(_0x5243c1,_0x4e9732,_0x176bb9,_0x2ab5c7){return _0x43a79e(_0x4e9732,_0x4e9732-0x1d6,_0x176bb9-0x19,_0x5243c1- -0x1a9);}return _0x43c221[_0x6f87e0(-0x10d,-0x15c,-0x161,-0xf6)](setglobalvar,_0x3ed9f5,_0x5b44db),_0x51f7e9&&_0x51f7e9[_0x1394dd(0xac,0x66,0xda,0xcd)](_0x1394dd(0x86,0xd9,0xcd,0x6a)+'lvar::'+_0x3ed9f5+'@}'),'';}),_0x1e9193=_0x1e9193[_0x4e1f8c(-0x1b4,-0x1bd,-0x191,-0x1c4)](/\{@getglobalvar::([^@]+)@\}/g,(_0x32ac59,_0x51918b)=>{function _0x340cfe(_0x6d7e01,_0x459d1d,_0x21dd64,_0x8205d9){return _0x4e1f8c(_0x21dd64-0x292,_0x459d1d-0x1e2,_0x21dd64-0x184,_0x8205d9);}const _0x3c68b8=_0x51918b[_0x340cfe(0xe7,0x150,0x10f,0xd8)](),_0x158924=getglobalvar(_0x3c68b8)||'';_0x51f7e9&&_0x51f7e9[_0x340cfe(0x111,0x12d,0x121,0x100)]('{@getgloba'+_0x340cfe(0xb7,0xfa,0xe9,0x11a)+_0x3c68b8+'@}');function _0x45a822(_0x48e11c,_0x2f1124,_0x9f30b0,_0xbdfef3){return _0x43a79e(_0x2f1124,_0x2f1124-0x1de,_0x9f30b0-0x1ed,_0xbdfef3- -0x1b7);}return _0x158924;}),_0x1e9193=_0x1e9193[_0x4e1f8c(-0x1b4,-0x1b9,-0x206,-0x1d0)](/\{@getworldvar::([^@]+)@\}/g,(_0x3bfcd3,_0x4425ef)=>{function _0x214b38(_0x247fc2,_0x22d920,_0x4bb3a8,_0x16ab82){return _0x4e1f8c(_0x4bb3a8- -0x12,_0x22d920-0x42,_0x4bb3a8-0x97,_0x22d920);}function _0x3b7ef1(_0x3da169,_0x1181a8,_0x1d3a2d,_0x390168){return _0x43a79e(_0x1181a8,_0x1181a8-0x171,_0x1d3a2d-0x13,_0x3da169-0x24b);}if(_0x43c221[_0x3b7ef1(0x343,0x34a,0x369,0x338)]===_0x43c221[_0x3b7ef1(0x343,0x305,0x357,0x35d)]){const _0x15b2e5=_0x4425ef['trim'](),_0x24ab67=getworldvar(_0x15b2e5)||'';return _0x51f7e9&&_0x51f7e9[_0x3b7ef1(0x31e,0x30b,0x370,0x31a)]('{@getworld'+'var::'+_0x15b2e5+'@}'),_0x24ab67;}else{const _0x4a5b33=_0x5d6bf7['trim']();return _0x410598[_0x214b38(-0x1de,-0x1dc,-0x1b3,-0x187)+'ta']['variables'][_0x4a5b33]=_0x476c68,_0x246edb&&_0x4e9971[_0x3b7ef1(0x31e,0x364,0x351,0x328)](_0x3b7ef1(0x2f0,0x2b3,0x30b,0x2da)+_0x4a5b33+'@}'),'';}});function _0x43a79e(_0x1a6d5b,_0x37c9b4,_0x53bc1c,_0x4262c8){return _0x5891(_0x4262c8- -0x49,_0x1a6d5b);}return _0x1e9193;}export function buildPromptWithTrigger(_0x288612){function _0x52cf9d(_0x24eacd,_0x585998,_0x448d6f,_0x3abd4e){return _0x5891(_0x24eacd-0x249,_0x585998);}const _0x4730c7={'RrQnT':function(_0x1265b7,_0x38911a){return _0x1265b7===_0x38911a;},'jNDNo':_0x52cf9d(0x308,0x2e9,0x348,0x33d),'bMhfZ':function(_0x147bf9,_0x4f0b0a,_0x85517f){return _0x147bf9(_0x4f0b0a,_0x85517f);},'nkaLx':'user','SoxRy':function(_0x5d6be7,_0x345b2d){return _0x5d6be7===_0x345b2d;},'bEzRY':_0x52cf9d(0x36d,0x32c,0x337,0x3b5),'Syjgk':_0x52cf9d(0x369,0x35b,0x32a,0x31c),'Oahfe':function(_0x3dfa7e,_0x4bb941){return _0x3dfa7e===_0x4bb941;},'lulww':_0x52cf9d(0x37f,0x379,0x3bc,0x3d3),'kZJTc':function(_0x5fa92c,_0x56775b){return _0x5fa92c!==_0x56775b;},'ivJDJ':function(_0x17ab7d,_0x8cd5d4){return _0x17ab7d!==_0x8cd5d4;}},{requestType:_0x55af79,contextData:_0x242fee}=_0x288612,_0x94e465=extension_settings[extensionName]?.[_0x52cf9d(0x321,0x305,0x2f8,0x36e)+'t_type_con'+_0x52cf9d(0x36f,0x334,0x3ac,0x32a)]||{},_0x58095b={};_0x58095b[_0x4cf48a(0xaf,0xbe,0xe8,0xee)+_0x52cf9d(0x2fb,0x31f,0x317,0x2c0)]='默认';const _0x358bf1=_0x94e465[_0x55af79]||_0x58095b,_0x1d58df=_0x358bf1[_0x52cf9d(0x30f,0x30c,0x34d,0x2c5)+'ofile']||'默认',_0x4f9075=extension_settings[extensionName]?.[_0x52cf9d(0x372,0x36a,0x395,0x3b0)+_0x4cf48a(0x167,0x129,0x129,0x15f)+'s']||{},_0x586548=_0x4f9075[_0x1d58df]||_0x4f9075[Object['keys'](_0x4f9075)[-0x1*0x7f9+0x1ea+0x60f*0x1]]||{},{context:context='',body:body='',worldBookContent:worldBookContent='',userDemand:userDemand=''}=_0x242fee,_0x6377d3=[userDemand,context,body,worldBookContent][_0x4cf48a(0x121,0x10e,0xf0,0x12a)](Boolean)[_0x4cf48a(0x158,0x10c,0x10f,0xee)]('\x0a');function _0x4cf48a(_0x4e08f4,_0x359368,_0x567b58,_0x11ea27){return _0x5891(_0x359368- -0x8,_0x4e08f4);}const _0x541204=[];if(_0x586548['entries']&&Array[_0x4cf48a(0xc0,0xc3,0x9c,0xa6)](_0x586548[_0x4cf48a(0x11e,0x13c,0x151,0x133)]))for(const _0x3d2b82 of _0x586548['entries']){if(!_0x3d2b82[_0x52cf9d(0x347,0x30d,0x373,0x338)])continue;if(!_0x3d2b82['content']||_0x3d2b82[_0x52cf9d(0x34c,0x340,0x2fb,0x394)]['trim']()==='')continue;if(_0x4730c7[_0x52cf9d(0x328,0x36a,0x354,0x350)](_0x3d2b82[_0x52cf9d(0x309,0x349,0x34f,0x339)+'e'],_0x4730c7['jNDNo'])){if(!_0x4730c7[_0x4cf48a(0x11a,0x133,0x127,0xe8)](checkTriggerWords,_0x3d2b82[_0x4cf48a(0x14c,0x12a,0x177,0xed)+'ds'],_0x6377d3))continue;}const _0x76fecc={};_0x76fecc[_0x52cf9d(0x311,0x336,0x2de,0x2d4)]=_0x3d2b82[_0x4cf48a(0x91,0xc0,0x7a,0xe7)]||_0x4730c7[_0x52cf9d(0x333,0x360,0x360,0x2f3)],_0x76fecc['content']=_0x3d2b82[_0x52cf9d(0x34c,0x362,0x361,0x36d)],_0x541204[_0x52cf9d(0x2ee,0x315,0x2b6,0x2ce)](_0x76fecc);}else{if(_0x586548[_0x4cf48a(0xf5,0x13b,0xf8,0x118)]&&Array[_0x4cf48a(0xa5,0xc3,0xfe,0x97)](_0x586548[_0x4cf48a(0x175,0x13b,0x142,0x10a)])){if(_0x4730c7[_0x52cf9d(0x2fc,0x2c7,0x2ae,0x347)](_0x4730c7[_0x4cf48a(0x108,0x123,0xf5,0x12d)],_0x4730c7[_0x52cf9d(0x320,0x2ea,0x358,0x2fd)])){const _0x35b8e6=_0x15919f?function(){function _0x43eccf(_0x391207,_0x107a6d,_0x5d5150,_0x1ce043){return _0x4cf48a(_0x5d5150,_0x1ce043- -0xf3,_0x5d5150-0x13d,_0x1ce043-0x1e5);}if(_0x3f88f6){const _0x4d0be3=_0x4e0e43[_0x43eccf(-0x4,-0x16,-0x40,-0x1)](_0x5bee02,arguments);return _0x5dad20=null,_0x4d0be3;}}:function(){};return _0x85710c=![],_0x35b8e6;}else for(const _0x1ba5c0 of _0x586548[_0x52cf9d(0x38c,0x35b,0x353,0x3c8)]){if(_0x4730c7['Oahfe'](_0x4730c7[_0x4cf48a(0x98,0xb3,0x90,0x85)],_0x4730c7[_0x52cf9d(0x304,0x2c4,0x2ee,0x2de)])){if(_0x1ba5c0['user']&&_0x4730c7[_0x52cf9d(0x380,0x3a7,0x37b,0x3b3)](_0x1ba5c0[_0x52cf9d(0x32f,0x31f,0x319,0x320)][_0x4cf48a(0xbd,0x102,0x145,0xe0)](),'')){const _0x38c332={};_0x38c332['role']=_0x4730c7[_0x4cf48a(0x11e,0xe2,0xdd,0x108)],_0x38c332['content']=_0x1ba5c0['user'],_0x541204[_0x52cf9d(0x2ee,0x2ba,0x2a4,0x2b8)](_0x38c332);}if(_0x1ba5c0[_0x52cf9d(0x315,0x2d0,0x2f5,0x300)]&&_0x4730c7[_0x4cf48a(0xcd,0xa9,0x77,0xb5)](_0x1ba5c0['assistant']['trim'](),'')){const _0x4d4a67={};_0x4d4a67[_0x52cf9d(0x311,0x328,0x2e1,0x312)]=_0x4cf48a(0xde,0xc4,0x110,0x10a),_0x4d4a67['content']=_0x1ba5c0[_0x52cf9d(0x315,0x2da,0x33a,0x35e)],_0x541204['push'](_0x4d4a67);}}else{const _0x931bc9={};_0x931bc9['role']=_0x4cf48a(0xe3,0xc4,0x9a,0xdb),_0x931bc9['content']=_0x2c58fa[_0x4cf48a(0xe8,0xc4,0xde,0xcc)],_0x513392['push'](_0x931bc9);}}}}const _0x4dbe54=mergeAdjacentMessages(_0x541204),{messages:_0x29d60c,replacedVariables:_0x3f4b75}=_0x4730c7[_0x52cf9d(0x384,0x34a,0x389,0x3d6)](replaceAllPlaceholders,_0x4dbe54,_0x242fee);return _0x29d60c;}export function getProcessedPrompt(_0x6e6f2e,_0x2297cd){function _0x25405e(_0x3f8fe8,_0x219eae,_0x5385d9,_0x32674a){return _0x5891(_0x32674a- -0x13f,_0x219eae);}function _0x2986e2(_0x151a60,_0xf5df16,_0x494abb,_0x22a352){return _0x5891(_0xf5df16- -0x3aa,_0x151a60);}const _0x39b19b={'kCsOW':function(_0x4935ec,_0x1f1a26){return _0x4935ec(_0x1f1a26);}},_0x2950c0={};return _0x2950c0[_0x2986e2(-0x2a0,-0x29d,-0x2c0,-0x2de)+'e']=_0x6e6f2e,_0x2950c0[_0x25405e(0x1,0x36,-0x4a,-0x3)+'a']=_0x2297cd,_0x39b19b[_0x25405e(-0x4a,-0xa0,-0x50,-0x87)](buildPromptWithTrigger,_0x2950c0);}