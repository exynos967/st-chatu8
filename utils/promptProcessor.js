(function(_0x1a7cb6,_0x431136){function _0x1bf924(_0x5118fd,_0xa82b66,_0x32375d,_0x42a10c){return _0x3f58(_0x5118fd-0x107,_0x32375d);}function _0x1c272c(_0x4f79c9,_0x195ec4,_0x86283d,_0x2edaec){return _0x3f58(_0x2edaec-0x290,_0x195ec4);}const _0x16c255=_0x1a7cb6();while(!![]){try{const _0x3b81fd=parseInt(_0x1c272c(0x387,0x388,0x3e5,0x3d2))/(0x2*0xd03+0x88d*-0x2+0x1*-0x8eb)*(parseInt(_0x1c272c(0x410,0x3ef,0x403,0x415))/(0x244c+-0x631+-0x1e19))+-parseInt(_0x1c272c(0x3fe,0x410,0x42e,0x430))/(-0x23*0xb2+-0x556+-0x95*-0x33)*(parseInt(_0x1bf924(0x277,0x2b2,0x274,0x26f))/(0x1305*-0x1+-0x140b+-0x2714*-0x1))+-parseInt(_0x1c272c(0x3e0,0x3fc,0x39c,0x3dd))/(0x1*-0x12d6+-0x46d*0x2+0x1bb5)*(parseInt(_0x1c272c(0x38b,0x3a0,0x3bd,0x3cb))/(0x4*-0x907+-0x1212+-0xd8d*-0x4))+parseInt(_0x1bf924(0x225,0x1da,0x23b,0x1f2))/(0x3*-0x1c6+0x1605*0x1+-0x2c*0x61)*(-parseInt(_0x1c272c(0x40a,0x3dd,0x381,0x3c5))/(0xf*-0x1ae+-0x1561+-0xf89*-0x3))+-parseInt(_0x1bf924(0x2bc,0x282,0x2c0,0x2a3))/(0x2669+0x237f+0x1*-0x49df)+-parseInt(_0x1bf924(0x21e,0x215,0x244,0x1f3))/(0x1*-0x120d+-0x23bd+0x35d4)*(parseInt(_0x1bf924(0x267,0x22d,0x213,0x26a))/(-0x9b1+0x34*0x46+-0x4*0x11f))+parseInt(_0x1c272c(0x3f7,0x456,0x3d1,0x412))/(0x3*-0x759+-0x1ef*-0x3+-0x1*-0x104a)*(parseInt(_0x1bf924(0x28e,0x2e0,0x260,0x270))/(-0x1+-0x1*0x2303+0x2311));if(_0x3b81fd===_0x431136)break;else _0x16c255['push'](_0x16c255['shift']());}catch(_0x15e04d){_0x16c255['push'](_0x16c255['shift']());}}}(_0x51d5,-0x1ad655+-0x1*0x166253+0x3f4462));const _0x214b51=(function(){function _0x14cb98(_0x449a61,_0x1b56d6,_0x1a3213,_0x73e6bb){return _0x3f58(_0x1a3213-0x17,_0x73e6bb);}const _0x1da391={'fawUR':function(_0x59927a,_0x228612){return _0x59927a!==_0x228612;},'wnkhZ':function(_0x4c76d0,_0x3609b0){return _0x4c76d0(_0x3609b0);},'WVkZO':function(_0x1bdf78,_0x1e3082){return _0x1bdf78===_0x1e3082;},'FnvgO':_0x14cb98(0x1c1,0x1a0,0x182,0x169),'opHSW':'KsLem','nHWSJ':'LJTVH'};let _0x515ded=!![];return function(_0x20dfba,_0x4d4c5c){function _0x4b8fcb(_0x310164,_0xdce345,_0x3f594c,_0xdba228){return _0x14cb98(_0x310164-0x1d4,_0xdce345-0x190,_0x310164-0x71,_0x3f594c);}const _0x51b3c5={'qREzF':function(_0x6d0b10,_0x4944a1){function _0x16100b(_0x4dc97c,_0x547ede,_0xdf6892,_0x34531d){return _0x3f58(_0x4dc97c- -0x96,_0x547ede);}return _0x1da391[_0x16100b(0xbd,0xbf,0xf8,0xfc)](_0x6d0b10,_0x4944a1);},'FlJSf':function(_0x52437a,_0x35fa8e){function _0x45741a(_0x3d931b,_0x2beebd,_0x2fe40d,_0x4c9254){return _0x3f58(_0x2fe40d-0xb,_0x3d931b);}return _0x1da391[_0x45741a(0x1cc,0x199,0x1a4,0x1ef)](_0x52437a,_0x35fa8e);},'ZlIqi':_0x1da391['FnvgO'],'tTDwn':_0x1da391[_0xc96eaa(0x3ce,0x385,0x3c7,0x370)],'NIOMZ':_0x4b8fcb(0x1b2,0x1d9,0x1f1,0x16f)};function _0xc96eaa(_0x15c5d6,_0x42a4c5,_0x4df78a,_0xef663a){return _0x14cb98(_0x15c5d6-0xfe,_0x42a4c5-0x69,_0x42a4c5-0x1c8,_0xef663a);}if(_0x1da391['fawUR'](_0x1da391[_0x4b8fcb(0x21b,0x203,0x1fb,0x206)],_0x1da391['nHWSJ']))for(const _0x38eac4 of _0x414022[_0x4b8fcb(0x1b1,0x1fd,0x1e3,0x18e)]){if(_0x38eac4[_0x4b8fcb(0x1ac,0x1b9,0x17e,0x18c)]&&_0x1da391[_0x4b8fcb(0x1e5,0x234,0x223,0x1f8)](_0x38eac4[_0xc96eaa(0x2fa,0x303,0x2ee,0x2b8)][_0x4b8fcb(0x1c1,0x197,0x1f2,0x17d)](),'')){const _0x5f15ea={};_0x5f15ea[_0xc96eaa(0x38a,0x38c,0x34b,0x35f)]=_0xc96eaa(0x2e1,0x303,0x2f1,0x2c5),_0x5f15ea[_0xc96eaa(0x378,0x360,0x355,0x3a4)]=_0x38eac4['user'],_0x11a4fd[_0xc96eaa(0x338,0x30a,0x2d1,0x2d5)](_0x5f15ea);}if(_0x38eac4[_0xc96eaa(0x3d2,0x395,0x3cb,0x385)]&&_0x38eac4['assistant'][_0x4b8fcb(0x1c1,0x1e4,0x1be,0x1cb)]()!==''){const _0x124c4a={};_0x124c4a[_0x4b8fcb(0x235,0x242,0x271,0x201)]=_0x4b8fcb(0x23e,0x248,0x20b,0x207),_0x124c4a[_0x4b8fcb(0x209,0x1b6,0x1d6,0x1d1)]=_0x38eac4['assistant'],_0x1d324a[_0xc96eaa(0x2fb,0x30a,0x356,0x320)](_0x124c4a);}}else{const _0x4433e1=_0x515ded?function(){function _0x12808d(_0x7a2771,_0x18c43a,_0x568dc4,_0x586652){return _0x4b8fcb(_0x586652-0x18e,_0x18c43a-0x154,_0x7a2771,_0x586652-0x158);}function _0x40d489(_0x49de86,_0x4096b1,_0x1c596e,_0x5e5fed){return _0xc96eaa(_0x49de86-0xf,_0x49de86- -0x85,_0x1c596e-0x103,_0x5e5fed);}if(_0x51b3c5[_0x12808d(0x3bd,0x3ee,0x374,0x3c7)](_0x51b3c5[_0x12808d(0x385,0x367,0x3cb,0x394)],_0x12808d(0x306,0x2fd,0x35c,0x332))){const _0x1c4e2e=_0x422b94[_0x40d489(0x293,0x29a,0x295,0x2dd)](),_0x558356=_0x51b3c5[_0x40d489(0x2e8,0x2e9,0x301,0x2b0)](_0x162e50,_0x1c4e2e)||'';return _0x331c92&&_0x31a38e[_0x12808d(0x39e,0x37e,0x33a,0x383)](_0x40d489(0x288,0x2b8,0x264,0x247)+_0x40d489(0x306,0x2bf,0x34f,0x348)+_0x1c4e2e+'@}'),_0x558356;}else{if(_0x4d4c5c){if(_0x51b3c5[_0x40d489(0x2aa,0x2f5,0x2a3,0x2b6)]===_0x51b3c5[_0x12808d(0x394,0x377,0x397,0x3bb)])return![];else{const _0x5d5985=_0x4d4c5c[_0x12808d(0x339,0x376,0x393,0x365)](_0x20dfba,arguments);return _0x4d4c5c=null,_0x5d5985;}}}}:function(){};return _0x515ded=![],_0x4433e1;}};}()),_0x58dab6=_0x214b51(this,function(){const _0x1cf753={};function _0x1431fc(_0x13f71e,_0x18e379,_0x5703da,_0x567f7e){return _0x3f58(_0x13f71e- -0x91,_0x5703da);}_0x1cf753['UAWkT']=_0x1431fc(0x9f,0xe6,0xdb,0xaf)+'+$';const _0x38ce41=_0x1cf753;function _0x156265(_0x319e71,_0x20a0f2,_0xa249ca,_0x177496){return _0x3f58(_0xa249ca-0xb8,_0x319e71);}return _0x58dab6[_0x1431fc(0xdd,0xe2,0xeb,0xfe)]()[_0x1431fc(0xef,0xc5,0xbb,0x143)](_0x38ce41[_0x156265(0x27a,0x27e,0x247,0x258)])['toString']()[_0x156265(0x25b,0x1ee,0x230,0x1de)+'r'](_0x58dab6)[_0x156265(0x25f,0x264,0x238,0x259)](_0x38ce41[_0x156265(0x296,0x1ff,0x247,0x299)]);});_0x58dab6();import{extension_settings}from'../../../../extensions.js';import{extensionName}from'./config.js';import{getContext}from'../../../../st-context.js';import{getglobalvar,setglobalvar}from'./chatDataUtils.js';import{getworldvar}from'./worldbookProcessor.js';function _0x3f58(_0xb398c0,_0x5e262f){_0xb398c0=_0xb398c0-(0x86+-0x12*-0x195+0x2*-0xdf6);const _0x3a13d4=_0x51d5();let _0x334628=_0x3a13d4[_0xb398c0];if(_0x3f58['RqfZpJ']===undefined){var _0x3eff05=function(_0x33d2b4){const _0x1a6c22='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x3e0030='',_0x2ed06a='',_0x155e6b=_0x3e0030+_0x3eff05;for(let _0x1aab4d=0x1b1*-0x17+0x798+0x1f4f,_0x1a14d1,_0x36dd79,_0x5a4bc6=0x19eb+-0xcc7+-0x1*0xd24;_0x36dd79=_0x33d2b4['charAt'](_0x5a4bc6++);~_0x36dd79&&(_0x1a14d1=_0x1aab4d%(-0x1a94+-0x221d+0x3cb5)?_0x1a14d1*(-0xff6+-0x1*0x683+0x16b9)+_0x36dd79:_0x36dd79,_0x1aab4d++%(0x2*-0xe6b+0x179c+0x3d*0x16))?_0x3e0030+=_0x155e6b['charCodeAt'](_0x5a4bc6+(0x1a*0x55+-0x90*-0x22+-0x1bb8))-(0x674+0x115*-0x5+-0x101)!==0x90*0x1c+0x15*-0xde+0x276?String['fromCharCode'](-0x2620+0x2*0xdd0+0x147*0x9&_0x1a14d1>>(-(-0x185*-0x1+0xe3*0x9+0x1e*-0x51)*_0x1aab4d&0x1577+-0x1c75*0x1+-0x4*-0x1c1)):_0x1aab4d:-0x117f*0x2+-0x1f86+0x4284){_0x36dd79=_0x1a6c22['indexOf'](_0x36dd79);}for(let _0x5435f0=-0x871+-0x15fe+0x1e6f,_0x5481cf=_0x3e0030['length'];_0x5435f0<_0x5481cf;_0x5435f0++){_0x2ed06a+='%'+('00'+_0x3e0030['charCodeAt'](_0x5435f0)['toString'](0x6e5+-0x49*0x65+0x15f8))['slice'](-(0x1*0x1f85+-0x58*-0x18+-0xd41*0x3));}return decodeURIComponent(_0x2ed06a);};_0x3f58['KjaNwu']=_0x3eff05,_0x3f58['vKqyUZ']={},_0x3f58['RqfZpJ']=!![];}const _0x361796=_0x3a13d4[0x24a2+-0xabe+0xcf2*-0x2],_0x3e8cb5=_0xb398c0+_0x361796,_0x899f7d=_0x3f58['vKqyUZ'][_0x3e8cb5];if(!_0x899f7d){const _0x483d3f=function(_0x20fba9){this['FWwgHI']=_0x20fba9,this['okSGAh']=[0x14cb+0x12fe+-0x27c8,-0x1975+-0x848+0x21bd,0x1e10+-0x20fb*0x1+0x2eb],this['IiZxss']=function(){return'newState';},this['dbXMAm']='\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*',this['mEvrOV']='[\x27|\x22].+[\x27|\x22];?\x20*}';};_0x483d3f['prototype']['frRuKD']=function(){const _0x414fe5=new RegExp(this['dbXMAm']+this['mEvrOV']),_0xe35b58=_0x414fe5['test'](this['IiZxss']['toString']())?--this['okSGAh'][0x1c58+0x1*-0x1342+0x1d1*-0x5]:--this['okSGAh'][-0xe0d+-0x1779+0x2586];return this['IPQYuW'](_0xe35b58);},_0x483d3f['prototype']['IPQYuW']=function(_0x500bc6){if(!Boolean(~_0x500bc6))return _0x500bc6;return this['OFgApz'](this['FWwgHI']);},_0x483d3f['prototype']['OFgApz']=function(_0x58fc54){for(let _0x25ec62=-0x30b+-0x277*-0x4+-0x5*0x15d,_0x468faf=this['okSGAh']['length'];_0x25ec62<_0x468faf;_0x25ec62++){this['okSGAh']['push'](Math['round'](Math['random']())),_0x468faf=this['okSGAh']['length'];}return _0x58fc54(this['okSGAh'][0x20d1+0x1ddf+-0x44*0xec]);},new _0x483d3f(_0x3f58)['frRuKD'](),_0x334628=_0x3f58['KjaNwu'](_0x334628),_0x3f58['vKqyUZ'][_0x3e8cb5]=_0x334628;}else _0x334628=_0x899f7d;return _0x334628;}export function checkTriggerWords(_0x12e789,_0x42eb7f){const _0x3c00f9={};_0x3c00f9['tNieG']=function(_0x5dac9f,_0x46998b){return _0x5dac9f!==_0x46998b;};function _0x5f2b8c(_0x5b5bd2,_0x43a2a0,_0x50137a,_0x4a853f){return _0x3f58(_0x50137a-0x2f,_0x5b5bd2);}_0x3c00f9[_0x1ad7e1(-0x221,-0x209,-0x20a,-0x1b7)]=_0x5f2b8c(0x182,0x1fb,0x1b9,0x1fe);const _0x364c1c=_0x3c00f9;if(!_0x12e789||!_0x42eb7f)return![];const _0x43a93f=_0x12e789['split'](',')['map'](_0x1a5231=>_0x1a5231[_0x1ad7e1(-0x27a,-0x232,-0x22e,-0x243)]())[_0x5f2b8c(0x176,0x12e,0x14f,0x12d)](_0x18f150=>_0x18f150);function _0x1ad7e1(_0x12850e,_0x4921f8,_0x5bacdc,_0x116dfe){return _0x3f58(_0x4921f8- -0x36b,_0x116dfe);}if(_0x43a93f[_0x1ad7e1(-0x236,-0x1f7,-0x249,-0x22d)]===0x5*0xa+0x52a*0x2+-0xa86)return _0x364c1c[_0x5f2b8c(0x1f2,0x1ca,0x1c4,0x1fe)](_0x364c1c[_0x5f2b8c(0x140,0x162,0x191,0x1bc)],_0x5f2b8c(0x1db,0x207,0x1b9,0x190))?[]:![];for(const _0x51f09c of _0x43a93f){if(_0x42eb7f[_0x1ad7e1(-0x236,-0x1f1,-0x213,-0x1fa)](_0x51f09c))return!![];}return![];}export function mergeAdjacentMessages(_0x4930fa){function _0x5d4aad(_0x1ddd5f,_0x4657b2,_0x2509ab,_0x326848){return _0x3f58(_0x4657b2-0x3d7,_0x1ddd5f);}const _0x358ef7={'dtyVD':_0x4e1eed(0x1d9,0x21d,0x22a,0x224),'GqUvo':function(_0x2812b4,_0x244a5e){return _0x2812b4===_0x244a5e;},'HFpND':function(_0x4d8adf,_0x459bfc){return _0x4d8adf+_0x459bfc;},'MfvDi':function(_0x5eb0b4,_0x5eec64){return _0x5eb0b4(_0x5eec64);},'jhyfy':function(_0xc7c996,_0x4afd27){return _0xc7c996(_0x4afd27);},'TfLOV':function(_0x5c5069,_0x45eecd){return _0x5c5069===_0x45eecd;},'atpcm':_0x4e1eed(0x1c2,0x1b6,0x183,0x1a3),'qkOIx':function(_0x25b66f,_0x4f84da,_0x14010d){return _0x25b66f(_0x4f84da,_0x14010d);}};if(!_0x4930fa||_0x4930fa[_0x4e1eed(0x1ba,0x204,0x249,0x252)]===0x2*-0x12af+-0x191*-0x1+-0x263*-0xf)return[];const _0x81e1e6=[];function _0x4e1eed(_0xe1e242,_0x50af8d,_0x22e376,_0x221e0b){return _0x3f58(_0x50af8d-0x90,_0x22e376);}let _0x1051f6=null;for(const _0xd3f05d of _0x4930fa){if(!_0x1051f6){const _0x17ce9f={..._0xd3f05d};_0x1051f6=_0x17ce9f;}else{if(_0x1051f6[_0x5d4aad(0x55f,0x584,0x58f,0x5ac)]===_0xd3f05d[_0x5d4aad(0x5d5,0x584,0x573,0x536)]){if(_0x358ef7[_0x5d4aad(0x542,0x529,0x536,0x50e)]('PYYpz',_0x358ef7[_0x4e1eed(0x245,0x224,0x237,0x1ef)])){if(typeof _0x4fe453===_0x358ef7[_0x4e1eed(0x1db,0x1d6,0x199,0x1bf)]&&_0x358ef7[_0x5d4aad(0x4fc,0x528,0x573,0x51f)](typeof _0x30165f,_0x358ef7[_0x4e1eed(0x1a1,0x1d6,0x1b6,0x1fc)]))return _0x358ef7[_0x4e1eed(0x22a,0x239,0x1ee,0x25e)](_0x358ef7[_0x4e1eed(0x225,0x239,0x264,0x250)](_0x1ccbe8,'\x0a'),_0x2bf97e);const _0x56f8f9=_0x358ef7[_0x5d4aad(0x51f,0x516,0x546,0x4e2)](_0x1e8a02,_0x1309e4),_0x545cef=_0x358ef7[_0x5d4aad(0x534,0x57e,0x553,0x59f)](_0x2d2f44,_0x27bf97),_0x22c9fc={};return _0x22c9fc['type']=_0x5d4aad(0x517,0x51a,0x536,0x4fe),_0x22c9fc[_0x5d4aad(0x56d,0x51a,0x4e4,0x4d9)]='\x0a',[..._0x56f8f9,_0x22c9fc,..._0x545cef];}else _0x1051f6[_0x4e1eed(0x228,0x211,0x1eb,0x1d6)]=_0x358ef7[_0x5d4aad(0x57d,0x552,0x524,0x521)](mergeContent,_0x1051f6[_0x5d4aad(0x529,0x558,0x541,0x552)],_0xd3f05d[_0x5d4aad(0x52e,0x558,0x51a,0x58f)]);}else{_0x81e1e6[_0x4e1eed(0x16e,0x1bb,0x1f6,0x1a3)](_0x1051f6);const _0x3fd143={..._0xd3f05d};_0x1051f6=_0x3fd143;}}}return _0x1051f6&&_0x81e1e6[_0x4e1eed(0x186,0x1bb,0x1e6,0x180)](_0x1051f6),_0x81e1e6;}function mergeContent(_0xec039b,_0x5303b3){const _0x511f52={'anAiU':function(_0x55591d,_0x246aa2){return _0x55591d===_0x246aa2;},'RbNHs':function(_0xf71591,_0x57df79){return _0xf71591===_0x57df79;},'fOTrg':_0x3454a4(-0x7a,-0xcd,-0xc4,-0xb1),'meBEP':function(_0x47f0bb,_0x62137e){return _0x47f0bb+_0x62137e;},'qSaMW':function(_0x29acd7,_0x401054){return _0x29acd7(_0x401054);},'HRxeo':'text'};if(_0x511f52['anAiU'](typeof _0xec039b,_0x3454a4(-0x102,-0x6a,-0xa6,-0xb1))&&_0x511f52[_0x3ed447(0x4b1,0x47c,0x479,0x45a)](typeof _0x5303b3,_0x511f52[_0x3ed447(0x3ee,0x43a,0x43a,0x422)]))return _0x511f52['meBEP'](_0xec039b,'\x0a')+_0x5303b3;const _0x5bef2a=_0x511f52[_0x3ed447(0x3e2,0x43d,0x415,0x434)](normalizeToArray,_0xec039b);function _0x3454a4(_0x514291,_0x23de54,_0x2b8d46,_0xcac74e){return _0x3f58(_0xcac74e- -0x23e,_0x2b8d46);}const _0x449542=normalizeToArray(_0x5303b3),_0x432222={};_0x432222[_0x3454a4(-0xe2,-0xdd,-0xa6,-0x9c)]=_0x511f52[_0x3ed447(0x438,0x461,0x444,0x425)],_0x432222[_0x3454a4(-0x101,-0xa7,-0xf2,-0xfb)]='\x0a';function _0x3ed447(_0x255d44,_0xea5c7d,_0x410cad,_0x412d38){return _0x3f58(_0x410cad-0x2d1,_0x412d38);}return[..._0x5bef2a,_0x432222,..._0x449542];}function normalizeToArray(_0x4cabc1){if(Array[_0x275577(-0x159,-0x178,-0x176,-0x136)](_0x4cabc1))return _0x4cabc1;const _0x277bbb={};function _0x47dad0(_0x3fc729,_0x1c063f,_0x2b5068,_0x46d873){return _0x3f58(_0x2b5068- -0x61,_0x1c063f);}_0x277bbb[_0x275577(-0x112,-0x1a1,-0x15f,-0x1b2)]=_0x275577(-0x209,-0x1ef,-0x1be,-0x1bb);function _0x275577(_0x1faa78,_0x26b65a,_0xb74db6,_0x53f706){return _0x3f58(_0xb74db6- -0x301,_0x26b65a);}return _0x277bbb[_0x275577(-0x1cf,-0x1d6,-0x1be,-0x18f)]=_0x4cabc1||'',[_0x277bbb];}export function replacePlaceholder(_0x5dbd81,_0x5a8968,_0x215e9a,_0x3164b2){const _0x2b2205={'AoDcG':function(_0x561ad7,_0x303bbd){return _0x561ad7(_0x303bbd);},'OOZDm':function(_0x600744,_0x56b787,_0x35203d){return _0x600744(_0x56b787,_0x35203d);},'YqPWf':function(_0x274903,_0x3ca07e){return _0x274903===_0x3ca07e;},'PaSza':'xneAz','ZzLiK':function(_0x15a02f,_0x8d5496){return _0x15a02f===_0x8d5496;},'vfYIa':_0x4bcdb7(-0x18f,-0x18e,-0x13c,-0x183),'JvTsu':_0x35b109(-0x143,-0x124,-0x173,-0x146),'wWBlr':_0x35b109(-0xe9,-0x123,-0xb6,-0xfe),'ggRQq':function(_0xa7996b,_0x5de91c,_0x2bad31,_0x3f9b8b,_0x26e4b4){return _0xa7996b(_0x5de91c,_0x2bad31,_0x3f9b8b,_0x26e4b4);}};if(_0x2b2205[_0x35b109(-0x168,-0x190,-0x14e,-0x194)](typeof _0x5dbd81,_0x4bcdb7(-0x161,-0x112,-0x146,-0x129))){if(_0x2b2205[_0x35b109(-0xd7,-0xee,-0x92,-0xc1)]!==_0x2b2205[_0x35b109(-0xd7,-0xd8,-0xb5,-0xb2)]){const _0xf02ccf={};return _0xf02ccf[_0x35b109(-0xe7,-0xea,-0xed,-0x131)+'e']=_0x5291ae,_0xf02ccf[_0x35b109(-0xed,-0xd7,-0xa2,-0xe9)+'a']=_0x406583,_0x2b2205['AoDcG'](_0x425288,_0xf02ccf);}else{if(_0x215e9a&&_0x5dbd81['includes'](_0x5a8968)){if(_0x3164b2){if(_0x2b2205['ZzLiK'](_0x2b2205[_0x4bcdb7(-0x189,-0x189,-0x148,-0x146)],'XLWZm'))_0x3164b2['add'](_0x5a8968);else{const _0x1edcb4=_0xaf3a31[_0x4bcdb7(-0x1b5,-0x1c8,-0x16c,-0x1c9)]();return _0x2b2205[_0x35b109(-0x135,-0x142,-0x17f,-0x178)](_0x47fe48,_0x1edcb4,_0x47a074),_0x1e810d&&_0x5c26b3[_0x4bcdb7(-0x181,-0x1ce,-0x17b,-0x13d)](_0x35b109(-0x15e,-0x12e,-0x195,-0x117)+_0x4bcdb7(-0x18a,-0x140,-0x180,-0x19a)+_0x1edcb4+'@}'),'';}}}return _0x5dbd81['replaceAll'](_0x5a8968,_0x215e9a||'');}}if(Array['isArray'](_0x5dbd81))return _0x5dbd81['map'](_0x5b8958=>replacePlaceholder(_0x5b8958,_0x5a8968,_0x215e9a,_0x3164b2));function _0x4bcdb7(_0x54b4fa,_0x5736e6,_0x36470a,_0x390b8e){return _0x3f58(_0x54b4fa- -0x2ee,_0x5736e6);}function _0x35b109(_0x2c6784,_0x5d690b,_0x133465,_0x1596c2){return _0x3f58(_0x2c6784- -0x28a,_0x133465);}if(_0x5dbd81&&_0x2b2205[_0x35b109(-0x168,-0x19c,-0x154,-0x12c)](typeof _0x5dbd81,_0x2b2205[_0x4bcdb7(-0x1ad,-0x1d0,-0x1de,-0x177)])){const _0x51e264={};for(const _0x46267f in _0x5dbd81){if(_0x2b2205[_0x35b109(-0xec,-0xde,-0x9f,-0x11f)](_0x2b2205[_0x35b109(-0xeb,-0x97,-0x106,-0x121)],_0x35b109(-0x130,-0x151,-0x132,-0x163)))return _0x2ef7e0['map'](_0x5a0cff=>_0x42e374(_0x5a0cff,_0x46e692,_0x8923b3,_0x2b17ec));else _0x51e264[_0x46267f]=_0x2b2205[_0x4bcdb7(-0x16b,-0x185,-0x198,-0x135)](replacePlaceholder,_0x5dbd81[_0x46267f],_0x5a8968,_0x215e9a,_0x3164b2);}return _0x51e264;}return _0x5dbd81;}export function replaceAllPlaceholders(_0x17f4a3,_0x191250){const _0x5cd890={'njiyO':function(_0x4ba8c){return _0x4ba8c();},'WAZlW':'{{user}}','PKPxq':_0x122b8f(-0xd5,-0xba,-0x112,-0xb1),'MInUu':function(_0x15c2a3,_0x58169d,_0x25a348,_0x514603,_0x1f96d5){return _0x15c2a3(_0x58169d,_0x25a348,_0x514603,_0x1f96d5);},'wVyBK':_0x122b8f(-0xd9,-0xb6,-0x89,-0xc3),'QoWKr':function(_0x174044,_0x244103,_0x43ecba,_0x131e8f,_0x25fac1){return _0x174044(_0x244103,_0x43ecba,_0x131e8f,_0x25fac1);},'Ywawo':_0x122b8f(-0xd4,-0xf8,-0x11f,-0x109),'qgbJn':function(_0x57da4b,_0x46bb38,_0x59cfdb,_0x580e06,_0xf35c97){return _0x57da4b(_0x46bb38,_0x59cfdb,_0x580e06,_0xf35c97);},'Mcdvf':_0x595086(-0xf8,-0xc2,-0xe0,-0x12f),'fKUGJ':function(_0x189ee6,_0x3337df,_0x199f0c,_0x4ad983,_0x144252){return _0x189ee6(_0x3337df,_0x199f0c,_0x4ad983,_0x144252);},'jctNs':function(_0x247ea6,_0x1e35d9,_0x54c8a8,_0xe4f6ce,_0x425657){return _0x247ea6(_0x1e35d9,_0x54c8a8,_0xe4f6ce,_0x425657);},'ixQTR':'{{通用服装启用列表'+'}}','DCiTL':function(_0x5ba659,_0xed8471,_0x5d391f,_0x40e2aa,_0x53d225){return _0x5ba659(_0xed8471,_0x5d391f,_0x40e2aa,_0x53d225);},'nUFaz':_0x595086(-0x36,-0xd2,-0x86,-0xcb)+'}}','FCqin':function(_0x2f8e78,_0xc73baf,_0x5d1e2c,_0x2d1bcb,_0x3cc4a4){return _0x2f8e78(_0xc73baf,_0x5d1e2c,_0x2d1bcb,_0x3cc4a4);},'HmUtM':_0x122b8f(-0xbd,-0xa3,-0xd5,-0xd6),'TBRha':_0x595086(-0xb7,-0xbe,-0x8a,-0xb3),'MNVLX':function(_0x9081c4,_0x3a3bf1){return _0x9081c4!==_0x3a3bf1;},'SumXb':'qkxVe'},{context:context='',body:body='',worldBookContent:worldBookContent='',variables:variables={},userDemand:userDemand='',characterListText:characterListText='',outfitEnableListText:outfitEnableListText='',commonCharacterListText:commonCharacterListText=''}=_0x191250,_0x50f216=new Set();let _0x51cef7=_0x17f4a3;const _0x59554f=_0x5cd890['njiyO'](getContext),_0x36fdd3=_0x59554f?.[_0x122b8f(-0x9b,-0x67,-0xde,-0x6d)]||'';let _0x3f519e=worldBookContent;_0x3f519e&&(_0x3f519e=_0x3f519e[_0x122b8f(-0x5f,-0x28,-0x3a,-0x85)](_0x5cd890[_0x595086(-0x11f,-0xe6,-0xd7,-0xd6)],_0x36fdd3),_0x3f519e=_0x3f519e[_0x595086(-0xb4,-0x3c,-0x6f,-0xb7)](_0x5cd890['PKPxq'],_0x36fdd3));_0x51cef7=_0x5cd890[_0x595086(-0x102,-0xba,-0xb4,-0xae)](replacePlaceholder,_0x51cef7,_0x5cd890[_0x595086(-0x21,-0x1d,-0x67,-0x79)],context,_0x50f216),_0x51cef7=_0x5cd890['QoWKr'](replacePlaceholder,_0x51cef7,_0x5cd890[_0x595086(-0xa5,-0x85,-0xc1,-0xd7)],_0x3f519e,_0x50f216),_0x51cef7=_0x5cd890['qgbJn'](replacePlaceholder,_0x51cef7,_0x5cd890[_0x595086(-0xba,-0x73,-0xa6,-0xdf)],body,_0x50f216);function _0x122b8f(_0xe80af2,_0x51a28a,_0x3f370b,_0x49082c){return _0x3f58(_0xe80af2- -0x1ef,_0x3f370b);}_0x51cef7=_0x5cd890[_0x595086(-0x91,-0x22,-0x54,-0x5d)](replacePlaceholder,_0x51cef7,_0x595086(-0x116,-0x11f,-0xde,-0xd4),characterListText,_0x50f216),_0x51cef7=_0x5cd890['jctNs'](replacePlaceholder,_0x51cef7,_0x5cd890['ixQTR'],outfitEnableListText,_0x50f216),_0x51cef7=_0x5cd890[_0x122b8f(-0xa1,-0xdf,-0x6c,-0x82)](replacePlaceholder,_0x51cef7,_0x5cd890['nUFaz'],commonCharacterListText,_0x50f216),_0x51cef7=_0x5cd890[_0x122b8f(-0x72,-0x41,-0xa8,-0x48)](replacePlaceholder,_0x51cef7,_0x5cd890['HmUtM'],userDemand,_0x50f216);if(variables&&Object['keys'](variables)['length']>0x11e*0x5+-0x46a+-0x12c){if(_0x5cd890[_0x595086(-0x9b,-0x76,-0xc7,-0xf8)]!==_0x5cd890[_0x122b8f(-0xb7,-0xf0,-0x74,-0x67)])_0x1b700f[_0x122b8f(-0x82,-0xc8,-0xb0,-0xaa)](_0x122b8f(-0xca,-0xf7,-0x116,-0xf0)+_0x595086(-0xd3,-0xb0,-0x9b,-0xd8)+_0x37198e+'@}');else{const _0x46fcdc=/\{\{getvar::([^}]+)\}\}/g,_0x155070=JSON[_0x595086(-0xaf,-0xea,-0xce,-0xcb)](_0x51cef7),_0x201dd9=[..._0x155070[_0x595086(-0xf9,-0x10c,-0xd0,-0x9b)](_0x46fcdc)],_0x59a3f6=new Set();for(const _0x5351c7 of _0x201dd9){if(_0x5cd890['MNVLX'](_0x5cd890[_0x122b8f(-0x53,-0x8b,-0x95,-0x9)],_0x5cd890[_0x595086(-0x4c,-0x31,-0x63,-0x33)])){const _0x30983f=_0x2218e9[_0x122b8f(-0xb6,-0x6f,-0xd7,-0xd6)]();return _0x35aaa9['chatMetada'+'ta'][_0x122b8f(-0xbb,-0x8c,-0xc2,-0x9c)][_0x30983f]=_0x4ed3d0,_0x143674&&_0x4f25ee[_0x595086(-0x79,-0x3f,-0x92,-0x73)]('{@setvar::'+_0x30983f+'@}'),'';}else _0x59a3f6[_0x122b8f(-0x82,-0x6b,-0xc5,-0x68)](_0x5351c7[0xa3a+-0x3a6+-0x693]);}for(const _0x55a82b of _0x59a3f6){const _0x55e2dd=_0x122b8f(-0xb2,-0xdd,-0x94,-0xbc)+_0x55a82b+'}}',_0x5925c0=variables[_0x55a82b]||'';_0x51cef7=replacePlaceholder(_0x51cef7,_0x55e2dd,_0x5925c0,_0x50f216);}}}_0x51cef7=processVariablePlaceholdersInMessages(_0x51cef7,_0x50f216);const _0x64f515={};_0x64f515[_0x122b8f(-0xc2,-0xd8,-0x7e,-0xf5)]=_0x51cef7;function _0x595086(_0x189d3f,_0x5f3b38,_0x3334e2,_0xb07744){return _0x3f58(_0x3334e2- -0x1ff,_0xb07744);}return _0x64f515['replacedVa'+_0x122b8f(-0xa5,-0xb3,-0xbe,-0xd7)]=_0x50f216,_0x64f515;}function processVariablePlaceholdersInMessages(_0x1534a6,_0x4d738a){const _0x27230b={'TZURr':_0x5f3b11(0x70,0x7d,0x3d,0x68)+'+$','ERVYq':function(_0x59a68a,_0x3d8a43,_0x15e847,_0x453db8){return _0x59a68a(_0x3d8a43,_0x15e847,_0x453db8);},'TyIJF':function(_0xa2bb6){return _0xa2bb6();},'xNVoE':function(_0x350f50,_0x7759ed){return _0x350f50===_0x7759ed;},'tKkZN':_0x286963(0x550,0x50c,0x4ab,0x4ff),'ZduPg':_0x5f3b11(0xe3,0x92,0x75,0xa8),'vSafY':function(_0x5e1fc8,_0x5a8d78){return _0x5e1fc8!==_0x5a8d78;},'COQUY':_0x5f3b11(0x9d,0xde,0x10a,0x118)};if(!_0x1534a6||_0x1534a6[_0x5f3b11(0xf7,0xc1,0xaa,0x78)]===0x6fb*-0x1+-0x1*-0xc74+-0x579)return _0x1534a6;function _0x286963(_0x350ee8,_0xdafe4c,_0x5815e2,_0xa9e443){return _0x3f58(_0xa9e443-0x373,_0x350ee8);}const _0x147920=_0x27230b['TyIJF'](getContext);if(!_0x147920['chatMetada'+'ta']){if(_0x27230b[_0x5f3b11(0xd8,0x101,0x11d,0xfc)](_0x27230b['tKkZN'],_0x27230b[_0x286963(0x51e,0x4ef,0x4fd,0x4e4)])){const _0x56a312={};_0x56a312[_0x5f3b11(0xdc,0xfa,0x11f,0x149)]=_0x5f3b11(0x67,0x71,0x79,0xb2),_0x56a312['content']=_0x347507[_0x286963(0x451,0x49a,0x483,0x497)],_0x3c5d12[_0x286963(0x460,0x4b6,0x480,0x49e)](_0x56a312);}else _0x147920[_0x5f3b11(0xe0,0xbf,0xff,0xcf)+'ta']={};}if(!_0x147920[_0x286963(0x510,0x530,0x4ca,0x4e5)+'ta'][_0x286963(0x4f6,0x4b1,0x4cb,0x4a7)]){if(_0x27230b['vSafY'](_0x27230b['COQUY'],_0x27230b['COQUY']))return _0x3fe624['toString']()[_0x5f3b11(0x93,0xcd,0x116,0x107)](lmXuJG[_0x5f3b11(0x105,0xe7,0xaa,0xde)])[_0x286963(0x533,0x4d5,0x517,0x4e1)]()['constructo'+'r'](_0x256b06)[_0x286963(0x4e0,0x537,0x4ab,0x4f3)](lmXuJG[_0x286963(0x51a,0x514,0x52e,0x50d)]);else _0x147920['chatMetada'+'ta']['variables']={};}function _0x5f3b11(_0x23b9a4,_0x5b9ef8,_0x4f6c73,_0x2059ce){return _0x3f58(_0x5b9ef8- -0xb3,_0x2059ce);}return _0x1534a6['map'](_0x3b85c5=>{if(!_0x3b85c5||!_0x3b85c5[_0x288223(-0xb8,-0xb2,-0xbe,-0xbc)])return _0x3b85c5;function _0x288223(_0x3c4b50,_0x1dd740,_0x3a8547,_0x530fe6){return _0x5f3b11(_0x3c4b50-0x1cd,_0x530fe6- -0x18a,_0x3a8547-0x1e5,_0x3a8547);}return{..._0x3b85c5,'content':_0x27230b['ERVYq'](processContentVariables,_0x3b85c5['content'],_0x147920,_0x4d738a)};});}function processContentVariables(_0x47b3bf,_0x294243,_0x26429e){const _0x1cfb0={'MrYqx':function(_0x2d0ef3,_0xf4e09d,_0x19b0a1,_0x21b6c1){return _0x2d0ef3(_0xf4e09d,_0x19b0a1,_0x21b6c1);},'sHdAI':function(_0x2ee4c3,_0x51d41c){return _0x2ee4c3===_0x51d41c;},'YTOUn':_0x4b8e69(0x50f,0x49c,0x4fd,0x4c3),'xnYAp':function(_0x20b643,_0x3e9528,_0x1229eb,_0x364726){return _0x20b643(_0x3e9528,_0x1229eb,_0x364726);},'IWSwf':'text','fVvVc':function(_0x134ab4,_0x4d2759){return _0x134ab4===_0x4d2759;},'MeEvg':function(_0x574b97,_0x3858ca){return _0x574b97!==_0x3858ca;},'YNkjF':_0x37e688(-0x1d9,-0x1b7,-0x200,-0x1cc),'GVavb':'TQAJC','PpkqT':'YPuHV','CyBMT':_0x37e688(-0x209,-0x1c4,-0x21c,-0x227)};function _0x37e688(_0x1326ed,_0x4f95e4,_0x5ced90,_0x44ab81){return _0x3f58(_0x1326ed- -0x35f,_0x4f95e4);}function _0x4b8e69(_0x17ec46,_0xf6b7ab,_0x2316b6,_0x800479){return _0x3f58(_0x800479-0x336,_0x17ec46);}if(typeof _0x47b3bf===_0x4b8e69(0x4fd,0x50a,0x517,0x4c3))return _0x1cfb0[_0x37e688(-0x22c,-0x21e,-0x250,-0x238)](_0x1cfb0[_0x37e688(-0x1a7,-0x1b4,-0x1d5,-0x175)],_0x1cfb0[_0x4b8e69(0x4ac,0x509,0x520,0x4ee)])?processStringVariables(_0x47b3bf,_0x294243,_0x26429e):_0x1cfb0['MrYqx'](_0x5b3438,_0x2c33e5,_0x25329d,_0x42bb44);if(Array[_0x37e688(-0x1d4,-0x210,-0x1df,-0x1cb)](_0x47b3bf))return _0x1cfb0['sHdAI'](_0x1cfb0['PpkqT'],_0x1cfb0['CyBMT'])?_0x20cd00[_0x37e688(-0x1c4,-0x18e,-0x215,-0x1a6)](_0x55ea43=>{function _0x32a01a(_0x30d459,_0x3c2109,_0x16d500,_0x48120a){return _0x37e688(_0x30d459-0x627,_0x3c2109,_0x16d500-0x18c,_0x48120a-0x17e);}if(_0x55ea43&&_0x1cfb0[_0x32a01a(0x3fb,0x444,0x3af,0x3dd)](_0x55ea43[_0x32a01a(0x46a,0x49f,0x468,0x464)],_0x32a01a(0x40b,0x43b,0x415,0x41a))&&typeof _0x55ea43[_0x351d84(0x504,0x4f8,0x4fa,0x53a)]===_0x1cfb0[_0x351d84(0x4fb,0x4be,0x545,0x4f1)])return{..._0x55ea43,'text':_0x1cfb0[_0x351d84(0x50d,0x528,0x54c,0x4da)](_0xf2beff,_0x55ea43[_0x351d84(0x504,0x4e9,0x4ce,0x513)],_0x8b36b1,_0xa910b7)};function _0x351d84(_0x5ceff7,_0x3f22e2,_0x2d4cf7,_0x9b9e0a){return _0x4b8e69(_0x3f22e2,_0x3f22e2-0x9f,_0x2d4cf7-0x109,_0x5ceff7-0x8b);}return _0x55ea43;}):_0x47b3bf[_0x37e688(-0x1c4,-0x1e1,-0x1e6,-0x177)](_0x5d1cf4=>{function _0x26710e(_0x21366e,_0x3a0a2d,_0x32df22,_0x216d53){return _0x37e688(_0x21366e-0x465,_0x3a0a2d,_0x32df22-0x81,_0x216d53-0x22);}function _0x290a33(_0x21cf37,_0x58b601,_0x1e5151,_0x1f95fb){return _0x4b8e69(_0x1e5151,_0x58b601-0x1d,_0x1e5151-0x19a,_0x21cf37- -0x229);}if(_0x5d1cf4&&_0x1cfb0['sHdAI'](_0x5d1cf4['type'],_0x1cfb0[_0x26710e(0x2c0,0x2f6,0x291,0x2f4)])&&_0x1cfb0[_0x26710e(0x21e,0x233,0x22d,0x23b)](typeof _0x5d1cf4[_0x26710e(0x249,0x203,0x206,0x25b)],_0x1cfb0[_0x26710e(0x240,0x275,0x28b,0x255)])){if(_0x1cfb0[_0x26710e(0x28f,0x2a9,0x2d7,0x2c0)](_0x1cfb0[_0x26710e(0x229,0x210,0x1ed,0x214)],_0x26710e(0x25e,0x233,0x252,0x265)))return{..._0x5d1cf4,'text':processStringVariables(_0x5d1cf4['text'],_0x294243,_0x26429e)};else _0x546a3d[_0x290a33(0x27f,0x22b,0x25c,0x247)+'ta']['variables']={};}return _0x5d1cf4;});return _0x47b3bf;}function processStringVariables(_0x3adb40,_0x5c7b30,_0x424dbf){const _0x2f4934={'Ppmlc':_0x3eb6ad(0x6d,0x9b,0x87,0x89),'nGSHx':'user','qgbjl':_0xf2b052(0xfe,0x100,0xe0,0x123),'qOMxm':'bWcJD','KJXGw':function(_0x9b728b,_0x2c5d24){return _0x9b728b===_0x2c5d24;},'daVoo':_0xf2b052(0x11e,0x124,0x16e,0xfb),'oHjfN':_0x3eb6ad(0xb1,0x52,0x98,0x8a),'nFnVj':function(_0xa0db0c,_0x149a51,_0x4d4dee){return _0xa0db0c(_0x149a51,_0x4d4dee);},'YINFY':function(_0x5f322c,_0x4e839c){return _0x5f322c(_0x4e839c);},'UuepK':function(_0x1292e8,_0x16e509){return _0x1292e8===_0x16e509;},'XFqZB':_0x3eb6ad(0x5e,0x86,0xfb,0xa7),'BeoXE':function(_0x2004de,_0x26fc0d,_0x28f6a6,_0x2cc422,_0xee3e38){return _0x2004de(_0x26fc0d,_0x28f6a6,_0x2cc422,_0xee3e38);},'qCojq':function(_0x40afef,_0x42a65c){return _0x40afef===_0x42a65c;},'AyvnQ':'GDlUc'};if(!_0x3adb40)return _0x3adb40;function _0x3eb6ad(_0x375161,_0xbe1fd7,_0x56ea07,_0x37d284){return _0x3f58(_0x37d284- -0xdd,_0x375161);}let _0x1b3ef3=_0x3adb40;function _0xf2b052(_0x577c50,_0xd10989,_0x10b0cb,_0x11bab5){return _0x3f58(_0x577c50- -0x45,_0x10b0cb);}return _0x1b3ef3=_0x1b3ef3['replace'](/\{@setvar::([^:@]+)::([\s\S]*?)@\}/g,(_0x35e33b,_0x4c2612,_0x10615f)=>{function _0x5bd235(_0x126970,_0x45dc68,_0x21c634,_0x457123){return _0x3eb6ad(_0x45dc68,_0x45dc68-0xc1,_0x21c634-0xf5,_0x21c634-0x14a);}const _0x560d5d=_0x4c2612['trim']();function _0x4a0058(_0x39f529,_0x4556de,_0x38d84f,_0x4c9563){return _0xf2b052(_0x4c9563- -0x1c5,_0x4556de-0xfa,_0x39f529,_0x4c9563-0x55);}return _0x5c7b30[_0x4a0058(-0xc2,-0x64,-0xaa,-0x98)+'ta'][_0x5bd235(0x1d8,0x1f4,0x1a1,0x1d7)][_0x560d5d]=_0x10615f,_0x424dbf&&(_0x2f4934[_0x5bd235(0x179,0x1f1,0x1c8,0x1dd)]===_0x2f4934[_0x4a0058(-0xb3,-0x7f,-0xdb,-0xaf)]?_0x424dbf[_0x5bd235(0x1a9,0x1b2,0x1da,0x22d)](_0x4a0058(-0x125,-0x104,-0x101,-0xf6)+_0x560d5d+'@}'):_0x3e4064&&_0xc8597a[_0x4a0058(-0xa0,-0xa5,-0x55,-0x9d)](_0x4aaa9d)),'';}),_0x1b3ef3=_0x1b3ef3[_0x3eb6ad(0xcb,0x86,0x92,0x7a)](/\{@getvar::([^@]+)@\}/g,(_0x3de4da,_0x5bc1d2)=>{const _0x4db488={};function _0x18e4fe(_0x8c9a91,_0x2d71f4,_0xd5cb83,_0x37a88e){return _0xf2b052(_0x8c9a91-0x31c,_0x2d71f4-0x105,_0xd5cb83,_0x37a88e-0x1e8);}function _0x4d2383(_0x2bb870,_0x23f706,_0x2f4c42,_0x46f36f){return _0x3eb6ad(_0x2bb870,_0x23f706-0x10,_0x2f4c42-0x45,_0x2f4c42-0x1f6);}_0x4db488[_0x4d2383(0x2cf,0x2b2,0x2c9,0x305)]=function(_0x1c6bd8,_0x1d3777){return _0x1c6bd8===_0x1d3777;},_0x4db488[_0x18e4fe(0x420,0x417,0x42d,0x3cf)]=_0x2f4934['qgbjl'],_0x4db488[_0x18e4fe(0x41f,0x43b,0x43f,0x41c)]=function(_0x51bf6b,_0x4e2b79){return _0x51bf6b===_0x4e2b79;};const _0x1fd55e=_0x4db488;if(_0x4d2383(0x320,0x2c1,0x2d2,0x2b7)!==_0x2f4934[_0x18e4fe(0x3fe,0x44f,0x44e,0x3c4)]){const _0x50c2ca=_0x5bc1d2[_0x4d2383(0x26d,0x27c,0x252,0x280)](),_0x1c755f=_0x5c7b30[_0x4d2383(0x270,0x299,0x28b,0x257)+'ta'][_0x18e4fe(0x40b,0x3bf,0x3e6,0x3fc)][_0x50c2ca]||'';if(_0x424dbf){if(_0x2f4934['KJXGw'](_0x2f4934[_0x18e4fe(0x456,0x4a3,0x407,0x41f)],_0x2f4934[_0x4d2383(0x255,0x2cd,0x295,0x29f)])){if(_0xc02107[_0x18e4fe(0x3fb,0x410,0x3b8,0x3ec)]&&_0x2fa43c['user']['trim']()!==''){const _0x396371={};_0x396371[_0x18e4fe(0x484,0x476,0x456,0x4c0)]=_0x2f4934['nGSHx'],_0x396371[_0x18e4fe(0x458,0x46e,0x444,0x445)]=_0x3f5966['user'],_0x5ea07e[_0x4d2383(0x295,0x288,0x244,0x211)](_0x396371);}if(_0xc66a5e['assistant']&&_0x27d215[_0x4d2383(0x2c1,0x27c,0x2cf,0x2a7)][_0x18e4fe(0x410,0x3c8,0x41d,0x3d7)]()!==''){const _0x42509f={};_0x42509f[_0x18e4fe(0x484,0x450,0x4a7,0x4b6)]=_0x4d2383(0x2ef,0x2b8,0x2cf,0x303),_0x42509f[_0x18e4fe(0x458,0x40e,0x443,0x486)]=_0x1772b4['assistant'],_0xfb578[_0x4d2383(0x285,0x264,0x244,0x276)](_0x42509f);}}else _0x424dbf['add'](_0x18e4fe(0x485,0x488,0x441,0x473)+_0x50c2ca+'@}');}return _0x1c755f;}else{if(_0x549823&&_0x1fd55e['HMXgw'](_0x545f42[_0x18e4fe(0x479,0x42e,0x4b8,0x470)],_0x1fd55e[_0x18e4fe(0x420,0x3e0,0x469,0x40d)])&&_0x1fd55e[_0x4d2383(0x270,0x28d,0x261,0x24b)](typeof _0x4fa0c5[_0x18e4fe(0x41a,0x420,0x455,0x443)],_0x4d2383(0x2b4,0x25d,0x2a6,0x2eb)))return{..._0x4e479f,'text':_0x6e78cf(_0x311d05[_0x4d2383(0x216,0x295,0x25c,0x26c)],_0x35c829,_0x2b7b80)};return _0x59db79;}}),_0x1b3ef3=_0x1b3ef3[_0xf2b052(0x112,0x14d,0xc4,0x122)](/\{@setglobalvar::([^:@]+)::([\s\S]*?)@\}/g,(_0x2b7e06,_0x3200bf,_0x51e7da)=>{const _0x398f16=_0x3200bf[_0x44bddb(0x3b4,0x356,0x368,0x35e)]();function _0x44bddb(_0x1c0e50,_0x2f19ac,_0x6aaf76,_0x2b637b){return _0x3eb6ad(_0x2b637b,_0x2f19ac-0xda,_0x6aaf76-0x1e6,_0x6aaf76-0x30c);}_0x2f4934['nFnVj'](setglobalvar,_0x398f16,_0x51e7da);_0x424dbf&&_0x424dbf[_0x44bddb(0x389,0x3a6,0x39c,0x3c0)](_0x44bddb(0x389,0x343,0x35b,0x343)+_0x44bddb(0x3aa,0x3cc,0x393,0x358)+_0x398f16+'@}');function _0x39e8a3(_0x5061cf,_0x594cdc,_0x39a468,_0x18529c){return _0x3eb6ad(_0x18529c,_0x594cdc-0x16,_0x39a468-0x11d,_0x5061cf-0xe0);}return'';}),_0x1b3ef3=_0x1b3ef3[_0x3eb6ad(0x29,0x6f,0x4b,0x7a)](/\{@getglobalvar::([^@]+)@\}/g,(_0xb2ce55,_0x3fc3dc)=>{function _0x2feada(_0xc679fa,_0x282c42,_0x5e835e,_0x1da439){return _0x3eb6ad(_0x5e835e,_0x282c42-0x66,_0x5e835e-0x125,_0x282c42-0x30b);}const _0x5ab455=_0x3fc3dc[_0x2feada(0x313,0x367,0x38c,0x322)]();function _0xfdb851(_0x3fdea9,_0x4e12e5,_0xe0993,_0x3f9859){return _0x3eb6ad(_0xe0993,_0x4e12e5-0x84,_0xe0993-0x1ba,_0x4e12e5- -0x11);}const _0x420d4a=_0x2f4934[_0x2feada(0x408,0x3e9,0x432,0x404)](getglobalvar,_0x5ab455)||'';if(_0x424dbf){if(_0x2f4934['UuepK'](_0x2f4934[_0x2feada(0x345,0x364,0x321,0x3b1)],_0x2f4934[_0x2feada(0x3a6,0x364,0x3a3,0x37a)]))_0x424dbf[_0xfdb851(0x7b,0x7f,0xb8,0xa2)](_0x2feada(0x348,0x353,0x366,0x34e)+_0xfdb851(0x53,0x76,0xa7,0x9f)+_0x5ab455+'@}');else{const _0x1b47f6={..._0x4ef090};_0x3900cb=_0x1b47f6;}}return _0x420d4a;}),_0x1b3ef3=_0x1b3ef3['replace'](/\{@getworldvar::([^@]+)@\}/g,(_0x1429ed,_0x2fc597)=>{function _0x1701ce(_0x3c6d2f,_0x52f730,_0x87a1c5,_0x38c313){return _0x3eb6ad(_0x38c313,_0x52f730-0x143,_0x87a1c5-0x17b,_0x87a1c5- -0x11e);}function _0x2e52f8(_0xd0da1e,_0x6a8cae,_0x1affc1,_0xc24a4e){return _0x3eb6ad(_0x6a8cae,_0x6a8cae-0x1f4,_0x1affc1-0x10f,_0xc24a4e- -0x54);}if(_0x2f4934[_0x2e52f8(0x40,0x89,-0x3,0x45)](_0x2f4934[_0x1701ce(-0x27,-0x54,-0x4c,-0x17)],_0x2f4934[_0x1701ce(-0x89,-0x50,-0x4c,-0x82)])){const _0x313ecd=_0x2fc597[_0x2e52f8(-0x38,0x40,-0xc,0x8)](),_0x5a0e2b=_0x2f4934[_0x2e52f8(0xa1,0xcf,0xad,0x8a)](getworldvar,_0x313ecd)||'';return _0x424dbf&&_0x424dbf[_0x1701ce(-0x6c,-0x4e,-0x8e,-0xb5)](_0x2e52f8(0xa,-0x33,-0x2b,-0x3)+'var::'+_0x313ecd+'@}'),_0x5a0e2b;}else{const _0x1ad7e5={};for(const _0x1a9dd0 in _0x1c7e94){_0x1ad7e5[_0x1a9dd0]=_0x2f4934['BeoXE'](_0x438bda,_0x36173c[_0x1a9dd0],_0x1be054,_0x388f05,_0x427616);}return _0x1ad7e5;}}),_0x1b3ef3;}function _0x51d5(){const _0x15bc9b=['DxnLCG','E0bNzxrNBg9Iyq','B1nwA2S','Cu9nEg0','v0fABfC','AgLZDg9YEq','svLgALC','ChvZAa','E0bZzxrNBg9Iyq','BwvZC2fNzxm','E0bNzxr3B3jSza','Bwf0y2HbBgW','kcGOlISPkYKRkq','C3rYAw5NAwz5','E3VNLkJMIlFPNidMSyj9Fq','C0HKquK','DMfYAwfIBgvZ','mJmXndrzsvjyDwG','wezXwKi','y29UDgv4Df9WCG','vejsAge','DhjPBq','wvrpvw4','mtHnENnTqu8','AM9PBG','E3TNzxr2yxi6oG','wxDHD28','twz2rgK','A2v5CW','sNzuC3u','ota4nty2BK5Orw5n','Dgv4Da','CvnHtvC','ufbPrNa','zhr5vKq','B2jQzwn0','Dg10vfO','ALjoA0O','CMLHyMXLCW','tuLUvxu','Eg5zqxa','mJa3nJGWmhrdrwLNrq','renPveW','yxbWBhK','DfreD24','r3fvDM8','vgzmt1y','D25RAfO','BMfTzte','t09Arg0','ugnhz2u','CMvWBgfJzq','zM5NvwS','twnKDMy','rLDODM8','uhbTBgm','CwXgBuK','zMf3vvi','B2zPBgu','weXxwM0','nJu0nuzOEK1dDG','z1r6ru4','qvPOBKm','Bgrvrwu','BhzHCJO6','DMzzswe','zNriwhG','qMviBvm','CeL5quq','zK9uCMC','sefyvfq','Bu5PtgO','DgvZDf9JB250zq','ywrK','Dg9tDhjPBMC','D1nPrxq','mJiWmJyZnKLIrerjrq','wMr1ugC','y2HHDe1LDgfKyq','sfj4zw8','BgvUz3rO','Bg1yq08','CunVANe','zw5HyMXLza','y29UC3rYDwn0BW','E3VPGjRNLkJOP5lOIBlLKk/NLkJLIjFOOAG','Aw5JBhvKzxm','CwTpsxG','B0HQzK4','rKnXAw4','wMXjCwK','zgfwB28','C2vHCMnO','y29UDgvUDa','mJrht1bgzeS','z2Dsuxe','s1PYAgO','mKjUy2rsDG','B1DKzeC','mZiZoda0mtnZtw5dvKm','DvnitNC','twvfDMC','re5eCw4','AxnbCNjHEq','BKDvv0G','C3rYAw5N','CvjfEKy','vufxA1q','CMvWBgfJzufSBa','zffZuMC','zMLNCW','BKHxu0O','yxrWy20','De5PzuC','q05fDg0','yK1OAuq','D1z5qKS','v1zRwK8','vfPvuNi','BwfW','u3vTwgi','y29UDgv4DerHDa','wNPmAuS','D1DcBhi','nMvHzKPzCW','Dgzzuwy','DhLWzq','CMvXDwvZDfr5Ca','DhjPz2DLCG','tKLptvO','B3biu1C','AMH5zNK','uMjoshm','sezWtKq','zwzeD2K','zKTvr0O','DMfYoJO','CM9Szq','E0bNzxr2yxi6oG','qxL2BLe','se1yz3C','rMXku2y','CNvjvfi','ugftEMe','Ee5wB0u','mta5mdK2nZrhEvrTueq','yxnZAxn0yw50','shLOtLO','r1zHDMi','werKuNO','svDtD2y','wuLorLK','E0bZzxr2yxi6oG','AvvdrMW','E3VKUiRKUiVMLOD9Fq','mty2mdb6z0LSre0','zLz2vMm','wNbpq0m','phvZzxi+','E3VKUjBNLyZKUABOP6BLJ5f9Fq','yMr5yNG','BgXTx3jLCxvLCW','mtaYmNrhwNjgBW','E3VMRApMLOD9Fq','zMLSDgvY','E3VOP5lOIBlLKk/NLkJLIjFOOAH9Fq','wxfqv2y','wu5RAKy'];_0x51d5=function(){return _0x15bc9b;};return _0x51d5();}export function buildPromptWithTrigger(_0x576cd5){function _0x5a80f1(_0xc6927a,_0x41c0bf,_0x41b2e8,_0x1dd693){return _0x3f58(_0x41c0bf- -0x3c5,_0xc6927a);}const _0x1343c4={'gTzEN':_0x3cfb5b(-0x115,-0x132,-0xc7,-0x15d),'wSiEt':function(_0x727918,_0x269ff5){return _0x727918||_0x269ff5;},'KglJv':function(_0x4216af,_0xe633d2){return _0x4216af===_0xe633d2;},'efDwi':_0x5a80f1(-0x271,-0x221,-0x23b,-0x229),'pIyAD':function(_0x3b8f74,_0x44678f,_0x369dd9){return _0x3b8f74(_0x44678f,_0x369dd9);},'CNEtm':'relah','XdvNW':function(_0x26b809,_0x476551){return _0x26b809!==_0x476551;},'ZpOCC':_0x5a80f1(-0x23d,-0x23d,-0x252,-0x258),'qlFmI':function(_0x1a0ba9,_0x1f5050){return _0x1a0ba9!==_0x1f5050;},'tUhjT':'user','HyhNZ':function(_0x36c5e6,_0x4ade83){return _0x36c5e6!==_0x4ade83;},'bMhiD':_0x3cfb5b(-0xa6,-0x8c,-0x5e,-0x58),'mBdoo':_0x5a80f1(-0x22b,-0x20f,-0x1dd,-0x1fb),'iUCFl':function(_0x28daf2,_0x470469){return _0x28daf2(_0x470469);}},{requestType:_0x3dc432,contextData:_0xaf3c92}=_0x576cd5,_0x4fc37f=extension_settings[extensionName]?.[_0x5a80f1(-0x2b7,-0x2a8,-0x2a9,-0x2fb)+'t_type_con'+_0x3cfb5b(-0xc6,-0xbd,-0xc5,-0xbd)]||{},_0x3e75ae={};function _0x3cfb5b(_0x7ee077,_0x5e620e,_0x58e877,_0x3f744e){return _0x3f58(_0x7ee077- -0x258,_0x5e620e);}_0x3e75ae['context_pr'+_0x3cfb5b(-0xfa,-0x12b,-0xd9,-0xca)]='默认';const _0x3f7990=_0x4fc37f[_0x3dc432]||_0x3e75ae,_0x4038af=_0x3f7990[_0x3cfb5b(-0x121,-0xe2,-0x168,-0xd8)+_0x3cfb5b(-0xfa,-0x14c,-0xea,-0xb4)]||'默认',_0x12ed14=extension_settings[extensionName]?.[_0x3cfb5b(-0xec,-0xe7,-0xc5,-0xee)+'xt_profile'+'s']||{},_0x2512c5=_0x12ed14[_0x4038af]||_0x12ed14[Object[_0x3cfb5b(-0x118,-0x156,-0x15c,-0x11f)](_0x12ed14)[-0x3eb+0xa2c+0x641*-0x1]]||{},{context:context='',body:body='',worldBookContent:worldBookContent='',userDemand:userDemand=''}=_0xaf3c92,_0x151a5b=[userDemand,context,body,worldBookContent][_0x5a80f1(-0x2b8,-0x2a5,-0x2a2,-0x2f2)](Boolean)[_0x5a80f1(-0x293,-0x289,-0x28c,-0x2dd)]('\x0a'),_0x1049d9=[];if(_0x2512c5['entries']&&Array[_0x3cfb5b(-0xcd,-0x97,-0x7b,-0x8f)](_0x2512c5['entries']))for(const _0x3fd1af of _0x2512c5['entries']){if(!_0x3fd1af[_0x5a80f1(-0x206,-0x24e,-0x22a,-0x285)])continue;if(!_0x3fd1af['content']||_0x1343c4['KglJv'](_0x3fd1af[_0x3cfb5b(-0xd7,-0x105,-0xff,-0xa6)][_0x5a80f1(-0x2d2,-0x28c,-0x242,-0x2a5)](),''))continue;if(_0x3fd1af['triggerMod'+'e']===_0x1343c4[_0x5a80f1(-0x1f1,-0x21b,-0x20d,-0x266)]){if(!_0x1343c4[_0x3cfb5b(-0xf0,-0x105,-0x13c,-0x138)](checkTriggerWords,_0x3fd1af['triggerWor'+'ds'],_0x151a5b))continue;}const _0x2d11e8={};_0x2d11e8[_0x5a80f1(-0x237,-0x218,-0x25f,-0x1cc)]=_0x3fd1af['role']||'user',_0x2d11e8['content']=_0x3fd1af[_0x5a80f1(-0x232,-0x244,-0x251,-0x216)],_0x1049d9[_0x3cfb5b(-0x12d,-0x146,-0x15a,-0x126)](_0x2d11e8);}else{if(_0x2512c5[_0x5a80f1(-0x280,-0x29c,-0x260,-0x29e)]&&Array[_0x5a80f1(-0x27f,-0x23a,-0x210,-0x26b)](_0x2512c5[_0x5a80f1(-0x28a,-0x29c,-0x290,-0x29b)])){if(_0x1343c4['CNEtm']===_0x1343c4[_0x5a80f1(-0x279,-0x22f,-0x216,-0x279)])for(const _0x2d9f43 of _0x2512c5['history']){if(_0x1343c4['XdvNW'](_0x1343c4[_0x3cfb5b(-0x13f,-0x164,-0x101,-0x12f)],'suGTa')){if(_0x2d9f43[_0x3cfb5b(-0x134,-0xeb,-0x136,-0xf9)]&&_0x1343c4[_0x3cfb5b(-0xfc,-0xcf,-0x111,-0xe0)](_0x2d9f43['user'][_0x5a80f1(-0x2ab,-0x28c,-0x2b2,-0x272)](),'')){const _0x3b36e3={};_0x3b36e3[_0x5a80f1(-0x267,-0x218,-0x23a,-0x265)]=_0x1343c4['tUhjT'],_0x3b36e3[_0x5a80f1(-0x263,-0x244,-0x247,-0x27f)]=_0x2d9f43[_0x5a80f1(-0x2a4,-0x2a1,-0x29d,-0x2a1)],_0x1049d9['push'](_0x3b36e3);}if(_0x2d9f43[_0x5a80f1(-0x1ca,-0x20f,-0x20a,-0x1cd)]&&_0x1343c4[_0x3cfb5b(-0xa1,-0x65,-0x5d,-0xed)](_0x2d9f43[_0x5a80f1(-0x20a,-0x20f,-0x255,-0x252)][_0x3cfb5b(-0x11f,-0xf4,-0x132,-0x155)](),'')){if(_0x1343c4['KglJv'](_0x1343c4[_0x3cfb5b(-0xc1,-0xa2,-0xc6,-0xe1)],_0x1343c4[_0x5a80f1(-0x24b,-0x22e,-0x209,-0x25a)])){const _0x3aef23={};_0x3aef23['role']=_0x1343c4['mBdoo'],_0x3aef23[_0x3cfb5b(-0xd7,-0xe6,-0xb8,-0xf2)]=_0x2d9f43[_0x5a80f1(-0x1d3,-0x20f,-0x1d3,-0x22c)],_0x1049d9['push'](_0x3aef23);}else _0x28d4a3[_0x5a80f1(-0x20a,-0x258,-0x261,-0x277)](_0x3cfb5b(-0x144,-0x192,-0x147,-0x10d)+_0x5227c6+'@}');}}else{if(_0x45928f['isArray'](_0x1b2be1))return _0x3a13d4;return[{'type':_0x1343c4[_0x3cfb5b(-0xf7,-0xc6,-0xe8,-0x142)],'text':_0x1343c4[_0x3cfb5b(-0xe9,-0xdd,-0xe1,-0xad)](_0x5e262f,'')}];}}else{const _0x2a739f=_0xf400ce?function(){function _0x47fca0(_0x2fe6b2,_0x109383,_0x38b3d4,_0x32d3c8){return _0x5a80f1(_0x32d3c8,_0x38b3d4-0x685,_0x38b3d4-0x13a,_0x32d3c8-0xbc);}if(_0x27bdf6){const _0x68bb28=_0x226955[_0x47fca0(0x3ca,0x419,0x40f,0x421)](_0xc7e08e,arguments);return _0x4c80f8=null,_0x68bb28;}}:function(){};return _0x1c34e0=![],_0x2a739f;}}}const _0x5e5ce0=_0x1343c4[_0x3cfb5b(-0x143,-0xf3,-0x107,-0x147)](mergeAdjacentMessages,_0x1049d9),{messages:_0xf0632f,replacedVariables:_0x2bafbb}=replaceAllPlaceholders(_0x5e5ce0,_0xaf3c92);return _0xf0632f;}export function getProcessedPrompt(_0x1dcef3,_0x336a55){const _0x5bf6c2={'HAXTT':function(_0x417e54,_0xd719c9){return _0x417e54(_0xd719c9);}},_0x15739d={};_0x15739d['requestTyp'+'e']=_0x1dcef3,_0x15739d['contextDat'+'a']=_0x336a55;function _0x934877(_0x1687e2,_0xa4a1e,_0x244ae3,_0x14c625){return _0x3f58(_0x1687e2-0x305,_0xa4a1e);}return _0x5bf6c2[_0x934877(0x46f,0x439,0x486,0x424)](buildPromptWithTrigger,_0x15739d);}