(function(_0x299878,_0x184b51){function _0x5a184b(_0x196255,_0x4c64e9,_0x2eae7f,_0x431b2a){return _0x4407(_0x2eae7f- -0x15f,_0x431b2a);}function _0x349f16(_0x43de67,_0x3ad15b,_0xacc27f,_0x21085a){return _0x4407(_0xacc27f-0x103,_0x21085a);}const _0x175fb6=_0x299878();while(!![]){try{const _0x10b1eb=parseInt(_0x349f16(0x2b3,0x2bc,0x2a3,0x2b1))/(0x1*0x1225+-0x7a*0x1f+-0x35e)+parseInt(_0x5a184b(-0x4,-0x2c,-0xe,-0x48))/(-0x1*-0x2333+0xc44*-0x2+-0xaa9*0x1)*(parseInt(_0x5a184b(0x7c,0x90,0x3a,0x4f))/(-0x989+0x1607+-0xc7b))+-parseInt(_0x5a184b(0xd,-0x2b,-0xf,-0x5b))/(0x10a9+0xbf7+-0x1c9c)+parseInt(_0x5a184b(0x47,-0x3e,-0xc,-0x9))/(0x19ee+-0xd7*-0x1f+-0xda*0x3d)*(parseInt(_0x349f16(0x1eb,0x261,0x21f,0x1ec))/(0x441+-0x1ee4+0xd*0x20d))+-parseInt(_0x349f16(0x24d,0x22b,0x26f,0x2cc))/(-0x11e3*-0x2+-0x22f2+-0xcd)+parseInt(_0x349f16(0x222,0x256,0x215,0x1be))/(-0xad*0x1d+0x99b+0xa06)+parseInt(_0x5a184b(-0x45,-0x71,-0x45,-0x5e))/(-0x774+-0x1d2*0xa+0x1*0x19b1)*(parseInt(_0x349f16(0x2ab,0x23b,0x287,0x267))/(-0x1210*-0x1+0x1*-0x1f3d+0xd37));if(_0x10b1eb===_0x184b51)break;else _0x175fb6['push'](_0x175fb6['shift']());}catch(_0x29d3c2){_0x175fb6['push'](_0x175fb6['shift']());}}}(_0x2abd,-0x9c04d*0x1+0x7*-0x13373+0x1a2d7a));const _0x17b2c6=(function(){const _0x26ac8f={};_0x26ac8f['XbDOL']=function(_0x20a920,_0x5e0ecc){return _0x20a920===_0x5e0ecc;},_0x26ac8f[_0x2c471c(0xaa,0x13e,0xcd,0xf6)]=_0x1f1b7e(0x2d0,0x2d6,0x298,0x2f8),_0x26ac8f[_0x1f1b7e(0x311,0x2da,0x2e4,0x2ca)]=_0x1f1b7e(0x310,0x309,0x2fa,0x2b7);function _0x2c471c(_0x4069aa,_0x543f0a,_0x7a14ab,_0x4971bd){return _0x4407(_0x4971bd- -0x74,_0x543f0a);}_0x26ac8f['rXQAa']=function(_0x937ef3,_0x2a23c2){return _0x937ef3!==_0x2a23c2;};function _0x1f1b7e(_0x1108d3,_0x125dd7,_0x446bc3,_0x4d9205){return _0x4407(_0x125dd7-0x1b7,_0x4d9205);}_0x26ac8f['hoPCN']=_0x1f1b7e(0x307,0x2c5,0x319,0x2f9),_0x26ac8f['DBrAG']=_0x1f1b7e(0x2fd,0x32b,0x374,0x347);const _0x2a7fd0=_0x26ac8f;let _0x5054a6=!![];return function(_0x2df20a,_0x220291){function _0x285c98(_0x57031f,_0x943f63,_0xb0d730,_0xea5b64){return _0x1f1b7e(_0x57031f-0x67,_0x57031f- -0x485,_0xb0d730-0x13,_0x943f63);}const _0x3b2355={'EjxuD':function(_0xfe7981,_0x27fadc){function _0x5f088e(_0x7336f7,_0x237d96,_0x37b2f8,_0x2283aa){return _0x4407(_0x237d96- -0x333,_0x37b2f8);}return _0x2a7fd0[_0x5f088e(-0x1fb,-0x229,-0x1ff,-0x1d5)](_0xfe7981,_0x27fadc);},'kpBZM':_0x2a7fd0['qUJHZ'],'ckLcW':_0x2a7fd0[_0x3e8bb7(0x2ce,0x2ac,0x271,0x2cb)]};function _0x3e8bb7(_0x548a29,_0x217f78,_0x816545,_0x31cd5b){return _0x2c471c(_0x548a29-0x8d,_0x548a29,_0x816545-0x52,_0x816545-0x1c2);}if(_0x2a7fd0[_0x3e8bb7(0x2ce,0x28b,0x2bf,0x317)](_0x2a7fd0[_0x285c98(-0x13b,-0x193,-0x129,-0x110)],_0x2a7fd0[_0x3e8bb7(0x2e4,0x338,0x2e9,0x308)])){const _0x53b2bc=_0x5054a6?function(){function _0x340fa4(_0x51aad5,_0x4af0a4,_0x988f8b,_0x5ba0a){return _0x3e8bb7(_0x4af0a4,_0x4af0a4-0x18b,_0x5ba0a- -0x1d9,_0x5ba0a-0x77);}function _0x326517(_0x517911,_0x13dd16,_0x21bbb3,_0xb5227a){return _0x3e8bb7(_0x21bbb3,_0x13dd16-0xb2,_0xb5227a- -0x2c5,_0xb5227a-0xc2);}if(_0x3b2355[_0x340fa4(0xda,0x11e,0xf7,0xd6)]==='IeNnB'){if(_0x32e38e){const _0x8c6245=_0x484cc6[_0x326517(0x19,-0xd,-0x25,0x38)](_0x3f81e3,arguments);return _0x48d9e5=null,_0x8c6245;}}else{if(_0x220291){if(_0x3b2355[_0x340fa4(0xae,0xe9,0xb2,0xfc)](_0x3b2355[_0x340fa4(0x103,0xa6,0x94,0xcf)],_0x3b2355[_0x340fa4(0x101,0xe3,0xe1,0xcf)])){const _0x23d689=_0x220291[_0x326517(0x4,0x11,0x72,0x38)](_0x2df20a,arguments);return _0x220291=null,_0x23d689;}else{if(!_0x4acc92||_0x3b2355['EjxuD'](_0x1d666f[_0x340fa4(0x13b,0xf7,0x92,0xe3)],0x2*-0x11dc+-0xd9*-0x5+-0x1*-0x1f7b))return _0xcbec3c;const _0x417e87=_0x35e70f();return!_0x417e87[_0x326517(-0x6f,-0x78,-0x1b,-0x45)+'ta']&&(_0x417e87[_0x326517(-0x53,-0x4d,-0x72,-0x45)+'ta']={}),!_0x417e87['chatMetada'+'ta']['variables']&&(_0x417e87['chatMetada'+'ta'][_0x326517(0x4a,0x85,0x20,0x42)]={}),_0x17fc84[_0x340fa4(0x7a,0x76,0xaa,0xa9)](_0x1d911a=>{if(!_0x1d911a||!_0x1d911a['content'])return _0x1d911a;return{..._0x1d911a,'content':_0x312911(_0x1d911a['content'],_0x417e87,_0x518f02)};});}}}}:function(){};return _0x5054a6=![],_0x53b2bc;}else{if(_0x57fd00[_0x3e8bb7(0x2a1,0x302,0x2b1,0x2e1)](_0x361966))return!![];}};}()),_0x533cf5=_0x17b2c6(this,function(){function _0x598149(_0x773e8a,_0x2c6815,_0x527a3a,_0x1201e8){return _0x4407(_0x773e8a- -0xd7,_0x527a3a);}function _0x312515(_0x4c5bef,_0x15ec44,_0x2530e6,_0x56457b){return _0x4407(_0x2530e6- -0x10c,_0x4c5bef);}return _0x533cf5[_0x598149(0xb4,0x96,0x89,0xc1)]()[_0x312515(0x75,0x29,0x71,0xc9)](_0x312515(0x69,0x56,0x42,-0x8)+'+$')[_0x598149(0xb4,0x87,0x74,0x5a)]()[_0x598149(0x46,-0xa,0x4c,0x55)+'r'](_0x533cf5)['search'](_0x312515(-0xa,0x1d,0x42,0x81)+'+$');});_0x533cf5();import{extension_settings}from'../../../../extensions.js';import{extensionName}from'./config.js';import{getContext}from'../../../../st-context.js';import{getglobalvar,setglobalvar}from'./chatDataUtils.js';import{getworldvar}from'./worldbookProcessor.js';export function checkTriggerWords(_0x1148a4,_0x5000a3){const _0x4a214e={};_0x4a214e['nWRGF']=function(_0x4cafd6,_0x42e3d0){return _0x4cafd6===_0x42e3d0;};function _0xa0c2e9(_0xc1cfda,_0x422c37,_0x2d9ae9,_0xea9a85){return _0x4407(_0xc1cfda-0x12,_0xea9a85);}function _0x592572(_0x4ad645,_0x5b33ef,_0x549f4f,_0x3b9aa3){return _0x4407(_0x5b33ef-0x2a0,_0x3b9aa3);}const _0x364ddf=_0x4a214e;if(!_0x1148a4||!_0x5000a3)return![];const _0x521c44=_0x1148a4['split'](',')[_0x592572(0x3f4,0x3d4,0x39c,0x3ff)](_0xa72da7=>_0xa72da7['trim']())[_0xa0c2e9(0x1b7,0x1f5,0x1dd,0x1b9)](_0x3d9083=>_0x3d9083);if(_0x364ddf[_0xa0c2e9(0x136,0x130,0x13f,0x18c)](_0x521c44[_0x592572(0x457,0x40e,0x3c1,0x3f3)],-0xa4c+0x11a7+-0x75b))return![];for(const _0x23eda0 of _0x521c44){if(_0x5000a3[_0x592572(0x40b,0x403,0x3ca,0x3f6)](_0x23eda0))return!![];}return![];}function _0x4407(_0xdbe8fc,_0x34dcde){_0xdbe8fc=_0xdbe8fc-(0x1ca5*0x1+-0x142a+-0x773);const _0x44c107=_0x2abd();let _0x55d506=_0x44c107[_0xdbe8fc];if(_0x4407['ZpicLh']===undefined){var _0x16b35d=function(_0x900069){const _0x56a2b0='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x9152f0='',_0x38f73e='',_0x1d8ec1=_0x9152f0+_0x16b35d;for(let _0x2d9373=0x10ab+0x2635+-0x36e0,_0x3fc1d7,_0x261269,_0x29f2d2=-0x1ec9+-0x20a1+-0x3f6a*-0x1;_0x261269=_0x900069['charAt'](_0x29f2d2++);~_0x261269&&(_0x3fc1d7=_0x2d9373%(-0x1*-0x979+0x217a*-0x1+-0x8f*-0x2b)?_0x3fc1d7*(0x224a+0x251e+-0x4728)+_0x261269:_0x261269,_0x2d9373++%(0x1e1d*0x1+0x1*-0xb87+-0x1292))?_0x9152f0+=_0x1d8ec1['charCodeAt'](_0x29f2d2+(0x2*-0x10da+0x29f+0x1f*0x101))-(0x149e+0x4*0x3ee+0x4*-0x913)!==-0xbd1+-0x227b+-0xb93*-0x4?String['fromCharCode'](0x6*0x5ee+0x245c+-0x46f1&_0x3fc1d7>>(-(-0x1076+-0x13+0x4d*0x37)*_0x2d9373&0x3ab+0x118*-0x10+0xddb)):_0x2d9373:0x8cc*-0x2+0xb*-0x10b+0x1d11){_0x261269=_0x56a2b0['indexOf'](_0x261269);}for(let _0x556e63=0x3*-0x119+-0x25ed+0x2938,_0x30ccdf=_0x9152f0['length'];_0x556e63<_0x30ccdf;_0x556e63++){_0x38f73e+='%'+('00'+_0x9152f0['charCodeAt'](_0x556e63)['toString'](-0x762+-0x1784+0xf7b*0x2))['slice'](-(-0x23ae*0x1+-0xb5*0x10+0x2f00));}return decodeURIComponent(_0x38f73e);};_0x4407['nzZcmD']=_0x16b35d,_0x4407['bdLfZX']={},_0x4407['ZpicLh']=!![];}const _0x225291=_0x44c107[-0xe*-0x278+0x19e1+0x1*-0x3c71],_0x389d7e=_0xdbe8fc+_0x225291,_0x2e1854=_0x4407['bdLfZX'][_0x389d7e];if(!_0x2e1854){const _0xaa61ae=function(_0x31d4c8){this['HJUZAg']=_0x31d4c8,this['QRAtFP']=[0x2*-0x931+0x9cd+0x44b*0x2,0x1*0xfeb+-0xa*0x4f+0x3*-0x447,-0x1161+0x1*0x18da+-0x779],this['XcfUQF']=function(){return'newState';},this['HSNrxn']='\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*',this['zHiTIw']='[\x27|\x22].+[\x27|\x22];?\x20*}';};_0xaa61ae['prototype']['UZdRbG']=function(){const _0x37b1c7=new RegExp(this['HSNrxn']+this['zHiTIw']),_0x194b29=_0x37b1c7['test'](this['XcfUQF']['toString']())?--this['QRAtFP'][-0x2*-0x3da+0xd2e+-0x14e1]:--this['QRAtFP'][-0x950+-0xe7d*-0x1+-0x52d];return this['NJsGha'](_0x194b29);},_0xaa61ae['prototype']['NJsGha']=function(_0x5af94b){if(!Boolean(~_0x5af94b))return _0x5af94b;return this['MXzqvE'](this['HJUZAg']);},_0xaa61ae['prototype']['MXzqvE']=function(_0x3b6f94){for(let _0xc56e82=-0x2*0x12fe+0x436+0x5a1*0x6,_0x1991c0=this['QRAtFP']['length'];_0xc56e82<_0x1991c0;_0xc56e82++){this['QRAtFP']['push'](Math['round'](Math['random']())),_0x1991c0=this['QRAtFP']['length'];}return _0x3b6f94(this['QRAtFP'][-0x237*-0x1+0xb*0x11+-0x2f2]);},new _0xaa61ae(_0x4407)['UZdRbG'](),_0x55d506=_0x4407['nzZcmD'](_0x55d506),_0x4407['bdLfZX'][_0x389d7e]=_0x55d506;}else _0x55d506=_0x2e1854;return _0x55d506;}export function mergeAdjacentMessages(_0x5ba9c8){const _0x9b3f77={'OMkLX':'assistant','mCaMQ':function(_0x5023cf,_0x4de549,_0x28dcf8,_0x3fd631){return _0x5023cf(_0x4de549,_0x28dcf8,_0x3fd631);},'tDSNy':function(_0x329d90,_0x18e39c,_0x3b2d3a,_0x5b34bb){return _0x329d90(_0x18e39c,_0x3b2d3a,_0x5b34bb);},'HbjFt':function(_0x4db94f,_0x5d0b45){return _0x4db94f===_0x5d0b45;},'ZhLEc':_0x7a345b(0x15b,0x18d,0x1b4,0x12f),'pJxmD':function(_0x3b1b92,_0x2b8fdc){return _0x3b1b92===_0x2b8fdc;},'NEJER':'mgclr','zMCPG':_0x19f8a0(0x1c1,0x192,0x17d,0x1a6),'jQMVC':function(_0xc3fbfe,_0x123f41){return _0xc3fbfe!==_0x123f41;},'cVuXh':'cJyBD','GgWEf':_0x7a345b(0x176,0x132,0xee,0x134),'MrJbN':'TXnTQ'};if(!_0x5ba9c8||_0x9b3f77[_0x19f8a0(0x149,0x133,0xda,0xfe)](_0x5ba9c8[_0x7a345b(0x180,0x188,0x135,0x176)],-0x109*-0x5+-0x16*-0xfe+-0x1f*0xdf)){if(_0x9b3f77[_0x7a345b(0x146,0x165,0x19d,0x1bc)](_0x9b3f77['ZhLEc'],_0x9b3f77[_0x7a345b(0x155,0x1ae,0x200,0x1c9)]))return[];else{const _0x3f0c65={};_0x3f0c65[_0x19f8a0(0xa4,0xf9,0xcb,0x132)]=_0x9b3f77[_0x19f8a0(0x124,0x157,0x10a,0x153)],_0x3f0c65[_0x7a345b(0xef,0x14a,0xfb,0x156)]=_0xf462a0[_0x19f8a0(0x176,0x17a,0x1ab,0x139)],_0xae0e8c[_0x7a345b(0x160,0x155,0x149,0x176)](_0x3f0c65);}}const _0x3fc5d6=[];function _0x7a345b(_0x4ca2f6,_0x420fd2,_0x49a9d4,_0x14cb87){return _0x4407(_0x420fd2-0x1a,_0x14cb87);}let _0x3bae19=null;for(const _0x34af0f of _0x5ba9c8){if(!_0x3bae19){if(_0x9b3f77[_0x19f8a0(0x1b9,0x1a7,0x1a9,0x1e2)](_0x9b3f77[_0x7a345b(0x176,0x14b,0x160,0xef)],_0x9b3f77[_0x19f8a0(0x13d,0x101,0xf9,0x15c)])){if(!_0x533078||!_0x3e248d[_0x7a345b(0x139,0x14a,0x15d,0x122)])return _0x32d4e9;return{..._0x2bd19d,'content':_0x9b3f77['mCaMQ'](_0x409195,_0x2eeb15['content'],_0x5130d1,_0xa7e6d2)};}else{const _0x4afa18={..._0x34af0f};_0x3bae19=_0x4afa18;}}else{if(_0x9b3f77[_0x7a345b(0x1b8,0x165,0x150,0x17b)](_0x3bae19[_0x19f8a0(0xb7,0xf9,0xe2,0xc9)],_0x34af0f[_0x7a345b(0x16a,0x12b,0x136,0xe6)]))_0x3bae19[_0x19f8a0(0x14f,0x118,0xed,0xcb)]=mergeContent(_0x3bae19[_0x7a345b(0x160,0x14a,0x14c,0x16b)],_0x34af0f[_0x7a345b(0x199,0x14a,0x156,0x15b)]);else{if(_0x9b3f77['jQMVC'](_0x9b3f77[_0x7a345b(0x1da,0x1bc,0x1cf,0x1d5)],_0x9b3f77[_0x19f8a0(0x100,0x145,0x18e,0x19e)])){_0x3fc5d6[_0x7a345b(0x139,0x155,0x154,0x12a)](_0x3bae19);const _0x3e1218={..._0x34af0f};_0x3bae19=_0x3e1218;}else _0x1a4629[_0x19f8a0(0x19f,0x169,0x13c,0x165)](_0x4822df[-0x1f7d+0x22db*0x1+-0x7*0x7b]);}}}function _0x19f8a0(_0x4eda89,_0x23d867,_0x541caf,_0x44b63c){return _0x4407(_0x23d867- -0x18,_0x44b63c);}if(_0x3bae19){if(_0x7a345b(0x14a,0x130,0x18c,0x12e)!==_0x9b3f77[_0x7a345b(0x1ec,0x190,0x178,0x140)])return{..._0x5a4876,'text':_0x9b3f77[_0x19f8a0(0x177,0x11b,0x13f,0x173)](_0x2f6cd4,_0x10ee92[_0x7a345b(0x129,0x185,0x198,0x186)],_0xf2dcbe,_0x2e1f77)};else _0x3fc5d6['push'](_0x3bae19);}return _0x3fc5d6;}function mergeContent(_0x12197d,_0x6b527b){const _0x381a8b={'ObFxA':function(_0x4cd21a,_0x128e8a){return _0x4cd21a===_0x128e8a;},'NHWaf':'string','bMlaj':function(_0x1e18b3,_0x162c3d){return _0x1e18b3+_0x162c3d;},'mkZFn':function(_0x40c2e1,_0x3f9ff8){return _0x40c2e1(_0x3f9ff8);},'rmunh':function(_0x4bd60e,_0x19d4af){return _0x4bd60e(_0x19d4af);}};function _0x86d4b5(_0x3a4e7b,_0x17f347,_0x2cc27d,_0x5242cc){return _0x4407(_0x3a4e7b- -0x1f9,_0x2cc27d);}if(_0x381a8b['ObFxA'](typeof _0x12197d,'string')&&_0x381a8b['ObFxA'](typeof _0x6b527b,_0x381a8b[_0x452739(-0x6e,-0x80,-0x9b,-0x8c)]))return _0x381a8b[_0x86d4b5(-0xd1,-0x11a,-0xac,-0x84)](_0x12197d+'\x0a',_0x6b527b);const _0x3aaaa5=_0x381a8b[_0x86d4b5(-0x68,-0xb5,-0x50,-0xb2)](normalizeToArray,_0x12197d),_0x2879a4=_0x381a8b[_0x86d4b5(-0xcc,-0xa8,-0xa5,-0xfb)](normalizeToArray,_0x6b527b);function _0x452739(_0x19c606,_0x5d965b,_0x55f611,_0x19581d){return _0x4407(_0x19c606- -0x1fa,_0x55f611);}const _0x2927c5={};return _0x2927c5[_0x452739(-0x7a,-0xbc,-0xa8,-0xab)]=_0x86d4b5(-0x8e,-0xd0,-0xb9,-0x4b),_0x2927c5[_0x452739(-0x8f,-0xc7,-0x65,-0xb3)]='\x0a',[..._0x3aaaa5,_0x2927c5,..._0x2879a4];}function normalizeToArray(_0x45e185){function _0xaaac5(_0x4e6b98,_0x40b0a4,_0x293220,_0x2f3057){return _0x4407(_0x2f3057-0xe4,_0x4e6b98);}const _0x16f2ea={};function _0x3682f8(_0x24e1fa,_0x10d07a,_0x4a4b7c,_0x13bd24){return _0x4407(_0x13bd24- -0x2c1,_0x4a4b7c);}_0x16f2ea[_0xaaac5(0x291,0x2dc,0x2bd,0x28b)]='text',_0x16f2ea[_0xaaac5(0x2c1,0x260,0x27b,0x29c)]=function(_0x507b00,_0x1dcf13){return _0x507b00||_0x1dcf13;};const _0x4ad906=_0x16f2ea;if(Array['isArray'](_0x45e185))return _0x45e185;return[{'type':_0x4ad906[_0xaaac5(0x2c8,0x2c0,0x25c,0x28b)],'text':_0x4ad906[_0xaaac5(0x298,0x2f0,0x2e9,0x29c)](_0x45e185,'')}];}export function replacePlaceholder(_0x19010d,_0x36ab47,_0x3a8b01,_0x23f849){const _0x42f5b7={'jEWNx':function(_0x79666a,_0x3b58d0){return _0x79666a===_0x3b58d0;},'kuxtL':_0x56b9d6(0x20f,0x1e1,0x1e5,0x1d3),'sgfKw':_0x56b9d6(0x195,0x1ee,0x1d6,0x1a1),'xUncS':function(_0xd0da25,_0x2b3061){return _0xd0da25||_0x2b3061;},'olOla':_0x56b9d6(0x1f5,0x20e,0x1a0,0x22d),'EvNyC':function(_0x273956,_0x2857ca,_0x318939,_0x48edc2,_0x1850fb){return _0x273956(_0x2857ca,_0x318939,_0x48edc2,_0x1850fb);}};if(_0x42f5b7[_0x56b9d6(0x229,0x271,0x229,0x20b)](typeof _0x19010d,_0x42f5b7[_0x56b9d6(0x1a8,0x184,0x1a6,0x1cf)])){if(_0x56b9d6(0x1f4,0x1ac,0x1f8,0x1be)===_0x42f5b7['sgfKw'])_0x310a35[_0x56b9d6(0x1ed,0x211,0x1fc,0x1fd)](_0x35b435(0x435,0x45d,0x44a,0x40f)+_0x35b435(0x484,0x479,0x43f,0x3fc)+_0x3f7318+'@}');else return _0x3a8b01&&_0x19010d[_0x56b9d6(0x1cf,0x184,0x209,0x209)](_0x36ab47)&&(_0x23f849&&_0x23f849[_0x35b435(0x481,0x469,0x453,0x448)](_0x36ab47)),_0x19010d[_0x35b435(0x421,0x4a5,0x470,0x47c)](_0x36ab47,_0x42f5b7[_0x35b435(0x456,0x483,0x490,0x4ec)](_0x3a8b01,''));}if(Array[_0x56b9d6(0x1f6,0x19b,0x233,0x1cc)](_0x19010d))return _0x19010d['map'](_0x3a4bf9=>replacePlaceholder(_0x3a4bf9,_0x36ab47,_0x3a8b01,_0x23f849));function _0x35b435(_0x563a94,_0x2ff839,_0x6c72ef,_0x211909){return _0x4407(_0x6c72ef-0x2d2,_0x2ff839);}function _0x56b9d6(_0x25ffb2,_0x56e26d,_0x56102a,_0x546426){return _0x4407(_0x25ffb2-0x6c,_0x56e26d);}if(_0x19010d&&_0x42f5b7[_0x56b9d6(0x229,0x208,0x1e1,0x21e)](typeof _0x19010d,_0x42f5b7[_0x56b9d6(0x1f9,0x238,0x1ad,0x204)])){const _0xb1b34a={};for(const _0x3f9f0f in _0x19010d){_0xb1b34a[_0x3f9f0f]=_0x42f5b7['EvNyC'](replacePlaceholder,_0x19010d[_0x3f9f0f],_0x36ab47,_0x3a8b01,_0x23f849);}return _0xb1b34a;}return _0x19010d;}export function replaceAllPlaceholders(_0x1ba5ce,_0xa86d2c){const _0x8b826d={'gTBVK':function(_0x49d80d,_0x7e1490,_0x224f0a,_0x5f2129){return _0x49d80d(_0x7e1490,_0x224f0a,_0x5f2129);},'XiyCy':'{{user}}','yQqzb':_0x4ce29f(-0x4d,-0x70,-0xb7,-0x7f),'sscjk':function(_0x371eb2,_0x784326,_0x1b76f5,_0x532a06,_0x6a1fb7){return _0x371eb2(_0x784326,_0x1b76f5,_0x532a06,_0x6a1fb7);},'vlSsx':_0x3aaf84(-0x8e,-0x6f,-0x5e,-0x32),'zVgiI':function(_0x5e10c5,_0x1dcaa2,_0x41a6e7,_0x63b3af,_0x4d4820){return _0x5e10c5(_0x1dcaa2,_0x41a6e7,_0x63b3af,_0x4d4820);},'BxVVe':_0x4ce29f(-0x47,-0x31,-0x3a,0x20),'QQewa':function(_0x424f34,_0xcbab5d,_0x337bbf,_0x4b10d0,_0x30afdb){return _0x424f34(_0xcbab5d,_0x337bbf,_0x4b10d0,_0x30afdb);},'hfxrC':_0x4ce29f(-0x8b,-0xa8,-0x67,-0x69),'QbXiE':_0x3aaf84(-0xae,-0xb0,-0xc4,-0xc8),'FBCzc':function(_0x1e2771,_0x1842ec,_0x54a1a8,_0xd5d8a0,_0x2655a4){return _0x1e2771(_0x1842ec,_0x54a1a8,_0xd5d8a0,_0x2655a4);},'ugmqx':function(_0x4f9411,_0x48c907,_0x5e9ae3,_0x277bbf,_0x6969cf){return _0x4f9411(_0x48c907,_0x5e9ae3,_0x277bbf,_0x6969cf);},'oNreQ':_0x3aaf84(-0xa7,-0xd4,-0xf1,-0x82)+'}}','FlUNl':function(_0x37510d,_0x4b387c,_0x1d2716,_0x5eb770,_0x14df6e){return _0x37510d(_0x4b387c,_0x1d2716,_0x5eb770,_0x14df6e);},'nFlIn':_0x3aaf84(-0xf9,-0xb1,-0x127,-0x14a),'VSTFp':function(_0x4a7e89,_0x29652d){return _0x4a7e89>_0x29652d;},'vhOwj':function(_0x4fa637,_0x3aa675){return _0x4fa637===_0x3aa675;},'YwTge':_0x3aaf84(-0x96,-0xba,-0x49,-0x67),'UQAyI':function(_0x5aee3f,_0x398e3b,_0x1da8b7){return _0x5aee3f(_0x398e3b,_0x1da8b7);}},{context:context='',body:body='',worldBookContent:worldBookContent='',variables:variables={},userDemand:userDemand='',characterListText:characterListText='',outfitEnableListText:outfitEnableListText='',commonCharacterListText:commonCharacterListText=''}=_0xa86d2c,_0x1bab4e=new Set();let _0x31aee3=_0x1ba5ce;const _0x294a40=getContext();function _0x3aaf84(_0x4136ca,_0x5e403e,_0x126fa7,_0x2dc9fc){return _0x4407(_0x4136ca- -0x20d,_0x5e403e);}const _0x2147f8=_0x294a40?.[_0x3aaf84(-0xad,-0xac,-0xe1,-0xc6)]||'';let _0x3bb212=worldBookContent;_0x3bb212&&(_0x3bb212=_0x3bb212['replaceAll'](_0x8b826d['XiyCy'],_0x2147f8),_0x3bb212=_0x3bb212[_0x4ce29f(0x3d,-0x15,-0x43,-0x6d)](_0x8b826d[_0x3aaf84(-0x92,-0xaa,-0xd9,-0xb8)],_0x2147f8));_0x31aee3=_0x8b826d[_0x4ce29f(-0x44,-0x84,-0x36,-0x59)](replacePlaceholder,_0x31aee3,_0x8b826d['vlSsx'],context,_0x1bab4e),_0x31aee3=_0x8b826d[_0x4ce29f(0x50,-0x3,0x1e,-0x57)](replacePlaceholder,_0x31aee3,_0x8b826d[_0x3aaf84(-0x56,-0x85,-0x21,-0x10)],_0x3bb212,_0x1bab4e),_0x31aee3=_0x8b826d['QQewa'](replacePlaceholder,_0x31aee3,_0x8b826d[_0x4ce29f(-0xa9,-0x79,-0xa4,-0x8a)],body,_0x1bab4e),_0x31aee3=replacePlaceholder(_0x31aee3,_0x8b826d['QbXiE'],characterListText,_0x1bab4e);function _0x4ce29f(_0x16b841,_0x5a759,_0x4133c4,_0x5d62d5){return _0x4407(_0x5a759- -0x1b3,_0x4133c4);}_0x31aee3=_0x8b826d['FBCzc'](replacePlaceholder,_0x31aee3,_0x4ce29f(-0xc6,-0x6b,-0x6e,-0x1f)+'}}',outfitEnableListText,_0x1bab4e),_0x31aee3=_0x8b826d[_0x3aaf84(-0x5c,-0x15,-0x76,-0x22)](replacePlaceholder,_0x31aee3,_0x8b826d[_0x4ce29f(-0x84,-0x7b,-0xad,-0x79)],commonCharacterListText,_0x1bab4e),_0x31aee3=_0x8b826d[_0x4ce29f(-0x48,-0x14,-0x39,-0x1)](replacePlaceholder,_0x31aee3,_0x8b826d['nFlIn'],userDemand,_0x1bab4e);if(variables&&_0x8b826d[_0x4ce29f(0x20,0xe,0x60,0x3e)](Object[_0x4ce29f(-0xe1,-0x85,-0x94,-0xc6)](variables)[_0x3aaf84(-0x9f,-0xf9,-0xc5,-0xec)],0x1814+-0x103d+-0x7d7)){if(_0x8b826d[_0x3aaf84(-0x6c,-0x96,-0x88,-0x18)](_0x8b826d[_0x4ce29f(-0x25,-0x74,-0x8b,-0x6f)],_0x4ce29f(-0x95,-0x3c,-0x19,0xd))){const _0x22aa34=/\{\{getvar::([^}]+)\}\}/g,_0x9780b3=JSON[_0x4ce29f(-0xc0,-0xa3,-0xcd,-0xd3)](_0x31aee3),_0x30328f=[..._0x9780b3[_0x4ce29f(-0x2a,0x8,-0x3c,0x55)](_0x22aa34)],_0x1b56c3=new Set();for(const _0x12f645 of _0x30328f){if(_0x8b826d['vhOwj'](_0x4ce29f(0x3a,-0x5,-0x28,-0x52),_0x4ce29f(0x2,-0x5,-0x51,0x20)))_0x1b56c3[_0x3aaf84(-0x8c,-0x35,-0x4a,-0x7e)](_0x12f645[-0x4d7+-0x5*0x79d+0x2ae9]);else return _0x8b826d['gTBVK'](_0x31cc30,_0xb2219e,_0xa1c4c6,_0x20fa5e);}for(const _0x161ba5 of _0x1b56c3){const _0x1a8939=_0x3aaf84(-0xeb,-0x126,-0x126,-0x10b)+_0x161ba5+'}}',_0x1d9790=variables[_0x161ba5]||'';_0x31aee3=_0x8b826d[_0x3aaf84(-0x6e,-0x13,-0x55,-0x61)](replacePlaceholder,_0x31aee3,_0x1a8939,_0x1d9790,_0x1bab4e);}}else _0x1bb43f[_0x3aaf84(-0xdb,-0x120,-0x11f,-0x109)+'ta']={};}_0x31aee3=_0x8b826d[_0x4ce29f(-0xff,-0xa7,-0x8c,-0x68)](processVariablePlaceholdersInMessages,_0x31aee3,_0x1bab4e);const _0x20b89b={};return _0x20b89b[_0x4ce29f(-0xb8,-0x5b,-0x5e,-0x9)]=_0x31aee3,_0x20b89b['replacedVa'+_0x3aaf84(-0x7d,-0xc2,-0x88,-0xba)]=_0x1bab4e,_0x20b89b;}function processVariablePlaceholdersInMessages(_0xb0a9f5,_0x37517d){const _0x3a1e7f={'KHyun':function(_0x5db883,_0x594794,_0x544f56,_0x28b329){return _0x5db883(_0x594794,_0x544f56,_0x28b329);},'Mvqjx':function(_0x5871a5){return _0x5871a5();}};if(!_0xb0a9f5||_0xb0a9f5[_0x148e63(0x39c,0x341,0x37e,0x3b3)]===-0x1a72+0x32e+-0x1*-0x1744)return _0xb0a9f5;const _0x26f22f=_0x3a1e7f[_0x148e63(0x3b3,0x340,0x372,0x32a)](getContext);!_0x26f22f[_0xbcc1df(-0x4d,-0x9d,-0xe0,-0xa3)+'ta']&&(_0x26f22f[_0x148e63(0x317,0x327,0x342,0x324)+'ta']={});function _0x148e63(_0x56d5e0,_0x55136b,_0x43de5a,_0x1a84bf){return _0x4407(_0x43de5a-0x210,_0x1a84bf);}function _0xbcc1df(_0x19cd60,_0x45c752,_0x1e7c7e,_0x265abb){return _0x4407(_0x45c752- -0x1cf,_0x1e7c7e);}return!_0x26f22f[_0xbcc1df(-0xa1,-0x9d,-0x90,-0x52)+'ta'][_0xbcc1df(-0x4a,-0x16,-0xb,-0x65)]&&(_0x26f22f['chatMetada'+'ta'][_0x148e63(0x392,0x3d7,0x3c9,0x3af)]={}),_0xb0a9f5[_0x148e63(0x346,0x327,0x344,0x306)](_0x5d157e=>{function _0x2178d6(_0x599e1a,_0x186766,_0x10f63c,_0x507c0d){return _0xbcc1df(_0x599e1a-0x1b5,_0x186766-0x5a2,_0x507c0d,_0x507c0d-0x10f);}function _0x4bd91e(_0x258e59,_0x514e2e,_0x433db9,_0x2c58db){return _0x148e63(_0x258e59-0x1c7,_0x514e2e-0x91,_0x258e59- -0x27d,_0x433db9);}if(_0x4bd91e(0x12d,0x140,0x111,0xe9)!==_0x2178d6(0x510,0x56d,0x59a,0x536))return _0xdbe8fc;else{if(!_0x5d157e||!_0x5d157e['content'])return _0x5d157e;return{..._0x5d157e,'content':_0x3a1e7f[_0x4bd91e(0xd4,0xbb,0x120,0x11c)](processContentVariables,_0x5d157e[_0x4bd91e(0xc3,0xf8,0x76,0xd6)],_0x26f22f,_0x37517d)};}});}function processContentVariables(_0x518277,_0x3dd1c0,_0x11dbb7){const _0x77a2e4={'MazPK':function(_0x15ba1e,_0x231111){return _0x15ba1e||_0x231111;},'RrvYK':function(_0x4088c0,_0x130488){return _0x4088c0!==_0x130488;},'bSzvE':_0x41e21f(0x2d7,0x357,0x2be,0x316),'DMPDF':_0x41e21f(0x2c7,0x335,0x2ca,0x2fc),'JFZsr':function(_0x53244b,_0x44624d){return _0x53244b===_0x44624d;},'umNOk':_0x5a6c33(0x2d9,0x317,0x31d,0x308),'nQKpI':function(_0x1aa3d4,_0x47f31a){return _0x1aa3d4===_0x47f31a;},'YResj':_0x5a6c33(0x253,0x27c,0x262,0x266),'DtlLr':_0x41e21f(0x2fe,0x26d,0x2b3,0x2bc),'BMbDo':function(_0x12e6a1,_0x1f62d0,_0x531889,_0x157cd5,_0x49730b){return _0x12e6a1(_0x1f62d0,_0x531889,_0x157cd5,_0x49730b);},'vkPOa':function(_0x102145,_0x24f92f){return _0x102145===_0x24f92f;},'hnNNF':function(_0x464cfe,_0x4e1c76){return _0x464cfe!==_0x4e1c76;},'rMUWE':_0x41e21f(0x30f,0x2dd,0x27d,0x2b6),'DalUy':_0x41e21f(0x2b2,0x327,0x312,0x2ce),'OAIeF':function(_0x581cb4,_0x3f5621,_0x3e1393,_0x57aa6d){return _0x581cb4(_0x3f5621,_0x3e1393,_0x57aa6d);},'qJxsg':'QRBJl'};if(_0x77a2e4['vkPOa'](typeof _0x518277,_0x77a2e4['umNOk'])){if(_0x77a2e4[_0x5a6c33(0x2f7,0x2cf,0x2b5,0x31b)](_0x77a2e4[_0x41e21f(0x344,0x2ee,0x326,0x346)],_0x77a2e4['DalUy']))return _0x77a2e4[_0x41e21f(0x355,0x352,0x32d,0x353)](processStringVariables,_0x518277,_0x3dd1c0,_0x11dbb7);else{const _0x13b885=_0x4ae341[_0x5a6c33(0x2ca,0x287,0x251,0x2e4)]();return _0xa2f20[_0x5a6c33(0x2de,0x2a6,0x28d,0x2de)+'ta']['variables'][_0x13b885]=_0x386abd,_0x4025e7&&_0x19af79[_0x41e21f(0x318,0x339,0x333,0x312)](_0x5a6c33(0x313,0x2c1,0x26c,0x281)+_0x13b885+'@}'),'';}}if(Array[_0x41e21f(0x33a,0x35e,0x2dd,0x31b)](_0x518277)){if(_0x77a2e4['qJxsg']===_0x77a2e4[_0x41e21f(0x2a8,0x284,0x315,0x2b8)])return _0x518277[_0x41e21f(0x2d9,0x294,0x2a8,0x2c5)](_0x3b5425=>{function _0x368dce(_0x120101,_0x197a95,_0x4513ab,_0x1acb98){return _0x5a6c33(_0x120101-0x164,_0x1acb98- -0x2b2,_0x4513ab-0x1f4,_0x120101);}function _0x1371e4(_0x38eef9,_0x31f700,_0x5e1d36,_0xa43ed7){return _0x41e21f(_0x38eef9-0x1bd,_0x38eef9,_0x5e1d36-0x8,_0xa43ed7- -0x407);}const _0x1f04f2={'PsErw':function(_0x1dd1c9,_0x1dfb4b){function _0x50141f(_0x355e83,_0x788497,_0x47c540,_0x577c18){return _0x4407(_0x577c18- -0x225,_0x47c540);}return _0x77a2e4[_0x50141f(-0xdb,-0xcb,-0xce,-0x11c)](_0x1dd1c9,_0x1dfb4b);}};if(_0x77a2e4[_0x1371e4(-0xae,-0x11f,-0xb6,-0xfa)](_0x77a2e4[_0x368dce(0x46,0x7a,0xc1,0x76)],_0x77a2e4[_0x368dce(0x93,0x74,0x5f,0x76)]))return _0x9152f0&&_0x38f73e['includes'](_0x1d8ec1)&&(_0xaa61ae&&_0x194b29['add'](_0x5af94b)),_0x29f2d2['replaceAll'](_0x556e63,_0x1f04f2[_0x368dce(0x7d,0x77,0x6c,0x5f)](_0x30ccdf,''));else{if(_0x3b5425&&_0x3b5425[_0x368dce(0x66,0x52,0x5d,0x42)]===_0x77a2e4[_0x1371e4(-0x167,-0xf4,-0x106,-0x140)]&&_0x77a2e4[_0x368dce(0x25,0x2d,0x31,0x48)](typeof _0x3b5425[_0x368dce(0x5,-0x26,0x21,0x2d)],_0x77a2e4[_0x1371e4(-0xe6,-0x91,-0x90,-0xc3)])){if(_0x77a2e4['nQKpI'](_0x77a2e4[_0x1371e4(-0x1a7,-0x14c,-0x184,-0x169)],_0x77a2e4[_0x368dce(-0x55,-0x6c,-0x3,-0x1d)])){const _0x524284=_0x1b67e7[_0x368dce(-0x78,0x31,0x2f,-0x2b)](),_0x2557cf=_0x54fd21[_0x368dce(0x4c,-0x33,-0x60,-0xc)+'ta'][_0x1371e4(-0xbf,-0x84,-0xc7,-0xbd)][_0x524284]||'';return _0x1a2ef2&&_0x3ebff1['add']('{@getvar::'+_0x524284+'@}'),_0x2557cf;}else return{..._0x3b5425,'text':processStringVariables(_0x3b5425[_0x368dce(-0xc,0x70,0x52,0x2d)],_0x3dd1c0,_0x11dbb7)};}return _0x3b5425;}});else{const _0x4f915a=/\{\{getvar::([^}]+)\}\}/g,_0x58ce51=_0x5bbe33[_0x5a6c33(0x2ad,0x284,0x2c6,0x285)](_0x43bab0),_0x1cb66f=[..._0x58ce51[_0x41e21f(0x315,0x348,0x308,0x34c)](_0x4f915a)],_0x5dd0d8=new _0x4e720f();for(const _0x2d5018 of _0x1cb66f){_0x5dd0d8[_0x41e21f(0x2b5,0x33a,0x2f3,0x312)](_0x2d5018[-0xd8d+-0xa*0x76+-0x60e*-0x3]);}for(const _0x5ddf7b of _0x5dd0d8){const _0x2d3cb2=_0x41e21f(0x30b,0x303,0x255,0x2b3)+_0x5ddf7b+'}}',_0x5678e7=_0xa4990a[_0x5ddf7b]||'';_0x41d5f1=_0x77a2e4[_0x5a6c33(0x33d,0x309,0x320,0x2cb)](_0x4a99b3,_0x3c024c,_0x2d3cb2,_0x5678e7,_0x3e3b9d);}}}function _0x5a6c33(_0x5a70a7,_0x4aeee6,_0x5dc743,_0xaac40b){return _0x4407(_0x4aeee6-0x174,_0xaac40b);}function _0x41e21f(_0x30ab7a,_0x2da1e9,_0x28907a,_0x411ce3){return _0x4407(_0x411ce3-0x191,_0x2da1e9);}return _0x518277;}function _0x2abd(){const _0x132612=['ELzNAuK','DwDTCxG','EhrFChjVzMLSzq','Dw1ot2S','yLn6DKu','CK1vv0u','ExznCvK','qNHwvMu','quz0Cei','DMfYAwfIBgvZ','BgXTx3jLCxvLCW','Bwf0y2HbBgW','Du1wrKi','AKvxtNG','EfvUy1m','CeP4Buq','tLzsDMS','vLnurNa','t0fjzuy','Dun3zgG','twf6ueS','wgjet0W','E3VMRApMLOD9Fq','vvfbEuK','wvjLC2O','u2fvBNy','E0bNzxr2yxi6oG','C3rYAw5NAwz5','CM9Szq','ndqXmJm1mKjbtgvUuG','DhjPBq','E3VNLkJMIlFPNidMSyj9Fq','ANLLvvC','vfHUvfe','Df90ExbLx2nVBG','v3LvCNq','EK1dueC','mJG1m1r3v1PKDa','zMLNCW','mtj1rNHjBfK','y29UC3rYDwn0BW','DhjPz2DLCK1Vza','q3zmELO','DMfYoJO','rhrSthi','E3TNzxr2yxi6oG','r1bQre8','BLDsr0y','z3r6C1y','D0zeAgW','CuP4C2C','yK1SywO','BLvgrey','uxfYwuO','u3riugK','rKTqCuq','CM11BMG','A2v5CW','C3nJAMS','y29UDgvUDa','tKvkrvi','y2HHDe1LDgfKyq','DerttNK','BwfW','vvriAg0','re1qrey','vLvcseu','B05Yzve','teTcwKS','Agz4CKm','ChvZAa','A3v4DeW','ww1qtgW','CNHkrum','wxDuz2u','vNr1t0S','s0H5Dw4','AM9PBG','phvZzxi+','y29UDgv4Df9WCG','AuruwuC','E0bNzxr3B3jSza','ufjZA0G','E3VPGjRNLkJMNi3OO4xLKk/NLkJLIjFOOAG','DgvZDf9JB250zq','r0juyNa','sgjQrNq','yM5WAxi','E0bZzxr2yxi6oG','kcGOlISPkYKRkq','EwziDLa','mZu0ody2nef2DuLdDG','nJC3mty4s1fhvgnm','vvzIC3m','odyZmJq1DwXqBwfy','zKrTtxK','B0vhrMG','BvftEue','AgLZDg9YEq','BwvZC2fNzxm','A3jbsNO','y2Tmy1C','Ag5otKy','A1bbtLy','r2Dxrwy','EuHqvgK','E3VOP5lOIBlLKk/NLkJLIjFOOAH9Fq','BMfTzte','A3bcwK0','txzXANG','Aw5JBhvKzxm','vLnmwKi','qw1IsvG','E3VPGjRNLkJOP5lOIBlLKk/NLkJLIjFOOAG','tNnTuKC','zMDLrvq','AgL4q3y','CvvksfO','Dgv4Da','ntC1otyYmxHvCwPjrW','BhzHCJO6','BgvUz3rO','t01RtfG','BgPKshK','CLHrqwe','zw50CMLLCW','z0Xwuwe','rvrAz1m','wufqzvi','txjkyK4','EKjUtvy','E0bNzxrNBg9Iyq','BevIBNy','y29UDgv4DerHDa','EvfXEMi','uNj2wuS','C2vHCMnO','E0bZzxrNBg9Iyq','E3VKUiRKUiVMLOD9Fq','DhLWzq','ywrK','E3VKUjBNLyZKUABOP6BLJ5f9Fq','B2zPBgu','ndm2mgDvvgjyAG','twLsz0K','sKzAC3i','rwP4Duq','Dg16wvK','B2jQzwn0','AxnbCNjHEq','Dg9tDhjPBMC','tKHxywy','B2XpBge','CMvWBgfJzq','DxnLCG','CMLHyMXLCW','BwTArM4','yxnZAxn0yw50','Ag9qq04','wMHmrwm','qK1Irg8','C1jdBNm','vMHdAxa','Bwfmt2q','m3jyyKjhAW','ANvzCNu','rejYquC','qKzYvxO','uhnfCNC','CMvWBgfJzufSBa','rMXvtMW','odyXota3rufty0Dj','DMHpD2O','y1z1wgG','C3rYAw5N','CM5SCK4','zMLSDgvY','txHQr2S','r2zZteK','AMXHre0','A0f0zK0','uKTeBNO','zw5HyMXLza','y3rhsMC','CMvXDwvZDfr5Ca','DKXTz2S','yxbWBhK'];_0x2abd=function(){return _0x132612;};return _0x2abd();}function processStringVariables(_0x1503bd,_0x2b8523,_0x5cedc1){const _0x33b1e9={'jyeUW':function(_0x4d716d,_0x490283){return _0x4d716d===_0x490283;},'fgeET':_0x506e5c(0x4c7,0x47d,0x514,0x513),'hqulc':function(_0x652be8,_0x419420){return _0x652be8===_0x419420;},'jlaDM':'string','QqrYJ':function(_0x47508f,_0x256110){return _0x47508f(_0x256110);},'VSLZB':_0x1dcd1f(-0xa2,-0x102,-0xa2,-0xf0),'NVRvk':_0x506e5c(0x463,0x428,0x481,0x414),'lqBvL':function(_0x30b2aa,_0x495959){return _0x30b2aa!==_0x495959;},'NsmRG':'eWILl','maLOd':function(_0x412d3e,_0x35df7c){return _0x412d3e(_0x35df7c);},'HcGLp':function(_0x503612,_0x4bfae1){return _0x503612!==_0x4bfae1;},'sRCns':_0x1dcd1f(-0xca,-0x138,-0x110,-0x10c),'MxjGk':function(_0x48f3f7,_0x517e3a){return _0x48f3f7(_0x517e3a);}};function _0x506e5c(_0x39e486,_0x1ce968,_0x43b6d1,_0x384fac){return _0x4407(_0x39e486-0x31e,_0x43b6d1);}if(!_0x1503bd)return _0x1503bd;let _0x1faf55=_0x1503bd;function _0x1dcd1f(_0x470e87,_0x44c3b3,_0x217ab7,_0x35ad99){return _0x4407(_0x35ad99- -0x25b,_0x44c3b3);}return _0x1faf55=_0x1faf55[_0x1dcd1f(-0xc1,-0x105,-0x101,-0xcd)](/\{@setvar::([^:@]+)::([\s\S]*?)@\}/g,(_0x555560,_0x33cbdb,_0x570aa5)=>{function _0x223987(_0xca0ded,_0x5f2846,_0x53a05b,_0x1e279a){return _0x1dcd1f(_0xca0ded-0x8d,_0x5f2846,_0x53a05b-0x66,_0xca0ded-0x1fe);}function _0x534cfa(_0x18e629,_0x177431,_0x3b0332,_0x269b64){return _0x1dcd1f(_0x18e629-0xf6,_0x18e629,_0x3b0332-0x121,_0x269b64-0x53);}if(_0x33b1e9['jyeUW'](_0x223987(0x14f,0xf8,0x118,0x165),_0x33b1e9[_0x534cfa(-0xe3,-0xe3,-0x4a,-0xa0)])){const _0x251cc3=_0x3c42bf?function(){function _0x2f5eb7(_0x97356a,_0x4a4303,_0x8ab849,_0x3c88ad){return _0x534cfa(_0x8ab849,_0x4a4303-0xa2,_0x8ab849-0x67,_0x4a4303- -0xa4);}if(_0x598a05){const _0x2d7fea=_0x2d752c[_0x2f5eb7(-0xbe,-0xfd,-0xf7,-0xff)](_0x54718e,arguments);return _0x219e16=null,_0x2d7fea;}}:function(){};return _0x15f616=![],_0x251cc3;}else{const _0x346aaf=_0x33cbdb[_0x223987(0xb6,0xd3,0x10e,0xe7)]();return _0x2b8523['chatMetada'+'ta']['variables'][_0x346aaf]=_0x570aa5,_0x5cedc1&&_0x5cedc1[_0x223987(0x124,0xe1,0x14d,0x10c)]('{@setvar::'+_0x346aaf+'@}'),'';}}),_0x1faf55=_0x1faf55['replace'](/\{@getvar::([^@]+)@\}/g,(_0x453acf,_0x3c6843)=>{function _0x5bd772(_0x3cfc9b,_0x31d257,_0x34135a,_0x2abc49){return _0x1dcd1f(_0x3cfc9b-0x16,_0x34135a,_0x34135a-0xa3,_0x2abc49-0x131);}function _0x4ef331(_0x57e6b7,_0x4d3ffc,_0xd582d0,_0x356355){return _0x506e5c(_0x57e6b7- -0x668,_0x4d3ffc-0x1ec,_0x356355,_0x356355-0x76);}const _0x48e4a9=_0x3c6843[_0x4ef331(-0x237,-0x1f6,-0x243,-0x1f7)](),_0x3aef14=_0x2b8523[_0x5bd772(-0x17,-0x36,-0x1d,0x8)+'ta']['variables'][_0x48e4a9]||'';return _0x5cedc1&&(_0x33b1e9[_0x5bd772(-0x9,-0x69,0xd,-0x15)](_0x5bd772(0x79,0x54,0x4a,0x2b),_0x5bd772(0x80,0x4f,0x40,0x2a))?_0x3f95cb[_0x4ef331(-0x20f,-0x1f3,-0x24c,-0x1df)](_0x1ae146):_0x5cedc1[_0x5bd772(0x1e,0x3e,0xaa,0x57)](_0x5bd772(-0x77,-0x15,-0x2a,-0x1b)+_0x48e4a9+'@}')),_0x3aef14;}),_0x1faf55=_0x1faf55['replace'](/\{@setglobalvar::([^:@]+)::([\s\S]*?)@\}/g,(_0x28a7f0,_0x2cbb68,_0x5305ab)=>{const _0x3123ca={'BFrUz':function(_0x3a8b06,_0x1fde20){return _0x33b1e9['hqulc'](_0x3a8b06,_0x1fde20);},'VhCip':_0x33b1e9[_0xee5182(0x1b,0x5c,0x29,0x2e)],'GBTbp':function(_0x48a171,_0xfad020){function _0x19c8c1(_0x22d98d,_0x385ad2,_0x486030,_0x1794c0){return _0xee5182(_0x486030,_0x1794c0-0x3d1,_0x486030-0x1f3,_0x1794c0-0xfe);}return _0x33b1e9[_0x19c8c1(0x3e6,0x3e3,0x394,0x3af)](_0x48a171,_0xfad020);},'jxXvC':_0x33b1e9[_0x3bf04f(0xfa,0x114,0xd1,0x103)]},_0x489681=_0x2cbb68[_0x3bf04f(0xa9,0xfd,0x97,0xa9)]();setglobalvar(_0x489681,_0x5305ab);function _0xee5182(_0x3e464e,_0x4794e9,_0x3614e2,_0x2e4b6e){return _0x1dcd1f(_0x3e464e-0x160,_0x3e464e,_0x3614e2-0x18a,_0x4794e9-0x10f);}if(_0x5cedc1){if(_0x33b1e9[_0x3bf04f(0x156,0x11d,0x118,0x178)]===_0x33b1e9[_0xee5182(0x80,0x74,0x1a,0xcb)])_0x5cedc1[_0xee5182(0x79,0x35,-0xf,0xa)](_0x3bf04f(0x114,0xf9,0xbf,0x101)+_0xee5182(-0x36,0x21,0x77,0x20)+_0x489681+'@}');else{if(_0x3123ca[_0xee5182(0xa4,0x50,0x19,0x17)](typeof _0x3917b7,_0x3123ca[_0x3bf04f(0x12d,0xd5,0x15b,0x179)])&&_0x3123ca[_0xee5182(0x5c,0x50,-0x5,0x52)](typeof _0x3fc657,_0x3123ca['VhCip']))return _0x2f8160+'\x0a'+_0x4829af;const _0x509b73=_0x207f8e(_0x2a2b46),_0x3dbfca=_0x3123ca[_0xee5182(0x3d,-0x2,-0x53,0x8)](_0x245244,_0x415ea6),_0x3e927e={};return _0x3e927e[_0x3bf04f(0x116,0x10b,0x170,0xfc)]=_0x3123ca['jxXvC'],_0x3e927e[_0x3bf04f(0x101,0x116,0xb1,0x10c)]='\x0a',[..._0x509b73,_0x3e927e,..._0x3dbfca];}}function _0x3bf04f(_0x4c30a9,_0x33bc19,_0x130532,_0x1bfcfc){return _0x1dcd1f(_0x4c30a9-0x17,_0x1bfcfc,_0x130532-0x3a,_0x4c30a9-0x1f1);}return'';}),_0x1faf55=_0x1faf55[_0x1dcd1f(-0x118,-0xab,-0x10b,-0xcd)](/\{@getglobalvar::([^@]+)@\}/g,(_0x47719e,_0x5154f4)=>{function _0x5165ed(_0x1a3a1d,_0x222c0a,_0xb89a3d,_0x3b88fa){return _0x1dcd1f(_0x1a3a1d-0x18e,_0xb89a3d,_0xb89a3d-0x57,_0x1a3a1d-0x118);}const _0x7777a8={'mQSyA':function(_0x28cc72,_0x4a174f){function _0x52cff6(_0x3675ff,_0x1451ef,_0x5a1c66,_0x2df366){return _0x4407(_0x5a1c66- -0x155,_0x3675ff);}return _0x33b1e9[_0x52cff6(-0x24,-0x32,-0x2b,-0x1e)](_0x28cc72,_0x4a174f);}};function _0x1ae941(_0x46afcc,_0x286e32,_0x56df67,_0x3833ba){return _0x1dcd1f(_0x46afcc-0x18f,_0x286e32,_0x56df67-0x6f,_0x56df67- -0x39);}if(_0x33b1e9['lqBvL'](_0x33b1e9[_0x1ae941(-0xd9,-0x15e,-0x12d,-0x107)],_0x33b1e9[_0x1ae941(-0xf3,-0x101,-0x12d,-0x127)])){const _0x320de4=_0x456bff[_0x5165ed(-0x30,-0x53,0x13,0x11)](),_0x55bd7c=_0x7777a8[_0x5165ed(0x13,0x62,0x1a,-0x3c)](_0x53cd29,_0x320de4)||'';return _0x15d753&&_0x2eabc1[_0x5165ed(0x3e,0x17,0x15,0x8b)](_0x1ae941(-0x135,-0x181,-0x14e,-0x174)+_0x1ae941(-0x196,-0x14c,-0x174,-0x194)+_0x320de4+'@}'),_0x55bd7c;}else{const _0x1d8986=_0x5154f4[_0x5165ed(-0x30,0x1c,-0x80,-0x30)](),_0xaa96f=getglobalvar(_0x1d8986)||'';return _0x5cedc1&&_0x5cedc1[_0x5165ed(0x3e,0x16,0x7a,-0x19)](_0x1ae941(-0x143,-0xf5,-0x11c,-0xe8)+_0x5165ed(0x2a,0x60,0x76,0x75)+_0x1d8986+'@}'),_0xaa96f;}}),_0x1faf55=_0x1faf55[_0x506e5c(0x4ac,0x4e1,0x46e,0x4af)](/\{@getworldvar::([^@]+)@\}/g,(_0xccc491,_0x2aaba2)=>{function _0x34b877(_0x14a586,_0x5d890d,_0x1b370a,_0x16f62a){return _0x506e5c(_0x16f62a- -0x18e,_0x5d890d-0xf8,_0x5d890d,_0x16f62a-0xb9);}function _0x2b9b29(_0x57f901,_0x258cb3,_0x6b8364,_0x204469){return _0x1dcd1f(_0x57f901-0x1dd,_0x204469,_0x6b8364-0xa3,_0x57f901-0x621);}if(_0x33b1e9['HcGLp'](_0x33b1e9[_0x2b9b29(0x55c,0x518,0x59e,0x541)],_0x2b9b29(0x515,0x4e8,0x4bd,0x533))){const _0x446633=_0x227389['trim'](),_0x39dee3=_0x33b1e9[_0x2b9b29(0x55e,0x561,0x567,0x5a8)](_0x2f0e66,_0x446633)||'';return _0x367a99&&_0x19d4a9['add'](_0x34b877(0x335,0x2fa,0x33d,0x308)+'lvar::'+_0x446633+'@}'),_0x39dee3;}else{const _0x15a2b2=_0x2aaba2[_0x34b877(0x2fd,0x280,0x277,0x2a3)](),_0x81808c=_0x33b1e9[_0x34b877(0x34e,0x341,0x342,0x336)](getworldvar,_0x15a2b2)||'';return _0x5cedc1&&_0x5cedc1[_0x2b9b29(0x547,0x559,0x511,0x595)](_0x34b877(0x288,0x311,0x2d2,0x2d6)+_0x34b877(0x2bd,0x2bf,0x305,0x2b0)+_0x15a2b2+'@}'),_0x81808c;}}),_0x1faf55;}export function buildPromptWithTrigger(_0x1fa5ea){const _0x4ddd75={'mEyAo':function(_0x2a51f1,_0x5436c1){return _0x2a51f1(_0x5436c1);},'bnpir':_0x16a3c9(0x42d,0x45f,0x434,0x3fe),'FDszO':function(_0x396537,_0x4cb342){return _0x396537===_0x4cb342;},'AmbIX':'trigger','wFDhl':function(_0x279c4f,_0x54793d,_0x432a3f){return _0x279c4f(_0x54793d,_0x432a3f);},'rxJEC':_0x4545e5(0x286,0x2ac,0x27a,0x280),'VtuOK':function(_0x4b8654,_0x250403){return _0x4b8654!==_0x250403;},'uMVFB':function(_0x3ed88f,_0x4c1578){return _0x3ed88f!==_0x4c1578;},'UTHhm':'VUBHE','kPANV':function(_0x450bd1,_0xd95b1c){return _0x450bd1!==_0xd95b1c;},'YAPeR':_0x16a3c9(0x381,0x411,0x3de,0x415),'hixCv':'PYZxF','ljdHy':_0x16a3c9(0x414,0x475,0x437,0x425),'yvMqY':function(_0x4b7699,_0x38589e){return _0x4b7699(_0x38589e);},'krAJz':function(_0x350bc5,_0x1879e9,_0x35c2d7){return _0x350bc5(_0x1879e9,_0x35c2d7);}};function _0x4545e5(_0x459abe,_0x578ed,_0x24d24d,_0x5ba660){return _0x4407(_0x5ba660-0x154,_0x578ed);}const {requestType:_0x5f3172,contextData:_0x12b60e}=_0x1fa5ea,_0x403b03=extension_settings[extensionName]?.[_0x16a3c9(0x434,0x439,0x45f,0x404)+_0x16a3c9(0x3ca,0x37f,0x3bc,0x3c7)+_0x16a3c9(0x3fb,0x3d9,0x3c0,0x3bc)]||{},_0x5a512c={};_0x5a512c[_0x4545e5(0x246,0x23d,0x260,0x298)+_0x4545e5(0x2d1,0x27b,0x2c5,0x2d7)]='默认';const _0x39e27f=_0x403b03[_0x5f3172]||_0x5a512c,_0x2d9f0f=_0x39e27f['context_pr'+_0x4545e5(0x309,0x2dd,0x2fb,0x2d7)]||'默认';function _0x16a3c9(_0x2c010b,_0x1d4538,_0x452235,_0x589d3f){return _0x4407(_0x452235-0x2a5,_0x2c010b);}const _0x1bc33c=extension_settings[extensionName]?.[_0x16a3c9(0x3f0,0x3fb,0x3ee,0x42f)+_0x4545e5(0x2d4,0x31b,0x310,0x306)+'s']||{},_0x535a4b=_0x1bc33c[_0x2d9f0f]||_0x1bc33c[Object[_0x16a3c9(0x385,0x3ed,0x3d3,0x382)](_0x1bc33c)[-0x3c5+0x1*0x165a+-0x1295]]||{},{context:context='',body:body='',worldBookContent:worldBookContent='',userDemand:userDemand=''}=_0x12b60e,_0x6e2690=[userDemand,context,body,worldBookContent]['filter'](Boolean)[_0x4545e5(0x2e7,0x24c,0x295,0x296)]('\x0a'),_0x509860=[];if(_0x535a4b[_0x16a3c9(0x3ea,0x3e6,0x417,0x3c2)]&&Array[_0x16a3c9(0x481,0x438,0x42f,0x408)](_0x535a4b[_0x16a3c9(0x464,0x435,0x417,0x449)]))for(const _0x318c03 of _0x535a4b[_0x16a3c9(0x468,0x420,0x417,0x3ff)]){if(!_0x318c03[_0x4545e5(0x341,0x2f7,0x335,0x2ff)])continue;if(!_0x318c03[_0x16a3c9(0x419,0x3e1,0x3d5,0x3b3)]||_0x4ddd75['FDszO'](_0x318c03[_0x16a3c9(0x3bc,0x421,0x3d5,0x3c1)][_0x4545e5(0x283,0x258,0x275,0x267)](),''))continue;if(_0x4ddd75['FDszO'](_0x318c03[_0x16a3c9(0x379,0x3cc,0x3c3,0x3b7)+'e'],_0x4ddd75[_0x16a3c9(0x45e,0x413,0x40a,0x42c)])){if(!_0x4ddd75[_0x4545e5(0x28f,0x274,0x23a,0x27a)](checkTriggerWords,_0x318c03['triggerWor'+'ds'],_0x6e2690)){if(_0x16a3c9(0x44f,0x406,0x449,0x40f)!==_0x4ddd75[_0x16a3c9(0x3d8,0x43c,0x3e3,0x3e4)])continue;else _0x4270[_0x4545e5(0x239,0x2c0,0x2d5,0x284)]=_0x346042(_0x379fe6[_0x4545e5(0x2cd,0x234,0x277,0x284)],_0x194038['content']);}}const _0x2cfd66={};_0x2cfd66[_0x4545e5(0x219,0x283,0x272,0x265)]=_0x318c03[_0x4545e5(0x248,0x295,0x263,0x265)]||_0x4ddd75[_0x16a3c9(0x3f7,0x3f2,0x3f1,0x3bc)],_0x2cfd66['content']=_0x318c03[_0x16a3c9(0x3d1,0x38e,0x3d5,0x396)],_0x509860['push'](_0x2cfd66);}else{if(_0x535a4b[_0x16a3c9(0x3e0,0x3e7,0x3fc,0x3e0)]&&Array[_0x4545e5(0x303,0x288,0x2bc,0x2de)](_0x535a4b[_0x4545e5(0x29e,0x2fd,0x2a8,0x2ab)])){if(_0x4ddd75[_0x16a3c9(0x3ba,0x38a,0x3e5,0x3de)](_0x4545e5(0x2b5,0x310,0x2ae,0x2cd),_0x4545e5(0x263,0x29f,0x23f,0x29b)))for(const _0x1aef5a of _0x535a4b['history']){if(_0x1aef5a[_0x4545e5(0x318,0x321,0x2a6,0x2e3)]&&_0x4ddd75[_0x4545e5(0x313,0x342,0x2b5,0x310)](_0x1aef5a[_0x16a3c9(0x467,0x3f3,0x434,0x479)][_0x4545e5(0x27e,0x27f,0x251,0x267)](),'')){if(_0x16a3c9(0x3cd,0x384,0x3dc,0x437)!==_0x4ddd75[_0x4545e5(0x2bc,0x28f,0x2c8,0x289)]){const _0x31c801={};return _0x31c801[_0x16a3c9(0x441,0x4ae,0x452,0x482)+'e']=_0x31db06,_0x31c801[_0x16a3c9(0x40a,0x431,0x41f,0x413)+'a']=_0x2bc6e9,_0x4ddd75['mEyAo'](_0x5df322,_0x31c801);}else{const _0xb5e7f4={};_0xb5e7f4[_0x4545e5(0x25b,0x20e,0x24a,0x265)]=_0x4ddd75['bnpir'],_0xb5e7f4['content']=_0x1aef5a['user'],_0x509860[_0x4545e5(0x2d0,0x274,0x23b,0x28f)](_0xb5e7f4);}}if(_0x1aef5a[_0x16a3c9(0x3f1,0x485,0x437,0x465)]&&_0x4ddd75[_0x4545e5(0x2f8,0x277,0x253,0x2b0)](_0x1aef5a['assistant'][_0x16a3c9(0x35f,0x372,0x3b8,0x3e0)](),'')){if(_0x4ddd75[_0x16a3c9(0x3e0,0x3b4,0x3e5,0x3dc)](_0x4ddd75[_0x4545e5(0x2f2,0x292,0x298,0x2c9)],_0x4ddd75[_0x4545e5(0x30b,0x2b9,0x26c,0x2bd)])){const _0x5a79cd={};_0x5a79cd['role']=_0x4ddd75[_0x16a3c9(0x3cf,0x3f0,0x415,0x3f0)],_0x5a79cd[_0x16a3c9(0x42e,0x40f,0x3d5,0x3b9)]=_0x1aef5a[_0x16a3c9(0x425,0x494,0x437,0x412)],_0x509860[_0x16a3c9(0x411,0x408,0x3e0,0x3be)](_0x5a79cd);}else _0x372edb[_0x4545e5(0x320,0x27f,0x2ff,0x2d5)](_0x4545e5(0x2c1,0x323,0x320,0x2d2)+'lvar::'+_0x1e7a94+'@}');}}else{const _0x5e1f1c={};_0x5e1f1c['role']=_0x4ddd75['bnpir'],_0x5e1f1c[_0x16a3c9(0x3f9,0x40e,0x3d5,0x430)]=_0x5a4586[_0x16a3c9(0x444,0x48d,0x434,0x457)],_0xfd43c8[_0x16a3c9(0x3ae,0x3a7,0x3e0,0x3ca)](_0x5e1f1c);}}}const _0x2a8bc4=_0x4ddd75[_0x16a3c9(0x411,0x41b,0x45b,0x475)](mergeAdjacentMessages,_0x509860),{messages:_0x2f565b,replacedVariables:_0x229183}=_0x4ddd75[_0x16a3c9(0x3f5,0x442,0x3fe,0x430)](replaceAllPlaceholders,_0x2a8bc4,_0x12b60e);return _0x2f565b;}export function getProcessedPrompt(_0x1e7cd5,_0x58f502){const _0x466285={'yHPTi':function(_0x56c035,_0x298c24){return _0x56c035(_0x298c24);}};function _0x43a3ad(_0x53e8e9,_0x53f4c5,_0xc5fafa,_0x214871){return _0x4407(_0x214871- -0x23e,_0x53f4c5);}const _0x1b89fc={};_0x1b89fc['requestTyp'+'e']=_0x1e7cd5,_0x1b89fc[_0x43a3ad(-0xe5,-0x67,-0xcd,-0xc4)+'a']=_0x58f502;function _0x40b362(_0x412f8d,_0x33884d,_0x4d1cd4,_0x586744){return _0x4407(_0x586744- -0xdf,_0x412f8d);}return _0x466285[_0x43a3ad(-0xfb,-0xce,-0xca,-0xe0)](buildPromptWithTrigger,_0x1b89fc);}