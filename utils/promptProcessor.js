(function(_0x329e71,_0x3c9911){function _0x270070(_0x50f1d9,_0x1a4682,_0x24f064,_0x510e85){return _0x3a52(_0x1a4682-0xf,_0x24f064);}const _0x4c6126=_0x329e71();function _0x451bd5(_0x1399cb,_0x5f1946,_0x197c0e,_0xb7b64d){return _0x3a52(_0x5f1946- -0x99,_0xb7b64d);}while(!![]){try{const _0x15bcec=parseInt(_0x451bd5(0x128,0x12f,0x11c,0xdd))/(0x1c14+0x3*0x3d0+-0x5*0x7e7)+-parseInt(_0x451bd5(0xcc,0x107,0x13b,0xd0))/(-0x165b+-0xad5+0x2132)*(-parseInt(_0x270070(0x1ae,0x1a2,0x1d8,0x1e4))/(-0xd1f*0x2+-0xa9f*-0x3+-0x59c))+-parseInt(_0x451bd5(0x164,0x155,0x124,0x18f))/(0x5af+0x5*-0x61d+0x18e6)+parseInt(_0x451bd5(0x1a6,0x191,0x1e0,0x1c8))/(0x1c*0x2+0x1*-0xafb+0xac8)+parseInt(_0x270070(0x1e1,0x1ea,0x23d,0x236))/(0x1097*0x1+0x201d+0x30ae*-0x1)+-parseInt(_0x451bd5(0x176,0x186,0x19f,0x173))/(0x29*0x31+-0x1*-0xc22+-0x13f4*0x1)+-parseInt(_0x270070(0x258,0x232,0x1f7,0x240))/(-0x2*-0x355+-0x13b*-0x12+-0x1cc8)*(parseInt(_0x270070(0x1b4,0x1a8,0x182,0x1aa))/(0x955+0x115a+-0x1aa6));if(_0x15bcec===_0x3c9911)break;else _0x4c6126['push'](_0x4c6126['shift']());}catch(_0x4594a1){_0x4c6126['push'](_0x4c6126['shift']());}}}(_0x12d6,-0x29*-0x69cb+-0x1129d1+-0x2da*-0x512));const _0x289c40=(function(){let _0x28f9fe=!![];return function(_0x5b99cb,_0x37a675){const _0xe62886=_0x28f9fe?function(){function _0x447c6f(_0x3dbf97,_0x39013b,_0xc0bebb,_0x26535b){return _0x3a52(_0x26535b- -0xfb,_0xc0bebb);}if(_0x37a675){const _0x3bbf89=_0x37a675[_0x447c6f(0x13f,0xf8,0x118,0x104)](_0x5b99cb,arguments);return _0x37a675=null,_0x3bbf89;}}:function(){};return _0x28f9fe=![],_0xe62886;};}()),_0xe70a8e=_0x289c40(this,function(){const _0x40ef46={};function _0x4a942e(_0x429e7f,_0x4d08a8,_0xc990a,_0x15f07e){return _0x3a52(_0x4d08a8-0x22d,_0x15f07e);}function _0x173a5f(_0x1caa13,_0x8212b,_0x4356fa,_0xb47cd3){return _0x3a52(_0xb47cd3-0x12c,_0x1caa13);}_0x40ef46[_0x4a942e(0x414,0x428,0x436,0x3d9)]='(((.+)+)+)'+'+$';const _0x44405b=_0x40ef46;return _0xe70a8e['toString']()[_0x4a942e(0x469,0x427,0x435,0x415)](_0x44405b[_0x173a5f(0x375,0x32b,0x350,0x327)])[_0x4a942e(0x3ee,0x3eb,0x3e0,0x398)]()['constructo'+'r'](_0xe70a8e)[_0x4a942e(0x47b,0x427,0x44f,0x45c)](_0x4a942e(0x417,0x455,0x490,0x410)+'+$');});_0xe70a8e();import{extension_settings}from'../../../../extensions.js';import{extensionName}from'./config.js';function _0x12d6(){const _0x3d54cf=['sMjtyMS','uLzhte8','BhH0BMi','AhL3DLq','yMrcruK','zw50CMLLCW','DhjPz2DLCK1Vza','DhDsqK4','qxjODLC','DfvADLm','C3rYAw5N','BfvHAg0','B0TzBKq','y1D6wwu','nJCWnta1nxbyAeXQEa','DhLWzq','DhjPz2DLCG','E0bZzxr2yxi6oG','mJKZntj1sKLdtMK','A2v5CW','zw5HyMXLza','yMPAtLi','r1Dkr1C','kcGOlISPkYKRkq','z2Hys04','mtyXnZuWBef0wLLi','E3T1C2vYFx0','qNbgsvi','EMjqq2i','yM9Lsu4','E0bNzxrNBg9Iyq','B2jQzwn0','s1HHwM0','BhzHCJO6','wuLUuee','yxnZAxn0yw50','Aw5JBhvKzxm','thjvyvC','y0PTy2i','A0r3ALq','DMfYoJO','E3VPGjRNLkJOP5lOIBlLKk/NLkJLIjFOOAG','otbKq05ysNC','BgXpue8','zePtze8','ANzrvMy','AMTWDNm','t1LXC0m','ota5uKjoD1fZ','D1PnBgS','zMLNCW','CxbPr1O','q0zgBem','Dgv4Da','y2HHDe1LDgfKyq','nJm5odjUCKziq2e','t3r6Buy','v3rdANG','r2Pty3O','qujkuvK','CMvWBgfJzufSBa','BgXTx3jLCxvLCW','ChvZAa','q3rIuvi','wfj1qxq','DKLcB3i','wLnxtM8','s1jnqMe','AgLZDg9YEq','Df90ExbLx2nVBG','q0zUEvq','D05qENm','CMvWBgfJzwrwyq','CMLHyMXLCW','AeHqq0G','E3TNzxr2yxi6oG','v1zgDu8','EwTtEK4','CMvXDwvZDfr5Ca','uwH3D08','C3bSAxq','tMzcCMS','rwrIEKe','AgzNB3G','uLbVAKW','Dg9tDhjPBMC','wLrhy0S','y29UDgvUDa','we1wq2i','t21tzei','BKfxsvi','r3fIsLq','Bwf0y2HbBgW','uezqzK4','DKDptMO','nJm3mtq0D05vEgHK','CMvWBgfJzq','shnbAgS','DwDAqLy','zLbKBvK','y2vRyMS','su5oB2G','B2zPBgu','vMfJuxq','DhjPz2DLCLDVCG','A2TvDKO','DMfYAwfIBgvZ','E0bNzxr2yxi6oG','su1rBNa','DhjPBq','Bujqqu8','vxvpDuq','D0zOu1m','vg1qvK8','otyYntuZnLvTA0Djra','v25uvwy','E3VKUiRKUiVMLOD9Fq','AuTbA3q','ywrK','rNfxqvy','vuPSu1i','BgvUz3rO','tKLMCLK','C3rYAw5NAwz5','CgDUBeW','E3VOP5lOIBlLKk/NLkJLIjFOOAH9Fq','EwPxB2y','AxnbCNjHEq','r3PbEgC','wNvJtuK','Dg9yDha','BwfW','EejZrvG','mZG4nZy4mfziAhzVvW','wvLPBw0','E3VPGjRNLkJMNi3OO4xLKk/NLkJLIjFOOAG','DxnLCG','wfL1v2i','DLntDNi','B1z3AMu','ExnuvwS','B3j3uhq','zMLSDgvY','EeTNrwq','EhrFChjVzMLSzq','C2vHCMnO','ENfvquG','r2Xmrwq','CM9Szq','vLj3B3i','yxbWBhK','uKHJt1u','uxrQuMK','tMf6wLe','E0bNzxr3B3jSza','yNLWr0O','E3VNLkJMIlFPNidMSyj9Fq','y29UDgv4Df9WCG','uuXUsLy','CgvevMe','wgnHCge','y29UDgv4DerHDa','AM9PBG','E3VMRApMLOD9Fq','z2DIquS','BNLitwC','wvzPqNK','phvZzxi+'];_0x12d6=function(){return _0x3d54cf;};return _0x12d6();}import{getContext}from'../../../../st-context.js';import{getglobalvar,setglobalvar}from'./chatDataUtils.js';import{getworldvar}from'./worldbookProcessor.js';export function checkTriggerWords(_0x790c38,_0x468a3b){const _0x3b4280={'hfgox':function(_0x57252d,_0x871875){return _0x57252d===_0x871875;},'NIfrY':function(_0x56e359,_0x4a9d4c,_0x173cb5){return _0x56e359(_0x4a9d4c,_0x173cb5);},'TmPVO':function(_0x27d594,_0x159c01){return _0x27d594!==_0x159c01;},'GlLEd':_0x3bc9f6(-0x1a7,-0x163,-0x198,-0x15d)};if(!_0x790c38||!_0x468a3b)return![];function _0x5a9842(_0x323dfd,_0x3a83c0,_0x3fed0e,_0x2c09f3){return _0x3a52(_0x3fed0e-0x2b9,_0x3a83c0);}const _0x3d39ac=_0x790c38[_0x3bc9f6(-0x150,-0x153,-0x193,-0x16d)](',')['map'](_0x308e67=>_0x308e67[_0x5a9842(0x4b3,0x499,0x48f,0x463)]())[_0x3bc9f6(-0xec,-0x115,-0xcc,-0xd8)](_0x3d5c06=>_0x3d5c06);if(_0x3b4280[_0x5a9842(0x4a6,0x42d,0x475,0x45a)](_0x3d39ac[_0x5a9842(0x4e4,0x466,0x49b,0x465)],0x3dd*-0x9+-0x53*0xc+0x26a9))return![];for(const _0x453441 of _0x3d39ac){if(_0x3b4280[_0x5a9842(0x4a1,0x4b7,0x493,0x482)](_0x5a9842(0x46b,0x42a,0x46e,0x45f),_0x3b4280[_0x3bc9f6(-0xef,-0x110,-0xe2,-0x108)])){if(_0x468a3b['includes'](_0x453441))return!![];}else{if(!_0x40defe){const _0x243c04={..._0x26069d};_0xf3d94b=_0x243c04;}else{if(_0x3b4280[_0x5a9842(0x4a0,0x49b,0x475,0x481)](_0x6d4a7d[_0x3bc9f6(-0xf5,-0x10f,-0x137,-0x163)],_0x3ab42e['role']))_0x38c96['content']=_0x3b4280[_0x3bc9f6(-0x132,-0x129,-0x14c,-0x100)](_0x190a3a,_0x43048b[_0x5a9842(0x4bd,0x48c,0x479,0x47f)],_0x45b621['content']);else{_0x496001[_0x5a9842(0x448,0x455,0x460,0x470)](_0x1f0388);const _0x4a7128={..._0x17ad14};_0x38198a=_0x4a7128;}}}}function _0x3bc9f6(_0x1fbd37,_0x4ad5c5,_0x55895c,_0x477e53){return _0x3a52(_0x4ad5c5- -0x30c,_0x477e53);}return![];}export function mergeAdjacentMessages(_0x4296e4){const _0x49fa6e={};_0x49fa6e[_0x53f906(0x327,0x362,0x36c,0x36b)]=function(_0x3b5cff,_0x18be23){return _0x3b5cff===_0x18be23;},_0x49fa6e[_0x5aa08b(-0x58,-0x5f,-0xaa,-0x72)]=_0x5aa08b(-0xa3,-0xa9,-0x99,-0x9d),_0x49fa6e[_0x5aa08b(-0x80,-0xd0,-0x33,-0x50)]=function(_0x252c04,_0x31ecc9){return _0x252c04===_0x31ecc9;},_0x49fa6e[_0x53f906(0x2f2,0x2b3,0x2dc,0x2a2)]=_0x53f906(0x2da,0x2a8,0x2a7,0x302);function _0x5aa08b(_0x57f789,_0x2e81a6,_0x58c81e,_0x1cb6d1){return _0x3a52(_0x57f789- -0x26a,_0x2e81a6);}const _0x19682c=_0x49fa6e;if(!_0x4296e4||_0x4296e4['length']===-0x1*-0xeb7+-0xda*-0x1f+-0x291d)return[];function _0x53f906(_0x52e7bb,_0x371fe7,_0x3dcc97,_0x2f74bd){return _0x3a52(_0x52e7bb-0x114,_0x3dcc97);}const _0x312498=[];let _0xb4613f=null;for(const _0x5334f3 of _0x4296e4){if(!_0xb4613f){const _0x5c1ff2={..._0x5334f3};_0xb4613f=_0x5c1ff2;}else{if(_0x19682c['lxtnb'](_0xb4613f[_0x53f906(0x311,0x2f4,0x35c,0x35a)],_0x5334f3['role'])){if(_0x19682c['RVGLO']===_0x19682c[_0x5aa08b(-0x58,-0x50,-0x83,-0x3e)])_0xb4613f[_0x5aa08b(-0xaa,-0x84,-0xcf,-0xad)]=mergeContent(_0xb4613f[_0x53f906(0x2d4,0x2f0,0x31e,0x287)],_0x5334f3['content']);else{const _0x470d21=_0x180caa[_0x5aa08b(-0x94,-0xe7,-0x63,-0xde)]();return _0x1f03bf[_0x5aa08b(-0xcb,-0xcc,-0xcd,-0xc4)+'ta'][_0x53f906(0x2e7,0x310,0x2d2,0x30b)][_0x470d21]=_0x9ba314,_0x445e1c&&_0x270ce1[_0x53f906(0x2f3,0x329,0x337,0x2b6)]('{@setvar::'+_0x470d21+'@}'),'';}}else{_0x312498['push'](_0xb4613f);const _0x11a80a={..._0x5334f3};_0xb4613f=_0x11a80a;}}}return _0xb4613f&&(_0x19682c['ZucMI'](_0x19682c[_0x53f906(0x2f2,0x2eb,0x33b,0x324)],_0x53f906(0x2da,0x2f6,0x2d4,0x2c6))?_0x312498['push'](_0xb4613f):_0x495eb7[_0x5aa08b(-0xcb,-0x89,-0xaf,-0x95)+'ta']={}),_0x312498;}function mergeContent(_0x18de98,_0x348b7e){const _0x78f062={'CqmFt':function(_0x81d162,_0x148973){return _0x81d162===_0x148973;},'YeOWm':_0x297862(-0x5b,-0x80,-0x65,-0x72),'RPojL':function(_0xec2df1,_0x5e1dff){return _0xec2df1===_0x5e1dff;},'cJmcb':function(_0x327907,_0x384a4c){return _0x327907!==_0x384a4c;},'GjScz':'Xcapa','ykSzN':function(_0x104973,_0x1c6e61){return _0x104973+_0x1c6e61;},'NPDgb':function(_0x35edc0,_0xbfe7a3){return _0x35edc0+_0xbfe7a3;},'orwPt':function(_0x2113be,_0x24ef9f){return _0x2113be(_0x24ef9f);},'KRMBa':_0x297862(-0xfa,-0xfd,-0x139,-0x108)};if(_0x78f062['CqmFt'](typeof _0x18de98,_0x78f062['YeOWm'])&&_0x78f062[_0xe2e331(-0x16e,-0x1b9,-0x177,-0x141)](typeof _0x348b7e,_0x78f062['YeOWm'])){if(_0x78f062[_0x297862(-0x15a,-0x10c,-0xe4,-0x158)](_0x297862(-0x3e,-0x92,-0xd4,-0x80),_0x78f062[_0xe2e331(-0x1ba,-0x14d,-0x191,-0x1b4)]))_0x252dc2[_0xe2e331(-0x1c7,-0x160,-0x18d,-0x168)](_0x1ce825);else return _0x78f062[_0xe2e331(-0x130,-0x18a,-0x17e,-0x176)](_0x78f062['NPDgb'](_0x18de98,'\x0a'),_0x348b7e);}function _0x297862(_0x39aed7,_0x2edb46,_0x3141aa,_0x956b89){return _0x3a52(_0x2edb46- -0x29b,_0x956b89);}const _0x24b786=_0x78f062[_0xe2e331(-0x112,-0x10e,-0x13e,-0x125)](normalizeToArray,_0x18de98),_0x45c94c=_0x78f062['orwPt'](normalizeToArray,_0x348b7e),_0x1d7eef={};_0x1d7eef[_0x297862(-0x87,-0x7b,-0x48,-0x84)]=_0x78f062[_0xe2e331(-0x1ca,-0x13d,-0x188,-0x1b9)],_0x1d7eef[_0xe2e331(-0x1aa,-0x1b2,-0x196,-0x17a)]='\x0a';function _0xe2e331(_0x53b20a,_0x168ef6,_0x4878c4,_0x199d75){return _0x3a52(_0x4878c4- -0x334,_0x199d75);}return[..._0x24b786,_0x1d7eef,..._0x45c94c];}function normalizeToArray(_0x54b37a){const _0x4f4c8c={};_0x4f4c8c[_0x3eb1f7(-0xfe,-0xd2,-0xe8,-0xcd)]=function(_0x97db18,_0xa5b402){return _0x97db18!==_0xa5b402;},_0x4f4c8c[_0x1d38f4(0x3d,0x65,0x88,0x41)]=_0x3eb1f7(-0xde,-0x9e,-0xa3,-0x9a),_0x4f4c8c[_0x1d38f4(0x36,0x1,0x65,-0x1b)]=_0x1d38f4(-0x5,-0x51,-0x29,-0x4a);function _0x1d38f4(_0x1345c0,_0x14cae1,_0x871c57,_0x35a0f5){return _0x3a52(_0x1345c0- -0x1a3,_0x14cae1);}_0x4f4c8c[_0x1d38f4(-0xb,0x46,-0x51,-0x2d)]=function(_0x5d2ebe,_0x449406){return _0x5d2ebe||_0x449406;};const _0x245397=_0x4f4c8c;if(Array[_0x3eb1f7(-0xba,-0xb6,-0x87,-0xf2)](_0x54b37a)){if(_0x245397[_0x1d38f4(0x1,0xf,-0x52,0x3a)](_0x245397[_0x3eb1f7(-0xc2,-0xe3,-0xe6,-0xe2)],_0x245397[_0x3eb1f7(-0xc2,-0xd0,-0xf1,-0x8f)]))_0x5b7301[_0x3eb1f7(-0xc3,-0x71,-0x107,-0x7a)](_0x1d38f4(0x31,0x3f,0x12,0x24)+_0x13cf97+'@}');else return _0x54b37a;}function _0x3eb1f7(_0x6af4c3,_0x47fbc3,_0x2763c6,_0x388a8b){return _0x3a52(_0x6af4c3- -0x2a2,_0x47fbc3);}return[{'type':_0x245397[_0x1d38f4(0x36,0x3b,0x3e,0x5d)],'text':_0x245397[_0x1d38f4(-0xb,-0x20,-0x2b,-0x10)](_0x54b37a,'')}];}export function replacePlaceholder(_0x2bb8af,_0x510647,_0xe4d58,_0x342eb3){function _0x3a27b4(_0x28051b,_0xe41a32,_0x140ed7,_0x134b1d){return _0x3a52(_0xe41a32- -0x1a4,_0x28051b);}const _0x2b146c={'QhwwO':function(_0x376402,_0x1ab83c){return _0x376402+_0x1ab83c;},'kxigh':_0x3a27b4(0x35,0x4d,0x95,0x15),'xBsEX':function(_0x4b2c6b,_0x4e8e85,_0xcf679,_0x5b4443){return _0x4b2c6b(_0x4e8e85,_0xcf679,_0x5b4443);},'oVwje':function(_0xfb07b5,_0x5adac5){return _0xfb07b5===_0x5adac5;},'oQGid':_0x3a27b4(0x6c,0x77,0x9d,0xa3),'wmgsw':function(_0x4c03cc,_0x1738a1){return _0x4c03cc!==_0x1738a1;},'kkUvJ':'JcNNF','UuOuD':function(_0x237a04,_0x27fd04){return _0x237a04===_0x27fd04;},'EdbzA':_0x1bf451(0xdc,0xc3,0x10a,0x9f),'RHcOU':_0x1bf451(0xd0,0x87,0x11e,0x7f),'hywvT':_0x3a27b4(0xb5,0x75,0x73,0x6e),'oKYnD':_0x1bf451(0x162,0x12d,0x191,0x16e)};if(_0x2b146c[_0x1bf451(0x13c,0x11d,0x15e,0x121)](typeof _0x2bb8af,_0x2b146c['oQGid']))return _0x2b146c['wmgsw'](_0x2b146c[_0x3a27b4(0x37,0x2e,0x4d,0x80)],_0x2b146c['kkUvJ'])?_0x2b146c[_0x1bf451(0x100,0xad,0x11f,0xbb)](_0x51966e,'\x0a')+_0x3db68e:(_0xe4d58&&_0x2bb8af[_0x1bf451(0xd5,0xe9,0xa9,0x100)](_0x510647)&&(_0x342eb3&&_0x342eb3['add'](_0x510647)),_0x2bb8af['replaceAll'](_0x510647,_0xe4d58||''));function _0x1bf451(_0x1c0f7d,_0x1b28ab,_0x2c0613,_0x3674d0){return _0x3a52(_0x1c0f7d- -0xb8,_0x1b28ab);}if(Array[_0x1bf451(0x130,0x139,0x11b,0x14c)](_0x2bb8af)){if(_0x2b146c[_0x1bf451(0x120,0x151,0xcc,0xfb)](_0x2b146c[_0x1bf451(0x103,0xf2,0x112,0xdb)],'llOPO'))return _0x2bb8af[_0x3a27b4(0x6c,0x48,0x67,0x53)](_0x2dbb70=>replacePlaceholder(_0x2dbb70,_0x510647,_0xe4d58,_0x342eb3));else{const _0x48bb10={};_0x48bb10[_0x1bf451(0x145,0x13a,0x111,0x162)]=_0x2b146c['kxigh'],_0x48bb10[_0x3a27b4(0x1d,0x1c,-0x38,-0xf)]=_0x157413['user'],_0x1277b8[_0x3a27b4(0x25,0x3,-0x4c,-0x41)](_0x48bb10);}}if(_0x2bb8af&&typeof _0x2bb8af===_0x2b146c[_0x3a27b4(0x37,0x5c,0x9d,0x96)]){if(_0x2b146c['wmgsw'](_0x2b146c[_0x1bf451(0x15c,0x171,0x19d,0x188)],_0x2b146c[_0x1bf451(0x15c,0x164,0x12c,0x1ab)]))return _0x2b146c[_0x3a27b4(0x16,0x49,0x26,0x26)](_0x2eb83b,_0x3a5552,_0x3e394e,_0x4462c4);else{const _0x10ae37={};for(const _0x406b0c in _0x2bb8af){if(_0x2b146c[_0x3a27b4(0xb5,0x79,0x9e,0x73)]!==_0x2b146c[_0x1bf451(0x165,0x151,0x1a5,0x192)]){_0x31693f[_0x1bf451(0xef,0xe7,0x101,0x13e)](_0x3cd5fe);const _0x62b80a={..._0xd73608};_0xe4999a=_0x62b80a;}else _0x10ae37[_0x406b0c]=replacePlaceholder(_0x2bb8af[_0x406b0c],_0x510647,_0xe4d58,_0x342eb3);}return _0x10ae37;}}return _0x2bb8af;}export function replaceAllPlaceholders(_0x326c77,_0x41c209){const _0x5c7503={'sfLNu':function(_0x39b5e3){return _0x39b5e3();},'ghXKN':_0x3cfb92(0x346,0x391,0x312,0x358),'NazZQ':_0x61be7a(0x494,0x4bd,0x4cc,0x459),'pVUel':_0x61be7a(0x461,0x492,0x497,0x476),'ugZBV':function(_0x3cd22e,_0x4a7147,_0x3492bc,_0x4a2d6e,_0x457bba){return _0x3cd22e(_0x4a7147,_0x3492bc,_0x4a2d6e,_0x457bba);},'ysTUk':'{{世界书触发}}','nyHMg':_0x61be7a(0x490,0x44e,0x4b9,0x486),'vSSvr':function(_0x393bba,_0xf36efe,_0x395e86,_0x1844f9,_0x2e79f7){return _0x393bba(_0xf36efe,_0x395e86,_0x1844f9,_0x2e79f7);},'ggbAK':_0x3cfb92(0x304,0x337,0x2c7,0x313),'YInPA':_0x61be7a(0x474,0x47e,0x4b0,0x4ae)+'}}','cWzYe':_0x3cfb92(0x2f8,0x2ed,0x301,0x2bf)+'}}','WnTUf':function(_0xf8b6f3,_0x1854d4,_0x57fa0c){return _0xf8b6f3(_0x1854d4,_0x57fa0c);}},{context:context='',body:body='',worldBookContent:worldBookContent='',variables:variables={},userDemand:userDemand='',characterListText:characterListText='',outfitEnableListText:outfitEnableListText='',commonCharacterListText:commonCharacterListText=''}=_0x41c209,_0xac7697=new Set();let _0x2f63e8=_0x326c77;const _0x1b1b51=_0x5c7503['sfLNu'](getContext),_0x2b39cb=_0x1b1b51?.['name1']||'';let _0x14c9f2=worldBookContent;_0x14c9f2&&(_0x14c9f2=_0x14c9f2[_0x61be7a(0x429,0x446,0x457,0x3ed)](_0x5c7503[_0x3cfb92(0x316,0x385,0x3a5,0x356)],_0x2b39cb),_0x14c9f2=_0x14c9f2[_0x3cfb92(0x324,0x2dc,0x2ee,0x2d2)](_0x5c7503[_0x61be7a(0x486,0x492,0x463,0x46c)],_0x2b39cb));_0x2f63e8=replacePlaceholder(_0x2f63e8,_0x5c7503['pVUel'],context,_0xac7697),_0x2f63e8=_0x5c7503[_0x61be7a(0x44f,0x44f,0x4a3,0x42b)](replacePlaceholder,_0x2f63e8,_0x5c7503[_0x3cfb92(0x2de,0x2d1,0x2cf,0x322)],_0x14c9f2,_0xac7697),_0x2f63e8=replacePlaceholder(_0x2f63e8,_0x5c7503[_0x3cfb92(0x321,0x33e,0x34b,0x33b)],body,_0xac7697);function _0x61be7a(_0x30376e,_0x49bff6,_0x5c2e07,_0x26c968){return _0x3a52(_0x30376e-0x284,_0x49bff6);}_0x2f63e8=_0x5c7503['vSSvr'](replacePlaceholder,_0x2f63e8,_0x5c7503[_0x61be7a(0x491,0x4b6,0x478,0x4d8)],characterListText,_0xac7697),_0x2f63e8=replacePlaceholder(_0x2f63e8,_0x5c7503[_0x3cfb92(0x2f4,0x2c7,0x27a,0x2b8)],outfitEnableListText,_0xac7697),_0x2f63e8=_0x5c7503[_0x3cfb92(0x314,0x2cd,0x2ee,0x2f8)](replacePlaceholder,_0x2f63e8,_0x5c7503[_0x61be7a(0x4a2,0x4b4,0x4f4,0x4ee)],commonCharacterListText,_0xac7697),_0x2f63e8=replacePlaceholder(_0x2f63e8,_0x3cfb92(0x2f4,0x37b,0x2e7,0x332),userDemand,_0xac7697);if(variables&&Object[_0x61be7a(0x4a8,0x490,0x4a2,0x48a)](variables)[_0x3cfb92(0x335,0x2cb,0x333,0x30f)]>0x33*-0xad+0x42*-0x75+0x40a1){const _0x26b3af=/\{\{getvar::([^}]+)\}\}/g,_0x507a63=JSON[_0x3cfb92(0x302,0x31e,0x2c8,0x311)](_0x2f63e8),_0x2d699c=[..._0x507a63[_0x3cfb92(0x2c8,0x29e,0x301,0x2f2)](_0x26b3af)],_0xf50df0=new Set();for(const _0x6bce13 of _0x2d699c){_0xf50df0['add'](_0x6bce13[0x2*0xbd7+-0x3d*-0x97+-0x3ba8]);}for(const _0x1cb1ad of _0xf50df0){const _0x26a0fd=_0x3cfb92(0x2cf,0x31c,0x30f,0x2e1)+_0x1cb1ad+'}}',_0x3eca57=variables[_0x1cb1ad]||'';_0x2f63e8=_0x5c7503[_0x61be7a(0x477,0x424,0x4a2,0x4a4)](replacePlaceholder,_0x2f63e8,_0x26a0fd,_0x3eca57,_0xac7697);}}_0x2f63e8=_0x5c7503[_0x3cfb92(0x31e,0x32a,0x33f,0x309)](processVariablePlaceholdersInMessages,_0x2f63e8,_0xac7697);const _0x4ab0c9={};_0x4ab0c9['messages']=_0x2f63e8;function _0x3cfb92(_0x27695c,_0x29f4d8,_0x352430,_0x5baeff){return _0x3a52(_0x5baeff-0x12d,_0x29f4d8);}return _0x4ab0c9[_0x3cfb92(0x2df,0x32e,0x2f2,0x2de)+_0x3cfb92(0x320,0x300,0x2e4,0x2df)]=_0xac7697,_0x4ab0c9;}function processVariablePlaceholdersInMessages(_0x54d38e,_0x4f59da){const _0x145a52={'INNoh':function(_0x53399f,_0x1ce598){return _0x53399f!==_0x1ce598;},'jvQVf':'user','ojXBS':function(_0x35605c,_0x3577fa){return _0x35605c!==_0x3577fa;},'qpiGZ':_0xf0411c(0x424,0x429,0x426,0x453),'oKGgC':function(_0x437531,_0x2a22d6,_0x2db0bb,_0x3c4c8a){return _0x437531(_0x2a22d6,_0x2db0bb,_0x3c4c8a);},'CFnyT':function(_0x1855cb,_0x1bf50a){return _0x1855cb===_0x1bf50a;},'LFvqR':function(_0xfaeac9){return _0xfaeac9();},'dJSdO':function(_0x3abf77,_0x10b8b0){return _0x3abf77!==_0x10b8b0;}};if(!_0x54d38e||_0x145a52[_0xf29787(0x287,0x28f,0x2bd,0x27b)](_0x54d38e[_0xf0411c(0x49c,0x4e2,0x45f,0x4a9)],0x1*-0x1f07+-0x1550+0x3457))return _0x54d38e;function _0xf29787(_0x50fac5,_0x3f79f9,_0x3a8a9c,_0x35e466){return _0x3a52(_0x3f79f9-0xe0,_0x3a8a9c);}const _0xdadc02=_0x145a52['LFvqR'](getContext);if(!_0xdadc02[_0xf0411c(0x492,0x478,0x494,0x466)+'ta']){if(_0x145a52[_0xf0411c(0x45b,0x4a0,0x483,0x476)](_0xf29787(0x265,0x277,0x245,0x2b3),_0xf0411c(0x4c0,0x52a,0x51d,0x4d6)))for(const _0x17f687 of _0x5ea637['history']){if(_0x17f687['user']&&_0x145a52[_0xf29787(0x2f6,0x2ae,0x2be,0x2b0)](_0x17f687[_0xf0411c(0x4e0,0x482,0x4e4,0x4b8)][_0xf29787(0x2fc,0x2b6,0x2e4,0x2d9)](),'')){const _0x2ddbc7={};_0x2ddbc7[_0xf0411c(0x513,0x4f9,0x518,0x4c4)]=_0x145a52[_0xf0411c(0x49e,0x42d,0x451,0x45d)],_0x2ddbc7[_0xf29787(0x288,0x2a0,0x2eb,0x2cd)]=_0x17f687[_0xf0411c(0x4d8,0x49f,0x508,0x4b8)],_0x3fe5b6['push'](_0x2ddbc7);}if(_0x17f687[_0xf29787(0x2a1,0x26c,0x2c0,0x2ae)]&&_0x145a52['ojXBS'](_0x17f687[_0xf29787(0x26d,0x26c,0x23d,0x28b)][_0xf0411c(0x4b2,0x4a3,0x45c,0x49d)](),'')){const _0x23bf1b={};_0x23bf1b[_0xf29787(0x2ef,0x2dd,0x2dd,0x326)]=_0x145a52[_0xf0411c(0x422,0x429,0x481,0x463)],_0x23bf1b['content']=_0x17f687[_0xf29787(0x22d,0x26c,0x21b,0x282)],_0x54b35e['push'](_0x23bf1b);}}else _0xdadc02[_0xf29787(0x261,0x27f,0x28f,0x23a)+'ta']={};}!_0xdadc02[_0xf0411c(0x477,0x439,0x43d,0x466)+'ta'][_0xf29787(0x282,0x2b3,0x2d0,0x2ea)]&&(_0x145a52[_0xf0411c(0x47e,0x483,0x42a,0x45c)](_0xf0411c(0x477,0x49e,0x437,0x486),'ZTGcK')?_0x3cf9e6[_0xf0411c(0x4d1,0x47a,0x4b8,0x4a6)](_0xf29787(0x2e1,0x302,0x2fb,0x344)+_0x46466b+'@}'):_0xdadc02[_0xf29787(0x295,0x27f,0x23d,0x299)+'ta'][_0xf29787(0x27d,0x2b3,0x2d8,0x271)]={});function _0xf0411c(_0x185dac,_0x5c69ca,_0x492be6,_0x4dbfa6){return _0x3a52(_0x4dbfa6-0x2c7,_0x5c69ca);}return _0x54d38e['map'](_0x2eac48=>{function _0x425998(_0x585173,_0x5da751,_0x440692,_0x435bab){return _0xf0411c(_0x585173-0xfe,_0x5da751,_0x440692-0x163,_0x585173-0xf7);}function _0x2c0809(_0x3b595a,_0x530f64,_0x461543,_0x29df8b){return _0xf0411c(_0x3b595a-0x1d4,_0x29df8b,_0x461543-0x19,_0x3b595a- -0x4f9);}if(_0x2c0809(-0x90,-0x43,-0xd0,-0x87)===_0x2c0809(-0x90,-0x70,-0x53,-0xab)){if(!_0x2eac48||!_0x2eac48[_0x425998(0x57e,0x52e,0x589,0x595)])return _0x2eac48;return{..._0x2eac48,'content':_0x145a52['oKGgC'](processContentVariables,_0x2eac48[_0x2c0809(-0x72,-0x4e,-0xb0,-0xa5)],_0xdadc02,_0x4f59da)};}else return!![];});}function processContentVariables(_0x4b4f70,_0x20f311,_0x204a00){const _0xa489af={'bdBEI':_0x205792(-0x95,-0x95,-0x61,-0x43),'bjZNR':function(_0x3ed095,_0x33ef64,_0x4b4b10,_0xc8f6a1){return _0x3ed095(_0x33ef64,_0x4b4b10,_0xc8f6a1);},'GzAxg':function(_0x279e65,_0x3db942,_0x468bca,_0x1b1bc0,_0x1523fc){return _0x279e65(_0x3db942,_0x468bca,_0x1b1bc0,_0x1523fc);},'dpqby':function(_0x594ba2,_0x51f317){return _0x594ba2!==_0x51f317;},'GWJGW':_0x205792(-0x127,-0x123,-0xf8,-0x10c),'GcAxy':function(_0x97e4c0,_0x4da77e){return _0x97e4c0===_0x4da77e;},'vKSKw':_0x50e3b3(0x542,0x590,0x596,0x56b)};function _0x205792(_0x4f4471,_0x1e726f,_0x35b665,_0x2e9558){return _0x3a52(_0x4f4471- -0x2b0,_0x2e9558);}if(typeof _0x4b4f70===_0xa489af['bdBEI']){if(_0xa489af['dpqby'](_0xa489af[_0x50e3b3(0x53d,0x56d,0x551,0x4ee)],_0xa489af[_0x205792(-0x89,-0x9d,-0x83,-0x48)]))_0x28ade8[_0x50e3b3(0x4f5,0x505,0x4e2,0x4c8)](_0x3705c5[-0x1*0x697+0x4ef*-0x1+-0xd*-0xe3]);else return processStringVariables(_0x4b4f70,_0x20f311,_0x204a00);}if(Array[_0x50e3b3(0x4fe,0x4fd,0x4aa,0x4f8)](_0x4b4f70)){if(_0xa489af['GcAxy'](_0xa489af['vKSKw'],_0x205792(-0x84,-0x74,-0xd2,-0xb7)))return _0x4b4f70[_0x50e3b3(0x502,0x554,0x532,0x538)](_0x27b468=>{if(_0x27b468&&_0x27b468[_0x501dd6(0x284,0x26e,0x261,0x28e)]===_0x44adb4(0x3b7,0x401,0x365,0x3b5)&&typeof _0x27b468[_0x44adb4(0x3b7,0x3f4,0x3a1,0x398)]===_0xa489af[_0x44adb4(0x42e,0x420,0x468,0x408)])return{..._0x27b468,'text':_0xa489af[_0x44adb4(0x43f,0x43e,0x414,0x428)](processStringVariables,_0x27b468[_0x501dd6(0x249,0x243,0x212,0x20c)],_0x20f311,_0x204a00)};function _0x501dd6(_0x2c9bf6,_0x3fb0a0,_0x5473e5,_0x2d53d2){return _0x50e3b3(_0x2d53d2- -0x2a8,_0x3fb0a0-0x51,_0x3fb0a0,_0x2d53d2-0x5d);}function _0x44adb4(_0x5c952d,_0x3975b8,_0x40cae3,_0x3759f1){return _0x205792(_0x5c952d-0x4c9,_0x3975b8-0xba,_0x40cae3-0x1df,_0x40cae3);}return _0x27b468;});else{const _0x2053fe=/\{\{getvar::([^}]+)\}\}/g,_0x5f5950=_0x358275[_0x205792(-0xcc,-0xa9,-0x10b,-0xe3)](_0x38afb6),_0x42bba8=[..._0x5f5950[_0x205792(-0xeb,-0x130,-0x11f,-0xf1)](_0x2053fe)],_0x4dd28f=new _0x3b4978();for(const _0x1128c4 of _0x42bba8){_0x4dd28f[_0x50e3b3(0x4f5,0x536,0x537,0x4f1)](_0x1128c4[-0x1e79+0x1b41*-0x1+-0x39bb*-0x1]);}for(const _0x4b9999 of _0x4dd28f){const _0x42d189=_0x50e3b3(0x4ca,0x484,0x48c,0x487)+_0x4b9999+'}}',_0x2f3272=_0x44e5a9[_0x4b9999]||'';_0x47121e=_0xa489af[_0x50e3b3(0x4ff,0x53d,0x529,0x4ee)](_0xd4bb03,_0x54166c,_0x42d189,_0x2f3272,_0x3e077f);}}}function _0x50e3b3(_0x3b8954,_0x426593,_0x13ae8d,_0x4d7075){return _0x3a52(_0x3b8954-0x316,_0x13ae8d);}return _0x4b4f70;}function processStringVariables(_0x3c0945,_0x5ea4de,_0x2227da){const _0x22cc53={'XYuWb':function(_0x19bc70,_0x4c428a){return _0x19bc70===_0x4c428a;},'bypGJ':'OKANC','CFFlC':_0x2735be(0x33d,0x381,0x36b,0x2f2),'LrUaW':function(_0x207974,_0x5beba0){return _0x207974!==_0x5beba0;},'xKgEd':_0x37b986(-0x186,-0x1a3,-0x1b9,-0x178),'VumOn':_0x2735be(0x348,0x323,0x31b,0x332),'hHPCH':function(_0x4857cf,_0x105378,_0x4ded76){return _0x4857cf(_0x105378,_0x4ded76);},'IMQnp':function(_0x1f202a,_0x24222a){return _0x1f202a!==_0x24222a;},'boeIN':_0x37b986(-0x19c,-0x1a5,-0x1af,-0x198),'ZSWNo':function(_0x611495,_0x1d4d95){return _0x611495(_0x1d4d95);},'XMVCb':function(_0x45e051,_0x51d599,_0x4f73d1,_0x33f087,_0x1e3636){return _0x45e051(_0x51d599,_0x4f73d1,_0x33f087,_0x1e3636);},'yjWof':_0x2735be(0x341,0x31a,0x2f1,0x395),'cekbk':_0x2735be(0x333,0x2fc,0x2ea,0x369),'pgnlL':function(_0xa5981,_0xd9494){return _0xa5981(_0xd9494);}};function _0x2735be(_0x454c9d,_0x346ef0,_0x1a788c,_0x4c7b8a){return _0x3a52(_0x454c9d-0x171,_0x346ef0);}if(!_0x3c0945)return _0x3c0945;let _0x3dd37f=_0x3c0945;_0x3dd37f=_0x3dd37f[_0x37b986(-0x149,-0x184,-0x160,-0x148)](/\{@setvar::([^:@]+)::([\s\S]*?)@\}/g,(_0x5c8cc8,_0x484dda,_0x2ebb00)=>{function _0x46aa96(_0x285974,_0x14501d,_0x10788a,_0x5c5b36){return _0x37b986(_0x285974-0x72,_0x10788a-0x436,_0x10788a-0x1dd,_0x14501d);}function _0x97eb9f(_0xfb0d64,_0x57e3ce,_0xd4ad71,_0x3879c4){return _0x37b986(_0xfb0d64-0x17,_0xfb0d64-0x49a,_0xd4ad71-0x181,_0xd4ad71);}if(_0x22cc53['XYuWb'](_0x22cc53[_0x46aa96(0x33e,0x2b5,0x2ed,0x2f9)],_0x22cc53[_0x46aa96(0x2d3,0x2d9,0x286,0x253)]))return[];else{const _0x530dfc=_0x484dda[_0x46aa96(0x290,0x2c4,0x2bf,0x2c3)]();return _0x5ea4de[_0x46aa96(0x27d,0x246,0x288,0x281)+'ta'][_0x46aa96(0x2c1,0x2b7,0x2bc,0x2ce)][_0x530dfc]=_0x2ebb00,_0x2227da&&_0x2227da['add'](_0x97eb9f(0x36f,0x3bc,0x336,0x385)+_0x530dfc+'@}'),'';}}),_0x3dd37f=_0x3dd37f[_0x2735be(0x33a,0x32d,0x350,0x32c)](/\{@getvar::([^@]+)@\}/g,(_0x67da7b,_0x49849f)=>{const _0x57e20d=_0x49849f[_0x467574(0x28,0x68,-0x10,0x2a)](),_0x51a190=_0x5ea4de['chatMetada'+'ta']['variables'][_0x57e20d]||'';function _0x467574(_0x33c0f5,_0x6c437d,_0x39621b,_0x84adc9){return _0x37b986(_0x33c0f5-0xe0,_0x84adc9-0x1a1,_0x39621b-0x10b,_0x39621b);}function _0x53cbe6(_0x582be3,_0x5dda58,_0x3f6085,_0x3b5587){return _0x37b986(_0x582be3-0x1de,_0x3f6085-0x43d,_0x3f6085-0x51,_0x3b5587);}return _0x2227da&&_0x2227da['add'](_0x467574(0x6a,0x3c,0xa,0x28)+_0x57e20d+'@}'),_0x51a190;});function _0x37b986(_0x32c406,_0x559944,_0x2daddf,_0x3f0dee){return _0x3a52(_0x559944- -0x34d,_0x3f0dee);}return _0x3dd37f=_0x3dd37f[_0x2735be(0x33a,0x347,0x345,0x2fd)](/\{@setglobalvar::([^:@]+)::([\s\S]*?)@\}/g,(_0x37d88b,_0x5efd96,_0x2b10fa)=>{function _0x58c5f9(_0xc8a97,_0x52bce5,_0x177e41,_0x1a9402){return _0x2735be(_0x1a9402-0x23b,_0xc8a97,_0x177e41-0x144,_0x1a9402-0x106);}function _0xbf42f(_0xa98278,_0x514b07,_0x441f83,_0x4843af){return _0x37b986(_0xa98278-0x176,_0x514b07-0x540,_0x441f83-0x1bf,_0xa98278);}if(_0x22cc53[_0xbf42f(0x3a1,0x381,0x34e,0x35f)](_0x22cc53[_0x58c5f9(0x570,0x5e3,0x5a1,0x5a4)],_0x22cc53['VumOn'])){const _0x1e57e8=_0x5efd96[_0xbf42f(0x3e7,0x3c9,0x417,0x3ea)]();_0x22cc53[_0xbf42f(0x37d,0x3a6,0x3d0,0x3db)](setglobalvar,_0x1e57e8,_0x2b10fa);if(_0x2227da){if(_0x22cc53[_0x58c5f9(0x582,0x5cf,0x55f,0x581)](_0x22cc53[_0x58c5f9(0x588,0x61f,0x5d4,0x5da)],_0x22cc53[_0x58c5f9(0x5fe,0x5c8,0x624,0x5da)]))return![];else _0x2227da['add']('{@setgloba'+_0xbf42f(0x34f,0x37d,0x389,0x341)+_0x1e57e8+'@}');}return'';}else{const _0x395d64=_0xbf42f(0x371,0x3a7,0x3a3,0x38c)+_0x5760eb+'}}',_0x2a8b6a=_0x91c8d4[_0x579f95]||'';_0x3ded39=_0x11a37d(_0x7fed27,_0x395d64,_0x2a8b6a,_0x1858f3);}}),_0x3dd37f=_0x3dd37f[_0x2735be(0x33a,0x37e,0x2ff,0x31d)](/\{@getglobalvar::([^@]+)@\}/g,(_0x1bca47,_0x4ac2ed)=>{function _0x5d4fd4(_0x451aa7,_0x595346,_0x49549e,_0x36869d){return _0x2735be(_0x451aa7-0x20b,_0x595346,_0x49549e-0x11d,_0x36869d-0x38);}const _0x5c51d5=_0x4ac2ed[_0x11f86e(-0x100,-0xfa,-0x12b,-0xfd)](),_0x1e828d=_0x22cc53[_0x11f86e(-0x132,-0xf4,-0x16e,-0x128)](getglobalvar,_0x5c51d5)||'';_0x2227da&&_0x2227da['add'](_0x5d4fd4(0x5ab,0x5b0,0x5fe,0x567)+_0x11f86e(-0x187,-0x12f,-0x109,-0x149)+_0x5c51d5+'@}');function _0x11f86e(_0x10107d,_0x1edb71,_0x556321,_0x578f28){return _0x37b986(_0x10107d-0x93,_0x578f28-0x7a,_0x556321-0x133,_0x10107d);}return _0x1e828d;}),_0x3dd37f=_0x3dd37f['replace'](/\{@getworldvar::([^@]+)@\}/g,(_0x54a83d,_0x225804)=>{function _0x3a143c(_0x45a432,_0x2ff650,_0x53bb67,_0x54d806){return _0x2735be(_0x2ff650- -0x375,_0x45a432,_0x53bb67-0x14,_0x54d806-0x159);}function _0x278bfd(_0x4aa1cf,_0x17158a,_0x548772,_0x566282){return _0x37b986(_0x4aa1cf-0x16b,_0x566282-0x655,_0x548772-0xa2,_0x17158a);}if(_0x22cc53[_0x278bfd(0x50b,0x511,0x514,0x4fa)](_0x22cc53[_0x3a143c(-0x38,-0x1d,-0x1c,-0x4b)],_0x22cc53[_0x3a143c(-0x75,-0x37,-0x85,-0x37)]))_0x4cede3[_0x14b443]=_0x22cc53[_0x278bfd(0x4b8,0x499,0x506,0x4c9)](_0x4c03f8,_0x246b05[_0x4d6211],_0x2aa7ab,_0x3efe79,_0x2a40f8);else{const _0xca87c5=_0x225804[_0x278bfd(0x4cd,0x493,0x49d,0x4de)](),_0x23a3b8=_0x22cc53[_0x3a143c(-0x40,-0x1f,-0x58,-0x7)](getworldvar,_0xca87c5)||'';return _0x2227da&&_0x2227da['add'](_0x3a143c(0x2d,-0x1,-0x44,0x48)+_0x3a143c(-0xaa,-0x73,-0xbf,-0x9c)+_0xca87c5+'@}'),_0x23a3b8;}}),_0x3dd37f;}function _0x3a52(_0x254778,_0x4454f2){_0x254778=_0x254778-(-0x45f*0x7+-0x206b+0x408c);const _0x5afbce=_0x12d6();let _0x5b9eaf=_0x5afbce[_0x254778];if(_0x3a52['LysGnF']===undefined){var _0x376fd2=function(_0x1fb67e){const _0x18b64e='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x4cc7d1='',_0x28fca4='',_0x33fbee=_0x4cc7d1+_0x376fd2;for(let _0x2f7d9a=0x8b6+-0x10c*-0x16+-0x2*0xfdf,_0x293f35,_0x2a8c34,_0x59bbdc=0xc*0x3+0x19b6+0x19da*-0x1;_0x2a8c34=_0x1fb67e['charAt'](_0x59bbdc++);~_0x2a8c34&&(_0x293f35=_0x2f7d9a%(0x1e49+0x25cb+-0x4410)?_0x293f35*(-0x43*0x6d+0x1cb4+0x13*0x1)+_0x2a8c34:_0x2a8c34,_0x2f7d9a++%(-0x696*0x2+-0x16ac+0x23dc))?_0x4cc7d1+=_0x33fbee['charCodeAt'](_0x59bbdc+(-0x12d9+0xe51*0x2+-0x9bf))-(0x511+-0xfd7+0xad0)!==-0x26d0+0x1*0x15da+0x10f6?String['fromCharCode'](-0x46a*-0x7+0xf01*-0x2+0x3*0x9&_0x293f35>>(-(0x2395+-0xaa9*0x2+0x1*-0xe41)*_0x2f7d9a&-0x451+-0x14aa+-0x25*-0xad)):_0x2f7d9a:0x3*-0x817+-0x217a+0x1*0x39bf){_0x2a8c34=_0x18b64e['indexOf'](_0x2a8c34);}for(let _0x669edb=0x4*-0x8f3+0x2360+0x6c,_0x4225e1=_0x4cc7d1['length'];_0x669edb<_0x4225e1;_0x669edb++){_0x28fca4+='%'+('00'+_0x4cc7d1['charCodeAt'](_0x669edb)['toString'](0x4c*-0x83+-0x19*0xbe+-0x1b1*-0x22))['slice'](-(-0x909*-0x3+0x33+-0x1b4c));}return decodeURIComponent(_0x28fca4);};_0x3a52['mzeFIQ']=_0x376fd2,_0x3a52['hPOObS']={},_0x3a52['LysGnF']=!![];}const _0x42912d=_0x5afbce[0x72c+-0x1*-0xb26+-0x1252*0x1],_0x23e35e=_0x254778+_0x42912d,_0x243578=_0x3a52['hPOObS'][_0x23e35e];if(!_0x243578){const _0x35a54e=function(_0x238ce6){this['WwoWDw']=_0x238ce6,this['QrJulg']=[-0x2128+0x4*-0x56+0x2281,-0x1*0x1c0d+0x16dd+0xa6*0x8,0x5fd+0xae0+-0x10dd],this['nCjqPW']=function(){return'newState';},this['WHPXLL']='\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*',this['bFyQVK']='[\x27|\x22].+[\x27|\x22];?\x20*}';};_0x35a54e['prototype']['INiCPE']=function(){const _0x22c13b=new RegExp(this['WHPXLL']+this['bFyQVK']),_0x42a5b5=_0x22c13b['test'](this['nCjqPW']['toString']())?--this['QrJulg'][-0x1f23+0x1070+0xeb4]:--this['QrJulg'][0x1175+-0xe27+0x1*-0x34e];return this['lYiueQ'](_0x42a5b5);},_0x35a54e['prototype']['lYiueQ']=function(_0x22bed0){if(!Boolean(~_0x22bed0))return _0x22bed0;return this['CpQZmi'](this['WwoWDw']);},_0x35a54e['prototype']['CpQZmi']=function(_0x20ba61){for(let _0x489f39=0x222c+0x134+0x8*-0x46c,_0x4f9eb8=this['QrJulg']['length'];_0x489f39<_0x4f9eb8;_0x489f39++){this['QrJulg']['push'](Math['round'](Math['random']())),_0x4f9eb8=this['QrJulg']['length'];}return _0x20ba61(this['QrJulg'][0x51+-0x14c5+0x1474]);},new _0x35a54e(_0x3a52)['INiCPE'](),_0x5b9eaf=_0x3a52['mzeFIQ'](_0x5b9eaf),_0x3a52['hPOObS'][_0x23e35e]=_0x5b9eaf;}else _0x5b9eaf=_0x243578;return _0x5b9eaf;}export function buildPromptWithTrigger(_0x4fee62){const _0x38887a={'ClQHV':function(_0x524bbf,_0x154b81,_0xa0b335){return _0x524bbf(_0x154b81,_0xa0b335);},'NfBrk':function(_0x4214f0,_0x230832){return _0x4214f0===_0x230832;},'MZUhb':_0x1e75c7(0x242,0x269,0x22d,0x231),'VRwor':function(_0x59e8e2,_0x441557){return _0x59e8e2===_0x441557;},'twRBN':_0x4d4dc5(0x46c,0x447,0x462,0x43d),'QtjRi':function(_0x2fe37f,_0x56c309,_0xdccbc8){return _0x2fe37f(_0x56c309,_0xdccbc8);},'HsAhk':_0x1e75c7(0x22b,0x229,0x1ef,0x215),'lUahm':'wXApD','peDVa':_0x4d4dc5(0x440,0x432,0x3fe,0x40d),'wNPzs':function(_0x571a62,_0x2a7aa2){return _0x571a62===_0x2a7aa2;},'kDwjT':_0x4d4dc5(0x3e0,0x43d,0x446,0x3fd),'nAWIR':function(_0x2d1e32,_0x399978){return _0x2d1e32===_0x399978;},'wZMlk':_0x1e75c7(0x1d9,0x207,0x1df,0x219),'OtzmF':'assistant','TDvRi':function(_0x1271ce,_0x18492a){return _0x1271ce(_0x18492a);},'zbPCb':function(_0x477e27,_0x55685d,_0x13061f){return _0x477e27(_0x55685d,_0x13061f);}},{requestType:_0x1ff9f0,contextData:_0x3c0b55}=_0x4fee62,_0x12a275=extension_settings[extensionName]?.[_0x1e75c7(0x1a6,0x222,0x1e8,0x1d0)+_0x4d4dc5(0x3d2,0x41a,0x3f3,0x3ca)+_0x1e75c7(0x209,0x17d,0x1ef,0x1c5)]||{},_0x1c1d11={};_0x1c1d11[_0x4d4dc5(0x420,0x457,0x468,0x422)+'ofile']='默认';const _0x468e6e=_0x12a275[_0x1ff9f0]||_0x1c1d11,_0x49dbdf=_0x468e6e[_0x4d4dc5(0x45f,0x40d,0x437,0x422)+_0x4d4dc5(0x3ad,0x40b,0x39e,0x3eb)]||'默认',_0x239abd=extension_settings[extensionName]?.['test_conte'+_0x4d4dc5(0x44b,0x452,0x419,0x415)+'s']||{};function _0x1e75c7(_0xfd626a,_0x4fb440,_0x95c0a3,_0x37a19c){return _0x3a52(_0x37a19c-0x2a,_0x95c0a3);}const _0x2e121c=_0x239abd[_0x49dbdf]||_0x239abd[Object[_0x1e75c7(0x26b,0x200,0x279,0x24e)](_0x239abd)[0x7a7+0x1c58+0x13*-0x1e5]]||{},{context:context='',body:body='',worldBookContent:worldBookContent='',userDemand:userDemand=''}=_0x3c0b55,_0x57fbe6=[userDemand,context,body,worldBookContent][_0x4d4dc5(0x3c9,0x3bf,0x3d5,0x413)](Boolean)[_0x1e75c7(0x247,0x264,0x216,0x235)]('\x0a'),_0x343ca2=[];if(_0x2e121c['entries']&&Array[_0x4d4dc5(0x43c,0x422,0x452,0x404)](_0x2e121c[_0x1e75c7(0x227,0x276,0x285,0x240)])){if(_0x38887a[_0x4d4dc5(0x3fe,0x418,0x3a4,0x3d6)](_0x1e75c7(0x1ef,0x250,0x1f3,0x231),_0x38887a['MZUhb']))for(const _0x340527 of _0x2e121c[_0x4d4dc5(0x462,0x3f2,0x484,0x432)]){if(!_0x340527[_0x4d4dc5(0x3f6,0x44a,0x488,0x441)])continue;if(!_0x340527['content']||_0x340527[_0x1e75c7(0x1c7,0x1c4,0x238,0x1ea)][_0x4d4dc5(0x3ff,0x425,0x3a1,0x3f2)]()==='')continue;if(_0x38887a[_0x4d4dc5(0x417,0x41e,0x402,0x41a)](_0x340527[_0x4d4dc5(0x42c,0x448,0x47b,0x433)+'e'],_0x38887a[_0x4d4dc5(0x441,0x458,0x3ea,0x434)])){if(!_0x38887a[_0x1e75c7(0x26b,0x25f,0x227,0x22b)](checkTriggerWords,_0x340527[_0x4d4dc5(0x3b8,0x3f1,0x3bc,0x3ed)+'ds'],_0x57fbe6)){if(_0x38887a[_0x4d4dc5(0x3bc,0x384,0x3c2,0x3d6)](_0x38887a[_0x4d4dc5(0x438,0x3f1,0x3f2,0x3e6)],_0x38887a[_0x4d4dc5(0x3f9,0x448,0x400,0x438)])){if(_0x18aeb3){const _0x5e3918=_0x546397[_0x1e75c7(0x247,0x220,0x1fd,0x229)](_0x2af93a,arguments);return _0x35defb=null,_0x5e3918;}}else continue;}}const _0x148013={};_0x148013['role']=_0x340527[_0x4d4dc5(0x3cc,0x44e,0x3ea,0x419)]||_0x38887a[_0x4d4dc5(0x3dc,0x423,0x3ee,0x424)],_0x148013[_0x4d4dc5(0x3bd,0x40c,0x3c8,0x3dc)]=_0x340527[_0x4d4dc5(0x3e4,0x3c1,0x3e3,0x3dc)],_0x343ca2[_0x4d4dc5(0x3f5,0x3aa,0x3f3,0x3c3)](_0x148013);}else _0x29ea23[_0x4d4dc5(0x408,0x3d3,0x40d,0x3fb)](_0x1e75c7(0x283,0x220,0x2a2,0x259)+_0x4d4dc5(0x3f7,0x3b8,0x3c5,0x3a6)+_0xb2ba07+'@}');}else{if(_0x2e121c[_0x1e75c7(0x18a,0x213,0x1b7,0x1d7)]&&Array['isArray'](_0x2e121c[_0x1e75c7(0x190,0x229,0x1fa,0x1d7)]))for(const _0x3fca93 of _0x2e121c[_0x1e75c7(0x1fc,0x1e2,0x1ef,0x1d7)]){if(_0x38887a[_0x1e75c7(0x202,0x22e,0x1db,0x1da)](_0x38887a[_0x4d4dc5(0x36e,0x3e2,0x399,0x3ac)],_0x4d4dc5(0x432,0x41e,0x45e,0x42d))){const _0x9446b7=_0x4d5678[_0x1e75c7(0x251,0x1c0,0x23e,0x200)]();return _0x38887a['ClQHV'](_0x53d922,_0x9446b7,_0x1a09cf),_0xaeaa67&&_0x5e9844[_0x1e75c7(0x20c,0x1d9,0x1c0,0x209)]('{@setgloba'+'lvar::'+_0x9446b7+'@}'),'';}else{if(_0x3fca93[_0x4d4dc5(0x3e9,0x3c8,0x448,0x40d)]&&_0x3fca93['user']['trim']()!==''){const _0x284839={};_0x284839[_0x1e75c7(0x237,0x252,0x22e,0x227)]=_0x4d4dc5(0x423,0x447,0x3cf,0x40d),_0x284839[_0x1e75c7(0x20c,0x1a3,0x19c,0x1ea)]=_0x3fca93['user'],_0x343ca2[_0x4d4dc5(0x3f3,0x379,0x380,0x3c3)](_0x284839);}if(_0x3fca93[_0x1e75c7(0x207,0x1f1,0x1b6,0x1b6)]&&_0x3fca93[_0x1e75c7(0x1a4,0x1c1,0x186,0x1b6)][_0x4d4dc5(0x41a,0x402,0x40a,0x3f2)]()!==''){if(_0x38887a[_0x1e75c7(0x22c,0x1c7,0x204,0x1ed)](_0x38887a[_0x4d4dc5(0x3c3,0x3e7,0x38f,0x3b6)],'wKPdS')){const _0x1f90da=_0x121ed[_0x1e75c7(0x1b2,0x214,0x1ce,0x200)](),_0x35a2c7=_0x1c3b3d[_0x1e75c7(0x193,0x1c2,0x179,0x1c9)+'ta']['variables'][_0x1f90da]||'';return _0x190fad&&_0x1b796c[_0x1e75c7(0x1e8,0x23e,0x24d,0x209)](_0x4d4dc5(0x3e0,0x3e1,0x412,0x3f0)+_0x1f90da+'@}'),_0x35a2c7;}else{const _0x28d496={};_0x28d496[_0x4d4dc5(0x3da,0x410,0x449,0x419)]=_0x38887a[_0x4d4dc5(0x3c9,0x395,0x3e2,0x3bd)],_0x28d496['content']=_0x3fca93[_0x1e75c7(0x192,0x1d5,0x1c7,0x1b6)],_0x343ca2[_0x1e75c7(0x1b1,0x19e,0x19e,0x1d1)](_0x28d496);}}}}}const _0x116609=_0x38887a['TDvRi'](mergeAdjacentMessages,_0x343ca2);function _0x4d4dc5(_0x21af7f,_0xe4fdbb,_0x2bc1e4,_0x50af6b){return _0x3a52(_0x50af6b-0x21c,_0xe4fdbb);}const {messages:_0x343b8e,replacedVariables:_0x5e8815}=_0x38887a[_0x4d4dc5(0x466,0x44f,0x466,0x449)](replaceAllPlaceholders,_0x116609,_0x3c0b55);return _0x343b8e;}export function getProcessedPrompt(_0x3bfcc9,_0x20eae9){function _0x4fa3ae(_0x56cb16,_0xef62e1,_0x953fff,_0x5e58c1){return _0x3a52(_0x56cb16- -0x1a3,_0x953fff);}const _0x4f0a90={'lirka':function(_0x5f401b,_0x1d918b){return _0x5f401b(_0x1d918b);}};function _0x714b96(_0x1bf115,_0x577c5d,_0x10d9e5,_0x256fd4){return _0x3a52(_0x256fd4-0x1dc,_0x1bf115);}const _0x4fc4a6={};return _0x4fc4a6[_0x714b96(0x3b8,0x3b8,0x35f,0x393)+'e']=_0x3bfcc9,_0x4fc4a6[_0x714b96(0x415,0x3e9,0x3d6,0x3e6)+'a']=_0x20eae9,_0x4f0a90['lirka'](buildPromptWithTrigger,_0x4fc4a6);}