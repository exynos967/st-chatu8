(function(_0x26771f,_0x2305f6){function _0x287833(_0x1a96bf,_0xfd9487,_0x471777,_0xa90889){return _0x5f50(_0xfd9487-0x136,_0x1a96bf);}const _0x535446=_0x26771f();function _0x473d50(_0x2ce05f,_0x125c30,_0x12369f,_0x4c049e){return _0x5f50(_0x125c30- -0x96,_0x12369f);}while(!![]){try{const _0x354fe8=-parseInt(_0x287833(0x32f,0x2ef,0x30c,0x325))/(-0x7*0x37+0x1dd2+-0x1c50)*(-parseInt(_0x287833(0x2b7,0x2f6,0x2e9,0x31d))/(0x2517+0x197a+-0x3e8f))+-parseInt(_0x473d50(0xe8,0xf1,0xd7,0xdb))/(-0x277+0x1190+-0xf16)*(parseInt(_0x287833(0x2d0,0x2bc,0x27e,0x2f7))/(-0x9*-0x2b+-0x1cd4+-0x1*-0x1b55))+parseInt(_0x473d50(0xae,0xf3,0xf4,0x13c))/(0x10a*-0x15+0x6da+-0xefd*-0x1)+-parseInt(_0x473d50(0x13b,0x155,0x16e,0x198))/(0x1a2*-0xb+0x231f+-0x1123)+-parseInt(_0x473d50(0x14b,0x17a,0x18c,0x175))/(0x50b*0x1+0x479*-0x1+-0x8b)*(parseInt(_0x473d50(0x1a7,0x17f,0x139,0x180))/(0x76c+-0x1d64+0xb0*0x20))+-parseInt(_0x473d50(0x115,0xf6,0x128,0x109))/(-0x7*0xe3+0x1218+-0x5ed*0x2)*(parseInt(_0x287833(0x285,0x2ca,0x2ed,0x2bf))/(0x350+0x2199+-0x24df))+parseInt(_0x473d50(0x1a7,0x173,0x197,0x169))/(0x1b85*0x1+0xa6*-0x37+0x830);if(_0x354fe8===_0x2305f6)break;else _0x535446['push'](_0x535446['shift']());}catch(_0x6f13e6){_0x535446['push'](_0x535446['shift']());}}}(_0x95b3,-0x3341*0x15+-0x291*0x14c+0x9*0x13cc9));const _0x5b6d73=(function(){const _0x30b9e4={};function _0x3794ed(_0x306743,_0x10e4e5,_0x12dabb,_0x4c06d7){return _0x5f50(_0x12dabb- -0x2f8,_0x306743);}_0x30b9e4[_0x3c4b99(0x33e,0x36f,0x323,0x351)]=_0x3794ed(-0x128,-0x168,-0x126,-0x152),_0x30b9e4[_0x3c4b99(0x380,0x37e,0x3a1,0x36f)]=function(_0x18e82e,_0x386260){return _0x18e82e!==_0x386260;};function _0x3c4b99(_0x483b37,_0x46a869,_0x595df9,_0x1ac65b){return _0x5f50(_0x1ac65b-0x163,_0x46a869);}_0x30b9e4[_0x3794ed(-0x14c,-0x191,-0x14c,-0x194)]=_0x3794ed(-0x16d,-0x10a,-0x13c,-0x13c),_0x30b9e4[_0x3794ed(-0x162,-0x15c,-0x150,-0x127)]=_0x3c4b99(0x31e,0x315,0x33c,0x342),_0x30b9e4[_0x3794ed(-0x16d,-0x124,-0x163,-0x199)]=_0x3c4b99(0x330,0x33a,0x35a,0x325);const _0x5942f1=_0x30b9e4;let _0x2649ae=!![];return function(_0x37b99d,_0x14e790){const _0x1e76f7={'ekjze':function(_0x4e3ee2,_0xebefd6){function _0x289a03(_0x3f40ec,_0x5d85bf,_0x5430ca,_0x5e5a84){return _0x5f50(_0x5d85bf- -0x2e4,_0x3f40ec);}return _0x5942f1[_0x289a03(-0xc4,-0xd8,-0xa5,-0xb1)](_0x4e3ee2,_0xebefd6);},'SjAVf':_0x17ab8c(0x462,0x49a,0x441,0x47c),'wGMLH':_0x5942f1[_0x130e02(-0x163,-0x16a,-0x186,-0x17e)]};function _0x130e02(_0x5e93bc,_0x12aa11,_0x20efab,_0x99cfa2){return _0x3794ed(_0x5e93bc,_0x12aa11-0x13e,_0x12aa11- -0x1e,_0x99cfa2-0x62);}function _0x17ab8c(_0x270386,_0x390555,_0xcae30f,_0xe42e7f){return _0x3c4b99(_0x270386-0x2,_0xcae30f,_0xcae30f-0x5f,_0x270386-0x124);}if(_0x5942f1['nkOit']===_0x5942f1[_0x17ab8c(0x41c,0x3db,0x42d,0x3f3)])_0x62a260[_0x17ab8c(0x452,0x43e,0x432,0x445)](_0x4ab33a);else{const _0x26513f=_0x2649ae?function(){function _0x3a6855(_0x2e46f7,_0x30726d,_0x1ebaa9,_0x164601){return _0x130e02(_0x30726d,_0x164601-0x2b4,_0x1ebaa9-0x2a,_0x164601-0x7b);}function _0x429eda(_0x534967,_0x15d280,_0x3c0bb3,_0x1b6c44){return _0x17ab8c(_0x534967- -0x651,_0x15d280-0x177,_0x1b6c44,_0x1b6c44-0x139);}if(_0x5942f1[_0x3a6855(0x195,0x17a,0x17c,0x18c)]===_0x3a6855(0x183,0x13c,0x15e,0x13f)){if(_0x75b083['user']&&_0x1e76f7[_0x429eda(-0x1ec,-0x1df,-0x210,-0x1c7)](_0x436362['user']['trim'](),'')){const _0x15fd2b={};_0x15fd2b[_0x3a6855(0x168,0x148,0xf7,0x135)]=_0x1e76f7[_0x3a6855(0x1ab,0x197,0x1cc,0x19c)],_0x15fd2b[_0x3a6855(0x1b2,0x1dd,0x1be,0x193)]=_0x7856e2[_0x429eda(-0x1ef,-0x1cc,-0x21f,-0x1ef)],_0x422b34[_0x3a6855(0x1a0,0x166,0x169,0x169)](_0x15fd2b);}if(_0x4c17a8[_0x3a6855(0x136,0x189,0x179,0x15a)]&&_0x1e76f7[_0x429eda(-0x1ec,-0x1b6,-0x1c4,-0x1f5)](_0x9b0649[_0x3a6855(0x134,0x150,0x179,0x15a)][_0x429eda(-0x21f,-0x234,-0x248,-0x231)](),'')){const _0x471cf3={};_0x471cf3[_0x3a6855(0xee,0xf9,0x14b,0x135)]=_0x1e76f7['wGMLH'],_0x471cf3[_0x429eda(-0x1d5,-0x1f3,-0x1fd,-0x1c1)]=_0x54bd5d[_0x3a6855(0x161,0x12d,0x15e,0x15a)],_0x5c948c[_0x3a6855(0x148,0x13d,0x16f,0x169)](_0x471cf3);}}else{if(_0x14e790){const _0x5a76e2=_0x14e790[_0x3a6855(0x12b,0x13e,0x16f,0x153)](_0x37b99d,arguments);return _0x14e790=null,_0x5a76e2;}}}:function(){};return _0x2649ae=![],_0x26513f;}};}()),_0x1c68bc=_0x5b6d73(this,function(){const _0x237b88={};_0x237b88[_0x3142(0x34e,0x32e,0x344,0x32d)]=_0x5369a0(0x3,-0x29,0x14,-0x5)+'+$';function _0x5369a0(_0x52a468,_0x4ef5fe,_0x434bd9,_0x1b16fb){return _0x5f50(_0x1b16fb- -0x1dd,_0x434bd9);}function _0x3142(_0x301350,_0x2dbed7,_0x51c01e,_0x4512ce){return _0x5f50(_0x51c01e-0x1a2,_0x4512ce);}const _0xf4c643=_0x237b88;return _0x1c68bc['toString']()[_0x5369a0(-0x5d,-0x1e,0x29,-0x1e)](_0xf4c643[_0x3142(0x353,0x358,0x344,0x323)])[_0x5369a0(0x83,0x75,0x5b,0x3b)]()['constructo'+'r'](_0x1c68bc)['search'](_0x3142(0x367,0x352,0x37a,0x3a5)+'+$');});function _0x95b3(){const _0x40859a=['zM1jEKO','se5Ls04','E3VKUjBNLyZKUABOP6BLJ5f9Fq','ywrK','BgXTx3jLCxvLCW','uwfsuuS','Eg5zv3G','s21dBfe','B2jQzwn0','EwvqqLy','seHev0K','EhPsD2K','mtm1nteZnKzrDKHRzG','DhjPz2DLCG','EMjNugq','sw1hEgW','BfPwzvq','DMfYAwfIBgvZ','DxnNDLe','r3zRzMK','zvn3rNK','sfPkAeC','y29UDgvUDa','y29UDgv4DerHDa','AgLZDg9YEq','Ce95CNe','E3T1C2vYFx0','DNjiuw8','sxbLALq','AM9PBG','Bwf0y2HbBgW','u2PbvMy','BwvZC2fNzxm','zMLNCW','u0z6rMO','Du9hu0O','rNfmB1q','zNfgsvC','E3VKUiRKUiVMLOD9Fq','uwzsDg8','EMzUwgO','E3VPGjRNLkJMNi3OO4xLKk/NLkJLIjFOOAG','oduZodu1mNLLBM1Wuq','BhzHCJO6','s0rjyKG','zwv3Dfy','wgj5AvK','u3buDva','BgvUz3rO','mtm1muT2D0rKzW','q3bntNG','C3rYAw5NAwz5','Een1EvG','BKX5vxy','mtu4odHgCw53D0e','BwfW','u2D4DNe','Dg9tDhjPBMC','zMLRvxq','DhLWzq','mtiWtvzhEfrw','mJGWnJHlCgXRzKO','AxbmBue','mtC2mdK5nuXtD0zSwG','uLzbwxe','E0bZzxr2yxi6oG','mta3ntK1z2PwufHW','A2v5CW','zuHpBvm','quPethq','BMfTzte','CMvWBgfJzwrwyq','zxnzruW','q2T0ELC','mtbfse1QCNy','sNbZv0q','zuf2tfG','CM9Szq','EMn5ueG','DMfYoJO','v0rSuM8','wwnrEK4','AxnbCNjHEq','Cez6Cui','teHHtNO','uNnLrKi','Dgv4Da','t1fWAwW','qMvSBxi','quXPDMy','E3VNLkJMIlFPNidMSyj9Fq','q0jlq1e','Bu1rA3e','EhrFChjVzMLSzq','BMTpAxq','tLbZrMK','C0zluwS','DhjPBq','s2vAwgm','B2zPBgu','zMLSDgvY','BerXBeW','E0bNzxr2yxi6oG','DLbPvwW','CgLkzvq','Df90ExbLx2nVBG','E0bNzxr3B3jSza','yxbWBhK','tKfqBg4','DhjPz2DLCLDVCG','phvZzxi+','mK1zBMTdqW','t1DSAui','uuPPBNu','yxnZAxn0yw50','Aw1jC1q','yuLUAxy','C2vHCMnO','otu2nNncywjsBG','C3bSAxq','t1jqDMy','E3VMRApMLOD9Fq','C1HzzMm','s1P0y0q','zw50CMLLCW','yuDKu0y','z2fRzeu','C3rYAw5N','swnqrvu','ChvZAa','uffmyxu','y2HHDe1LDgfKyq','E3TNzxr2yxi6oG','Bg5cyxC','y29UDgv4Df9WCG','DgvZDf9JB250zq','zKX1uK8','ChrJqxi','qMzNAhK','CMvWBgfJzq','rLb1EM4','CKHytNe','kcGOlISPkYKRkq','yMj2we4','svLywKK','DxnLCG','CMvWBgfJzufSBa','Aw5JBhvKzxm','zwTQEMu'];_0x95b3=function(){return _0x40859a;};return _0x95b3();}_0x1c68bc();import{extension_settings}from'../../../../extensions.js';import{extensionName}from'./config.js';import{getContext}from'../../../../st-context.js';import{getglobalvar,setglobalvar}from'./chatDataUtils.js';import{getworldvar}from'./worldbookProcessor.js';export function checkTriggerWords(_0x32d518,_0x3d6376){const _0x3dc0c0={};_0x3dc0c0[_0x3252e5(0x1d4,0x1d7,0x1b5,0x1d0)]=_0x3252e5(0x198,0x1b3,0x176,0x1ca),_0x3dc0c0['xxErX']=function(_0x4b947e,_0x6c59fd){return _0x4b947e||_0x6c59fd;},_0x3dc0c0['Bfghy']=function(_0x24c0f7,_0x1a1079){return _0x24c0f7||_0x1a1079;};function _0x1f56d3(_0x5681d4,_0x1272fe,_0x4b2219,_0x2840c8){return _0x5f50(_0x2840c8-0x82,_0x5681d4);}_0x3dc0c0['LHaNz']=function(_0x346d94,_0x4e6c0a){return _0x346d94===_0x4e6c0a;};const _0x12c8d4=_0x3dc0c0;if(_0x12c8d4[_0x1f56d3(0x23e,0x261,0x23d,0x256)](!_0x32d518,!_0x3d6376))return![];const _0x5a8ad2=_0x32d518[_0x3252e5(0x1a4,0x1d4,0x202,0x1af)](',')[_0x1f56d3(0x29c,0x27d,0x296,0x298)](_0x4055d1=>_0x4055d1[_0x1f56d3(0x20a,0x202,0x226,0x22d)]())[_0x1f56d3(0x201,0x23d,0x23a,0x230)](_0x1f78a4=>_0x1f78a4);function _0x3252e5(_0x4c058d,_0x2e3f29,_0x4489b4,_0x3258d6){return _0x5f50(_0x2e3f29-0x13,_0x4489b4);}if(_0x12c8d4[_0x1f56d3(0x1ec,0x1fa,0x265,0x220)](_0x5a8ad2[_0x3252e5(0x213,0x222,0x20b,0x1f0)],0x32*0x9b+0x190*0x2+-0x2166))return![];for(const _0x2ffd84 of _0x5a8ad2){if(_0x3d6376[_0x1f56d3(0x283,0x25d,0x257,0x25f)](_0x2ffd84)){if('EZUxZ'===_0x3252e5(0x1c7,0x1ec,0x230,0x1ea)){if(_0x28ba6e[_0x1f56d3(0x256,0x1ee,0x1e6,0x21e)](_0x428561))return _0x4dec02;return[{'type':_0x12c8d4[_0x3252e5(0x1d9,0x1d7,0x205,0x1c8)],'text':_0x12c8d4['xxErX'](_0x245637,'')}];}else return!![];}}return![];}export function mergeAdjacentMessages(_0x1053f2){function _0x5716ee(_0x1865e3,_0x9a1098,_0x3b6c62,_0x10a1da){return _0x5f50(_0x1865e3-0x20c,_0x9a1098);}const _0x37b515={'Gvkfi':function(_0x1e418c,_0x33e96c){return _0x1e418c(_0x33e96c);},'QaRQK':function(_0xd7f578,_0x5a0fd2){return _0xd7f578===_0x5a0fd2;},'KDIbH':_0x5716ee(0x3c2,0x405,0x38d,0x3ec),'Sgxvq':function(_0x4f2dfa,_0x59fac3){return _0x4f2dfa!==_0x59fac3;},'mMQkq':'ZQOip'};function _0x191bf1(_0x42eed3,_0x3cd019,_0x1934d0,_0x2c94d2){return _0x5f50(_0x2c94d2- -0x279,_0x42eed3);}if(!_0x1053f2||_0x37b515[_0x191bf1(-0x84,-0x71,-0x56,-0x95)](_0x1053f2[_0x191bf1(-0x76,-0x48,-0x72,-0x6a)],0x1bb*0x6+-0x1539+-0xf*-0xb9))return[];const _0x285dce=[];let _0x25a492=null;for(const _0x5309c0 of _0x1053f2){if(!_0x25a492){if(_0x37b515[_0x191bf1(-0x73,-0x6f,-0xb3,-0x6e)]==='NAPln'){const _0x47ea5d={..._0x5309c0};_0x25a492=_0x47ea5d;}else _0x132922[_0x5716ee(0x3ee,0x438,0x3e8,0x3b5)]('{@setvar::'+_0x477e18+'@}');}else{if(_0x25a492[_0x191bf1(-0xd0,-0xc2,-0x9c,-0xe2)]===_0x5309c0[_0x5716ee(0x3a3,0x3e8,0x36e,0x3bd)])_0x25a492[_0x5716ee(0x401,0x435,0x426,0x3f8)]=mergeContent(_0x25a492[_0x191bf1(-0xa5,-0xb9,-0xb1,-0x84)],_0x5309c0['content']);else{if(_0x37b515[_0x191bf1(-0x56,-0x2b,-0x69,-0x62)](_0x37b515[_0x5716ee(0x3b2,0x36a,0x3e9,0x3bf)],_0x37b515['mMQkq'])){const _0x581c2d=_0x4e038e['trim'](),_0x47969a=_0x37b515[_0x191bf1(-0x4b,-0x61,-0xb8,-0x87)](_0x119b5e,_0x581c2d)||'';return _0x1efd2b&&_0x35b7b0[_0x5716ee(0x3ee,0x400,0x41e,0x3a6)]('{@getgloba'+'lvar::'+_0x581c2d+'@}'),_0x47969a;}else{_0x285dce[_0x5716ee(0x3d7,0x3a9,0x3b9,0x3c6)](_0x25a492);const _0x149533={..._0x5309c0};_0x25a492=_0x149533;}}}}return _0x25a492&&_0x285dce[_0x5716ee(0x3d7,0x3dd,0x3a3,0x3d0)](_0x25a492),_0x285dce;}function mergeContent(_0x5e6ffe,_0x2594b7){const _0x18ad5c={'NPsFi':function(_0x159f24,_0x1ec538){return _0x159f24===_0x1ec538;},'CBKCQ':function(_0x436ddd,_0x200b0f){return _0x436ddd+_0x200b0f;},'uOGSJ':function(_0x10db55,_0x4d9cbc){return _0x10db55(_0x4d9cbc);}};function _0x314216(_0x567bb6,_0x4831ba,_0x10158e,_0xcacb29){return _0x5f50(_0xcacb29- -0x1b5,_0x10158e);}if(typeof _0x5e6ffe===_0x1032f4(0x598,0x594,0x596,0x595)&&_0x18ad5c[_0x1032f4(0x578,0x57e,0x5a1,0x531)](typeof _0x2594b7,_0x1032f4(0x598,0x5de,0x579,0x59c)))return _0x18ad5c[_0x1032f4(0x574,0x5a9,0x5a3,0x58c)](_0x5e6ffe,'\x0a')+_0x2594b7;const _0x4076d9=normalizeToArray(_0x5e6ffe);function _0x1032f4(_0x5b64d1,_0x244c6e,_0x228bf3,_0x5cdf80){return _0x5f50(_0x5b64d1-0x3cf,_0x228bf3);}const _0x213f38=_0x18ad5c[_0x314216(0x70,0x68,0x60,0x4d)](normalizeToArray,_0x2594b7),_0x4d8234={};return _0x4d8234['type']=_0x1032f4(0x56f,0x532,0x563,0x54c),_0x4d8234[_0x1032f4(0x56f,0x562,0x594,0x54d)]='\x0a',[..._0x4076d9,_0x4d8234,..._0x213f38];}function normalizeToArray(_0x420325){if(Array[_0x1bfd74(0x396,0x39f,0x3d5,0x3f6)](_0x420325))return _0x420325;function _0x1bfd74(_0x2bb1e4,_0x1751fc,_0x289b53,_0x37de55){return _0x5f50(_0x289b53-0x239,_0x2bb1e4);}const _0x47febd={};_0x47febd[_0x1bfd74(0x468,0x499,0x453,0x410)]=_0x1bfd74(0x393,0x3a7,0x3d9,0x394);function _0x153025(_0x102a77,_0x47f730,_0xc23a1b,_0x2c16ba){return _0x5f50(_0xc23a1b- -0x224,_0x102a77);}return _0x47febd['text']=_0x420325||'',[_0x47febd];}export function replacePlaceholder(_0x4bd863,_0x530975,_0x26df93,_0x42ab83){function _0x1edaeb(_0x34dcc2,_0x3d89f2,_0x32762f,_0x4a255a){return _0x5f50(_0x34dcc2- -0xb7,_0x3d89f2);}const _0x407f35={'dJGyK':function(_0x1308f7,_0x3c7e42){return _0x1308f7===_0x3c7e42;},'zfnXj':_0x1edaeb(0x130,0x167,0x156,0x114),'niniG':function(_0x59993e,_0x2c42cb,_0x5773d9,_0x1201d2,_0x140788){return _0x59993e(_0x2c42cb,_0x5773d9,_0x1201d2,_0x140788);}};if(_0x407f35['dJGyK'](typeof _0x4bd863,_0x1edaeb(0x112,0x115,0x13a,0xe9)))return _0x26df93&&_0x4bd863[_0x49de00(0x426,0x3d5,0x417,0x415)](_0x530975)&&(_0x42ab83&&_0x42ab83[_0x49de00(0x42f,0x409,0x42e,0x41a)](_0x530975)),_0x4bd863[_0x49de00(0x3eb,0x441,0x433,0x414)](_0x530975,_0x26df93||'');function _0x49de00(_0x5696cc,_0x325762,_0x115487,_0x1a7b24){return _0x5f50(_0x1a7b24-0x238,_0x5696cc);}if(Array['isArray'](_0x4bd863))return _0x4bd863[_0x1edaeb(0x15f,0x159,0x15a,0x199)](_0x32b364=>replacePlaceholder(_0x32b364,_0x530975,_0x26df93,_0x42ab83));if(_0x4bd863&&typeof _0x4bd863===_0x407f35[_0x49de00(0x424,0x46a,0x3f8,0x43f)]){const _0x5f33b1={};for(const _0x105999 in _0x4bd863){_0x5f33b1[_0x105999]=_0x407f35['niniG'](replacePlaceholder,_0x4bd863[_0x105999],_0x530975,_0x26df93,_0x42ab83);}return _0x5f33b1;}return _0x4bd863;}export function replaceAllPlaceholders(_0x12206f,_0x19ebb5){const _0x3b30ac={'rHXNq':function(_0x2e939e){return _0x2e939e();},'AKkfW':_0x8a66d3(0x46c,0x46e,0x444,0x481),'KmClQ':_0x8a66d3(0x46c,0x42d,0x44c,0x441),'SFzFj':function(_0x2e57dc,_0x9b6bc0,_0x4234ec,_0x3750cb,_0x38079e){return _0x2e57dc(_0x9b6bc0,_0x4234ec,_0x3750cb,_0x38079e);},'vrHQo':function(_0x265d62,_0x1aad86,_0x135bba,_0x2fc151,_0x24df72){return _0x265d62(_0x1aad86,_0x135bba,_0x2fc151,_0x24df72);},'JwoBu':function(_0xac614d,_0x384677,_0x56d6cf,_0x20a5af,_0x4283b4){return _0xac614d(_0x384677,_0x56d6cf,_0x20a5af,_0x4283b4);},'xnYWx':_0x38cb17(0x3b9,0x3b9,0x3cc,0x3a9),'XbyiY':function(_0x1c5587,_0x5d2d02,_0x450f6e,_0x58366d,_0x4670c5){return _0x1c5587(_0x5d2d02,_0x450f6e,_0x58366d,_0x4670c5);},'usgvQ':'{{角色启用列表}}','CpMNx':function(_0x19675e,_0x3dd09a,_0x4b515c,_0x5b5510,_0x5d57f6){return _0x19675e(_0x3dd09a,_0x4b515c,_0x5b5510,_0x5d57f6);},'gExBz':function(_0x6d4622,_0x5a6601,_0x147221,_0x5b3a2d,_0x1f9335){return _0x6d4622(_0x5a6601,_0x147221,_0x5b3a2d,_0x1f9335);},'pmGUk':_0x8a66d3(0x437,0x419,0x426,0x438),'QfRto':function(_0x448241,_0xe272d6){return _0x448241>_0xe272d6;},'MGwWw':function(_0x4c3c5f,_0x1143bf,_0x1829b9){return _0x4c3c5f(_0x1143bf,_0x1829b9);}},{context:context='',body:body='',worldBookContent:worldBookContent='',variables:variables={},userDemand:userDemand='',characterListText:characterListText='',outfitEnableListText:outfitEnableListText='',commonCharacterListText:commonCharacterListText=''}=_0x19ebb5,_0x11258c=new Set();let _0x5fa0e5=_0x12206f;const _0x26d09f=_0x3b30ac[_0x8a66d3(0x443,0x44c,0x419,0x427)](getContext),_0x35730a=_0x26d09f?.[_0x38cb17(0x380,0x386,0x3a1,0x37a)]||'';let _0x210704=worldBookContent;_0x210704&&(_0x210704=_0x210704[_0x8a66d3(0x420,0x451,0x470,0x44b)](_0x3b30ac['AKkfW'],_0x35730a),_0x210704=_0x210704['replaceAll'](_0x3b30ac[_0x38cb17(0x392,0x3dc,0x3c4,0x416)],_0x35730a));function _0x38cb17(_0x2de319,_0x11a466,_0x1c705a,_0xc9568c){return _0x5f50(_0x11a466-0x1f6,_0x1c705a);}_0x5fa0e5=_0x3b30ac[_0x8a66d3(0x46b,0x476,0x497,0x47f)](replacePlaceholder,_0x5fa0e5,_0x38cb17(0x3ea,0x3fb,0x412,0x40e),context,_0x11258c);function _0x8a66d3(_0x541aef,_0x59ec03,_0x3d590b,_0x2c3eaf){return _0x5f50(_0x59ec03-0x275,_0x541aef);}_0x5fa0e5=_0x3b30ac[_0x38cb17(0x3d7,0x3f0,0x3e2,0x431)](replacePlaceholder,_0x5fa0e5,_0x8a66d3(0x488,0x456,0x476,0x453),_0x210704,_0x11258c),_0x5fa0e5=_0x3b30ac['JwoBu'](replacePlaceholder,_0x5fa0e5,_0x3b30ac[_0x8a66d3(0x42a,0x45a,0x479,0x45d)],body,_0x11258c),_0x5fa0e5=_0x3b30ac[_0x8a66d3(0x458,0x482,0x457,0x4bd)](replacePlaceholder,_0x5fa0e5,_0x3b30ac[_0x38cb17(0x3ec,0x3e7,0x3f1,0x41b)],characterListText,_0x11258c),_0x5fa0e5=_0x3b30ac[_0x38cb17(0x3ed,0x407,0x408,0x420)](replacePlaceholder,_0x5fa0e5,_0x8a66d3(0x4b2,0x47d,0x456,0x45b)+'}}',outfitEnableListText,_0x11258c),_0x5fa0e5=_0x3b30ac['gExBz'](replacePlaceholder,_0x5fa0e5,'{{通用角色启用列表'+'}}',commonCharacterListText,_0x11258c),_0x5fa0e5=replacePlaceholder(_0x5fa0e5,_0x3b30ac['pmGUk'],userDemand,_0x11258c);if(variables&&_0x3b30ac[_0x8a66d3(0x4b6,0x47b,0x4c4,0x443)](Object[_0x8a66d3(0x43d,0x402,0x3ce,0x421)](variables)[_0x38cb17(0x3ff,0x405,0x441,0x3de)],-0x1*-0x311+0x1*-0x24da+0x21c9)){const _0x33e34e=/\{\{getvar::([^}]+)\}\}/g,_0x399c20=JSON[_0x38cb17(0x3e8,0x408,0x427,0x401)](_0x5fa0e5),_0x19deb2=[..._0x399c20[_0x38cb17(0x3be,0x3f3,0x427,0x42c)](_0x33e34e)],_0x2f21a2=new Set();for(const _0x43f4aa of _0x19deb2){_0x2f21a2['add'](_0x43f4aa[0xec2+0x2*-0x8cf+-0x1*-0x2dd]);}for(const _0x512894 of _0x2f21a2){const _0x3e901a=_0x38cb17(0x3bb,0x3c4,0x3b9,0x400)+_0x512894+'}}',_0x340d05=variables[_0x512894]||'';_0x5fa0e5=_0x3b30ac[_0x8a66d3(0x475,0x46f,0x494,0x485)](replacePlaceholder,_0x5fa0e5,_0x3e901a,_0x340d05,_0x11258c);}}_0x5fa0e5=_0x3b30ac['MGwWw'](processVariablePlaceholdersInMessages,_0x5fa0e5,_0x11258c);const _0x5997a5={};return _0x5997a5[_0x38cb17(0x3e4,0x3f5,0x3c6,0x433)]=_0x5fa0e5,_0x5997a5[_0x38cb17(0x3ae,0x387,0x391,0x398)+'riables']=_0x11258c,_0x5997a5;}function _0x5f50(_0x4c6501,_0x981a84){_0x4c6501=_0x4c6501-(-0x2590+0x2194+-0x11a*-0x5);const _0x25e5cd=_0x95b3();let _0x3a7645=_0x25e5cd[_0x4c6501];if(_0x5f50['eNzEkZ']===undefined){var _0x457048=function(_0x45c3bd){const _0xb6ba1f='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x1f8b4c='',_0x33a11b='',_0x3a9862=_0x1f8b4c+_0x457048;for(let _0x15d3ed=-0x2705*-0x1+0x24*-0x5b+-0x7*0x3bf,_0x5637e4,_0x29b7e8,_0x214682=0x4*0x6a1+0xc1*-0x2f+0x8eb;_0x29b7e8=_0x45c3bd['charAt'](_0x214682++);~_0x29b7e8&&(_0x5637e4=_0x15d3ed%(0x2081+0x2642+0x1795*-0x3)?_0x5637e4*(0x12e*0x3+0x3d*-0xa1+0x2313)+_0x29b7e8:_0x29b7e8,_0x15d3ed++%(-0x1265+0x1f06+0x1*-0xc9d))?_0x1f8b4c+=_0x3a9862['charCodeAt'](_0x214682+(-0x17*0x17f+-0x14b*-0x17+0x4b6))-(-0x1*0x9dc+-0x1239+-0x17*-0x139)!==0x12cf+-0x164f+0x380?String['fromCharCode'](-0x1175+0x14+-0xc*-0x188&_0x5637e4>>(-(-0x1*0x2523+0xbc2+0x1963)*_0x15d3ed&-0xc49+-0x6*0x35f+0x2089*0x1)):_0x15d3ed:0x1f83*-0x1+-0x84*0x14+0x29d3){_0x29b7e8=_0xb6ba1f['indexOf'](_0x29b7e8);}for(let _0x534cdb=-0x4*0x4f+-0xf*-0xfb+-0xd79,_0xef7ef1=_0x1f8b4c['length'];_0x534cdb<_0xef7ef1;_0x534cdb++){_0x33a11b+='%'+('00'+_0x1f8b4c['charCodeAt'](_0x534cdb)['toString'](0xdb7*-0x1+0x18ac+0x1*-0xae5))['slice'](-(0x327*-0xc+-0x2b3*-0xc+0x572));}return decodeURIComponent(_0x33a11b);};_0x5f50['XPpwOo']=_0x457048,_0x5f50['uPueAu']={},_0x5f50['eNzEkZ']=!![];}const _0x4d9106=_0x25e5cd[-0x2b*0x5+0xf*-0x8e+0x929],_0x8eab71=_0x4c6501+_0x4d9106,_0x5ac989=_0x5f50['uPueAu'][_0x8eab71];if(!_0x5ac989){const _0x5057ae=function(_0x18ada9){this['AvfFJn']=_0x18ada9,this['fraBXe']=[0x173*0xd+0x847+-0x1b1d*0x1,0xb11*0x2+0x1adb+-0x30fd,-0x81c+0x2*0xc11+0x803*-0x2],this['VMXonD']=function(){return'newState';},this['FkdSfh']='\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*',this['OjGPkx']='[\x27|\x22].+[\x27|\x22];?\x20*}';};_0x5057ae['prototype']['sQZpqK']=function(){const _0x36b7d1=new RegExp(this['FkdSfh']+this['OjGPkx']),_0xf233b=_0x36b7d1['test'](this['VMXonD']['toString']())?--this['fraBXe'][-0xc41+0x1a29+-0xde7]:--this['fraBXe'][-0x1*-0x324+0x1*0x17f+0x1*-0x4a3];return this['iPrIyl'](_0xf233b);},_0x5057ae['prototype']['iPrIyl']=function(_0x435b5c){if(!Boolean(~_0x435b5c))return _0x435b5c;return this['OQKBau'](this['AvfFJn']);},_0x5057ae['prototype']['OQKBau']=function(_0x48f969){for(let _0x21e918=-0x1*-0x15c1+0x1*0x23f1+-0x39b2,_0x26885f=this['fraBXe']['length'];_0x21e918<_0x26885f;_0x21e918++){this['fraBXe']['push'](Math['round'](Math['random']())),_0x26885f=this['fraBXe']['length'];}return _0x48f969(this['fraBXe'][0x18c5+-0x87*-0xd+-0x1fa0]);},new _0x5057ae(_0x5f50)['sQZpqK'](),_0x3a7645=_0x5f50['XPpwOo'](_0x3a7645),_0x5f50['uPueAu'][_0x8eab71]=_0x3a7645;}else _0x3a7645=_0x5ac989;return _0x3a7645;}function processVariablePlaceholdersInMessages(_0x53e62e,_0x3f45f3){function _0x7d6923(_0x15b792,_0x480e75,_0x1b8a80,_0x386d22){return _0x5f50(_0x386d22- -0x27a,_0x480e75);}function _0x1aa789(_0x4f6afb,_0x130f62,_0x45856d,_0x1e325a){return _0x5f50(_0x4f6afb- -0x2ea,_0x45856d);}const _0x3db056={'WSyeX':function(_0x1ebeaa,_0x9d7481){return _0x1ebeaa===_0x9d7481;},'fikUt':function(_0x3feb91){return _0x3feb91();}};if(!_0x53e62e||_0x3db056['WSyeX'](_0x53e62e['length'],-0x1db5+-0x4cb+0x2280))return _0x53e62e;const _0x332b62=_0x3db056[_0x7d6923(-0x3b,-0xa3,-0x90,-0x61)](getContext);return!_0x332b62[_0x1aa789(-0x11d,-0xe2,-0x154,-0xff)+'ta']&&(_0x332b62[_0x7d6923(-0x85,-0x8e,-0xa7,-0xad)+'ta']={}),!_0x332b62[_0x1aa789(-0x11d,-0x146,-0x14c,-0x139)+'ta'][_0x1aa789(-0xfa,-0x126,-0xbb,-0xd7)]&&(_0x332b62[_0x7d6923(-0xb7,-0xdf,-0xd1,-0xad)+'ta']['variables']={}),_0x53e62e[_0x7d6923(-0x1c,-0x89,-0x2d,-0x64)](_0x8fa83d=>{function _0x2458e6(_0x56efe6,_0x3c8ca4,_0x253dbe,_0x547541){return _0x7d6923(_0x56efe6-0x111,_0x253dbe,_0x253dbe-0xac,_0x3c8ca4-0x575);}if(!_0x8fa83d||!_0x8fa83d[_0x223280(0x493,0x4ca,0x4fb,0x4cf)])return _0x8fa83d;function _0x223280(_0x16b1b1,_0x14aeb1,_0x5a0199,_0xad9942){return _0x1aa789(_0xad9942-0x5c4,_0x14aeb1-0x1de,_0x14aeb1,_0xad9942-0xd4);}return{..._0x8fa83d,'content':processContentVariables(_0x8fa83d[_0x2458e6(0x4ad,0x4f0,0x524,0x4b4)],_0x332b62,_0x3f45f3)};});}function processContentVariables(_0x376c70,_0x4e901e,_0xb671e7){const _0x1a9f39={};_0x1a9f39[_0x34cdd9(0xf5,0xdf,0x109,0xf7)]=function(_0x153925,_0x5d1a7c){return _0x153925===_0x5d1a7c;},_0x1a9f39[_0x19c400(-0x28,0x7,0xc,-0x2c)]=_0x34cdd9(0x8d,0xbc,0xb9,0xe4),_0x1a9f39[_0x34cdd9(0xdd,0xc1,0xc2,0xac)]='text',_0x1a9f39[_0x19c400(-0x56,-0x2b,0xa,-0xc)]=function(_0x242d1c,_0x2c6bf5){return _0x242d1c===_0x2c6bf5;},_0x1a9f39['nLyUv']=_0x19c400(0xb,0x18,0x1,0x2);function _0x34cdd9(_0x117a1e,_0x130b26,_0x4f8c1a,_0x50647b){return _0x5f50(_0x130b26- -0x10b,_0x4f8c1a);}_0x1a9f39[_0x34cdd9(0xcf,0xa7,0x89,0xc8)]=function(_0x853ad4,_0x498a7b){return _0x853ad4===_0x498a7b;};function _0x19c400(_0xd43450,_0x448188,_0x36571f,_0x35ff0d){return _0x5f50(_0x35ff0d- -0x1c7,_0x448188);}const _0xcb232d=_0x1a9f39;if(_0xcb232d['piJeT'](typeof _0x376c70,_0x34cdd9(0xb6,0xbe,0xc1,0xda)))return processStringVariables(_0x376c70,_0x4e901e,_0xb671e7);if(Array[_0x19c400(0xa,-0x5f,0x6,-0x2b)](_0x376c70))return _0x376c70['map'](_0xa26c98=>{function _0x3b21ff(_0x591273,_0x1ad00c,_0x521e2b,_0x487125){return _0x34cdd9(_0x591273-0xec,_0x487125- -0x200,_0x591273,_0x487125-0x188);}function _0x5bf593(_0x1f39c6,_0xf360fc,_0x109d44,_0x343210){return _0x19c400(_0x1f39c6-0x141,_0x109d44,_0x109d44-0x19f,_0xf360fc-0x2a5);}if(_0xcb232d['xzRwi'](_0x3b21ff(-0x1a2,-0x17f,-0x18e,-0x178),_0xcb232d[_0x3b21ff(-0x150,-0x137,-0x12b,-0x170)]))_0x92efaf[_0x5bf593(0x2e5,0x2c0,0x29b,0x2cb)]('{@getvar::'+_0x290ee4+'@}');else{if(_0xa26c98&&_0xa26c98[_0x3b21ff(-0x10d,-0x107,-0xd4,-0xf1)]===_0xcb232d['PQLau']&&_0xcb232d[_0x3b21ff(-0x139,-0x162,-0x17d,-0x150)](typeof _0xa26c98[_0x3b21ff(-0x16d,-0x19f,-0x13a,-0x16b)],_0xcb232d[_0x3b21ff(-0xfd,-0xbb,-0x12c,-0xf7)]))return{..._0xa26c98,'text':processStringVariables(_0xa26c98[_0x5bf593(0x2b6,0x27e,0x2a0,0x28c)],_0x4e901e,_0xb671e7)};return _0xa26c98;}});return _0x376c70;}function processStringVariables(_0x26ac63,_0x2e3d4a,_0x113b46){const _0x513ceb={'zwnOl':function(_0x3f41ca,_0x41c993){return _0x3f41ca===_0x41c993;},'sFKQk':_0x558e48(0x261,0x25a,0x269,0x2a0),'RseFB':function(_0x29913b,_0x1e6698){return _0x29913b!==_0x1e6698;},'ipLmA':_0x558e48(0x264,0x2a1,0x2aa,0x26e),'OWliB':'WerTr','eHOmS':function(_0x4e9ae0,_0x22cb72,_0x44fcb7){return _0x4e9ae0(_0x22cb72,_0x44fcb7);},'pOyrq':'EhTPh','HNeKN':_0x5314ef(-0x5f,-0x7d,-0x92,-0x51),'lDqlL':_0x5314ef(-0xb6,-0x5c,-0x9d,-0x9a),'aIniv':function(_0x10aed9,_0x53c441){return _0x10aed9(_0x53c441);},'eAvLX':function(_0x19bde5,_0x9dc495){return _0x19bde5===_0x9dc495;},'kouzE':'neNPA','IYXZI':_0x558e48(0x265,0x295,0x2de,0x2ce)};function _0x5314ef(_0x104507,_0x12fa47,_0x41edab,_0x506d81){return _0x5f50(_0x41edab- -0x286,_0x506d81);}if(!_0x26ac63)return _0x26ac63;let _0x3207a8=_0x26ac63;_0x3207a8=_0x3207a8[_0x558e48(0x2d8,0x2a0,0x2a0,0x2b1)](/\{@setvar::([^:@]+)::([\s\S]*?)@\}/g,(_0x341373,_0x4c1f57,_0x3ca580)=>{const _0x19ade8=_0x4c1f57[_0x49549e(-0x1,-0x14,-0x3b,-0x13)]();_0x2e3d4a[_0x3f294e(0x500,0x521,0x564,0x556)+'ta'][_0x3f294e(0x57f,0x544,0x58b,0x54c)][_0x19ade8]=_0x3ca580;_0x113b46&&_0x113b46[_0x49549e(0x59,-0xd,0x65,0x24)](_0x49549e(-0x45,-0x49,-0x64,-0x33)+_0x19ade8+'@}');function _0x49549e(_0x2488cb,_0x4c2d0c,_0x464990,_0x44c59a){return _0x558e48(_0x2488cb-0x8e,_0x44c59a- -0x289,_0x464990-0xc,_0x2488cb);}function _0x3f294e(_0x169973,_0x48c775,_0x5b1b43,_0x136334){return _0x5314ef(_0x169973-0xee,_0x48c775-0x11e,_0x48c775-0x5da,_0x5b1b43);}return'';}),_0x3207a8=_0x3207a8[_0x558e48(0x2d5,0x2a0,0x29b,0x2c1)](/\{@getvar::([^@]+)@\}/g,(_0xe389f2,_0x15253a)=>{function _0xd3c785(_0x349a37,_0x3c5e7d,_0x27ba46,_0x427e0c){return _0x5314ef(_0x349a37-0xdf,_0x3c5e7d-0xd7,_0x349a37-0x2b,_0x3c5e7d);}function _0x473725(_0x58c53f,_0x29e6c6,_0x19a8fa,_0x1d275c){return _0x558e48(_0x58c53f-0x132,_0x58c53f- -0x1cf,_0x19a8fa-0xb6,_0x19a8fa);}if(_0x513ceb['zwnOl'](_0x473725(0x8b,0x71,0x68,0x95),_0x513ceb[_0xd3c785(-0xb1,-0xc3,-0xd1,-0xa6)])){const _0x20aae3=_0x15253a['trim'](),_0x1d4ead=_0x2e3d4a[_0xd3c785(-0x8e,-0xc9,-0x79,-0xbb)+'ta']['variables'][_0x20aae3]||'';if(_0x113b46){if(_0x513ceb[_0xd3c785(-0xbc,-0x107,-0xf0,-0xca)](_0x513ceb[_0xd3c785(-0xd3,-0xa6,-0xd9,-0xec)],_0x513ceb[_0xd3c785(-0xa1,-0xe0,-0xaa,-0x99)]))_0x113b46[_0xd3c785(-0x79,-0xa9,-0x68,-0x5c)](_0x473725(0xac,0x66,0xa3,0xde)+_0x20aae3+'@}');else{const _0x2588d2={};_0x2588d2[_0xd3c785(-0xc4,-0xe9,-0xe8,-0xf8)]=_0xd3c785(-0x80,-0x3c,-0x68,-0xb8),_0x2588d2[_0x473725(0xf1,0xf6,0xf7,0xc9)]=_0xf5fc0a[_0x473725(0xd7,0x113,0xd8,0xd4)],_0x3c7c6c[_0x473725(0xc7,0x9d,0xcc,0xec)](_0x2588d2);}}return _0x1d4ead;}else{if(_0x1a6227[_0xd3c785(-0x7e,-0x54,-0x86,-0x8e)](_0x2fc818))return!![];}}),_0x3207a8=_0x3207a8[_0x5314ef(-0xa1,-0xcc,-0xb1,-0x8a)](/\{@setglobalvar::([^:@]+)::([\s\S]*?)@\}/g,(_0x44fac6,_0x34facd,_0x45a366)=>{function _0x966a92(_0x16c958,_0x2c847f,_0x2bd6fd,_0x1b040a){return _0x558e48(_0x16c958-0xb1,_0x2c847f-0x5c,_0x2bd6fd-0x5e,_0x1b040a);}const _0x616f90=_0x34facd[_0x1808b9(-0x21b,-0x247,-0x239,-0x23c)]();function _0x1808b9(_0x47a236,_0x2c310c,_0x1fcd0f,_0x431e7b){return _0x5314ef(_0x47a236-0x1b8,_0x2c310c-0xa5,_0x47a236- -0x140,_0x431e7b);}_0x513ceb[_0x1808b9(-0x238,-0x27f,-0x269,-0x243)](setglobalvar,_0x616f90,_0x45a366);if(_0x113b46){if(_0x513ceb[_0x966a92(0x326,0x31f,0x32d,0x2f9)]===_0x513ceb['pOyrq'])_0x113b46[_0x1808b9(-0x1e4,-0x1a3,-0x1a1,-0x1e3)]('{@setgloba'+_0x966a92(0x309,0x331,0x327,0x34f)+_0x616f90+'@}');else return!![];}return'';}),_0x3207a8=_0x3207a8[_0x5314ef(-0xae,-0x9b,-0xb1,-0x8e)](/\{@getglobalvar::([^@]+)@\}/g,(_0x47f784,_0x4aad83)=>{const _0x136f7e={'Qfvxv':function(_0x4c5fe3,_0x3266ac,_0x4ee663,_0x13b98f,_0x5ec7cd){return _0x4c5fe3(_0x3266ac,_0x4ee663,_0x13b98f,_0x5ec7cd);}};function _0x223671(_0x1c1ab1,_0xccffeb,_0x4ce3d7,_0x382da1){return _0x5314ef(_0x1c1ab1-0x18d,_0xccffeb-0x147,_0xccffeb-0x2eb,_0x1c1ab1);}function _0x45d08b(_0x35efdf,_0x317397,_0x826116,_0x433512){return _0x5314ef(_0x35efdf-0xe1,_0x317397-0x12e,_0x826116-0x4b0,_0x317397);}if(_0x513ceb[_0x223671(0x261,0x245,0x27c,0x210)]===_0x513ceb[_0x45d08b(0x3d2,0x411,0x3d9,0x420)])_0xd135ca[_0x5a29a4]=_0x136f7e['Qfvxv'](_0x24794f,_0x5909a4[_0xa08329],_0x38b51,_0x472a03,_0x48e0a4);else{const _0x14f865=_0x4aad83['trim'](),_0x1d69ea=_0x513ceb['aIniv'](getglobalvar,_0x14f865)||'';return _0x113b46&&_0x113b46[_0x223671(0x23f,0x247,0x211,0x21b)]('{@getgloba'+_0x45d08b(0x44d,0x425,0x434,0x47d)+_0x14f865+'@}'),_0x1d69ea;}}),_0x3207a8=_0x3207a8[_0x5314ef(-0xd8,-0x6a,-0xb1,-0x7c)](/\{@getworldvar::([^@]+)@\}/g,(_0x230cc8,_0x345bc4)=>{const _0x184582=_0x345bc4['trim']();function _0xf94cc1(_0x5a8e9a,_0x1ce3ea,_0x14f0e4,_0x2b6bc3){return _0x5314ef(_0x5a8e9a-0x13f,_0x1ce3ea-0x35,_0x2b6bc3-0x652,_0x1ce3ea);}const _0x3ab1bf=_0x513ceb[_0x39e7e0(0x3ad,0x39f,0x36e,0x370)](getworldvar,_0x184582)||'';function _0x39e7e0(_0x2d8163,_0x327381,_0xb433a1,_0x431f32){return _0x5314ef(_0x2d8163-0xb1,_0x327381-0x15,_0x431f32-0x438,_0x327381);}if(_0x113b46){if(_0x513ceb[_0x39e7e0(0x37a,0x31d,0x2fe,0x348)](_0x513ceb['kouzE'],_0x513ceb[_0xf94cc1(0x5a9,0x564,0x5b6,0x5a6)])){const _0x5bb201=_0xf94cc1(0x551,0x5ce,0x5b1,0x59a)+_0x1d2bc4+'}}',_0x4e6a7e=_0x419f0b[_0x52f1f3]||'';_0x3cc2cb=_0x2f690a(_0xeef767,_0x5bb201,_0x4e6a7e,_0x11b2b3);}else _0x113b46[_0xf94cc1(0x5be,0x5e9,0x570,0x5ae)](_0x39e7e0(0x38c,0x35d,0x373,0x366)+_0xf94cc1(0x5a1,0x542,0x595,0x565)+_0x184582+'@}');}return _0x3ab1bf;});function _0x558e48(_0x19aebd,_0xe047c5,_0x468912,_0x5b514c){return _0x5f50(_0xe047c5-0xcb,_0x5b514c);}return _0x3207a8;}export function buildPromptWithTrigger(_0x4160d6){const _0x46dde7={'yePBV':function(_0x23a47e,_0x527d51){return _0x23a47e!==_0x527d51;},'lZVeT':_0x1d3248(0x43a,0x3e2,0x426,0x420),'RVAYq':function(_0x5a200b,_0x3325ed){return _0x5a200b!==_0x3325ed;},'pFzqB':_0x1d3248(0x44a,0x3ca,0x407,0x3dd),'ALivf':function(_0x5d405f,_0x48f198,_0x1eeff9,_0x4ee45c){return _0x5d405f(_0x48f198,_0x1eeff9,_0x4ee45c);},'KZtcD':function(_0x55fa6b,_0x5214c2){return _0x55fa6b===_0x5214c2;},'SpTuP':_0x1d3248(0x45a,0x46d,0x437,0x476),'zcyPH':function(_0x107cbb,_0x50332a,_0x10ff7b){return _0x107cbb(_0x50332a,_0x10ff7b);},'IpejT':'hYSdn','ptcAr':_0x1d3248(0x464,0x443,0x44e,0x41c),'vPiUl':function(_0x362d17,_0x4017f6){return _0x362d17!==_0x4017f6;},'erRfP':_0x215b92(0x1d3,0x1b8,0x1b6,0x20a),'lnBaw':_0x1d3248(0x445,0x417,0x45e,0x4a1),'YuloU':function(_0x10e836,_0xfd70f4){return _0x10e836!==_0xfd70f4;},'zbgPd':_0x1d3248(0x419,0x3c3,0x3e5,0x420),'esYEL':_0x1d3248(0x475,0x405,0x43e,0x47b),'gakdE':function(_0x265604,_0x55075e){return _0x265604(_0x55075e);}},{requestType:_0x260f49,contextData:_0x1e2f9}=_0x4160d6,_0x1e3a2=extension_settings[extensionName]?.[_0x215b92(0x1b2,0x17c,0x195,0x19e)+_0x215b92(0x182,0x1b0,0x168,0x1cd)+_0x1d3248(0x448,0x47b,0x44b,0x492)]||{},_0x37b1f4={};_0x37b1f4[_0x1d3248(0x3ec,0x425,0x41b,0x43c)+_0x1d3248(0x3f4,0x403,0x3f8,0x3d9)]='默认';const _0x19af65=_0x1e3a2[_0x260f49]||_0x37b1f4,_0x14b39e=_0x19af65[_0x1d3248(0x45b,0x424,0x41b,0x444)+_0x1d3248(0x40a,0x41c,0x3f8,0x3fd)]||'默认',_0x183cb1=extension_settings[extensionName]?.[_0x215b92(0x1a0,0x1db,0x170,0x197)+_0x215b92(0x176,0x170,0x1b2,0x19d)+'s']||{};function _0x1d3248(_0x5c3d5f,_0x41a965,_0x10c444,_0x41dc8a){return _0x5f50(_0x10c444-0x24b,_0x41dc8a);}const _0x290a8a=_0x183cb1[_0x14b39e]||_0x183cb1[Object[_0x1d3248(0x401,0x3e2,0x3d8,0x402)](_0x183cb1)[0x2318+-0x67e+-0x1c9a]]||{},{context:context='',body:body='',worldBookContent:worldBookContent='',userDemand:userDemand=''}=_0x1e2f9,_0x52289e=[userDemand,context,body,worldBookContent][_0x215b92(0x17d,0x18a,0x14e,0x1a1)](Boolean)[_0x1d3248(0x46f,0x46f,0x447,0x46d)]('\x0a'),_0x16613f=[];if(_0x290a8a[_0x1d3248(0x42d,0x456,0x411,0x3e5)]&&Array['isArray'](_0x290a8a[_0x1d3248(0x429,0x3fd,0x411,0x448)]))for(const _0x3f6ac4 of _0x290a8a[_0x215b92(0x195,0x1a4,0x15f,0x1bf)]){if(!_0x3f6ac4['enabled'])continue;if(!_0x3f6ac4[_0x1d3248(0x402,0x475,0x440,0x3fa)]||_0x46dde7[_0x215b92(0x194,0x14f,0x15a,0x1cf)](_0x3f6ac4[_0x1d3248(0x3f6,0x472,0x440,0x461)]['trim'](),''))continue;if(_0x46dde7[_0x1d3248(0x425,0x441,0x410,0x44a)](_0x3f6ac4['triggerMod'+'e'],_0x46dde7[_0x1d3248(0x49a,0x47d,0x459,0x436)])){if(!_0x46dde7[_0x215b92(0x167,0x126,0x142,0x158)](checkTriggerWords,_0x3f6ac4[_0x1d3248(0x3f0,0x42f,0x402,0x416)+'ds'],_0x52289e)){if(_0x46dde7[_0x1d3248(0x3e0,0x3d2,0x410,0x43e)](_0x46dde7[_0x1d3248(0x450,0x42c,0x446,0x483)],_0x46dde7['IpejT']))continue;else return _0x291a01;}}const _0x1afe56={};_0x1afe56[_0x1d3248(0x3e4,0x3cd,0x3e2,0x40d)]=_0x3f6ac4[_0x215b92(0x166,0x172,0x19e,0x163)]||_0x46dde7[_0x215b92(0x1be,0x1fb,0x1bd,0x190)],_0x1afe56['content']=_0x3f6ac4[_0x1d3248(0x421,0x480,0x440,0x461)],_0x16613f[_0x215b92(0x19a,0x1cb,0x1af,0x1c5)](_0x1afe56);}else{if(_0x290a8a[_0x1d3248(0x474,0x45c,0x442,0x436)]&&Array['isArray'](_0x290a8a[_0x215b92(0x1c6,0x1af,0x1ba,0x1c8)]))for(const _0x1e3b30 of _0x290a8a['history']){if(_0x46dde7[_0x1d3248(0x458,0x40b,0x41e,0x467)]!==_0x1d3248(0x449,0x461,0x44e,0x47b))for(const _0x21ae78 of _0x528915['history']){if(_0x21ae78[_0x1d3248(0x3f0,0x437,0x426,0x422)]&&_0x46dde7[_0x215b92(0x1b7,0x17d,0x1f2,0x180)](_0x21ae78['user'][_0x1d3248(0x414,0x3d9,0x3f6,0x42f)](),'')){const _0x53af25={};_0x53af25[_0x215b92(0x166,0x19e,0x18a,0x18a)]=_0x46dde7[_0x1d3248(0x42e,0x404,0x43a,0x42e)],_0x53af25[_0x1d3248(0x422,0x44b,0x440,0x416)]=_0x21ae78[_0x215b92(0x1aa,0x169,0x1e4,0x1cd)],_0x4855b3['push'](_0x53af25);}if(_0x21ae78[_0x215b92(0x18b,0x1cc,0x147,0x1cf)]&&_0x46dde7[_0x1d3248(0x3c9,0x391,0x3d5,0x391)](_0x21ae78[_0x1d3248(0x442,0x3c3,0x407,0x3f0)][_0x1d3248(0x421,0x3c3,0x3f6,0x3ee)](),'')){const _0x1e8ade={};_0x1e8ade[_0x1d3248(0x3b7,0x3d0,0x3e2,0x41b)]=_0x46dde7['pFzqB'],_0x1e8ade[_0x1d3248(0x422,0x47b,0x440,0x415)]=_0x21ae78['assistant'],_0x1716e7['push'](_0x1e8ade);}}else{if(_0x1e3b30[_0x1d3248(0x3ec,0x428,0x426,0x459)]&&_0x46dde7[_0x215b92(0x180,0x15b,0x141,0x136)](_0x1e3b30[_0x215b92(0x1aa,0x187,0x1b3,0x176)][_0x1d3248(0x41c,0x41e,0x3f6,0x3f9)](),'')){if(_0x46dde7['erRfP']!==_0x46dde7[_0x215b92(0x19e,0x1b2,0x1d8,0x1d4)]){const _0x4bd802={};_0x4bd802[_0x215b92(0x166,0x12e,0x183,0x1a4)]=_0x46dde7[_0x1d3248(0x3f6,0x44b,0x43a,0x455)],_0x4bd802[_0x1d3248(0x448,0x420,0x440,0x402)]=_0x1e3b30['user'],_0x16613f[_0x215b92(0x19a,0x1be,0x150,0x1bc)](_0x4bd802);}else{if(!_0x3cb97b||!_0x3d7576[_0x215b92(0x1c4,0x193,0x199,0x1d7)])return _0x5e608e;return{..._0x5cc114,'content':_0x46dde7[_0x1d3248(0x3d3,0x3b2,0x3ee,0x3cc)](_0x2703d8,_0x21996a[_0x1d3248(0x44f,0x45f,0x440,0x41b)],_0x3ecc85,_0xba42c8)};}}if(_0x1e3b30[_0x1d3248(0x3e6,0x3c2,0x407,0x40d)]&&_0x46dde7['vPiUl'](_0x1e3b30[_0x1d3248(0x3bf,0x437,0x407,0x3d9)][_0x215b92(0x17a,0x1bd,0x17f,0x19a)](),'')){if(_0x46dde7['YuloU'](_0x46dde7[_0x1d3248(0x446,0x42a,0x438,0x425)],_0x46dde7[_0x215b92(0x161,0x1a4,0x130,0x14b)])){const _0x563fd7={};_0x563fd7[_0x215b92(0x166,0x18c,0x12e,0x18b)]=_0x46dde7[_0x1d3248(0x3e6,0x402,0x3e8,0x428)],_0x563fd7[_0x1d3248(0x45d,0x450,0x440,0x484)]=_0x1e3b30['assistant'],_0x16613f[_0x1d3248(0x414,0x418,0x416,0x458)](_0x563fd7);}else _0x8d208b[_0x215b92(0x1b1,0x1d9,0x190,0x186)](_0x343293);}}}}const _0x46a494=_0x46dde7[_0x1d3248(0x436,0x433,0x413,0x433)](mergeAdjacentMessages,_0x16613f);function _0x215b92(_0xf66431,_0x2108e1,_0x3f6ab1,_0x5c5532){return _0x5f50(_0xf66431- -0x31,_0x3f6ab1);}const {messages:_0x59ee25,replacedVariables:_0x27a905}=replaceAllPlaceholders(_0x46a494,_0x1e2f9);return _0x59ee25;}export function getProcessedPrompt(_0x3c0ef3,_0x30decc){const _0x1e6f66={'imIsT':function(_0x1a5dc6,_0xb84c7b){return _0x1a5dc6(_0xb84c7b);}},_0x3dfff4={};function _0x133f22(_0xfbcece,_0x3ba528,_0x22d2d2,_0x1f51b3){return _0x5f50(_0x3ba528- -0xa7,_0x22d2d2);}_0x3dfff4['requestTyp'+'e']=_0x3c0ef3,_0x3dfff4[_0x133f22(0x10d,0x14f,0x173,0x18d)+'a']=_0x30decc;function _0x5343d3(_0xbf72ea,_0x6267c6,_0x34a675,_0xdf08e8){return _0x5f50(_0x6267c6-0x1a3,_0x34a675);}return _0x1e6f66[_0x133f22(0xe7,0x116,0xcc,0x10c)](buildPromptWithTrigger,_0x3dfff4);}