(function(_0x3c69e4,_0x5e7c07){function _0x1b2870(_0x584072,_0x71acec,_0x9506d3,_0x6a29ca){return _0x1120(_0x584072- -0xee,_0x71acec);}function _0x4a974e(_0x1684fb,_0x330236,_0xedf8ff,_0x4df491){return _0x1120(_0x330236- -0x1ac,_0xedf8ff);}const _0x51e22a=_0x3c69e4();while(!![]){try{const _0x5aad18=-parseInt(_0x1b2870(0xf5,0xed,0xb6,0xf6))/(0x20b3*0x1+0x61f*-0x1+-0x1a93)+-parseInt(_0x4a974e(0x65,0x9b,0xcc,0x50))/(0x20d6+0x1869+0x1*-0x393d)*(parseInt(_0x1b2870(0x11b,0xca,0xcb,0x127))/(0x1741*0x1+-0x25df+0xea1))+-parseInt(_0x1b2870(0x16b,0x129,0x196,0x17a))/(0xe7c+-0xe*-0x12d+-0x1eee)+parseInt(_0x1b2870(0x181,0x1d3,0x147,0x170))/(-0x6*0x416+0x1afd+-0x1*0x274)+-parseInt(_0x4a974e(0x4c,0x66,0x59,0xb7))/(-0x185c+0x829+0x1039)*(parseInt(_0x4a974e(0x61,0xac,0x78,0x73))/(-0x24ac+0x1bbc+0x8f7))+-parseInt(_0x1b2870(0x140,0x177,0x121,0x11d))/(0x2*0x69e+-0x4f*-0x4f+0x9*-0x42d)+parseInt(_0x4a974e(0xb5,0xaf,0x79,0x62))/(-0x3*0xc83+0x2225+-0x1*-0x36d)*(parseInt(_0x1b2870(0x11a,0x137,0xce,0x13b))/(-0x1cd9+-0x1241*0x1+0x2f24));if(_0x5aad18===_0x5e7c07)break;else _0x51e22a['push'](_0x51e22a['shift']());}catch(_0x3a17cc){_0x51e22a['push'](_0x51e22a['shift']());}}}(_0x1cb5,-0xa662+0x1*-0x4820a+0xa0eec));const _0x3eae75=(function(){const _0x5631fb={};_0x5631fb['guRUk']=function(_0x1fef71,_0xe5f138){return _0x1fef71===_0xe5f138;};function _0x1fc07f(_0xd6afaa,_0x19d625,_0x135b6c,_0x1e4298){return _0x1120(_0x19d625- -0x1d8,_0x135b6c);}_0x5631fb[_0x159839(0x153,0x118,0x153,0x10b)]=_0x1fc07f(0x70,0x78,0xa8,0x40),_0x5631fb[_0x159839(0x178,0x103,0x129,0x15f)]=_0x159839(0x171,0x15c,0x156,0x169);const _0x47a94e=_0x5631fb;let _0x26bc1a=!![];function _0x159839(_0x244b0f,_0x34fc3e,_0x5d0b65,_0x4a6a59){return _0x1120(_0x5d0b65- -0x10a,_0x244b0f);}return function(_0x187d5e,_0x5509f8){function _0x34eae5(_0x1fa4a7,_0x572068,_0x20b606,_0x288c78){return _0x159839(_0x20b606,_0x572068-0x13,_0x1fa4a7- -0x2ce,_0x288c78-0x174);}function _0x5cd54f(_0xa97149,_0x36a084,_0x53e6dd,_0x41a73e){return _0x1fc07f(_0xa97149-0x1d1,_0x36a084-0x2a8,_0xa97149,_0x41a73e-0x56);}const _0x4039a7={'gOiCM':function(_0x560e95,_0x1dcc4b){function _0x2b573b(_0x303472,_0x374f4c,_0x361e0e,_0x3d4918){return _0x1120(_0x3d4918-0x137,_0x374f4c);}return _0x47a94e[_0x2b573b(0x2f7,0x306,0x37b,0x33a)](_0x560e95,_0x1dcc4b);},'pDzqc':function(_0x5ce8fb,_0x43584c,_0x556d34){return _0x5ce8fb(_0x43584c,_0x556d34);}};if(_0x47a94e[_0x34eae5(-0x17b,-0x1ce,-0x1a5,-0x136)]!==_0x47a94e['bjttF']){const _0x48c3a3=_0x26bc1a?function(){function _0x231174(_0x3276a6,_0xf62379,_0x4b6772,_0x36a960){return _0x34eae5(_0x4b6772-0xc1,_0xf62379-0x7c,_0x36a960,_0x36a960-0x1b6);}if(_0x5509f8){const _0x125dcc=_0x5509f8[_0x231174(-0x8c,-0xe4,-0xd3,-0x108)](_0x187d5e,arguments);return _0x5509f8=null,_0x125dcc;}}:function(){};return _0x26bc1a=![],_0x48c3a3;}else{if(!_0x75cc47){const _0x40c903={..._0x504206};_0x34a4f7=_0x40c903;}else{if(_0x4039a7['gOiCM'](_0x2f40cb[_0x5cd54f(0x2df,0x2f1,0x2bd,0x29f)],_0x3765e9[_0x5cd54f(0x2f7,0x2f1,0x2de,0x318)]))_0x38dffb[_0x34eae5(-0x1b0,-0x185,-0x1f0,-0x1de)]=_0x4039a7[_0x5cd54f(0x2f6,0x30e,0x320,0x30d)](_0x177b91,_0x5ae336[_0x34eae5(-0x1b0,-0x18a,-0x1ec,-0x15d)],_0x46a8a8['content']);else{_0x5de5d2[_0x34eae5(-0x15b,-0x140,-0x146,-0x119)](_0x4b1df8);const _0x523ed0={..._0x31b8db};_0x4f6305=_0x523ed0;}}}};}()),_0x30ba9d=_0x3eae75(this,function(){function _0x364a20(_0x56e1ec,_0x4f4016,_0xa61978,_0x2c5b5b){return _0x1120(_0x2c5b5b- -0x37d,_0xa61978);}const _0x12867d={};function _0x39ba13(_0xe78b43,_0x35ef70,_0x314581,_0x3072bb){return _0x1120(_0x314581- -0x3b1,_0xe78b43);}_0x12867d['IWRuZ']=_0x364a20(-0x16f,-0x140,-0x15d,-0x182)+'+$';const _0x2f6b33=_0x12867d;return _0x30ba9d[_0x364a20(-0x1bc,-0x1cd,-0x181,-0x1a6)]()[_0x39ba13(-0x198,-0x1c1,-0x1c5,-0x17c)](_0x2f6b33[_0x364a20(-0x165,-0x17b,-0x14c,-0x146)])[_0x364a20(-0x15f,-0x1be,-0x1e7,-0x1a6)]()[_0x39ba13(-0x10f,-0x167,-0x14b,-0x16b)+'r'](_0x30ba9d)[_0x39ba13(-0x1b3,-0x1f1,-0x1c5,-0x1c0)](_0x2f6b33[_0x39ba13(-0x1bf,-0x1af,-0x17a,-0x1c3)]);});_0x30ba9d();import{extension_settings}from'../../../../extensions.js';import{extensionName}from'./config.js';import{getContext}from'../../../../st-context.js';import{getglobalvar,setglobalvar}from'./chatDataUtils.js';function _0x1120(_0x1c6f49,_0x37bebc){_0x1c6f49=_0x1c6f49-(0x1ad4+0x17*0x157+-0x37ce);const _0x161afb=_0x1cb5();let _0x17c3c2=_0x161afb[_0x1c6f49];if(_0x1120['GqtNqV']===undefined){var _0x3e6c8d=function(_0x316473){const _0x596e09='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x3e1baa='',_0x13b5e9='',_0x3688b8=_0x3e1baa+_0x3e6c8d;for(let _0x302283=-0x190a+0x77d+0x118d,_0x4c4317,_0x1728b0,_0x20e229=0xda7+0x2*0x649+0x1*-0x1a39;_0x1728b0=_0x316473['charAt'](_0x20e229++);~_0x1728b0&&(_0x4c4317=_0x302283%(-0x1ae1+0xc7*0xb+0x1258)?_0x4c4317*(0xf65+0x1*0x106c+-0x1*0x1f91)+_0x1728b0:_0x1728b0,_0x302283++%(-0x251a+-0x34c*-0x2+0x1e86))?_0x3e1baa+=_0x3688b8['charCodeAt'](_0x20e229+(-0x1b0*-0x7+0x59*-0x2+-0xb14))-(-0x1692+-0xd*-0x274+0x6c*-0x16)!==0x1142+0x2*0xa+-0x2*0x8ab?String['fromCharCode'](0x227c+-0x18d0+0x8ad*-0x1&_0x4c4317>>(-(-0xf5e*-0x1+-0x5e7*0x3+0x259)*_0x302283&0x1fbf+0x118e+-0x349*0xf)):_0x302283:0x7*-0xd+-0x243c+0x2497){_0x1728b0=_0x596e09['indexOf'](_0x1728b0);}for(let _0x4a9c0a=0x2315+0x1*0x16fd+0x1*-0x3a12,_0x43b00d=_0x3e1baa['length'];_0x4a9c0a<_0x43b00d;_0x4a9c0a++){_0x13b5e9+='%'+('00'+_0x3e1baa['charCodeAt'](_0x4a9c0a)['toString'](0x13d5*-0x1+0x215*0x11+0xf80*-0x1))['slice'](-(-0xa*0x152+-0x1*-0x69a+0x69c));}return decodeURIComponent(_0x13b5e9);};_0x1120['CRkPFR']=_0x3e6c8d,_0x1120['ZlFhIQ']={},_0x1120['GqtNqV']=!![];}const _0x3d3801=_0x161afb[-0xd2c+0x10f7+0x1*-0x3cb],_0x1f5a0f=_0x1c6f49+_0x3d3801,_0x521758=_0x1120['ZlFhIQ'][_0x1f5a0f];if(!_0x521758){const _0x2b95d1=function(_0x38ba83){this['UsyzKD']=_0x38ba83,this['hQxByr']=[-0xb50+0x707+0x3*0x16e,-0x2311+-0x148c+-0x26b*-0x17,0x1261+-0x169*-0x1b+-0x3874],this['lUIZsY']=function(){return'newState';},this['simunc']='\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*',this['kVBLsX']='[\x27|\x22].+[\x27|\x22];?\x20*}';};_0x2b95d1['prototype']['WtqKfq']=function(){const _0xe576af=new RegExp(this['simunc']+this['kVBLsX']),_0x5531a6=_0xe576af['test'](this['lUIZsY']['toString']())?--this['hQxByr'][-0xcad+0x233c+-0x168e]:--this['hQxByr'][0x68f*0x3+-0x1*0xf5b+-0x452];return this['aNpQbr'](_0x5531a6);},_0x2b95d1['prototype']['aNpQbr']=function(_0xf22cbd){if(!Boolean(~_0xf22cbd))return _0xf22cbd;return this['DgyoLt'](this['UsyzKD']);},_0x2b95d1['prototype']['DgyoLt']=function(_0x2040e5){for(let _0x25f428=-0xd3d+0x26ba+-0xf*0x1b3,_0x13a399=this['hQxByr']['length'];_0x25f428<_0x13a399;_0x25f428++){this['hQxByr']['push'](Math['round'](Math['random']())),_0x13a399=this['hQxByr']['length'];}return _0x2040e5(this['hQxByr'][-0xe76+0x2*-0xa58+0x1*0x2326]);},new _0x2b95d1(_0x1120)['WtqKfq'](),_0x17c3c2=_0x1120['CRkPFR'](_0x17c3c2),_0x1120['ZlFhIQ'][_0x1f5a0f]=_0x17c3c2;}else _0x17c3c2=_0x521758;return _0x17c3c2;}import{getworldvar}from'./worldbookProcessor.js';export function checkTriggerWords(_0x42fe77,_0x1c56ba){const _0x4c863e={'jlRKp':function(_0x5795c8,_0x361d39,_0x1be5b6,_0x5e7d4b){return _0x5795c8(_0x361d39,_0x1be5b6,_0x5e7d4b);},'jaiSg':function(_0x43b60e,_0x282fbf){return _0x43b60e===_0x282fbf;},'BIBna':_0x5785b4(0x202,0x250,0x262,0x206),'bVxlR':_0x5efae7(0x2e7,0x305,0x341,0x2d8),'JyEYQ':_0x5785b4(0x1f6,0x20a,0x1c9,0x25c),'KGkos':'xlUuz'};if(!_0x42fe77||!_0x1c56ba)return![];function _0x5efae7(_0x5ca127,_0x595356,_0x286390,_0x241ace){return _0x1120(_0x595356-0x100,_0x5ca127);}function _0x5785b4(_0x40eae2,_0x31f026,_0x483bad,_0x108118){return _0x1120(_0x31f026-0xb,_0x483bad);}const _0x1f2c8f=_0x42fe77[_0x5efae7(0x320,0x2e0,0x2e2,0x316)](',')['map'](_0xb58289=>_0xb58289[_0x5785b4(0x1ff,0x226,0x1e8,0x203)]())[_0x5efae7(0x371,0x338,0x358,0x302)](_0x5733ee=>_0x5733ee);if(_0x4c863e[_0x5efae7(0x339,0x304,0x338,0x301)](_0x1f2c8f['length'],0x123d+0xe0*0x18+0x29*-0xf5))return _0x4c863e[_0x5785b4(0x1fc,0x1e8,0x194,0x1fd)]!==_0x5785b4(0x22b,0x250,0x280,0x230)?{..._0x51e526,'text':_0x4c863e[_0x5785b4(0x1f4,0x1f5,0x23d,0x244)](_0x1d3f43,_0x5ebbb6[_0x5efae7(0x2e7,0x320,0x33f,0x325)],_0x473547,_0x5040b3)}:![];for(const _0x1691ff of _0x1f2c8f){if(_0x4c863e[_0x5785b4(0x1dc,0x1ea,0x19d,0x213)]===_0x4c863e[_0x5785b4(0x2b9,0x280,0x243,0x273)]){const _0x1df536=_0x489b37[_0x5efae7(0x37e,0x344,0x2fe,0x371)](_0x500bce,arguments);return _0x44c040=null,_0x1df536;}else{if(_0x1c56ba[_0x5efae7(0x35e,0x34d,0x360,0x342)](_0x1691ff))return _0x4c863e[_0x5785b4(0x25c,0x20f,0x1c5,0x25d)](_0x4c863e['KGkos'],_0x5efae7(0x2fa,0x2e4,0x2b5,0x332))?!![]:![];}}return![];}export function mergeAdjacentMessages(_0x10402e){const _0x5903f8={'yBhRz':function(_0x5134f2,_0x7a5e8b,_0x1bbd4e){return _0x5134f2(_0x7a5e8b,_0x1bbd4e);},'GTeZT':function(_0x3adaf8,_0x44f5ed){return _0x3adaf8===_0x44f5ed;},'oNoAY':_0x5770b4(0x5b2,0x600,0x5cf,0x61b)};if(!_0x10402e||_0x5903f8['GTeZT'](_0x10402e[_0x239cb3(0x138,0xe6,0x123,0x17d)],0x1*0xa2e+0x10a5*-0x2+0x171c*0x1))return[];const _0x566bdb=[];let _0x5951d2=null;function _0x5770b4(_0x5e4ecf,_0x4d4937,_0x35941d,_0x2fb9a1){return _0x1120(_0x35941d-0x35b,_0x5e4ecf);}for(const _0x432831 of _0x10402e){if(!_0x5951d2){const _0x559b70={..._0x432831};_0x5951d2=_0x559b70;}else{if(_0x5951d2[_0x5770b4(0x5c6,0x592,0x57c,0x52d)]===_0x432831[_0x5770b4(0x556,0x5ae,0x57c,0x57f)])_0x5951d2[_0x239cb3(0xe9,0x127,0xfa,0x10c)]=_0x5903f8[_0x5770b4(0x50d,0x512,0x543,0x590)](mergeContent,_0x5951d2['content'],_0x432831[_0x239cb3(0xe9,0xd7,0xa4,0xef)]);else{_0x566bdb['push'](_0x5951d2);const _0xf66568={..._0x432831};_0x5951d2=_0xf66568;}}}if(_0x5951d2){if('WICHS'!==_0x5903f8[_0x5770b4(0x5b8,0x551,0x56b,0x5a2)])_0x566bdb[_0x5770b4(0x62a,0x5b9,0x5d8,0x58f)](_0x5951d2);else{const _0x3d3956=_0x33dfc4[_0x5770b4(0x5c9,0x59a,0x576,0x54d)]();return _0x5903f8[_0x5770b4(0x575,0x51d,0x543,0x590)](_0x5b2c39,_0x3d3956,_0x1c78bd),_0xb442f5&&_0x7fbe9a['add'](_0x5770b4(0x5b2,0x55c,0x595,0x5bc)+_0x239cb3(0xc2,0x10c,0xf8,0x96)+_0x3d3956+'@}'),'';}}function _0x239cb3(_0x4ac59b,_0x32f23b,_0x141438,_0xb7379a){return _0x1120(_0x4ac59b- -0x13f,_0x141438);}return _0x566bdb;}function mergeContent(_0x2757d8,_0xea612e){const _0x48407e={'sgGtJ':function(_0x4399c0,_0xea89c0){return _0x4399c0===_0xea89c0;},'nzlTX':_0x18cae5(0x565,0x5e4,0x594,0x5a9),'LptFU':function(_0x3aab12,_0x32ab12){return _0x3aab12+_0x32ab12;},'nAOPy':function(_0x400a64,_0x2198fb){return _0x400a64(_0x2198fb);},'XYxTR':function(_0x3dca9f,_0x3388ff){return _0x3dca9f(_0x3388ff);}};if(_0x48407e[_0x595beb(-0x17,-0x38,-0x64,-0x91)](typeof _0x2757d8,_0x48407e[_0x595beb(-0x2,0xa,-0x24,-0x64)])&&_0x48407e[_0x18cae5(0x548,0x559,0x53e,0x58e)](typeof _0xea612e,_0x595beb(-0x77,-0x23,-0x49,-0x29)))return _0x48407e[_0x18cae5(0x599,0x5ac,0x568,0x59b)](_0x48407e[_0x18cae5(0x5c4,0x5db,0x599,0x59b)](_0x2757d8,'\x0a'),_0xea612e);const _0x46285b=_0x48407e[_0x595beb(-0x98,-0x81,-0x59,-0xad)](normalizeToArray,_0x2757d8),_0x183d65=_0x48407e[_0x18cae5(0x64b,0x632,0x65f,0x61e)](normalizeToArray,_0xea612e);function _0x18cae5(_0x28dbdd,_0xfd4a52,_0x330fe7,_0x23df2d){return _0x1120(_0x23df2d-0x3b2,_0xfd4a52);}const _0xc3bf70={};_0xc3bf70[_0x595beb(0x3a,0x27,0x2b,-0x5)]=_0x595beb(-0x2b,-0x65,-0x20,-0x4);function _0x595beb(_0x4c8347,_0x30b369,_0x55cc22,_0x424eb2){return _0x1120(_0x55cc22- -0x240,_0x424eb2);}return _0xc3bf70[_0x18cae5(0x603,0x5e8,0x5e9,0x5d2)]='\x0a',[..._0x46285b,_0xc3bf70,..._0x183d65];}function normalizeToArray(_0x2ceb46){const _0x309cee={};function _0x5da7ab(_0x49d490,_0x5a3a32,_0xb43ab,_0x3b78f9){return _0x1120(_0x3b78f9-0xd8,_0xb43ab);}_0x309cee[_0x3b0088(0x35d,0x357,0x349,0x369)]=_0x5da7ab(0x2c5,0x2f5,0x322,0x2f8);function _0x3b0088(_0x58c787,_0x316e22,_0x2c4f96,_0x54abce){return _0x1120(_0x54abce-0x144,_0x2c4f96);}_0x309cee[_0x3b0088(0x3d9,0x3ab,0x392,0x3ae)]=function(_0xeb496,_0x32b0fd){return _0xeb496||_0x32b0fd;};const _0x2b7294=_0x309cee;if(Array['isArray'](_0x2ceb46))return _0x2ceb46;return[{'type':_0x2b7294[_0x5da7ab(0x2d1,0x2bc,0x2f4,0x2fd)],'text':_0x2b7294[_0x3b0088(0x3a0,0x35c,0x3bb,0x3ae)](_0x2ceb46,'')}];}export function replacePlaceholder(_0x51d812,_0xf1090,_0x1c2bd7,_0xd6c3a4){const _0x530580={'tJkzT':function(_0x5a9523,_0x4fa720){return _0x5a9523===_0x4fa720;},'yGOaa':_0x3a70a9(-0x4e,-0x52,-0x17,-0x9),'OPbqr':function(_0x20a484,_0x2c3e0a){return _0x20a484||_0x2c3e0a;},'NMLZd':'object','yyYZW':function(_0x16d278,_0xb24f49){return _0x16d278!==_0xb24f49;},'ERfOW':_0x53d989(0x86,0xd4,0xbe,0xd8),'pbdJT':function(_0x305e57,_0x3a763c,_0x817464,_0x4d4d37,_0x352d4d){return _0x305e57(_0x3a763c,_0x817464,_0x4d4d37,_0x352d4d);}};if(_0x530580[_0x53d989(0x6f,0xb5,0x8b,0x38)](typeof _0x51d812,_0x530580[_0x3a70a9(-0x22,0x2e,-0x13,-0x34)]))return _0x1c2bd7&&_0x51d812[_0x3a70a9(0x8,-0x20,0x5c,0x45)](_0xf1090)&&(_0xd6c3a4&&_0xd6c3a4['add'](_0xf1090)),_0x51d812[_0x53d989(0xd9,0xc3,0x97,0x5c)](_0xf1090,_0x530580['OPbqr'](_0x1c2bd7,''));function _0x53d989(_0x3aa417,_0x512226,_0xb43ce,_0x288ef9){return _0x1120(_0xb43ce- -0x156,_0x512226);}if(Array[_0x53d989(0x10e,0xf8,0xfe,0xdf)](_0x51d812))return _0x51d812['map'](_0x4f9288=>replacePlaceholder(_0x4f9288,_0xf1090,_0x1c2bd7,_0xd6c3a4));if(_0x51d812&&_0x530580[_0x53d989(0x6a,0x4c,0x8b,0x47)](typeof _0x51d812,_0x530580[_0x3a70a9(-0x27,0x13,-0x41,-0x62)])){if(_0x530580[_0x3a70a9(-0x28,-0x34,0x16,-0xb)](_0x53d989(0x67,0x89,0x85,0x6a),_0x530580[_0x53d989(0xdf,0xf2,0x10b,0xc6)])){const _0x461ac0={};for(const _0x55ed6f in _0x51d812){_0x461ac0[_0x55ed6f]=_0x530580[_0x3a70a9(-0x43,-0xb,-0x66,-0x7e)](replacePlaceholder,_0x51d812[_0x55ed6f],_0xf1090,_0x1c2bd7,_0xd6c3a4);}return _0x461ac0;}else _0xb3581b[_0x3a70a9(-0x14,-0x16,-0x39,-0x37)](_0x354ddb);}function _0x3a70a9(_0x4ad2c7,_0x5864ef,_0x10c661,_0x7bb59b){return _0x1120(_0x4ad2c7- -0x245,_0x7bb59b);}return _0x51d812;}export function replaceAllPlaceholders(_0x4dc881,_0x1165ce){const _0x132786={'mgcCp':'user','VCpuS':function(_0x166258,_0x2a13e9){return _0x166258!==_0x2a13e9;},'urnpR':_0x2eea63(0x435,0x4b3,0x474,0x497),'hdaQF':function(_0x392ce5){return _0x392ce5();},'YrRTn':_0x5f1145(0x157,0x151,0x175,0x12b),'jwwaq':_0x5f1145(0xe6,0xb1,0xf5,0x11b),'NvzkC':function(_0x5dfa8f,_0x41c4eb,_0xb70af3,_0x4856ac,_0x5484e9){return _0x5dfa8f(_0x41c4eb,_0xb70af3,_0x4856ac,_0x5484e9);},'Nevse':_0x5f1145(0x177,0x167,0x1cb,0x198),'dcvQZ':function(_0x2fbf0b,_0x50ce90,_0x13c462,_0x33c214,_0x25fabf){return _0x2fbf0b(_0x50ce90,_0x13c462,_0x33c214,_0x25fabf);},'epIyZ':_0x5f1145(0x10e,0xf4,0xf8,0xea),'bWoVW':_0x5f1145(0x16c,0x122,0x136,0x193),'mxYpO':_0x2eea63(0x48d,0x4ec,0x4d1,0x4a4),'eEwED':_0x5f1145(0x10a,0x118,0xda,0x10c)+'}}','iTkMq':_0x2eea63(0x49e,0x487,0x4d8,0x4c5)+'}}','JXhZm':_0x5f1145(0xd4,0xe2,0x8b,0x124),'THnmp':function(_0x4061d5,_0x42f6fb){return _0x4061d5>_0x42f6fb;},'MDViZ':_0x5f1145(0x162,0x19e,0x134,0x118),'INIuM':_0x5f1145(0x176,0x15b,0x149,0x13e),'YrMUA':_0x2eea63(0x4f6,0x4ed,0x4e8,0x4cd),'kfzNc':function(_0x4d0aac,_0x368311,_0x4320dc,_0x192360,_0x2295ee){return _0x4d0aac(_0x368311,_0x4320dc,_0x192360,_0x2295ee);},'BHRaw':function(_0x5404ce,_0x3d2160,_0x122450){return _0x5404ce(_0x3d2160,_0x122450);}},{context:context='',body:body='',worldBookContent:worldBookContent='',variables:variables={},userDemand:userDemand='',characterListText:characterListText='',outfitEnableListText:outfitEnableListText='',commonCharacterListText:commonCharacterListText=''}=_0x1165ce,_0x15e55c=new Set();let _0x20489f=_0x4dc881;function _0x5f1145(_0x2f36a5,_0xceb68c,_0x5e7734,_0x3b3ffa){return _0x1120(_0x2f36a5- -0x105,_0x3b3ffa);}const _0x11051b=_0x132786[_0x2eea63(0x4d8,0x4b6,0x4e3,0x501)](getContext),_0x3961d2=_0x11051b?.[_0x5f1145(0x125,0x114,0x14a,0xe0)]||'';let _0x105a41=worldBookContent;_0x105a41&&(_0x105a41=_0x105a41[_0x2eea63(0x474,0x46e,0x47b,0x4c6)](_0x132786[_0x5f1145(0x171,0x1ae,0x14b,0x1a1)],_0x3961d2),_0x105a41=_0x105a41[_0x2eea63(0x45b,0x45f,0x47b,0x42a)](_0x132786[_0x5f1145(0x174,0x1aa,0x1a5,0x122)],_0x3961d2));_0x20489f=_0x132786[_0x5f1145(0x144,0x12d,0x101,0x15a)](replacePlaceholder,_0x20489f,_0x132786[_0x5f1145(0x14c,0x157,0x121,0x149)],context,_0x15e55c),_0x20489f=_0x132786['dcvQZ'](replacePlaceholder,_0x20489f,_0x132786[_0x5f1145(0x102,0x117,0x12b,0xdc)],_0x105a41,_0x15e55c),_0x20489f=_0x132786[_0x5f1145(0x144,0x176,0x183,0x17c)](replacePlaceholder,_0x20489f,_0x132786[_0x5f1145(0x12b,0x10d,0x145,0x129)],body,_0x15e55c);function _0x2eea63(_0x475e8f,_0xc1c56b,_0x361642,_0x36278b){return _0x1120(_0x361642-0x28e,_0xc1c56b);}_0x20489f=_0x132786['dcvQZ'](replacePlaceholder,_0x20489f,_0x132786['mxYpO'],characterListText,_0x15e55c),_0x20489f=_0x132786[_0x2eea63(0x540,0x4e8,0x50d,0x521)](replacePlaceholder,_0x20489f,_0x132786[_0x2eea63(0x4f2,0x4f6,0x4f6,0x513)],outfitEnableListText,_0x15e55c),_0x20489f=replacePlaceholder(_0x20489f,_0x132786[_0x5f1145(0x179,0x1cd,0x1b1,0x13f)],commonCharacterListText,_0x15e55c),_0x20489f=_0x132786[_0x5f1145(0x17a,0x1a4,0x197,0x15a)](replacePlaceholder,_0x20489f,_0x132786['JXhZm'],userDemand,_0x15e55c);if(variables&&_0x132786[_0x5f1145(0xeb,0x131,0xd1,0x127)](Object[_0x5f1145(0x126,0xf1,0x158,0x163)](variables)[_0x5f1145(0x172,0x130,0x19a,0x198)],-0x8*0x417+0xec*-0x15+0x115c*0x3)){if(_0x132786[_0x2eea63(0x4c4,0x462,0x48e,0x447)](_0x132786[_0x2eea63(0x4e8,0x491,0x4d0,0x509)],_0x132786[_0x5f1145(0x13d,0x159,0x15b,0x103)]))for(const _0x45f7e0 of _0xf0ee2[_0x2eea63(0x447,0x4a5,0x487,0x459)]){if(_0x45f7e0[_0x2eea63(0x4a3,0x4af,0x4ce,0x4ce)]&&_0x45f7e0[_0x5f1145(0x13b,0x11f,0x145,0x146)][_0x5f1145(0x116,0xc9,0xfa,0x100)]()!==''){const _0x6c2c02={};_0x6c2c02[_0x2eea63(0x4ca,0x45f,0x4af,0x483)]=_0x132786[_0x5f1145(0x159,0x1a6,0x143,0x17c)],_0x6c2c02[_0x5f1145(0x123,0x168,0x168,0xd6)]=_0x45f7e0['user'],_0x41b1cf['push'](_0x6c2c02);}if(_0x45f7e0['assistant']&&_0x132786[_0x5f1145(0xfb,0x13b,0xcc,0x12e)](_0x45f7e0[_0x5f1145(0xe1,0xc0,0x12b,0x130)][_0x2eea63(0x495,0x463,0x4a9,0x457)](),'')){const _0x3b5b93={};_0x3b5b93[_0x5f1145(0x11c,0xda,0xe2,0x12c)]=_0x132786[_0x2eea63(0x4a2,0x49b,0x498,0x4bb)],_0x3b5b93[_0x5f1145(0x123,0x163,0x15c,0x122)]=_0x45f7e0[_0x2eea63(0x48a,0x448,0x474,0x439)],_0xf6b913[_0x5f1145(0x178,0x19f,0x144,0x12b)](_0x3b5b93);}}else{const _0x39209f=/\{\{getvar::([^}]+)\}\}/g,_0x4ccef8=JSON[_0x5f1145(0x10c,0x153,0x12c,0x10d)](_0x20489f),_0x580b81=[..._0x4ccef8[_0x2eea63(0x4aa,0x49b,0x466,0x450)](_0x39209f)],_0x1088cf=new Set();for(const _0x4055da of _0x580b81){if(_0x132786['INIuM']!==_0x132786[_0x2eea63(0x4be,0x444,0x486,0x4b5)])_0x1088cf[_0x5f1145(0x12c,0x157,0x16c,0x100)](_0x4055da[0xe8c+0x2e6*-0x6+-0x1b*-0x1b]);else return!![];}for(const _0x271e35 of _0x1088cf){const _0x494b7a=_0x2eea63(0x4ac,0x494,0x4d4,0x494)+_0x271e35+'}}',_0x4ea86e=variables[_0x271e35]||'';_0x20489f=_0x132786[_0x2eea63(0x4df,0x501,0x4cf,0x4e9)](replacePlaceholder,_0x20489f,_0x494b7a,_0x4ea86e,_0x15e55c);}}}_0x20489f=_0x132786['BHRaw'](processVariablePlaceholdersInMessages,_0x20489f,_0x15e55c);const _0xc29e8={};return _0xc29e8[_0x5f1145(0x16d,0x17d,0x165,0x16a)]=_0x20489f,_0xc29e8['replacedVa'+'riables']=_0x15e55c,_0xc29e8;}function processVariablePlaceholdersInMessages(_0x3deb2c,_0xda4ce8){function _0x35f4d7(_0x203f4f,_0x3821d0,_0x37b89d,_0xdc151e){return _0x1120(_0xdc151e-0x309,_0x37b89d);}const _0x443050={'zNcHE':function(_0x4ea9b9,_0x421a76){return _0x4ea9b9+_0x421a76;},'xxlAa':function(_0x133891,_0x4bfd3c){return _0x133891+_0x4bfd3c;},'twyvE':'fzDoU','yVZsG':function(_0x39d63b,_0x48c190,_0x43255a,_0x5e16f9){return _0x39d63b(_0x48c190,_0x43255a,_0x5e16f9);},'wsbXU':function(_0x2a7e66,_0x144ed0){return _0x2a7e66===_0x144ed0;},'fayVd':function(_0x1632bb){return _0x1632bb();},'sxNdv':'HryZQ','YUTcS':_0x8bd131(0x4c4,0x4e7,0x4be,0x4be)};function _0x8bd131(_0x287682,_0x5bfd65,_0x18c416,_0x34a53d){return _0x1120(_0x18c416-0x24e,_0x5bfd65);}if(!_0x3deb2c||_0x443050['wsbXU'](_0x3deb2c[_0x8bd131(0x4c3,0x4d9,0x4c5,0x492)],-0x2*-0x69d+0x7c8+-0x1502))return _0x3deb2c;const _0x4642d6=_0x443050[_0x35f4d7(0x52c,0x57d,0x507,0x538)](getContext);if(!_0x4642d6[_0x8bd131(0x4a5,0x49d,0x4bc,0x4f2)+'ta']){if(_0x443050[_0x35f4d7(0x515,0x49c,0x4ca,0x4ee)]===_0x443050[_0x8bd131(0x414,0x412,0x448,0x42e)])return _0xc92049[_0x8bd131(0x47d,0x436,0x489,0x481)](_0x42b5df=>_0x29c692(_0x42b5df,_0x1ab3ff,_0x36a550,_0x413ab5));else _0x4642d6['chatMetada'+'ta']={};}return!_0x4642d6[_0x8bd131(0x47a,0x4d7,0x4bc,0x4f1)+'ta'][_0x35f4d7(0x528,0x4fa,0x538,0x4f8)]&&(_0x4642d6[_0x8bd131(0x4e3,0x4a6,0x4bc,0x47a)+'ta'][_0x35f4d7(0x4cb,0x4e4,0x516,0x4f8)]={}),_0x3deb2c[_0x8bd131(0x49f,0x49d,0x489,0x463)](_0x46d552=>{function _0x32056e(_0x1d7061,_0x2278a2,_0x33c970,_0x13a1f4){return _0x8bd131(_0x1d7061-0x69,_0x1d7061,_0x13a1f4-0xf6,_0x13a1f4-0x2e);}function _0xcc7f80(_0x29655a,_0x3140fc,_0x42528c,_0x1f12c3){return _0x35f4d7(_0x29655a-0x1bd,_0x3140fc-0xd8,_0x3140fc,_0x42528c- -0x5da);}if(_0xcc7f80(-0x4f,-0xa5,-0x89,-0x6a)!==_0x443050[_0xcc7f80(-0xbd,-0x65,-0x85,-0xa8)]){if(!_0x46d552||!_0x46d552['content'])return _0x46d552;return{..._0x46d552,'content':_0x443050['yVZsG'](processContentVariables,_0x46d552[_0x32056e(0x54c,0x560,0x57c,0x56c)],_0x4642d6,_0xda4ce8)};}else return _0x443050[_0xcc7f80(-0xd0,-0x81,-0xb7,-0xd6)](_0x443050[_0xcc7f80(-0x8e,-0x6a,-0xa8,-0x93)](_0x2bdb06,'\x0a'),_0x1bb79e);});}function processContentVariables(_0xc3cbc3,_0x312881,_0x216ea6){const _0x30a90b={'YvAcF':function(_0x149f49,_0x2b1b74){return _0x149f49===_0x2b1b74;},'gdjMh':'Xlnhc','arSBO':_0x534a9d(0x607,0x5bc,0x58d,0x581),'wwqLN':function(_0x32a5e7,_0x4a7802){return _0x32a5e7===_0x4a7802;},'lenKK':_0x58dc53(0x241,0x238,0x2c8,0x27e),'OcUeh':_0x534a9d(0x5c7,0x57f,0x542,0x55e),'jYiav':function(_0x5531cd,_0x28ac5c,_0x33c726,_0x279c08){return _0x5531cd(_0x28ac5c,_0x33c726,_0x279c08);},'bnoDN':function(_0x32572c,_0x494a2c){return _0x32572c===_0x494a2c;},'yIGRT':function(_0x4920a7,_0x24b290,_0x183705,_0x513c99){return _0x4920a7(_0x24b290,_0x183705,_0x513c99);}};if(_0x30a90b['bnoDN'](typeof _0xc3cbc3,_0x30a90b[_0x58dc53(0x304,0x2e3,0x31c,0x2c7)]))return _0x30a90b[_0x58dc53(0x27a,0x277,0x272,0x2c3)](processStringVariables,_0xc3cbc3,_0x312881,_0x216ea6);if(Array[_0x58dc53(0x270,0x2de,0x2e6,0x2b2)](_0xc3cbc3))return _0xc3cbc3[_0x58dc53(0x2b9,0x281,0x28d,0x299)](_0x4cde4c=>{function _0x4384b8(_0x2e776c,_0xfac77,_0x5419e5,_0x5b8a72){return _0x58dc53(_0x5419e5,_0xfac77-0x13b,_0x5419e5-0xff,_0xfac77-0xa);}function _0x29c965(_0x538e0b,_0x551c53,_0x20bd7f,_0x5bd6c1){return _0x58dc53(_0x551c53,_0x551c53-0x82,_0x20bd7f-0x113,_0x5bd6c1-0x57);}if(_0x30a90b[_0x4384b8(0x292,0x265,0x2b6,0x256)](_0x30a90b[_0x29c965(0x2de,0x2f0,0x2b6,0x2f1)],_0x30a90b[_0x4384b8(0x29a,0x25c,0x227,0x21b)]))_0x47651c[_0x4384b8(0x2b4,0x2d6,0x327,0x31d)+'ta']={};else{if(_0x4cde4c&&_0x30a90b['wwqLN'](_0x4cde4c[_0x29c965(0x360,0x304,0x340,0x320)],_0x30a90b[_0x29c965(0x2f8,0x29f,0x299,0x2c2)])&&_0x30a90b[_0x29c965(0x2b1,0x2ea,0x2f3,0x2cd)](typeof _0x4cde4c['text'],_0x30a90b[_0x29c965(0x2cf,0x310,0x35c,0x31e)]))return{..._0x4cde4c,'text':_0x30a90b[_0x4384b8(0x2b8,0x266,0x28c,0x2ac)](processStringVariables,_0x4cde4c[_0x29c965(0x2b0,0x31e,0x284,0x2d5)],_0x312881,_0x216ea6)};return _0x4cde4c;}});function _0x534a9d(_0x256899,_0x4d57f1,_0x431b52,_0x5b2d53){return _0x1120(_0x4d57f1-0x388,_0x5b2d53);}function _0x58dc53(_0x517747,_0x1efc81,_0x32fd42,_0x37dedc){return _0x1120(_0x37dedc-0x5e,_0x517747);}return _0xc3cbc3;}function processStringVariables(_0x845041,_0x12ce12,_0xda24b){const _0x11e5c6={'kXudw':function(_0x494997,_0x233ff6){return _0x494997===_0x233ff6;},'yopoC':_0x3553ba(0x3f8,0x3cf,0x38e,0x3c9),'jAJkP':_0x3553ba(0x3a6,0x3dc,0x3c0,0x3ce),'zcCFQ':function(_0x8f921b,_0x2b955d,_0x328b7a,_0x1680a6,_0xe054fa){return _0x8f921b(_0x2b955d,_0x328b7a,_0x1680a6,_0xe054fa);},'nvnJu':_0x5062e6(0x2f4,0x2a0,0x2f2,0x2a1)};if(!_0x845041)return _0x845041;let _0x17ced2=_0x845041;function _0x5062e6(_0x225927,_0x3aa3af,_0x392d97,_0x59cdea){return _0x1120(_0x392d97-0xc0,_0x3aa3af);}_0x17ced2=_0x17ced2['replace'](/\{@setvar::([^:@]+)::([\s\S]*?)@\}/g,(_0x1e1a21,_0x321821,_0x4fff81)=>{function _0x19771d(_0x843e46,_0x190954,_0x29d3d3,_0x39fbee){return _0x5062e6(_0x843e46-0x12e,_0x190954,_0x39fbee-0xd2,_0x39fbee-0x79);}function _0x434396(_0x274082,_0x25e67f,_0x558e2a,_0x2adf21){return _0x5062e6(_0x274082-0xc6,_0x2adf21,_0x25e67f-0xca,_0x2adf21-0x1a);}if(_0x11e5c6[_0x19771d(0x32c,0x367,0x340,0x36c)](_0x11e5c6['yopoC'],_0x11e5c6[_0x19771d(0x348,0x35a,0x35c,0x384)])){_0xd85824['push'](_0x37fae);const _0x365e13={..._0x389e36};_0x5ee831=_0x365e13;}else{const _0x4b724b=_0x321821[_0x19771d(0x360,0x3bd,0x399,0x3ad)]();return _0x12ce12[_0x434396(0x420,0x3f8,0x3ce,0x3e3)+'ta']['variables'][_0x4b724b]=_0x4fff81,_0xda24b&&_0xda24b[_0x19771d(0x395,0x3e0,0x3aa,0x3c3)](_0x434396(0x3ce,0x3b6,0x3e2,0x3aa)+_0x4b724b+'@}'),'';}}),_0x17ced2=_0x17ced2[_0x5062e6(0x25d,0x275,0x2a2,0x2c8)](/\{@getvar::([^@]+)@\}/g,(_0x5462d4,_0x14348d)=>{function _0x2e9480(_0x5be13c,_0x56998a,_0x29ba97,_0x4a73de){return _0x3553ba(_0x5be13c-0x8c,_0x56998a,_0x29ba97-0x7,_0x5be13c- -0x1db);}const _0x518929=_0x14348d['trim'](),_0x125030=_0x12ce12['chatMetada'+'ta'][_0x2e9480(0x1be,0x1db,0x198,0x1c8)][_0x518929]||'';function _0x3d2fff(_0x54911b,_0x191f68,_0x29eca1,_0x153780){return _0x3553ba(_0x54911b-0x1c2,_0x54911b,_0x29eca1-0xc7,_0x153780- -0x24a);}return _0xda24b&&_0xda24b[_0x3d2fff(0x15b,0x165,0x152,0x191)](_0x3d2fff(0x134,0x122,0x184,0x16c)+_0x518929+'@}'),_0x125030;}),_0x17ced2=_0x17ced2[_0x5062e6(0x271,0x2c2,0x2a2,0x2c0)](/\{@setglobalvar::([^:@]+)::([\s\S]*?)@\}/g,(_0x33cada,_0x5823e8,_0x28dc50)=>{const _0x4181cf=_0x5823e8['trim']();function _0x1ea797(_0x375e56,_0x5b1deb,_0x1beca2,_0xf4528e){return _0x5062e6(_0x375e56-0x160,_0x375e56,_0x1beca2- -0x1c,_0xf4528e-0x9);}function _0x1c4a0a(_0x4720b8,_0x58fce0,_0x65d5d7,_0x5db64d){return _0x3553ba(_0x4720b8-0x0,_0x4720b8,_0x65d5d7-0x1be,_0x5db64d- -0x545);}return setglobalvar(_0x4181cf,_0x28dc50),_0xda24b&&_0xda24b[_0x1ea797(0x2ea,0x300,0x2d5,0x31d)](_0x1c4a0a(-0x198,-0x129,-0x134,-0x161)+_0x1ea797(0x2a5,0x29e,0x2a5,0x2f6)+_0x4181cf+'@}'),'';}),_0x17ced2=_0x17ced2[_0x3553ba(0x395,0x3c7,0x380,0x38c)](/\{@getglobalvar::([^@]+)@\}/g,(_0x57ded4,_0x4e03ba)=>{function _0x5ddc3f(_0x4404b4,_0x3c01a6,_0x44fbed,_0x35e514){return _0x5062e6(_0x4404b4-0x120,_0x44fbed,_0x35e514- -0x221,_0x35e514-0x4e);}const _0x1ad15d={'kaJlS':function(_0x2a5bd6,_0x4a8e05,_0x30ed0a,_0x1099c6,_0x2ed4bb){function _0x2396c4(_0x267197,_0x47070b,_0xe7b433,_0x3d4309){return _0x1120(_0x47070b-0xe6,_0x3d4309);}return _0x11e5c6[_0x2396c4(0x2d1,0x30d,0x2b9,0x2f3)](_0x2a5bd6,_0x4a8e05,_0x30ed0a,_0x1099c6,_0x2ed4bb);}};function _0xa64080(_0x195026,_0x5c10a8,_0x21ab30,_0x46fa2c){return _0x5062e6(_0x195026-0x17a,_0x21ab30,_0x195026- -0x283,_0x46fa2c-0x87);}if(_0x11e5c6[_0xa64080(0x17,-0x32,0x32,0xd)](_0xa64080(0x9c,0xef,0x9f,0x66),'ijGZK')){const _0x567903=_0x4e03ba['trim'](),_0xaae01=getglobalvar(_0x567903)||'';return _0xda24b&&(_0x5ddc3f(0x11d,0x93,0xa7,0xd1)===_0x11e5c6[_0x5ddc3f(0xa2,0xe2,0xc4,0xf5)]?_0xda24b[_0x5ddc3f(0xe1,0xd7,0x106,0xd0)](_0x5ddc3f(0x101,0x10f,0x16a,0x117)+_0xa64080(0x3e,0x21,0x1f,0x3d)+_0x567903+'@}'):_0x4d201e[_0x3d20b7]=_0x1ad15d['kaJlS'](_0x19258e,_0x2b3361[_0x28195e],_0x46d189,_0x4a2714,_0x29c06f)),_0xaae01;}else return _0x37bebc;}),_0x17ced2=_0x17ced2[_0x3553ba(0x397,0x3bb,0x375,0x38c)](/\{@getworldvar::([^@]+)@\}/g,(_0x5a4937,_0x7bda8c)=>{function _0xdb43f2(_0x3cc2aa,_0x38b32f,_0x1e2ca9,_0x4de4b7){return _0x5062e6(_0x3cc2aa-0x7d,_0x1e2ca9,_0x38b32f- -0xfe,_0x4de4b7-0x45);}const _0x4e59b9=_0x7bda8c[_0xdb43f2(0x192,0x1dd,0x201,0x1bb)](),_0x3ba646=getworldvar(_0x4e59b9)||'';function _0x48f0de(_0x1ed5f8,_0x245d5d,_0x4bfad1,_0x28732f){return _0x3553ba(_0x1ed5f8-0x11e,_0x28732f,_0x4bfad1-0x152,_0x4bfad1- -0x2eb);}return _0xda24b&&_0xda24b['add'](_0xdb43f2(0x227,0x211,0x24e,0x235)+_0xdb43f2(0x22e,0x20d,0x21b,0x254)+_0x4e59b9+'@}'),_0x3ba646;});function _0x3553ba(_0x513664,_0x2cad4a,_0x33445a,_0x500cae){return _0x1120(_0x500cae-0x1aa,_0x2cad4a);}return _0x17ced2;}function _0x1cb5(){const _0x4e6123=['zxbjEvO','mJaWu3bgv0zp','mtjkzvjuy1y','DxjUCfi','uejRug8','E0bNzxr2yxi6oG','BgvUs0S','DhjPz2DLCK1Vza','E3VPGjRNLkJMNi3OO4xLKk/NLkJLIjFOOAG','B05VqvK','C3rYAw5NAwz5','nLjksK51Eq','E3VKUjBNLyZKUABOP6BLJ5f9Fq','r1bpExq','twPiD2G','y29UDgv4DerHDa','AuTst1O','D3DXte4','zw50CMLLCW','EK5Jseu','DhjPBq','BNPSvfG','ExLzwLC','tK1mwMq','BNvkwvO','Dgv4Da','CM9Szq','rffrvwW','EuDpywe','uxHMChi','AwL0Awq','DgvZDf9JB250zq','EMndrLe','y29UDgvUDa','EhHSqwe','BMfTzte','A2v5CW','E0bZzxr2yxi6oG','AhD6A1a','ndq2mtyZmKzitKfHua','zMf5vMq','yLDVvLC','ywrK','vhbwDNK','yMP0Dey','s095zNy','zg53uhO','BgXTx3jLCxvLCW','svDsDvO','zMLSDgvY','v29OCwC','E0bZzxrNBg9Iyq','BwfW','z2rQtwG','AM9PBG','Cer6Cwm','v3HNruS','DxnLCG','A2z6tMm','turwAvO','E3VOP5lOIBlLKk/NLkJLIjFOOAH9Fq','yxbWBhK','zxzoyuy','E3TNzxr2yxi6oG','nZe4nZHtBgnouKe','Ehv4wKC','tNz6A0m','E3VPGjRNLkJOP5lOIBlLKk/NLkJLIjFOOAG','DMfYoJO','DhD5DKu','Aw5JBhvKzxm','tLvmtLu','E0bNzxr3B3jSza','CKPuA2e','tMv2C2u','BMLYsvK','ExrPv28','AxnbCNjHEq','AgrHuuy','BNzUsNu','EhrFChjVzMLSzq','mJq5nJa3nhrlt3LMAq','nJu0mJm2AvHdB2rJ','r3rPBei','nJm1mtu3ywHKD2fv','E3T1C2vYFx0','CMzly20','BwDJq3a','AwPhwKS','C2DHAMG','rvjMt1C','CMvXDwvZDfr5Ca','CvjHyNa','yNfevMi','EuLhuLq','y29UC3rYDwn0BW','su5Kuxi','zuv3ruq','t2nvzwG','yxfyDwm','DhLWzq','wfL4vfi','B2zPBgu','y2HHDe1LDgfKyq','mJu0nduZmg1kAK9ZDG','refqshe','E3VMRApMLOD9Fq','BwvZC2fNzxm','rKfZwei','thrnANu','sNLfwve','wxjsvg4','BgvUz3rO','E0bNzxrNBg9Iyq','AND3yxe','u2XwChO','q1rsyM0','E3VKUiRKUiVMLOD9Fq','ChvZAa','AvrRtxe','zgn2uvO','Dg9tDhjPBMC','Bwf0y2HbBgW','E3VNLkJMIlFPNidMSyj9Fq','A1H1zhC','wNjXB1u','C2DhDeO','qKLcBMe','tMXeAMS','yLz4Bfi','C3bSAxq','DePRELq','CMvWBgfJzq','mZC3nJeZtuLIt3Lu','EgXvDxO','C3Hozhy','yxnZAxn0yw50','BKfpuhK','EujOuNO','thb0rLu','AMXss3a','phvZzxi+','C2vHCMnO','CMvWBgfJzufSBa','u1jMvKS','DMfYAwfIBgvZ','veHUBxa','DhjPz2DLCLDVCG','AKfkA1a','D29lExm','yxjtqK8','qMPTvg0','v3rjCNq','C3rYAw5N','wxjnvue','AgLZDg9YEq','wvvuy1m','kcGOlISPkYKRkq','zMLNCW','wxzby0y','ALLPyxy','BNrqtuu','vKnWDvm','BhzHCJO6','CgjKsLq','z3vsvwS','AMfPu2C','wvbdyvC','Ce5ovuq'];_0x1cb5=function(){return _0x4e6123;};return _0x1cb5();}export function buildPromptWithTrigger(_0x222f94){function _0x2d1107(_0x35fdca,_0x57300a,_0x2234f8,_0x2ae4c3){return _0x1120(_0x35fdca- -0x265,_0x2234f8);}const _0x47e93a={'Wohqg':function(_0x212f00,_0x2986f4){return _0x212f00===_0x2986f4;},'woKys':_0x2d1107(-0x45,-0x6,-0x6b,-0x8),'SRfVK':function(_0x145d52,_0x219010){return _0x145d52===_0x219010;},'SlVpz':'string','bqDVb':function(_0xc30d22,_0x41cf32,_0x1dc86e,_0xbdf91a){return _0xc30d22(_0x41cf32,_0x1dc86e,_0xbdf91a);},'SLvTy':_0x2d1107(-0x9,0x49,-0x2b,0x1),'LVAfS':'<user>','dnwPz':function(_0x3f03aa,_0x273c89){return _0x3f03aa===_0x273c89;},'ytiWo':'trigger','nirIY':function(_0x11ffbf,_0x2a138a,_0x41b675){return _0x11ffbf(_0x2a138a,_0x41b675);},'NlDjk':_0x2d1107(-0x5f,-0x4c,-0x80,-0xac),'DQQUl':_0x2d1107(0xe,-0x1e,0x1f,0x58),'NULNU':function(_0x4667fe,_0x28f15c){return _0x4667fe!==_0x28f15c;},'WtIrt':_0x216cf6(0x5a2,0x58c,0x5c9,0x5c0),'PBkPo':function(_0x2435c0,_0x39e335){return _0x2435c0!==_0x39e335;},'BjmTm':function(_0x17deb2,_0x593792){return _0x17deb2!==_0x593792;},'WxgEK':_0x2d1107(-0x50,-0x26,-0x3f,-0x67),'hwzkP':'assistant','iKROZ':function(_0x42908b,_0x53df39){return _0x42908b(_0x53df39);}},{requestType:_0x135684,contextData:_0x5d80fb}=_0x222f94,_0x542453=extension_settings[extensionName]?.[_0x2d1107(-0x2f,0xb,-0x68,-0x1)+'t_type_con'+_0x2d1107(-0x69,-0x7c,-0x87,-0x39)]||{},_0x36e22a={};_0x36e22a['context_pr'+_0x2d1107(0x8,-0x39,-0x41,0x4d)]='默认';const _0xffca09=_0x542453[_0x135684]||_0x36e22a,_0x16e9cf=_0xffca09['context_pr'+_0x216cf6(0x5cf,0x5f0,0x588,0x5cc)]||'默认',_0x261250=extension_settings[extensionName]?.[_0x2d1107(-0x3f,-0x42,-0x5a,-0x82)+_0x2d1107(-0xe,-0x26,-0x35,0x40)+'s']||{};function _0x216cf6(_0x23b9c2,_0x12f98e,_0xe2afaa,_0x4b2266){return _0x1120(_0x23b9c2-0x362,_0x4b2266);}const _0x3b5068=_0x261250[_0x16e9cf]||_0x261250[Object[_0x216cf6(0x58d,0x54a,0x5c8,0x5b2)](_0x261250)[-0xf6b+0x1cff+-0x2c*0x4f]]||{},{context:context='',body:body='',worldBookContent:worldBookContent='',userDemand:userDemand=''}=_0x5d80fb,_0x2fab45=[userDemand,context,body,worldBookContent][_0x216cf6(0x59a,0x549,0x577,0x5a3)](Boolean)[_0x216cf6(0x59f,0x561,0x5b8,0x5d1)]('\x0a'),_0x508fe5=[];if(_0x3b5068['entries']&&Array[_0x2d1107(-0x11,-0xa,-0x41,0x3c)](_0x3b5068['entries']))for(const _0x33e26d of _0x3b5068[_0x2d1107(-0x4c,-0x7a,-0x9,-0x48)]){if(!_0x33e26d['enabled'])continue;if(!_0x33e26d[_0x2d1107(-0x3d,-0x70,-0x32,-0x8c)]||_0x47e93a[_0x2d1107(-0x30,-0x4c,-0x60,-0x5a)](_0x33e26d[_0x2d1107(-0x3d,-0x5f,-0x21,-0x7a)]['trim'](),''))continue;if(_0x47e93a[_0x216cf6(0x550,0x566,0x589,0x537)](_0x33e26d[_0x216cf6(0x570,0x5b3,0x576,0x5a5)+'e'],_0x47e93a[_0x216cf6(0x5b5,0x5d4,0x586,0x57f)])){if(!_0x47e93a[_0x216cf6(0x5b4,0x58d,0x5a2,0x5ac)](checkTriggerWords,_0x33e26d[_0x216cf6(0x553,0x554,0x556,0x5a6)+'ds'],_0x2fab45))continue;}const _0x4c890b={};_0x4c890b[_0x216cf6(0x583,0x597,0x57e,0x587)]=_0x33e26d[_0x2d1107(-0x44,0xa,-0x56,-0x5e)]||_0x216cf6(0x5a2,0x5b8,0x5da,0x5c2),_0x4c890b['content']=_0x33e26d[_0x216cf6(0x58a,0x581,0x5c4,0x5b5)],_0x508fe5[_0x2d1107(0x18,0x10,0x28,0x3c)](_0x4c890b);}else{if(_0x3b5068['history']&&Array['isArray'](_0x3b5068[_0x2d1107(-0x6c,-0xbb,-0x8c,-0x6b)])){if(_0x47e93a[_0x2d1107(-0x87,-0xa5,-0x8f,-0xa3)]!==_0x47e93a[_0x216cf6(0x540,0x56c,0x572,0x51f)]){if(_0x4f9d9b&&_0x47e93a[_0x2d1107(-0x2c,-0x51,-0x13,-0x1a)](_0x3ba659[_0x2d1107(0x6,0x14,-0x2e,0x4d)],_0x47e93a[_0x216cf6(0x555,0x582,0x580,0x52a)])&&_0x47e93a[_0x2d1107(-0x77,-0x74,-0xc7,-0xab)](typeof _0x1e7c30['text'],_0x47e93a[_0x216cf6(0x5dc,0x5a0,0x588,0x5f7)]))return{..._0x4700fb,'text':_0x47e93a[_0x2d1107(-0x1,0x27,-0xc,-0xf)](_0x1665b0,_0x8a54e2[_0x2d1107(-0x45,-0x63,-0x2b,-0x31)],_0x3b8a89,_0x2afeeb)};return _0x3bde38;}else for(const _0x5ab77f of _0x3b5068[_0x216cf6(0x55b,0x54a,0x50a,0x548)]){if(_0x47e93a[_0x216cf6(0x584,0x55e,0x5b5,0x5a2)]!=='FAsXB'){const _0x5a8fd4=/\{\{getvar::([^}]+)\}\}/g,_0xc7a583=_0x898643[_0x216cf6(0x573,0x5a9,0x5b7,0x58c)](_0x534581),_0x4bf25d=[..._0xc7a583[_0x216cf6(0x53a,0x527,0x52a,0x520)](_0x5a8fd4)],_0x370a13=new _0x3646ab();for(const _0x345e39 of _0x4bf25d){_0x370a13['add'](_0x345e39[-0x7bf+-0x194c+0x1*0x210c]);}for(const _0x39f951 of _0x370a13){const _0x5e48e1=_0x2d1107(-0x1f,-0x5d,-0xd,-0x5e)+_0x39f951+'}}',_0x4ce6d0=_0x1135d2[_0x39f951]||'';_0x26ba97=_0x2a3041(_0x34dbdb,_0x5e48e1,_0x4ce6d0,_0x22af22);}}else{if(_0x5ab77f[_0x2d1107(-0x25,-0x39,0x18,-0x52)]&&_0x47e93a[_0x2d1107(-0x17,-0xd,-0x52,-0x56)](_0x5ab77f[_0x2d1107(-0x25,-0x4c,-0x13,-0x60)]['trim'](),'')){const _0x30bb5f={};_0x30bb5f[_0x216cf6(0x583,0x591,0x575,0x5ab)]=_0x47e93a[_0x2d1107(-0x6f,-0x4c,-0x76,-0x4d)],_0x30bb5f['content']=_0x5ab77f['user'],_0x508fe5[_0x216cf6(0x5df,0x5de,0x5bd,0x5a6)](_0x30bb5f);}if(_0x5ab77f[_0x216cf6(0x548,0x4f6,0x594,0x558)]&&_0x47e93a[_0x2d1107(-0x5a,-0xc,-0x91,-0x60)](_0x5ab77f[_0x2d1107(-0x7f,-0xb5,-0x34,-0x88)][_0x2d1107(-0x4a,-0x4a,-0x1b,-0x68)](),'')){if(_0x47e93a[_0x216cf6(0x557,0x55c,0x53e,0x536)](_0x47e93a[_0x216cf6(0x5a1,0x566,0x571,0x550)],_0x47e93a[_0x216cf6(0x5a1,0x54e,0x5da,0x550)]))_0x2ed46b=_0x1b6e3c['replaceAll'](_0x47e93a['SLvTy'],_0x381012),_0x51cc2c=_0x317bcf['replaceAll'](_0x47e93a['LVAfS'],_0x39f6a9);else{const _0x18e8dd={};_0x18e8dd[_0x2d1107(-0x44,-0x70,-0x12,-0x8e)]=_0x47e93a[_0x2d1107(-0x38,-0x22,-0x1b,-0x1b)],_0x18e8dd[_0x2d1107(-0x3d,-0x42,-0x51,-0x6c)]=_0x5ab77f[_0x2d1107(-0x7f,-0x99,-0x3d,-0x5f)],_0x508fe5['push'](_0x18e8dd);}}}}}}const _0x57490c=_0x47e93a[_0x2d1107(-0x4e,-0x3c,-0x85,-0x1b)](mergeAdjacentMessages,_0x508fe5),{messages:_0x22029d,replacedVariables:_0x1403a4}=_0x47e93a[_0x2d1107(-0x13,-0x46,-0x18,0x35)](replaceAllPlaceholders,_0x57490c,_0x5d80fb);return _0x22029d;}export function getProcessedPrompt(_0x44720b,_0x1df77c){const _0x3609e1={'qRabp':function(_0x432171,_0x568628){return _0x432171(_0x568628);}},_0x2a74f3={};function _0x4a16f7(_0x132edd,_0x31e4c8,_0x51e23b,_0xeae617){return _0x1120(_0x132edd- -0x7f,_0x51e23b);}_0x2a74f3[_0x186b66(0x27c,0x213,0x269,0x25a)+'e']=_0x44720b;function _0x186b66(_0x240600,_0xf9c953,_0x23fdcf,_0x133ed6){return _0x1120(_0x133ed6- -0x8,_0x23fdcf);}return _0x2a74f3[_0x186b66(0x23d,0x253,0x241,0x20e)+'a']=_0x1df77c,_0x3609e1[_0x4a16f7(0x1e4,0x1a1,0x200,0x191)](buildPromptWithTrigger,_0x2a74f3);}