(function(_0x52a7c9,_0x2e109c){const _0x12ae2b=_0x52a7c9();function _0x134b20(_0x37ce53,_0x4fc9af,_0x586d71,_0x5b873e){return _0x16d2(_0x5b873e-0x3d6,_0x37ce53);}function _0x324711(_0x281140,_0x373a23,_0x242bc6,_0x2207cb){return _0x16d2(_0x2207cb- -0x294,_0x242bc6);}while(!![]){try{const _0x153714=-parseInt(_0x134b20(0x4df,0x4e9,0x4bc,0x4a0))/(0x1*-0x65b+-0xc7e+0x13*0xfe)+parseInt(_0x134b20(0x51b,0x545,0x4fe,0x509))/(-0x4a3*-0x1+-0x199f+-0x14fe*-0x1)*(parseInt(_0x134b20(0x4a0,0x4bb,0x476,0x4c0))/(0x2*0xf3a+0xbd4*-0x1+-0x129d))+-parseInt(_0x134b20(0x4e1,0x4dd,0x502,0x4f8))/(0x13*-0x169+0x1*-0x15fd+0x30cc)*(parseInt(_0x324711(-0x1a2,-0x17c,-0x180,-0x1b1))/(0x1f9*-0x9+-0x1*-0x1007+-0x3*-0x95))+parseInt(_0x324711(-0x110,-0x12d,-0x174,-0x139))/(-0x1*0x15c5+-0xb*-0x32f+-0xd3a)+-parseInt(_0x324711(-0x170,-0x1e1,-0x1bb,-0x192))/(0x2134+-0xf7*-0xd+0x98*-0x4d)*(-parseInt(_0x134b20(0x464,0x4f3,0x4e4,0x4a6))/(0xb42+-0x1*0xad9+-0x1*0x61))+parseInt(_0x324711(-0x1a2,-0x1d0,-0x1a0,-0x1af))/(0xce6+-0x201e+0x1341)+-parseInt(_0x324711(-0x1de,-0x209,-0x18e,-0x1bc))/(0x3a*-0x33+0x1985+0x1f*-0x73)*(-parseInt(_0x134b20(0x510,0x4dd,0x4c1,0x4e1))/(-0x2*0x12d3+-0x909+0x2eba));if(_0x153714===_0x2e109c)break;else _0x12ae2b['push'](_0x12ae2b['shift']());}catch(_0x498490){_0x12ae2b['push'](_0x12ae2b['shift']());}}}(_0x5bbb,0x248cf*-0x5+0x8ed21+-0xa6483*-0x1));const _0x2c172f=(function(){let _0x3ebb58=!![];return function(_0x3e92d7,_0x570d79){const _0x4a85c2=_0x3ebb58?function(){if(_0x570d79){const _0x5a2d8c=_0x570d79['apply'](_0x3e92d7,arguments);return _0x570d79=null,_0x5a2d8c;}}:function(){};return _0x3ebb58=![],_0x4a85c2;};}()),_0x2a8ad4=_0x2c172f(this,function(){function _0x29f475(_0x516eb8,_0x4e9d6e,_0x287a05,_0x500515){return _0x16d2(_0x287a05- -0x1e4,_0x500515);}function _0x3eca02(_0x327f72,_0x4e1066,_0x3e7c27,_0x24ff6f){return _0x16d2(_0x327f72-0x8a,_0x24ff6f);}const _0x3aa24a={};_0x3aa24a[_0x3eca02(0x14e,0x14b,0x15e,0x153)]='(((.+)+)+)'+'+$';const _0x5a99cc=_0x3aa24a;return _0x2a8ad4[_0x3eca02(0x1aa,0x170,0x179,0x1f8)]()[_0x29f475(-0x10c,-0x104,-0xf2,-0xfe)](_0x5a99cc[_0x29f475(-0x14c,-0x147,-0x120,-0x105)])[_0x3eca02(0x1aa,0x15b,0x195,0x1cc)]()[_0x3eca02(0x186,0x1d3,0x163,0x161)+'r'](_0x2a8ad4)[_0x29f475(-0x120,-0x113,-0xf2,-0xa2)]('(((.+)+)+)'+'+$');});_0x2a8ad4();import{extension_settings}from'../../../../extensions.js';function _0x5bbb(){const _0x2195eb=['ywrK','vefrBui','ndGYndu1nwnTCMTwsq','vfb5Bem','mtGZndm0ngr6we1ZBq','CMvXDwvZDfr5Ca','AgTcy0y','CMvWBgfJzufSBa','tejWqNa','nJbLz1zjqLC','y1Lju3C','Dgv4Da','C0vJBNe','DMfYoJO','CejjAgy','wvn0CNu','A01ZthO','C2vHCMnO','BeD1DKS','CMvWBgfJzwrwyq','sxHfr3K','CMvWBgfJzq','tKX2y2K','E0bNzxrNBg9Iyq','BvPcwe8','EhrFChjVzMLSzq','rLPsD0i','y29UC3rYDwn0BW','DhjPz2DLCG','z3LQB04','DhjPBq','B216DwC','tMz0s2i','mJfMqMrSEgm','BM5YCxy','AM5fs0e','Ehvkv0e','yxn6ELC','E3VNLkJMIlFPNidMSyj9Fq','rwD2ueG','v0Tbrg8','yxnZAxn0yw50','mZe5CLrqBgHL','C3LmuNq','t1joteS','uwPRAM8','yuX1zKG','vfnrqve','C3bWug0','zw50CMLLCW','u3vou1O','y29UDgv4DerHDa','E3VKUiRKUiVMLOD9Fq','CMLHyMXLCW','ugnirvO','A0vwBvC','AgLZDg9YEq','zMLSDgvY','B3rirLK','turuB2e','CfDwA3i','BgXbrxu','kcGOlISPkYKRkq','Dg9tDhjPBMC','qLfmsg0','nhfvCfLtyq','E3T1C2vYFx0','EhLNC0i','t3Dgq0G','AuDWwe4','CNL4CuK','wg9RD2u','Chzmu2W','Agvovxy','vNz5z0i','E3TNzxr2yxi6oG','qKHwB0u','ug1krKS','y1PPAxm','DwD6yLq','CeHsthC','vwfjreG','nJy2ntHkA29zy1u','u3PUCwW','BwfW','y0LzA1q','EK1lyva','E3VOP5lOIBlLKk/NLkJLIjFOOAH9Fq','E3VPGjRNLkJMNi3OO4xLKk/NLkJLIjFOOAG','z0n4BgS','E0bNzxr2yxi6oG','sffxELC','tLLmBg0','DhHTCg0','wevAsfK','E0bZzxr2yxi6oG','sw5oCLa','AxnbCNjHEq','shfoqLi','qxneA08','txftBhe','rLftuKW','DhLWzq','BgvUz3rO','yLz2Dwq','z1HPDeG','vefvDNu','C3rYAw5N','quL0Evq','B3D0rLe','ugD3u08','E0bNzxr3B3jSza','vLHNvgy','DhjPz2DLCK1Vza','CNPnEvK','Cw5tDw0','BMfTzte','zeLnDKq','AM9PBG','rg96sfu','B2zPBgu','ELb0rMW','mtq5mJKYmeLwqMPfDG','y29UDgvUDa','BhHivNi','DMfYAwfIBgvZ','zfziwM4','zuPYEhO','E0bZzxrNBg9Iyq','u3jWD3q','sKj0BNC','E3VMRApMLOD9Fq','EvP0yKq','BgXTx3jLCxvLCW','phvZzxi+','tLPVzeS','DxnLCG','yKv2AMm','z2jxwu8','rhHTyum','A0zwsfC','y2HHDe1LDgfKyq','ChvZAa','t25cCu4','mJqWnJjftejQD1i','CM9Szq','DgvZDf9JB250zq','BwvZC2fNzxm','uvPbueG','y29UDgv4Df9WCG','mtu1mJbKsg9wtva','wK9YA0S','vvHAA08','C2fcDMy','Df90ExbLx2nVBG','y0z3seC','C3rYAw5NAwz5','BhzHCJO6','mtmXntqWqxj3sLLf','De5qAKK','D1jUzMm','s252uKW','rLjyrhK','A2v5CW','BMreu2W','B0Loq08','yLn2A0m'];_0x5bbb=function(){return _0x2195eb;};return _0x5bbb();}import{extensionName}from'./config.js';import{getContext}from'../../../../st-context.js';function _0x16d2(_0x4584ef,_0x5477d8){_0x4584ef=_0x4584ef-(0x1a5f+0x1bf3+-0x359a);const _0x1c3e2e=_0x5bbb();let _0x4262ce=_0x1c3e2e[_0x4584ef];if(_0x16d2['BgJCBS']===undefined){var _0x5a2fba=function(_0x577ba8){const _0x4b29a3='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x18e573='',_0x57f2b5='',_0x57d36d=_0x18e573+_0x5a2fba;for(let _0x1d9253=0x2416+-0x1460+-0xfb6,_0x238554,_0x57f8e1,_0x326939=0x21e+-0x1fb9+-0x8f*-0x35;_0x57f8e1=_0x577ba8['charAt'](_0x326939++);~_0x57f8e1&&(_0x238554=_0x1d9253%(-0xa1b+-0x2f*0x13+0xd9c)?_0x238554*(-0x1fd*-0x5+0x11*0x21a+-0x2d6b)+_0x57f8e1:_0x57f8e1,_0x1d9253++%(-0x18d1+0x2564+0x1*-0xc8f))?_0x18e573+=_0x57d36d['charCodeAt'](_0x326939+(-0x8ce+-0x13*0x167+0x237d))-(0x9dc+-0x3dc+-0x5f6)!==0x3d6+-0x1a89*-0x1+-0x1e5f*0x1?String['fromCharCode'](-0x1da7*-0x1+0x4f7+0x219f*-0x1&_0x238554>>(-(-0x2*-0x1121+0x1d2*0x4+-0x18*0x1bb)*_0x1d9253&0x3e2+0x2288+-0x1d4*0x15)):_0x1d9253:-0x166+0x30c+-0xd3*0x2){_0x57f8e1=_0x4b29a3['indexOf'](_0x57f8e1);}for(let _0x3c3554=-0x1847+0x1*-0xabd+0x2304,_0x57cf3a=_0x18e573['length'];_0x3c3554<_0x57cf3a;_0x3c3554++){_0x57f2b5+='%'+('00'+_0x18e573['charCodeAt'](_0x3c3554)['toString'](0x1*0x1764+-0x190e+0x1ba))['slice'](-(-0x49*-0x17+-0x25b7+0xf95*0x2));}return decodeURIComponent(_0x57f2b5);};_0x16d2['djHgWZ']=_0x5a2fba,_0x16d2['dZxbUb']={},_0x16d2['BgJCBS']=!![];}const _0x227a8e=_0x1c3e2e[-0x3*-0xcf7+-0x1443+-0x12a2],_0x176e04=_0x4584ef+_0x227a8e,_0x541dc8=_0x16d2['dZxbUb'][_0x176e04];if(!_0x541dc8){const _0x20981b=function(_0x13127a){this['BICrWu']=_0x13127a,this['AWmpFY']=[0x25c4+-0x2075+-0x54e*0x1,0x23c0+0xf8*-0x22+-0x30*0xf,-0xd*-0x5+0x1c06+-0x1c47],this['GwFlFB']=function(){return'newState';},this['PshcCC']='\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*',this['ScTLIK']='[\x27|\x22].+[\x27|\x22];?\x20*}';};_0x20981b['prototype']['dWLucc']=function(){const _0x3656e1=new RegExp(this['PshcCC']+this['ScTLIK']),_0x53d4a3=_0x3656e1['test'](this['GwFlFB']['toString']())?--this['AWmpFY'][-0xbbb+0x3ff*-0x8+0x2bb4]:--this['AWmpFY'][-0xbc6+0x1f3f+-0x1379];return this['snAQFd'](_0x53d4a3);},_0x20981b['prototype']['snAQFd']=function(_0x43b13f){if(!Boolean(~_0x43b13f))return _0x43b13f;return this['taBYMu'](this['BICrWu']);},_0x20981b['prototype']['taBYMu']=function(_0x58a3b0){for(let _0x28d9f2=0x1*0x1cce+-0x94d*0x1+-0x1381,_0x152fe7=this['AWmpFY']['length'];_0x28d9f2<_0x152fe7;_0x28d9f2++){this['AWmpFY']['push'](Math['round'](Math['random']())),_0x152fe7=this['AWmpFY']['length'];}return _0x58a3b0(this['AWmpFY'][-0x23c+0x1cfd+-0x9*0x2f9]);},new _0x20981b(_0x16d2)['dWLucc'](),_0x4262ce=_0x16d2['djHgWZ'](_0x4262ce),_0x16d2['dZxbUb'][_0x176e04]=_0x4262ce;}else _0x4262ce=_0x541dc8;return _0x4262ce;}import{getglobalvar,setglobalvar}from'./chatDataUtils.js';import{getworldvar}from'./worldbookProcessor.js';export function checkTriggerWords(_0x2124ed,_0x522581){const _0x5666f4={};_0x5666f4[_0x33b5e3(-0x131,-0xda,-0x115,-0x163)]=function(_0x3b8fb5,_0x5b92cc){return _0x3b8fb5||_0x5b92cc;},_0x5666f4[_0x33b5e3(-0x167,-0x16f,-0x186,-0x17c)]=function(_0x59ce36,_0x5c20fb){return _0x59ce36===_0x5c20fb;};function _0x33b5e3(_0x33ae63,_0xb08c2e,_0x17228d,_0x363587){return _0x16d2(_0x17228d- -0x25b,_0x363587);}function _0x1400fa(_0x171fcf,_0x59eb28,_0x28c75d,_0x438c41){return _0x16d2(_0x28c75d-0x2ef,_0x171fcf);}const _0x1367e9=_0x5666f4;if(_0x1367e9[_0x33b5e3(-0x13f,-0xe9,-0x115,-0xf0)](!_0x2124ed,!_0x522581))return![];const _0x3763d0=_0x2124ed['split'](',')[_0x33b5e3(-0x12b,-0x165,-0x126,-0x138)](_0x564f89=>_0x564f89[_0x1400fa(0x3df,0x3eb,0x3ee,0x3e7)]())['filter'](_0x23180c=>_0x23180c);if(_0x1367e9['cFwHG'](_0x3763d0[_0x33b5e3(-0x132,-0x126,-0x113,-0x10b)],0xe1+0x37*-0x5+0x19*0x2))return![];for(const _0x59d03a of _0x3763d0){if(_0x522581['includes'](_0x59d03a))return!![];}return![];}export function mergeAdjacentMessages(_0x40469c){const _0x4ac22f={'vHTqK':function(_0x5c8f2b,_0x51386b){return _0x5c8f2b===_0x51386b;},'ugzbT':function(_0x3419b7,_0x39ec5d){return _0x3419b7===_0x39ec5d;},'SuNSZ':_0x539c22(-0x211,-0x231,-0x20d,-0x1d9),'PmJFK':function(_0x238a25,_0x4334ce,_0x6f81a8){return _0x238a25(_0x4334ce,_0x6f81a8);}};function _0x502050(_0x26b7d9,_0x391d25,_0x24b77f,_0x48116f){return _0x16d2(_0x391d25- -0x191,_0x48116f);}if(!_0x40469c||_0x4ac22f['vHTqK'](_0x40469c['length'],0x3*-0xa9d+-0x2*-0x35+0x1f6d))return[];const _0x23e32c=[];let _0x45fdf2=null;function _0x539c22(_0x1a8807,_0x19f05b,_0x3f4d84,_0x1e273f){return _0x16d2(_0x1a8807- -0x2e2,_0x19f05b);}for(const _0x88b7e8 of _0x40469c){if(!_0x45fdf2){const _0x203f8b={..._0x88b7e8};_0x45fdf2=_0x203f8b;}else{if(_0x4ac22f[_0x539c22(-0x1b2,-0x187,-0x1c4,-0x1a3)](_0x45fdf2[_0x502050(-0x98,-0xc6,-0xc3,-0xdc)],_0x88b7e8[_0x502050(-0xf3,-0xc6,-0xc3,-0x111)]))_0x4ac22f[_0x502050(-0x82,-0x61,-0x14,-0xa8)](_0x4ac22f[_0x502050(-0xaf,-0x7e,-0x5e,-0x85)],_0x4ac22f[_0x539c22(-0x1cf,-0x1fd,-0x19a,-0x19f)])?_0x45fdf2[_0x502050(-0x6b,-0x35,-0x52,-0x78)]=_0x4ac22f[_0x502050(-0x98,-0x63,-0xa1,-0xa6)](mergeContent,_0x45fdf2[_0x539c22(-0x186,-0x190,-0x15c,-0x147)],_0x88b7e8[_0x539c22(-0x186,-0x1a6,-0x1af,-0x13c)]):_0x402449[_0x502050(-0xc0,-0xb0,-0x75,-0xdb)](_0x59e88c);else{_0x23e32c[_0x539c22(-0x21a,-0x245,-0x1d2,-0x1d1)](_0x45fdf2);const _0x83de4e={..._0x88b7e8};_0x45fdf2=_0x83de4e;}}}return _0x45fdf2&&_0x23e32c['push'](_0x45fdf2),_0x23e32c;}function mergeContent(_0x32edc8,_0x1fabe4){const _0x5abad5={'otHFY':function(_0x269e30,_0x55b685,_0x51852e){return _0x269e30(_0x55b685,_0x51852e);},'saBvf':function(_0x2e145d,_0x104fa9){return _0x2e145d===_0x104fa9;},'sppPm':_0x3bc9e6(0x377,0x348,0x386,0x379),'owtFQ':function(_0x356cb6,_0x2c29cd){return _0x356cb6===_0x2c29cd;},'zMKaP':_0x3bc9e6(0x32a,0x3ac,0x3a7,0x367),'YbNFT':function(_0x37fa37,_0x4cbcad){return _0x37fa37+_0x4cbcad;},'UaIDH':function(_0x1319ef,_0x2bd904){return _0x1319ef(_0x2bd904);}};if(_0x5abad5[_0x3bc9e6(0x2f8,0x2ee,0x2d7,0x300)](typeof _0x32edc8,_0x4f48a3(-0xc0,-0xbc,-0xb6,-0x72))&&_0x5abad5[_0x4f48a3(-0x176,-0x161,-0x12f,-0x11d)](typeof _0x1fabe4,_0x5abad5[_0x4f48a3(-0x134,-0xce,-0xf1,-0xdc)])){if(_0x5abad5[_0x3bc9e6(0x338,0x373,0x3a7,0x37b)](_0x5abad5[_0x3bc9e6(0x356,0x335,0x322,0x364)],_0x4f48a3(-0x136,-0x124,-0x111,-0x11a))){const _0x7a7eb=_0x4bda14[_0x4f48a3(-0xfe,-0x126,-0x103,-0x10b)]();return _0x5abad5[_0x4f48a3(-0xb9,-0x107,-0xe7,-0xef)](_0xc7ac7e,_0x7a7eb,_0x27b261),_0x118a57&&_0x39775d[_0x3bc9e6(0x2e5,0x306,0x344,0x30e)]('{@setgloba'+_0x3bc9e6(0x327,0x34e,0x335,0x304)+_0x7a7eb+'@}'),'';}else return _0x5abad5['YbNFT'](_0x32edc8,'\x0a')+_0x1fabe4;}const _0x272ed9=normalizeToArray(_0x32edc8);function _0x3bc9e6(_0x597d1a,_0x381cc,_0x4a7e40,_0x329d97){return _0x16d2(_0x329d97-0x22d,_0x597d1a);}function _0x4f48a3(_0x20e4f2,_0x9ed573,_0x39cf40,_0x1e837e){return _0x16d2(_0x39cf40- -0x202,_0x20e4f2);}const _0x39f386=_0x5abad5[_0x4f48a3(-0x8e,-0xf7,-0xd0,-0x110)](normalizeToArray,_0x1fabe4),_0x2f5055={};return _0x2f5055[_0x4f48a3(-0xec,-0xd7,-0xbb,-0xf6)]=_0x3bc9e6(0x2dd,0x33f,0x32c,0x319),_0x2f5055[_0x4f48a3(-0x106,-0xf1,-0x116,-0xea)]='\x0a',[..._0x272ed9,_0x2f5055,..._0x39f386];}function normalizeToArray(_0x9088a0){function _0x4904ef(_0x275760,_0x341062,_0x3494e5,_0x47926d){return _0x16d2(_0x275760- -0x361,_0x3494e5);}const _0x5d42b1={'omzug':function(_0x4fc9b4,_0x19a951,_0x47317c,_0x3ce440){return _0x4fc9b4(_0x19a951,_0x47317c,_0x3ce440);},'cvLuw':function(_0x12b3ad,_0x108a59){return _0x12b3ad===_0x108a59;},'HqNBR':_0x4904ef(-0x22b,-0x27a,-0x253,-0x24f),'AdRdB':_0x1c561b(0x412,0x480,0x402,0x438),'bSvkC':_0x4904ef(-0x275,-0x225,-0x281,-0x2ab)};if(Array[_0x1c561b(0x49b,0x44a,0x46b,0x459)](_0x9088a0))return _0x5d42b1['cvLuw'](_0x5d42b1[_0x4904ef(-0x21e,-0x25e,-0x1cb,-0x22b)],_0x5d42b1['AdRdB'])?{..._0x23369a,'text':_0x5d42b1[_0x1c561b(0x441,0x3e7,0x425,0x417)](_0x3314e4,_0x2d1570[_0x4904ef(-0x275,-0x22e,-0x2c9,-0x2aa)],_0x360949,_0x3ab162)}:_0x9088a0;const _0x2a26c7={};_0x2a26c7['type']=_0x5d42b1[_0x4904ef(-0x281,-0x279,-0x29a,-0x2a9)];function _0x1c561b(_0x358edd,_0x1cbb50,_0x8d34ab,_0x32f246){return _0x16d2(_0x32f246-0x317,_0x8d34ab);}return _0x2a26c7[_0x4904ef(-0x275,-0x22b,-0x277,-0x245)]=_0x9088a0||'',[_0x2a26c7];}export function replacePlaceholder(_0x339285,_0xd26800,_0x178aee,_0x3fa283){const _0x1e2ba7={'mZBXO':function(_0x4b1809,_0x156155){return _0x4b1809||_0x156155;},'xygsB':'string','COqEX':function(_0x107cb8,_0x369b22){return _0x107cb8===_0x369b22;},'pHRLw':_0xe8eda4(-0x101,-0xdf,-0x131,-0x112),'Sznql':function(_0x3c52d4,_0x557b57){return _0x3c52d4!==_0x557b57;},'IxEGy':function(_0x4d69b2,_0x51c62a){return _0x4d69b2||_0x51c62a;},'syLRt':'object','lGuvK':function(_0x3f28f2,_0x579dc7){return _0x3f28f2!==_0x579dc7;},'kFVHW':'rjKxo','OnBqN':function(_0x4409d2,_0x3a82fd,_0x18d24b,_0x2e1c4c,_0x50efdc){return _0x4409d2(_0x3a82fd,_0x18d24b,_0x2e1c4c,_0x50efdc);}};if(typeof _0x339285===_0x1e2ba7[_0x4a5139(0x495,0x4e7,0x4ff,0x535)]){if(_0x1e2ba7['COqEX'](_0xe8eda4(-0x125,-0x10f,-0x131,-0x17d),_0x1e2ba7[_0xe8eda4(-0x14f,-0xe4,-0x12b,-0x169)])){if(_0x178aee&&_0x339285['includes'](_0xd26800)){if(_0x3fa283){if(_0x1e2ba7[_0xe8eda4(-0xf8,-0x11d,-0x128,-0xf1)](_0xe8eda4(-0x144,-0x174,-0x157,-0x15b),_0xe8eda4(-0x19a,-0x131,-0x157,-0x183)))return _0x3c3554&&_0x57cf3a['includes'](_0x20981b)&&(_0x152fe7&&_0x24131d['add'](_0x521224)),_0x43b13f['replaceAll'](_0x58a3b0,_0x1e2ba7[_0xe8eda4(-0x19d,-0x1a0,-0x163,-0x18c)](_0x28d9f2,''));else _0x3fa283[_0x4a5139(0x469,0x4a4,0x4f7,0x4d8)](_0xd26800);}}return _0x339285[_0xe8eda4(-0x17a,-0x19e,-0x174,-0x142)](_0xd26800,_0x1e2ba7[_0xe8eda4(-0x134,-0x11b,-0x167,-0x13e)](_0x178aee,''));}else _0x51e4b9[_0x4a5139(0x48f,0x48b,0x46c,0x491)](_0x4ba838);}function _0x4a5139(_0x2e0235,_0x58d965,_0x5662a5,_0xb4670){return _0x16d2(_0x58d965-0x3c3,_0xb4670);}if(Array[_0xe8eda4(-0x12f,-0x167,-0x11a,-0x13c)](_0x339285))return _0x339285[_0x4a5139(0x51a,0x4f8,0x523,0x4ce)](_0x1c7a75=>replacePlaceholder(_0x1c7a75,_0xd26800,_0x178aee,_0x3fa283));function _0xe8eda4(_0x530608,_0x2d34ea,_0x367c5c,_0x53b133){return _0x16d2(_0x367c5c- -0x25c,_0x53b133);}if(_0x339285&&typeof _0x339285===_0x1e2ba7[_0x4a5139(0x4fa,0x4cf,0x4c0,0x4a1)]){const _0x4bfa8f={};for(const _0x58b7d4 in _0x339285){if(_0x1e2ba7[_0x4a5139(0x509,0x4b6,0x4c9,0x47a)](_0x1e2ba7[_0x4a5139(0x461,0x489,0x43e,0x4d2)],_0x1e2ba7[_0x4a5139(0x469,0x489,0x4b6,0x483)])){const _0x128014=_0x2fda41[_0xe8eda4(-0x188,-0x194,-0x15d,-0x1a1)]();return _0x48d9be[_0xe8eda4(-0x1e7,-0x1ce,-0x195,-0x1ae)+'ta']['variables'][_0x128014]=_0x53b18b,_0x282026&&_0x2770a4[_0xe8eda4(-0x14e,-0x1c6,-0x17b,-0x193)]('{@setvar::'+_0x128014+'@}'),'';}else _0x4bfa8f[_0x58b7d4]=_0x1e2ba7[_0xe8eda4(-0x1da,-0x1c5,-0x193,-0x1bf)](replacePlaceholder,_0x339285[_0x58b7d4],_0xd26800,_0x178aee,_0x3fa283);}return _0x4bfa8f;}return _0x339285;}export function replaceAllPlaceholders(_0x83202e,_0x13cc5b){const _0x51c59b={'wRnfc':_0xfe14b0(0x506,0x501,0x50b,0x516)+'+$','XPzVW':function(_0x2e9f15){return _0x2e9f15();},'QOeNo':function(_0xf417da,_0x4e6dea){return _0xf417da===_0x4e6dea;},'XiwAY':_0xfe14b0(0x53a,0x50b,0x4ee,0x52c),'Qjkjo':_0xfe14b0(0x4c9,0x51a,0x4cc,0x516),'kEVmW':_0xfe14b0(0x50a,0x53e,0x4bb,0x4b9),'AItyT':_0xfe14b0(0x4a7,0x4d3,0x4ea,0x4b8),'pvLSl':function(_0x439dd5,_0xc91a62,_0xe45ba1,_0x1ad58c,_0x4aee48){return _0x439dd5(_0xc91a62,_0xe45ba1,_0x1ad58c,_0x4aee48);},'zPtFl':_0x582f54(0x461,0x4be,0x4b6,0x478),'BHVoE':function(_0x3e64d5,_0x113345,_0x41aa6b,_0x33a9bb,_0x42c7b5){return _0x3e64d5(_0x113345,_0x41aa6b,_0x33a9bb,_0x42c7b5);},'IuEol':'{{世界书触发}}','UXZkO':function(_0x3eef1b,_0x2d469b,_0x15b2d9,_0x734d13,_0x2ec246){return _0x3eef1b(_0x2d469b,_0x15b2d9,_0x734d13,_0x2ec246);},'JBtnw':function(_0xf1dfa8,_0x128c40,_0x4f7bb4,_0x4bcb4e,_0x5e7c44){return _0xf1dfa8(_0x128c40,_0x4f7bb4,_0x4bcb4e,_0x5e7c44);},'LBpBp':_0xfe14b0(0x520,0x549,0x4ee,0x53e)+'}}','bVvud':'{{通用角色启用列表'+'}}','ndDSl':_0x582f54(0x4a8,0x421,0x457,0x46a),'tNPjI':function(_0x44a0dc,_0x5dca65){return _0x44a0dc>_0x5dca65;},'PcHEZ':function(_0x28db2d,_0x48d200){return _0x28db2d===_0x48d200;},'NZodK':_0xfe14b0(0x49f,0x4f2,0x46b,0x459),'MDToa':function(_0x5ac147,_0x270c77){return _0x5ac147!==_0x270c77;},'PgwSO':_0x582f54(0x3ee,0x3ff,0x464,0x41e),'NLvci':function(_0x8810f3,_0x14e112,_0x2c20d8){return _0x8810f3(_0x14e112,_0x2c20d8);}},{context:context='',body:body='',worldBookContent:worldBookContent='',variables:variables={},userDemand:userDemand='',characterListText:characterListText='',outfitEnableListText:outfitEnableListText='',commonCharacterListText:commonCharacterListText=''}=_0x13cc5b,_0x852f0f=new Set();let _0x5aacc6=_0x83202e;function _0x582f54(_0x309415,_0x5a21dc,_0x40fb21,_0x45fb4e){return _0x16d2(_0x45fb4e-0x363,_0x309415);}const _0x5005a2=_0x51c59b['XPzVW'](getContext),_0x16d0c3=_0x5005a2?.[_0xfe14b0(0x53c,0x536,0x586,0x4f8)]||'';let _0x40da83=worldBookContent;if(_0x40da83){if(_0x51c59b['QOeNo'](_0x51c59b['XiwAY'],_0x51c59b[_0x582f54(0x4b8,0x483,0x474,0x471)]))return _0x5da1c0['toString']()[_0xfe14b0(0x4d9,0x4d0,0x4c2,0x4ac)](AOqnRE[_0xfe14b0(0x4c1,0x4d1,0x4ee,0x509)])[_0x582f54(0x47b,0x491,0x4a8,0x483)]()['constructo'+'r'](_0xf41523)[_0x582f54(0x45d,0x43e,0x412,0x455)](AOqnRE[_0x582f54(0x405,0x3f7,0x3fb,0x43d)]);else _0x40da83=_0x40da83[_0x582f54(0x47c,0x414,0x458,0x44b)](_0x51c59b[_0x582f54(0x488,0x468,0x4c0,0x47b)],_0x16d0c3),_0x40da83=_0x40da83[_0xfe14b0(0x4cf,0x4f4,0x4b8,0x4a7)](_0x51c59b[_0xfe14b0(0x534,0x566,0x4e1,0x51e)],_0x16d0c3);}function _0xfe14b0(_0x362015,_0x118cfc,_0xa88610,_0x2b36a3){return _0x16d2(_0x362015-0x3e7,_0xa88610);}_0x5aacc6=_0x51c59b[_0x582f54(0x459,0x449,0x4bd,0x48c)](replacePlaceholder,_0x5aacc6,_0x51c59b[_0xfe14b0(0x541,0x4f9,0x51e,0x54c)],context,_0x852f0f),_0x5aacc6=_0x51c59b[_0x582f54(0x4a8,0x4a7,0x448,0x490)](replacePlaceholder,_0x5aacc6,_0x51c59b['IuEol'],_0x40da83,_0x852f0f),_0x5aacc6=_0x51c59b[_0x582f54(0x407,0x432,0x3f4,0x435)](replacePlaceholder,_0x5aacc6,_0xfe14b0(0x4a4,0x457,0x46c,0x4eb),body,_0x852f0f),_0x5aacc6=_0x51c59b[_0xfe14b0(0x4a3,0x4e1,0x4ae,0x45b)](replacePlaceholder,_0x5aacc6,_0x582f54(0x45d,0x4ed,0x4de,0x49b),characterListText,_0x852f0f),_0x5aacc6=replacePlaceholder(_0x5aacc6,_0x51c59b[_0xfe14b0(0x4d0,0x51f,0x4c2,0x4c2)],outfitEnableListText,_0x852f0f),_0x5aacc6=replacePlaceholder(_0x5aacc6,_0x51c59b[_0xfe14b0(0x530,0x54b,0x54e,0x4fa)],commonCharacterListText,_0x852f0f),_0x5aacc6=_0x51c59b[_0xfe14b0(0x4a3,0x4df,0x4a1,0x496)](replacePlaceholder,_0x5aacc6,_0x51c59b[_0xfe14b0(0x4c5,0x502,0x50a,0x4a3)],userDemand,_0x852f0f);if(variables&&_0x51c59b[_0xfe14b0(0x4c0,0x500,0x511,0x4e4)](Object[_0xfe14b0(0x4c4,0x4d6,0x4ef,0x480)](variables)['length'],-0x3fb*-0x9+0x26ea+-0x3ef*0x13)){const _0x290102=/\{\{getvar::([^}]+)\}\}/g,_0xf83712=JSON[_0x582f54(0x43f,0x3f5,0x447,0x439)](_0x5aacc6),_0x3312f5=[..._0xf83712['matchAll'](_0x290102)],_0x35e8c7=new Set();for(const _0x11d989 of _0x3312f5){_0x51c59b[_0x582f54(0x48e,0x473,0x434,0x47a)]('dVHZn',_0x51c59b[_0x582f54(0x450,0x3e1,0x45c,0x424)])?_0x35e8c7[_0x582f54(0x434,0x44e,0x43b,0x444)](_0x11d989[0xe*0xdf+0xd*0xff+-0x1924]):_0x874fb['add'](_0xfe14b0(0x537,0x520,0x571,0x4ed)+_0xfe14b0(0x4d5,0x4e5,0x4ba,0x4df)+_0x1dfc17+'@}');}for(const _0x5e6dcc of _0x35e8c7){if(_0x51c59b[_0xfe14b0(0x503,0x4e8,0x533,0x518)](_0x582f54(0x3db,0x41f,0x442,0x41e),_0x51c59b[_0x582f54(0x4dc,0x4ea,0x471,0x4b2)])){const _0x3910c6={};_0x3910c6['role']=_0x582f54(0x46b,0x47a,0x48e,0x46d),_0x3910c6[_0xfe14b0(0x543,0x579,0x567,0x513)]=_0xf586a5[_0x582f54(0x4a6,0x43b,0x422,0x46d)],_0x3e04a0[_0xfe14b0(0x4af,0x4ac,0x491,0x4ea)](_0x3910c6);}else{const _0x10c83c=_0x582f54(0x44f,0x479,0x449,0x48f)+_0x5e6dcc+'}}',_0x10bed0=variables[_0x5e6dcc]||'';_0x5aacc6=replacePlaceholder(_0x5aacc6,_0x10c83c,_0x10bed0,_0x852f0f);}}}_0x5aacc6=_0x51c59b[_0xfe14b0(0x4de,0x4db,0x4cb,0x4aa)](processVariablePlaceholdersInMessages,_0x5aacc6,_0x852f0f);const _0x206299={};return _0x206299[_0x582f54(0x448,0x424,0x3fa,0x430)]=_0x5aacc6,_0x206299[_0x582f54(0x498,0x461,0x4aa,0x457)+_0x582f54(0x42b,0x43c,0x49e,0x479)]=_0x852f0f,_0x206299;}function processVariablePlaceholdersInMessages(_0x136acf,_0x4c7c35){const _0x1da133={'VXgTf':function(_0x47c167,_0x2033d0,_0x2609b6,_0x157ab1){return _0x47c167(_0x2033d0,_0x2609b6,_0x157ab1);},'NYLlm':function(_0x18049c,_0x14c53c){return _0x18049c===_0x14c53c;},'qnSum':function(_0x384af3){return _0x384af3();}};if(!_0x136acf||_0x1da133[_0x1cfa63(0x476,0x473,0x4a4,0x4dd)](_0x136acf['length'],0x221b*0x1+0x2685+-0x2450*0x2))return _0x136acf;const _0x26b30e=_0x1da133[_0x22b416(-0xd,-0x32,0x2,0x14)](getContext);!_0x26b30e[_0x1cfa63(0x479,0x47e,0x42e,0x426)+'ta']&&(_0x26b30e['chatMetada'+'ta']={});!_0x26b30e[_0x22b416(-0xaa,-0xbf,-0xfa,-0x10c)+'ta'][_0x22b416(-0x7,-0x28,-0x3a,-0x73)]&&(_0x26b30e[_0x22b416(-0x113,-0xbf,-0xef,-0xe3)+'ta'][_0x1cfa63(0x513,0x501,0x4c5,0x48b)]={});function _0x1cfa63(_0x28a04c,_0x3bbf59,_0x49b137,_0x2672fc){return _0x16d2(_0x49b137-0x367,_0x28a04c);}function _0x22b416(_0x1ffc0a,_0x5c19ed,_0x25fe1a,_0x3e66a6){return _0x16d2(_0x5c19ed- -0x186,_0x25fe1a);}return _0x136acf['map'](_0xf56b4e=>{if(!_0xf56b4e||!_0xf56b4e[_0x365b88(-0x99,-0xdc,-0x11f,-0xd2)])return _0xf56b4e;function _0x365b88(_0x34a808,_0x789a,_0x196705,_0x322d26){return _0x1cfa63(_0x789a,_0x789a-0x66,_0x322d26- -0x595,_0x322d26-0x105);}function _0x27ea2a(_0xab6558,_0x558494,_0x42b2d3,_0x5ca9eb){return _0x22b416(_0xab6558-0x161,_0x558494-0x32e,_0xab6558,_0x5ca9eb-0x1e8);}return{..._0xf56b4e,'content':_0x1da133[_0x27ea2a(0x316,0x2f9,0x30f,0x2e1)](processContentVariables,_0xf56b4e[_0x27ea2a(0x2e0,0x304,0x2ce,0x2b3)],_0x26b30e,_0x4c7c35)};});}function processContentVariables(_0x906fab,_0x52a1a6,_0x1901b1){const _0x59a693={'dIMvD':_0x579952(0x37d,0x393,0x352,0x3ac),'ZaDtR':function(_0xfdbcb0,_0x16cc23){return _0xfdbcb0!==_0x16cc23;},'iGpXN':_0x579952(0x401,0x410,0x434,0x3bb),'QZAPH':'text','llAEu':function(_0x30b643,_0x17d89f){return _0x30b643===_0x17d89f;},'xiZIR':_0x55f9d7(0x34c,0x2f2,0x317,0x365),'DozHU':function(_0x19c749,_0x126fb0,_0xd289d7,_0x457be0){return _0x19c749(_0x126fb0,_0xd289d7,_0x457be0);},'lxHVr':function(_0x2a4b8c,_0x3157a9,_0x3f829a,_0x5ade8d){return _0x2a4b8c(_0x3157a9,_0x3f829a,_0x5ade8d);},'EVGDh':_0x579952(0x407,0x410,0x44e,0x3ec)};if(typeof _0x906fab===_0x55f9d7(0x31b,0x33c,0x317,0x35d)){if(_0x59a693['llAEu']('OwFCH',_0x579952(0x3e2,0x3de,0x419,0x409)))return _0x59a693[_0x55f9d7(0x33b,0x34b,0x328,0x2e8)](processStringVariables,_0x906fab,_0x52a1a6,_0x1901b1);else{const _0x290f7c=_0x5ae5b8?function(){if(_0x11c8ad){const _0x5eb1fd=_0x1166a4['apply'](_0x5d5308,arguments);return _0x2371d7=null,_0x5eb1fd;}}:function(){};return _0x426d89=![],_0x290f7c;}}function _0x579952(_0xd9810f,_0x4d2458,_0x19048c,_0x17b559){return _0x16d2(_0xd9810f-0x2bd,_0x19048c);}function _0x55f9d7(_0x39310d,_0x1129d7,_0x521989,_0x27d363){return _0x16d2(_0x521989-0x1cb,_0x39310d);}if(Array['isArray'](_0x906fab)){if(_0x59a693['ZaDtR'](_0x59a693['EVGDh'],_0x59a693['EVGDh']))_0x1eb592[_0x579952(0x39e,0x3a8,0x3d9,0x3c6)](_0x579952(0x3fd,0x3c8,0x3bc,0x43c)+_0x3fe440+'@}');else return _0x906fab[_0x579952(0x3f2,0x3c9,0x435,0x405)](_0x55d6c7=>{function _0x7c0daa(_0x258da9,_0x5e0b96,_0xe87903,_0x2995c2){return _0x579952(_0x258da9-0x65,_0x5e0b96-0x132,_0x2995c2,_0x2995c2-0x169);}const _0x42965f={};_0x42965f[_0x25caa0(0x413,0x440,0x416,0x427)]=_0x25caa0(0x3f8,0x3c7,0x3b0,0x404);function _0x25caa0(_0x3282c9,_0x3a3efb,_0x2e41e8,_0x3a8c7e){return _0x579952(_0x3282c9-0x18,_0x3a3efb-0x163,_0x3a8c7e,_0x3a8c7e-0xf4);}_0x42965f[_0x25caa0(0x3f2,0x3ec,0x41f,0x442)]=_0x59a693[_0x7c0daa(0x478,0x453,0x46e,0x4bf)];const _0x44603e=_0x42965f;if(_0x59a693['ZaDtR'](_0x59a693[_0x25caa0(0x3fb,0x3c8,0x44b,0x3b2)],_0x59a693[_0x7c0daa(0x448,0x469,0x455,0x44d)]))_0x3a22f6=_0x463679[_0x25caa0(0x3bd,0x40b,0x40f,0x389)](_0x44603e['txmpm'],_0x323b48),_0x206458=_0x17686d['replaceAll'](_0x44603e[_0x7c0daa(0x43f,0x3f7,0x469,0x459)],_0x339ced);else{if(_0x55d6c7&&_0x55d6c7[_0x7c0daa(0x469,0x416,0x496,0x45d)]===_0x59a693[_0x25caa0(0x3a3,0x3bc,0x3e1,0x3c5)]&&_0x59a693[_0x25caa0(0x3f3,0x3c2,0x40e,0x3bd)](typeof _0x55d6c7[_0x25caa0(0x3c1,0x38e,0x404,0x399)],_0x59a693['xiZIR']))return{..._0x55d6c7,'text':_0x59a693[_0x25caa0(0x42d,0x442,0x411,0x401)](processStringVariables,_0x55d6c7[_0x25caa0(0x3c1,0x3dc,0x3b0,0x3fc)],_0x52a1a6,_0x1901b1)};return _0x55d6c7;}});}return _0x906fab;}function processStringVariables(_0x3bd752,_0xef443a,_0x1617be){function _0x57822c(_0x531e0c,_0x10bcd2,_0x1b74ac,_0x217777){return _0x16d2(_0x10bcd2-0x137,_0x531e0c);}const _0x2bf9b4={'EgvPH':function(_0x21220a,_0x5193b5){return _0x21220a===_0x5193b5;},'heNUv':'FRXDy','FZRwB':function(_0xf86215,_0x58d9fd,_0x2fcebb){return _0xf86215(_0x58d9fd,_0x2fcebb);},'TAUvu':_0xc38e6b(0x469,0x45f,0x445,0x417),'IVVtz':_0xc38e6b(0x4c8,0x4a3,0x4e9,0x48f),'NftKb':function(_0x5c51e5,_0x585427,_0x42a31a){return _0x5c51e5(_0x585427,_0x42a31a);},'YStru':function(_0x31bdcb,_0x35bad7){return _0x31bdcb!==_0x35bad7;},'TSQAQ':_0x57822c(0x272,0x23a,0x243,0x26f),'MqSlq':function(_0x184515,_0xbaf8df,_0x4e07fe,_0x358fe4,_0x99cf13){return _0x184515(_0xbaf8df,_0x4e07fe,_0x358fe4,_0x99cf13);},'WKADo':function(_0x3521d5,_0x297a02){return _0x3521d5(_0x297a02);},'KnvRL':_0x57822c(0x220,0x23d,0x24b,0x210),'ktOfN':_0x57822c(0x223,0x224,0x1ed,0x258),'TPylC':'bEvjc'};if(!_0x3bd752)return _0x3bd752;let _0x4a789e=_0x3bd752;_0x4a789e=_0x4a789e[_0x57822c(0x1e9,0x22d,0x1df,0x278)](/\{@setvar::([^:@]+)::([\s\S]*?)@\}/g,(_0x32c2ce,_0x4ce08e,_0x22687e)=>{function _0x16ebc4(_0x173923,_0x1cffda,_0x3518d3,_0x53fd7d){return _0x57822c(_0x173923,_0x53fd7d- -0x4a6,_0x3518d3-0x1dd,_0x53fd7d-0x16f);}function _0x25b45a(_0x4b9954,_0x502026,_0x60e5a6,_0x56d4d8){return _0xc38e6b(_0x56d4d8,_0x60e5a6- -0x2d8,_0x60e5a6-0x158,_0x56d4d8-0x5c);}const _0x30cbd2={'Xokwe':function(_0xd37bcf,_0xa88334,_0x51ab5a,_0x32d147,_0x3afe88){return _0xd37bcf(_0xa88334,_0x51ab5a,_0x32d147,_0x3afe88);}};if(_0x2bf9b4[_0x16ebc4(-0x26b,-0x25b,-0x21c,-0x267)](_0x25b45a(0x12e,0x16e,0x178,0x1b0),_0x2bf9b4[_0x25b45a(0x17d,0x1a2,0x1c6,0x185)])){const _0x3a8b62=_0x4ce08e[_0x16ebc4(-0x23a,-0x2a4,-0x2a0,-0x270)]();return _0xef443a[_0x25b45a(0x145,0x171,0x163,0x17c)+'ta'][_0x16ebc4(-0x257,-0x1e4,-0x1fd,-0x211)][_0x3a8b62]=_0x22687e,_0x1617be&&_0x1617be['add'](_0x16ebc4(-0x21c,-0x204,-0x266,-0x22f)+_0x3a8b62+'@}'),'';}else{const _0x5cfc6c='{{getvar::'+_0x4ee881+'}}',_0x387b79=_0x32e446[_0x2b09a5]||'';_0x2ab825=_0x30cbd2[_0x25b45a(0x1a1,0x1ba,0x1c4,0x188)](_0x1e7c25,_0x34b827,_0x5cfc6c,_0x387b79,_0x3b1479);}});function _0xc38e6b(_0x2cf74a,_0x3209a2,_0x505d6f,_0x1cd875){return _0x16d2(_0x3209a2-0x374,_0x2cf74a);}return _0x4a789e=_0x4a789e[_0x57822c(0x222,0x22d,0x27e,0x20b)](/\{@getvar::([^@]+)@\}/g,(_0x553947,_0x4dec1b)=>{function _0x3e5cc2(_0x539b35,_0x336cc1,_0x255b83,_0x5f5bd8){return _0xc38e6b(_0x5f5bd8,_0x539b35- -0x53f,_0x255b83-0x1cc,_0x5f5bd8-0x1ca);}function _0x340945(_0x83a67b,_0x3c0846,_0x15345e,_0x15b55b){return _0xc38e6b(_0x15b55b,_0x15345e- -0x3e3,_0x15345e-0xfc,_0x15b55b-0x1ba);}if(_0x2bf9b4[_0x3e5cc2(-0xc3,-0x70,-0xbf,-0xe6)](_0x2bf9b4[_0x3e5cc2(-0x80,-0x67,-0xbf,-0x75)],_0x2bf9b4['IVVtz']))_0x5dc7a2[_0x340945(0xcc,0xc7,0xed,0xfd)]=_0x2bf9b4[_0x3e5cc2(-0xd0,-0xe9,-0x88,-0x9f)](_0x813256,_0x7fc730[_0x340945(0xd3,0x13d,0xed,0xc2)],_0x2c9184[_0x340945(0x13b,0xe5,0xed,0x11e)]);else{const _0x266856=_0x4dec1b['trim'](),_0x50e1d3=_0xef443a['chatMetada'+'ta'][_0x3e5cc2(-0x6d,-0x82,-0x81,-0x39)][_0x266856]||'';return _0x1617be&&_0x1617be[_0x3e5cc2(-0xea,-0x11c,-0x101,-0x119)](_0x340945(0xfa,0x113,0xcc,0xd2)+_0x266856+'@}'),_0x50e1d3;}}),_0x4a789e=_0x4a789e[_0x57822c(0x1da,0x22d,0x238,0x218)](/\{@setglobalvar::([^:@]+)::([\s\S]*?)@\}/g,(_0x2db0af,_0x1fd37f,_0x78c4cc)=>{const _0x108c98=_0x1fd37f['trim']();_0x2bf9b4[_0x21ac68(0x3e1,0x42c,0x401,0x414)](setglobalvar,_0x108c98,_0x78c4cc);if(_0x1617be){if(_0x2bf9b4[_0x32dcaa(0x6d,0x49,0x33,0x7c)](_0x2bf9b4[_0x21ac68(0x472,0x41a,0x469,0x423)],_0x2bf9b4['TSQAQ'])){const _0x3f074d=_0x43ba9c[_0x32dcaa(0xb0,0x50,0x7a,0x8b)](),_0x5ea834=_0x1604c3['chatMetada'+'ta'][_0x21ac68(0x440,0x4ba,0x494,0x471)][_0x3f074d]||'';return _0x4d09ad&&_0x32ce3b[_0x21ac68(0x400,0x3dc,0x40c,0x3f4)]('{@getvar::'+_0x3f074d+'@}'),_0x5ea834;}else _0x1617be[_0x21ac68(0x435,0x3b6,0x3dc,0x3f4)](_0x21ac68(0x3c0,0x3aa,0x3db,0x3cd)+_0x32dcaa(0x8d,0xaf,0xa5,0x63)+_0x108c98+'@}');}function _0x21ac68(_0x4c3df7,_0x4075a6,_0x5649df,_0x3325d7){return _0xc38e6b(_0x4075a6,_0x3325d7- -0x61,_0x5649df-0xda,_0x3325d7-0x176);}function _0x32dcaa(_0x1859fb,_0x481fd6,_0x535957,_0x53695f){return _0xc38e6b(_0x535957,_0x53695f- -0x3e8,_0x535957-0xdd,_0x53695f-0x144);}return'';}),_0x4a789e=_0x4a789e['replace'](/\{@getglobalvar::([^@]+)@\}/g,(_0x2e0d79,_0x1cc569)=>{const _0xfaf63f=_0x1cc569[_0x141b47(0x3a8,0x36f,0x38f,0x3ce)]();function _0x141b47(_0x5ea1fe,_0x115cb7,_0x17749b,_0x508b5a){return _0x57822c(_0x508b5a,_0x5ea1fe-0x172,_0x17749b-0x70,_0x508b5a-0xd);}const _0x13723f=_0x2bf9b4[_0x141b47(0x3b2,0x389,0x3e0,0x375)](getglobalvar,_0xfaf63f)||'';_0x1617be&&(_0x2bf9b4[_0x1a2740(0x2c8,0x2d0,0x29c,0x2a6)]===_0x2bf9b4['ktOfN']?_0x3bd14a[_0x4d1573]=_0x2bf9b4[_0x1a2740(0x2e4,0x2dd,0x356,0x310)](_0x11f286,_0x3c385f[_0x3f4715],_0x4932e6,_0xbaefda,_0x20b66e):_0x1617be['add'](_0x1a2740(0x2a3,0x314,0x2c1,0x2c3)+_0x141b47(0x380,0x399,0x3b5,0x369)+_0xfaf63f+'@}'));function _0x1a2740(_0x769bce,_0x1ad595,_0x140b75,_0x50c18d){return _0xc38e6b(_0x1ad595,_0x50c18d- -0x1a9,_0x140b75-0x11e,_0x50c18d-0x1);}return _0x13723f;}),_0x4a789e=_0x4a789e[_0xc38e6b(0x467,0x46a,0x47c,0x427)](/\{@getworldvar::([^@]+)@\}/g,(_0x49a55c,_0x7547a5)=>{const _0x72545e=_0x7547a5[_0x508bcc(0x161,0x195,0x1cd,0x144)]();function _0x508bcc(_0x5977ec,_0x44f656,_0x76368f,_0x1b5470){return _0x57822c(_0x5977ec,_0x44f656- -0xa1,_0x76368f-0xb8,_0x1b5470-0x18a);}function _0x42671(_0x38d397,_0x3219cd,_0x11490a,_0x288b3a){return _0x57822c(_0x38d397,_0x11490a- -0x245,_0x11490a-0x44,_0x288b3a-0x1d4);}const _0x434be9=getworldvar(_0x72545e)||'';if(_0x1617be){if(_0x2bf9b4[_0x508bcc(0x1bc,0x186,0x18a,0x1d8)](_0x42671(-0x13,-0x69,-0x4b,-0x4b),_0x2bf9b4[_0x508bcc(0x155,0x17a,0x133,0x150)]))return _0x541dc8;else _0x1617be['add'](_0x42671(0x7d,0x85,0x42,0x7)+_0x508bcc(0x1c1,0x184,0x144,0x165)+_0x72545e+'@}');}return _0x434be9;}),_0x4a789e;}export function buildPromptWithTrigger(_0xde8f46){const _0x7f2a45={'InNrP':function(_0x293e50,_0x463239){return _0x293e50!==_0x463239;},'Yxatr':_0x593d20(-0x15f,-0x1d6,-0x16c,-0x185),'URbtb':function(_0xf0e215,_0x10d07f){return _0xf0e215!==_0x10d07f;},'oPcdv':'assistant','eJrxz':_0x856461(0x7e,0x36,0x40,0x70),'hkBcF':function(_0x56ee04,_0x5a4619,_0x565595){return _0x56ee04(_0x5a4619,_0x565595);},'ghpYw':function(_0x1d889b,_0x5c0d30){return _0x1d889b===_0x5c0d30;},'aLufH':'zpRgJ','ryxqI':function(_0x3bb1e5,_0x1e7f00){return _0x3bb1e5===_0x1e7f00;},'oINCO':_0x593d20(-0x139,-0x18a,-0x15f,-0x143),'vDUdo':function(_0x4fd80f,_0x2d290c){return _0x4fd80f!==_0x2d290c;},'HQWzW':_0x856461(0x21,0x80,0x77,0x71),'JPOlo':_0x593d20(-0x166,-0x11d,-0x125,-0x158),'XEZHY':_0x856461(0x6,0x2c,0x5e,0x31),'tJUuY':_0x593d20(-0x187,-0x145,-0x139,-0x13a)},{requestType:_0x588f8e,contextData:_0x40bb8e}=_0xde8f46,_0x189b9c=extension_settings[extensionName]?.[_0x856461(0x5b,0x51,0x72,0x32)+_0x856461(0x28,0x5,0x64,0x47)+'figs']||{},_0x220fac={};_0x220fac[_0x856461(-0x7,0x93,-0x1,0x42)+_0x593d20(-0x111,-0xa9,-0xa7,-0xee)]='默认';const _0x1a3d6f=_0x189b9c[_0x588f8e]||_0x220fac,_0x434e68=_0x1a3d6f[_0x856461(0x80,0x24,0x2f,0x42)+_0x856461(0xa5,0xc4,0xe0,0xcc)]||'默认';function _0x593d20(_0x2c779b,_0x18b717,_0x5640a9,_0x2c23cb){return _0x16d2(_0x2c23cb- -0x247,_0x18b717);}const _0x1e3c1a=extension_settings[extensionName]?.[_0x593d20(-0x1a6,-0x141,-0x1a5,-0x17b)+_0x593d20(-0x18d,-0x12f,-0x10b,-0x14d)+'s']||{},_0x24f5f=_0x1e3c1a[_0x434e68]||_0x1e3c1a[Object[_0x856461(0x14,-0x4,0x3e,0x50)](_0x1e3c1a)[0xd22*-0x1+0x11ce*-0x1+-0x3c*-0x84]]||{},{context:context='',body:body='',worldBookContent:worldBookContent='',userDemand:userDemand=''}=_0x40bb8e;function _0x856461(_0x549dc0,_0x4c991a,_0x52dc2e,_0x14ef61){return _0x16d2(_0x14ef61- -0x8d,_0x4c991a);}const _0x5189df=[userDemand,context,body,worldBookContent][_0x856461(0x5c,0x6c,0xbb,0x8d)](Boolean)[_0x856461(0x9b,0x99,0xe1,0xca)]('\x0a'),_0x1e36ad=[];if(_0x24f5f[_0x593d20(-0xf9,-0xf4,-0x142,-0x135)]&&Array[_0x593d20(-0x12c,-0xf3,-0x13c,-0x105)](_0x24f5f[_0x593d20(-0x10c,-0x127,-0xf7,-0x135)]))for(const _0x482550 of _0x24f5f[_0x856461(0x48,0xbb,0x3e,0x85)]){if(!_0x482550['enabled'])continue;if(!_0x482550[_0x856461(0x116,0xea,0xa3,0xcf)]||_0x482550['content'][_0x593d20(-0x12f,-0x189,-0x18a,-0x148)]()==='')continue;if(_0x482550[_0x856461(0x119,0x9b,0xcf,0xc5)+'e']===_0x7f2a45[_0x856461(0x51,0x2f,-0x1d,0x2c)]){if(!_0x7f2a45[_0x856461(0x7d,0x8a,0x83,0x5a)](checkTriggerWords,_0x482550['triggerWor'+'ds'],_0x5189df)){if(_0x7f2a45['ghpYw'](_0x7f2a45[_0x593d20(-0xf1,-0xf9,-0x12c,-0x138)],_0x7f2a45['aLufH']))continue;else{if(_0x1a24db[_0x593d20(-0x171,-0x17e,-0x1b2,-0x185)]&&_0x7f2a45[_0x593d20(-0x12d,-0x109,-0x11f,-0x106)](_0x4b481f[_0x856461(-0x1f,0x82,0x81,0x35)]['trim'](),'')){const _0x49835f={};_0x49835f[_0x593d20(-0x169,-0x16a,-0x13b,-0x17c)]=_0x7f2a45['Yxatr'],_0x49835f[_0x593d20(-0x12f,-0xb6,-0xa2,-0xeb)]=_0x19fc36[_0x593d20(-0x1b1,-0x19d,-0x183,-0x185)],_0x318a11[_0x593d20(-0x13c,-0x1d0,-0x199,-0x17f)](_0x49835f);}if(_0x185b73[_0x593d20(-0x11e,-0xef,-0x18c,-0x13d)]&&_0x7f2a45['URbtb'](_0x344853[_0x856461(0x3b,0x3e,0xb1,0x7d)][_0x593d20(-0x113,-0x16e,-0x12b,-0x148)](),'')){const _0x10aefd={};_0x10aefd[_0x593d20(-0x1a2,-0x14e,-0x1cc,-0x17c)]=_0x7f2a45['oPcdv'],_0x10aefd[_0x593d20(-0xf4,-0x10c,-0x11e,-0xeb)]=_0x5755e8[_0x593d20(-0x185,-0x158,-0x106,-0x13d)],_0x1afd75['push'](_0x10aefd);}}}}const _0x342ddd={};_0x342ddd[_0x593d20(-0x187,-0x165,-0x13b,-0x17c)]=_0x482550[_0x856461(0x5a,0x18,0x1f,0x3e)]||_0x856461(0x21,0x66,0x6,0x35),_0x342ddd[_0x856461(0xac,0xd6,0xf1,0xcf)]=_0x482550[_0x856461(0x8c,0x100,0xde,0xcf)],_0x1e36ad[_0x856461(0x2d,0x68,0x23,0x3b)](_0x342ddd);}else{if(_0x24f5f[_0x593d20(-0xfe,-0x102,-0x12b,-0x12e)]&&Array[_0x856461(0xe5,0xe9,0x93,0xb5)](_0x24f5f[_0x593d20(-0x142,-0x112,-0x145,-0x12e)]))for(const _0x3f3c7e of _0x24f5f[_0x593d20(-0x15c,-0xf1,-0x10f,-0x12e)]){if(_0x7f2a45[_0x856461(0xdf,0x86,0x66,0x9a)](_0x7f2a45[_0x856461(0x93,0x15,0x4a,0x52)],_0x7f2a45['oINCO'])){if(_0x3f3c7e[_0x856461(0x0,0x5a,0x3b,0x35)]&&_0x7f2a45['vDUdo'](_0x3f3c7e[_0x856461(0x3f,0x2f,0x5b,0x35)][_0x593d20(-0x127,-0x11d,-0x182,-0x148)](),'')){if(_0x7f2a45[_0x856461(0xb4,0xd8,0xad,0xaf)]!==_0x7f2a45['JPOlo']){const _0x4d16b4={};_0x4d16b4[_0x593d20(-0x147,-0x1c9,-0x143,-0x17c)]=_0x593d20(-0x18f,-0x196,-0x1c8,-0x185),_0x4d16b4[_0x856461(0xea,0x118,0xcd,0xcf)]=_0x3f3c7e[_0x856461(-0xb,0x83,0x55,0x35)],_0x1e36ad[_0x593d20(-0x18c,-0x18b,-0x143,-0x17f)](_0x4d16b4);}else{const _0x2a840f=_0xfadbf6[_0x856461(0x27,0x50,0x20,0x72)](),_0x4d6d40=_0x53ca75(_0x2a840f)||'';return _0x4968dc&&_0x18dc60[_0x593d20(-0x181,-0x175,-0x1b7,-0x166)](_0x593d20(-0x147,-0x11f,-0x134,-0xf7)+_0x593d20(-0x19e,-0x12a,-0x186,-0x159)+_0x2a840f+'@}'),_0x4d6d40;}}if(_0x3f3c7e[_0x593d20(-0x11a,-0x13f,-0x190,-0x13d)]&&_0x7f2a45['vDUdo'](_0x3f3c7e['assistant'][_0x593d20(-0xff,-0x15b,-0x133,-0x148)](),'')){if(_0x7f2a45[_0x593d20(-0x100,-0x126,-0x11c,-0x108)]===_0x7f2a45['tJUuY'])_0x48f391['add'](_0x856461(0x6c,0xac,0xa6,0xae)+_0x1ec95c+'@}');else{const _0x6f83={};_0x6f83[_0x856461(0x75,0x4e,0x3c,0x3e)]=_0x856461(0xa7,0xbe,0x3e,0x7d),_0x6f83['content']=_0x3f3c7e[_0x856461(0xb3,0xcd,0x9f,0x7d)],_0x1e36ad['push'](_0x6f83);}}}else _0x54af0f[_0x856461(0x35,0x74,0x7b,0x54)](_0x856461(0x3,0x17,0x4a,0x2d)+_0x593d20(-0x1bd,-0x155,-0x187,-0x170)+_0x12e685+'@}');}}const _0x11ebd8=mergeAdjacentMessages(_0x1e36ad),{messages:_0x2cf792,replacedVariables:_0x9e32d1}=replaceAllPlaceholders(_0x11ebd8,_0x40bb8e);return _0x2cf792;}export function getProcessedPrompt(_0x476ddc,_0x3e1b5e){function _0x5bd0e9(_0xcee186,_0x11eb7a,_0x3a5546,_0x33e4f6){return _0x16d2(_0xcee186- -0x28,_0x11eb7a);}const _0x4cb203={'DxmaC':function(_0x36f60c,_0x49cb93){return _0x36f60c(_0x49cb93);}};function _0x1c0f73(_0x2c1fa8,_0xc09103,_0x34b16d,_0x441b08){return _0x16d2(_0x34b16d- -0x35b,_0x2c1fa8);}const _0x115b56={};return _0x115b56[_0x1c0f73(-0x25b,-0x27d,-0x275,-0x256)+'e']=_0x476ddc,_0x115b56[_0x5bd0e9(0xec,0xe8,0xfc,0xa6)+'a']=_0x3e1b5e,_0x4cb203[_0x1c0f73(-0x279,-0x255,-0x296,-0x2c0)](buildPromptWithTrigger,_0x115b56);}