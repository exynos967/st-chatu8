(function(_0x3ea028,_0x19e86b){function _0x2a086a(_0x26e086,_0x1a8c46,_0x4e6191,_0x5279d1){return _0x1434(_0x26e086-0x2e1,_0x1a8c46);}const _0x39888c=_0x3ea028();function _0x52224a(_0x405bd3,_0x1ef1ed,_0xba87ad,_0x11e994){return _0x1434(_0x405bd3- -0x3f,_0xba87ad);}while(!![]){try{const _0xe8c4ac=-parseInt(_0x2a086a(0x4c2,0x4dd,0x4e4,0x4a0))/(-0x1*-0x1021+0x8*-0xb+-0xfc8)+parseInt(_0x52224a(0x1b2,0x1cd,0x18f,0x1d1))/(-0xb6b*0x2+-0x75*-0x3a+-0x3aa)+-parseInt(_0x52224a(0x221,0x1db,0x23f,0x22d))/(-0x15*0x2f+-0x12c8+-0xdf*-0x1a)+parseInt(_0x2a086a(0x4fa,0x4d4,0x530,0x502))/(-0x11df+0xa82+-0x1*-0x761)+-parseInt(_0x52224a(0x190,0x16f,0x1cf,0x147))/(-0x1*0x1d29+0x243a*0x1+-0x4*0x1c3)*(-parseInt(_0x2a086a(0x54b,0x50a,0x522,0x55a))/(0xd0*0x28+-0x15d8+-0xaa2))+-parseInt(_0x52224a(0x1ad,0x1ea,0x1f1,0x1c3))/(-0x1ca4+-0x1a2f+0x36da)*(-parseInt(_0x2a086a(0x524,0x51c,0x4ea,0x515))/(-0x9ac*0x1+0x17db+-0xe27*0x1))+-parseInt(_0x2a086a(0x4b3,0x483,0x495,0x49a))/(0x1bf4+-0x1*-0x18df+-0x1d*0x1d2);if(_0xe8c4ac===_0x19e86b)break;else _0x39888c['push'](_0x39888c['shift']());}catch(_0x3642be){_0x39888c['push'](_0x39888c['shift']());}}}(_0x16b5,-0x1b71+0x12465+0x1*0x7f43));const _0x24debe=(function(){function _0xa006f3(_0x18ad9d,_0x230a65,_0x6a3ee,_0x2efbd0){return _0x1434(_0x18ad9d-0x310,_0x230a65);}const _0x20b05f={'hNuYF':function(_0x70d0da,_0x404d88,_0x27e5b8,_0x500b5d){return _0x70d0da(_0x404d88,_0x27e5b8,_0x500b5d);},'eUWmq':function(_0x4087ca,_0x549db3){return _0x4087ca!==_0x549db3;},'rszJz':'shbCZ','ClPlJ':_0xa006f3(0x509,0x509,0x4f2,0x4cc),'IauIq':'uApdl'};let _0x3a9651=!![];return function(_0x1eee40,_0x496ac6){function _0x2f6801(_0x4b4d52,_0x5cdfc8,_0x1544f1,_0x48c1f5){return _0xa006f3(_0x5cdfc8- -0x6b9,_0x48c1f5,_0x1544f1-0x189,_0x48c1f5-0x1d9);}const _0x4824c2={'WTsst':function(_0x24e8b9,_0x17805d,_0x10cb0e,_0x5bceae){return _0x20b05f['hNuYF'](_0x24e8b9,_0x17805d,_0x10cb0e,_0x5bceae);},'hpKnl':function(_0x4fccc0,_0x2f6e5b){function _0x3d1977(_0x494763,_0x4956bb,_0x4104a0,_0x44002d){return _0x1434(_0x44002d-0x1d5,_0x4956bb);}return _0x20b05f[_0x3d1977(0x400,0x36e,0x3a1,0x3be)](_0x4fccc0,_0x2f6e5b);},'WssEH':_0x20b05f[_0x2f6801(-0x153,-0x16b,-0x194,-0x173)],'antGi':'tfOdY'};function _0x2f8ebe(_0x17b35b,_0x1c90fb,_0x1103d6,_0x4b608f){return _0xa006f3(_0x17b35b- -0xd7,_0x1103d6,_0x1103d6-0x1f4,_0x4b608f-0xc7);}if(_0x20b05f[_0x2f8ebe(0x422,0x3f1,0x46d,0x455)](_0x20b05f[_0x2f6801(-0x188,-0x17e,-0x191,-0x151)],_0x20b05f['IauIq'])){const _0x11e948=_0x3a9651?function(){function _0x12b661(_0x374f4c,_0x52b62a,_0x338c9d,_0x592891){return _0x2f8ebe(_0x338c9d-0xfe,_0x52b62a-0x161,_0x52b62a,_0x592891-0x1be);}function _0x5d67b4(_0x433703,_0x46bb4f,_0x59b557,_0x11ea22){return _0x2f8ebe(_0x11ea22-0x42,_0x46bb4f-0x19f,_0x59b557,_0x11ea22-0x92);}if(_0x4824c2['hpKnl'](_0x4824c2[_0x12b661(0x4e4,0x4df,0x508,0x4fe)],_0x4824c2['antGi'])){if(_0x496ac6){const _0x4e7cd2=_0x496ac6[_0x12b661(0x506,0x559,0x556,0x564)](_0x1eee40,arguments);return _0x496ac6=null,_0x4e7cd2;}}else return{..._0x42f159,'text':_0x4824c2['WTsst'](_0xe9470c,_0x5b0323[_0x5d67b4(0x4c8,0x4bc,0x463,0x492)],_0x552004,_0x172c07)};}:function(){};return _0x3a9651=![],_0x11e948;}else{const _0x517ae7=_0x2b2cde[_0x2f8ebe(0x487,0x47c,0x461,0x4c4)]();return _0x5d6254[_0x2f8ebe(0x46e,0x482,0x497,0x488)+'ta'][_0x2f8ebe(0x468,0x426,0x44f,0x451)][_0x517ae7]=_0x36681f,_0x32da14&&_0x2b4c55[_0x2f8ebe(0x41d,0x3d2,0x450,0x42d)](_0x2f6801(-0x1b4,-0x16e,-0x1bd,-0x166)+_0x517ae7+'@}'),'';}};}()),_0x486b79=_0x24debe(this,function(){function _0x350608(_0x185a7c,_0x236e4e,_0x4f4993,_0x47fa38){return _0x1434(_0x236e4e- -0x3f,_0x4f4993);}const _0x4e141e={};function _0x3273f2(_0x37745a,_0x58fc98,_0x37ec7a,_0x23eaac){return _0x1434(_0x37745a- -0x216,_0x58fc98);}_0x4e141e[_0x3273f2(0x39,0xa,0x6e,0x12)]=_0x3273f2(0x23,0x16,0x71,0x29)+'+$';const _0x27e850=_0x4e141e;return _0x486b79['toString']()[_0x350608(0x1dd,0x1b9,0x1d3,0x1b5)](_0x27e850['LBZAJ'])[_0x350608(0x1eb,0x217,0x24c,0x24c)]()[_0x3273f2(-0x3f,0x5,-0x5d,-0x37)+'r'](_0x486b79)[_0x350608(0x184,0x1b9,0x1e0,0x1a8)](_0x350608(0x21c,0x1fa,0x1f7,0x24a)+'+$');});_0x486b79();import{extension_settings}from'../../../../extensions.js';function _0x1434(_0x4e2640,_0x1b6a7b){_0x4e2640=_0x4e2640-(0x2304+-0x1*0x1a49+-0x6f0);const _0x292e8f=_0x16b5();let _0x307573=_0x292e8f[_0x4e2640];if(_0x1434['rFURYW']===undefined){var _0x42cc86=function(_0x1c5965){const _0x36c8a8='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x5c9e40='',_0x5d79f5='',_0x97b593=_0x5c9e40+_0x42cc86;for(let _0xb24d50=-0x1685+-0x43*-0x59+-0x2*0x63,_0x1745c8,_0x215b02,_0x72bd43=0x48b+-0x1db0+0x1925*0x1;_0x215b02=_0x1c5965['charAt'](_0x72bd43++);~_0x215b02&&(_0x1745c8=_0xb24d50%(-0xb60+0x1862*0x1+-0xcfe)?_0x1745c8*(0x260c+-0x1070+-0x155c)+_0x215b02:_0x215b02,_0xb24d50++%(-0x1cb*0x1+0x166a+-0x149b))?_0x5c9e40+=_0x97b593['charCodeAt'](_0x72bd43+(-0x10f5+-0x1876+0x2975))-(-0x79*0x31+-0x4*0x1e9+0x1ed7)!==-0x1aee+-0x1943+-0x1*-0x3431?String['fromCharCode'](0x1214+0xcfb*-0x1+0x4b*-0xe&_0x1745c8>>(-(0x2207+-0x15c9+-0xc3c*0x1)*_0xb24d50&0x418+0x1ecb+-0x4b*0x77)):_0xb24d50:0x1304+-0x1e17*0x1+0xb13){_0x215b02=_0x36c8a8['indexOf'](_0x215b02);}for(let _0x4f0aa9=-0x8ee+-0xdf9+-0x29*-0x8f,_0x1ca767=_0x5c9e40['length'];_0x4f0aa9<_0x1ca767;_0x4f0aa9++){_0x5d79f5+='%'+('00'+_0x5c9e40['charCodeAt'](_0x4f0aa9)['toString'](0x2ef*-0x2+0x1014+-0x1b1*0x6))['slice'](-(0x1de4+0xd0b+0xb*-0x3e7));}return decodeURIComponent(_0x5d79f5);};_0x1434['DetOHF']=_0x42cc86,_0x1434['FXAMDY']={},_0x1434['rFURYW']=!![];}const _0x2b4a00=_0x292e8f[-0xa2*0x17+-0x392*-0x8+-0xe02],_0x3f7282=_0x4e2640+_0x2b4a00,_0x30f52b=_0x1434['FXAMDY'][_0x3f7282];if(!_0x30f52b){const _0x3fa84b=function(_0xa332fb){this['GkdmcI']=_0xa332fb,this['rhKWMw']=[-0x64e+-0x1*-0x1a6b+-0x141c*0x1,0x10a8+-0x2*0x201+0x653*-0x2,0x238+0x1516*-0x1+0x12de],this['xxZHky']=function(){return'newState';},this['iyMvtD']='\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*',this['GZoKCR']='[\x27|\x22].+[\x27|\x22];?\x20*}';};_0x3fa84b['prototype']['UbBNlw']=function(){const _0x427677=new RegExp(this['iyMvtD']+this['GZoKCR']),_0xd6ba5c=_0x427677['test'](this['xxZHky']['toString']())?--this['rhKWMw'][-0x12d0*0x1+0x1d01+-0xa30*0x1]:--this['rhKWMw'][0x1*0x684+0x263e+-0x2cc2];return this['WIOuIj'](_0xd6ba5c);},_0x3fa84b['prototype']['WIOuIj']=function(_0x34922f){if(!Boolean(~_0x34922f))return _0x34922f;return this['SMnPhq'](this['GkdmcI']);},_0x3fa84b['prototype']['SMnPhq']=function(_0x4c5720){for(let _0x33198b=-0x29*-0x89+-0x2419+0x25c*0x6,_0x20c276=this['rhKWMw']['length'];_0x33198b<_0x20c276;_0x33198b++){this['rhKWMw']['push'](Math['round'](Math['random']())),_0x20c276=this['rhKWMw']['length'];}return _0x4c5720(this['rhKWMw'][-0x13ec+0x32b+0x10c1]);},new _0x3fa84b(_0x1434)['UbBNlw'](),_0x307573=_0x1434['DetOHF'](_0x307573),_0x1434['FXAMDY'][_0x3f7282]=_0x307573;}else _0x307573=_0x30f52b;return _0x307573;}import{extensionName}from'./config.js';import{getContext}from'../../../../st-context.js';import{getglobalvar,setglobalvar}from'./chatDataUtils.js';import{getworldvar}from'./worldbookProcessor.js';export function checkTriggerWords(_0x3868f0,_0x166bff){const _0x1f5c1b={};_0x1f5c1b['UoWZa']=function(_0x3c1136,_0x5f54a7){return _0x3c1136||_0x5f54a7;};function _0x384a89(_0x4039b0,_0x222ff8,_0x55a216,_0x34d865){return _0x1434(_0x222ff8-0x36e,_0x4039b0);}_0x1f5c1b[_0x36db41(-0x153,-0x172,-0x143,-0x197)]=function(_0x58bd4c,_0x10db04){return _0x58bd4c===_0x10db04;};function _0x36db41(_0x131b92,_0x38b595,_0x206b36,_0x28eb43){return _0x1434(_0x38b595- -0x3ae,_0x131b92);}const _0x36c99f=_0x1f5c1b;if(_0x36c99f[_0x36db41(-0x17d,-0x1bf,-0x203,-0x18e)](!_0x3868f0,!_0x166bff))return![];const _0xaf2763=_0x3868f0[_0x36db41(-0x16f,-0x186,-0x19c,-0x14d)](',')[_0x36db41(-0x139,-0x178,-0x1c2,-0x144)](_0x28c7f2=>_0x28c7f2[_0x384a89(0x5ee,0x5bc,0x5ee,0x5d2)]())['filter'](_0x46ab32=>_0x46ab32);if(_0x36c99f[_0x36db41(-0x178,-0x172,-0x17d,-0x16f)](_0xaf2763['length'],0x107*0x1+-0x1bdd+0x1ad6))return![];for(const _0x252fcd of _0xaf2763){if(_0x384a89(0x5af,0x5c6,0x598,0x602)===_0x384a89(0x520,0x558,0x52f,0x56e)){if(_0x1930de){const _0x22c54d=_0x265d06[_0x36db41(-0x1d8,-0x18f,-0x1de,-0x1c3)](_0x336132,arguments);return _0x13f4f1=null,_0x22c54d;}}else{if(_0x166bff[_0x384a89(0x5f8,0x5a6,0x59f,0x554)](_0x252fcd))return!![];}}return![];}export function mergeAdjacentMessages(_0x5ec3c5){function _0xc83ade(_0x30ab17,_0x361452,_0x5c67b0,_0x304875){return _0x1434(_0x361452-0x302,_0x30ab17);}const _0x4e516c={'hCrtU':function(_0x538f7c,_0x35e27f){return _0x538f7c===_0x35e27f;},'sGBVc':function(_0x1559a4,_0x99225c,_0x3af9f7){return _0x1559a4(_0x99225c,_0x3af9f7);},'FMAmY':_0x1e6a0c(0x1e2,0x227,0x1ec,0x26c),'Inhil':_0x1e6a0c(0x242,0x26d,0x25b,0x26d)};if(!_0x5ec3c5||_0x5ec3c5[_0x1e6a0c(0x26b,0x21b,0x265,0x1e4)]===0x43*-0x2f+0x1*-0x1865+0x24b2)return[];function _0x1e6a0c(_0x2e0bcc,_0x5ce3ce,_0xb61811,_0x1ce880){return _0x1434(_0x5ce3ce-0x33,_0x2e0bcc);}const _0x4097b9=[];let _0x3fffd6=null;for(const _0x538376 of _0x5ec3c5){if(!_0x3fffd6){const _0x301a1a={..._0x538376};_0x3fffd6=_0x301a1a;}else{if(_0x4e516c[_0xc83ade(0x5a5,0x56a,0x535,0x58f)](_0x3fffd6['role'],_0x538376[_0x1e6a0c(0x2d7,0x28c,0x275,0x2c8)]))_0x3fffd6['content']=_0x4e516c[_0x1e6a0c(0x207,0x210,0x243,0x228)](mergeContent,_0x3fffd6[_0xc83ade(0x524,0x4d8,0x4d1,0x4ff)],_0x538376['content']);else{if(_0x4e516c[_0x1e6a0c(0x249,0x29b,0x2e0,0x267)](_0x4e516c['FMAmY'],_0x4e516c[_0x1e6a0c(0x264,0x22f,0x1f9,0x228)]))_0x3dabb6[_0x1e6a0c(0x1db,0x217,0x1d7,0x246)]('{@setvar::'+_0x5e735d+'@}');else{_0x4097b9[_0x1e6a0c(0x298,0x29f,0x24f,0x26b)](_0x3fffd6);const _0x2d50c7={..._0x538376};_0x3fffd6=_0x2d50c7;}}}}return _0x3fffd6&&_0x4097b9[_0xc83ade(0x52d,0x56e,0x527,0x55f)](_0x3fffd6),_0x4097b9;}function mergeContent(_0x4778a5,_0x35311d){function _0x5c8d76(_0x417a49,_0x560a81,_0x4b5bf2,_0x21f970){return _0x1434(_0x560a81- -0x20b,_0x417a49);}const _0xdf9915={'UfFHV':function(_0x3ee4ac,_0xf9c7e4){return _0x3ee4ac===_0xf9c7e4;},'GxPjD':_0x3102c4(-0xd2,-0xea,-0xc2,-0xf1),'XqSiz':_0x5c8d76(0x40,0x49,-0x1,0x90),'ZFRCd':function(_0x3256d7,_0x26fd69){return _0x3256d7+_0x26fd69;},'iVBBr':function(_0x39682c,_0x4b784f){return _0x39682c+_0x4b784f;},'afDaS':function(_0x36f32e,_0x76e778){return _0x36f32e(_0x76e778);}};if(_0xdf9915[_0x5c8d76(0x15,0x57,0x8,0xa)](typeof _0x4778a5,_0xdf9915[_0x3102c4(-0xf5,-0x14c,-0x126,-0xea)])&&typeof _0x35311d===_0xdf9915[_0x5c8d76(-0x17,-0x2f,-0x66,-0x79)]){if(_0xdf9915[_0x3102c4(-0xe0,-0x66,-0x94,-0x5e)]!==_0x3102c4(-0x13b,-0x144,-0xff,-0x100))return _0xdf9915['ZFRCd'](_0xdf9915[_0x5c8d76(0x28,0x4c,0x79,0x32)](_0x4778a5,'\x0a'),_0x35311d);else _0x511d15[_0x3102c4(-0xef,-0xf2,-0x11e,-0xf9)](_0x3102c4(-0xc3,-0x76,-0xc1,-0xc3)+'lvar::'+_0x24fbe7+'@}');}function _0x3102c4(_0x3e98a9,_0x32dbc4,_0x11d080,_0x190db1){return _0x1434(_0x11d080- -0x302,_0x3e98a9);}const _0x1d3c9e=normalizeToArray(_0x4778a5),_0x5f1564=_0xdf9915[_0x5c8d76(-0x11,0x11,-0x3d,-0x13)](normalizeToArray,_0x35311d),_0x13bf68={};return _0x13bf68['type']='text',_0x13bf68[_0x5c8d76(0x27,0xc,-0x28,0x48)]='\x0a',[..._0x1d3c9e,_0x13bf68,..._0x5f1564];}function normalizeToArray(_0xa61069){const _0x38d9b9={};_0x38d9b9[_0x4d9de3(0x5d7,0x5b8,0x5b5,0x59b)]=_0x4d9de3(0x585,0x596,0x5d0,0x5bb),_0x38d9b9[_0x4d9de3(0x532,0x529,0x50d,0x52c)]=function(_0x135c29,_0x54dd8e){return _0x135c29!==_0x54dd8e;},_0x38d9b9['Wnvhq']=_0x4d9de3(0x4f0,0x53f,0x54e,0x52f);function _0x4d9de3(_0x3ec537,_0xdec591,_0x363321,_0x1194f4){return _0x1434(_0x1194f4-0x35c,_0x3ec537);}function _0x3b0f50(_0x1d1f19,_0x23d7c6,_0x43cc64,_0x47cab7){return _0x1434(_0x47cab7-0x180,_0x43cc64);}_0x38d9b9['LUrhV']=function(_0x229ddc,_0x11d5f3){return _0x229ddc||_0x11d5f3;};const _0x3da54e=_0x38d9b9;if(Array[_0x3b0f50(0x39d,0x38b,0x37d,0x3aa)](_0xa61069)){if(_0x3da54e[_0x3b0f50(0x39b,0x39c,0x2ff,0x350)](_0x4d9de3(0x587,0x54e,0x537,0x566),_0x3da54e[_0x4d9de3(0x58c,0x56b,0x5ad,0x5af)]))return _0xa61069;else{const _0x16eb87={};_0x16eb87[_0x4d9de3(0x599,0x5ec,0x5d3,0x5b5)]=_0x3da54e[_0x3b0f50(0x374,0x411,0x412,0x3bf)],_0x16eb87['content']=_0x851d95[_0x4d9de3(0x5c3,0x5d0,0x58d,0x5bb)],_0x2a838e[_0x4d9de3(0x607,0x5a8,0x5e8,0x5c8)](_0x16eb87);}}return[{'type':_0x3b0f50(0x37d,0x38d,0x349,0x397),'text':_0x3da54e[_0x3b0f50(0x3fc,0x3b8,0x3c1,0x3ae)](_0xa61069,'')}];}export function replacePlaceholder(_0x4578cf,_0x2063e8,_0x380843,_0x140388){const _0x37a25b={'UjmnD':function(_0x341e0d,_0x262bee){return _0x341e0d||_0x262bee;},'LNHqu':function(_0x4d951a,_0x3f9283){return _0x4d951a===_0x3f9283;},'qtmuY':'string','VlOKv':_0x2c0624(0xf5,0x113,0x15c,0x12f),'dcPSb':_0x1b3b32(0x47c,0x494,0x435,0x45a),'GVpPH':function(_0x2707fc,_0x7dd981){return _0x2707fc===_0x7dd981;},'LvcQH':_0x2c0624(0xdd,0x111,0x15f,0x10d),'RoNhl':_0x1b3b32(0x402,0x3f9,0x410,0x41b),'sVaOU':'AONBk','MXozs':function(_0x16d733,_0x39e3d6,_0x481e26,_0x42f75a,_0xafc84f){return _0x16d733(_0x39e3d6,_0x481e26,_0x42f75a,_0xafc84f);}};if(_0x37a25b['LNHqu'](typeof _0x4578cf,_0x37a25b[_0x1b3b32(0x481,0x494,0x4cf,0x48a)])){if(_0x380843&&_0x4578cf[_0x2c0624(0x121,0x147,0x17a,0x125)](_0x2063e8)){if(_0x37a25b[_0x2c0624(0x144,0x178,0x14c,0x18c)]===_0x37a25b[_0x2c0624(0x143,0x178,0x192,0x141)])_0x140388&&_0x140388[_0x1b3b32(0x419,0x463,0x44e,0x451)](_0x2063e8);else{const _0x18bbe4={};for(const _0x3617d0 in _0x55c168){_0x18bbe4[_0x3617d0]=_0x483eab(_0x61c0eb[_0x3617d0],_0x29764a,_0x3bc2d6,_0x1619e6);}return _0x18bbe4;}}return _0x4578cf[_0x1b3b32(0x43d,0x434,0x45a,0x47d)](_0x2063e8,_0x380843||'');}function _0x1b3b32(_0xe235fd,_0x53554f,_0x5a5b7f,_0x155d10){return _0x1434(_0xe235fd-0x235,_0x155d10);}if(Array[_0x1b3b32(0x45f,0x453,0x48c,0x467)](_0x4578cf))return _0x4578cf[_0x2c0624(0x15b,0x145,0x123,0x162)](_0x4affca=>replacePlaceholder(_0x4affca,_0x2063e8,_0x380843,_0x140388));if(_0x4578cf&&_0x37a25b[_0x2c0624(0x11d,0x11c,0xeb,0x12c)](typeof _0x4578cf,_0x37a25b[_0x2c0624(0xde,0xf1,0x11e,0x134)])){if(_0x37a25b['GVpPH'](_0x37a25b[_0x2c0624(0x14d,0x125,0x145,0x14c)],_0x37a25b[_0x1b3b32(0x44b,0x411,0x46c,0x48e)])){const _0x399c7b={};for(const _0x281e1e in _0x4578cf){if(_0x37a25b[_0x2c0624(0x127,0x12a,0xdf,0xd9)]===_0x37a25b['sVaOU'])return _0x215b02&&_0x72bd43[_0x2c0624(0x16e,0x147,0x199,0x15a)](_0x4f0aa9)&&(_0x4c5720&&_0x2c701e[_0x2c0624(0xce,0xf3,0xc7,0x12e)](_0x6bee4c)),_0x427677[_0x2c0624(0x148,0x117,0xc6,0xfd)](_0xd6ba5c,_0x37a25b[_0x1b3b32(0x4a4,0x4b2,0x457,0x470)](_0x34922f,''));else _0x399c7b[_0x281e1e]=_0x37a25b[_0x1b3b32(0x410,0x3f7,0x405,0x45e)](replacePlaceholder,_0x4578cf[_0x281e1e],_0x2063e8,_0x380843,_0x140388);}return _0x399c7b;}else{const _0x52b309={..._0x42bb6b};_0x528c4b=_0x52b309;}}function _0x2c0624(_0x36dfd5,_0x3eb20f,_0x152837,_0x457997){return _0x1434(_0x3eb20f- -0xf1,_0x36dfd5);}return _0x4578cf;}export function replaceAllPlaceholders(_0x5c0c44,_0x3f9a59){const _0x1fd62e={'LARqd':function(_0x28b2b1,_0x53d103){return _0x28b2b1===_0x53d103;},'QgBiA':'text','WSIrg':_0x157d88(0x2d5,0x29f,0x2fd,0x2d7),'yuVcj':function(_0x5b4a7b,_0x4692cd,_0x25303f,_0x57049a){return _0x5b4a7b(_0x4692cd,_0x25303f,_0x57049a);},'EiAZY':function(_0x4882ed){return _0x4882ed();},'Ivnox':function(_0x4b2501,_0x3479e1){return _0x4b2501!==_0x3479e1;},'jZxKW':_0x578fb0(-0xa0,-0x3a,-0x88,-0x56),'RuxQy':'{{user}}','xzelq':function(_0x36f68d,_0x4d913a,_0x10d322,_0x56de63,_0x18eaf4){return _0x36f68d(_0x4d913a,_0x10d322,_0x56de63,_0x18eaf4);},'giAmS':'{{上下文}}','qIuND':function(_0x5c30e4,_0x10ea2c,_0x290a1f,_0x3c9ed9,_0x506fa3){return _0x5c30e4(_0x10ea2c,_0x290a1f,_0x3c9ed9,_0x506fa3);},'ppSFP':_0x578fb0(-0xc1,-0xbe,-0x9c,-0x7f),'DdoFq':_0x157d88(0x2d9,0x2bf,0x2c6,0x2a7),'VYlFV':'{{角色启用列表}}','GvZbp':function(_0x167f57,_0x1dba96,_0x2428a3,_0x3ae321,_0x5cae18){return _0x167f57(_0x1dba96,_0x2428a3,_0x3ae321,_0x5cae18);},'bbsqF':'{{通用服装启用列表'+'}}','TYaEu':_0x578fb0(-0x110,-0x10b,-0xda,-0x12b)+'}}','ZZXzv':function(_0x2b6149,_0x56d52a,_0x6945c,_0x78948f,_0x31c2d4){return _0x2b6149(_0x56d52a,_0x6945c,_0x78948f,_0x31c2d4);},'qdfQA':_0x157d88(0x26f,0x278,0x2be,0x2bc),'gJllR':function(_0x4cf497,_0x94806d){return _0x4cf497>_0x94806d;},'HgytS':function(_0x100a5e,_0x5e9fe1,_0x1c06b8){return _0x100a5e(_0x5e9fe1,_0x1c06b8);}},{context:context='',body:body='',worldBookContent:worldBookContent='',variables:variables={},userDemand:userDemand='',characterListText:characterListText='',outfitEnableListText:outfitEnableListText='',commonCharacterListText:commonCharacterListText=''}=_0x3f9a59,_0x52c5dd=new Set();let _0x47db7f=_0x5c0c44;const _0x4094e5=_0x1fd62e[_0x578fb0(-0x101,-0x99,-0xc1,-0xd1)](getContext),_0x1cb569=_0x4094e5?.[_0x157d88(0x2fa,0x34b,0x31d,0x33e)]||'';let _0x3adb8b=worldBookContent;if(_0x3adb8b){if(_0x1fd62e[_0x578fb0(-0xdd,-0x93,-0xc5,-0xd8)]('cMdjL',_0x1fd62e['jZxKW']))return _0x18ca9c[_0x578fb0(-0xe4,-0x6a,-0xa3,-0xac)](_0x5df93a=>{function _0x5e7fb8(_0x20ac64,_0x476663,_0x3dc005,_0x12a975){return _0x157d88(_0x3dc005-0x1df,_0x476663-0x26,_0x20ac64,_0x12a975-0x41);}if(_0x5df93a&&_0x1fd62e[_0x383f4e(0x378,0x359,0x395,0x391)](_0x5df93a[_0x5e7fb8(0x504,0x512,0x4d1,0x499)],_0x1fd62e[_0x383f4e(0x3a8,0x36c,0x388,0x3ea)])&&typeof _0x5df93a['text']===_0x1fd62e[_0x383f4e(0x320,0x35f,0x357,0x372)])return{..._0x5df93a,'text':_0x1fd62e['yuVcj'](_0x425719,_0x5df93a['text'],_0x4609c6,_0x49a0da)};function _0x383f4e(_0x56711d,_0x52080e,_0x2b0613,_0x1b71d3){return _0x578fb0(_0x56711d-0x16f,_0x1b71d3,_0x56711d-0x425,_0x1b71d3-0x125);}return _0x5df93a;});else _0x3adb8b=_0x3adb8b[_0x578fb0(-0xcb,-0xc0,-0xd1,-0xbb)](_0x1fd62e[_0x157d88(0x2c6,0x2c5,0x276,0x288)],_0x1cb569),_0x3adb8b=_0x3adb8b[_0x157d88(0x29d,0x2a4,0x25b,0x258)](_0x578fb0(-0x6e,-0xe6,-0xb8,-0xbd),_0x1cb569);}_0x47db7f=_0x1fd62e[_0x157d88(0x263,0x2b3,0x220,0x215)](replacePlaceholder,_0x47db7f,_0x1fd62e[_0x578fb0(-0x117,-0x8f,-0xd3,-0xa2)],context,_0x52c5dd);function _0x578fb0(_0x14f430,_0x307583,_0x58b18c,_0x593100){return _0x1434(_0x58b18c- -0x2d9,_0x307583);}_0x47db7f=_0x1fd62e[_0x578fb0(-0xff,-0x9e,-0xd9,-0x89)](replacePlaceholder,_0x47db7f,_0x1fd62e['ppSFP'],_0x3adb8b,_0x52c5dd),_0x47db7f=_0x1fd62e[_0x157d88(0x263,0x28c,0x298,0x296)](replacePlaceholder,_0x47db7f,_0x1fd62e[_0x578fb0(-0x7a,-0xa1,-0xa6,-0xe7)],body,_0x52c5dd),_0x47db7f=replacePlaceholder(_0x47db7f,_0x1fd62e[_0x578fb0(-0x135,-0xa9,-0xf2,-0x106)],characterListText,_0x52c5dd);function _0x157d88(_0x5747d8,_0x2a3553,_0x40e681,_0x5c17e8){return _0x1434(_0x5747d8-0x95,_0x40e681);}_0x47db7f=_0x1fd62e[_0x578fb0(-0xa2,-0x106,-0xe7,-0x139)](replacePlaceholder,_0x47db7f,_0x1fd62e[_0x157d88(0x2b8,0x26e,0x306,0x2d2)],outfitEnableListText,_0x52c5dd),_0x47db7f=_0x1fd62e['xzelq'](replacePlaceholder,_0x47db7f,_0x1fd62e[_0x157d88(0x2ea,0x311,0x2a7,0x2e5)],commonCharacterListText,_0x52c5dd),_0x47db7f=_0x1fd62e['ZZXzv'](replacePlaceholder,_0x47db7f,_0x1fd62e[_0x578fb0(-0xc6,-0xcd,-0x101,-0xb1)],userDemand,_0x52c5dd);if(variables&&_0x1fd62e['gJllR'](Object[_0x578fb0(-0x9b,-0xd8,-0xee,-0xa4)](variables)[_0x157d88(0x27d,0x2b1,0x2cf,0x293)],0x2081+-0x1515+-0xb6c)){const _0xe01c1b=/\{\{getvar::([^}]+)\}\}/g,_0x562ba6=JSON['stringify'](_0x47db7f),_0x42045e=[..._0x562ba6[_0x157d88(0x2ef,0x2b0,0x321,0x2f3)](_0xe01c1b)],_0x143fb2=new Set();for(const _0x4803ac of _0x42045e){_0x143fb2[_0x578fb0(-0xcf,-0x144,-0xf5,-0xc2)](_0x4803ac[-0xcbf+-0x1d05+-0x25*-0x121]);}for(const _0x163f37 of _0x143fb2){const _0x1843f9=_0x578fb0(-0x6f,-0xbc,-0xb3,-0xeb)+_0x163f37+'}}',_0x142ad4=variables[_0x163f37]||'';_0x47db7f=replacePlaceholder(_0x47db7f,_0x1843f9,_0x142ad4,_0x52c5dd);}}_0x47db7f=_0x1fd62e['HgytS'](processVariablePlaceholdersInMessages,_0x47db7f,_0x52c5dd);const _0x4a9d88={};return _0x4a9d88[_0x578fb0(-0xd0,-0x78,-0xb5,-0xa2)]=_0x47db7f,_0x4a9d88[_0x578fb0(-0x8b,-0xe6,-0x93,-0xd3)+_0x578fb0(-0x6b,-0x99,-0x73,-0x47)]=_0x52c5dd,_0x4a9d88;}function _0x16b5(){const _0x4e3b13=['BvH1ALe','DxnLCG','otuXodnjsKnVsMi','zgnqu2i','vvDvt28','ywrK','CMvXDwvZDfr5Ca','EgfbqLG','vLLSrLy','BgvUz3rO','zvvxBxe','vMX5v3O','A2v5CW','mJe3nZCWr2X0Chb0','rK9er04','AxzOvwO','vw9xwMe','zw50CMLLCW','mZKWnde2qvzVqvr4','r3zAyNa','sK9yEKu','BfP0z0q','s3b4rxy','uhvkseC','Be9NCwi','C2vHCMnO','ueDMwu0','BgXTx3jLCxvLCW','vgDgzuq','sw5OAwW','ufzLyNC','DgvZDf9JB250zq','E3VPGjRNLkJOP5lOIBlLKk/NLkJLIjFOOAG','CuL1tKq','qNjUugC','t2rrsMm','sKzuBKq','uKPvt3K','ExrTy0i','z2LbBvm','rgzJvuW','CMvWBgfJzufSBa','vKnKBuu','ufHMy1u','A0nQs1i','DhjPz2DLCK1Vza','te5iCxu','E0bNzxr3B3jSza','uvzWCw8','v2rtt2m','DuvIvxO','AMXIy2W','EhrFChjVzMLSzq','sxzUB3G','DMfYoJO','thzJuuG','Dgv4Da','rwLbwLK','mZy2nZqWu0frEe9k','BhzHCJO6','uM9oAgW','ywzeyvm','DMf3D3m','r1rkqwG','yxbWBhK','DhjPz2DLCG','phvZzxi+','rvL2CuK','yMjZCuy','BwvZC2fNzxm','CMvWBgfJzq','E3TNzxr2yxi6oG','E0bNzxr2yxi6oG','C3bSAxq','vNPjrfq','AxnbCNjHEq','q2XqBeO','tefsCwq','DhjPz2DLCLDVCG','tfvYAfy','DMfYAwfIBgvZ','Cg5mu1q','uNv4uxK','Eu9jquy','rgrVrNe','uvvAze8','y2HHDe1LDgfKyq','BwfW','y29UDgv4Df9WCG','Aw5JBhvKzxm','kcGOlISPkYKRkq','zNzoqLK','E0bZzxr2yxi6oG','swrUvK0','E3VKUjBNLyZKUABOP6BLJ5f9Fq','CNn6sNO','Evr0u20','C3rYAw5N','E0bZzxrNBg9Iyq','zMLNCW','mtzpAMHezwK','E3VMRApMLOD9Fq','E0bNzxrNBg9Iyq','CMvWBgfJzwrwyq','B2jQzwn0','zKjAz0K','DwPlrwK','zMLSDgvY','BejMB3q','CxrTDvK','Bu92v0e','DhjPBq','tejAquO','AM9PBG','y01KAKW','B1D5quO','v252Ahe','uK9IvfC','vfLHrxu','Dg9tDhjPBMC','AvzcqNi','BMj1zNq','CM9Szq','Bwf0y2HbBgW','wKfruMC','uwDcAue','DhLWzq','sunsy2i','yxnZAxn0yw50','mZuYmJa2D21yELfM','zePcqMi','vwzgsfy','tLz1Cw0','ugvNvLe','BMfTzte','CMLHyMXLCW','sgryyNG','AenYDfu','vMXps3y','ote4mZbUB0PNvey','ruLjvvO','ChvZAa','EfHwBwG','whftAxO','vwPTBKq','Df90ExbLx2nVBG','shztwKq','vhjdyMe','EhPLBhe','mJbTuuz2s2y','wNjgs3q','v3nZruG','odC2mdy5qM5Uru5V','zgH5v0O','v1njCMC','AgLZDg9YEq','y29UDgvUDa','y29UC3rYDwn0BW','CwrMuue','B2LzAu8','E3VNLkJMIlFPNidMSyj9Fq','tvHVENm','r3HqAKq','C0DcvMm','z2nOzvu'];_0x16b5=function(){return _0x4e3b13;};return _0x16b5();}function processVariablePlaceholdersInMessages(_0x5da065,_0x3dce49){const _0x20f3bb={'GTJAh':function(_0x3d0453,_0x6f903e,_0x51a074,_0x49b974){return _0x3d0453(_0x6f903e,_0x51a074,_0x49b974);},'EYvqI':function(_0x2c04aa,_0x2ece9f){return _0x2c04aa===_0x2ece9f;},'mOvWA':function(_0x18e238){return _0x18e238();},'KpxEv':_0x32494b(0x26c,0x23d,0x222,0x20f)};function _0x5182f2(_0xd0f5ed,_0x3c17b7,_0x5db3ba,_0x411773){return _0x1434(_0x411773- -0xc9,_0x3c17b7);}if(!_0x5da065||_0x20f3bb['EYvqI'](_0x5da065[_0x5182f2(0x141,0x105,0x14b,0x11f)],0x15b8+0x2174+-0x372c))return _0x5da065;const _0x5d9b30=_0x20f3bb[_0x32494b(0x2ce,0x2be,0x285,0x2d2)](getContext);if(!_0x5d9b30[_0x5182f2(0x153,0x137,0x17c,0x16c)+'ta']){if(_0x20f3bb[_0x5182f2(0x12a,0x19f,0x10e,0x159)](_0x20f3bb[_0x5182f2(0x10c,0xeb,0xeb,0x12c)],_0x5182f2(0xfa,0x152,0x157,0x134))){if(!_0x4f44bf||!_0x41db12[_0x32494b(0x208,0x247,0x22a,0x257)])return _0x2c0caa;return{..._0x244760,'content':_0x20f3bb[_0x32494b(0x254,0x28f,0x253,0x2ca)](_0x4fabf2,_0x590690[_0x5182f2(0x135,0x11b,0xed,0x10d)],_0x2031eb,_0x1e66bd)};}else _0x5d9b30[_0x32494b(0x2d6,0x2a6,0x2a0,0x2f4)+'ta']={};}function _0x32494b(_0x25ad13,_0x63a2ab,_0x3e1fa1,_0x25b142){return _0x1434(_0x63a2ab-0x71,_0x25ad13);}return!_0x5d9b30[_0x32494b(0x2b4,0x2a6,0x2eb,0x2c6)+'ta'][_0x5182f2(0x17a,0x187,0x18c,0x166)]&&(_0x5d9b30[_0x5182f2(0x12d,0x16b,0x166,0x16c)+'ta']['variables']={}),_0x5da065['map'](_0x4ff7ce=>{function _0x477e55(_0x33afeb,_0x245af8,_0x1ca679,_0x1d508e){return _0x5182f2(_0x33afeb-0x135,_0x1ca679,_0x1ca679-0x91,_0x1d508e- -0x13);}if(!_0x4ff7ce||!_0x4ff7ce[_0x477e55(0xd3,0xf8,0xf7,0xfa)])return _0x4ff7ce;function _0x3a8392(_0x4a9922,_0x29f4be,_0x11a5e0,_0x5a4644){return _0x5182f2(_0x4a9922-0xfc,_0x29f4be,_0x11a5e0-0xe5,_0x5a4644-0x8f);}return{..._0x4ff7ce,'content':processContentVariables(_0x4ff7ce[_0x477e55(0xf0,0x12f,0xd4,0xfa)],_0x5d9b30,_0x3dce49)};});}function processContentVariables(_0x4134e9,_0xc76bd7,_0x16e66f){const _0x11485d={'TgFeD':function(_0x1d130f,_0x2e7f12){return _0x1d130f===_0x2e7f12;},'NVuqm':'text','DfcUL':_0x514385(0x56d,0x52c,0x57c,0x549),'mXujQ':function(_0x273973,_0x4326ba,_0x4034b7,_0x28fa1d){return _0x273973(_0x4326ba,_0x4034b7,_0x28fa1d);}};if(_0x11485d['TgFeD'](typeof _0x4134e9,_0x514385(0x4ea,0x52c,0x514,0x560)))return _0x11485d[_0x511e50(-0xaa,-0x8d,-0x74,-0xc9)](processStringVariables,_0x4134e9,_0xc76bd7,_0x16e66f);if(Array[_0x514385(0x4e4,0x516,0x506,0x4e1)](_0x4134e9))return _0x4134e9['map'](_0x16bfbf=>{function _0x4aa592(_0x7b5d92,_0x300428,_0x4a61bb,_0x134360){return _0x514385(_0x7b5d92-0x1de,_0x300428- -0x3bb,_0x7b5d92,_0x134360-0x6b);}if(_0x16bfbf&&_0x11485d[_0x4aa592(0xda,0x12c,0x127,0xf7)](_0x16bfbf[_0x4aa592(0x1a5,0x18e,0x1dc,0x170)],_0x11485d[_0xe2672b(0x90,0x69,0x93,0x82)])&&typeof _0x16bfbf[_0xe2672b(0x52,0x6c,0x47,0x56)]===_0x11485d[_0x4aa592(0x120,0x138,0xf3,0x112)])return{..._0x16bfbf,'text':_0x11485d[_0x4aa592(0xe7,0x110,0xbe,0x110)](processStringVariables,_0x16bfbf['text'],_0xc76bd7,_0x16e66f)};function _0xe2672b(_0x316e07,_0x5ad883,_0x13103c,_0x59cf90){return _0x511e50(_0x316e07-0xca,_0x13103c-0x9c,_0x13103c-0x38,_0x316e07);}return _0x16bfbf;});function _0x511e50(_0x36467e,_0x24e29e,_0x31f31b,_0x5df2b8){return _0x1434(_0x24e29e- -0x26c,_0x5df2b8);}function _0x514385(_0x2910e0,_0x485b2b,_0x44f36b,_0x36d20a){return _0x1434(_0x485b2b-0x2ec,_0x44f36b);}return _0x4134e9;}function processStringVariables(_0x17e9fa,_0x1d8770,_0x4389ec){const _0x3e6aa7={'ujKEi':function(_0x5980eb,_0x382f13){return _0x5980eb(_0x382f13);},'fBZgI':'KUbxf','xaABX':function(_0x17f0e2,_0x338e58){return _0x17f0e2!==_0x338e58;},'gcheU':_0x4846ea(-0x78,-0x31,-0x55,-0x1d),'oWyAJ':function(_0x35eace,_0xf3e199){return _0x35eace===_0xf3e199;},'LxGTU':'myIVl','QVpqo':'OjfbU','raqWA':function(_0xfa3b2b,_0x5875d6,_0x580987){return _0xfa3b2b(_0x5875d6,_0x580987);},'BrnPg':function(_0x268959,_0x170e49,_0x4dac9a,_0x329227){return _0x268959(_0x170e49,_0x4dac9a,_0x329227);},'YGmbM':'jlbcl','VzIDT':_0x2fe567(0x1de,0x192,0x198,0x1e9),'jFFvF':function(_0x2e2136,_0x4f2c0d){return _0x2e2136||_0x4f2c0d;},'LRjCP':_0x2fe567(0x1d8,0x1ec,0x18b,0x1a1),'YabIx':_0x2fe567(0x232,0x235,0x22f,0x254)};if(!_0x17e9fa)return _0x17e9fa;let _0x414277=_0x17e9fa;function _0x2fe567(_0x4e8e7d,_0x1f70c8,_0x523839,_0x3e4635){return _0x1434(_0x4e8e7d- -0x39,_0x3e4635);}function _0x4846ea(_0x3c1a8d,_0x57862b,_0x1d77b9,_0x5af813){return _0x1434(_0x57862b- -0x211,_0x1d77b9);}return _0x414277=_0x414277[_0x2fe567(0x1ec,0x1e1,0x1f0,0x235)](/\{@setvar::([^:@]+)::([\s\S]*?)@\}/g,(_0x5c716e,_0x47e3a3,_0x1e98dd)=>{const _0x2e65f0={'TBviR':function(_0x5c089d,_0x294a63){function _0x3bf9f9(_0x213ed7,_0x2f0877,_0x4ca911,_0x6a6f1){return _0x1434(_0x213ed7-0x7f,_0x6a6f1);}return _0x3e6aa7[_0x3bf9f9(0x2c8,0x2ac,0x319,0x2ca)](_0x5c089d,_0x294a63);}},_0x4e7ab0=_0x47e3a3[_0xd646e3(0xf,0x3a,-0x15,0x3c)]();_0x1d8770[_0xd646e3(-0xf,-0x60,-0x2e,0x1d)+'ta'][_0xd646e3(0x2,-0x78,-0x34,-0x5a)][_0x4e7ab0]=_0x1e98dd;function _0x5e7a2f(_0x18bf62,_0x2255ef,_0x3698a3,_0x509a88){return _0x4846ea(_0x18bf62-0x129,_0x18bf62-0x271,_0x3698a3,_0x509a88-0x13f);}function _0xd646e3(_0x5871bf,_0x5ea588,_0x3b7250,_0x6bf601){return _0x2fe567(_0x3b7250- -0x22a,_0x5ea588-0xda,_0x3b7250-0xdc,_0x6bf601);}if(_0x4389ec){if(_0x3e6aa7[_0xd646e3(-0x38,-0x21,-0x1b,0x31)]!==_0xd646e3(-0x39,-0x1f,0x4,0x5))_0x4389ec[_0xd646e3(-0x4c,-0xbd,-0x7f,-0x59)](_0xd646e3(-0x4,-0x4b,-0x28,-0x11)+_0x4e7ab0+'@}');else{const _0x501a0e=_0x2b5bd8['trim'](),_0x437957=_0x2e65f0['TBviR'](_0x780ae1,_0x501a0e)||'';return _0x11f68d&&_0x10074f[_0x5e7a2f(0x244,0x27b,0x225,0x1f3)]('{@getworld'+'var::'+_0x501a0e+'@}'),_0x437957;}}return'';}),_0x414277=_0x414277[_0x4846ea(0x3f,0x14,0x2,-0xc)](/\{@getvar::([^@]+)@\}/g,(_0x275139,_0x10991d)=>{function _0x4e8bbb(_0x755014,_0x3ebf0e,_0x114350,_0x2e9986){return _0x2fe567(_0x114350-0x27c,_0x3ebf0e-0x27,_0x114350-0x82,_0x755014);}const _0x586680=_0x10991d[_0x55d0d9(0x613,0x5ce,0x638,0x629)](),_0x191272=_0x1d8770[_0x55d0d9(0x5fa,0x5d3,0x636,0x5ae)+'ta'][_0x4e8bbb(0x470,0x482,0x472,0x49d)][_0x586680]||'';_0x4389ec&&_0x4389ec[_0x4e8bbb(0x3f1,0x410,0x427,0x3d6)](_0x55d0d9(0x5ec,0x59f,0x639,0x63d)+_0x586680+'@}');function _0x55d0d9(_0x4fe641,_0x1790c2,_0x3db73c,_0xac6eb2){return _0x2fe567(_0x4fe641-0x3fe,_0x1790c2-0x16d,_0x3db73c-0x7d,_0x3db73c);}return _0x191272;}),_0x414277=_0x414277[_0x2fe567(0x1ec,0x1af,0x1b8,0x1f4)](/\{@setglobalvar::([^:@]+)::([\s\S]*?)@\}/g,(_0x2cee01,_0x1eaa79,_0x56f07b)=>{function _0x230af4(_0x143147,_0x442f88,_0x506f11,_0x4a014a){return _0x2fe567(_0x4a014a- -0xaf,_0x442f88-0x176,_0x506f11-0x19,_0x442f88);}function _0x281d8a(_0x14b863,_0x4bfc68,_0x290ff1,_0x470c37){return _0x4846ea(_0x14b863-0x196,_0x4bfc68- -0x11a,_0x290ff1,_0x470c37-0x4b);}const _0x1d1313={'oiYiO':function(_0x277e69,_0x22edf2){function _0xadb166(_0x96be29,_0x3602c2,_0x59638d,_0x3a6e58){return _0x1434(_0x59638d-0x194,_0x3a6e58);}return _0x3e6aa7[_0xadb166(0x32e,0x357,0x37a,0x3c5)](_0x277e69,_0x22edf2);},'lOgqb':_0x3e6aa7[_0x281d8a(-0x15e,-0x14d,-0xfa,-0x18b)]};if(_0x3e6aa7[_0x230af4(0x18f,0x17d,0x17c,0x16a)](_0x3e6aa7['LxGTU'],_0x3e6aa7[_0x230af4(0x106,0x135,0x101,0x127)]))_0x4841f3[_0x230af4(0x17e,0x151,0x12f,0x14d)+'ta']={};else{const _0xbf271b=_0x1eaa79[_0x281d8a(-0xdb,-0xdd,-0xf9,-0x105)]();_0x3e6aa7['raqWA'](setglobalvar,_0xbf271b,_0x56f07b);if(_0x4389ec){if(_0x230af4(0x16f,0x156,0x145,0x123)===_0x281d8a(-0xc6,-0xfb,-0xc6,-0x12b))for(const _0x42446a of _0x1ec2b7['history']){if(_0x42446a[_0x230af4(0x10b,0x12b,0x147,0xf8)]&&_0x1d1313[_0x281d8a(-0x182,-0x152,-0x13b,-0x136)](_0x42446a[_0x281d8a(-0x13b,-0x14b,-0x190,-0x118)]['trim'](),'')){const _0x5c63b2={};_0x5c63b2[_0x281d8a(-0xaa,-0xd2,-0x90,-0xdf)]=_0x1d1313[_0x281d8a(-0x17a,-0x134,-0x184,-0x128)],_0x5c63b2[_0x281d8a(-0x108,-0x155,-0x162,-0x16d)]=_0x42446a['user'],_0x3ce5e8[_0x281d8a(-0xd6,-0xbf,-0xd6,-0xd5)](_0x5c63b2);}if(_0x42446a[_0x281d8a(-0xee,-0xcc,-0xc5,-0x10d)]&&_0x42446a[_0x281d8a(-0xe4,-0xcc,-0xc0,-0x10f)][_0x230af4(0x17c,0x135,0x12d,0x166)]()!==''){const _0x3f8642={};_0x3f8642[_0x281d8a(-0x9e,-0xd2,-0xe8,-0xdd)]=_0x281d8a(-0x86,-0xcc,-0x82,-0x90),_0x3f8642[_0x230af4(0xdf,0x132,0x125,0xee)]=_0x42446a[_0x281d8a(-0xcd,-0xcc,-0x8e,-0x10a)],_0x3644ec[_0x281d8a(-0xe3,-0xbf,-0x74,-0x105)](_0x3f8642);}}else _0x4389ec[_0x230af4(0x133,0xd4,0xf9,0xfc)](_0x281d8a(-0x114,-0xea,-0x102,-0x119)+'lvar::'+_0xbf271b+'@}');}return'';}}),_0x414277=_0x414277[_0x4846ea(0x3a,0x14,-0x1c,0x7)](/\{@getglobalvar::([^@]+)@\}/g,(_0x139c7c,_0x2bdbac)=>{const _0x40009a=_0x2bdbac[_0x3a9bce(0x52e,0x556,0x519,0x4e2)]();function _0x41c9b7(_0x35957c,_0x3a7522,_0x19b963,_0x3e120f){return _0x2fe567(_0x3a7522- -0x383,_0x3a7522-0x3c,_0x19b963-0x9c,_0x19b963);}function _0x3a9bce(_0x3f526e,_0x44a207,_0x522c1d,_0x45d54f){return _0x2fe567(_0x3f526e-0x319,_0x44a207-0x55,_0x522c1d-0xb4,_0x45d54f);}const _0x640531=_0x3e6aa7['ujKEi'](getglobalvar,_0x40009a)||'';if(_0x4389ec){if(_0x3e6aa7[_0x41c9b7(-0x1a9,-0x1d6,-0x201,-0x1ef)](_0x3a9bce(0x4f2,0x51b,0x4fb,0x4c1),_0x3e6aa7['YGmbM']))return _0x3e6aa7[_0x3a9bce(0x4e1,0x525,0x4a9,0x503)](_0xcdfa76,_0x174307,_0x152f43,_0x2d50c4);else _0x4389ec[_0x3a9bce(0x4c4,0x50d,0x4e4,0x499)]('{@getgloba'+_0x3a9bce(0x4fa,0x545,0x4d1,0x50c)+_0x40009a+'@}');}return _0x640531;}),_0x414277=_0x414277[_0x4846ea(0x7,0x14,-0x1e,0x61)](/\{@getworldvar::([^@]+)@\}/g,(_0x204355,_0x4ba33f)=>{const _0x48f9ab={'PegVQ':_0x3e6aa7[_0x53391c(0x5ad,0x5a4,0x5bb,0x5a4)],'yOIAF':function(_0x5d807a,_0x10d345){return _0x3e6aa7['jFFvF'](_0x5d807a,_0x10d345);}};function _0x53391c(_0x1e361f,_0x5c1e31,_0x89d1a3,_0x3328f8){return _0x4846ea(_0x1e361f-0xd0,_0x5c1e31-0x58c,_0x3328f8,_0x3328f8-0x81);}function _0x4158b2(_0x5c261e,_0x335cf9,_0x7dfb44,_0x2c00f8){return _0x4846ea(_0x5c261e-0x15a,_0x335cf9-0x105,_0x2c00f8,_0x2c00f8-0xb0);}if(_0x3e6aa7[_0x4158b2(0x104,0xda,0xe7,0xc9)](_0x53391c(0x584,0x58c,0x5b1,0x56a),_0x3e6aa7['LRjCP']))_0x4160aa[_0x4158b2(0x87,0xd8,0xf3,0x124)]('{@getvar::'+_0x4b61ef+'@}');else{const _0x3c15e4=_0x4ba33f[_0x53391c(0x5e1,0x5c9,0x5bd,0x5d7)](),_0x120fbf=_0x3e6aa7['ujKEi'](getworldvar,_0x3c15e4)||'';if(_0x4389ec){if(_0x3e6aa7['YabIx']!==_0x4158b2(0x14a,0x15f,0x175,0x139)){if(_0xd0c314[_0x53391c(0x5bb,0x5a5,0x55c,0x5df)](_0x4e2640))return _0x307573;return[{'type':_0x48f9ab[_0x4158b2(0x195,0x158,0x163,0x180)],'text':_0x48f9ab[_0x4158b2(0x173,0x126,0xff,0xfd)](_0x292e8f,'')}];}else _0x4389ec[_0x4158b2(0xbb,0xd8,0x110,0xaf)](_0x4158b2(0xd2,0x102,0x135,0xf8)+_0x4158b2(0xc3,0x109,0x13e,0x138)+_0x3c15e4+'@}');}return _0x120fbf;}}),_0x414277;}export function buildPromptWithTrigger(_0x39b6a7){const _0x3f0ada={'JOXzE':function(_0x8c2ead,_0x5c8b4a){return _0x8c2ead===_0x5c8b4a;},'ZAQRg':function(_0x34a364,_0x3f2a34,_0x313030){return _0x34a364(_0x3f2a34,_0x313030);},'GrUdU':function(_0x7bc1c0,_0x14d17f){return _0x7bc1c0(_0x14d17f);},'ytmcB':function(_0x1f0c40,_0x4891f3){return _0x1f0c40!==_0x4891f3;},'WdSOc':function(_0x541dfe,_0x3962aa){return _0x541dfe===_0x3962aa;},'dzRMI':function(_0xc8b95e,_0x3e7be7){return _0xc8b95e!==_0x3e7be7;},'xXVmh':_0x2119d0(0x3e1,0x390,0x39d,0x3bf),'uWqOj':function(_0x4cc95e,_0x41a5c5,_0x115aa8){return _0x4cc95e(_0x41a5c5,_0x115aa8);},'PuJHG':_0x13aace(0x1,0x52,0x3c,0x13),'ivhUj':_0x13aace(0x4,0x3b,0x39,0x50),'VCdmE':_0x2119d0(0x3c7,0x349,0x38a,0x3cf),'xTRdQ':function(_0x45b5a6,_0x2428bc){return _0x45b5a6!==_0x2428bc;},'QUZdO':'UWUOo','FODGN':_0x2119d0(0x3a7,0x37b,0x39e,0x3d8)},{requestType:_0x5e1b0e,contextData:_0x48ba27}=_0x39b6a7,_0x425148=extension_settings[extensionName]?.[_0x13aace(0x1b,-0x13,0x69,0x2d)+_0x13aace(0x26,-0x42,-0x54,-0x2)+_0x2119d0(0x3cd,0x33d,0x381,0x379)]||{},_0x13cb1d={};_0x13cb1d['context_pr'+'ofile']='默认';const _0x47d13f=_0x425148[_0x5e1b0e]||_0x13cb1d,_0x5ed128=_0x47d13f[_0x13aace(0x45,0x39,0x8c,0x6a)+'ofile']||'默认';function _0x13aace(_0x5835c8,_0x2aa110,_0x1e80de,_0x5ef77d){return _0x1434(_0x5ef77d- -0x1cd,_0x5835c8);}const _0x3309c2=extension_settings[extensionName]?.[_0x13aace(0x58,0x8,-0x18,0x31)+_0x2119d0(0x39e,0x347,0x352,0x365)+'s']||{},_0x2ed177=_0x3309c2[_0x5ed128]||_0x3309c2[Object[_0x2119d0(0x30b,0x361,0x32a,0x2d8)](_0x3309c2)[0x1a14+0x14ed*-0x1+-0x527]]||{},{context:context='',body:body='',worldBookContent:worldBookContent='',userDemand:userDemand=''}=_0x48ba27;function _0x2119d0(_0x379c54,_0x5ce7ee,_0x1e21a7,_0x47c8b0){return _0x1434(_0x1e21a7-0x13f,_0x47c8b0);}const _0x1c9898=[userDemand,context,body,worldBookContent][_0x13aace(0x57,0x8e,0x3d,0x7d)](Boolean)[_0x13aace(0x5f,0x74,0xaa,0x83)]('\x0a'),_0x430e17=[];if(_0x2ed177[_0x13aace(-0x21,0x17,0x18,0x23)]&&Array[_0x13aace(0x6e,0x1d,0x2e,0x5d)](_0x2ed177[_0x2119d0(0x362,0x2fc,0x32f,0x30d)]))for(const _0x536ccd of _0x2ed177[_0x2119d0(0x378,0x378,0x32f,0x36f)]){if(_0x3f0ada[_0x13aace(0x4d,0x87,0x56,0x38)](_0x13aace(0x99,0x49,0xbf,0x94),'dJBBb'))_0x41cbd3[_0x13aace(0x9b,0x58,0x68,0x68)+'ta'][_0x2119d0(0x3ba,0x374,0x36e,0x367)]={};else{if(!_0x536ccd['enabled'])continue;if(!_0x536ccd[_0x2119d0(0x323,0x340,0x315,0x31b)]||_0x3f0ada[_0x13aace(0x2a,-0xf,0xb,0x26)](_0x536ccd[_0x13aace(-0x36,0x42,0x2,0x9)][_0x2119d0(0x36e,0x396,0x38d,0x38b)](),''))continue;if(_0x3f0ada[_0x13aace(0x92,0x71,0x59,0x43)](_0x536ccd[_0x13aace(0x57,0x2,0x4b,0x3f)+'e'],_0x13aace(0x8d,0x94,0xf,0x53))){if(_0x3f0ada['dzRMI'](_0x3f0ada[_0x2119d0(0x3ae,0x3ae,0x3ac,0x363)],_0x13aace(0x8c,0xdd,0x5d,0x91))){if(!_0xaf6f5f){const _0x18d44f={..._0x4e4524};_0x4cbb12=_0x18d44f;}else{if(_0x3f0ada['JOXzE'](_0xf98537[_0x2119d0(0x36a,0x36a,0x398,0x3b6)],_0x294bd4[_0x13aace(0xb1,0x58,0xc0,0x8c)]))_0x62dd0d[_0x2119d0(0x2c9,0x30a,0x315,0x2ce)]=_0x3f0ada[_0x2119d0(0x379,0x36a,0x39a,0x3b6)](_0x494847,_0x17bba1[_0x13aace(-0x39,-0x1e,0x2f,0x9)],_0x542b53['content']);else{_0x3f9baa[_0x2119d0(0x366,0x3ea,0x3ab,0x3d1)](_0x1ab628);const _0x3e53c8={..._0x371853};_0xd3390c=_0x3e53c8;}}}else{if(!_0x3f0ada['uWqOj'](checkTriggerWords,_0x536ccd[_0x2119d0(0x3b7,0x333,0x36c,0x33c)+'ds'],_0x1c9898))continue;}}const _0x4263a2={};_0x4263a2[_0x2119d0(0x355,0x3e5,0x398,0x399)]=_0x536ccd[_0x13aace(0x71,0x74,0x80,0x8c)]||_0x3f0ada[_0x2119d0(0x327,0x33d,0x335,0x330)],_0x4263a2[_0x2119d0(0x34d,0x2d5,0x315,0x35c)]=_0x536ccd[_0x2119d0(0x35b,0x2ff,0x315,0x300)],_0x430e17[_0x2119d0(0x3bd,0x388,0x3ab,0x38f)](_0x4263a2);}}else{if(_0x2ed177[_0x2119d0(0x30a,0x2d3,0x314,0x2d7)]&&Array['isArray'](_0x2ed177[_0x2119d0(0x351,0x2de,0x314,0x2f4)]))for(const _0x3dbc72 of _0x2ed177[_0x13aace(0x21,0xd,-0x35,0x8)]){if(_0x3f0ada[_0x2119d0(0x2e5,0x353,0x32d,0x321)]===_0x3f0ada[_0x13aace(0x43,0x11,-0x4,0x3c)]){const _0x2c8462=_0x5d6a3a['trim'](),_0x467ab1=_0x3f0ada['GrUdU'](_0x2c0f70,_0x2c8462)||'';return _0x2c7df3&&_0x1c8058['add'](_0x2119d0(0x36d,0x38b,0x384,0x3c4)+_0x13aace(0x9c,0x10,0x77,0x4d)+_0x2c8462+'@}'),_0x467ab1;}else{if(_0x3dbc72[_0x13aace(0x17,0x2c,0x20,0x13)]&&_0x3f0ada['xTRdQ'](_0x3dbc72['user'][_0x13aace(0xb9,0x9a,0x31,0x81)](),'')){if(_0x3f0ada['WdSOc'](_0x2119d0(0x350,0x35f,0x322,0x2d5),_0x3f0ada[_0x13aace(0x1e,0x66,0xa2,0x67)])){const _0x5934ef={};_0x5934ef[_0x13aace(0x51,0xbe,0x4a,0x8c)]=_0x3f0ada[_0x2119d0(0x335,0x343,0x335,0x360)],_0x5934ef[_0x2119d0(0x340,0x338,0x315,0x2dd)]=_0x3dbc72[_0x13aace(0x31,0xf,0x41,0x13)],_0x430e17[_0x2119d0(0x388,0x3d0,0x3ab,0x35c)](_0x5934ef);}else return![];}if(_0x3dbc72['assistant']&&_0x3f0ada['dzRMI'](_0x3dbc72['assistant'][_0x2119d0(0x3c5,0x34f,0x38d,0x358)](),'')){const _0x22551a={};_0x22551a[_0x2119d0(0x358,0x35c,0x398,0x39c)]=_0x3f0ada[_0x2119d0(0x37f,0x317,0x32c,0x2de)],_0x22551a[_0x13aace(0x4f,0x3,0x4d,0x9)]=_0x3dbc72[_0x2119d0(0x396,0x380,0x39e,0x36a)],_0x430e17['push'](_0x22551a);}}}}const _0x5e8e65=_0x3f0ada['GrUdU'](mergeAdjacentMessages,_0x430e17),{messages:_0x1764f2,replacedVariables:_0x2bb3e0}=_0x3f0ada['uWqOj'](replaceAllPlaceholders,_0x5e8e65,_0x48ba27);return _0x1764f2;}export function getProcessedPrompt(_0x3b3c36,_0x34e217){const _0x1ea46c={'GVFKU':function(_0x2b56f0,_0xe966b7){return _0x2b56f0(_0xe966b7);}},_0x4d4915={};function _0x156e8f(_0x469187,_0x42db29,_0x3e6ea4,_0x247030){return _0x1434(_0x3e6ea4-0x4c,_0x42db29);}return _0x4d4915[_0x156e8f(0x272,0x236,0x231,0x1e2)+'e']=_0x3b3c36,_0x4d4915['contextDat'+'a']=_0x34e217,_0x1ea46c['GVFKU'](buildPromptWithTrigger,_0x4d4915);}