(function(_0x51c68a,_0x5722ee){function _0x5426c0(_0x59d7d3,_0x1c2d72,_0x30f8d5,_0x3bd46c){return _0x53ff(_0x59d7d3-0x30f,_0x3bd46c);}const _0x3d0e9d=_0x51c68a();function _0x3f993e(_0x47c608,_0x381799,_0x20489a,_0x2c2448){return _0x53ff(_0x20489a-0x224,_0x2c2448);}while(!![]){try{const _0x4dbb63=parseInt(_0x3f993e(0x465,0x435,0x46f,0x4c9))/(-0x6*0x2cc+0x792+0x151*0x7)+-parseInt(_0x3f993e(0x43e,0x499,0x471,0x44d))/(-0xd3*0x11+0xade+0x327)*(-parseInt(_0x3f993e(0x43c,0x3fa,0x423,0x3cf))/(0x1847+0x18db+0x9d3*-0x5))+-parseInt(_0x5426c0(0x589,0x5e7,0x542,0x5bd))/(0x1*0x75b+0x1*-0xca7+-0x50*-0x11)+-parseInt(_0x3f993e(0x467,0x440,0x41e,0x3c3))/(0x1403+0x1bf7*-0x1+0x7f9)+parseInt(_0x3f993e(0x44d,0x45a,0x46b,0x491))/(-0xb95+-0x4b5+-0x9*-0x1d0)*(-parseInt(_0x3f993e(0x3c3,0x3a9,0x404,0x3a7))/(0x6c5*-0x1+-0x14b*0x1e+-0x30a*-0xf))+parseInt(_0x5426c0(0x520,0x4da,0x558,0x522))/(-0x6e6*0x5+0x2391+-0x1*0x10b)+parseInt(_0x5426c0(0x55f,0x5aa,0x5b8,0x578))/(-0x1*-0x1770+-0x20ea+0x983*0x1);if(_0x4dbb63===_0x5722ee)break;else _0x3d0e9d['push'](_0x3d0e9d['shift']());}catch(_0x335853){_0x3d0e9d['push'](_0x3d0e9d['shift']());}}}(_0x16ec,0x1*0x12a897+-0x1e876+-0x4cff0));const _0x9908e9=(function(){let _0x4efe99=!![];return function(_0x2ddea3,_0x21c4ef){const _0x341dc1=_0x4efe99?function(){function _0x20051f(_0x527f83,_0x54ecf3,_0x401ed1,_0x3f66c0){return _0x53ff(_0x54ecf3- -0x21d,_0x527f83);}if(_0x21c4ef){const _0x101a8a=_0x21c4ef[_0x20051f(0x7a,0x3e,0x81,0x1a)](_0x2ddea3,arguments);return _0x21c4ef=null,_0x101a8a;}}:function(){};return _0x4efe99=![],_0x341dc1;};}()),_0x4f1555=_0x9908e9(this,function(){function _0x6eaf28(_0x22ff60,_0x567f39,_0x10f7f4,_0x4f23be){return _0x53ff(_0x567f39- -0xfd,_0x10f7f4);}const _0x18531d={};_0x18531d[_0x281cb6(0x5b6,0x5d3,0x575,0x58d)]='(((.+)+)+)'+'+$';function _0x281cb6(_0x2963a4,_0x12c47d,_0x112718,_0x206c9e){return _0x53ff(_0x2963a4-0x364,_0x206c9e);}const _0x5aed4c=_0x18531d;return _0x4f1555[_0x281cb6(0x598,0x5ec,0x5cc,0x566)]()[_0x281cb6(0x5a2,0x5f1,0x5f8,0x58d)](_0x5aed4c[_0x281cb6(0x5b6,0x614,0x594,0x567)])[_0x6eaf28(0x146,0x137,0x189,0x15f)]()[_0x281cb6(0x597,0x557,0x56e,0x57d)+'r'](_0x4f1555)['search']('(((.+)+)+)'+'+$');});_0x4f1555();function _0x53ff(_0x3c0746,_0x1d0f13){_0x3c0746=_0x3c0746-(0x392*0x9+0x1778+-0x35cb);const _0x990584=_0x16ec();let _0x3b39d7=_0x990584[_0x3c0746];if(_0x53ff['uXxPHE']===undefined){var _0x304b02=function(_0xc6f2c2){const _0x579c92='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x66c84c='',_0x156d75='',_0x353c57=_0x66c84c+_0x304b02;for(let _0x427e45=0x1dc0+-0x18e*-0xd+-0x31f6,_0x145319,_0x29effd,_0x41e81b=0x1d4b+0x20e0+-0x3e2b;_0x29effd=_0xc6f2c2['charAt'](_0x41e81b++);~_0x29effd&&(_0x145319=_0x427e45%(0x229c+-0x800+-0x1a98)?_0x145319*(-0x3ca*-0x1+0x1*-0x1e71+-0x61*-0x47)+_0x29effd:_0x29effd,_0x427e45++%(0x1179+0x177a+-0x28ef))?_0x66c84c+=_0x353c57['charCodeAt'](_0x41e81b+(0xa*0x20b+0x1*0xdd9+-0x5*0x6d9))-(-0x65*-0x5+0x8*0x9a+0x9d*-0xb)!==0x3a5*0x1+0x30b+-0x6b0?String['fromCharCode'](0xd*-0x2a5+-0x1ea3+0x3*0x1601&_0x145319>>(-(0x3*-0x5a5+0x243e+0xb7*-0x1b)*_0x427e45&-0xf09+0x2*-0xcbe+-0x1*-0x288b)):_0x427e45:0x54f+0x168d+-0xdee*0x2){_0x29effd=_0x579c92['indexOf'](_0x29effd);}for(let _0x1d94b2=0x695+-0x24b3+0x1e1e,_0x30d81d=_0x66c84c['length'];_0x1d94b2<_0x30d81d;_0x1d94b2++){_0x156d75+='%'+('00'+_0x66c84c['charCodeAt'](_0x1d94b2)['toString'](0x657+-0x1*-0x53d+0x43*-0x2c))['slice'](-(0x23b6+0x13*-0x11b+-0xeb3));}return decodeURIComponent(_0x156d75);};_0x53ff['GciLKZ']=_0x304b02,_0x53ff['efvanS']={},_0x53ff['uXxPHE']=!![];}const _0x56ab46=_0x990584[0x18ae*-0x1+-0xbca+0x123c*0x2],_0x666303=_0x3c0746+_0x56ab46,_0x13a445=_0x53ff['efvanS'][_0x666303];if(!_0x13a445){const _0x415462=function(_0x4e45cc){this['pFptHG']=_0x4e45cc,this['rHpjnI']=[0x4*0x4e7+-0x1f4e+-0x257*-0x5,-0x1*-0x112e+0xb99+-0x1cc7,0x1*-0x4c1+-0xb03*-0x1+0x2*-0x321],this['wNcgVH']=function(){return'newState';},this['tHkRQt']='\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*',this['eUsWxU']='[\x27|\x22].+[\x27|\x22];?\x20*}';};_0x415462['prototype']['TCTTjf']=function(){const _0x2f4e3a=new RegExp(this['tHkRQt']+this['eUsWxU']),_0x37ec1a=_0x2f4e3a['test'](this['wNcgVH']['toString']())?--this['rHpjnI'][0x7d3*-0x2+0x772*-0x5+0x34e1]:--this['rHpjnI'][0x78b*-0x2+-0x1*-0x378+0x1*0xb9e];return this['GcRZla'](_0x37ec1a);},_0x415462['prototype']['GcRZla']=function(_0x4a5474){if(!Boolean(~_0x4a5474))return _0x4a5474;return this['qFboOc'](this['pFptHG']);},_0x415462['prototype']['qFboOc']=function(_0x40a055){for(let _0x483e4a=0x2*0x1247+0x89*0x45+-0x497b,_0x532d94=this['rHpjnI']['length'];_0x483e4a<_0x532d94;_0x483e4a++){this['rHpjnI']['push'](Math['round'](Math['random']())),_0x532d94=this['rHpjnI']['length'];}return _0x40a055(this['rHpjnI'][0x78b*-0x3+0x237f+-0xcde]);},new _0x415462(_0x53ff)['TCTTjf'](),_0x3b39d7=_0x53ff['GciLKZ'](_0x3b39d7),_0x53ff['efvanS'][_0x666303]=_0x3b39d7;}else _0x3b39d7=_0x13a445;return _0x3b39d7;}import{extension_settings}from'../../../../extensions.js';function _0x16ec(){const _0x48239b=['Aw5JBhvKzxm','CMvWBgfJzq','nJGYnZeYyNfkyvnH','vhbxquC','ywLTuwi','sgrVuuS','wgPSru8','DxvIAKq','CMLHyMXLCW','phvZzxi+','vgLuzNu','BgvUz3rO','rhHbthq','wMfrEhi','weLuC0C','ywrK','DhjPz2DLCG','qwngCKC','BwfW','tefeEuO','AMnmwfK','y29UDgv4Df9WCG','CgTXzgm','Bhf6wgy','rwzyq1q','AhnRywy','rK9pA0O','Bwf0y2HbBgW','wKjsvLy','yvHgALa','AuDOvwW','y29UDgvUDa','uhPJAui','wgPXDgq','vwP6zNK','A1Doyvq','y29UC3rYDwn0BW','Dg9tDhjPBMC','vfPyBe4','CMvWBgfJzwrwyq','DMfYoJO','EKf2AMC','BNDhwue','E3VKUjBNLyZKUABOP6BLJ5f9Fq','yKriD3K','twDgveq','ChLIr3m','C2vHCMnO','ELrMB1m','uLjXvfa','ALHPBwe','z2PjBM4','AxnbCNjHEq','rKTtEuW','BePPqKW','wfzXwgW','mtm4uhLMD05P','tMnRA2K','zMLNCW','CLHIDvm','ntG3mteXtMrnwMnX','yufHsMq','mJu1nZe2yxrmqM9J','BuT4zgi','y2HHDe1LDgfKyq','mtG1ntu4mdrSt1vVz00','Au9et08','whfjq3G','wvHgCLi','BgXTx3jLCxvLCW','Ew5lA3q','E3T1C2vYFx0','vLr4yMG','E3VPGjRNLkJMNi3OO4xLKk/NLkJLIjFOOAG','zw5HyMXLza','AM9PBG','yxbWBhK','s2PmAwq','D0jwEwG','zw50CMLLCW','BMfTzte','s0ffAKi','BLn6ug0','CM9Szq','yxnZAxn0yw50','r1nzCwS','B2jRy3i','CxnAtNq','DhjPBq','rKrpwuO','EKPKyKO','BhzHCJO6','zK56DgO','y3fbt3i','rxDWu0G','vuLQAKG','DNzWBwC','q1fZwMK','AKvcsuy','Cvv2B2y','E0bNzxr2yxi6oG','Dgv4Da','svn5ALG','q3DtAKG','A3neD0G','ChvZAa','E3VMRApMLOD9Fq','mJe2mJuWmhbksgDgAG','v2XTwe8','qNjOB2u','uNj6zNK','zu1NuLi','CvPqs0i','DMfYAwfIBgvZ','DhLWzq','vKPTuMy','BNPhC2C','C3rYAw5N','Aw1bt0e','AgLZDg9YEq','z3PXr1G','s25cDK4','wgDzz0u','Dg56twO','BfDJtw4','tNzdvuS','tffRzwy','vMLZz3O','Ce9wDuC','yM1NCg8','zMLSDgvY','zwrlq1G','txH4BNO','tuzjAfi','CMvXDwvZDfr5Ca','rMfuwKi','AMjTDeC','wu5Zr3y','v1z4z1O','AMv3DMm','E0bZzxrNBg9Iyq','mJu5mdiXsxbsq0Hf','wez0q2i','E3TNzxr2yxi6oG','swH5ALm','EhrFChjVzMLSzq','Dw9lsu4','s0fID1u','CMT4Dge','yMfRvxG','AMTSvha','E3VKUiRKUiVMLOD9Fq','E3VNLkJMIlFPNidMSyj9Fq','wMDbrvy','CMvWBgfJzufSBa','Df90ExbLx2nVBG','zgXZyuO','E0bNzxr3B3jSza','C3bSAxq','Dg9OExO','vfLOvee','A29QtNy','zvHeAfO','B2zPBgu','vxjmB0G','BwvZC2fNzxm','ze9ZBxC','ntm1nZC5nwjfEvHOEa','E3VPGjRNLkJOP5lOIBlLKk/NLkJLIjFOOAG','E0bNzxrNBg9Iyq','C3rYAw5NAwz5','sufyrg4','mtjkvg1zvfm','BgPNB3y','z2HiC3G','A2v5CW','DxnLCG','E0bZzxr2yxi6oG','s21Nsfu','u3zgCeu','r25PBgm','uNbVs0i','y29UDgv4DerHDa','vKv3B3G','uuXhwui','DgvZDf9JB250zq','zfLAv3i','BKrnvKO'];_0x16ec=function(){return _0x48239b;};return _0x16ec();}import{extensionName}from'./config.js';import{getContext}from'../../../../st-context.js';import{getglobalvar,setglobalvar}from'./chatDataUtils.js';import{getworldvar}from'./worldbookProcessor.js';export function checkTriggerWords(_0x5ac276,_0x37a8cb){function _0xa25726(_0x4357a3,_0x341689,_0x54575c,_0x742d1c){return _0x53ff(_0x341689- -0x3e1,_0x54575c);}const _0x822ed1={};_0x822ed1[_0xa25726(-0x1bb,-0x1e8,-0x18e,-0x1c1)]=function(_0x53f6c4,_0x47fc56){return _0x53f6c4||_0x47fc56;};function _0x359fab(_0x1b6445,_0xebcc81,_0x26a3bf,_0x3fb7f9){return _0x53ff(_0xebcc81-0x207,_0x26a3bf);}_0x822ed1[_0x359fab(0x480,0x48c,0x4cd,0x4ae)]=function(_0x49bf53,_0x1bdf89){return _0x49bf53===_0x1bdf89;},_0x822ed1[_0xa25726(-0x13e,-0x17c,-0x122,-0x17c)]='EkOYn',_0x822ed1[_0xa25726(-0x13f,-0x173,-0x174,-0x193)]=_0xa25726(-0x1bd,-0x20d,-0x22a,-0x245),_0x822ed1['KnBvN']=function(_0x19077d,_0x46df42){return _0x19077d!==_0x46df42;},_0x822ed1[_0xa25726(-0x1db,-0x1d6,-0x1da,-0x1be)]=_0xa25726(-0x1f3,-0x1ef,-0x1a3,-0x20a),_0x822ed1['aAaJd']=_0xa25726(-0x1aa,-0x16f,-0x1bb,-0x1a4);const _0x52823b=_0x822ed1;if(_0x52823b[_0x359fab(0x431,0x400,0x418,0x420)](!_0x5ac276,!_0x37a8cb)){if(_0x52823b[_0x359fab(0x471,0x48c,0x4e0,0x4cd)](_0x52823b[_0xa25726(-0x172,-0x17c,-0x19e,-0x196)],_0x52823b[_0x359fab(0x489,0x475,0x479,0x422)]))_0x6d19a0[_0x359fab(0x40d,0x425,0x403,0x449)](_0x5a2956[-0x1*0x14e3+-0xc74*0x2+0x2dcc]);else return![];}const _0x2ad75d=_0x5ac276[_0x359fab(0x430,0x3f8,0x3d4,0x446)](',')[_0x359fab(0x41c,0x428,0x478,0x43f)](_0x467e9a=>_0x467e9a[_0x359fab(0x48b,0x46e,0x48e,0x41f)]())[_0xa25726(-0x1fc,-0x20c,-0x1b5,-0x217)](_0x405531=>_0x405531);if(_0x52823b['imAOA'](_0x2ad75d[_0x359fab(0x411,0x421,0x411,0x3fc)],-0x6b*-0x21+0x1*-0x34d+0xa7e*-0x1))return _0x52823b[_0xa25726(-0x18a,-0x159,-0x18e,-0x107)](_0x52823b['QLGYB'],_0x52823b[_0x359fab(0x446,0x453,0x466,0x461)])?![]:_0x6b8e07(_0x443d78,_0x57da4a,_0x5b6569);for(const _0x43d1c2 of _0x2ad75d){if(_0x37a8cb[_0x359fab(0x42f,0x416,0x3cc,0x42c)](_0x43d1c2))return!![];}return![];}export function mergeAdjacentMessages(_0x525163){const _0x10fbf7={};_0x10fbf7['EhLEQ']=function(_0x45cffd,_0x39cd4e){return _0x45cffd===_0x39cd4e;},_0x10fbf7[_0x9e069d(0x2de,0x315,0x36a,0x318)]=_0x5bacaa(-0x125,-0x155,-0xed,-0x112),_0x10fbf7['zTfoS']=function(_0x5bb26f,_0x5d304c){return _0x5bb26f===_0x5d304c;},_0x10fbf7[_0x5bacaa(-0x168,-0x100,-0xd5,-0x126)]=function(_0x33c678,_0x4c8298){return _0x33c678===_0x4c8298;},_0x10fbf7[_0x9e069d(0x280,0x2ee,0x2a4,0x2d3)]=_0x5bacaa(-0x189,-0x213,-0x1ae,-0x1c6),_0x10fbf7[_0x9e069d(0x2e2,0x304,0x35c,0x329)]=_0x5bacaa(-0x13a,-0x126,-0xe9,-0x119),_0x10fbf7[_0x9e069d(0x297,0x24b,0x25e,0x2a0)]=function(_0x40464f,_0x5ec21c){return _0x40464f===_0x5ec21c;},_0x10fbf7['VTxbh']=function(_0x1062a0,_0x87fe75){return _0x1062a0!==_0x87fe75;},_0x10fbf7[_0x5bacaa(-0x15d,-0x17b,-0x1a8,-0x16b)]=_0x9e069d(0x2e1,0x29d,0x321,0x2de),_0x10fbf7['dGrXc']=function(_0x21601c,_0x55820e){return _0x21601c===_0x55820e;},_0x10fbf7[_0x5bacaa(-0x15a,-0x132,-0x143,-0x16e)]=_0x9e069d(0x2ec,0x359,0x332,0x320);const _0x3446c7=_0x10fbf7;function _0x5bacaa(_0x2af4bb,_0x9668de,_0x45df06,_0x33c5a9){return _0x53ff(_0x33c5a9- -0x396,_0x9668de);}function _0x9e069d(_0x56cc25,_0x192dcb,_0x242fae,_0xcab836){return _0x53ff(_0xcab836-0xb8,_0x56cc25);}if(!_0x525163||_0x3446c7[_0x5bacaa(-0x174,-0x13a,-0x18e,-0x157)](_0x525163[_0x9e069d(0x2f6,0x2a5,0x2f0,0x2d2)],0x1*-0xe1b+0x211+0xc0a))return _0x3446c7[_0x5bacaa(-0x14c,-0x11e,-0xd2,-0x126)](_0x3446c7['DxALt'],_0x3446c7[_0x9e069d(0x2f4,0x2ad,0x2e1,0x2d3)])?[]:[];const _0x471277=[];let _0x3fb820=null;for(const _0x45ae0d of _0x525163){if(_0x3446c7[_0x9e069d(0x2d0,0x325,0x2eb,0x2f7)](_0x3446c7['jEBIF'],_0x3446c7[_0x9e069d(0x314,0x332,0x355,0x329)])){if(!_0x3fb820){const _0x3fd5c5={..._0x45ae0d};_0x3fb820=_0x3fd5c5;}else{if(_0x3446c7[_0x5bacaa(-0x18e,-0x193,-0x194,-0x1ae)](_0x3fb820[_0x5bacaa(-0x180,-0x190,-0xf3,-0x134)],_0x45ae0d[_0x9e069d(0x2c2,0x2ea,0x32e,0x31a)]))_0x3446c7[_0x5bacaa(-0x141,-0x118,-0x156,-0x13f)](_0x3446c7[_0x5bacaa(-0x1a7,-0x165,-0x11f,-0x16b)],_0x5bacaa(-0x1bd,-0x1b8,-0x1a0,-0x170))?_0x4c4a2a[_0x9e069d(0x310,0x334,0x2f7,0x307)+'ta']={}:_0x3fb820[_0x5bacaa(-0x144,-0x149,-0x176,-0x168)]=mergeContent(_0x3fb820[_0x9e069d(0x2c1,0x2c1,0x2ae,0x2e6)],_0x45ae0d['content']);else{_0x471277[_0x9e069d(0x338,0x32b,0x2e7,0x330)](_0x3fb820);const _0x3bfd6f={..._0x45ae0d};_0x3fb820=_0x3bfd6f;}}}else{const _0x1b809a=_0x3c06b8['apply'](_0x50b96d,arguments);return _0x3422b6=null,_0x1b809a;}}if(_0x3fb820){if(_0x3446c7['dGrXc']('fZOzy',_0x3446c7[_0x9e069d(0x2ee,0x2fa,0x306,0x2e0)])){if(_0x53c647&&_0x3446c7['EhLEQ'](_0x38751b[_0x5bacaa(-0x139,-0xe5,-0x108,-0x115)],_0x9e069d(0x36a,0x372,0x31e,0x32c))&&typeof _0xb9c67b[_0x5bacaa(-0x179,-0x153,-0x13b,-0x122)]===_0x3446c7['KAEjB'])return{..._0x150fae,'text':_0x13570d(_0x466d3e[_0x9e069d(0x33d,0x2ee,0x32b,0x32c)],_0x3765fc,_0x228936)};return _0x4295ed;}else _0x471277[_0x5bacaa(-0x104,-0x16c,-0xf0,-0x11e)](_0x3fb820);}return _0x471277;}function mergeContent(_0x4cd0c8,_0x46bbdf){function _0x39b890(_0x1a6171,_0x5177e1,_0x4b715f,_0x3a0b51){return _0x53ff(_0x4b715f-0x15d,_0x3a0b51);}const _0x544c29={'Mxxnz':_0x233edd(-0x6f,-0x91,-0xa0,-0xca),'zJdbJ':function(_0x367385,_0x48d6df){return _0x367385===_0x48d6df;},'TpWAG':function(_0x5802ff,_0x34c68b){return _0x5802ff!==_0x34c68b;},'ISyjX':_0x39b890(0x34e,0x360,0x37d,0x348),'LQkef':function(_0x3ba508,_0x5f136c){return _0x3ba508+_0x5f136c;},'jcLXY':function(_0x621ee4,_0x315d1a){return _0x621ee4(_0x315d1a);},'pOVuG':function(_0x8dea28,_0x1d38e9){return _0x8dea28(_0x1d38e9);},'RbTej':_0x233edd(-0xa1,-0xee,-0x126,-0xda)};if(typeof _0x4cd0c8===_0x544c29[_0x233edd(-0x145,-0x132,-0x192,-0x177)]&&_0x544c29[_0x39b890(0x3ee,0x3b7,0x3c6,0x39b)](typeof _0x46bbdf,_0x39b890(0x3ba,0x3b6,0x3e1,0x423))){if(_0x544c29[_0x39b890(0x380,0x317,0x36f,0x3b3)](_0x544c29[_0x233edd(-0xc3,-0x103,-0x10f,-0xd9)],_0x544c29[_0x233edd(-0x95,-0xeb,-0xb3,-0xd9)]))_0x40a055&&_0xe712f4[_0x39b890(0x37a,0x36e,0x37b,0x32e)](_0xd46fe);else return _0x544c29['LQkef'](_0x544c29[_0x233edd(-0x131,-0x186,-0x145,-0x17d)](_0x4cd0c8,'\x0a'),_0x46bbdf);}const _0x25279a=_0x544c29[_0x233edd(-0x127,-0x135,-0xd8,-0x12b)](normalizeToArray,_0x4cd0c8),_0x5137b1=_0x544c29[_0x39b890(0x346,0x332,0x330,0x304)](normalizeToArray,_0x46bbdf),_0x4dea06={};function _0x233edd(_0xc2b253,_0x16aefc,_0x17fe9,_0x2992f3){return _0x53ff(_0x2992f3- -0x34e,_0x17fe9);}return _0x4dea06[_0x233edd(-0x73,-0x74,-0xfa,-0xcd)]=_0x544c29['RbTej'],_0x4dea06[_0x233edd(-0xf0,-0xce,-0xe3,-0xda)]='\x0a',[..._0x25279a,_0x4dea06,..._0x5137b1];}function normalizeToArray(_0x101855){function _0x401773(_0x56525f,_0x2f37e0,_0xef2999,_0x212480){return _0x53ff(_0xef2999- -0x2ae,_0x212480);}const _0x537a45={};_0x537a45['VkWic']=function(_0x51c5c8,_0x45cd26){return _0x51c5c8||_0x45cd26;};const _0x108dfe=_0x537a45;function _0x456a03(_0x4edf9a,_0x2acef2,_0x44840f,_0x554479){return _0x53ff(_0x554479-0x345,_0x2acef2);}if(Array[_0x401773(-0xc5,-0xbe,-0x6b,-0x1b)](_0x101855))return _0x101855;return[{'type':_0x401773(-0x1,0x1,-0x3a,-0x3d),'text':_0x108dfe['VkWic'](_0x101855,'')}];}export function replacePlaceholder(_0x1a0eb8,_0x5c1832,_0x437af9,_0x58602a){const _0x426953={'nzGsg':function(_0x582b5e,_0x4946e3){return _0x582b5e(_0x4946e3);},'uoKIN':function(_0x2a63f6,_0x22b326){return _0x2a63f6===_0x22b326;},'eMgRR':_0xed3507(0x4c,0xa6,0x3,0x27),'lpLnN':_0x1aef4c(0x35c,0x300,0x34e,0x313),'mKxdb':_0x1aef4c(0x383,0x3dd,0x388,0x3d4),'FKSyL':function(_0x21f308,_0x372923){return _0x21f308||_0x372923;},'ghHsx':function(_0x3ee963,_0x371723){return _0x3ee963===_0x371723;},'iODOO':'URshG','jbmtG':'object','VEwox':function(_0x61d791,_0x26a570){return _0x61d791!==_0x26a570;},'EfXCT':_0xed3507(0x43,0x84,0x1b,0x3d),'zPmFJ':function(_0x244936,_0x3e9731,_0x25aa9b,_0x2af16a,_0x276a82){return _0x244936(_0x3e9731,_0x25aa9b,_0x2af16a,_0x276a82);}};if(_0x426953[_0xed3507(-0x53,-0x93,-0x8c,-0x2a)](typeof _0x1a0eb8,_0x426953[_0x1aef4c(0x3c1,0x3bc,0x3dd,0x404)])){if(_0x426953['lpLnN']!==_0x426953[_0xed3507(0x16,-0x35,0x12,-0x46)])return _0x437af9&&_0x1a0eb8[_0xed3507(-0x29,-0x67,-0x73,-0x73)](_0x5c1832)&&(_0x58602a&&_0x58602a[_0x1aef4c(0x32d,0x3d2,0x37d,0x3b4)](_0x5c1832)),_0x1a0eb8['replaceAll'](_0x5c1832,_0x426953[_0xed3507(0xc,-0x52,-0x4f,0x2c)](_0x437af9,''));else _0x288924[_0xed3507(-0x1a,-0x4b,0x32,0x24)](_0xed3507(-0x48,-0x48,0x2,-0x60)+_0xed3507(-0x1,0x26,0x55,0x2f)+_0x5558fd+'@}');}if(Array[_0xed3507(0xb,-0x40,-0x4c,0x4c)](_0x1a0eb8)){if(_0x426953[_0xed3507(-0x37,-0x86,-0x19,-0x2a)](_0x426953[_0xed3507(0x19,-0x4,0x1c,-0x42)],_0x426953[_0x1aef4c(0x3b1,0x3f3,0x3b0,0x35b)]))return _0x1a0eb8[_0x1aef4c(0x392,0x37a,0x380,0x326)](_0x103d31=>replacePlaceholder(_0x103d31,_0x5c1832,_0x437af9,_0x58602a));else{_0x328204[_0xed3507(0x40,0x1a,0x2a,-0x1d)](_0x385454);const _0x3a4bb0={..._0x44a7fa};_0x12bb6c=_0x3a4bb0;}}function _0x1aef4c(_0x330c47,_0x5c46fd,_0x392866,_0x3ec463){return _0x53ff(_0x392866-0x15f,_0x3ec463);}if(_0x1a0eb8&&_0x426953[_0xed3507(-0x37,-0x12,0x10,-0x21)](typeof _0x1a0eb8,_0x426953[_0x1aef4c(0x346,0x35c,0x33a,0x345)])){if(_0x426953[_0xed3507(-0x2e,-0x37,-0x37,-0x5a)](_0x426953[_0x1aef4c(0x348,0x3a3,0x386,0x345)],_0x426953[_0x1aef4c(0x38b,0x365,0x386,0x39c)])){const _0x53b0ff={};return _0x53b0ff[_0x1aef4c(0x36a,0x323,0x338,0x36c)+'e']=_0x1344e0,_0x53b0ff[_0x1aef4c(0x31f,0x3a8,0x368,0x3bb)+'a']=_0x2a5bf5,_0x426953[_0x1aef4c(0x41f,0x3b7,0x3e2,0x42c)](_0x170297,_0x53b0ff);}else{const _0x5c60ca={};for(const _0x53b445 in _0x1a0eb8){_0x5c60ca[_0x53b445]=_0x426953['zPmFJ'](replacePlaceholder,_0x1a0eb8[_0x53b445],_0x5c1832,_0x437af9,_0x58602a);}return _0x5c60ca;}}function _0xed3507(_0x2c5c3d,_0xebd3ad,_0x549a09,_0x4b58bd){return _0x53ff(_0x2c5c3d- -0x238,_0xebd3ad);}return _0x1a0eb8;}export function replaceAllPlaceholders(_0x2b28ef,_0x343f88){const _0x2bfbf3={'pkqdc':'text','LADyJ':function(_0x4a25ac,_0x4699b9){return _0x4a25ac||_0x4699b9;},'eXDhZ':function(_0x46a853,_0x3a49c2,_0x1f052d,_0x3a0d66){return _0x46a853(_0x3a49c2,_0x1f052d,_0x3a0d66);},'MFIhR':function(_0x287292){return _0x287292();},'rXbuS':_0x15fdce(0x2d3,0x324,0x2c5,0x2dd),'IVBtz':_0x15fdce(0x295,0x2c3,0x283,0x277),'YNsGv':function(_0xc3ec78,_0x44af0c,_0x4f6c2e,_0x36a70e,_0x188306){return _0xc3ec78(_0x44af0c,_0x4f6c2e,_0x36a70e,_0x188306);},'VWaVV':_0x506b7b(-0x37,0x12,-0x47,-0xa2),'tnzMj':_0x506b7b(0x9e,0x80,0x48,0x3),'IAXDn':'{{角色启用列表}}','fNztj':_0x15fdce(0x2d5,0x28c,0x277,0x323)+'}}','FaTZB':_0x506b7b(0x25,0x1,-0x36,-0x3f)+'}}','VJmRf':_0x15fdce(0x268,0x27c,0x27c,0x26d),'nDMVJ':function(_0x5b97e1,_0xbae6ab){return _0x5b97e1===_0xbae6ab;},'kyVMD':'pybGs','MgFTD':function(_0x1c888c,_0x2c94e7){return _0x1c888c===_0x2c94e7;},'zAvjg':_0x15fdce(0x2e3,0x30c,0x339,0x2cd),'TTLje':function(_0x2d324a,_0x14f5b4,_0x2514d1){return _0x2d324a(_0x14f5b4,_0x2514d1);}},{context:context='',body:body='',worldBookContent:worldBookContent='',variables:variables={},userDemand:userDemand='',characterListText:characterListText='',outfitEnableListText:outfitEnableListText='',commonCharacterListText:commonCharacterListText=''}=_0x343f88,_0x203103=new Set();let _0x3dcb68=_0x2b28ef;const _0x448607=_0x2bfbf3[_0x15fdce(0x255,0x1fb,0x25a,0x1fb)](getContext),_0x4a722a=_0x448607?.[_0x15fdce(0x2dc,0x2f7,0x2d7,0x2cb)]||'';let _0x5423e4=worldBookContent;_0x5423e4&&(_0x5423e4=_0x5423e4[_0x506b7b(-0x2d,-0x15,-0x44,-0x52)](_0x2bfbf3[_0x506b7b(0x12,0x4b,0x19,0x34)],_0x4a722a),_0x5423e4=_0x5423e4['replaceAll'](_0x2bfbf3['IVBtz'],_0x4a722a));function _0x506b7b(_0x512c56,_0x185458,_0x892f71,_0x394350){return _0x53ff(_0x892f71- -0x231,_0x512c56);}_0x3dcb68=_0x2bfbf3[_0x506b7b(-0x8f,-0x99,-0x55,-0x14)](replacePlaceholder,_0x3dcb68,_0x2bfbf3['VWaVV'],context,_0x203103),_0x3dcb68=replacePlaceholder(_0x3dcb68,_0x506b7b(0x49,-0x3b,0x9,0x45),_0x5423e4,_0x203103);function _0x15fdce(_0x2fa421,_0x9fbc78,_0x3afc5d,_0x4ccfb1){return _0x53ff(_0x2fa421-0x7d,_0x4ccfb1);}_0x3dcb68=_0x2bfbf3['YNsGv'](replacePlaceholder,_0x3dcb68,_0x2bfbf3[_0x506b7b(0x9d,0x98,0x59,0x43)],body,_0x203103),_0x3dcb68=_0x2bfbf3[_0x15fdce(0x259,0x20f,0x22d,0x221)](replacePlaceholder,_0x3dcb68,_0x2bfbf3[_0x506b7b(0xa,-0x51,-0x33,-0x47)],characterListText,_0x203103),_0x3dcb68=replacePlaceholder(_0x3dcb68,_0x2bfbf3[_0x506b7b(0x7f,-0x1,0x3a,0x75)],outfitEnableListText,_0x203103),_0x3dcb68=replacePlaceholder(_0x3dcb68,_0x2bfbf3[_0x15fdce(0x257,0x233,0x273,0x241)],commonCharacterListText,_0x203103),_0x3dcb68=_0x2bfbf3[_0x15fdce(0x259,0x292,0x263,0x214)](replacePlaceholder,_0x3dcb68,_0x2bfbf3[_0x506b7b(0x10,0x89,0x51,-0x9)],userDemand,_0x203103);if(variables&&Object[_0x15fdce(0x27f,0x26e,0x2dd,0x2b5)](variables)[_0x15fdce(0x297,0x2ba,0x246,0x2c6)]>-0x8*-0x4a+-0x22b2+-0x67a*-0x5){if(_0x2bfbf3[_0x506b7b(0x33,-0x7e,-0x23,-0x38)](_0x506b7b(0x36,0x49,0xc,-0x36),_0x2bfbf3['kyVMD'])){const _0x456e05=/\{\{getvar::([^}]+)\}\}/g,_0x512689=JSON[_0x15fdce(0x27a,0x22a,0x2b0,0x256)](_0x3dcb68),_0x134b25=[..._0x512689[_0x15fdce(0x2a7,0x2e2,0x2d8,0x255)](_0x456e05)],_0x3e7c2c=new Set();for(const _0x4e74c2 of _0x134b25){if(_0x2bfbf3[_0x15fdce(0x2b9,0x302,0x2d0,0x2ef)](_0x506b7b(0x2f,-0x37,0x10,0x56),_0x2bfbf3[_0x15fdce(0x2b5,0x29b,0x27a,0x2fa)])){if(_0x4fd564[_0x506b7b(-0x23,-0x28,0x12,-0xc)](_0x47e20e))return _0x5b038c;return[{'type':_0x2bfbf3[_0x506b7b(0x6,-0x43,-0xc,-0x58)],'text':_0x2bfbf3[_0x15fdce(0x29f,0x261,0x2e7,0x26f)](_0x141248,'')}];}else _0x3e7c2c[_0x506b7b(-0x53,-0x55,-0x13,0x2e)](_0x4e74c2[-0x3*0x2d+0x1*-0x17e1+0x1869*0x1]);}for(const _0x47c72e of _0x3e7c2c){const _0x5f236c=_0x506b7b(-0x5d,-0x3c,-0x4f,-0x21)+_0x47c72e+'}}',_0xe09fde=variables[_0x47c72e]||'';_0x3dcb68=_0x2bfbf3['YNsGv'](replacePlaceholder,_0x3dcb68,_0x5f236c,_0xe09fde,_0x203103);}}else{const _0x1b3ea0={'rkxta':function(_0x3509e7,_0xc536c8,_0x34e110,_0x343c40){function _0x32ffb1(_0x208ada,_0x5f0d5d,_0x2e43f3,_0x1c7943){return _0x506b7b(_0x208ada,_0x5f0d5d-0x140,_0x2e43f3-0x172,_0x1c7943-0x147);}return _0x2bfbf3[_0x32ffb1(0x17c,0xe5,0x136,0x16e)](_0x3509e7,_0xc536c8,_0x34e110,_0x343c40);}};if(!_0x3f48c4||_0x2a2a78['length']===0x123c+0x1*-0x12da+-0x4f*-0x2)return _0x1abeb0;const _0x32a6bf=_0x1dd8b2();return!_0x32a6bf[_0x506b7b(-0x3b,0x7,0x1e,0x7a)+'ta']&&(_0x32a6bf[_0x506b7b(0x5,-0x2d,0x1e,0x61)+'ta']={}),!_0x32a6bf['chatMetada'+'ta'][_0x15fdce(0x2fd,0x2f5,0x30f,0x305)]&&(_0x32a6bf[_0x506b7b(0x6,-0x1e,0x1e,0x42)+'ta'][_0x15fdce(0x2fd,0x2c6,0x324,0x31b)]={}),_0x4bc944['map'](_0x204ad1=>{if(!_0x204ad1||!_0x204ad1[_0x27d2f2(0x115,0xf7,0x137,0xa7)])return _0x204ad1;function _0x27d2f2(_0x39d548,_0x16064a,_0x10f863,_0x43dbf8){return _0x506b7b(_0x10f863,_0x16064a-0x133,_0x16064a-0xfa,_0x43dbf8-0x14e);}function _0x19f5d8(_0x23802d,_0x33424b,_0x5b5a98,_0x31e06f){return _0x506b7b(_0x31e06f,_0x33424b-0x150,_0x5b5a98-0x85,_0x31e06f-0x8f);}return{..._0x204ad1,'content':_0x1b3ea0[_0x27d2f2(0xd1,0xb0,0xb8,0xa1)](_0x28c634,_0x204ad1[_0x19f5d8(0x81,0x6f,0x82,0xab)],_0x32a6bf,_0x569188)};});}}_0x3dcb68=_0x2bfbf3['TTLje'](processVariablePlaceholdersInMessages,_0x3dcb68,_0x203103);const _0x440640={};return _0x440640[_0x15fdce(0x275,0x248,0x21b,0x264)]=_0x3dcb68,_0x440640[_0x15fdce(0x2b3,0x28b,0x2c5,0x2d5)+_0x15fdce(0x294,0x241,0x24a,0x295)]=_0x203103,_0x440640;}function processVariablePlaceholdersInMessages(_0x12ec1a,_0x3c41d2){const _0x41d361={'TYhTA':function(_0x2acdbf,_0x14ebbb){return _0x2acdbf===_0x14ebbb;},'ynKkt':_0x11ddde(0x326,0x35e,0x363,0x30d),'TZXlN':'string','WVxgZ':function(_0x44b08e,_0x485e77,_0xd1c37,_0x153336){return _0x44b08e(_0x485e77,_0xd1c37,_0x153336);},'XgYgE':function(_0x41d395,_0x1e666e){return _0x41d395===_0x1e666e;},'UrLoH':function(_0x558fd8){return _0x558fd8();},'PGjHl':function(_0x18da9e,_0x2ccab6){return _0x18da9e===_0x2ccab6;},'YXFrR':_0x11ddde(0x371,0x316,0x2cf,0x34c),'ezcAP':function(_0x2ee8e5,_0x5c5f06){return _0x2ee8e5!==_0x5c5f06;},'lJiBL':_0x48a2c4(0x48,0x2a,0x39,-0x27),'lWcMn':_0x48a2c4(-0x40,0xf,0x2,0x39)};if(!_0x12ec1a||_0x41d361[_0x48a2c4(-0x2d,0x2c,0x5d,0x6)](_0x12ec1a[_0x11ddde(0x2cf,0x304,0x356,0x2cf)],-0x1*0x1077+-0x21d9+0x3250))return _0x12ec1a;function _0x11ddde(_0x4f6e80,_0xcd0bf9,_0x1a3bbf,_0x477f08){return _0x53ff(_0xcd0bf9-0xea,_0x477f08);}const _0x36365c=_0x41d361[_0x11ddde(0x2f5,0x2e1,0x297,0x315)](getContext);if(!_0x36365c['chatMetada'+'ta']){if(_0x41d361['PGjHl'](_0x41d361[_0x11ddde(0x33f,0x33d,0x375,0x315)],_0x41d361[_0x11ddde(0x398,0x33d,0x372,0x320)]))_0x36365c[_0x11ddde(0x336,0x339,0x314,0x2ec)+'ta']={};else return _0x40af6[_0x11ddde(0x305,0x30b,0x339,0x2cd)](_0x5be999=>{function _0x42eb78(_0x12c211,_0x2edccd,_0x224d51,_0x217265){return _0x48a2c4(_0x12c211-0x14,_0x2edccd-0x27c,_0x224d51-0x102,_0x12c211);}function _0x3071b6(_0x1ea25a,_0x4e251b,_0x4db151,_0x2ff2d4){return _0x48a2c4(_0x1ea25a-0xae,_0x1ea25a- -0x181,_0x4db151-0x151,_0x4db151);}if(_0x5be999&&_0x41d361[_0x42eb78(0x244,0x212,0x1f7,0x23f)](_0x5be999[_0x3071b6(-0x15d,-0x172,-0x1b6,-0x122)],_0x41d361[_0x3071b6(-0x189,-0x1c2,-0x174,-0x1ca)])&&typeof _0x5be999[_0x42eb78(0x25f,0x293,0x249,0x2c9)]===_0x41d361[_0x3071b6(-0x1a9,-0x196,-0x186,-0x178)])return{..._0x5be999,'text':_0x41d361['WVxgZ'](_0x5b0677,_0x5be999[_0x3071b6(-0x16a,-0x126,-0x132,-0x14c)],_0x21f4ab,_0x319c72)};return _0x5be999;});}function _0x48a2c4(_0x336290,_0x8b8126,_0x38224b,_0xc45fa8){return _0x53ff(_0x8b8126- -0x25d,_0xc45fa8);}if(!_0x36365c[_0x11ddde(0x346,0x339,0x34f,0x31c)+'ta'][_0x48a2c4(0x34,0x23,0x5a,-0x1e)]){if(_0x41d361['ezcAP'](_0x41d361[_0x48a2c4(-0x37,-0x18,0x10,-0x6)],_0x41d361[_0x48a2c4(-0x95,-0x8e,-0xd3,-0x79)]))_0x36365c['chatMetada'+'ta'][_0x48a2c4(0x7b,0x23,0x28,-0x9)]={};else{const _0x40718e=_0xb84dd5?function(){function _0x3920cd(_0x61ea55,_0x1b88d4,_0x360dd6,_0x4bca72){return _0x11ddde(_0x61ea55-0x4a,_0x4bca72-0x112,_0x360dd6-0x12b,_0x1b88d4);}if(_0x1a7706){const _0x13e4da=_0x153a96[_0x3920cd(0x434,0x405,0x402,0x457)](_0x4503d0,arguments);return _0x4c581b=null,_0x13e4da;}}:function(){};return _0x52755a=![],_0x40718e;}}return _0x12ec1a[_0x48a2c4(-0x23,-0x3c,-0x1a,-0x81)](_0x11cb0e=>{if(!_0x11cb0e||!_0x11cb0e[_0x411717(0x566,0x52e,0x545,0x4ed)])return _0x11cb0e;function _0x411717(_0x3277b4,_0x28a573,_0x1e2af5,_0x4615ae){return _0x48a2c4(_0x3277b4-0x57,_0x1e2af5-0x574,_0x1e2af5-0x21,_0x4615ae);}function _0x330690(_0x353b8b,_0x4f031a,_0x18eb67,_0x2f4bc1){return _0x48a2c4(_0x353b8b-0x1cd,_0x2f4bc1-0x27a,_0x18eb67-0x77,_0x353b8b);}return{..._0x11cb0e,'content':_0x41d361[_0x411717(0x517,0x546,0x4f4,0x54d)](processContentVariables,_0x11cb0e[_0x330690(0x1ef,0x236,0x1f7,0x24b)],_0x36365c,_0x3c41d2)};});}function processContentVariables(_0x4ef9ba,_0xe026a,_0x404ffa){const _0x41962b={'ZaQxr':_0x301131(-0x87,-0x5b,-0xa6,-0xa9),'qZPKB':_0x38ab78(0x4d,0x66,0x57,0x7d),'ckylZ':_0x38ab78(0xb5,0x27,0x5e,0x7b),'ksDwH':function(_0x411a85,_0x3266cb){return _0x411a85===_0x3266cb;},'Nckki':'text','GSYqk':function(_0x366514,_0x51109a){return _0x366514===_0x51109a;},'kWNaT':_0x301131(-0x36,-0xa7,-0xc2,-0x7b),'HdoQK':_0x301131(-0xc4,-0x108,-0x156,-0x11c),'qdrSm':function(_0x3c2d30,_0x78ea3f,_0x1f974c,_0x3d5404){return _0x3c2d30(_0x78ea3f,_0x1f974c,_0x3d5404);}};function _0x301131(_0x41eabc,_0x403ede,_0x3afa25,_0x761063){return _0x53ff(_0x761063- -0x2ff,_0x403ede);}if(typeof _0x4ef9ba===_0x41962b['kWNaT'])return processStringVariables(_0x4ef9ba,_0xe026a,_0x404ffa);if(Array[_0x301131(-0xba,-0xbc,-0x10d,-0xbc)](_0x4ef9ba))return _0x4ef9ba[_0x301131(-0xc4,-0xde,-0xeb,-0xde)](_0x1d4ce8=>{function _0x5271e3(_0x149d11,_0x404278,_0x3f0db6,_0x264e10){return _0x38ab78(_0x149d11-0x158,_0x149d11,_0x3f0db6-0x1d5,_0x3f0db6-0x42c);}const _0x375694={};_0x375694['kYjDb']=_0x41962b[_0x208065(-0x1ff,-0x1c4,-0x20c,-0x1c5)];function _0x208065(_0x277245,_0xe7fb9,_0x28429a,_0x30b761){return _0x38ab78(_0x277245-0x168,_0x277245,_0x28429a-0x6d,_0xe7fb9- -0x245);}_0x375694['gjInn']=_0x41962b[_0x5271e3(0x4bc,0x50a,0x510,0x53b)];const _0x308d53=_0x375694;if(_0x41962b['ckylZ']!==_0x5271e3(0x489,0x46d,0x4c2,0x4e5)){if(_0x1d4ce8&&_0x41962b[_0x208065(-0x1a5,-0x169,-0x1af,-0x199)](_0x1d4ce8[_0x5271e3(0x4be,0x564,0x512,0x4fb)],_0x41962b[_0x5271e3(0x4f6,0x47c,0x4d9,0x4ab)])&&_0x41962b[_0x5271e3(0x49e,0x52f,0x4f5,0x53a)](typeof _0x1d4ce8[_0x5271e3(0x4c6,0x508,0x505,0x503)],_0x41962b[_0x5271e3(0x4d5,0x47a,0x4c3,0x477)])){if(_0x41962b[_0x208065(-0x185,-0x169,-0x1b3,-0x1a5)](_0x41962b[_0x208065(-0x1de,-0x1cc,-0x199,-0x17d)],_0x5271e3(0x423,0x49f,0x474,0x4a0)))return{..._0x1d4ce8,'text':_0x41962b['qdrSm'](processStringVariables,_0x1d4ce8['text'],_0xe026a,_0x404ffa)};else _0x1d022f=_0x3f4549['replaceAll'](_0x308d53['kYjDb'],_0x534424),_0x25463b=_0x262fa4[_0x5271e3(0x4b6,0x489,0x47e,0x4b3)](_0x308d53[_0x208065(-0x18b,-0x19e,-0x1c7,-0x17e)],_0x3b555b);}return _0x1d4ce8;}else{if(_0x46b830){const _0x1b99a6=_0x1d96f6['apply'](_0x321914,arguments);return _0x359028=null,_0x1b99a6;}}});function _0x38ab78(_0x16286c,_0x1bbdf7,_0x4bb03d,_0xcf2d33){return _0x53ff(_0xcf2d33- -0x19b,_0x1bbdf7);}return _0x4ef9ba;}function processStringVariables(_0x42520b,_0x55efdf,_0x3dee33){const _0x487800={'aimQb':function(_0x46e258,_0x536dd0,_0x369e71,_0x3c4a7f,_0x47249f){return _0x46e258(_0x536dd0,_0x369e71,_0x3c4a7f,_0x47249f);},'yJhkD':function(_0x58be6a,_0x327a4f){return _0x58be6a===_0x327a4f;},'mNFrt':'jlFbx','XITsG':function(_0x1cfce2,_0xbb1bf4){return _0x1cfce2+_0xbb1bf4;},'nSzPm':function(_0x229857,_0x5d0cec,_0x19abd0){return _0x229857(_0x5d0cec,_0x19abd0);},'BWqzF':_0x326c1c(0x280,0x2f1,0x295,0x2c3),'TiTfu':_0x326c1c(0x2a1,0x245,0x28d,0x23b),'Xjqtd':function(_0x335023,_0x2c1c1d){return _0x335023(_0x2c1c1d);},'nwGYA':function(_0x39fca7,_0x40ba8e){return _0x39fca7!==_0x40ba8e;},'iGhUl':_0x31deed(0x540,0x58a,0x53a,0x53e),'XVqXl':_0x31deed(0x577,0x59f,0x5fb,0x5c1)};if(!_0x42520b)return _0x42520b;let _0x4f2b77=_0x42520b;function _0x326c1c(_0x1b4e03,_0x408f38,_0x2dc372,_0x2647c6){return _0x53ff(_0x2dc372-0x8d,_0x1b4e03);}_0x4f2b77=_0x4f2b77[_0x31deed(0x53a,0x515,0x528,0x562)](/\{@setvar::([^:@]+)::([\s\S]*?)@\}/g,(_0x351af6,_0x4b11af,_0x4a24cf)=>{function _0x4a7b71(_0x835e7b,_0x44a329,_0xcccd46,_0x159c5a){return _0x31deed(_0x835e7b-0x156,_0x44a329-0x1e5,_0x44a329,_0x159c5a- -0x3a6);}const _0x537750={'jewvc':function(_0xea04d6,_0x40daed,_0x18558a,_0x5ccdbe,_0x389cb6){function _0x457e81(_0x39562e,_0x46cf32,_0x24b627,_0x9e1053){return _0x53ff(_0x9e1053- -0x13d,_0x24b627);}return _0x487800[_0x457e81(0xd3,0xf4,0x11e,0xd6)](_0xea04d6,_0x40daed,_0x18558a,_0x5ccdbe,_0x389cb6);}},_0x215e41=_0x4b11af[_0x4a7b71(0x20b,0x1f5,0x230,0x213)]();_0x55efdf[_0x4a7b71(0x24d,0x237,0x1cf,0x1fb)+'ta'][_0x4cdf2f(0x2ce,0x2e4,0x2b3,0x2e8)][_0x215e41]=_0x4a24cf;function _0x4cdf2f(_0x20d8db,_0x1340cf,_0x2c099e,_0x5a002e){return _0x31deed(_0x20d8db-0x5e,_0x1340cf-0x1dc,_0x2c099e,_0x1340cf- -0x2ee);}if(_0x3dee33){if(_0x487800['yJhkD'](_0x487800['mNFrt'],_0x4cdf2f(0x258,0x24a,0x1fd,0x27b))){const _0x4f9862={};for(const _0x30cb49 in _0x5094da){_0x4f9862[_0x30cb49]=_0x537750[_0x4a7b71(0x146,0x192,0x139,0x18a)](_0x3d631d,_0x55969b[_0x30cb49],_0x27bd60,_0x11e352,_0x4fbd73);}return _0x4f9862;}else _0x3dee33[_0x4cdf2f(0x248,0x282,0x252,0x2b4)](_0x4cdf2f(0x23e,0x268,0x243,0x236)+_0x215e41+'@}');}return'';});function _0x31deed(_0x4b1740,_0x201bcd,_0x4abe14,_0x48263b){return _0x53ff(_0x48263b-0x352,_0x4abe14);}return _0x4f2b77=_0x4f2b77['replace'](/\{@getvar::([^@]+)@\}/g,(_0x4ffc4e,_0x26f1dc)=>{const _0x171b74=_0x26f1dc[_0x5a6bd0(-0x6f,-0x16,-0x14,-0x1d)]();function _0x1e879c(_0x2db50b,_0x50b94a,_0x5163aa,_0x3f61b6){return _0x31deed(_0x2db50b-0x7a,_0x50b94a-0x1c2,_0x3f61b6,_0x5163aa-0x95);}function _0x5a6bd0(_0x1fe530,_0x82c04c,_0x4036ad,_0x4d0c1d){return _0x326c1c(_0x4036ad,_0x82c04c-0x17f,_0x82c04c- -0x30a,_0x4d0c1d-0x117);}const _0x5b6a46=_0x55efdf['chatMetada'+'ta']['variables'][_0x171b74]||'';return _0x3dee33&&_0x3dee33['add'](_0x1e879c(0x684,0x643,0x65a,0x6b1)+_0x171b74+'@}'),_0x5b6a46;}),_0x4f2b77=_0x4f2b77[_0x31deed(0x53c,0x5a6,0x536,0x562)](/\{@setglobalvar::([^:@]+)::([\s\S]*?)@\}/g,(_0x5f4e9d,_0x51920d,_0x4c5976)=>{const _0x27a77b=_0x51920d[_0x1d24cd(0x1e4,0x213,0x25b,0x1b8)]();_0x487800[_0x5bbe05(0x21a,0x1f5,0x243,0x249)](setglobalvar,_0x27a77b,_0x4c5976);function _0x5bbe05(_0x2768ab,_0xf40655,_0x505633,_0x3fd092){return _0x326c1c(_0x505633,_0xf40655-0xb6,_0x2768ab- -0xd4,_0x3fd092-0x1df);}if(_0x3dee33){if(_0x487800['BWqzF']!==_0x487800[_0x5bbe05(0x1d2,0x1a8,0x1cf,0x1f9)])_0x3dee33['add'](_0x1d24cd(0x1b9,0x18b,0x168,0x1c6)+_0x1d24cd(0x23b,0x216,0x272,0x1fb)+_0x27a77b+'@}');else return _0x487800[_0x1d24cd(0x194,0x1c9,0x1d1,0x170)](_0x487800[_0x1d24cd(0x185,0x1c9,0x21b,0x1eb)](_0x54ec82,'\x0a'),_0x324458);}function _0x1d24cd(_0x45bebd,_0x3564d8,_0x3fa6fe,_0x29b4bf){return _0x326c1c(_0x45bebd,_0x3564d8-0x163,_0x3564d8- -0xe1,_0x29b4bf-0xcf);}return'';}),_0x4f2b77=_0x4f2b77[_0x31deed(0x517,0x571,0x552,0x562)](/\{@getglobalvar::([^@]+)@\}/g,(_0x5a091c,_0x5ca367)=>{function _0xd8653(_0x1585be,_0x478367,_0x19ac29,_0x1178cf){return _0x31deed(_0x1585be-0x19f,_0x478367-0xf9,_0x478367,_0x1178cf-0x3e);}const _0x4c1184={'Visgz':function(_0x37c8da,_0x2c44ab,_0x285a84){function _0x2fed03(_0x2d877d,_0x2a6050,_0x22dc2b,_0x396fdc){return _0x53ff(_0x2d877d- -0x36b,_0x22dc2b);}return _0x487800[_0x2fed03(-0x10a,-0xcf,-0x151,-0xba)](_0x37c8da,_0x2c44ab,_0x285a84);}},_0x48c936=_0x5ca367['trim'](),_0x3a2962=_0x487800[_0x4fbf42(0x2d,0x7a,0x51,0x61)](getglobalvar,_0x48c936)||'';if(_0x3dee33){if(_0x487800[_0x4fbf42(0x6b,0x6e,0x8c,0x6a)](_0x487800[_0x4fbf42(0x8f,0x12,0x50,0x5e)],_0x487800[_0x4fbf42(0xaa,0x13,0x83,0x5e)])){const _0x25e538=_0x55e819[_0x4fbf42(0xad,0xeb,0x79,0x98)]();return _0x4c1184[_0xd8653(0x547,0x508,0x596,0x562)](_0x38341d,_0x25e538,_0x49a5cc),_0x1081e1&&_0xc84355[_0x4fbf42(0xa1,0x30,0x1c,0x4f)](_0xd8653(0x59c,0x580,0x544,0x56f)+_0xd8653(0x613,0x62a,0x5cf,0x5fa)+_0x25e538+'@}'),'';}else _0x3dee33[_0xd8653(0x60c,0x5e7,0x56c,0x5ae)](_0x4fbf42(-0x10,0x46,0x56,0x2d)+_0xd8653(0x5cb,0x62f,0x64a,0x5fa)+_0x48c936+'@}');}function _0x4fbf42(_0x5096d8,_0x1a9fbd,_0x1e1d50,_0x1de21b){return _0x326c1c(_0x1e1d50,_0x1a9fbd-0x1a4,_0x1de21b- -0x25c,_0x1de21b-0x13f);}return _0x3a2962;}),_0x4f2b77=_0x4f2b77['replace'](/\{@getworldvar::([^@]+)@\}/g,(_0x148a53,_0x36fe7b)=>{function _0xc01e8f(_0x1150cc,_0x28ef8d,_0x24dd00,_0x12b2f3){return _0x31deed(_0x1150cc-0x16d,_0x28ef8d-0xfa,_0x1150cc,_0x24dd00- -0x144);}function _0x51bb86(_0x105a34,_0x2b21dd,_0x3b456c,_0x5cd87b){return _0x326c1c(_0x2b21dd,_0x2b21dd-0x117,_0x3b456c-0x96,_0x5cd87b-0x153);}if(_0x487800[_0x51bb86(0x374,0x396,0x35c,0x325)](_0x487800['XVqXl'],_0x487800[_0xc01e8f(0x40a,0x44e,0x454,0x452)]))_0x2d25b3[_0xc01e8f(0x49c,0x493,0x486,0x476)](_0x276449);else{const _0x9a1fa0=_0x36fe7b[_0xc01e8f(0x4cf,0x4bf,0x475,0x418)](),_0x3ad840=_0x487800[_0x51bb86(0x383,0x384,0x353,0x3ab)](getworldvar,_0x9a1fa0)||'';return _0x3dee33&&_0x3dee33['add'](_0xc01e8f(0x3a8,0x3d3,0x3fe,0x3f2)+'var::'+_0x9a1fa0+'@}'),_0x3ad840;}}),_0x4f2b77;}export function buildPromptWithTrigger(_0x3d7469){const _0x35e74a={'bDHwy':function(_0x1ba63e,_0x871ff){return _0x1ba63e===_0x871ff;},'Brhoe':function(_0x563cb6,_0x14619d,_0x926fe5){return _0x563cb6(_0x14619d,_0x926fe5);},'PzciB':function(_0x5ca487,_0x2a4f3a,_0x144f45,_0x34b96d){return _0x5ca487(_0x2a4f3a,_0x144f45,_0x34b96d);},'DkbEt':_0x51a573(0x423,0x405,0x3d5,0x3c0),'XjlEO':function(_0x309d7b,_0x4c6824){return _0x309d7b===_0x4c6824;},'TOwwY':_0x51a573(0x44c,0x41e,0x41b,0x46d),'KjLid':function(_0x46d3c8,_0x3add08){return _0x46d3c8===_0x3add08;},'kojNv':'KmgHU','XFtCb':'user','Gnilc':function(_0x148212,_0x57942e){return _0x148212!==_0x57942e;},'CwSjH':_0x51a573(0x40e,0x3e8,0x3a8,0x3e4),'EwpSH':_0x469818(-0x3,0x34,0x85,0x54),'dYZWr':_0x469818(0x11b,0x131,0xc8,0xe1),'RRqTP':function(_0x2f1345,_0xeff4bf,_0xef4ce1){return _0x2f1345(_0xeff4bf,_0xef4ce1);}},{requestType:_0xdd1783,contextData:_0x158123}=_0x3d7469,_0xf9f49=extension_settings[extensionName]?.[_0x469818(0x110,0xee,0x11d,0xd2)+_0x51a573(0x3c3,0x3ed,0x3ea,0x3e8)+_0x51a573(0x3ef,0x448,0x468,0x43f)]||{},_0x43ddb2={};_0x43ddb2[_0x469818(0xae,0xe3,0xf2,0xa2)+'ofile']='默认';const _0x2a1d6c=_0xf9f49[_0xdd1783]||_0x43ddb2,_0x29e850=_0x2a1d6c[_0x469818(0x99,0x47,0x4b,0xa2)+_0x469818(0x68,0xbb,0x7b,0x74)]||'默认',_0x378895=extension_settings[extensionName]?.[_0x469818(0xc2,0x59,0x53,0x8a)+_0x51a573(0x3fb,0x3e3,0x3aa,0x3cd)+'s']||{},_0x22a735=_0x378895[_0x29e850]||_0x378895[Object[_0x469818(0x26,0x40,0x24,0x80)](_0x378895)[0x9*-0xb0+0x1*-0x1273+0x18a3]]||{},{context:context='',body:body='',worldBookContent:worldBookContent='',userDemand:userDemand=''}=_0x158123,_0x5f143c=[userDemand,context,body,worldBookContent][_0x51a573(0x3b1,0x3d4,0x416,0x394)](Boolean)[_0x469818(0x8b,0xa6,0xf7,0xd8)]('\x0a'),_0x56cb3a=[];if(_0x22a735[_0x469818(0x89,0x91,0xa5,0xdc)]&&Array['isArray'](_0x22a735['entries']))for(const _0x5ae914 of _0x22a735[_0x51a573(0x4ad,0x45d,0x433,0x4b8)]){if('SvFpE'===_0x35e74a['DkbEt']){if(!_0x5ae914[_0x51a573(0x49f,0x458,0x45a,0x42b)])continue;if(!_0x5ae914[_0x469818(0x102,0xb8,0xd4,0xac)]||_0x35e74a[_0x469818(0xd0,0xa4,0xdc,0xb9)](_0x5ae914[_0x469818(0xb3,0x93,0x97,0xac)][_0x51a573(0x433,0x466,0x4a3,0x414)](),''))continue;if(_0x35e74a[_0x469818(0x3d,0x90,0x64,0x93)](_0x5ae914['triggerMod'+'e'],_0x35e74a['TOwwY'])){if(!_0x35e74a[_0x51a573(0x433,0x47b,0x48f,0x46d)](checkTriggerWords,_0x5ae914['triggerWor'+'ds'],_0x5f143c)){if(_0x35e74a[_0x51a573(0x44c,0x45b,0x4a8,0x43a)](_0x469818(0xd2,0x4a,0xce,0x83),_0x35e74a[_0x51a573(0x443,0x3f3,0x428,0x432)]))continue;else _0x43d4d6[_0x469818(0x5c,0x70,0xa8,0x9c)]('{@getvar::'+_0x4d458b+'@}');}}const _0x30c32c={};_0x30c32c[_0x469818(0x137,0xe7,0x8b,0xe0)]=_0x5ae914[_0x51a573(0x40e,0x461,0x447,0x42b)]||_0x35e74a['XFtCb'],_0x30c32c[_0x51a573(0x45b,0x42d,0x443,0x47d)]=_0x5ae914[_0x469818(0x5a,0xac,0xe8,0xac)],_0x56cb3a[_0x51a573(0x4a4,0x477,0x4a1,0x489)](_0x30c32c);}else{if(!_0x3f0398){const _0x5250e5={..._0x19162f};_0x2cdf35=_0x5250e5;}else{if(_0x35e74a['bDHwy'](_0x248287[_0x469818(0xbd,0xcc,0xaf,0xe0)],_0x362a85['role']))_0x376d46['content']=_0x35e74a[_0x51a573(0x489,0x47b,0x454,0x4c0)](_0x361491,_0x16279b['content'],_0x5bfb02[_0x469818(0xd9,0xca,0x6a,0xac)]);else{_0x2f5f16['push'](_0x5f0e88);const _0x152b62={..._0x5b4645};_0x49bc22=_0x152b62;}}}}else{if(_0x22a735['history']&&Array[_0x51a573(0x492,0x442,0x438,0x3f4)](_0x22a735[_0x469818(0xec,0x137,0x10d,0x104)]))for(const _0x2b33cc of _0x22a735[_0x469818(0xbd,0x125,0xb4,0x104)]){if(_0x2b33cc[_0x51a573(0x42f,0x402,0x456,0x452)]&&_0x35e74a[_0x51a573(0x411,0x406,0x432,0x429)](_0x2b33cc['user'][_0x51a573(0x453,0x466,0x410,0x44b)](),'')){const _0x5ad942={};_0x5ad942['role']=_0x35e74a[_0x469818(0x74,0x89,0x9,0x5f)],_0x5ad942[_0x469818(0x6b,0x6a,0x10a,0xac)]=_0x2b33cc['user'],_0x56cb3a[_0x51a573(0x4c5,0x477,0x444,0x4b3)](_0x5ad942);}if(_0x2b33cc['assistant']&&_0x35e74a[_0x469818(0x42,0x53,0x43,0x85)](_0x2b33cc[_0x469818(0x111,0x137,0xaa,0xe1)][_0x469818(0x126,0xde,0xd3,0xe5)](),'')){if(_0x35e74a[_0x469818(0xaf,0x8f,0xcd,0x85)](_0x35e74a[_0x51a573(0x423,0x475,0x43f,0x451)],_0x35e74a[_0x469818(0x13f,0x114,0x11a,0xeb)])){const _0x3fb8e3={};_0x3fb8e3[_0x51a573(0x475,0x461,0x4a7,0x488)]=_0x35e74a[_0x51a573(0x3d4,0x40c,0x420,0x43b)],_0x3fb8e3[_0x51a573(0x40c,0x42d,0x483,0x449)]=_0x2b33cc[_0x469818(0xb6,0xb1,0xa3,0xe1)],_0x56cb3a[_0x469818(0xed,0xd2,0xea,0xf6)](_0x3fb8e3);}else return{..._0x32480a,'text':_0x35e74a[_0x51a573(0x42d,0x42e,0x403,0x419)](_0x51f687,_0x4de7b9[_0x469818(0x99,0x139,0x11e,0xf2)],_0x8e4499,_0x2ca50a)};}}}function _0x51a573(_0x209d95,_0x7a8153,_0x8c31f3,_0x26b92a){return _0x53ff(_0x7a8153-0x1ff,_0x8c31f3);}function _0x469818(_0x4d87d4,_0x20261d,_0x453b3a,_0x3665ec){return _0x53ff(_0x3665ec- -0x182,_0x453b3a);}const _0x570870=mergeAdjacentMessages(_0x56cb3a),{messages:_0x472e8e,replacedVariables:_0x946110}=_0x35e74a[_0x469818(0x60,0xc3,0x119,0xbe)](replaceAllPlaceholders,_0x570870,_0x158123);return _0x472e8e;}export function getProcessedPrompt(_0x3877b9,_0x502406){function _0x217489(_0x4413d0,_0x2a5419,_0x2dbebc,_0x27077a){return _0x53ff(_0x4413d0-0x321,_0x27077a);}function _0x445399(_0x3ba5fd,_0x95f864,_0x433492,_0x22526e){return _0x53ff(_0x3ba5fd- -0x22d,_0x95f864);}const _0x43958d={'wBVyh':function(_0x2e0048,_0x39be3e){return _0x2e0048(_0x39be3e);}},_0xd126d2={};return _0xd126d2[_0x217489(0x4fa,0x53b,0x4fb,0x543)+'e']=_0x3877b9,_0xd126d2[_0x217489(0x52a,0x586,0x554,0x513)+'a']=_0x502406,_0x43958d[_0x445399(0x30,-0x1e,0x37,-0xf)](buildPromptWithTrigger,_0xd126d2);}