(function(_0x4a1d11,_0x5bb696){function _0x1d3da6(_0x3f7afe,_0x6b7872,_0x2d0529,_0x49649d){return _0x2d4a(_0x2d0529-0x2af,_0x3f7afe);}function _0x545e50(_0x48eb41,_0x25ec85,_0x5cc316,_0xe9b448){return _0x2d4a(_0x5cc316- -0x300,_0x25ec85);}const _0x197b66=_0x4a1d11();while(!![]){try{const _0x4d566c=parseInt(_0x1d3da6(0x484,0x4c5,0x4c2,0x4e1))/(-0x89a+-0x9da+0x1275)+parseInt(_0x1d3da6(0x43e,0x451,0x482,0x439))/(0x9fd+-0x1e54+0x1459)*(parseInt(_0x545e50(-0xe9,-0x14c,-0x10f,-0x110))/(0xa7f*0x3+-0x2f*-0x82+-0xfd*0x38))+-parseInt(_0x545e50(-0x108,-0xc5,-0x10a,-0xc6))/(0x8be+-0x89*-0x6+-0xbf0)+-parseInt(_0x545e50(-0xe0,-0xc3,-0xd4,-0xe4))/(-0xa2+-0x1f98+0xd*0x27b)+-parseInt(_0x545e50(-0xf0,-0xe3,-0xcf,-0xa7))/(0x2*0x6fc+-0x9db+0x3*-0x15d)*(parseInt(_0x545e50(-0xcb,-0xde,-0xdd,-0x96))/(0x15d+0x2*0x77b+-0x104c))+-parseInt(_0x545e50(-0xa7,-0x13e,-0xfd,-0xff))/(-0x2151+0x62d+-0x1b2c*-0x1)+parseInt(_0x545e50(-0xe7,-0xf1,-0x9c,-0x87))/(-0x263f*0x1+0x22*-0x10f+0x4a46);if(_0x4d566c===_0x5bb696)break;else _0x197b66['push'](_0x197b66['shift']());}catch(_0x3bdf66){_0x197b66['push'](_0x197b66['shift']());}}}(_0x3db2,0x11f51*0x1+0x35e01+-0x43cd*-0x9));const _0x504ea4=(function(){const _0x4d2bad={};_0x4d2bad[_0xbdda36(0x471,0x45d,0x429,0x40e)]=function(_0x4d9a7f,_0x2e7996){return _0x4d9a7f+_0x2e7996;},_0x4d2bad[_0x52c098(0x3d,0x68,0x6f,0x72)]=function(_0x377eb8,_0x378a1e){return _0x377eb8!==_0x378a1e;},_0x4d2bad[_0x52c098(0x19,0x64,0x6a,0x4b)]=_0x52c098(0x37,0xad,0x59,0x9b),_0x4d2bad[_0xbdda36(0x402,0x41f,0x438,0x453)]='PTYmB',_0x4d2bad[_0x52c098(0x60,0xd3,0x84,0x9a)]=_0xbdda36(0x43b,0x41e,0x42a,0x427);function _0x52c098(_0xc492f1,_0x10be66,_0x514474,_0x25826a){return _0x2d4a(_0x514474- -0x17b,_0x25826a);}function _0xbdda36(_0x5c2840,_0x421c31,_0x235494,_0x3ad53c){return _0x2d4a(_0x235494-0x21c,_0x421c31);}_0x4d2bad['fDzNw']=function(_0x4a1961,_0x47f759){return _0x4a1961===_0x47f759;},_0x4d2bad[_0xbdda36(0x446,0x429,0x410,0x427)]=_0xbdda36(0x467,0x485,0x45f,0x460),_0x4d2bad[_0x52c098(0xd7,0x85,0xc4,0x7f)]=_0xbdda36(0x43b,0x42c,0x479,0x491);const _0x39bf44=_0x4d2bad;let _0x92994e=!![];return function(_0x3e2f08,_0x3c518f){function _0x3bfae1(_0x2d20cd,_0x161a0b,_0xb3906f,_0x49540b){return _0xbdda36(_0x2d20cd-0x1d2,_0x49540b,_0xb3906f- -0x4e3,_0x49540b-0xb7);}const _0xf45ac1={'kQcpt':function(_0x373c04,_0x5b369f){function _0x3313ad(_0xa402b0,_0x35662f,_0x546468,_0x4b2e61){return _0x2d4a(_0xa402b0- -0xeb,_0x35662f);}return _0x39bf44[_0x3313ad(0xff,0xff,0xde,0xb9)](_0x373c04,_0x5b369f);},'qoTZk':_0x39bf44[_0x3bfae1(-0xeb,-0xb7,-0xe2,-0xe7)],'IPsZw':_0x39bf44[_0x3bfae1(-0xed,-0xf7,-0xab,-0x8a)],'rstJd':_0x39bf44[_0x3bfae1(-0x77,-0xa1,-0xc8,-0x94)]};function _0x3e555d(_0x2a0314,_0xd0c8cc,_0x50f400,_0x24880e){return _0xbdda36(_0x2a0314-0x135,_0x50f400,_0x24880e- -0x40b,_0x24880e-0x81);}if(_0x39bf44[_0x3e555d(0x35,0x84,0x83,0x7b)](_0x39bf44[_0x3e555d(0x4c,0xd,0x3c,0x5)],_0x39bf44[_0x3bfae1(-0xc2,-0xab,-0x88,-0x53)]))return _0x39bf44[_0x3bfae1(-0xb2,-0x10b,-0xba,-0x74)](_0x39bf44[_0x3bfae1(-0x6c,-0x72,-0xba,-0xa9)](_0x47d583,'\x0a'),_0xd5171a);else{const _0x2959c4=_0x92994e?function(){function _0x1f8d6c(_0x3a18f7,_0x9ebf3f,_0x481af6,_0x385940){return _0x3e555d(_0x3a18f7-0x199,_0x9ebf3f-0x189,_0x3a18f7,_0x481af6-0x493);}function _0x1f2fe9(_0x22347e,_0x5ee5d0,_0x3976fd,_0x1cf192){return _0x3e555d(_0x22347e-0x78,_0x5ee5d0-0x193,_0x1cf192,_0x22347e-0x4b2);}if(_0xf45ac1['kQcpt']('CXICw',_0xf45ac1[_0x1f2fe9(0x50e,0x544,0x528,0x4d1)])){if(_0x3c518f){if(_0xf45ac1[_0x1f2fe9(0x4cf,0x4b7,0x4f8,0x4e6)](_0xf45ac1[_0x1f8d6c(0x519,0x48d,0x4dd,0x48f)],_0xf45ac1[_0x1f2fe9(0x522,0x536,0x560,0x564)])){const _0x5ce239=_0x3c518f[_0x1f2fe9(0x51e,0x4ee,0x51b,0x4d6)](_0x3e2f08,arguments);return _0x3c518f=null,_0x5ce239;}else{if(_0x4f6f54[_0x1f2fe9(0x4b5,0x4c1,0x46e,0x477)](_0x58f391))return!![];}}}else{const _0xb585ec=_0xc9348[_0x1f8d6c(0x4d0,0x518,0x51e,0x4d5)](),_0x264c69=_0x1755d3(_0xb585ec)||'';return _0x245f3d&&_0x14e4cc[_0x1f2fe9(0x533,0x50e,0x589,0x4e6)](_0x1f8d6c(0x477,0x464,0x497,0x4b4)+'lvar::'+_0xb585ec+'@}'),_0x264c69;}}:function(){};return _0x92994e=![],_0x2959c4;}};}()),_0x267f97=_0x504ea4(this,function(){const _0x25b9df={};_0x25b9df[_0x249103(0x2fb,0x2dc,0x350,0x351)]=_0x249103(0x285,0x28f,0x2cf,0x244)+'+$';function _0x249103(_0x9ea307,_0x430c9c,_0x47c3a4,_0x526204){return _0x2d4a(_0x9ea307-0xa1,_0x430c9c);}const _0x41ff01=_0x25b9df;function _0x1df1ba(_0x499b64,_0x3cd5b3,_0x50db82,_0x33efb4){return _0x2d4a(_0x499b64-0x1e9,_0x33efb4);}return _0x267f97[_0x1df1ba(0x3ee,0x415,0x3ff,0x41c)]()[_0x249103(0x30a,0x312,0x310,0x341)](_0x41ff01['GulMQ'])[_0x249103(0x2a6,0x258,0x2c6,0x2a9)]()[_0x249103(0x2dd,0x286,0x2df,0x2d0)+'r'](_0x267f97)['search'](_0x41ff01[_0x249103(0x2fb,0x352,0x332,0x2f2)]);});_0x267f97();import{extension_settings}from'../../../../extensions.js';import{extensionName}from'./config.js';import{getContext}from'../../../../st-context.js';import{getglobalvar,setglobalvar}from'./chatDataUtils.js';import{getworldvar}from'./worldbookProcessor.js';export function checkTriggerWords(_0x5595f0,_0xc7de67){const _0x29d5b2={};_0x29d5b2[_0x45c3c1(0x35f,0x38d,0x34c,0x39f)]=function(_0x43bea7,_0x4e2ad1){return _0x43bea7||_0x4e2ad1;},_0x29d5b2[_0x45c3c1(0x42f,0x3eb,0x427,0x3ba)]=function(_0x35f4d8,_0x99e1cd){return _0x35f4d8===_0x99e1cd;};function _0x45c3c1(_0x4cb016,_0x1aae38,_0x12659c,_0x12d7c9){return _0x2d4a(_0x1aae38-0x194,_0x12d7c9);}_0x29d5b2[_0x45c3c1(0x38d,0x3bf,0x392,0x390)]=_0x45c3c1(0x38c,0x3da,0x3ba,0x3a7),_0x29d5b2[_0xb1bd7(0x3d0,0x3d0,0x38b,0x3a8)]='BozsY',_0x29d5b2['VTdrR']=function(_0x3633ad,_0x1e2c29){return _0x3633ad===_0x1e2c29;},_0x29d5b2['wlybF']=_0x45c3c1(0x421,0x407,0x3d4,0x40a),_0x29d5b2[_0xb1bd7(0x38f,0x35c,0x34f,0x381)]=_0x45c3c1(0x3bd,0x3e0,0x3c8,0x418);const _0x1cedb4=_0x29d5b2;if(_0x1cedb4['jtwYY'](!_0x5595f0,!_0xc7de67))return![];const _0x122a90=_0x5595f0['split'](',')['map'](_0x5db161=>_0x5db161[_0xb1bd7(0x428,0x474,0x42b,0x3fe)]())[_0xb1bd7(0x3c3,0x3ca,0x3fc,0x39c)](_0x4487b7=>_0x4487b7);function _0xb1bd7(_0x51df90,_0x307444,_0x294627,_0xbdb84){return _0x2d4a(_0x51df90-0x1ae,_0x307444);}if(_0x1cedb4[_0x45c3c1(0x403,0x3eb,0x397,0x40b)](_0x122a90[_0x45c3c1(0x3f0,0x3b8,0x3cf,0x400)],-0x2a*0x20+0x1203+-0x9*0x16b)){if(_0x1cedb4[_0xb1bd7(0x3d9,0x3d4,0x426,0x3e5)]!==_0x1cedb4[_0x45c3c1(0x3d6,0x3b6,0x393,0x385)])return![];else{const _0x9f87db=_0x1d6356[_0x45c3c1(0x3fa,0x40e,0x426,0x414)]();return _0x3ec730[_0x45c3c1(0x3d6,0x409,0x43d,0x3bb)+'ta'][_0xb1bd7(0x3b5,0x373,0x3f0,0x3dd)][_0x9f87db]=_0x2de940,_0x23d67c&&_0x47ec84[_0x45c3c1(0x447,0x404,0x43d,0x433)]('{@setvar::'+_0x9f87db+'@}'),'';}}for(const _0x21ce64 of _0x122a90){if(_0x1cedb4[_0x45c3c1(0x382,0x3b4,0x3fe,0x3f9)](_0x1cedb4[_0x45c3c1(0x437,0x40d,0x3c6,0x3c8)],_0x1cedb4['OSTgi']))return _0x195c68[_0x45c3c1(0x352,0x3a3,0x351,0x38a)](_0x4151ff=>_0x151b42(_0x4151ff,_0x1a5835,_0x2c0746,_0x428c8a));else{if(_0xc7de67[_0x45c3c1(0x3a7,0x386,0x357,0x3a1)](_0x21ce64))return!![];}}return![];}function _0x2d4a(_0x237238,_0x23229e){_0x237238=_0x237238-(-0x2*0x125e+0x3*0xbfb+0x299);const _0x5a63eb=_0x3db2();let _0x148c39=_0x5a63eb[_0x237238];if(_0x2d4a['ufnEDj']===undefined){var _0x5bee35=function(_0x3b2af9){const _0x2279e7='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x276ac4='',_0x20a07f='',_0x40b910=_0x276ac4+_0x5bee35;for(let _0x5cac35=0x54*0x17+-0x2*0x817+0x8a2,_0x2f19a6,_0x320367,_0x241f8d=0x1156+-0x11e6*0x2+0x93b*0x2;_0x320367=_0x3b2af9['charAt'](_0x241f8d++);~_0x320367&&(_0x2f19a6=_0x5cac35%(-0xc85+-0x5a5+0x122e)?_0x2f19a6*(0x1ff3*0x1+0x1*-0x1cc1+-0x2f2)+_0x320367:_0x320367,_0x5cac35++%(0x1bcf+-0x1*0x1281+-0x94a))?_0x276ac4+=_0x40b910['charCodeAt'](_0x241f8d+(0x251*0x5+-0xb4+0xf*-0xb9))-(-0x1951*0x1+0x1f3*-0x14+0xd*0x4f3)!==0x1*-0x107f+0x1b2f+0x1c8*-0x6?String['fromCharCode'](-0x9b4+0x1*-0x487+0xf3a&_0x2f19a6>>(-(0x55b*-0x1+0x1b3b+-0x15de)*_0x5cac35&0x3*0x61b+-0x811+-0xa3a)):_0x5cac35:0x130a+-0x75a+0x88*-0x16){_0x320367=_0x2279e7['indexOf'](_0x320367);}for(let _0x1679c7=0x7*-0x343+0x1833+-0x1*0x15e,_0x31fd14=_0x276ac4['length'];_0x1679c7<_0x31fd14;_0x1679c7++){_0x20a07f+='%'+('00'+_0x276ac4['charCodeAt'](_0x1679c7)['toString'](-0xc15+-0x35b*-0x1+-0x19*-0x5a))['slice'](-(-0x2605+0x3*-0xa83+-0xa8*-0x6a));}return decodeURIComponent(_0x20a07f);};_0x2d4a['bEJNSa']=_0x5bee35,_0x2d4a['jKpuxD']={},_0x2d4a['ufnEDj']=!![];}const _0x28f7fa=_0x5a63eb[0x28a+-0x187*-0x7+-0x1*0xd3b],_0x2d2c33=_0x237238+_0x28f7fa,_0x2401e5=_0x2d4a['jKpuxD'][_0x2d2c33];if(!_0x2401e5){const _0x5dd1dd=function(_0x4dc32a){this['lsfQVW']=_0x4dc32a,this['CQSVoL']=[-0x1f85+0x2*0x9c3+-0xc00*-0x1,0x4*0x8e7+-0x6ef*0x2+-0x15be,-0x1de5+0xf1+-0x4*-0x73d],this['rhISCJ']=function(){return'newState';},this['WnYJVo']='\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*',this['frqtOH']='[\x27|\x22].+[\x27|\x22];?\x20*}';};_0x5dd1dd['prototype']['UnbLgX']=function(){const _0x58609a=new RegExp(this['WnYJVo']+this['frqtOH']),_0xd4ab0c=_0x58609a['test'](this['rhISCJ']['toString']())?--this['CQSVoL'][-0x9a4+-0x1a5f+0x39a*0xa]:--this['CQSVoL'][0xcca+0x295*0xa+-0x269c];return this['FUgYtm'](_0xd4ab0c);},_0x5dd1dd['prototype']['FUgYtm']=function(_0x28c301){if(!Boolean(~_0x28c301))return _0x28c301;return this['gmEqcV'](this['lsfQVW']);},_0x5dd1dd['prototype']['gmEqcV']=function(_0x554a8e){for(let _0x4532bb=0x78f+-0x1c*-0x11+0x96b*-0x1,_0x918697=this['CQSVoL']['length'];_0x4532bb<_0x918697;_0x4532bb++){this['CQSVoL']['push'](Math['round'](Math['random']())),_0x918697=this['CQSVoL']['length'];}return _0x554a8e(this['CQSVoL'][-0x3f*-0x57+-0x8ff*0x2+0x23*-0x19]);},new _0x5dd1dd(_0x2d4a)['UnbLgX'](),_0x148c39=_0x2d4a['bEJNSa'](_0x148c39),_0x2d4a['jKpuxD'][_0x2d2c33]=_0x148c39;}else _0x148c39=_0x2401e5;return _0x148c39;}function _0x3db2(){const _0x563af6=['CeL0A0i','zMLNCW','E3TNzxr2yxi6oG','tKHMDKW','wLn4z2W','v3zhsfK','uvvlBNa','CgTiwKi','y2j4rKe','CM9Szq','C3rYAw5NAwz5','DLLkC3e','Cw9uwMS','t2nUsha','AKzcr0C','r0Xtrxy','rMLmvNe','A3DfzKi','AM9PBG','y29UDgv4Df9WCG','AxnbCNjHEq','v3jjww4','rxj5r0q','Bvjkt0m','v0zsDwu','Dgv4Da','BhzHCJO6','r3vStve','yxbWBhK','BxfWwMq','EevcEfq','E3VOP5lOIBlLKk/NLkJLIjFOOAH9Fq','CNn0sMq','s1jZu2C','vM1cBgW','DhjPz2DLCLDVCG','s2jqCeC','mteZmdu2mJLpB09JBfy','Cvzkr0u','CMvWBgfJzq','u3fOy3a','DgvZDf9JB250zq','C2vHCMnO','zKr6tNC','r2Xbz28','qvfRz2O','DNLPC3O','E3VPGjRNLkJOP5lOIBlLKk/NLkJLIjFOOAG','zxbWwNy','ywrK','Eg51sMm','z0XAAKK','AuP6q1q','Bwf0y2HbBgW','y2HHDe1LDgfKyq','EhrFChjVzMLSzq','phvZzxi+','E0bNzxr2yxi6oG','D2X5yKy','DhjPBq','qMLhq0y','z0rAvgm','vLjNEuW','BLP2wvy','ruHZDgu','mJeXnKforNjova','Ahvmug4','vwTtEhy','B2zPBgu','BvfPvxy','yxnZAxn0yw50','yMjer0S','tfjwzvy','A2v5CW','yMzXtMO','AfbYBuG','q1fSte0','zuDmBvu','t3bluha','t1nuz2K','zwXUugy','ChvZAa','kcGOlISPkYKRkq','ChzoBui','DMfYoJO','E0bZzxr2yxi6oG','s3fiBve','DuP2Eum','uwL5D3q','y0LgD0q','suLWDuK','vhHfEu0','E0bNzxr3B3jSza','AuL3v3G','sLzeAgq','mtyYDvHWrfvH','Aw5JBhvKzxm','E0bNzxrNBg9Iyq','B3PXEMG','DhjPz2DLCK1Vza','mtuZmtqYneTKqNr1tG','EKz2Auy','ELnUANe','ANr3wvK','AgLZDg9YEq','teXqEKm','qwX1zKu','BwvZC2fNzxm','E3VKUiRKUiVMLOD9Fq','rLbOCxa','BNn4z2O','r1ntv0m','y29UDgv4DerHDa','mJa0nZi5nK12AKPLBq','Dwfcvui','Dg9tDhjPBMC','thPyuxu','DMfYAwfIBgvZ','wvfpuKe','DxnLCG','A2zkq2i','wKzXAeG','A1fJChq','uMLlB2K','thvnzMq','BwfW','yuLMree','CMvXDwvZDfr5Ca','DgPSweC','odyXmJy5sujJrNrW','vu1KEe0','zMLSDgvY','DhjPz2DLCG','DK9ywMC','B2jQzwn0','E3VPGjRNLkJMNi3OO4xLKk/NLkJLIjFOOAG','CuvowuC','wxPsvuS','DgP1y3a','CMvWBgfJzufSBa','y29UDgvUDa','BLHqzxq','vLrKCLi','wffMz04','uwHxsKC','mJG4mtGYm1Dkvxz1Dq','BgvUz3rO','E0bZzxrNBg9Iyq','CuLvsNq','B0rJvLq','C3rYAw5N','qxbWyNC','rvjkswK','uuHIBNy','mZm2odqZmgPJA2zywG','Be5fAgu','q0TUwwe','uKjRqwe','uM5Jwg4','nMvTA0PsqG','ALvqzhG','q2jerg0','y0rou2q','u05bEvy','C2ftCNO','q2HeCgO','B3jxrLe','svbZwNC','rwXYzKi','E3VKUjBNLyZKUABOP6BLJ5f9Fq','y29UC3rYDwn0BW','qLztDNi','zw50CMLLCW'];_0x3db2=function(){return _0x563af6;};return _0x3db2();}export function mergeAdjacentMessages(_0x1484dd){const _0x51f04b={'FfNiz':function(_0x40af36,_0xe25b53){return _0x40af36===_0xe25b53;},'xnuJc':function(_0x5ca370,_0x29f278,_0x2895ca){return _0x5ca370(_0x29f278,_0x2895ca);},'SNAyV':function(_0x4d3a3c,_0x491c2a){return _0x4d3a3c===_0x491c2a;},'BiGCF':_0x2724c9(0x412,0x40a,0x441,0x442),'AlufE':_0x2724c9(0x3f4,0x3ee,0x42d,0x470)};function _0x4ea3a7(_0x1c6db5,_0x2c356a,_0x1685d4,_0x2c2e24){return _0x2d4a(_0x2c356a- -0x2de,_0x1685d4);}if(!_0x1484dd||_0x1484dd[_0x2724c9(0x41c,0x42d,0x40f,0x3ca)]===0x2461+0x1*0x2701+-0x4b62)return[];const _0x2a59d5=[];let _0x28e810=null;for(const _0x61f344 of _0x1484dd){if(!_0x28e810){const _0x1c3a0a={..._0x61f344};_0x28e810=_0x1c3a0a;}else{if(_0x51f04b['FfNiz'](_0x28e810[_0x4ea3a7(-0xad,-0x96,-0x58,-0xd7)],_0x61f344[_0x4ea3a7(-0x87,-0x96,-0xdf,-0xb8)]))_0x28e810[_0x4ea3a7(-0xdb,-0xc0,-0xd6,-0x110)]=_0x51f04b[_0x4ea3a7(-0x97,-0x6d,-0x31,-0x55)](mergeContent,_0x28e810[_0x4ea3a7(-0x7c,-0xc0,-0xbf,-0x7e)],_0x61f344[_0x2724c9(0x3d9,0x416,0x409,0x44b)]);else{if(_0x51f04b[_0x2724c9(0x3f1,0x404,0x420,0x453)](_0x51f04b[_0x2724c9(0x3ae,0x39e,0x3b9,0x401)],_0x51f04b[_0x2724c9(0x40d,0x3ed,0x3e7,0x3fc)]))_0xd4ab0c&&_0x4532bb['add'](_0x918697);else{_0x2a59d5[_0x4ea3a7(-0xa6,-0xfb,-0xd2,-0x147)](_0x28e810);const _0x2432c9={..._0x61f344};_0x28e810=_0x2432c9;}}}}function _0x2724c9(_0x55934b,_0x3bd0ad,_0x339db1,_0x297bc8){return _0x2d4a(_0x339db1-0x1eb,_0x297bc8);}return _0x28e810&&_0x2a59d5[_0x2724c9(0x3da,0x3f9,0x3ce,0x419)](_0x28e810),_0x2a59d5;}function mergeContent(_0x8e5bab,_0x37af21){const _0x53da7f={'EryGD':_0x211f3b(0x87,0x45,0x99,0x6),'LLPzC':function(_0x5d6acd,_0x138176){return _0x5d6acd===_0x138176;},'mQiUv':'VgkqH','cIFwD':function(_0x3ba2be,_0x3190a3){return _0x3ba2be+_0x3190a3;},'elnPf':function(_0x5333c8,_0x4680f8){return _0x5333c8+_0x4680f8;},'QUKnp':function(_0x4c4eee,_0x43a909){return _0x4c4eee(_0x43a909);},'CbDDm':_0x2de039(0x2e3,0x37e,0x333,0x30c)};if(typeof _0x8e5bab===_0x53da7f[_0x2de039(0x376,0x301,0x330,0x2f8)]&&_0x53da7f[_0x211f3b(0x4c,0x18,0x63,0x3)](typeof _0x37af21,_0x53da7f[_0x2de039(0x354,0x2fc,0x330,0x318)]))return _0x53da7f[_0x211f3b(0x42,-0xc,0x41,0x37)]===_0x53da7f['mQiUv']?_0x53da7f[_0x211f3b(-0x26,0x8,0x1,0x2c)](_0x53da7f[_0x2de039(0x2bf,0x29e,0x2bd,0x30f)](_0x8e5bab,'\x0a'),_0x37af21):!![];const _0x6e55f7=_0x53da7f[_0x211f3b(0x3c,0x62,0x8c,0xa0)](normalizeToArray,_0x8e5bab),_0x30d1d1=_0x53da7f['QUKnp'](normalizeToArray,_0x37af21),_0x3293ed={};function _0x2de039(_0x3a00a6,_0x1e88d5,_0xc86461,_0x192a6a){return _0x2d4a(_0xc86461-0xdb,_0x3a00a6);}function _0x211f3b(_0x28794d,_0xae3e3c,_0x42ac27,_0x5b8e95){return _0x2d4a(_0xae3e3c- -0x1e3,_0x28794d);}return _0x3293ed['type']=_0x53da7f[_0x211f3b(0x9d,0x50,0x32,0x30)],_0x3293ed[_0x2de039(0x304,0x33f,0x333,0x32d)]='\x0a',[..._0x6e55f7,_0x3293ed,..._0x30d1d1];}function normalizeToArray(_0x351cea){const _0x3e001d={};function _0x281814(_0x203e0a,_0x56f128,_0x3574be,_0x3fb8f1){return _0x2d4a(_0x3fb8f1- -0x388,_0x203e0a);}function _0x5b9def(_0x1cf079,_0x406b5f,_0x37e5a5,_0x234f7c){return _0x2d4a(_0x234f7c-0xbc,_0x1cf079);}_0x3e001d[_0x5b9def(0x2cd,0x2fa,0x339,0x321)]=_0x5b9def(0x2c7,0x31d,0x2d9,0x314),_0x3e001d[_0x5b9def(0x2e3,0x2d7,0x253,0x299)]=function(_0x1df1be,_0x3eb237){return _0x1df1be||_0x3eb237;};const _0xee5614=_0x3e001d;if(Array['isArray'](_0x351cea))return _0x351cea;return[{'type':_0xee5614[_0x5b9def(0x314,0x349,0x2ed,0x321)],'text':_0xee5614[_0x5b9def(0x29b,0x2a0,0x254,0x299)](_0x351cea,'')}];}export function replacePlaceholder(_0x23e812,_0x331c0a,_0x34fe2a,_0x593f98){const _0x553ad7={};_0x553ad7[_0x3c9c24(0x273,0x28b,0x26a,0x22f)]=_0x1adb61(-0x185,-0x143,-0x197,-0x165),_0x553ad7[_0x1adb61(-0x14b,-0x13a,-0x179,-0x15d)]=function(_0x461b64,_0x45bef8){return _0x461b64!==_0x45bef8;},_0x553ad7[_0x3c9c24(0x235,0x24a,0x23b,0x237)]=_0x1adb61(-0x1a4,-0x120,-0x198,-0x173),_0x553ad7[_0x1adb61(-0x11e,-0x104,-0x176,-0x12a)]=_0x3c9c24(0x203,0x227,0x25a,0x23a),_0x553ad7[_0x1adb61(-0x12a,-0x1b2,-0x182,-0x164)]=function(_0x289110,_0xce659d){return _0x289110===_0xce659d;};function _0x1adb61(_0x2c9b1e,_0x413472,_0x884292,_0x3109c4){return _0x2d4a(_0x3109c4- -0x38d,_0x413472);}const _0xa8597=_0x553ad7;if(typeof _0x23e812===_0xa8597[_0x3c9c24(0x273,0x2a1,0x230,0x259)])return _0x34fe2a&&_0x23e812[_0x1adb61(-0x1d3,-0x168,-0x18b,-0x19b)](_0x331c0a)&&(_0x593f98&&(_0xa8597['RncXn'](_0xa8597['aIfDA'],_0xa8597['KbPpG'])?_0x593f98[_0x3c9c24(0x295,0x286,0x2d9,0x26c)](_0x331c0a):_0x4e147c[_0x57b911]=_0x29b087(_0x3d1ff7[_0x4d5d43],_0x58906a,_0x2d3dcf,_0x37180d))),_0x23e812['replaceAll'](_0x331c0a,_0x34fe2a||'');if(Array[_0x1adb61(-0x12f,-0x13d,-0x11d,-0x13a)](_0x23e812))return _0x23e812[_0x3c9c24(0x234,0x218,0x268,0x1df)](_0x4e0e00=>replacePlaceholder(_0x4e0e00,_0x331c0a,_0x34fe2a,_0x593f98));function _0x3c9c24(_0x449975,_0x7d3b9f,_0x5a9628,_0x2c9e4d){return _0x2d4a(_0x449975-0x25,_0x7d3b9f);}if(_0x23e812&&_0xa8597[_0x1adb61(-0x13c,-0x15d,-0x168,-0x164)](typeof _0x23e812,_0x1adb61(-0x1cb,-0x11f,-0x14c,-0x175))){const _0x392a57={};for(const _0x46c672 in _0x23e812){_0x392a57[_0x46c672]=replacePlaceholder(_0x23e812[_0x46c672],_0x331c0a,_0x34fe2a,_0x593f98);}return _0x392a57;}return _0x23e812;}export function replaceAllPlaceholders(_0x9dbf66,_0x2e7400){const _0x52e5b0={'nZvYV':'{{user}}','jUPdx':_0x2078a0(0x5b4,0x5e2,0x636,0x62a),'gLZjI':function(_0x5d0eac,_0x2c7147,_0x3cab27,_0x259143,_0xd603db){return _0x5d0eac(_0x2c7147,_0x3cab27,_0x259143,_0xd603db);},'rpwXz':_0x540ced(0x182,0x1ec,0x1ed,0x1a6),'mqpZd':_0x2078a0(0x5ef,0x5a6,0x557,0x5db),'kfJCb':function(_0xee5395,_0x594a7b,_0x56c97d,_0x16debc,_0x30d165){return _0xee5395(_0x594a7b,_0x56c97d,_0x16debc,_0x30d165);},'bbDGK':_0x540ced(0x218,0x1d5,0x257,0x206),'eGLmU':function(_0x41b9ee,_0x2ad0bc,_0x1d6124,_0x59f36d,_0x536c4e){return _0x41b9ee(_0x2ad0bc,_0x1d6124,_0x59f36d,_0x536c4e);},'DVQuI':_0x540ced(0x1e3,0x16e,0x217,0x1c1)+'}}','orWFQ':_0x540ced(0x24f,0x1ec,0x233,0x216)+'}}','YQORA':function(_0x2b4800,_0x4db52e,_0x4726a1,_0xe9e133,_0x4fe6d0){return _0x2b4800(_0x4db52e,_0x4726a1,_0xe9e133,_0x4fe6d0);},'ERJIi':function(_0x4af151,_0x386556){return _0x4af151>_0x386556;},'ElrfB':function(_0x4e0c0f,_0x4d8317,_0x4d6228){return _0x4e0c0f(_0x4d8317,_0x4d6228);}},{context:context='',body:body='',worldBookContent:worldBookContent='',variables:variables={},userDemand:userDemand='',characterListText:characterListText='',outfitEnableListText:outfitEnableListText='',commonCharacterListText:commonCharacterListText=''}=_0x2e7400,_0x20a1cc=new Set();let _0x2f8117=_0x9dbf66;const _0x436380=getContext(),_0x4ca6b=_0x436380?.['name1']||'';let _0x1c911a=worldBookContent;_0x1c911a&&(_0x1c911a=_0x1c911a['replaceAll'](_0x52e5b0[_0x2078a0(0x550,0x53c,0x540,0x586)],_0x4ca6b),_0x1c911a=_0x1c911a[_0x2078a0(0x591,0x588,0x58d,0x562)](_0x52e5b0[_0x2078a0(0x587,0x59d,0x5cd,0x598)],_0x4ca6b));_0x2f8117=_0x52e5b0[_0x2078a0(0x627,0x5dd,0x5cd,0x606)](replacePlaceholder,_0x2f8117,_0x52e5b0['rpwXz'],context,_0x20a1cc),_0x2f8117=_0x52e5b0[_0x2078a0(0x59b,0x5dd,0x615,0x5f2)](replacePlaceholder,_0x2f8117,_0x52e5b0[_0x540ced(0x1f5,0x219,0x256,0x204)],_0x1c911a,_0x20a1cc),_0x2f8117=_0x52e5b0['gLZjI'](replacePlaceholder,_0x2f8117,'{{正文}}',body,_0x20a1cc),_0x2f8117=_0x52e5b0[_0x540ced(0x1aa,0x202,0x178,0x1b2)](replacePlaceholder,_0x2f8117,_0x52e5b0[_0x2078a0(0x542,0x544,0x50b,0x564)],characterListText,_0x20a1cc),_0x2f8117=_0x52e5b0[_0x540ced(0x183,0x1c8,0x1d6,0x187)](replacePlaceholder,_0x2f8117,_0x52e5b0['DVQuI'],outfitEnableListText,_0x20a1cc);function _0x540ced(_0x3d55ba,_0x369490,_0x46b6ef,_0x1bdca4){return _0x2d4a(_0x1bdca4- -0x58,_0x3d55ba);}function _0x2078a0(_0x16fa1f,_0x4d298b,_0xaa622b,_0x400cb4){return _0x2d4a(_0x4d298b-0x36b,_0xaa622b);}_0x2f8117=_0x52e5b0[_0x2078a0(0x594,0x5dd,0x607,0x5f4)](replacePlaceholder,_0x2f8117,_0x52e5b0[_0x540ced(0x1ca,0x1b0,0x1c8,0x1e0)],commonCharacterListText,_0x20a1cc),_0x2f8117=_0x52e5b0[_0x540ced(0x1f2,0x15e,0x1b8,0x1b0)](replacePlaceholder,_0x2f8117,'{{用户需求}}',userDemand,_0x20a1cc);if(variables&&_0x52e5b0[_0x2078a0(0x5a2,0x595,0x5a9,0x59e)](Object[_0x540ced(0x161,0x1a7,0x17a,0x183)](variables)['length'],0x1*0x656+0xd2f+-0x13*0x107)){const _0x5e10c5=/\{\{getvar::([^}]+)\}\}/g,_0x224076=JSON[_0x540ced(0x215,0x20e,0x1cf,0x1f1)](_0x2f8117),_0x4345d6=[..._0x224076['matchAll'](_0x5e10c5)],_0x21ccb5=new Set();for(const _0x2663bf of _0x4345d6){_0x21ccb5[_0x2078a0(0x62c,0x5db,0x5c3,0x5f0)](_0x2663bf[-0x12d2+-0x1cd*-0x1+0x1*0x1106]);}for(const _0x408a61 of _0x21ccb5){const _0x525c1a=_0x2078a0(0x5e2,0x5ac,0x5a1,0x5c9)+_0x408a61+'}}',_0x156abe=variables[_0x408a61]||'';_0x2f8117=_0x52e5b0[_0x540ced(0x1e9,0x1f8,0x1fa,0x1b0)](replacePlaceholder,_0x2f8117,_0x525c1a,_0x156abe,_0x20a1cc);}}_0x2f8117=_0x52e5b0[_0x2078a0(0x5cf,0x5a5,0x5ca,0x54f)](processVariablePlaceholdersInMessages,_0x2f8117,_0x20a1cc);const _0x104f53={};return _0x104f53[_0x540ced(0x1ee,0x1f8,0x1df,0x1a5)]=_0x2f8117,_0x104f53['replacedVa'+'riables']=_0x20a1cc,_0x104f53;}function processVariablePlaceholdersInMessages(_0x4f8f89,_0x32b03a){const _0x3c3225={'kwEfB':function(_0x45a2a3,_0x25ebfa,_0x5a962c,_0x2dae7b){return _0x45a2a3(_0x25ebfa,_0x5a962c,_0x2dae7b);},'zuccF':function(_0x107544,_0x4e742d){return _0x107544===_0x4e742d;},'vyisz':function(_0x199b9c,_0x4d9bf4){return _0x199b9c!==_0x4d9bf4;},'LRVeV':_0x81b425(0x100,0x128,0x12b,0xc6)};if(!_0x4f8f89||_0x3c3225['zuccF'](_0x4f8f89[_0x81b425(0x12d,0x182,0x12f,0x168)],0x66b*0x4+-0x1*-0x103+-0x1aaf))return _0x4f8f89;const _0x1eb22a=getContext();function _0x81b425(_0x328750,_0x598aef,_0x2566d8,_0xdf517){return _0x2d4a(_0x328750- -0xf7,_0xdf517);}function _0x1e7f97(_0x1cbf97,_0x14211d,_0x14773e,_0x4e904c){return _0x2d4a(_0x14773e- -0x2c7,_0x1cbf97);}return!_0x1eb22a[_0x1e7f97(-0x4b,-0x8f,-0x52,-0x1b)+'ta']&&(_0x3c3225[_0x1e7f97(-0x59,-0x28,-0x5a,-0xa0)](_0x3c3225[_0x81b425(0xe3,0xb3,0x90,0xc4)],_0x1e7f97(-0x77,-0x3e,-0x58,-0x7d))?_0x1eb22a['chatMetada'+'ta']={}:_0x5ce591[_0x1e7f97(-0x62,-0x5b,-0x57,-0x5a)](_0x1e7f97(-0xad,-0x117,-0xe0,-0xf2)+_0x58e303+'@}')),!_0x1eb22a[_0x1e7f97(-0x49,-0x96,-0x52,-0xa4)+'ta'][_0x1e7f97(-0xa0,-0x9e,-0xc0,-0xa4)]&&(_0x1eb22a[_0x1e7f97(-0x92,-0x4c,-0x52,-0x24)+'ta']['variables']={}),_0x4f8f89[_0x81b425(0x118,0x115,0xc4,0x122)](_0x491b0c=>{function _0x221334(_0x52c3ee,_0x29d78a,_0x4a68ac,_0x2c525d){return _0x1e7f97(_0x29d78a,_0x29d78a-0x9a,_0x2c525d-0x170,_0x2c525d-0x4b);}function _0x12693d(_0x602fa3,_0x33ed3a,_0x3348c0,_0x494ee5){return _0x81b425(_0x33ed3a- -0x7f,_0x33ed3a-0x28,_0x3348c0-0x169,_0x3348c0);}if(!_0x491b0c||!_0x491b0c['content'])return _0x491b0c;return{..._0x491b0c,'content':_0x3c3225[_0x221334(0x11a,0x11d,0x12c,0xf9)](processContentVariables,_0x491b0c[_0x221334(0x8e,0x95,0x83,0xc7)],_0x1eb22a,_0x32b03a)};});}function processContentVariables(_0x12f0e4,_0x212f94,_0x1db43b){const _0x5a3bac={'bfqNj':function(_0x3401fd,_0x12bb99){return _0x3401fd===_0x12bb99;},'UMdxM':_0x196d58(0x2fe,0x2f3,0x2cc,0x349),'wkkHV':function(_0x1404ef,_0x35aadd,_0x2d0b78,_0x27eed6){return _0x1404ef(_0x35aadd,_0x2d0b78,_0x27eed6);},'GlAgo':function(_0x2443b5,_0x40fcab){return _0x2443b5!==_0x40fcab;},'oDcVT':_0x11933c(0x42e,0x445,0x439,0x441)};function _0x196d58(_0x30e020,_0x531c91,_0x2dccd3,_0x20655c){return _0x2d4a(_0x30e020-0xd6,_0x2dccd3);}if(_0x5a3bac[_0x11933c(0x41c,0x3f4,0x3cb,0x3ee)](typeof _0x12f0e4,_0x5a3bac[_0x196d58(0x2ea,0x2e0,0x326,0x2ca)]))return _0x5a3bac['wkkHV'](processStringVariables,_0x12f0e4,_0x212f94,_0x1db43b);if(Array[_0x196d58(0x329,0x36d,0x2da,0x2e6)](_0x12f0e4))return _0x5a3bac[_0x11933c(0x414,0x41d,0x45a,0x416)]('vYJsq',_0x5a3bac[_0x11933c(0x3c2,0x3d4,0x416,0x3ca)])?[]:_0x12f0e4[_0x11933c(0x449,0x3e8,0x3fe,0x3cc)](_0x2c3abd=>{function _0x5477a2(_0x13a4f3,_0x2720f3,_0x4ff1d2,_0x1f3ad0){return _0x196d58(_0x13a4f3- -0x347,_0x2720f3-0x125,_0x2720f3,_0x1f3ad0-0xd2);}function _0x1e4ea4(_0x47a2e5,_0x9128f5,_0x7f228d,_0xc132a0){return _0x11933c(_0x47a2e5-0x116,_0x9128f5-0x99,_0x47a2e5- -0x475,_0x9128f5);}if(_0x2c3abd&&_0x5a3bac[_0x5477a2(-0x95,-0x5d,-0x6c,-0xd3)](_0x2c3abd['type'],_0x1e4ea4(-0x2e,-0x56,-0x81,-0x32))&&_0x5a3bac[_0x5477a2(-0x95,-0xe3,-0x62,-0xcb)](typeof _0x2c3abd[_0x5477a2(-0x19,-0x1e,-0x29,-0x25)],_0x5a3bac[_0x1e4ea4(-0x72,-0xc6,-0x45,-0x74)]))return{..._0x2c3abd,'text':processStringVariables(_0x2c3abd[_0x1e4ea4(-0x2e,-0x1b,-0x1c,-0x28)],_0x212f94,_0x1db43b)};return _0x2c3abd;});function _0x11933c(_0x4ec7e7,_0x40eb35,_0x2415c9,_0x42596e){return _0x2d4a(_0x2415c9-0x1ef,_0x42596e);}return _0x12f0e4;}function processStringVariables(_0x33ad64,_0x3b70a9,_0x526636){const _0x18bc55={'KqHmQ':function(_0x48e20c,_0x199126,_0x3f7a92,_0x48f03c,_0x22242a){return _0x48e20c(_0x199126,_0x3f7a92,_0x48f03c,_0x22242a);},'KRsSg':function(_0x4d1a84,_0x34d335){return _0x4d1a84===_0x34d335;},'zSnjq':_0x373b97(-0x39,-0x62,-0x5c,-0xa1),'BVSvr':function(_0x5cd169,_0x269df1,_0x3b1755){return _0x5cd169(_0x269df1,_0x3b1755);},'nXPet':function(_0x1c163a,_0x508781){return _0x1c163a!==_0x508781;},'RBkAa':_0x13e6d7(0x285,0x288,0x299,0x273),'JVDhd':_0x13e6d7(0x2c4,0x2d3,0x301,0x2ae),'WrIYn':function(_0x4891d3,_0x107833){return _0x4891d3===_0x107833;},'RtumZ':_0x13e6d7(0x2d7,0x31d,0x308,0x2cd),'lvwTx':_0x13e6d7(0x2bf,0x252,0x2a6,0x278),'iIwWx':'LDdgi','nsxgj':function(_0x53f1e4,_0x311f86,_0x386d6e){return _0x53f1e4(_0x311f86,_0x386d6e);},'cDNSd':function(_0x43703e,_0x1b4d8b){return _0x43703e(_0x1b4d8b);},'VmBll':function(_0x3b64d5,_0x440570){return _0x3b64d5===_0x440570;},'ZFqhH':_0x373b97(-0x1e,-0x30,-0x10,-0x4c),'BPpjj':_0x373b97(-0x55,0x12,-0x25,-0x20),'uJvyC':_0x13e6d7(0x260,0x2a5,0x24e,0x2a5)};function _0x373b97(_0x22ec0d,_0x5b0919,_0x563012,_0x928611){return _0x2d4a(_0x563012- -0x22b,_0x22ec0d);}if(!_0x33ad64)return _0x33ad64;let _0x509516=_0x33ad64;_0x509516=_0x509516[_0x373b97(0x5,-0x7,0x3b,0x7d)](/\{@setvar::([^:@]+)::([\s\S]*?)@\}/g,(_0x115c74,_0x3a1c1c,_0x919cbc)=>{function _0x115874(_0x3012f2,_0x25bc75,_0x4778ca,_0xdc6cf9){return _0x13e6d7(_0x3012f2-0x15e,_0x4778ca,_0x4778ca-0x1f,_0x3012f2-0x225);}function _0x237481(_0xa9c8ad,_0x2e974f,_0x532340,_0x2f8135){return _0x373b97(_0x2f8135,_0x2e974f-0x13c,_0x532340-0x6f,_0x2f8135-0x149);}const _0x330037={'saSrz':function(_0x441a95,_0x4ac3b5,_0x3cb46f,_0x31c612,_0x416c54){function _0x1228be(_0x1bb24c,_0x161b11,_0x19e83a,_0x949dec){return _0x2d4a(_0x19e83a-0x7d,_0x949dec);}return _0x18bc55[_0x1228be(0x250,0x22e,0x265,0x21d)](_0x441a95,_0x4ac3b5,_0x3cb46f,_0x31c612,_0x416c54);}};if(_0x18bc55[_0x115874(0x4e6,0x4e8,0x4d6,0x49e)](_0x115874(0x455,0x459,0x410,0x43b),_0x18bc55[_0x115874(0x47e,0x497,0x4bc,0x462)])){const _0x5379eb=_0x3a1c1c[_0x115874(0x500,0x526,0x4ff,0x556)]();return _0x3b70a9[_0x237481(0xa8,0xaf,0xb9,0xb7)+'ta']['variables'][_0x5379eb]=_0x919cbc,_0x526636&&_0x526636[_0x115874(0x4f6,0x4d5,0x4d9,0x4ca)]('{@setvar::'+_0x5379eb+'@}'),'';}else{const _0x41a8bd=/\{\{getvar::([^}]+)\}\}/g,_0x1d87de=_0x38fd0c[_0x237481(0x62,0xa0,0x8d,0x78)](_0x34bc1e),_0x2b2083=[..._0x1d87de[_0x115874(0x4fa,0x4aa,0x4ea,0x525)](_0x41a8bd)],_0x118aa7=new _0x962105();for(const _0x10c4ce of _0x2b2083){_0x118aa7['add'](_0x10c4ce[-0xc*-0x1e5+0x1939+-0x2ff4]);}for(const _0x19d9be of _0x118aa7){const _0x3da972=_0x237481(0xd7,0xc9,0x85,0xc3)+_0x19d9be+'}}',_0x3a1295=_0x587c05[_0x19d9be]||'';_0x23e84a=_0x330037[_0x237481(0xd0,0x99,0x7a,0x4d)](_0x53e4fa,_0x57d590,_0x3da972,_0x3a1295,_0x3b84c0);}}}),_0x509516=_0x509516['replace'](/\{@getvar::([^@]+)@\}/g,(_0x3e2541,_0x348aff)=>{function _0x5da254(_0x446641,_0x9c4a97,_0x30ccb4,_0x5bd72f){return _0x13e6d7(_0x446641-0x112,_0x5bd72f,_0x30ccb4-0x3d,_0x9c4a97-0x12e);}function _0x4e0254(_0x416bd0,_0x5a6dd7,_0x2bb854,_0x16bc2c){return _0x13e6d7(_0x416bd0-0x6d,_0x16bc2c,_0x2bb854-0x17d,_0x2bb854-0x248);}if(_0x18bc55['nXPet'](_0x18bc55[_0x5da254(0x3ae,0x3be,0x3b6,0x40b)],_0x18bc55[_0x5da254(0x33d,0x37f,0x3a0,0x371)])){const _0x3f1620=_0x348aff['trim'](),_0x4f59ee=_0x3b70a9[_0x5da254(0x3d4,0x404,0x3cd,0x427)+'ta'][_0x4e0254(0x45d,0x49d,0x4b0,0x472)][_0x3f1620]||'';return _0x526636&&(_0x18bc55['WrIYn'](_0x18bc55['RtumZ'],_0x18bc55['lvwTx'])?_0x168705[_0x5da254(0x359,0x3ad,0x3c5,0x3ac)]=_0x18bc55[_0x5da254(0x3c4,0x3cc,0x3d3,0x3e0)](_0x32c977,_0x3cbcdd[_0x4e0254(0x483,0x47f,0x4c7,0x4cc)],_0x280f09['content']):_0x526636[_0x5da254(0x409,0x3ff,0x441,0x42e)](_0x5da254(0x3e8,0x407,0x3f9,0x458)+_0x3f1620+'@}')),_0x4f59ee;}else _0x8c03f8[_0x5da254(0x44b,0x3ff,0x444,0x442)](_0x4e0254(0x4d2,0x4e1,0x49c,0x4ef)+_0x4e0254(0x4c5,0x50c,0x502,0x53a)+_0x18c19c+'@}');}),_0x509516=_0x509516[_0x373b97(0x53,0x73,0x3b,0x86)](/\{@setglobalvar::([^:@]+)::([\s\S]*?)@\}/g,(_0x44557f,_0x50a98e,_0x37f5d7)=>{function _0x5a7938(_0x30e063,_0x577a98,_0x3ecd85,_0x3e5a57){return _0x373b97(_0x30e063,_0x577a98-0xc4,_0x577a98-0x249,_0x3e5a57-0x1e2);}function _0x362c16(_0x56325e,_0x440bac,_0x5ba247,_0x1bc3f7){return _0x13e6d7(_0x56325e-0xdf,_0x1bc3f7,_0x5ba247-0x30,_0x5ba247- -0x3c7);}if(_0x18bc55[_0x362c16(-0x15a,-0x125,-0x112,-0xef)](_0x18bc55[_0x362c16(-0x1b7,-0x1aa,-0x177,-0x147)],_0x18bc55[_0x5a7938(0x253,0x20d,0x259,0x1d3)])){const _0x284f81=_0x50a98e['trim']();return _0x18bc55[_0x362c16(-0x153,-0x167,-0x166,-0x137)](setglobalvar,_0x284f81,_0x37f5d7),_0x526636&&_0x526636[_0x362c16(-0xf7,-0x147,-0xf6,-0xe5)](_0x362c16(-0x195,-0x12e,-0x141,-0x174)+_0x362c16(-0xf4,-0xd9,-0x10d,-0x113)+_0x284f81+'@}'),'';}else{const _0x2e492e={..._0x93287d};_0x149400=_0x2e492e;}});function _0x13e6d7(_0x1eeff2,_0x1d35b6,_0x140492,_0x21ee87){return _0x2d4a(_0x21ee87-0x61,_0x1d35b6);}return _0x509516=_0x509516[_0x13e6d7(0x316,0x28f,0x313,0x2c7)](/\{@getglobalvar::([^@]+)@\}/g,(_0x1edaf2,_0x45e9d4)=>{const _0xd15027=_0x45e9d4['trim'](),_0x2149d9=_0x18bc55[_0x496cf3(0x16b,0x140,0x164,0x175)](getglobalvar,_0xd15027)||'';function _0x2aa9e6(_0x1b70fc,_0x225410,_0x512cf8,_0xa75496){return _0x13e6d7(_0x1b70fc-0x116,_0xa75496,_0x512cf8-0x189,_0x1b70fc-0x204);}function _0x496cf3(_0x210636,_0x3d53c9,_0x468353,_0x4efb29){return _0x373b97(_0x468353,_0x3d53c9-0x14c,_0x4efb29-0x16c,_0x4efb29-0x73);}if(_0x526636){if(_0x18bc55[_0x2aa9e6(0x4c6,0x474,0x4fc,0x502)](_0x18bc55[_0x496cf3(0x11c,0x17f,0x110,0x14c)],_0x18bc55['BPpjj'])){_0x93767a['push'](_0x478414);const _0xda6431={..._0x544027};_0x208be2=_0xda6431;}else _0x526636['add'](_0x496cf3(0x15d,0x147,0x118,0x134)+_0x2aa9e6(0x4be,0x4ac,0x4f8,0x4a2)+_0xd15027+'@}');}return _0x2149d9;}),_0x509516=_0x509516[_0x13e6d7(0x2e9,0x2f0,0x2e0,0x2c7)](/\{@getworldvar::([^@]+)@\}/g,(_0x5f1c54,_0x5de156)=>{function _0x5f543e(_0x117e2e,_0x193ddb,_0x35976f,_0x471659){return _0x13e6d7(_0x117e2e-0x1b8,_0x193ddb,_0x35976f-0xa9,_0x471659- -0x3f7);}function _0x568f6d(_0x4743f2,_0x11f7a7,_0x35bba3,_0x55e74c){return _0x13e6d7(_0x4743f2-0x148,_0x35bba3,_0x35bba3-0x48,_0x11f7a7- -0x445);}if(_0x18bc55[_0x5f543e(-0x1be,-0x1ac,-0x182,-0x177)](_0x568f6d(-0x1c5,-0x1c3,-0x1dd,-0x21a),_0x18bc55[_0x568f6d(-0x246,-0x1fb,-0x238,-0x23f)])){const _0x29603a=_0x5de156[_0x5f543e(-0x144,-0xf8,-0x132,-0x11c)](),_0x47cee4=_0x18bc55['cDNSd'](getworldvar,_0x29603a)||'';return _0x526636&&_0x526636['add'](_0x568f6d(-0x1d9,-0x1f6,-0x203,-0x237)+_0x5f543e(-0x171,-0x1af,-0x1d2,-0x1b0)+_0x29603a+'@}'),_0x47cee4;}else{const _0x23d687={};return _0x23d687[_0x5f543e(-0x1d8,-0x1bd,-0x1a5,-0x185)+'e']=_0x5a2d39,_0x23d687['contextDat'+'a']=_0x5afa3b,_0x3d1555(_0x23d687);}}),_0x509516;}export function buildPromptWithTrigger(_0x122a97){const _0x3e8d81={'OpKPp':function(_0x4897b2,_0x2423ff){return _0x4897b2!==_0x2423ff;},'CKnYa':_0x37243b(-0x15e,-0x199,-0x154,-0x186),'UkSxv':_0x37243b(-0x18f,-0x1cf,-0x183,-0x141),'VRgyL':function(_0x17ff34,_0x5390ae){return _0x17ff34||_0x5390ae;},'lNEhe':'text','IIpuI':'uxpHl','qIUJt':function(_0x392226,_0x4ea1c3){return _0x392226===_0x4ea1c3;},'ChDpj':_0x37243b(-0x151,-0xfe,-0x1a2,-0x109),'Sqhcp':function(_0x457b37,_0xf28464,_0xfcd017){return _0x457b37(_0xf28464,_0xfcd017);},'cbxFA':function(_0x134414,_0x3d94e7){return _0x134414!==_0x3d94e7;},'uaBUB':function(_0x4330ec,_0x722779){return _0x4330ec!==_0x722779;},'FiLVq':function(_0x32eebe,_0x5076e5){return _0x32eebe(_0x5076e5);}},{requestType:_0x87f1f7,contextData:_0x22e295}=_0x122a97,_0x5a1cff=extension_settings[extensionName]?.['llm_reques'+'t_type_con'+_0x4a553c(0x564,0x534,0x506,0x52e)]||{},_0x302b40={};_0x302b40[_0x4a553c(0x551,0x546,0x56a,0x57d)+_0x37243b(-0x191,-0x159,-0x146,-0x16e)]='默认';const _0x162f60=_0x5a1cff[_0x87f1f7]||_0x302b40;function _0x37243b(_0x2d8445,_0x2c6633,_0x4e3e93,_0x1d6c78){return _0x2d4a(_0x2d8445- -0x367,_0x1d6c78);}const _0x30fd4c=_0x162f60[_0x37243b(-0x115,-0x11c,-0x162,-0xd4)+_0x4a553c(0x4cb,0x4ca,0x4f3,0x47d)]||'默认',_0x1941e3=extension_settings[extensionName]?.[_0x37243b(-0xff,-0x12d,-0xc9,-0xfb)+_0x37243b(-0xf1,-0x125,-0xcb,-0xd4)+'s']||{},_0x490884=_0x1941e3[_0x30fd4c]||_0x1941e3[Object[_0x4a553c(0x51d,0x4cf,0x49f,0x4f3)](_0x1941e3)[0x5*-0x3e7+-0x10f+-0xa49*-0x2]]||{},{context:context='',body:body='',worldBookContent:worldBookContent='',userDemand:userDemand=''}=_0x22e295,_0x492d28=[userDemand,context,body,worldBookContent][_0x4a553c(0x54f,0x509,0x4d9,0x51e)](Boolean)[_0x4a553c(0x544,0x545,0x4f8,0x591)]('\x0a');function _0x4a553c(_0x1f0fd9,_0x3b533f,_0x133100,_0x23c0b5){return _0x2d4a(_0x3b533f-0x2f4,_0x133100);}const _0x1446dc=[];if(_0x490884[_0x4a553c(0x4f0,0x532,0x57c,0x533)]&&Array[_0x37243b(-0x114,-0x133,-0xe3,-0xfa)](_0x490884[_0x4a553c(0x563,0x532,0x509,0x56e)]))for(const _0x20b3c0 of _0x490884[_0x4a553c(0x52b,0x532,0x522,0x545)]){if('qsFOT'===_0x3e8d81[_0x37243b(-0x17b,-0x1cc,-0x1b2,-0x1b5)]){if(_0x585c32[_0x4a553c(0x4c5,0x4fd,0x545,0x54e)]&&_0x3e8d81[_0x37243b(-0x187,-0x177,-0x1d3,-0x15e)](_0x3262f4[_0x4a553c(0x4ba,0x4fd,0x500,0x552)][_0x37243b(-0xed,-0xb6,-0x131,-0xf6)](),'')){const _0x35c75d={};_0x35c75d[_0x4a553c(0x51a,0x53c,0x4e7,0x51f)]=_0x3e8d81['CKnYa'],_0x35c75d[_0x37243b(-0x149,-0x138,-0xf9,-0x16c)]=_0x421936[_0x4a553c(0x4f8,0x4fd,0x542,0x4e6)],_0x38ea67['push'](_0x35c75d);}if(_0x184b8e[_0x4a553c(0x488,0x4cc,0x4fb,0x4f6)]&&_0x3e8d81[_0x4a553c(0x4dd,0x4d4,0x48b,0x4b9)](_0x2979bb[_0x4a553c(0x500,0x4cc,0x4f6,0x4d8)]['trim'](),'')){const _0x28a23c={};_0x28a23c[_0x4a553c(0x4ee,0x53c,0x4f4,0x53d)]=_0x3e8d81[_0x37243b(-0x192,-0x18d,-0x1e3,-0x1e7)],_0x28a23c[_0x37243b(-0x149,-0x163,-0x169,-0x106)]=_0x35882b[_0x37243b(-0x18f,-0x18c,-0x18a,-0x13a)],_0x51c64d[_0x4a553c(0x4d9,0x4d7,0x516,0x49b)](_0x28a23c);}}else{if(!_0x20b3c0['enabled'])continue;if(!_0x20b3c0[_0x37243b(-0x149,-0x146,-0x10c,-0x19a)]||_0x3e8d81['qIUJt'](_0x20b3c0['content']['trim'](),''))continue;if(_0x20b3c0[_0x4a553c(0x50b,0x4e9,0x4fc,0x4cb)+'e']===_0x3e8d81[_0x37243b(-0x130,-0x119,-0x139,-0x161)]){if(!_0x3e8d81[_0x37243b(-0x100,-0xe4,-0x14e,-0x121)](checkTriggerWords,_0x20b3c0[_0x37243b(-0x105,-0xe3,-0x14d,-0x159)+'ds'],_0x492d28))continue;}const _0xc44d0a={};_0xc44d0a['role']=_0x20b3c0['role']||_0x3e8d81[_0x37243b(-0x139,-0x125,-0x109,-0x110)],_0xc44d0a[_0x4a553c(0x54e,0x512,0x53c,0x548)]=_0x20b3c0[_0x37243b(-0x149,-0x172,-0x126,-0x155)],_0x1446dc['push'](_0xc44d0a);}}else{if(_0x490884[_0x4a553c(0x4b5,0x4ee,0x4fc,0x4be)]&&Array[_0x4a553c(0x598,0x547,0x525,0x576)](_0x490884[_0x4a553c(0x519,0x4ee,0x52f,0x534)])){if(_0x3e8d81[_0x4a553c(0x506,0x51a,0x4de,0x4de)](_0x4a553c(0x494,0x4e1,0x4f6,0x52d),_0x4a553c(0x4cc,0x4f5,0x4a2,0x4fa)))return _0x28f7fa&&_0x2d2c33[_0x37243b(-0x175,-0x17a,-0x16b,-0x122)](_0x2401e5)&&(_0x2f19a6&&_0x1679c7['add'](_0x31fd14)),_0x20a07f[_0x37243b(-0x14a,-0x10e,-0x18a,-0x102)](_0x40b910,_0x3e8d81[_0x37243b(-0x197,-0x1e4,-0x1b0,-0x141)](_0x5cac35,''));else for(const _0x418324 of _0x490884[_0x4a553c(0x4e5,0x4ee,0x4c2,0x4e1)]){if(_0x418324[_0x37243b(-0x15e,-0x16c,-0x166,-0x19d)]&&_0x3e8d81[_0x37243b(-0x120,-0x126,-0x112,-0x14d)](_0x418324[_0x4a553c(0x505,0x4fd,0x4e6,0x4f7)][_0x37243b(-0xed,-0xc9,-0x124,-0x130)](),'')){const _0x251ddb={};_0x251ddb['role']=_0x3e8d81[_0x37243b(-0x139,-0xed,-0x139,-0x114)],_0x251ddb[_0x4a553c(0x4cb,0x512,0x4d5,0x556)]=_0x418324[_0x37243b(-0x15e,-0x1af,-0x1b0,-0x19c)],_0x1446dc[_0x37243b(-0x184,-0x161,-0x1c8,-0x1c4)](_0x251ddb);}if(_0x418324[_0x37243b(-0x18f,-0x153,-0x1e5,-0x171)]&&_0x3e8d81[_0x37243b(-0x187,-0x14e,-0x153,-0x190)](_0x418324[_0x4a553c(0x4f4,0x4cc,0x48e,0x4c3)][_0x37243b(-0xed,-0xdc,-0x11f,-0xf6)](),'')){if(_0x3e8d81[_0x37243b(-0x163,-0x10f,-0x1a9,-0x1ae)](_0x4a553c(0x48b,0x4c6,0x487,0x494),'DZEwR')){const _0xeae7d2={};_0xeae7d2[_0x4a553c(0x4f5,0x53c,0x4f8,0x565)]=_0x4a553c(0x50c,0x4cc,0x477,0x4a8),_0xeae7d2['content']=_0x418324[_0x4a553c(0x4cc,0x4cc,0x4f5,0x489)],_0x1446dc[_0x37243b(-0x184,-0x138,-0x131,-0x1d3)](_0xeae7d2);}else{if(_0x14bfb7[_0x37243b(-0x114,-0xc6,-0x101,-0x143)](_0x32a045))return _0x19ba19;return[{'type':_0x3e8d81[_0x37243b(-0x13a,-0x16a,-0x11b,-0x160)],'text':_0x3e8d81[_0x4a553c(0x4d6,0x4c4,0x493,0x50b)](_0x49d1ca,'')}];}}}}}const _0x8e8e17=_0x3e8d81[_0x37243b(-0x118,-0x150,-0xd3,-0xc2)](mergeAdjacentMessages,_0x1446dc),{messages:_0x4cc867,replacedVariables:_0x41d7f1}=_0x3e8d81[_0x4a553c(0x50e,0x55b,0x552,0x54e)](replaceAllPlaceholders,_0x8e8e17,_0x22e295);return _0x4cc867;}export function getProcessedPrompt(_0x14fbc9,_0x42ce68){const _0x3dc49e={'dQNQm':function(_0x25ad47,_0x50a862){return _0x25ad47(_0x50a862);}},_0x32f033={};_0x32f033['requestTyp'+'e']=_0x14fbc9,_0x32f033[_0x420cb1(0x336,0x2ea,0x309,0x302)+'a']=_0x42ce68;function _0x420cb1(_0x3a50c8,_0x4ad55a,_0x29f27b,_0x4bf471){return _0x2d4a(_0x4ad55a-0xe8,_0x29f27b);}return _0x3dc49e['dQNQm'](buildPromptWithTrigger,_0x32f033);}