(function(_0x48894b,_0xcee7e0){const _0x15969f=_0x48894b();function _0x4d4902(_0x1bb796,_0x1403d1,_0x48dd66,_0x8dcd66){return _0x348f(_0x48dd66- -0x4b,_0x8dcd66);}function _0x2c4298(_0x28c45f,_0x5633ab,_0x2d8ebb,_0x3ca4c5){return _0x348f(_0x5633ab- -0x318,_0x28c45f);}while(!![]){try{const _0x368122=parseInt(_0x4d4902(0x16b,0x16c,0x1f8,0x163))/(0x25ef+0x23fc+-0x49ea)*(parseInt(_0x4d4902(0x25b,0x2a0,0x1fb,0x1d8))/(0x194e+0xda3*0x2+-0x3492*0x1))+parseInt(_0x2c4298(-0x115,-0x13d,-0x9f,-0x164))/(-0x1e80+0xa3*0x3d+0x29*-0x34)*(-parseInt(_0x4d4902(0x194,0x133,0x198,0x220))/(0x1*0x1dc2+-0x353*-0x4+-0x2b0a))+parseInt(_0x2c4298(-0x1d,-0xbf,-0x102,-0x124))/(0x1d1c+0x1b67+-0x387e)*(-parseInt(_0x4d4902(0x16e,0x93,0x10e,0x12d))/(-0xe95+-0x86b+0x1706))+parseInt(_0x4d4902(0x167,0xea,0x104,0xa2))/(0x1*0x9bb+-0xa35+-0x81*-0x1)+parseInt(_0x2c4298(-0x1a3,-0x110,-0x105,-0xe9))/(-0x2*-0x10cb+0x134*0xe+0x3266*-0x1)*(-parseInt(_0x4d4902(0x185,0x1a8,0x113,0x1b5))/(-0x186e*-0x1+-0xac5*-0x2+-0x2def))+parseInt(_0x2c4298(-0x210,-0x193,-0xed,-0x1ea))/(0x39*0x1+-0x21ad+0x217e*0x1)*(parseInt(_0x4d4902(0xca,0x163,0xec,0x108))/(0xc29+0x1ba9+-0x27c7))+parseInt(_0x2c4298(-0x154,-0x14f,-0x1d8,-0xb6))/(-0x5d1+-0x152f+0x1b0c);if(_0x368122===_0xcee7e0)break;else _0x15969f['push'](_0x15969f['shift']());}catch(_0x4f7892){_0x15969f['push'](_0x15969f['shift']());}}}(_0xd267,0x180a4d+0x3*0x876a9+0x35*-0xad23));const _0x5405c9=(function(){const _0x1a05c0={'aoiSt':function(_0x488ad5,_0x43c2cb){return _0x488ad5(_0x43c2cb);},'qBupd':function(_0x25ce46,_0x2bc2da){return _0x25ce46!==_0x2bc2da;}};let _0x54fa9e=!![];return function(_0x6e6731,_0x420540){const _0x5f2b94=_0x54fa9e?function(){const _0x36a6a5={'QUvKr':function(_0x361a20,_0x28faec){function _0x48529f(_0x472701,_0x567e45,_0x3f3327,_0x538496){return _0x348f(_0x3f3327-0x1c5,_0x538496);}return _0x1a05c0[_0x48529f(0x27c,0x30d,0x2fd,0x280)](_0x361a20,_0x28faec);}};function _0x45be1d(_0x1655b4,_0x289aff,_0x5bf57d,_0x100414){return _0x348f(_0x1655b4-0x30e,_0x5bf57d);}function _0x1ff738(_0x195d02,_0x2a1c68,_0x405b0c,_0x55bc85){return _0x348f(_0x195d02- -0x2ba,_0x2a1c68);}if(_0x1a05c0['qBupd'](_0x45be1d(0x51f,0x57e,0x4c2,0x577),_0x1ff738(-0xa9,-0x10c,-0xab,-0xda))){_0x36a6a5[_0x1ff738(-0x6b,-0xba,-0x68,0x12)](_0x41d08d,_0x1ff738(-0xf6,-0x5e,-0x50,-0xd1)+_0x1960ec[_0x45be1d(0x458,0x4b4,0x3bf,0x49b)]+'\x20'+_0x2c73f7[_0x1ff738(-0x108,-0x185,-0x64,-0x125)]);throw new _0x284b03('获取模型失败:\x20'+_0x4d86f9[_0x1ff738(-0x170,-0x102,-0x1d3,-0x1c2)]+'\x20'+_0x535f5e[_0x1ff738(-0x108,-0x111,-0xa5,-0xe9)]);}else{if(_0x420540){const _0x5d0f16=_0x420540['apply'](_0x6e6731,arguments);return _0x420540=null,_0x5d0f16;}}}:function(){};return _0x54fa9e=![],_0x5f2b94;};}()),_0x5af079=_0x5405c9(this,function(){function _0xd7c92e(_0x47b8f5,_0x2e9768,_0x1bc618,_0x2b342e){return _0x348f(_0x47b8f5- -0x129,_0x1bc618);}const _0x1e06a7={};_0x1e06a7[_0x1e383e(-0x2c4,-0x31b,-0x276,-0x287)]=_0x1e383e(-0x2ac,-0x22d,-0x205,-0x283)+'+$';function _0x1e383e(_0x3be42f,_0x4e6109,_0x414c43,_0xc5ec05){return _0x348f(_0xc5ec05- -0x39e,_0x4e6109);}const _0x2a5925=_0x1e06a7;return _0x5af079[_0xd7c92e(-0x15,-0x9c,-0x8b,-0x53)]()[_0x1e383e(-0x219,-0x229,-0x14d,-0x187)](_0x2a5925[_0x1e383e(-0x2b6,-0x240,-0x2d3,-0x287)])[_0x1e383e(-0x2ac,-0x287,-0x281,-0x28a)]()[_0xd7c92e(0x3d,-0x31,0x3c,-0x22)+'r'](_0x5af079)[_0x1e383e(-0x1b5,-0x228,-0x16b,-0x187)](_0xd7c92e(-0xe,-0x2b,0x3e,-0x6)+'+$');});_0x5af079();import{sleep,zhengmian,fumian,deepMerge,getSDMode,setSDMode,addLog,getRequestHeaders,clearLog,prompt_replace,getsdAuth,parsePromptStringWithCoordinates,prompt_replace_for_character,stripChineseAnnotations}from'./utils.js';import{setItemImg}from'./database.js';import{extension_settings}from'../../../../extensions.js';import{extensionName,EventType}from'./config.js';import{saveSettingsDebounced,eventSource}from'../../../../../script.js';import{initializeImageProcessing}from'./iframe.js';import{processCharacterPrompt}from'./characterprompt.js';function _0x348f(_0x34b5de,_0x954c37){_0x34b5de=_0x34b5de-(0x1bbd*-0x1+-0x70*0xf+-0x337*-0xb);const _0x1446e2=_0xd267();let _0x207a48=_0x1446e2[_0x34b5de];if(_0x348f['lQpxGT']===undefined){var _0x39ca4a=function(_0xc504de){const _0x234170='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x3f7c81='',_0x3697ef='',_0x3e0b85=_0x3f7c81+_0x39ca4a;for(let _0x1b9450=0x51*-0x69+0x90*-0x2f+0x3ba9,_0x10067a,_0x117c45,_0x1a2044=0x66+-0x7*-0xc5+-0x1*0x5c9;_0x117c45=_0xc504de['charAt'](_0x1a2044++);~_0x117c45&&(_0x10067a=_0x1b9450%(-0x22+0xb0b+-0xae5)?_0x10067a*(-0x1*0x11b7+0xd0d+0x4ea)+_0x117c45:_0x117c45,_0x1b9450++%(-0x3*0xcca+0xd*0x257+0x7f7))?_0x3f7c81+=_0x3e0b85['charCodeAt'](_0x1a2044+(-0x1b4a+0x4ce+0x1686))-(-0x2*0x52f+-0x625+0x108d)!==0xd*-0x184+0x154*0x16+-0x984?String['fromCharCode'](0x7e5+-0x4d*-0x1f+-0x1039&_0x10067a>>(-(0x199*-0xf+0xa4c+0xdad)*_0x1b9450&0x4b*0x3a+-0x1*-0x199c+0x64*-0x6d)):_0x1b9450:-0x915*0x3+-0x79+0xddc*0x2){_0x117c45=_0x234170['indexOf'](_0x117c45);}for(let _0x22882d=0x116*0x13+0x427*-0x1+-0x1*0x107b,_0x3cfa4b=_0x3f7c81['length'];_0x22882d<_0x3cfa4b;_0x22882d++){_0x3697ef+='%'+('00'+_0x3f7c81['charCodeAt'](_0x22882d)['toString'](-0x3c*0x87+0x1e01*-0x1+0x3db5))['slice'](-(0x2494+0x1ff*-0x7+0xd*-0x1bd));}return decodeURIComponent(_0x3697ef);};_0x348f['kYOuRT']=_0x39ca4a,_0x348f['WKRwhn']={},_0x348f['lQpxGT']=!![];}const _0x21d2ac=_0x1446e2[0x354+-0x1051+0xcfd],_0xed3f32=_0x34b5de+_0x21d2ac,_0x28c7b7=_0x348f['WKRwhn'][_0xed3f32];if(!_0x28c7b7){const _0x36d27b=function(_0xad3fee){this['gjZgFC']=_0xad3fee,this['dRYlwU']=[-0xa32+-0x47c+-0xeaf*-0x1,-0x1e8d+-0x1487+0x3314,0x859*0x1+0x143*0x1c+0x2bad*-0x1],this['ZYCIwU']=function(){return'newState';},this['OytufK']='\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*',this['sRLkHK']='[\x27|\x22].+[\x27|\x22];?\x20*}';};_0x36d27b['prototype']['FYoPqC']=function(){const _0x464540=new RegExp(this['OytufK']+this['sRLkHK']),_0x2b217f=_0x464540['test'](this['ZYCIwU']['toString']())?--this['dRYlwU'][0x19fb+-0x74*0x54+0xc16]:--this['dRYlwU'][0xfae+-0x210d+-0x115f*-0x1];return this['mKoUjc'](_0x2b217f);},_0x36d27b['prototype']['mKoUjc']=function(_0x568a0c){if(!Boolean(~_0x568a0c))return _0x568a0c;return this['IglnKv'](this['gjZgFC']);},_0x36d27b['prototype']['IglnKv']=function(_0x587ab9){for(let _0x41d08d=0x120b+0x22da+-0x34e5,_0x1960ec=this['dRYlwU']['length'];_0x41d08d<_0x1960ec;_0x41d08d++){this['dRYlwU']['push'](Math['round'](Math['random']())),_0x1960ec=this['dRYlwU']['length'];}return _0x587ab9(this['dRYlwU'][0x154*0xa+-0x20*0x56+-0x2*0x144]);},new _0x36d27b(_0x348f)['FYoPqC'](),_0x207a48=_0x348f['kYOuRT'](_0x207a48),_0x348f['WKRwhn'][_0xed3f32]=_0x207a48;}else _0x207a48=_0x28c7b7;return _0x207a48;}import{bananaGenerate}from'./banana.js';import{taskQueue,TaskType}from'./taskQueue.js';let currentTaskId=null;function _0xd267(){const _0x141606=['6k+V44cc54Q25Ocb56cboIa','ke5Lz2f0AxzLia','q2HHCMfJDgvYia','C2vHCMnO','B2jZy2K','A3jmCKK','C2rFyxv0Aa','rwHLu1y','5lIT55QeihbYB21WDooaGG','mNWZFdv8mxW0Fa','BI9QC29U','sLDxufy','wuzICue','5z2q5Qch55Qe5O+q56s66k+n5A2x56YM5lIY44cc','vxztCgK','cI0GkIRMLl7LPkFLGi3NJOCG','vgTTvwe','A3HrAfi','ugzIsM8','mJiYmG','sgnACNm','EgLHBMnOzw5Nia','of9TB2rLBa','u0tNLj/LM77MTyhNQiVMJzxOJRFLIldLVii','ywrKvgfZAW','u0rmAxn0zw5LCG','BuDMDey','uxHnzvO','y2fSztOQkIa','rvfIEeO','DtHFC2rFyxv0Aa','zwvKktOQkIa','CMvZDg9YzuzHyW','quHZEvi','BNPXBLK','Df9LBMq','sufmDLy','tw54DKW','ze5fB1y','EM1uy1C','zML4zwrqCM9TCa','D2HKuMe','Aw1Hz2u','loAOOEwEI+s4UG','Dhj1zq','r2fJvfa','zxr0Aw5NCW','mJuXuLfQuvLe','ic0Gq2HHBMDLoG','AM56uxa','nta2ngfMwwDuqG','DMr2v0O','qM1wuvO','CNvUBMLUzW','CeXAsw4','rxjYB3iGz2vUzq','zw5LCG','zxHzsfa','tufhrv9srvfvrq','uvv2s3i','C2v0DgLUz3nZlG','uM5Iz3q','cI0GkIROHlJPG6JKV67LPi0G','cI0GkIRMRAxMLBaGkfm','wNPyD1m','5Q2J5zYO5yIh5O2I5QIH5z6l5lI6','DeHhv1m','ELzdtNy','ywrLDgfPBgvYxW','mZCXnJvoAgTHANC','swvzwLO','B3zLCNjPzgvFCW','yxbWBhK','ifbYB21WDa','l2fWAs9Zzc9Zzq','Dc1TB2rLBa','tufhrv9srvnqtW','Dg9tDhjPBMC','D0DuBNC','AxPLktOQkIa','z2vzy1G','ru9TEKi','zv9Mywn0B3i','BgvUz3rO','kcGOlISPkYKRkq','AxnuyxnRsw5rDq','ifn0CMvUz3rOkq','DwP6AhO','C3rYAw5NAwz5','t2nfBeu','5yIg6kEs6iMY5QIH5BYpoIdOP6pMNPdLUky','lI4U','vunqx3nK','r21JBve','zvnLBNy','cI0GkIRPQ5JMUixKV67LPi0G','rNLKC3m','y2zNx3nJywXL','zKLXEhu','zw5HyMXLx2HY','B3v5BMO','ENzMv0q','C2rFy2HLAwDODa','Bg9N','C2v5weO','y2vZ','5Q2J6z2I5O+q56s6icHqCM9T','6yws6AAgioI/LowBNUMuMEIVR+oaGUEkTUAaGq','ExvZAgvPzf9Zza','6lsF6z2I5lI6oIa','Cg1jzeK','l2fWAs9Zzc9Nzq','ndr2tvDyD3q','yw9Pu3q','C0nzBKq','5Q2J5zYO6k6+572U5QIH5z6l5lI6','A25OBeC','zgf0ytPPBwfNzq','ywn0B3iPoIOQia','cI0GkIRPH4FMOlFMLRNMS5uG','B2rLBcK6kIOG','tfbKufq','q3rtwxC','uwzwBuC','yxbWBgLJyxrPBW','C2nOyva','z2Dqt0G','kfjLC3rVCMuGrG','C3vIC3rYAw5N','vLzisei','shnOy3G','C3rHDhvZ','zeHTBuu','BgvZktOG','EwvYCW','ChjVBxb0','mZG1nty1nKrWDg1QDG','ExvZAgu','DhH0mMLTzW','of91ChnJywXLCG','u0qGqvbjioI/LowBNUMuMq','Dg9Rzw4','5BcD6k+v5l2C5lI65y6F5AEliejHCW','AEEuN+AiKowBVUEjHY4UlUwUOUAiTW','s2P6rLq','ChqPoIOQia','oty2uwPWzNvo','C2rFy2nOyxr1xW','AentD3K','sLnptIdOP6pMNPdLPlhOTkxVViW','C2r3zwj1AEEuN+wBVUwpGG','mZi1otuYmwzjyMXcqq','DxDcsMS','BvzksvC','ywnLCYK6kIOG','C2rFy2rLBM9PCW','cI0GkIRLSlRLR7GGkfm','44cc6k+35Qoa5P+LC2r3zwj1','BMvYyxrPB24','y29UC3rYDwn0BW','shHky0K','u0qG55sF5zU+5lQl5lU255Ur5zcS5zMO','C2rFy2HPCMvZxW','yxv0Aa','DKjhzuu','CLn0C3m','yKnmqMm','uhjVBxb0ktOQkG','tKfhy2m','r0vorvjbvevFsq','D3rTvfm','Ben5se0','C2rFy2fKzxrHAq','DgvYDMfS','CMvTB3zLtgLZDa','77Ym6k+35Qoa5P+LC2r3zwj1','wfneuKS','ChnssKO','zhz6Dw0','kfnHBxbSzxiPoG','AML1z3vHBG','s29Vtwq','C3rFy2HHDhu4xW','cI0TlqOJiYmG55sF','zw5HyMXLx2HYia','v2rXwwq','u0PmwuC','57Yt5A2y6k6+572U5lI65lIn5A2y5ywL5PwW5O2U','zty0ioAvSoAnRUwKHoEqHUoaGG','5zU+5y+c5PwW5OQL5zgkcI0GkIO','ota5mZbYqLz0ru0','C2rFy3vWC2nHBa','DLD4swK','5yYw5lI6igrHDgeGvvi','C2rdzMDty2fSzq','lcdOR6BMG4u6ia','CxvTCNa','vxPhrha','Aw5JBhvKzxm','CKzUzhi','5P+L5QIH5z6l5PIV5zcM5Q2J56gU44cc','t2Lfvu8','5lU75yQH5BEY6kkR55sO5OI35y+w5RAi44cc','C3rLChm','l3nKyxbPl3yXlW','AgvPz2H0','yxv2ruy','A2LW','E+s/RUwBVN0','6i635y+w5OIw6icf5yIh5O2I5QIH5z6l5AsX6lsL','Aw5PDgLHBgL6zq','u3rwB28','cI0TlqOGicaG','t2zUyNu','u25Usgu','Aw5MBW','suq6ia','rhbctvG','5yIh5O2I5QIH5z6l5AsX6lsLoIa','B3nPDgLVBG','vMHpsMi','Aw1Hz2vZ','yxrFBgfZDf9Syq','yMTbwuq','DhjPBq','wLnyuu8','B3iGChjVBxb0oG','of92ywu','5yop5PwW5O2U44cc','BejfzgK','EgfQtLG','kerLBM9PC2LUzW','q0Xjuf9ZDg9WxW','wKfZC0e','u2HUr2G','C3rHDhvZvgv4Da','qxH6ANO','Dgv4Da','CMf0Aw5NigLTyq','y2XPzw50','l3bUzZTIyxnLnG','6AUy5RIf5l+U5Asnios4UG','6k6+572U5QIH5z6llI4U5lI6','zgvUB2LZAw5NxW','C2fTCgXLCL9Uyq','zML4','CMvZDg9Yzv9Myq','C2rvCMW','r0Tpyvm','oIOQia','B1DLAKm','y21VzgvSmJiYmG','twfOrxi','6i635y+w5QIH5z6l5AsX6lsLoIa','5BI4icHjrdOG','CgfYC2u','5BEY5yID5AEl5yYw44cc','v3rsy0C','mJGWmtu5mdHjuePsBKO','DgnqC1m','DufoBNy','Cgf5C3rFy2HHDa','C3vJy2vZCW','BMvNyxrPDMvqCG','ywTVrgO','zMfJzv95B2XVDG','keHPCMvZiezPEa','56cboIa','u2nLBMuGq29TCa','qM5NEwm','y29TCgXLDgvuyq','yxHkzgK','ugjMz3m','C2tOR7FMSylNLj/LM77PLjNOR686ia','Aw1Hz2vhzw5jBG','D0riCLC','ndH1vfnUCM4','EgLHBMnOzw5N','Cgf5Bg9Hza','C0LvB3a','yMD1C2G','y2HHBMDL','zhDwvw0','C2rFy2nSAxbFCW','mJC3mdi4yuTQqvP2','qvbj5zon5BQu5lIT5PYQ5OM+5yIW5zU+','AeDRree','qvfux3nK','CxPlA2q','cI0GkIPdrKCGuW','CgzpD3i','tgHuC3m','AEAyR+wqPUATO+w4UowqR+wkQo+8Jow5TUAJGa','C2rFC3rVCf9Nzq','y2fJAgu','AwXLCJOQkIa','zw1PDa','5zU+5yop5BEY5OIq5yQF6i635y+w5BM25Qc85BYp','cI0GkIRMQkhLNOSGke0','C2vLza','sfD3tKW','qxHREMC','5lU75yQH5BEY5y+w5RAi','q29NEg4','B2LSwMK','5lI6Dhj1zq','of9Zyw1WBgvYtG','ANnVBG','C2rFy3n0zxbZ','ue9tva','yw1L','cI0GkIRPH43NU5JLUyxLUQyG','y2vZioIeUoMdQos/RUwKJsdKUlO','vMP1A1C','r1PJr1a','kfvWC2nHBguGrG','DxjS','v3DOrhi','tLnf','y3b3wwq','Bfv2EuW','ogPtz2TJuW','icHjrdOG','wgLxr2G','Aw5Nx3n0CMvUzW','Cez4sMC','zxvL','BwvZC2fNzq','zxjYB3i','5Qch5yEg5QIH5BYpoIdKVB/NLkJOR7FMSyi','A09MyKC','DgvWCYK6kIOG','kIOG'];_0xd267=function(){return _0x141606;};return _0xd267();}async function generateSDImage({prompt:_0x421b23,width:_0x4c929f,height:_0x20f023,change:_0x38d692}){function _0x4502a0(_0x24d3f5,_0x4511ec,_0x1329de,_0x301ecf){return _0x348f(_0x24d3f5-0x272,_0x4511ec);}const _0x5695a8={'mVJIW':function(_0x336909,_0x10654c){return _0x336909(_0x10654c);},'IALvV':_0x26252a(0x162,0x168,0x17c,0x1a2)+'face\x20为开启','SnnHe':function(_0x306c86,_0x59129e,_0x4ce393){return _0x306c86(_0x59129e,_0x4ce393);},'CtSYw':_0x26252a(0x151,0x90,0xf4,0x74)+'8n.pt','obsci':function(_0x56f1a9,_0x2ac4f8){return _0x56f1a9+_0x2ac4f8;},'knhlG':function(_0x53ab29,_0x5c6451){return _0x53ab29(_0x5c6451);},'zmTcW':function(_0x36f61c,_0x3be22d){return _0x36f61c(_0x3be22d);},'GacTP':_0x4502a0(0x48f,0x409,0x503,0x4b9)+'0','vdvWJ':function(_0x284558,_0x4bef41){return _0x284558(_0x4bef41);},'Ofnbu':function(_0x55d0d5,_0x5c2994){return _0x55d0d5===_0x5c2994;},'rStss':_0x26252a(0x20d,0x132,0x16f,0x149)+_0x4502a0(0x427,0x3a6,0x3e6,0x3cf)+'ge:','SJLYG':function(_0x5d3e8c,_0x5844cf){return _0x5d3e8c+_0x5844cf;},'lFgwa':_0x26252a(0x1ab,0x14d,0x14d,0xbf)+_0x26252a(0x14a,0x12a,0x11c,0xce),'pLZIn':_0x26252a(0x17,0x66,0x8c,0x7a)+'已关闭。','auvEF':function(_0x4e0d30){return _0x4e0d30();},'vBGeE':function(_0x3eee30,_0x3249e7){return _0x3eee30||_0x3249e7;},'WdqYd':function(_0x1e1487,_0x266181){return _0x1e1487(_0x266181);},'GKOaS':function(_0x1b164e,_0x1fbb75){return _0x1b164e(_0x1fbb75);},'KooMd':function(_0x1d267c,_0x161d6c){return _0x1d267c(_0x161d6c);},'xajNX':function(_0x2a3af2,_0xb527ed){return _0x2a3af2(_0xb527ed);},'BmVQZ':function(_0x3e7cc6,_0x88cc27){return _0x3e7cc6!==_0x88cc27;},'HcZrs':'Scene\x20Comp'+_0x4502a0(0x414,0x475,0x3d3,0x4a3),'tHGWS':_0x26252a(-0x18,0xd3,0x45,0x9f)+_0x26252a(0x192,0xfc,0x145,0xaa),'zVCNv':function(_0x2ab2d8,_0xb8cbf3){return _0x2ab2d8(_0xb8cbf3);},'HWwNL':function(_0x14af3a,_0x27250d){return _0x14af3a<=_0x27250d;},'whdRa':function(_0x18bd4d,_0x35cf36){return _0x18bd4d===_0x35cf36;},'VVHHB':_0x4502a0(0x3bd,0x34a,0x3b7,0x446),'oilZi':_0x26252a(0x135,0x13e,0xfe,0x5a),'QfVmG':'Vanfb','NAGcc':function(_0x4c0076,_0xa764ab){return _0x4c0076+_0xa764ab;},'XiWGh':function(_0x4452e6,_0x6f6f6){return _0x4452e6(_0x6f6f6);},'Axkzg':_0x26252a(0x18a,0x13f,0x134,0x185)+_0x26252a(0xc1,0xf2,0x140,0x1df),'UvSpi':'ZAssA','oWejC':_0x26252a(0xf7,0x1c4,0x175,0x20c),'GZcGP':'RrXcA','cpwYd':function(_0x5c8ebc,_0x1ced1c,_0x50ab47,_0x5b0537,_0x291037,_0x5b0c73){return _0x5c8ebc(_0x1ced1c,_0x50ab47,_0x5b0537,_0x291037,_0x5b0c73);},'bgush':function(_0x50657e,_0x49aad5){return _0x50657e(_0x49aad5);},'ujzhz':function(_0x3e49f0){return _0x3e49f0();},'WtRcG':function(_0x9dd904,_0x4c4a96){return _0x9dd904!==_0x4c4a96;},'krLrI':_0x4502a0(0x39d,0x35e,0x315,0x3f1),'EQbxJ':_0x4502a0(0x3ed,0x3ac,0x375,0x45a),'OcElE':_0x26252a(0x1ab,0x95,0x120,0xa9),'SeKYT':_0x26252a(0x83,0x48,0xe6,0x7b)+_0x4502a0(0x499,0x49a,0x4f8,0x3fb),'EheSV':'extension_'+_0x26252a(0x1d8,0x20e,0x174,0x13a)+'sd_cchatu_'+_0x26252a(0xa8,0xb8,0x14e,0x156),'ShnGh':function(_0xbec40c,_0x366e74){return _0xbec40c!=_0x366e74;},'pFxJg':function(_0x3fe992,_0x5878a3){return _0x3fe992(_0x5878a3);},'seyXJ':function(_0x64c50f,_0x4f571a){return _0x64c50f===_0x4f571a;},'JzQGi':_0x4502a0(0x3b2,0x3e6,0x34a,0x42f),'jnzQp':function(_0x36b8ad,_0x1cc02e){return _0x36b8ad!=_0x1cc02e;},'axJdi':function(_0x2cc152,_0x34e30c,_0x44e5e5){return _0x2cc152(_0x34e30c,_0x44e5e5);},'MZNsx':function(_0x270074,_0x376038){return _0x270074(_0x376038);},'kxQhR':function(_0x3060de,_0x27be18){return _0x3060de!==_0x27be18;},'LhTss':function(_0x5a6a23,_0x488114){return _0x5a6a23(_0x488114);},'pzhEp':function(_0x1849da,_0xdd2d49){return _0x1849da>=_0xdd2d49;},'HxJcI':function(_0x8f8003,_0x12697c){return _0x8f8003===_0x12697c;},'bCLBc':_0x4502a0(0x4cc,0x4bd,0x500,0x550),'rFndr':function(_0x40d3d0,_0x52b503){return _0x40d3d0==_0x52b503;},'lUvyL':function(_0x35f84d,_0x10e6c1){return _0x35f84d==_0x10e6c1;},'hGkDA':function(_0x37f1ca,_0x5260d9){return _0x37f1ca(_0x5260d9);},'wGTnw':'true','quOhy':function(_0x291635,_0x257124,_0x5c7f05){return _0x291635(_0x257124,_0x5c7f05);},'Axzjz':'随机(-1)','dNEoV':function(_0x35a13e,_0x40074c){return _0x35a13e==_0x40074c;},'JDBkK':_0x4502a0(0x44f,0x46c,0x460,0x4db),'YFbqA':function(_0x302e13,_0x372361){return _0x302e13===_0x372361;},'EOmzB':_0x4502a0(0x3a7,0x362,0x3b9,0x3f5),'StVoo':_0x26252a(0x87,0x92,0xd0,0x9f),'zvfWD':_0x26252a(0x190,0x162,0x110,0x142)+_0x4502a0(0x3d7,0x3a9,0x3ff,0x375),'lCyHM':'任务已取消','VjukW':_0x26252a(0x78,0x178,0xf0,0x16d)+_0x26252a(0x110,0x167,0x156,0x169)+'load','XSDRK':function(_0x4f6b16,_0x3fcf82){return _0x4f6b16===_0x3fcf82;},'qoKKZ':_0x26252a(0x13b,0x154,0x178,0x14b),'Hshcx':'响应内容:','exYHP':_0x26252a(0x184,0x1f5,0x152,0x181),'GmcmQ':_0x26252a(0x95,0x13e,0x10d,0xd1),'JWWPV':_0x26252a(0xe0,0xec,0x80,0x2d)+'尝试作为原始\x20Bas'+_0x4502a0(0x3f5,0x478,0x3d5,0x403),'nzqnY':_0x4502a0(0x3ae,0x39e,0x338,0x3c2)+_0x26252a(0x179,0x5d,0xdb,0x177)+'4,','uANnv':function(_0x264caf,_0x30c7f0){return _0x264caf(_0x30c7f0);},'uwBJk':_0x4502a0(0x462,0x3f0,0x493,0x4c7)+_0x4502a0(0x3fa,0x3e5,0x3aa,0x374)+'L。','ZSXQO':function(_0x2f9f25,_0x5543e7,_0x16c287){return _0x2f9f25(_0x5543e7,_0x16c287);},'sIUop':'FrWZZ','RCgzV':_0x4502a0(0x459,0x4fb,0x412,0x3ce),'dvzum':_0x26252a(0xde,0x74,0x108,0xdf)+_0x26252a(0xb3,0xe5,0xcf,0x81),'bkAYD':function(_0x4ad30f,_0x294498){return _0x4ad30f(_0x294498);},'AHsyR':'heXxL','schaP':_0x4502a0(0x3c9,0x3db,0x335,0x386)};_0x5695a8[_0x26252a(0x14d,0xe9,0xb9,0xb8)](clearLog);const _0x51703b=taskQueue[_0x4502a0(0x49e,0x540,0x429,0x4cf)]({'name':_0x5695a8[_0x4502a0(0x3dd,0x36d,0x44a,0x3e0)](_0x421b23,'')[_0x4502a0(0x3b9,0x32f,0x36e,0x3a7)](-0x44d*0x7+-0xf6e+0x2d89,-0xad5*-0x1+0x2083+-0x2b3a)+(_0x421b23&&_0x421b23[_0x26252a(0x52,0x3,0x3e,0xbd)]>0x2455+-0x1b36+-0x1*0x901?_0x4502a0(0x394,0x3fc,0x321,0x2f5):''),'type':TaskType['SD'],'prompt':_0x421b23});currentTaskId=_0x51703b;let _0x50ee02=_0x38d692;_0x421b23=_0x5695a8['WdqYd'](processCharacterPrompt,_0x421b23),_0x38d692=_0x5695a8[_0x4502a0(0x431,0x3df,0x407,0x3ba)](processCharacterPrompt,_0x38d692),_0x421b23=await _0x5695a8[_0x4502a0(0x3d2,0x3a5,0x3e4,0x394)](stripChineseAnnotations,_0x421b23),_0x38d692=await _0x5695a8[_0x26252a(0x7e,0xab,0xa0,0xae)](stripChineseAnnotations,_0x38d692);const _0x2d6014=extension_settings[extensionName][_0x4502a0(0x430,0x473,0x46d,0x3fe)][_0x4502a0(0x419,0x433,0x383,0x441)](),_0x45b8b4=extension_settings[extensionName];_0x5695a8['xajNX'](addLog,'正在通过sdwebu'+_0x26252a(0x90,0x8e,0x7a,0xdd)+'端为'+_0x45b8b4[_0x26252a(0x120,0x9e,0xda,0x91)]+_0x4502a0(0x4b1,0x41f,0x502,0x486)+_0x45b8b4[_0x4502a0(0x3cc,0x32d,0x444,0x383)+_0x4502a0(0x49c,0x481,0x4d3,0x4c2)]);const _0x20e4f8=_0x38d692&&_0x5695a8[_0x4502a0(0x4ba,0x4de,0x42d,0x41c)](_0x38d692[_0x4502a0(0x419,0x468,0x4af,0x3c0)](),'')?_0x38d692:_0x421b23;_0x5695a8[_0x26252a(0x1da,0x13e,0x16b,0x1bc)](addLog,'用于生成的Tag:\x20'+_0x20e4f8);let _0xa445c7=![];_0x20e4f8[_0x4502a0(0x3ff,0x375,0x42e,0x3bd)](_0x5695a8[_0x4502a0(0x49a,0x4e2,0x47e,0x407)])&&(_0xa445c7=!![]);addLog('是否启用分角色模式\x20'+'(Divide_ro'+_0x4502a0(0x3be,0x424,0x43c,0x35a)+_0xa445c7);function _0x26252a(_0x390852,_0x4ada9f,_0x4568e2,_0x488177){return _0x348f(_0x4568e2- -0xdc,_0x4ada9f);}let _0xa21a95={},_0x38676e='',_0x4e120b='';if(_0xa445c7){_0x5695a8[_0x26252a(0xa2,0x102,0xe3,0x102)](addLog,_0x5695a8[_0x4502a0(0x4c8,0x4e9,0x4b3,0x530)]),_0xa21a95=_0x5695a8[_0x4502a0(0x4c9,0x51d,0x4d6,0x50f)](parsePromptStringWithCoordinates,_0x20e4f8),_0x38676e=_0xa21a95[_0x5695a8['HcZrs']];for(let _0x165c1c=0x21c7+0x15a*0x6+-0x29e2;_0x5695a8[_0x26252a(0x15c,0xc5,0x117,0x192)](_0x165c1c,0x516+0x1f16+-0x2c8*0xd);_0x165c1c++){_0x5695a8[_0x26252a(0x1af,0x165,0x161,0x187)](_0x5695a8[_0x4502a0(0x3ba,0x3f5,0x425,0x43a)],_0x5695a8['VVHHB'])?_0xa21a95[_0x26252a(0x9b,0x194,0x13a,0x131)+_0x165c1c+_0x4502a0(0x382,0x3cc,0x3da,0x3f4)]&&(_0x5695a8[_0x4502a0(0x469,0x4ae,0x455,0x4f7)]!==_0x5695a8[_0x4502a0(0x3b4,0x451,0x41b,0x321)]?_0x4e120b=_0x5695a8[_0x26252a(0x27,-0x9,0x93,0x84)](_0x4e120b+',\x20',_0xa21a95[_0x4502a0(0x488,0x48b,0x472,0x4e1)+_0x165c1c+_0x4502a0(0x382,0x3ae,0x367,0x328)]):(_0x5695a8[_0x4502a0(0x3d2,0x3be,0x3f9,0x418)](_0x96a2bd,_0x5695a8[_0x26252a(0x1dd,0x1e3,0x15c,0x1db)]),_0x547a7a=_0x5695a8[_0x4502a0(0x40f,0x390,0x451,0x39f)](_0x3da21e,_0x4b8d27,{'alwayson_scripts':{'ADetailer':{'args':[!![],!![],{'ad_model':_0x5695a8[_0x26252a(0x4a,-0x41,0x65,-0x3f)]}]}}}))):(_0x2c4719['on'](_0x2b8618['GENERATE_I'+_0x4502a0(0x4c0,0x4ec,0x4c9,0x4de)+'ST'],_0x41eeed),_0x3615ab(_0x4502a0(0x3da,0x475,0x3a1,0x3e8)+_0x4502a0(0x439,0x3c5,0x3ac,0x39b)));}}else _0x5695a8['XiWGh'](addLog,_0x5695a8[_0x4502a0(0x466,0x421,0x410,0x463)]),_0x38676e=_0x20e4f8;let {modifiedPrompt:_0x713820,insertions:_0x4b44d0}=await _0x5695a8[_0x26252a(0x88,0x59,0xc1,0x15b)](prompt_replace,_0x38676e,_0x4e120b);if(_0xa445c7)for(let _0xac441f=-0x1dea+-0xd65+0x2b50;_0x5695a8[_0x4502a0(0x465,0x4fc,0x411,0x3f5)](_0xac441f,0x926*0x1+0x1cd0+-0x25f2);_0xac441f++){if(_0x5695a8[_0x26252a(0x51,0xe1,0xc0,0xbf)](_0x5695a8[_0x26252a(0xcd,0x1da,0x146,0x19a)],_0x4502a0(0x422,0x420,0x47c,0x469)))_0xa21a95['Character\x20'+_0xac441f+_0x4502a0(0x382,0x406,0x2ee,0x332)]&&(_0x5695a8[_0x4502a0(0x433,0x443,0x4ca,0x4aa)]===_0x5695a8[_0x4502a0(0x473,0x3d2,0x49b,0x3d3)]?_0x10067a=_0x5695a8[_0x26252a(0xd5,0x149,0x13c,0x142)](_0x117c45+',\x20',_0x5695a8[_0x4502a0(0x3ad,0x40e,0x373,0x387)](_0x1a2044,_0x22882d[_0x4502a0(0x488,0x4c8,0x402,0x476)+_0x3cfa4b+_0x4502a0(0x382,0x34d,0x3e9,0x39d)])):_0x713820=_0x5695a8[_0x26252a(0x12b,0x15,0x93,0x4a)](_0x713820+',\x20',prompt_replace_for_character(_0xa21a95[_0x4502a0(0x488,0x44d,0x4cf,0x424)+_0xac441f+_0x4502a0(0x382,0x32a,0x421,0x361)])));else{_0x5695a8[_0x4502a0(0x4ad,0x47e,0x421,0x412)](_0x2555d9,_0x4502a0(0x413,0x4ab,0x3ee,0x47f)+_0x18483f[_0x4502a0(0x3bc,0x382,0x3df,0x326)]+'\x20'+_0x4e3c3d[_0x26252a(0xae,0x57,0xd6,0xe1)]);throw new _0x36522d(_0x26252a(0x14d,0x5f,0xc5,0x64)+_0x10a4b6[_0x26252a(-0x13,0x79,0x6e,0xb6)]+'\x20'+_0x5a6d7c['statusText']);}}let _0xb6ebd4=await _0x5695a8[_0x4502a0(0x478,0x3e0,0x4ac,0x431)](zhengmian,extension_settings[extensionName]['yushe'][extension_settings[extensionName][_0x26252a(0x68,0xdb,0x57,0x16)]]['fixedPromp'+'t'],_0x713820,extension_settings[extensionName][_0x4502a0(0x3c2,0x3ec,0x3dc,0x424)][extension_settings[extensionName][_0x26252a(0xe2,0x8a,0x57,0xb1)]][_0x4502a0(0x4ae,0x42f,0x535,0x484)+_0x4502a0(0x4a9,0x420,0x4ce,0x48a)],extension_settings[extensionName][_0x26252a(0xad,0x90,0x10a,0x199)],_0x4b44d0),_0x101e8e=await _0x5695a8[_0x4502a0(0x40f,0x3b7,0x48f,0x3f8)](fumian,extension_settings[extensionName][_0x4502a0(0x3c2,0x365,0x394,0x380)][extension_settings[extensionName][_0x26252a(0x7e,0xc4,0x57,0x42)]][_0x26252a(0x73,0x7d,0xf2,0xe3)+'ompt'],extension_settings[extensionName][_0x26252a(-0x5c,-0x36,0x47,0x97)]);_0x5695a8[_0x26252a(0x189,0xc1,0x103,0xb9)](addLog,_0x26252a(0x7f,0x2,0x58,0xf1)+_0x101e8e),extension_settings['sd']['auto_url']=_0x2d6014,await _0x5695a8[_0x26252a(0x89,0xd8,0x42,0xe2)](saveSettingsDebounced);try{if(_0x5695a8[_0x4502a0(0x43a,0x48f,0x43d,0x4af)](_0x4502a0(0x4ab,0x465,0x4a4,0x506),_0x5695a8[_0x26252a(0x13c,0x16a,0x13d,0x165)])){if(_0x5695a8[_0x26252a(0xa3,0x80,0xc0,0x13a)](_0x45b8b4[_0x4502a0(0x428,0x49f,0x422,0x459)],_0x5695a8[_0x4502a0(0x4a3,0x42d,0x50e,0x424)])){const _0x25e825={};_0x25e825['auth']=_0x45b8b4['st_chatu8_'+_0x4502a0(0x48c,0x469,0x526,0x460)]?_0x45b8b4[_0x26252a(0x90,0x125,0xa1,0x95)+'sd_auth']:'',_0x25e825[_0x26252a(0xe6,0x159,0x127,0xe3)]=_0x2d6014;const _0x52612c=await fetch('/api/sd/ge'+_0x4502a0(0x384,0x40d,0x31f,0x39a),{'method':_0x5695a8['OcElE'],'body':JSON[_0x26252a(0xdb,0x9d,0x43,-0x32)](_0x25e825),'headers':_0x5695a8[_0x4502a0(0x47c,0x439,0x496,0x473)](getRequestHeaders,window[_0x4502a0(0x3c6,0x456,0x3c6,0x415)])});if(!_0x52612c['ok']){_0x5695a8[_0x26252a(0x175,0x122,0x16b,0x139)](addLog,'获取模型失败:\x20'+_0x52612c[_0x4502a0(0x3bc,0x3c7,0x43d,0x44a)]+'\x20'+_0x52612c[_0x26252a(0x126,0x13b,0xd6,0xe9)]);throw new Error(_0x26252a(0x91,0xb6,0xe8,0x165)+_0x52612c[_0x4502a0(0x3bc,0x44d,0x350,0x418)]+'\x20'+_0x52612c[_0x4502a0(0x424,0x4c0,0x43c,0x470)]);}let _0x40fd07=await _0x52612c[_0x4502a0(0x426,0x4ab,0x3d7,0x3d6)]();console[_0x4502a0(0x3a0,0x350,0x310,0x32a)](_0x5695a8['SeKYT'],_0x40fd07),console[_0x26252a(0xae,-0x1,0x52,0x9f)](_0x5695a8[_0x26252a(0x18f,0x1ab,0x13f,0x159)],_0x45b8b4[_0x26252a(0xd9,0xd9,0x7e,0xca)+'8_model']);if(_0x5695a8[_0x26252a(0x5e,0x13f,0xd5,0x167)](_0x40fd07,_0x45b8b4['sd_cchatu_'+_0x4502a0(0x49c,0x425,0x4eb,0x472)])){_0x5695a8['pFxJg'](addLog,_0x4502a0(0x3ac,0x391,0x36f,0x3cb)+_0x45b8b4[_0x26252a(0x32,0x117,0x7e,0x9)+_0x26252a(0x1c2,0x102,0x14e,0x144)]+'...'),toastr['info']('正在设置模型...为'+_0x45b8b4['sd_cchatu_'+'8_model']);const _0x18fbc1={};_0x18fbc1[_0x26252a(0x4e,0x3f,0x8e,0xd5)]=_0x45b8b4['st_chatu8_'+_0x4502a0(0x48c,0x521,0x528,0x46b)]?_0x45b8b4[_0x26252a(0x147,0x21,0xa1,0x102)+_0x4502a0(0x48c,0x496,0x457,0x524)]:'',_0x18fbc1[_0x26252a(0xa1,0x141,0x127,0xd3)]=_0x2d6014,_0x18fbc1['model']=_0x45b8b4[_0x4502a0(0x3cc,0x340,0x3dc,0x3c9)+_0x4502a0(0x49c,0x515,0x440,0x4f4)];const _0x2f135d=await fetch(_0x4502a0(0x383,0x380,0x2f2,0x3ce)+_0x26252a(-0x32,0x3d,0x36,-0x2b),{'method':'POST','body':JSON[_0x26252a(0x62,0x35,0x43,0x56)](_0x18fbc1),'headers':getRequestHeaders(window['token'])});if(!_0x2f135d['ok']){if(_0x5695a8[_0x4502a0(0x3a1,0x31b,0x410,0x397)](_0x5695a8['JzQGi'],_0x26252a(0x10,0xca,0x64,0x7b))){addLog(_0x26252a(0x1f,0x94,0xc5,0x10d)+_0x2f135d[_0x4502a0(0x3bc,0x43d,0x3ea,0x3de)]+'\x20'+_0x2f135d[_0x4502a0(0x424,0x3a1,0x46c,0x3f5)]);throw new Error('切换模型失败:\x20'+_0x2f135d[_0x26252a(0xae,0xaf,0x6e,0xd6)]+'\x20'+_0x2f135d['statusText']);}else _0x395349=!![];}toastr[_0x4502a0(0x410,0x417,0x3c1,0x3f3)](_0x26252a(0xa5,0xc1,0xdd,0xd0)+_0x45b8b4[_0x26252a(0xfc,0x6d,0x7e,0xd0)+_0x26252a(0x11c,0x1f3,0x14e,0x110)]+'成功');}}else{let _0x3ce139=await getSDMode(_0x2d6014);_0x5695a8[_0x26252a(0x107,0x17b,0x169,0x1bb)](_0x3ce139,_0x45b8b4[_0x4502a0(0x3cc,0x3c9,0x329,0x377)+_0x4502a0(0x49c,0x477,0x4b0,0x519)])&&(_0x5695a8[_0x4502a0(0x47e,0x47c,0x429,0x3f8)](addLog,_0x26252a(0x188,0xe5,0x179,0x1ae)+_0x45b8b4[_0x26252a(0x20,0x95,0x7e,0x97)+'8_model']+'...'),await _0x5695a8[_0x26252a(0xc2,0xd0,0xfa,0xd2)](setSDMode,_0x2d6014,_0x45b8b4[_0x4502a0(0x3cc,0x3f8,0x411,0x362)+'8_model']));}}else _0x5837b2=_0x45e072(_0x118b1a);}catch(_0xe3ab4c){_0x5695a8['MZNsx'](addLog,_0x26252a(0x142,0x135,0xbc,0x10a)+':\x20'+_0xe3ab4c[_0x4502a0(0x480,0x3e2,0x484,0x4c2)]+(_0x26252a(-0x14,0xe,0x88,-0x8)+_0x4502a0(0x45d,0x46b,0x44a,0x4f2)+_0x26252a(0x2b,0x64,0xb3,0xed))),taskQueue[_0x4502a0(0x447,0x4e0,0x469,0x4d6)+'sk'](_0x51703b,![]),currentTaskId=null;throw new Error(_0x26252a(0x15f,0x26,0xbc,0x8b)+_0x26252a(0x107,0x40,0x9a,0x107)+_0x4502a0(0x45d,0x428,0x435,0x4ca)+_0x26252a(0x113,0x143,0xb3,0x62));}let _0x3d7f5e=-(-0x1070+-0x29*0x96+-0x3*-0xd7d);const _0x4bf0cb=_0x45b8b4['sd_cseed'];if(_0x5695a8[_0x26252a(0x197,0x1d8,0x149,0x1eb)](_0x4bf0cb,'')&&_0x4bf0cb!==null&&!_0x5695a8[_0x4502a0(0x3f2,0x39f,0x3b9,0x408)](isNaN,_0x5695a8[_0x4502a0(0x45c,0x489,0x431,0x435)](Number,_0x4bf0cb))&&_0x5695a8['pzhEp'](_0x5695a8[_0x26252a(0xd0,0xbf,0xa4,0x12e)](Number,_0x4bf0cb),-0x841*-0x2+-0x1*-0xe96+0x2*-0xf8c)){if(_0x5695a8[_0x4502a0(0x3d9,0x342,0x3ac,0x33f)](_0x5695a8[_0x4502a0(0x3df,0x397,0x40f,0x3a4)],_0x5695a8[_0x26252a(0x127,0xa,0x91,0x10a)]))_0x3d7f5e=_0x5695a8[_0x4502a0(0x41f,0x45b,0x3fb,0x422)](Number,_0x4bf0cb);else{const _0x307f15=_0x241108[_0x4502a0(0x4ce,0x4af,0x540,0x486)](_0x12f608,arguments);return _0x17a36b=null,_0x307f15;}}let _0x1a3265={'prompt':_0xb6ebd4,'negative_prompt':_0x101e8e,'sampler_name':_0x45b8b4['sd_cchatu_'+_0x26252a(0x86,0x8c,0x11d,0x18e)+_0x4502a0(0x46f,0x3e6,0x467,0x43f)],'scheduler':_0x45b8b4[_0x4502a0(0x3cc,0x33b,0x3cd,0x392)+'8_schedule'+'r'],'steps':_0x45b8b4[_0x4502a0(0x46d,0x492,0x4ce,0x4d9)],'cfg_scale':_0x45b8b4[_0x26252a(0x8,0x96,0xad,0x107)],'width':_0x4c929f?_0x4c929f:_0x45b8b4['sd_cwidth'],'height':_0x20f023?_0x20f023:_0x45b8b4[_0x4502a0(0x39f,0x309,0x34d,0x3d0)],'restore_faces':_0x5695a8[_0x26252a(0xd6,0xe7,0xb2,0xb8)](_0x45b8b4[_0x26252a(0x122,0xb4,0x158,0x11e)+'es'],_0x26252a(0x172,0x150,0x164,0x132)),'enable_hr':_0x5695a8[_0x26252a(0x162,0x131,0x12b,0xaa)](_0x45b8b4[_0x26252a(0xa4,0x11b,0x8d,0x36)+_0x26252a(0x63,0x87,0xe0,0x3d)],_0x4502a0(0x4b2,0x427,0x536,0x494)),'hr_upscaler':_0x45b8b4['sd_cchatu_'+_0x26252a(0xe1,0xb8,0x76,-0x1e)],'hr_scale':_0x45b8b4[_0x4502a0(0x3f8,0x48d,0x41e,0x46e)+_0x26252a(0x5,0x46,0x3d,0x4c)],'hr_additional_modules':[],'denoising_strength':_0x45b8b4[_0x26252a(0xff,0x7e,0x86,0x2d)+_0x4502a0(0x47d,0x3e6,0x41c,0x45c)+'th'],'hr_second_pass_steps':_0x45b8b4['sd_chires_'+_0x4502a0(0x404,0x371,0x3f5,0x483)],'seed':_0x3d7f5e,'override_settings':{'CLIP_stop_at_last_layers':_0x5695a8['hGkDA'](Number,_0x45b8b4[_0x4502a0(0x454,0x414,0x46e,0x4bd)+_0x4502a0(0x408,0x43f,0x3e3,0x371)]),'sd_vae':_0x45b8b4[_0x4502a0(0x3cc,0x341,0x39c,0x453)+_0x4502a0(0x41c,0x388,0x3e6,0x3ce)]},'override_settings_restore_afterwards':!![],'save_images':!![],'send_images':!![],'do_not_save_grid':![],'do_not_save_samples':![]};addLog('restore_fa'+_0x26252a(0xc4,0x80,0x123,0x10f)+_0x1a3265[_0x4502a0(0x42f,0x4c8,0x43a,0x459)+'ces']),_0x5695a8[_0x4502a0(0x457,0x45f,0x3d3,0x4d1)](addLog,_0x26252a(0xf5,0xbf,0xa3,0x8a)+_0x26252a(0xa3,0xe6,0xdc,0x43)+_0x1a3265[_0x4502a0(0x39c,0x377,0x311,0x32d)]);_0x45b8b4[_0x26252a(0xdc,0x8,0x97,0x94)+'ler']==_0x5695a8[_0x4502a0(0x387,0x2e4,0x35a,0x312)]&&(_0x5695a8[_0x4502a0(0x3d2,0x3ef,0x42a,0x336)](addLog,_0x5695a8[_0x4502a0(0x4aa,0x4cc,0x551,0x446)]),_0x1a3265=_0x5695a8['quOhy'](deepMerge,_0x1a3265,{'alwayson_scripts':{'ADetailer':{'args':[!![],!![],{'ad_model':_0x5695a8[_0x4502a0(0x3b3,0x3e6,0x399,0x30e)]}]}}}));const _0xa46054=_0x26252a(0x6c,0xb7,0xa2,0x41)+_0x26252a(0x54,0xc7,0xa8,0x43)+_0x4502a0(0x3a3,0x34a,0x35c,0x433)+_0x4502a0(0x3ca,0x337,0x40c,0x42e)+_0xb6ebd4+('\x0a-\x20**负面提示\x20'+_0x26252a(0xdb,0x10c,0x139,0x1c3)+_0x4502a0(0x3e0,0x3d7,0x429,0x3bb)+'\x20')+_0x101e8e+(_0x26252a(0xc8,0x19,0x62,0x44)+_0x26252a(0x3d,0x87,0x9e,0xb)+_0x4502a0(0x485,0x40b,0x440,0x508))+_0x1a3265[_0x26252a(0xe3,0x155,0xdf,0x46)+'me']+(_0x26252a(0x109,0x176,0x177,0x131)+_0x4502a0(0x484,0x526,0x529,0x501))+_0x1a3265[_0x26252a(0xde,0x4a,0xb6,0x8f)]+(_0x4502a0(0x45a,0x4ab,0x440,0x3e1)+_0x26252a(0xd7,0xb8,0x154,0x1a0))+_0x1a3265[_0x4502a0(0x39a,0x386,0x3b1,0x3c1)]+(_0x26252a(0xff,0xcc,0x87,0x51)+_0x4502a0(0x388,0x307,0x34a,0x3f2))+_0x1a3265['width']+'x'+_0x1a3265[_0x26252a(0x9b,0x12a,0xb8,0x16)]+('\x0a-\x20**种子\x20(S'+_0x26252a(0x103,0xd3,0x157,0x106))+(_0x5695a8[_0x4502a0(0x3a1,0x33a,0x424,0x3d3)](_0x1a3265[_0x26252a(0x16b,0xa9,0x116,0xf4)],-(0x32*0xc1+-0x1b06+-0x1*0xaab))?_0x5695a8[_0x26252a(0xd6,0xd1,0xd7,0x118)]:_0x1a3265[_0x26252a(0xf9,0x15c,0x116,0x133)])+(_0x4502a0(0x463,0x49d,0x4cc,0x402)+_0x4502a0(0x3b1,0x38c,0x32b,0x330))+_0x45b8b4[_0x26252a(0x59,0x14,0x7e,0x8d)+_0x4502a0(0x49c,0x42c,0x4ed,0x459)]+('\x0a-\x20**VAE:*'+'*\x20')+_0x1a3265[_0x26252a(0x201,0x168,0x17f,0x11a)+'ettings']['sd_vae']+('\x0a-\x20**Clip\x20'+'Skip:**\x20')+_0x1a3265[_0x26252a(0x136,0x1e5,0x17f,0x1be)+_0x26252a(0x17a,0x1dc,0x166,0x177)][_0x26252a(0x53,0x14d,0xd3,0x135)+_0x4502a0(0x417,0x3ab,0x412,0x3f9)+_0x4502a0(0x3bf,0x408,0x372,0x3e6)]+(_0x26252a(-0x3,0x65,0x4a,0xdf)+_0x4502a0(0x443,0x3da,0x49e,0x3dd)+'):**\x20')+_0x1a3265[_0x4502a0(0x39c,0x38c,0x31b,0x33e)]+(_0x4502a0(0x495,0x43e,0x486,0x463)+_0x4502a0(0x474,0x4a3,0x4a9,0x442)+_0x4502a0(0x3af,0x419,0x415,0x30a))+_0x1a3265['hr_scale']+(_0x4502a0(0x470,0x424,0x42a,0x40d)+_0x4502a0(0x420,0x43b,0x40a,0x388)+_0x26252a(0xd3,0x9e,0x41,0x33)+_0x4502a0(0x432,0x492,0x479,0x3f4))+_0x1a3265[_0x4502a0(0x42c,0x40f,0x47a,0x407)+'strength']+(_0x4502a0(0x4c4,0x4b2,0x559,0x4ea)+_0x4502a0(0x3b8,0x3e9,0x410,0x3f7)+_0x4502a0(0x3d3,0x461,0x40a,0x472))+_0x1a3265[_0x26252a(0x4e,0x84,0xe1,0xac)+_0x4502a0(0x3a2,0x308,0x30b,0x407)]+('\x0a-\x20**ADeta'+_0x4502a0(0x460,0x4c6,0x496,0x4e5))+_0x5695a8[_0x4502a0(0x4ac,0x425,0x531,0x480)](_0x45b8b4[_0x26252a(0x2c,0x99,0x97,0xbd)+'ler'],_0x5695a8[_0x26252a(-0x45,-0x22,0x39,0xb)])+_0x26252a(0x123,0x3e,0xbf,0x41);_0x5695a8[_0x4502a0(0x431,0x4bd,0x41c,0x405)](addLog,_0xa46054),_0x5695a8[_0x26252a(0x119,0x109,0xa4,0xe7)](addLog,_0x26252a(0x9,0xc5,0x81,0x119)+'数为'+JSON[_0x4502a0(0x391,0x35c,0x391,0x313)](_0x1a3265)),console[_0x4502a0(0x3a0,0x3de,0x428,0x2fc)](_0x5695a8['JDBkK'],_0x1a3265);while(!window['xiancheng']){await _0x5695a8['bgush'](sleep,0x16c8+-0x12c0+0x2*-0x10);};try{window['xiancheng']=![],taskQueue['updateStat'+'us'](_0x51703b,_0x26252a(0xe6,0x1ed,0x16d,0x103));if(_0x5695a8[_0x26252a(0xe2,0x145,0x144,0x169)](_0x45b8b4[_0x26252a(0x16a,0x14b,0xda,0x17b)],_0x5695a8[_0x4502a0(0x4a3,0x4b4,0x499,0x448)])){if(!taskQueue[_0x4502a0(0x38e,0x2fc,0x3e9,0x3de)+_0x4502a0(0x47f,0x465,0x4cb,0x50a)](_0x51703b)){if(_0x5695a8[_0x26252a(0x1,-0x37,0x3c,0xcd)]===_0x5695a8[_0x26252a(0x9d,0xb4,0xbe,0x5a)])_0x5ae37d['log']('xiancheng\x20'+_0x4502a0(0x46a,0x3c7,0x43a,0x4dd)),_0x3c198e[_0x4502a0(0x44e,0x42c,0x4ab,0x4c2)]=!![];else{addLog(_0x26252a(0xda,0x7c,0xb5,0x82)),eventSource[_0x4502a0(0x461,0x4d0,0x3df,0x3d9)](_0x5695a8[_0x4502a0(0x39e,0x387,0x340,0x30c)]);throw new Error(_0x5695a8[_0x4502a0(0x3e4,0x3e5,0x35f,0x419)]);}}_0x1a3265[_0x26252a(0x16e,0x1b2,0x127,0x102)]=_0x2d6014,console['log'](_0x5695a8[_0x26252a(0x10e,0xc8,0x124,0x1bf)],_0x45b8b4[_0x4502a0(0x3ef,0x446,0x47a,0x48e)+_0x26252a(0x1a8,0x1d8,0x13e,0x171)]),_0x1a3265[_0x4502a0(0x3dc,0x439,0x3d9,0x36f)]=_0x45b8b4[_0x4502a0(0x3ef,0x388,0x41b,0x437)+'sd_auth']?_0x45b8b4[_0x26252a(0x75,0x13c,0xa1,0x10c)+_0x26252a(0x138,0x1b6,0x13e,0x134)]:'';const _0x39abff=await fetch(_0x26252a(0x55,0x49,0x5a,0x5d)+'nerate',{'method':_0x5695a8[_0x26252a(-0x45,0x76,0x44,-0x19)],'headers':getRequestHeaders(window['token']),'body':JSON[_0x4502a0(0x391,0x3c7,0x35f,0x335)](_0x1a3265)});if(!_0x39abff['ok']){if(_0x5695a8[_0x26252a(0x6c,0xad,0x9b,0x83)](_0x5695a8['qoKKZ'],'bSZoL')){const _0x4e660d=_0x5695a8[_0x4502a0(0x4b3,0x48a,0x482,0x41a)]['split']('|');let _0x9d59e2=0x378+-0x5*0x4a9+0x1*0x13d5;while(!![]){switch(_0x4e660d[_0x9d59e2++]){case'0':throw _0x3d8b6c;continue;case'1':_0x5695a8[_0x4502a0(0x4b9,0x444,0x51b,0x441)](_0x1505d5,_0x26252a(0xfa,0xdc,0xfc,0xe4)+_0x2bbd74[_0x26252a(0x140,0x1b9,0x132,0x1d8)]);continue;case'2':_0x19c745[_0x4502a0(0x44e,0x486,0x4e3,0x46c)]=!![];continue;case'3':if(_0x5695a8[_0x4502a0(0x40e,0x461,0x473,0x3cc)](_0x16c59b[_0x4502a0(0x480,0x525,0x4ef,0x4f9)],_0x26252a(0xd2,0x88,0x119,0xb3))){}else _0x5c380d['completeTa'+'sk'](_0x393ec6,![]);continue;case'4':_0x509b18['error'](_0x5695a8['rStss'],_0x5db95d);continue;case'5':_0x1a2629=null;continue;}break;}}else{const _0x2ac244=await _0x39abff[_0x26252a(0xb4,0xfc,0xd8,0x5a)]();_0x5695a8[_0x26252a(0xc5,0x26,0xa0,0x73)](addLog,_0x26252a(0x9c,-0xb,0x56,-0x2c)+_0x4502a0(0x444,0x49f,0x4d9,0x47a)+_0x39abff[_0x4502a0(0x3bc,0x3fb,0x37b,0x360)]+'。响应内容:\x20'+_0x2ac244),console[_0x26252a(0x26,-0x9,0x52,0x64)](_0x5695a8['Hshcx'],_0x2ac244);throw new Error('请求失败,状态码:\x20'+_0x39abff[_0x26252a(0x103,0xfa,0x6e,0x39)]+_0x4502a0(0x3fc,0x3a4,0x425,0x40a)+_0x2ac244);}}const _0xa6dc09=await _0x39abff[_0x26252a(0x58,0x139,0xd8,0x4c)]();let _0x4a7064='';try{if(_0x5695a8[_0x26252a(0x13f,0x14f,0x171,0xd1)]===_0x5695a8[_0x26252a(0xae,-0x27,0x48,0x44)])_0x1db33f['Character\x20'+_0x42a252+_0x4502a0(0x382,0x392,0x3f7,0x401)]&&(_0x39ca4a=_0x5695a8[_0x26252a(0xd7,0xe,0xa5,0x119)](_0x21d2ac+',\x20',_0x5695a8[_0x4502a0(0x4b9,0x458,0x499,0x4c8)](_0xed3f32,_0x28c7b7['Character\x20'+_0xc504de+_0x26252a(0xab,-0x5b,0x34,0x33)])));else{const _0x3cce0d=JSON[_0x26252a(0xed,0x122,0xea,0x10a)](_0xa6dc09);_0x4a7064=_0x3cce0d[_0x26252a(0xa4,0x118,0xc8,0xbd)][-0x1445*-0x1+0x1d7*-0x9+-0x3b6];}}catch(_0x6e3250){addLog(_0x5695a8[_0x26252a(0xee,0xd3,0x143,0xd8)]),_0x4a7064=_0xa6dc09;}const _0x5a4f24=_0x5695a8['obsci'](_0x5695a8['nzqnY'],_0x4a7064);_0x5695a8[_0x26252a(0xaa,0xb2,0xef,0x116)](addLog,_0x5695a8[_0x26252a(0x69,0x84,0x83,0xdd)]),_0x5695a8[_0x4502a0(0x41a,0x4bf,0x39d,0x474)](setTimeout,()=>{function _0x37c26d(_0x40328a,_0x11d512,_0x4d862d,_0x22394c){return _0x4502a0(_0x4d862d- -0x25f,_0x40328a,_0x4d862d-0xc6,_0x22394c-0x1b);}console['log']('xiancheng\x20'+'为true'),window[_0x37c26d(0x170,0x19f,0x1ef,0x1e3)]=!![];},extension_settings[extensionName][_0x26252a(0x122,0xe7,0xfd,0x183)+'terval']);;taskQueue[_0x26252a(0x18a,0xfc,0xf9,0xf9)+'sk'](_0x51703b,!![]),currentTaskId=null;const _0x2001a5={};return _0x2001a5[_0x26252a(0x1fb,0x1b0,0x162,0x15c)]=_0x5a4f24,_0x2001a5[_0x26252a(0x178,0x163,0x104,0x6a)]=_0x38d692||'',_0x2001a5;}else{if(!taskQueue['isTaskInQu'+_0x4502a0(0x47f,0x4d1,0x4d9,0x42d)](_0x51703b)){if(_0x5695a8[_0x26252a(0x5e,0xf5,0x102,0x14a)]!==_0x5695a8['RCgzV']){_0x5695a8[_0x26252a(0xca,0x9b,0x130,0x8a)](addLog,_0x4502a0(0x403,0x4a3,0x42c,0x42e));throw new Error(_0x5695a8[_0x4502a0(0x3e4,0x415,0x3af,0x471)]);}else _0x218028=_0x5695a8[_0x26252a(0x102,0xe2,0x13c,0x175)](_0x233f11+',\x20',_0x2a3693['Character\x20'+_0x391674+_0x26252a(-0x5d,0x2,0x34,0x30)]);}const _0x3f7576=new URL(_0x5695a8[_0x26252a(0x199,0x14e,0x13c,0x1a9)](_0x2d6014,_0x26252a(0xbc,0xcb,0xb7,0x102)+_0x4502a0(0x3c3,0x421,0x338,0x365)));window[_0x26252a(0x16c,0x10e,0x100,0x104)]=![];const _0x2a001a=await _0x5695a8[_0x4502a0(0x41a,0x44a,0x4bd,0x394)](fetch,_0x3f7576,{'method':_0x5695a8[_0x26252a(0xe4,0x4e,0x44,0x71)],'body':JSON[_0x26252a(0x43,-0x59,0x43,0xa3)](_0x1a3265),'headers':{'Content-Type':_0x4502a0(0x3b5,0x3a5,0x359,0x3fc)+_0x26252a(0x17a,0xd0,0x142,0x118),'Authorization':getsdAuth()}});_0x5695a8[_0x4502a0(0x41a,0x39d,0x3ea,0x487)](setTimeout,()=>{function _0x1b0284(_0x15c35c,_0x5d9c2e,_0x38c2a6,_0x567f0d){return _0x4502a0(_0x38c2a6- -0x3bd,_0x567f0d,_0x38c2a6-0x3f,_0x567f0d-0x5d);}function _0x1ba00a(_0x362809,_0x291d33,_0x37fe9a,_0x1533b3){return _0x26252a(_0x362809-0xec,_0x291d33,_0x362809-0x55,_0x1533b3-0x4);}console[_0x1b0284(-0xae,-0x68,-0x1d,-0x5e)](_0x5695a8['lFgwa']),window[_0x1b0284(0xfd,0xbb,0x91,0x131)]=!![];},extension_settings[extensionName]['imageGenIn'+_0x26252a(-0x3,0x12f,0x98,0x6e)]);;if(!_0x2a001a['ok']){const _0x3645b0=await _0x2a001a[_0x4502a0(0x426,0x44e,0x3f7,0x4ca)]();addLog(_0x26252a(0x63,0x32,0x77,0xba)+_0x26252a(0xea,0xc4,0x138,0x98)+_0x2a001a[_0x26252a(-0x18,0x94,0x6e,-0x10)]+'。响应内容:\x20'+_0x3645b0),console['log'](_0x5695a8[_0x4502a0(0x3bb,0x455,0x439,0x3d4)],_0x3645b0);throw new Error('请求失败,状态码:\x20'+_0x2a001a[_0x26252a(-0x1d,0x8f,0x6e,0xb3)]+_0x4502a0(0x3fc,0x46a,0x474,0x428)+_0x3645b0);}const _0x3aa829=await _0x2a001a[_0x26252a(0x179,0x148,0x11e,0x187)]();if(!_0x3aa829[_0x4502a0(0x416,0x408,0x3f6,0x469)]||_0x5695a8['Ofnbu'](_0x3aa829[_0x4502a0(0x416,0x42f,0x3e5,0x3b7)][_0x4502a0(0x38c,0x3fc,0x363,0x2f3)],-0x264d+0x7*0x56a+0x67))throw new Error(_0x5695a8[_0x4502a0(0x3eb,0x3d9,0x47d,0x45b)]);const _0x3434c5=_0x3aa829[_0x26252a(0x4e,0xca,0xc8,0xbe)][-0x3*0xa57+0x1e92+0x73],_0x5a108e=_0x5695a8[_0x26252a(0x118,0x185,0x15a,0x1ef)]+_0x3434c5;return _0x5695a8[_0x26252a(0xe4,0x122,0xca,0x86)](addLog,_0x5695a8['uwBJk']),taskQueue['completeTa'+'sk'](_0x51703b,!![]),currentTaskId=null,{'image':_0x5a108e,'change':_0x5695a8[_0x26252a(-0x4,0x99,0x8f,0x114)](_0x50ee02,'')};}}catch(_0x51af49){if(_0x5695a8[_0x4502a0(0x3a1,0x43e,0x40d,0x323)](_0x5695a8['AHsyR'],_0x5695a8[_0x26252a(0xbb,0x1b0,0x159,0xc4)])){window['xiancheng']=!![];if(_0x5695a8['XSDRK'](_0x51af49[_0x26252a(0xb0,0x14a,0x132,0x152)],_0x5695a8[_0x26252a(0x16,0x5d,0x96,0x64)])){}else _0x5695a8[_0x4502a0(0x4af,0x47e,0x535,0x52b)](_0x5695a8['schaP'],_0x5695a8[_0x26252a(0xb2,0xd1,0x68,0x10b)])?taskQueue[_0x4502a0(0x447,0x4bc,0x3a2,0x3ea)+'sk'](_0x51703b,![]):_0x17a1b3[_0x4502a0(0x447,0x4e6,0x4b3,0x449)+'sk'](_0x27bfc6,![]);currentTaskId=null,_0x5695a8['LhTss'](addLog,'sd请求生图错误:\x20'+_0x51af49[_0x4502a0(0x480,0x503,0x403,0x46a)]),console['error'](_0x5695a8[_0x4502a0(0x3de,0x3d9,0x397,0x433)],_0x51af49);throw _0x51af49;}else _0x30b86f[_0x4502a0(0x40b,0x464,0x44e,0x4a6)+_0x4502a0(0x49f,0x460,0x469,0x509)]&&(_0x33754d[_0x4502a0(0x3e7,0x3a3,0x433,0x435)+_0x26252a(0x15c,0x139,0x170,0x17e)](_0x40abd9[_0x4502a0(0x3e2,0x47f,0x419,0x448)+_0x26252a(0x1d5,0x115,0x172,0x193)+'ST'],_0x10f0a1),_0x5d9776[_0x26252a(0xf8,0x15d,0xbd,0x63)+'SDListener']=![],_0x5695a8[_0x4502a0(0x3ad,0x3b6,0x38a,0x39d)](_0xa809b4,_0x5695a8[_0x4502a0(0x4bc,0x481,0x422,0x537)]));}}async function sdGenerate(_0x3088b6){const _0x119d77={'VhOJb':function(_0x5007b4,_0x36fbfd){return _0x5007b4(_0x36fbfd);},'PfbJo':_0xbea656(-0x19b,-0x158,-0x110,-0xf4)+_0xbea656(-0x6f,-0x58,-0xe3,-0x9c),'DpBMX':_0x1f2142(-0x148,-0x110,-0x140,-0x1b6)+'osition','Bngyc':function(_0x18719d,_0x21c5b0){return _0x18719d+_0x21c5b0;},'qumrp':function(_0xd7858d,_0x215af0){return _0xd7858d+_0x215af0;},'hCSwy':function(_0x382757,_0x50d40a){return _0x382757(_0x50d40a);},'SSBxo':_0xbea656(-0x5a,-0xe2,-0x110,-0x127),'sCYnD':function(_0x4d3d07,_0x35cf84){return _0x4d3d07===_0x35cf84;},'akoDj':function(_0x1c378e,_0x3cf577){return _0x1c378e!==_0x3cf577;},'OiEUO':_0xbea656(-0x41,-0x55,-0x82,-0x7f),'QGASE':function(_0x21f76e,_0x29d3fb){return _0x21f76e(_0x29d3fb);},'wtmTS':function(_0x22e16e,_0x16a43e){return _0x22e16e(_0x16a43e);},'psRJJ':'Error\x20gene'+'rating\x20SD\x20'+'image:','vWxIi':function(_0x1c5243,_0x374feb){return _0x1c5243(_0x374feb);}};function _0x1f2142(_0x4fa946,_0x3491ae,_0x31b329,_0x2a0e34){return _0x348f(_0x3491ae- -0x2e3,_0x2a0e34);}const {id:_0x4657cc,prompt:_0xac7138,width:_0x592aa4,height:_0xf9852f,change:_0x36477f}=_0x3088b6;_0x119d77[_0x1f2142(-0xe6,-0x188,-0x1ec,-0x1d5)](addLog,'收到SD生图请求\x20('+_0xbea656(-0x14e,-0xda,-0xc4,-0x87)+_0x4657cc+(')\x20-\x20Prompt'+':\x20')+_0xac7138+(_0x36477f?_0xbea656(0xa,-0x35,0x61,-0x3e)+'\x20'+_0x36477f:''));function _0xbea656(_0x1818ed,_0x46276d,_0xaf4ce,_0x74635e){return _0x348f(_0x46276d- -0x279,_0x1818ed);}if(_0x36477f&&_0x36477f['includes'](_0x119d77['SSBxo'])){if(_0x119d77[_0x1f2142(-0x212,-0x1aa,-0x236,-0x1bb)](_0xbea656(-0x11a,-0x152,-0xee,-0x158),_0x1f2142(-0x22e,-0x1bc,-0x254,-0x22d))){bananaGenerate(_0x3088b6);return;}else _0x119d77[_0x1f2142(-0x134,-0x140,-0x184,-0x1ca)](_0x18248e,_0xbea656(-0x53,-0xf7,-0x18a,-0x70)+'库');}try{if(_0x119d77[_0x1f2142(-0x1aa,-0x114,-0xc7,-0x97)](_0x119d77[_0x1f2142(-0x139,-0x153,-0x1bd,-0x18d)],'nDOiR')){const {image:_0x2bfcc5,change:_0x4a8c00}=await generateSDImage({'prompt':_0xac7138,'width':_0x592aa4,'height':_0xf9852f,'change':_0x36477f});if(extension_settings[extensionName][_0x1f2142(-0xe6,-0xf6,-0x13a,-0xef)]!='0'){const _0x21328c={};_0x21328c['change']=_0x4a8c00,await setItemImg(_0xac7138,_0x2bfcc5,_0x21328c),_0x119d77[_0xbea656(-0x199,-0x11e,-0x7d,-0xf8)](addLog,'图像已存入数据库\x20f'+_0x1f2142(-0x10b,-0x13a,-0x107,-0x100)+'\x20'+_0xac7138);}else _0x119d77['QGASE'](addLog,_0xbea656(-0x159,-0xf7,-0x12f,-0x19d)+'库');const _0x794d3c={};_0x794d3c['id']=_0x4657cc,_0x794d3c[_0xbea656(-0x146,-0xac,-0x13,-0x12c)]=!![],_0x794d3c['imageData']=_0x2bfcc5,_0x794d3c['prompt']=_0xac7138,_0x794d3c[_0xbea656(-0xfb,-0x99,-0xfe,-0x132)]=_0x4a8c00,eventSource[_0xbea656(-0x91,-0x8a,-0x11f,-0x5c)](EventType['GENERATE_I'+_0xbea656(-0xf2,-0x166,-0x1ff,-0xf0)+_0xbea656(-0xbe,-0x74,-0x2c,-0x2c)],_0x794d3c),_0x119d77['QGASE'](addLog,'发送SD生图成功响应'+_0x1f2142(-0x5a,-0xda,-0xae,-0x14d)+_0x4657cc+')');}else{_0x119d77[_0x1f2142(-0x191,-0x140,-0x1d0,-0xe5)](_0xe8ec2f,_0x119d77[_0x1f2142(-0x14a,-0xbd,-0x49,-0x162)]),_0x446d3e=_0x119d77[_0xbea656(-0x72,-0xd6,-0x12c,-0x72)](_0x4ef1e0,_0x3b8d60),_0x481331=_0x4955d1[_0x119d77[_0xbea656(-0x62,-0xd9,-0x13d,-0x5d)]];for(let _0x44ece7=0x19d4+0x1558*-0x1+-0x47b;_0x44ece7<=-0x1a2f*-0x1+0x10eb+0x1*-0x2b16;_0x44ece7++){_0x491ae3[_0xbea656(-0x87,-0x63,0x31,-0xcd)+_0x44ece7+'\x20Prompt']&&(_0x5a1d7b=_0x119d77[_0x1f2142(-0x12d,-0x10f,-0x112,-0x178)](_0x119d77[_0x1f2142(-0x1f0,-0x158,-0x196,-0x137)](_0x4f130f,',\x20'),_0x5c2287[_0xbea656(-0x9b,-0x63,-0xb5,-0xbb)+_0x44ece7+_0x1f2142(-0x24e,-0x1d3,-0x19c,-0x181)]));}}}catch(_0xc11b1d){const _0x217810=_0x1f2142(-0x130,-0xb8,-0x87,-0xf0)+_0x1f2142(-0x187,-0x11e,-0x1b3,-0xb5)+_0x4657cc+'):\x20'+_0xc11b1d[_0xbea656(-0x6e,-0x6b,-0xd,-0xce)];_0x119d77[_0xbea656(-0x154,-0x108,-0xec,-0xbc)](addLog,'错误:\x20'+_0x217810),console[_0xbea656(-0xaf,-0x6a,-0xd1,-0xb0)](_0x119d77[_0xbea656(-0x9e,-0x101,-0x89,-0x131)],_0xc11b1d);const _0x303bbf={};_0x303bbf['id']=_0x4657cc,_0x303bbf['success']=![],_0x303bbf['error']=_0xc11b1d['message'],_0x303bbf[_0x1f2142(-0x22b,-0x195,-0x1c5,-0x20d)]=_0xac7138,eventSource[_0x1f2142(-0xb7,-0xf4,-0xee,-0x114)](EventType[_0xbea656(-0xd5,-0x109,-0x98,-0x11b)+_0x1f2142(-0x253,-0x1d0,-0x19d,-0x1bb)+_0x1f2142(-0x157,-0xde,-0x93,-0x133)],_0x303bbf),_0x119d77[_0xbea656(-0xab,-0xf2,-0x14c,-0x16c)](addLog,'发送SD生图失败响应'+'\x20(ID:\x20'+_0x4657cc+')');}}function initializeSDListener(){eventSource['on'](EventType[_0x59b7b5(-0xe2,-0xc8,-0x7c,-0x10d)+_0x59b7b5(-0x4,-0x34,-0x81,-0x1c)+'ST'],sdGenerate);function _0x59b7b5(_0x23d13b,_0x79ad7e,_0x1f3b34,_0x42356f){return _0x348f(_0x23d13b- -0x252,_0x42356f);}function _0x137167(_0x56fd5e,_0x482532,_0x3c6c8b,_0x3db872){return _0x348f(_0x3c6c8b- -0x19b,_0x482532);}addLog(_0x137167(-0xcd,0x4,-0x33,0x4a)+_0x59b7b5(-0x8b,-0x131,-0xcb,-0x30));}export async function replaceWithSd(){function _0x3a5998(_0xcf1186,_0x27b1af,_0x35dd55,_0x32777c){return _0x348f(_0x32777c- -0x318,_0xcf1186);}const _0x4b4bbf={'wThOX':function(_0x275050,_0xabbeb5){return _0x275050(_0xabbeb5);},'Cogxn':_0x3a5998(-0x117,-0x245,-0x1d8,-0x1bc)+_0x11447a(0x244,0x295,0x23c,0x281)+_0x11447a(0x30b,0x2c3,0x2b2,0x2cb),'ggPOH':_0x3a5998(-0x127,-0x199,-0x17c,-0x187),'UzGDp':_0x3a5998(-0x1a7,-0x98,-0xdd,-0x12c)+_0x3a5998(-0x160,-0x240,-0x1c7,-0x1b3),'dwVUm':_0x3a5998(-0xe5,-0xa1,-0x180,-0x123),'jfrzD':function(_0x186a62,_0x36a155){return _0x186a62==_0x36a155;},'QKltD':function(_0x287853){return _0x287853();},'Pbfgs':function(_0x33d2d2,_0x28b4b0){return _0x33d2d2===_0x28b4b0;},'QxMeZ':function(_0xfe33a7,_0x455645){return _0xfe33a7===_0x455645;},'tcPsS':'JhEXO','fIqxu':function(_0x422955,_0x3ab2eb){return _0x422955(_0x3ab2eb);},'MahEr':'SD\x20生图事件监听器'+'已关闭。'};function _0x11447a(_0x49d0b9,_0x1484a7,_0x3434d1,_0x4475e7){return _0x348f(_0x1484a7-0x140,_0x3434d1);}if(_0x4b4bbf['jfrzD'](extension_settings[extensionName]['mode'],'sd'))!window[_0x3a5998(-0x129,-0xfa,-0x177,-0x17f)+'SDListener']&&(window[_0x11447a(0x296,0x2d9,0x28c,0x37b)+_0x11447a(0x35d,0x36d,0x313,0x332)]=!![],_0x4b4bbf['QKltD'](initializeSDListener)),initializeImageProcessing();else{if(_0x4b4bbf[_0x3a5998(-0x182,-0x18c,-0x144,-0x141)](_0x3a5998(-0x1d7,-0x253,-0x219,-0x1f3),'yPrDQ'))_0x4b4bbf['wThOX'](_0xe2139d,_0x4b4bbf[_0x3a5998(-0x86,-0x18f,-0x111,-0x122)]),_0x3a76ae=_0x14f782;else{if(window['initialize'+_0x3a5998(-0x89,-0xbf,-0x51,-0xeb)]){if(_0x4b4bbf[_0x3a5998(-0x113,-0xef,-0x168,-0xe9)](_0x4b4bbf[_0x11447a(0x367,0x30a,0x3ab,0x31c)],_0x3a5998(-0x7b,-0xf4,-0x195,-0x114))){_0xf4a7b5(_0x4b4bbf[_0x3a5998(-0x1c4,-0x221,-0x15b,-0x1d3)]),_0x3d493d['emit'](_0x4b4bbf[_0x11447a(0x230,0x2cc,0x258,0x28d)]);throw new _0x778b1f(_0x4b4bbf[_0x3a5998(-0x1a2,-0x198,-0xde,-0x137)]);}else eventSource['removeList'+_0x3a5998(-0x157,-0x13a,-0x96,-0xcc)](EventType[_0x11447a(0x331,0x2b0,0x20b,0x248)+_0x11447a(0x3d6,0x38e,0x33d,0x2eb)+'ST'],sdGenerate),window['initialize'+_0x3a5998(-0x9c,-0x6b,-0x5b,-0xeb)]=![],_0x4b4bbf[_0x11447a(0x1f3,0x269,0x212,0x2f1)](addLog,_0x4b4bbf[_0x11447a(0x2ec,0x303,0x268,0x391)]);}}}}