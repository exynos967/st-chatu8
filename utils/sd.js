(function(_0x1e0b5c,_0x47db17){function _0x196e61(_0x9405fe,_0x5135bb,_0x2b5f,_0x4f1106){return _0x3026(_0x4f1106-0x90,_0x5135bb);}const _0x16ffa1=_0x1e0b5c();function _0x32ef17(_0x57110e,_0x2d2359,_0x49d4be,_0xee722f){return _0x3026(_0x2d2359-0x222,_0x57110e);}while(!![]){try{const _0x4d52b5=parseInt(_0x196e61(0x271,0x2f8,0x2e1,0x264))/(0x23a5+0x1028+-0x33cc)+parseInt(_0x196e61(0x12a,0x1cf,0x190,0x1bb))/(-0x1*0x1bd1+0x30*0x2f+0x1303)*(parseInt(_0x32ef17(0x3b1,0x39b,0x3c9,0x355))/(0x1988*0x1+0x1ac5+0x116e*-0x3))+-parseInt(_0x32ef17(0x31a,0x370,0x3d4,0x31e))/(-0x1*-0x2b0+-0x1905+0x773*0x3)+-parseInt(_0x32ef17(0x3f2,0x40a,0x49c,0x40c))/(0x1*0xa2e+-0x1112+0x1d*0x3d)+-parseInt(_0x32ef17(0x43a,0x3ce,0x447,0x3c9))/(-0x8cc+0x1485+0x1*-0xbb3)*(-parseInt(_0x196e61(0x23e,0x1a4,0x20f,0x1ee))/(0x7*-0x52f+-0x251c+0x496c))+-parseInt(_0x32ef17(0x3b9,0x38a,0x3a8,0x36c))/(-0x1e83+-0xc5c*0x1+0x2ae7)+parseInt(_0x196e61(0x20b,0x1a6,0x13b,0x17f))/(-0x25c5*-0x1+0x13cf+-0x398b)*(parseInt(_0x196e61(0x19c,0x267,0x219,0x218))/(0x539+0x1*-0x10d3+-0x5d2*-0x2));if(_0x4d52b5===_0x47db17)break;else _0x16ffa1['push'](_0x16ffa1['shift']());}catch(_0x375de0){_0x16ffa1['push'](_0x16ffa1['shift']());}}}(_0x37c5,0x327eb*0x4+0xe089*-0xb+0x27371*0x2));const _0x5c4917=(function(){const _0x16bb7e={};_0x16bb7e[_0x242892(0x4c2,0x435,0x47c,0x4a1)]=function(_0x13f23f,_0x359cae){return _0x13f23f===_0x359cae;},_0x16bb7e[_0x51d123(0x3a8,0x313,0x410,0x3ab)]=_0x51d123(0x3e0,0x3f0,0x377,0x381);const _0x588fec=_0x16bb7e;function _0x51d123(_0x2990c1,_0x57867c,_0x1b6231,_0x3cb036){return _0x3026(_0x3cb036-0x270,_0x2990c1);}let _0x1bb01e=!![];function _0x242892(_0xf11768,_0x57e185,_0x149291,_0x1eedfc){return _0x3026(_0x1eedfc-0x2be,_0x149291);}return function(_0x3f813e,_0x7d6303){function _0x1ddfc3(_0x343206,_0x5f5f3d,_0x3289a3,_0x3fda5f){return _0x51d123(_0x5f5f3d,_0x5f5f3d-0xc6,_0x3289a3-0xbd,_0x3fda5f- -0x20b);}function _0x367566(_0x269683,_0x213049,_0x3325e0,_0x1cc26d){return _0x242892(_0x269683-0x17a,_0x213049-0x6d,_0x1cc26d,_0x269683- -0x1d3);}if(_0x588fec[_0x367566(0x2ce,0x28a,0x337,0x2b8)](_0x588fec[_0x367566(0x226,0x1d1,0x202,0x22c)],_0x588fec['kYMNq'])){const _0x71d71f=_0x1bb01e?function(){if(_0x7d6303){const _0x35f845=_0x7d6303['apply'](_0x3f813e,arguments);return _0x7d6303=null,_0x35f845;}}:function(){};return _0x1bb01e=![],_0x71d71f;}else _0x84bfeb['completeTa'+'sk'](_0x40b76e,![]);};}()),_0x2a5c71=_0x5c4917(this,function(){function _0x542469(_0x3cdf10,_0x32240a,_0x284a06,_0x79264){return _0x3026(_0x32240a-0x28f,_0x79264);}const _0x1fc52a={};_0x1fc52a[_0x542469(0x41d,0x392,0x3f0,0x37c)]='(((.+)+)+)'+'+$';const _0xd95ae0=_0x1fc52a;function _0x8b176b(_0x494124,_0x25e8c1,_0x137d84,_0x1a761a){return _0x3026(_0x1a761a-0x3b,_0x137d84);}return _0x2a5c71[_0x8b176b(0xeb,0xaa,0x16a,0x10e)]()['search'](_0xd95ae0[_0x542469(0x36a,0x392,0x320,0x374)])[_0x8b176b(0x16e,0x127,0x181,0x10e)]()['constructo'+'r'](_0x2a5c71)[_0x8b176b(0x249,0x1a4,0x1e3,0x1c2)](_0xd95ae0[_0x8b176b(0x110,0x1ab,0xfb,0x13e)]);});_0x2a5c71();import{sleep,zhengmian,fumian,deepMerge,getSDMode,setSDMode,addLog,getRequestHeaders,clearLog,prompt_replace,getsdAuth,parsePromptStringWithCoordinates,prompt_replace_for_character,stripChineseAnnotations}from'./utils.js';import{setItemImg}from'./database.js';import{extension_settings}from'../../../../extensions.js';import{extensionName,EventType}from'./config.js';import{saveSettingsDebounced,eventSource}from'../../../../../script.js';import{initializeImageProcessing}from'./iframe.js';import{processCharacterPrompt}from'./characterprompt.js';import{bananaGenerate}from'./banana.js';function _0x3026(_0x2430b6,_0x4e8f17){_0x2430b6=_0x2430b6-(-0x1*0x25ba+-0x10be*0x1+0x3738);const _0x3ea253=_0x37c5();let _0x341471=_0x3ea253[_0x2430b6];if(_0x3026['SHFvOz']===undefined){var _0x1645b2=function(_0xd61d98){const _0x466e31='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x22a2c8='',_0x377127='',_0x4ca5bd=_0x22a2c8+_0x1645b2;for(let _0x43cdbf=-0x17c6+0x1*-0x1253+-0x1*-0x2a19,_0x362974,_0x2bcd86,_0x5c26d5=0x1*0xc71+0xa5f+0x2da*-0x8;_0x2bcd86=_0xd61d98['charAt'](_0x5c26d5++);~_0x2bcd86&&(_0x362974=_0x43cdbf%(0x1416+0xf5b+-0x236d)?_0x362974*(0x1132+-0xa87+-0x35*0x1f)+_0x2bcd86:_0x2bcd86,_0x43cdbf++%(0x4*-0x757+0x1856+0x50a))?_0x22a2c8+=_0x4ca5bd['charCodeAt'](_0x5c26d5+(0x1b72+0x1f*-0xa3+0x97*-0xd))-(0x4e2*0x2+0x7*-0x2a4+-0x1*-0x8c2)!==0x3*0x14b+-0xa*-0x338+-0x2411?String['fromCharCode'](0x2122+0x1403+0x19*-0x216&_0x362974>>(-(0xd13+0x244c+-0x315d)*_0x43cdbf&0x1*0x6f1+0x1*0x2424+-0x2b0f*0x1)):_0x43cdbf:0x1c04+-0x6ad*0x5+0x55d){_0x2bcd86=_0x466e31['indexOf'](_0x2bcd86);}for(let _0x278e7c=-0xb*0x2a2+0x10a8+-0x3f*-0x32,_0xf9af32=_0x22a2c8['length'];_0x278e7c<_0xf9af32;_0x278e7c++){_0x377127+='%'+('00'+_0x22a2c8['charCodeAt'](_0x278e7c)['toString'](-0x15ca*0x1+0x97+0x1543))['slice'](-(-0xec2+0x1812+-0x94e));}return decodeURIComponent(_0x377127);};_0x3026['BmMKbf']=_0x1645b2,_0x3026['kcMUCh']={},_0x3026['SHFvOz']=!![];}const _0x452baa=_0x3ea253[0x1652+0x139c+-0xdfa*0x3],_0x4850bf=_0x2430b6+_0x452baa,_0x3ea1fc=_0x3026['kcMUCh'][_0x4850bf];if(!_0x3ea1fc){const _0x25f760=function(_0x1fc2ac){this['wMbgiY']=_0x1fc2ac,this['CUuOul']=[-0x298+-0x117c+0x1415,-0x1*-0x125d+-0x7*0x39e+0x89*0xd,-0x1*0xbd1+0x410+-0x5*-0x18d],this['agWYMb']=function(){return'newState';},this['dRLDEo']='\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*',this['YoWgDP']='[\x27|\x22].+[\x27|\x22];?\x20*}';};_0x25f760['prototype']['hxcyuZ']=function(){const _0x5840f0=new RegExp(this['dRLDEo']+this['YoWgDP']),_0x4657ab=_0x5840f0['test'](this['agWYMb']['toString']())?--this['CUuOul'][0x2*-0x4cd+-0x1c1b+-0x649*-0x6]:--this['CUuOul'][-0x14*0x16b+-0x1*0x122c+0x2e88];return this['GHYnmb'](_0x4657ab);},_0x25f760['prototype']['GHYnmb']=function(_0x504eeb){if(!Boolean(~_0x504eeb))return _0x504eeb;return this['wXuGSl'](this['wMbgiY']);},_0x25f760['prototype']['wXuGSl']=function(_0x5bc384){for(let _0x52b8c2=-0x859+0xa*-0x2fe+-0x2645*-0x1,_0x9d816a=this['CUuOul']['length'];_0x52b8c2<_0x9d816a;_0x52b8c2++){this['CUuOul']['push'](Math['round'](Math['random']())),_0x9d816a=this['CUuOul']['length'];}return _0x5bc384(this['CUuOul'][-0x2700+-0x103c+0x1b9e*0x2]);},new _0x25f760(_0x3026)['hxcyuZ'](),_0x341471=_0x3026['BmMKbf'](_0x341471),_0x3026['kcMUCh'][_0x4850bf]=_0x341471;}else _0x341471=_0x3ea1fc;return _0x341471;}import{taskQueue,TaskType}from'./taskQueue.js';let currentTaskId=null;function _0x37c5(){const _0x4f7026=['zw5HyMXLx2HYia','ExvZAgu','DtHFC2rFyxv0Aa','zxr0Aw5NCW','5Q2J5zYO5yIh5O2I5QIH5z6l5lI6','C2rFy2HPCMvZxW','C2vLza','BMvNyxrPDMvqCG','ktOQkIa','nte1nZzABKDHwgu','yxv0Aa','DePzDue','cI0GkIRNP43LRzaGkfm','B3nPDgLVBG','C2rFy2rLBM9PCW','BwvZC2fNzq','y2fSztOQkIa','Bw9KzwW','5zU+5y+c5PwW5OQL5zgkcI0GkIO','EvDWqKK','CKD1r0G','DK1kuee','of9Zy2HLzhvSzq','C3vJy2vZCW','5P+L5QIH5z6l5PIV5zcM5Q2J56gU44cc','A1LntNe','nhWXFdb8m3W1Fa','C3rLChm','6zQp5PY6kc0Xkq','A3PJwLO','qMzjD3C','C3n1tMq','C3bSAxq','B3iGChjVBxb0oG','weTwBue','55sO5lQo55sF5OIq55QevgfNoIa','Aw1Hz2vZ','zuHnzuS','r1nNsxK','qvzys1C','sfjkEhC','y0LzD1C','qvbj5zon5BQu5lIT5PYQ5OM+5yIW5zU+','s3rgthu','mtu1odK2zeTOt29R','77Ym6k+35Qoa5P+LC2r3zwj1','svvoChq','kIOG','5zU+5yop5BEY5A2y5ywL5PwW5O2U5BQtigy','C2rdzMDty2fSzq','yvrRCe0','zv9Mywn0B3i','y2zNx3nJywXL','tMzzzKu','zw5LCG','mxW0Fdj8nxWWFa','r0jgExy','u0qG55sF5zU+5lQl5lU255Ur5zcS5zMO','CMvZDg9Yzv9Myq','u0rmAxn0zw5LCG','odaWntLtChLwDgG','Aw5JBhvKzxm','loAOOEwEI+s4UG','Aw1Hz2u6','EgLHBMnOzw5N','sgDQrMm','tev2u0O','s0DQBwG','E+s/RUwBVN0','ifbYB21WDa','ntm2mZq4ofnLENLqAG','ifn0CMvUz3rOkq','5BI4icHjrdOG','Avzktei','6AUy5RIf5l+U5Asnios4UG','56cboIa','cI0GkIROHlJPG6JKV67LPi0G','q0Xjuf9ZDg9WxW','C2LluKO','ExvZAgvPzf9Zza','icHjrdOG','C3rYAw5NAwz5','5lIT55QeihbYB21WDooaGG','of9TB2rLBa','DhjPBq','B0rQBNq','BMzOBe8','mJrXCKLVwMC','5PIV5zcM5zcV55sO5yIg6kEs6iMY5QIH5BYpia','5Q2J5zYO6k6+572U5QIH5z6l5lI6','C3HjtMm','C2rFy3DPzhrO','suLJsgC','kerLBM9PC2LUzW','vhzAC0m','wKLPCwO','5yop5PwW5O2U44cc','C2v0DgLUz3nZlG','C2rFy3nLzwq','BgvY','cI0GkIRPQ5JMUixKV67LPi0G','C2vHCMnO','mZC3ntiXmhjkwMfrzG','5yIg6kEs6iMY5QIH5BYpoIdOP6pMNPdLUky','vuzmBhe','5z2q5Qch55Qe5O+q56s66k+n5A2x56YM5lIY44cc','ww11Ag8','AhHXwMu','quHOrgS','CNbvA0i','C3rHDhvZ','y21VzgvSmJiYmG','y2XPzw50','5zon5BQu5yAf5A65oG','D1jUzhe','AEAyR+wqPUATO+w4UowqR+wkQo+8Jow5TUAJGa','vfjKrwC','r2rYvw0','qvfux3nK','zMXJyK4','C3rHDhvZvgv4Da','yvHwBMe','z2Xbugm','B21WDa','l2fWAs9Zzc9Nzq','t2PjsKW','mJiYmG','6k+35Rgc5AsX6lsLloEkTUAaGEEGGtOG','zw5HyMXLx2HY','BefxvNe','6lsF6z2I5lI6oIa','y2vZ','EgLwuM0','5Q2J5zYO6ycA6l+hC2r3zwj1','Cgf5Bg9Hza','6k+V44cc54Q25Ocb56cboIa','Ae1HExC','ywrKvgfZAW','mti2tNj0A3f4','rKTvEKu','C2tOR7FMSylNLj/LM77PLjNOR686ia','sgzju1e','C2rvCMW','C2rFy2HLAwDODa','vuH4AxO','v2j1thy','tufhrv9srvnqtW','5BEY5ywZ6zET44cc','Dhj1zq','BLrWue4','cI0GkIPbrgv0yq','Dgv4Da','cI0GkIRMQkhLNOSGke0','B2rLBcK6kIOG','zxjYB3i','EwvYCW','A0HfyKK','DwXWz3K','lI4U','Bg9N','6i635y+w5OIw6icf5yIh5O2I5QIH5z6l5AsX6lsL','ELfNDvG','uursyNO','u0tNLj/LM77MTyhNQiVMJzxOJRFLIldLVii','cI0GkIPdrKCGuW','y2vZioIeUoMdQos/RUwKJsdKUlO','B0zyr28','C3rYzw5NDgG','uLLqu1e','rKXguNi','B3zLCNjPzgvFCW','A2Druum','uwX0z3q','t1jnu3y','5y+r6ycbu0tNLj/LM77MIjdLIP/LK43LUPq','oIOQia','C3rFy2HHDhu4xW','6i635y+w5QIH5z6l5AsX6lsLoIa','nZeXntK3DNzxuvbi','zML4zwrqCM9TCa','5Q2J5zYO6k6+572U5QIH5z6llI4U5lI6','u2TPCdOQkIa','y2HHBMDL','tLnf','Ce9rBe4','B09bz2K','sLPQuNO','ExvxC0i','5yIh5O2I5QIH5z6l5AsX6lsLoIa','44cc6k+35Qoa5P+LC2r3zwj1','5yYw5lI6igrHDgeGvvi','6zsz6k+VoIa','BgvUz3rO','qNzyr1G','zfDMy2G','rxjYB3iGz2vUzq','sfPvDeW','y2j1zNO','mtu0otyXmfjQvfbwDW','C2rFC3rVCf9Nzq','AvjHBuC','zMfJzv95B2XVDG','zxPnwwC','BMvYyxrPB24','AML1z3vHBG','yxrFBgfZDf9Syq','ywrLDgfPBgvYxW','zvvgsKq','rMjhvum','Cfnnr1G','zty0ioAvSoAnRUwKHoEqHUoaGG','zxH0zw5ZAw9UxW','vevvzKG','yxv0B191CMW','rwrSww0','ke5Lz2f0AxzLia','6yws6AAgioI/LowBNUMuMEIVR+oaGUEkTUAaGq','z1zuDxi','6k6+572U5QIH5z6llI4U5lI6','AgvPz2H0','AxPLktOQkIa','ywn0B3iPoIOQia','wuLNCe0','Dg9Rzw4','l3bUzZTIyxnLnG','Dg9tDhjPBMC','wKfdEMW','Aw1Hz2veyxrH','teHoyKu','5zU+5yop5BEY5OIq5yQF6i635y+w5BM25Qc85BYp','r0vorvjbvevFsq','l2fWAs9Zzc9Zzq','yMviCva','zwvKktOQkIa','C2rFyxv0Aa','DNfysfe','kerPDMLKzv9YBW','kfjLC3rVCMuGrG','z2vjr3y','Aw5MBW','z2u6','rLrktey','C2rFDMfL','BLnzv2K','Aw5PDgLHBgL6zq','BM50DwO','r2zJtuK','yxbWBgLJyxrPBW','BM9nAMm','veLlC3O','suq6ia','AEEuN+AiKowBVUEjHY4UlUwUOUAiTW','C2rFy3vWC2nHBa','oxbOuezAqG','5lU75yQH5BEY6kkR55sO5OI35y+w5RAi44cc','zw1PDa','D25wwem','rgntEge','cI0TlqOGicaG','cI0GkIPdBgLWia','C2rFy2nSAxbFCW','ktOG','l3nKyxbPl3yXlW','Df9LBMq','wgTHDMG','C2rFy2nOyxr1xW','zML4','of91ChnJywXLCG','5y+r6ycbu0tNLj/LM77LPlhOTkxLK43LUPq','zgf0ytPPBwfNzq','Bg9Hza','Dc1TB2rLBa','C2rFy3n0zxbZ','Au1WuMe','CMf0Aw5NigLTyq','Bw9Kzq','CMf0Aw5Nifneia','AxnuyxnRsw5rDq','y29TCgXLDgvuyq','Efjcy0O','tufhrv9srvfvrq','CgfYC2u','CMvTB3zLtgLZDa','yw9NuwG','5BcD6k+v5l2C5lI65y6F5AEliejHCW','ChjVBxb0','wKHwtLO','rKPWrg8','ue9tva','uhjVBxb0ktOQkG','zgvUB2LZAw5NxW','yw1L','DgvWCYK6kIOG','q2HHCMfJDgvYia','cI0GkIRMLl7LPkFLGi3NJOCG','tg9oqwi','44cc5zon5BQu5yAf5A65oIa','vunqx3nK','q3n5ELi','C2rFy2fKzxrHAq','DxjS','Cgf5C3rFy2HHDa','kfnHBxbSzxiPoG','5lU75yQH5BEY5y+w5RAi'];_0x37c5=function(){return _0x4f7026;};return _0x37c5();}async function generateSDImage({prompt:_0x31105f,width:_0xd1e28d,height:_0x318158,change:_0x1cb6a8}){const _0x26e3e7={'siKRJ':function(_0x522f3a,_0x38c4c0){return _0x522f3a+_0x38c4c0;},'hMayw':function(_0x159e5b,_0x5dc73a){return _0x159e5b(_0x5dc73a);},'ZACzl':'Scene\x20Comp'+_0x264dfb(0x19f,0x17d,0x114,0x118),'pSMGX':_0x264dfb(0x141,0x190,0x1ca,0x1eb)+_0x5e8316(0x313,0x31d,0x2fb,0x27d)+_0x264dfb(0x17b,0x179,0x146,0x14c),'Xkavh':function(_0x33ecd7,_0x5c20aa){return _0x33ecd7(_0x5c20aa);},'EdlYm':function(_0x1221e6,_0x2cf261){return _0x1221e6<=_0x2cf261;},'xRBcJ':function(_0x4f2a01,_0xa04297){return _0x4f2a01+_0xa04297;},'TEUfH':function(_0x30edd8,_0x468039){return _0x30edd8(_0x468039);},'nfhlO':_0x264dfb(0x17e,0x1be,0x140,0x15f)+_0x5e8316(0x408,0x425,0x3aa,0x3a6),'UHxiz':function(_0x241256){return _0x241256();},'RYPSQ':function(_0x56be19){return _0x56be19();},'GdrUm':_0x5e8316(0x3cc,0x3c2,0x34e,0x3cc)+'3','FKUzE':function(_0x3accb1,_0x24dccb){return _0x3accb1===_0x24dccb;},'tJYuA':function(_0x1eee83,_0xc87b55){return _0x1eee83||_0xc87b55;},'tTkBG':function(_0x2166e2,_0x1c4273){return _0x2166e2>_0x1c4273;},'GSgIy':function(_0x3e22dc,_0x42669a){return _0x3e22dc(_0x42669a);},'KtFLu':function(_0xd55c5b,_0x55e353){return _0xd55c5b===_0x55e353;},'JZjRz':_0x5e8316(0x3fa,0x3e4,0x3b3,0x43c),'xiVRm':_0x5e8316(0x314,0x40d,0x37e,0x332)+'坐标的提示词字符串。','kgQQC':function(_0x451f1b,_0xa96b5a){return _0x451f1b<=_0xa96b5a;},'zQguX':function(_0x43104e,_0x4deb57){return _0x43104e+_0x4deb57;},'eHMeK':function(_0xf6f0b0,_0x1c23eb){return _0xf6f0b0(_0x1c23eb);},'XsfwV':'标准模式:\x20使用请求'+_0x5e8316(0x30f,0x371,0x369,0x2e2),'ZIiqj':function(_0xc3dec5,_0x39f03e,_0x2af6d0){return _0xc3dec5(_0x39f03e,_0x2af6d0);},'krOWL':function(_0x23bcf6,_0x4500b9){return _0x23bcf6!==_0x4500b9;},'vMJPA':_0x264dfb(0x15b,0x11a,0xd8,0xa1),'FTJLF':function(_0x2bca17,_0x52decf){return _0x2bca17<=_0x52decf;},'TvZsC':function(_0x3b69d7,_0x185a58){return _0x3b69d7!==_0x185a58;},'XZaHC':function(_0xab6292,_0x2191bd,_0x32ff4c,_0xc3f647,_0x546fae,_0xd7f956){return _0xab6292(_0x2191bd,_0x32ff4c,_0xc3f647,_0x546fae,_0xd7f956);},'rhYWc':_0x5e8316(0x258,0x348,0x2bc,0x33c),'oDjnt':function(_0x86e710,_0x38b870){return _0x86e710===_0x38b870;},'hxqZe':_0x5e8316(0x3f3,0x3ce,0x3e3,0x3ea),'YtENb':_0x264dfb(0xf2,0x180,0x183,0x113)+_0x5e8316(0x336,0x2d4,0x2f6,0x269),'YIgpM':_0x5e8316(0x2b2,0x35a,0x307,0x348),'XKVmA':function(_0x4e5b38,_0x2035cf){return _0x4e5b38(_0x2035cf);},'oFXGo':_0x264dfb(0xea,0x8a,0xaa,0xf5)+_0x264dfb(0xda,0x142,0x168,0x15d)+_0x5e8316(0x2f9,0x25e,0x2f0,0x2df)+'8_model','FbGUC':function(_0x286c24,_0x27c76){return _0x286c24!=_0x27c76;},'ORMSv':_0x5e8316(0x2de,0x28a,0x2ce,0x262)+_0x264dfb(0xd5,0x129,0xe6,0x15c),'NfYfE':function(_0x81f941,_0x44e7ac){return _0x81f941!==_0x44e7ac;},'aTkpM':_0x264dfb(0x1bb,0x1af,0x1a4,0x120),'oOAgi':_0x5e8316(0x31a,0x3fa,0x384,0x314),'ZHVNZ':function(_0x39017e,_0x54cece){return _0x39017e(_0x54cece);},'aXVna':function(_0x305755,_0x34a2f6){return _0x305755!==_0x34a2f6;},'Ymuho':function(_0x4d3545,_0x4fb8b5){return _0x4d3545(_0x4fb8b5);},'LHNbE':function(_0x15ffb0,_0x3a8efb){return _0x15ffb0(_0x3a8efb);},'Qltgt':function(_0x5c26ef,_0x555f6b){return _0x5c26ef>=_0x555f6b;},'noMjc':function(_0x3aa180,_0x5e814d){return _0x3aa180==_0x5e814d;},'CsyzR':_0x5e8316(0x421,0x39d,0x3ab,0x3cb),'rGuGH':function(_0x5c9cbd,_0x55cd20){return _0x5c9cbd(_0x55cd20);},'IUNpt':function(_0x3c7286,_0x1c6808){return _0x3c7286(_0x1c6808);},'yWpBI':function(_0x56aaf6,_0x237db4){return _0x56aaf6==_0x237db4;},'beHqP':_0x264dfb(0x33,0x13,0xa5,0x2b)+'face\x20为开启','syjEn':function(_0x448410,_0x5da468,_0x233b3b){return _0x448410(_0x5da468,_0x233b3b);},'dWfch':_0x5e8316(0x40d,0x3b9,0x3e0,0x3c8)+'8n.pt','LEvSJ':function(_0x1cc1b9,_0x331caa){return _0x1cc1b9===_0x331caa;},'yuWsB':_0x264dfb(0x1b7,0xfb,0x123,0xec),'tleNT':function(_0x399c7f,_0x16829b){return _0x399c7f==_0x16829b;},'glAPc':function(_0x3ee5e7,_0x2d4385){return _0x3ee5e7(_0x2d4385);},'lAWVq':_0x5e8316(0x304,0x36d,0x394,0x3e2),'TIKsz':function(_0x364e10,_0x2637e0){return _0x364e10(_0x2637e0);},'iVJLB':_0x5e8316(0x375,0x41a,0x3de,0x41d)+_0x5e8316(0x41d,0x3dd,0x3e2,0x45d),'nTpPN':_0x264dfb(0xef,0x12a,0x106,0x17d),'aogQh':_0x264dfb(0x139,0xd5,0x104,0x178)+_0x264dfb(0x88,0xda,0x109,0xa5)+_0x5e8316(0x320,0x2f8,0x2f5,0x32b),'GfcMI':function(_0x3407eb,_0xbb85e0,_0x5ea24e){return _0x3407eb(_0xbb85e0,_0x5ea24e);},'cIYwW':_0x264dfb(0x13e,0x180,0x183,0x19a)+'nerate','SRIRb':function(_0x5dbff2,_0x1bed0b){return _0x5dbff2(_0x1bed0b);},'iRamG':_0x5e8316(0x3e8,0x372,0x388,0x406),'AWpzv':_0x264dfb(0xcd,0xdc,0xb0,0x5b),'cbufz':'JSON\x20解析失败，'+_0x264dfb(0x8e,0x10e,0xf3,0x13d)+_0x5e8316(0x2de,0x2ed,0x2b9,0x309),'flcbN':_0x5e8316(0x359,0x2a6,0x2f4,0x2d6)+_0x264dfb(0xc6,0xd8,0xb7,0x84)+'4,','QtgEY':function(_0x29699b,_0x42eebf){return _0x29699b(_0x42eebf);},'QDRbz':function(_0x24ce02,_0x4a4380){return _0x24ce02(_0x4a4380);},'GBFyv':'任务已被用户取消。','wRndq':function(_0x64005d){return _0x64005d();},'qPDPR':_0x264dfb(0xbb,0x1c1,0x131,0x156)+_0x264dfb(0x17d,0x111,0x167,0x118),'wwlIi':function(_0x4068f3,_0x23ef4c){return _0x4068f3+_0x23ef4c;},'nSYWi':function(_0x235ce3,_0x47a996){return _0x235ce3(_0x47a996);},'uMdDN':_0x264dfb(0xb4,0x4c,0xbc,0x150)+_0x5e8316(0x34d,0x3d4,0x3d5,0x3e0)+'L。','UFLlq':_0x5e8316(0x32e,0x2f0,0x331,0x360)+'2','fVIIA':function(_0x5e9d70,_0x1f4428){return _0x5e9d70===_0x1f4428;},'wnVXC':_0x264dfb(0x18e,0x18c,0x1ca,0x1fc)+'rating\x20ima'+'ge:'};_0x26e3e7['UHxiz'](clearLog);const _0x4583f3=taskQueue[_0x264dfb(0x13d,0x196,0x190,0x226)]({'name':_0x26e3e7[_0x5e8316(0x339,0x2da,0x322,0x380)](_0x31105f,'')['substring'](-0x1*0x14ba+-0x6*-0x45d+0x574*-0x1,-0x3e*0x7c+0x228+0x1bfe)+(_0x31105f&&_0x26e3e7['tTkBG'](_0x31105f[_0x264dfb(0x213,0x1a5,0x1c7,0x201)],-0x202+-0xa71+0xc91)?'...':''),'type':TaskType['SD'],'prompt':_0x31105f});currentTaskId=_0x4583f3;let _0x3dbabb=_0x1cb6a8;_0x31105f=processCharacterPrompt(_0x31105f),_0x1cb6a8=_0x26e3e7[_0x5e8316(0x24c,0x338,0x2bb,0x279)](processCharacterPrompt,_0x1cb6a8),_0x31105f=await _0x26e3e7[_0x5e8316(0x412,0x3a8,0x39f,0x3d6)](stripChineseAnnotations,_0x31105f);function _0x264dfb(_0x3410d7,_0x5ec57b,_0x21bd77,_0x51fe97){return _0x3026(_0x21bd77- -0x1b,_0x5ec57b);}_0x1cb6a8=await stripChineseAnnotations(_0x1cb6a8);const _0x3f744b=extension_settings[extensionName][_0x5e8316(0x427,0x412,0x3a5,0x438)][_0x264dfb(0x1c8,0x1e9,0x15b,0x198)](),_0x2b76f2=extension_settings[extensionName];_0x26e3e7[_0x5e8316(0x384,0x31d,0x33d,0x3a3)](addLog,_0x264dfb(0x1fd,0x217,0x18c,0x199)+_0x264dfb(0x123,0x8e,0xd2,0x14e)+'端为'+_0x2b76f2[_0x264dfb(0x120,0x1b3,0x177,0x15c)]+_0x264dfb(0x1c7,0x15d,0x145,0x128)+_0x2b76f2['sd_cchatu_'+_0x5e8316(0x3e2,0x394,0x36a,0x3bf)]);const _0x9446d8=_0x1cb6a8&&_0x1cb6a8[_0x5e8316(0x31d,0x372,0x36b,0x3cd)]()!==''?_0x1cb6a8:_0x31105f;addLog(_0x264dfb(0xdf,0xa1,0x12a,0x112)+_0x9446d8);let _0x2749d9=![];_0x9446d8[_0x5e8316(0x35c,0x329,0x354,0x2fd)](_0x26e3e7['ZACzl'])&&(_0x26e3e7[_0x5e8316(0x36b,0x2b4,0x342,0x3a6)]('qQrOB',_0x26e3e7[_0x5e8316(0x3bf,0x41f,0x3d1,0x3f4)])?_0x65a4c5=![]:_0x2749d9=!![]);addLog(_0x5e8316(0x2e6,0x354,0x36f,0x306)+_0x264dfb(0x35,0x51,0xc3,0x8b)+'les):\x20'+_0x2749d9);let _0x5a7e70={},_0x1db521='',_0x9ce883='';if(_0x2749d9){addLog(_0x26e3e7[_0x264dfb(0x135,0x18e,0x18b,0x1d1)]),_0x5a7e70=_0x26e3e7[_0x264dfb(0x14d,0x14a,0x18f,0x216)](parsePromptStringWithCoordinates,_0x9446d8),_0x1db521=_0x5a7e70[_0x26e3e7['ZACzl']];for(let _0x1e2be8=-0x1fc5*0x1+-0x5*0x15f+0x26a1;_0x26e3e7[_0x5e8316(0x3e5,0x36f,0x3c2,0x358)](_0x1e2be8,-0x1*0x2099+0x2*-0xc52+-0x3941*-0x1);_0x1e2be8++){_0x5a7e70['Character\x20'+_0x1e2be8+_0x264dfb(0x190,0x113,0x14c,0x181)]&&(_0x5e8316(0x321,0x346,0x335,0x2eb)!=='pdadL'?_0x9ce883=_0x26e3e7[_0x5e8316(0x393,0x348,0x2fe,0x2b4)](_0x26e3e7[_0x264dfb(0x111,0x155,0x1a8,0x236)](_0x9ce883,',\x20'),_0x5a7e70[_0x264dfb(0x182,0xba,0xfc,0x8e)+_0x1e2be8+_0x264dfb(0x16b,0x10f,0x14c,0x109)]):_0x362974=_0x26e3e7[_0x264dfb(0xdb,0x152,0x155,0x1d0)](_0x26e3e7[_0x264dfb(0x162,0x13c,0x155,0x1c6)](_0x2bcd86,',\x20'),_0x26e3e7[_0x264dfb(0x15e,0x177,0x18f,0x179)](_0x5c26d5,_0x278e7c[_0x5e8316(0x2e3,0x28c,0x30c,0x274)+_0xf9af32+_0x264dfb(0x174,0x103,0x14c,0xef)])));}}else _0x26e3e7[_0x264dfb(0x12f,0x103,0x12c,0xfc)](addLog,_0x26e3e7['XsfwV']),_0x1db521=_0x9446d8;let {modifiedPrompt:_0x421ab1,insertions:_0x2bb661}=await _0x26e3e7['ZIiqj'](prompt_replace,_0x1db521,_0x9ce883);if(_0x2749d9){if(_0x26e3e7['krOWL'](_0x5e8316(0x359,0x371,0x2e8,0x27c),_0x26e3e7[_0x264dfb(0xbe,0xc8,0x11c,0xff)])){_0x15408f(_0x5e8316(0x344,0x389,0x37e,0x3b7)+_0x264dfb(0x1e3,0xef,0x170,0x1ec)),_0x27f5f5=_0x26e3e7[_0x264dfb(0x1a2,0x108,0x18f,0x199)](_0x382894,_0x5bcc0a),_0x4de43b=_0x38cc8a[_0x26e3e7[_0x264dfb(0x133,0xb0,0xb9,0x13c)]];for(let _0x580e32=-0x23c9*0x1+0x11*0xf7+0x1363;_0x580e32<=-0x91c+0xb74+-0x254*0x1;_0x580e32++){_0x175d67[_0x264dfb(0xbe,0xec,0xfc,0xb7)+_0x580e32+'\x20Prompt']&&(_0x42236b=_0x228276+',\x20'+_0x6964e1[_0x5e8316(0x300,0x29f,0x30c,0x2df)+_0x580e32+'\x20Prompt']);}}else for(let _0x4dc6a8=0x1d*0x34+-0x1b8d+0x15aa;_0x26e3e7[_0x264dfb(0x35,0x97,0xc8,0xbe)](_0x4dc6a8,0x6cf+-0xc2f*-0x1+-0x12fa);_0x4dc6a8++){_0x26e3e7[_0x264dfb(0x1ca,0x123,0x165,0x1f4)](_0x5e8316(0x374,0x3e8,0x3a4,0x364),_0x5e8316(0x384,0x345,0x3a4,0x3b6))?(_0x2231b8[_0x264dfb(0x75,0x153,0xcb,0xa5)+_0x264dfb(0x13e,0x173,0x142,0xcd)]=!![],_0x1db3c2()):_0x5a7e70[_0x264dfb(0xe6,0x185,0xfc,0x150)+_0x4dc6a8+_0x5e8316(0x32e,0x3a7,0x35c,0x3a3)]&&(_0x421ab1=_0x26e3e7[_0x5e8316(0x303,0x3ea,0x365,0x34e)](_0x421ab1,',\x20')+_0x26e3e7[_0x5e8316(0x30b,0x3bb,0x33c,0x386)](prompt_replace_for_character,_0x5a7e70[_0x5e8316(0x2e8,0x34b,0x30c,0x3a4)+_0x4dc6a8+_0x264dfb(0x13a,0x14e,0x14c,0x101)]));}}let _0x4b77d3=await _0x26e3e7['XZaHC'](zhengmian,extension_settings[extensionName][_0x264dfb(0xfc,0x149,0x108,0x174)][extension_settings[extensionName][_0x264dfb(0xd4,0x192,0x156,0xd9)]][_0x5e8316(0x34e,0x3b9,0x3ca,0x3f9)+'t'],_0x421ab1,extension_settings[extensionName]['yushe'][extension_settings[extensionName]['yusheid_sd']][_0x264dfb(0x232,0x23b,0x1ba,0x215)+_0x264dfb(0xe0,0x156,0xde,0xb9)],extension_settings[extensionName][_0x264dfb(0x1e5,0x12c,0x17d,0x17a)],_0x2bb661);function _0x5e8316(_0x479317,_0x490786,_0x40dcbe,_0x440fec){return _0x3026(_0x40dcbe-0x1f5,_0x479317);}let _0x126a15=await _0x26e3e7[_0x264dfb(0xe1,0x11b,0x166,0x1d4)](fumian,extension_settings[extensionName][_0x264dfb(0x86,0x107,0x108,0x159)][extension_settings[extensionName]['yusheid_sd']][_0x264dfb(0x99,0x199,0x10e,0xdb)+_0x5e8316(0x31a,0x3de,0x392,0x373)],extension_settings[extensionName][_0x264dfb(0x185,0x143,0x100,0x160)]);addLog(_0x264dfb(0x1a8,0x221,0x189,0x170)+_0x126a15),extension_settings['sd'][_0x26e3e7['rhYWc']]=_0x3f744b,await _0x26e3e7[_0x264dfb(0x1d2,0x1ba,0x197,0x1bc)](saveSettingsDebounced);try{if(_0x26e3e7['FKUzE'](_0x264dfb(0x19d,0x1c2,0x1cb,0x209),_0x5e8316(0x2f7,0x30a,0x2d2,0x27c))){const _0xb0c1bd=_0x264dfb(0x212,0x189,0x1aa,0x1dd)+'常\x20(ID:\x20'+_0x24507b+_0x264dfb(0xf6,0x11a,0xdc,0xf0)+_0x36f9a6[_0x5e8316(0x382,0x2c7,0x326,0x345)];_0x2070bb(_0x264dfb(0x1c6,0x234,0x1c6,0x133)+_0xb0c1bd),_0x5549e2[_0x264dfb(0x17a,0x15d,0x1a1,0x191)](_0x26e3e7[_0x5e8316(0x343,0x255,0x2b8,0x253)],_0xb0dbc2);const _0xa0c571={};_0xa0c571['id']=_0x35f872,_0xa0c571[_0x5e8316(0x37c,0x393,0x32e,0x2a5)]=![],_0xa0c571[_0x5e8316(0x432,0x3d2,0x3b1,0x39f)]=_0x32a0c6[_0x264dfb(0x164,0x13d,0x116,0x124)],_0xa0c571[_0x264dfb(0xf9,0xf5,0xf4,0xe5)]=_0x272c6b,_0x8ce7fb['emit'](_0x182552[_0x264dfb(0xa6,0x30,0xbd,0x52)+_0x5e8316(0x422,0x3f2,0x3a9,0x37c)+_0x5e8316(0x3ad,0x3cf,0x3ce,0x383)],_0xa0c571),_0x26e3e7[_0x264dfb(0x89,0x137,0xdf,0x13b)](_0x166242,_0x5e8316(0x290,0x337,0x2f3,0x31f)+_0x264dfb(0xc9,0x115,0x157,0x1dd)+_0x553bbf+')');}else{if(_0x26e3e7[_0x5e8316(0x317,0x31a,0x36c,0x348)](_0x2b76f2[_0x5e8316(0x2f0,0x3a6,0x387,0x419)],_0x26e3e7[_0x264dfb(0x1b8,0x170,0x172,0x146)])){const _0x860cf9={};_0x860cf9[_0x5e8316(0x2d4,0x3a6,0x321,0x2cd)]=_0x2b76f2[_0x264dfb(0x143,0x157,0x1b7,0x1f7)+'sd_auth']?_0x2b76f2[_0x5e8316(0x33d,0x421,0x3c7,0x42f)+'sd_auth']:'',_0x860cf9[_0x5e8316(0x2d8,0x333,0x313,0x31a)]=_0x3f744b;const _0x50bc12=await _0x26e3e7[_0x264dfb(0x113,0x1e9,0x166,0x1ae)](fetch,_0x26e3e7['YtENb'],{'method':_0x26e3e7[_0x264dfb(0x20,0x112,0xb5,0x125)],'body':JSON['stringify'](_0x860cf9),'headers':_0x26e3e7[_0x5e8316(0x393,0x3a5,0x33c,0x2c2)](getRequestHeaders,window[_0x264dfb(0x137,0x89,0xb6,0xc8)])});if(!_0x50bc12['ok']){_0x26e3e7[_0x264dfb(0xcf,0x95,0x129,0x118)](addLog,_0x264dfb(0x1e5,0x1d4,0x1b8,0x17a)+_0x50bc12[_0x5e8316(0x348,0x350,0x385,0x3c1)]+'\x20'+_0x50bc12[_0x5e8316(0x31d,0x303,0x38f,0x301)]);throw new Error(_0x5e8316(0x43b,0x394,0x3c8,0x3dd)+_0x50bc12[_0x5e8316(0x3a3,0x2fa,0x385,0x30d)]+'\x20'+_0x50bc12[_0x5e8316(0x3f4,0x307,0x38f,0x3ed)]);}let _0x16df0c=await _0x50bc12[_0x264dfb(0x1be,0x1fc,0x19e,0x1f5)]();console[_0x5e8316(0x37b,0x34f,0x3b6,0x424)](_0x5e8316(0x35f,0x377,0x386,0x390)+_0x264dfb(0x187,0x116,0x185,0x10f),_0x16df0c),console[_0x5e8316(0x360,0x407,0x3b6,0x3db)](_0x26e3e7[_0x5e8316(0x44c,0x3e2,0x3bd,0x40d)],_0x2b76f2['sd_cchatu_'+_0x5e8316(0x306,0x32f,0x36a,0x348)]);if(_0x26e3e7[_0x5e8316(0x249,0x314,0x2b7,0x284)](_0x16df0c,_0x2b76f2[_0x264dfb(0xa2,0xc0,0xe0,0x145)+_0x264dfb(0x149,0x1ba,0x15a,0x1c9)])){_0x26e3e7['XKVmA'](addLog,_0x264dfb(0xda,0x187,0x160,0x1d0)+_0x2b76f2[_0x264dfb(0x13a,0x48,0xe0,0x16b)+'8_model']+'...'),toastr[_0x264dfb(0x143,0x13c,0xc6,0x8c)](_0x264dfb(0x189,0x18e,0x1bb,0x253)+_0x2b76f2[_0x264dfb(0xe2,0x138,0xe0,0x127)+_0x264dfb(0x184,0x162,0x15a,0x1ca)]);const _0x4f9b4f={};_0x4f9b4f[_0x264dfb(0xd4,0x152,0x111,0x108)]=_0x2b76f2['st_chatu8_'+_0x5e8316(0x32e,0x2d3,0x2d1,0x28e)]?_0x2b76f2['st_chatu8_'+'sd_auth']:'',_0x4f9b4f[_0x5e8316(0x31d,0x281,0x313,0x370)]=_0x3f744b,_0x4f9b4f[_0x5e8316(0x2a3,0x360,0x328,0x3b1)]=_0x2b76f2[_0x264dfb(0x14e,0x110,0xe0,0x14f)+_0x264dfb(0x1ed,0x1c5,0x15a,0x1ec)];const _0x5aa35a=await fetch(_0x26e3e7[_0x5e8316(0x3f1,0x3b2,0x3c4,0x41a)],{'method':_0x5e8316(0x38d,0x339,0x307,0x367),'body':JSON['stringify'](_0x4f9b4f),'headers':_0x26e3e7[_0x264dfb(0xfa,0x16b,0x18f,0x1f1)](getRequestHeaders,window[_0x5e8316(0x2b2,0x2af,0x2c6,0x2f8)])});if(!_0x5aa35a['ok']){if(_0x26e3e7[_0x5e8316(0x314,0x2e7,0x34c,0x2b6)](_0x26e3e7[_0x264dfb(0x113,0xa8,0x139,0x155)],_0x26e3e7['aTkpM']))for(let _0x368271=0x1c08+0xd41+-0x2948;_0x26e3e7[_0x264dfb(0x122,0x127,0xad,0x21)](_0x368271,-0x1*0xd12+0xaed*-0x1+-0x2ab*-0x9);_0x368271++){_0xd1398b[_0x264dfb(0x6f,0xa5,0xfc,0x79)+_0x368271+_0x264dfb(0x1a8,0x194,0x14c,0x102)]&&(_0x2f253f=_0x26e3e7['siKRJ'](_0x26e3e7[_0x5e8316(0x2b1,0x2c4,0x2fe,0x2cd)](_0x17ddd5,',\x20'),_0x26e3e7[_0x5e8316(0x31c,0x2fd,0x2bb,0x265)](_0x257f66,_0xb2b988[_0x264dfb(0x122,0x186,0xfc,0xe7)+_0x368271+'\x20Prompt'])));}else{addLog('切换模型失败:\x20'+_0x5aa35a[_0x264dfb(0x11a,0x14a,0x175,0xe9)]+'\x20'+_0x5aa35a[_0x5e8316(0x422,0x341,0x38f,0x2fd)]);throw new Error(_0x5e8316(0x367,0x385,0x3d3,0x402)+_0x5aa35a[_0x5e8316(0x401,0x407,0x385,0x33a)]+'\x20'+_0x5aa35a[_0x264dfb(0x162,0x1ce,0x17f,0x11f)]);}}toastr[_0x5e8316(0x340,0x360,0x2d6,0x30d)](_0x264dfb(0xeb,0xf7,0xb1,0xb2)+_0x2b76f2[_0x5e8316(0x2da,0x2ca,0x2f0,0x2b9)+'8_model']+'成功');}}else{if(_0x26e3e7[_0x264dfb(0x201,0x1ff,0x1c0,0x170)]===_0x26e3e7['oOAgi']){let _0x4781e4=await getSDMode(_0x3f744b);_0x26e3e7[_0x5e8316(0x228,0x28c,0x2b7,0x2d0)](_0x4781e4,_0x2b76f2[_0x5e8316(0x29b,0x298,0x2f0,0x319)+_0x264dfb(0xca,0x117,0x15a,0xf9)])&&(addLog(_0x5e8316(0x33a,0x2d8,0x31b,0x392)+_0x2b76f2[_0x5e8316(0x26b,0x25f,0x2f0,0x28d)+_0x264dfb(0x1a3,0x13e,0x15a,0x19f)]+_0x264dfb(0x1fe,0x1aa,0x1a5,0x1de)),await _0x26e3e7[_0x264dfb(0xe5,0xe2,0x166,0x154)](setSDMode,_0x3f744b,_0x2b76f2[_0x5e8316(0x276,0x321,0x2f0,0x315)+_0x5e8316(0x341,0x347,0x36a,0x348)]));}else _0x58a01f[_0x264dfb(0xfe,0xb8,0xcb,0x5a)+_0x5e8316(0x2c3,0x313,0x352,0x361)]&&(_0x1c45b6[_0x5e8316(0x397,0x38f,0x301,0x269)+_0x264dfb(0xac,0xa6,0x13d,0x171)](_0x94c1ac[_0x5e8316(0x2d8,0x265,0x2cd,0x2da)+_0x5e8316(0x2e5,0x26d,0x2ff,0x31c)+'ST'],_0x507556),_0x3f6b22[_0x5e8316(0x366,0x315,0x2db,0x24b)+_0x5e8316(0x3b2,0x310,0x352,0x394)]=![],_0x26e3e7['Xkavh'](_0x3b4bbc,_0x26e3e7[_0x264dfb(0xff,0x104,0x15d,0x12e)]));}}}catch(_0x4b9d36){_0x26e3e7[_0x5e8316(0x31b,0x350,0x305,0x2e8)](addLog,_0x264dfb(0x1cf,0x1da,0x1a7,0x112)+':\x20'+_0x4b9d36[_0x5e8316(0x3b4,0x331,0x326,0x36b)]+(_0x264dfb(0x15c,0x173,0x1c4,0x258)+'i是否正常启动，并检'+_0x264dfb(0xb0,0x11d,0x11f,0x14f))),taskQueue[_0x5e8316(0x27c,0x28d,0x2fd,0x387)+'sk'](_0x4583f3,![]),currentTaskId=null;throw new Error(_0x5e8316(0x42e,0x3a5,0x3b7,0x424)+_0x264dfb(0x120,0x186,0x134,0x12c)+_0x5e8316(0x3c2,0x307,0x38a,0x3a4)+_0x264dfb(0x14a,0x185,0x11f,0x19d));}let _0x4bf022=-(-0xeeb+-0x2680+0x356c);const _0x1978fe=_0x2b76f2[_0x264dfb(0x14c,0x152,0x169,0x19c)];_0x1978fe!==''&&_0x26e3e7['aXVna'](_0x1978fe,null)&&!_0x26e3e7['Ymuho'](isNaN,_0x26e3e7[_0x5e8316(0x239,0x2ba,0x2cb,0x298)](Number,_0x1978fe))&&_0x26e3e7[_0x5e8316(0x43c,0x43a,0x3c3,0x3b1)](_0x26e3e7['Xkavh'](Number,_0x1978fe),0x1e8d+0x28*0x65+-0x1d*0x199)&&(_0x4bf022=_0x26e3e7[_0x5e8316(0x3b8,0x3d4,0x381,0x3f3)](Number,_0x1978fe));let _0xd4c13a={'prompt':_0x4b77d3,'negative_prompt':_0x126a15,'sampler_name':_0x2b76f2['sd_cchatu_'+'8_samplerN'+_0x5e8316(0x391,0x272,0x30a,0x307)],'scheduler':_0x2b76f2[_0x5e8316(0x28a,0x35a,0x2f0,0x340)+_0x264dfb(0x19a,0xbf,0x11d,0xd2)+'r'],'steps':_0x2b76f2[_0x5e8316(0x310,0x2f8,0x2f7,0x347)],'cfg_scale':_0x2b76f2[_0x5e8316(0x300,0x2c1,0x348,0x2cb)],'width':_0xd1e28d?_0xd1e28d:_0x2b76f2[_0x5e8316(0x3b2,0x328,0x372,0x342)],'height':_0x318158?_0x318158:_0x2b76f2[_0x5e8316(0x316,0x345,0x3a6,0x3dc)],'restore_faces':_0x2b76f2['restoreFac'+'es']==_0x264dfb(0x110,0x1e6,0x19b,0x1d9),'enable_hr':_0x26e3e7[_0x264dfb(0x167,0x167,0xcf,0x14c)](_0x2b76f2[_0x264dfb(0x149,0x74,0x10c,0x104)+_0x5e8316(0x2ff,0x26b,0x2f1,0x317)],_0x26e3e7[_0x264dfb(0xaf,0xb1,0x101,0xc6)]),'hr_upscaler':_0x2b76f2[_0x5e8316(0x2bf,0x327,0x2f0,0x31a)+_0x5e8316(0x373,0x2ca,0x2f2,0x32a)],'hr_scale':_0x2b76f2[_0x264dfb(0x162,0x6d,0xd3,0x12d)+_0x5e8316(0x386,0x3c4,0x34a,0x2d3)],'hr_additional_modules':[],'denoising_strength':_0x2b76f2[_0x264dfb(0xf1,0xc1,0x115,0x91)+'ing_streng'+'th'],'hr_second_pass_steps':_0x2b76f2[_0x5e8316(0x2dc,0x31a,0x31c,0x2d6)+_0x5e8316(0x380,0x2e0,0x332,0x3b0)],'seed':_0x4bf022,'override_settings':{'CLIP_stop_at_last_layers':Number(_0x2b76f2[_0x264dfb(0xf0,0x9b,0xdb,0x105)+'kip']),'sd_vae':_0x2b76f2['sd_cchatu_'+'8_vae']},'override_settings_restore_afterwards':!![],'save_images':!![],'send_images':!![],'do_not_save_grid':![],'do_not_save_samples':![]};_0x26e3e7['rGuGH'](addLog,'restore_fa'+_0x264dfb(0x125,0x1f2,0x1ac,0x1c3)+_0xd4c13a[_0x5e8316(0x2d1,0x2e5,0x351,0x3c7)+_0x264dfb(0x1db,0x165,0x18a,0x185)]),_0x26e3e7[_0x264dfb(0x121,0xe0,0x135,0xe9)](addLog,_0x5e8316(0x2e1,0x2fc,0x317,0x2ba)+_0x5e8316(0x2f4,0x36b,0x361,0x3bf)+_0xd4c13a[_0x5e8316(0x413,0x301,0x397,0x35e)]);_0x26e3e7[_0x5e8316(0x2c7,0x33a,0x32a,0x2be)](_0x2b76f2[_0x264dfb(0x148,0xd9,0x102,0x17c)+_0x264dfb(0x1db,0x1f3,0x16a,0x1f1)],_0x26e3e7[_0x264dfb(0x123,0xd2,0x101,0xd6)])&&(addLog(_0x26e3e7[_0x264dfb(0xe0,0x4f,0xbf,0x14a)]),_0xd4c13a=_0x26e3e7['syjEn'](deepMerge,_0xd4c13a,{'alwayson_scripts':{'ADetailer':{'args':[!![],!![],{'ad_model':_0x26e3e7[_0x5e8316(0x412,0x41e,0x3d9,0x3c2)]}]}}}));const _0x14ac85='\x0a---\x0a###\x20生'+_0x264dfb(0x101,0x8c,0x119,0x168)+'正面提示\x20(Prom'+'pt):**\x20'+_0x4b77d3+('\x0a-\x20**负面提示\x20'+_0x5e8316(0x29c,0x241,0x2be,0x29c)+_0x5e8316(0x344,0x29c,0x308,0x32a)+'\x20')+_0x126a15+('\x0a-\x20**采样方法\x20'+_0x5e8316(0x356,0x2bf,0x315,0x32c)+_0x264dfb(0x170,0x17f,0x136,0xc0))+_0xd4c13a['sampler_na'+'me']+('\x0a-\x20**步数\x20(S'+_0x264dfb(0x74,0x17d,0xfb,0x151))+_0xd4c13a[_0x264dfb(0x93,0x178,0x122,0xef)]+(_0x5e8316(0x32c,0x3d8,0x3bb,0x3c8)+_0x264dfb(0x197,0xaa,0x117,0x147))+_0xd4c13a[_0x264dfb(0x185,0x193,0x13b,0x1be)]+('\x0a-\x20**尺寸\x20(S'+_0x5e8316(0x346,0x342,0x2c3,0x269))+_0xd4c13a['width']+'x'+_0xd4c13a[_0x5e8316(0x347,0x2fe,0x2c2,0x2c9)]+(_0x5e8316(0x34e,0x2e1,0x323,0x2d6)+_0x264dfb(0xab,0xab,0xc0,0x87))+(_0x26e3e7[_0x5e8316(0x3ed,0x3a6,0x359,0x308)](_0xd4c13a[_0x5e8316(0x30b,0x38b,0x31d,0x37f)],-(0x1d4e+0x5*0x33b+0x1*-0x2d74))?_0x26e3e7[_0x264dfb(0x22b,0x20d,0x1c2,0x173)]:_0xd4c13a['seed'])+(_0x264dfb(0x215,0x12f,0x19f,0x19c)+_0x5e8316(0x3e0,0x32d,0x3b0,0x35d))+_0x2b76f2[_0x5e8316(0x36c,0x2e8,0x2f0,0x2fa)+_0x264dfb(0x163,0x115,0x15a,0x1ca)]+('\x0a-\x20**VAE:*'+'*\x20')+_0xd4c13a['override_s'+_0x5e8316(0x381,0x371,0x31a,0x32d)][_0x5e8316(0x2d7,0x2ab,0x2d9,0x2e6)]+(_0x5e8316(0x35a,0x339,0x2ea,0x2a3)+_0x5e8316(0x456,0x343,0x3cc,0x3ea))+_0xd4c13a[_0x264dfb(0x208,0x162,0x1b1,0x19e)+_0x264dfb(0x169,0x8a,0x10a,0x7d)][_0x5e8316(0x34b,0x3f5,0x364,0x3e0)+_0x5e8316(0x409,0x461,0x3e4,0x414)+_0x264dfb(0x187,0x22a,0x1a2,0x1c6)]+(_0x264dfb(0x1f5,0x15d,0x16b,0x12b)+'(Hires\x20Fix'+_0x264dfb(0xca,0xf7,0x10f,0xa5))+_0xd4c13a['enable_hr']+(_0x264dfb(0x71,0x15f,0xfd,0xf8)+'(Upscale\x20F'+_0x264dfb(0x5a,0xf6,0xb4,0xdb))+_0xd4c13a['hr_scale']+('\x0a-\x20**重绘幅度\x20'+_0x5e8316(0x3d4,0x30f,0x374,0x3e7)+_0x264dfb(0x137,0x18a,0x14e,0x154)+_0x5e8316(0x3f8,0x3d5,0x3c6,0x357))+_0xd4c13a[_0x264dfb(0xc4,0xd3,0xf9,0x156)+_0x5e8316(0x3b7,0x42f,0x3be,0x354)]+(_0x264dfb(0x15f,0x1e1,0x153,0x1e1)+_0x264dfb(0x58,0xda,0xc4,0x116)+'aces):**\x20')+_0xd4c13a[_0x5e8316(0x342,0x3c6,0x351,0x3db)+'ces']+(_0x264dfb(0x181,0x1e0,0x19d,0x1c2)+'iler:**\x20')+_0x26e3e7['tleNT'](_0x2b76f2[_0x264dfb(0x16d,0x13d,0x102,0xce)+_0x264dfb(0x16b,0x187,0x16a,0x1a2)],_0x26e3e7[_0x264dfb(0xac,0x10f,0x101,0xf7)])+_0x264dfb(0xf7,0x72,0xd9,0x136);_0x26e3e7[_0x5e8316(0x2fd,0x3ba,0x32b,0x2c5)](addLog,_0x14ac85),_0x26e3e7[_0x5e8316(0x363,0x3dc,0x381,0x2ee)](addLog,'sdwebui生图参'+'数为'+JSON[_0x5e8316(0x3c5,0x32d,0x368,0x31e)](_0xd4c13a)),console[_0x5e8316(0x3fb,0x391,0x3b6,0x37a)](_0x5e8316(0x3d9,0x347,0x39d,0x411),_0xd4c13a);let _0x12b6be=!![];while(_0x12b6be){window['xiancheng']?_0x12b6be=![]:await _0x26e3e7[_0x264dfb(0x1da,0x13a,0x181,0x1f6)](sleep,-0x23c5+-0x1dca+-0x1*-0x4577);};try{window[_0x264dfb(0x1ba,0x172,0x147,0xd2)]=!![],taskQueue['updateStat'+'us'](_0x4583f3,'running');if(_0x26e3e7[_0x264dfb(0x1a8,0x108,0x149,0x1b0)](_0x2b76f2[_0x5e8316(0x41f,0x419,0x387,0x3aa)],_0x5e8316(0x3a9,0x3dc,0x3e3,0x472))){if(_0x26e3e7['aXVna'](_0x26e3e7[_0x5e8316(0x3f9,0x3b7,0x398,0x3ee)],_0x26e3e7[_0x264dfb(0x1d7,0x147,0x188,0x18c)]))!_0x121480[_0x5e8316(0x243,0x31d,0x2db,0x349)+_0x5e8316(0x384,0x30d,0x352,0x365)]&&(_0x584861['initialize'+_0x5e8316(0x319,0x3be,0x352,0x397)]=!![],_0x26e3e7[_0x264dfb(0x194,0x202,0x197,0x115)](_0x285a9d)),_0x26e3e7[_0x5e8316(0x38c,0x396,0x3bf,0x41c)](_0x52188e);else{if(!taskQueue[_0x264dfb(0x151,0x127,0xec,0xfc)+'eue'](_0x4583f3)){_0x26e3e7[_0x5e8316(0x277,0x339,0x2e0,0x28d)](addLog,_0x264dfb(0x115,0x9c,0xd5,0x165)),eventSource[_0x264dfb(0xf7,0xac,0xd6,0xef)](_0x26e3e7[_0x5e8316(0x33f,0x3f0,0x360,0x2cc)]);throw new Error(_0x26e3e7[_0x5e8316(0x41a,0x3fe,0x3ac,0x320)]);}_0xd4c13a[_0x264dfb(0x73,0x130,0x103,0x8f)]=_0x3f744b,console[_0x5e8316(0x37b,0x36c,0x3b6,0x439)](_0x26e3e7[_0x264dfb(0x7c,0x6f,0xf2,0x64)],_0x2b76f2[_0x264dfb(0x1d4,0x1a8,0x1b7,0x221)+'sd_auth']),_0xd4c13a[_0x5e8316(0x32b,0x351,0x321,0x2bf)]=_0x2b76f2[_0x5e8316(0x3ca,0x372,0x3c7,0x346)+_0x264dfb(0xb6,0x108,0xc1,0xf5)]?_0x2b76f2[_0x264dfb(0x152,0x18b,0x1b7,0x125)+_0x5e8316(0x2f2,0x2d4,0x2d1,0x27e)]:'';const _0x1460f9=await _0x26e3e7[_0x264dfb(0xb9,0x76,0xcd,0xc3)](fetch,_0x26e3e7[_0x5e8316(0x377,0x31c,0x340,0x369)],{'method':_0x26e3e7[_0x5e8316(0x351,0x24e,0x2c5,0x30f)],'headers':_0x26e3e7['TIKsz'](getRequestHeaders,window['token']),'body':JSON[_0x5e8316(0x3f0,0x3a1,0x368,0x319)](_0xd4c13a)});if(!_0x1460f9['ok']){const _0x4da29d=await _0x1460f9[_0x5e8316(0x381,0x317,0x3ae,0x42f)]();_0x26e3e7['SRIRb'](addLog,_0x264dfb(0x99,0x1d,0xaf,0xf6)+_0x264dfb(0x130,0x12d,0x152,0x1d0)+_0x1460f9['status']+_0x5e8316(0x2ff,0x298,0x30f,0x30a)+_0x4da29d),console[_0x264dfb(0x194,0x1e2,0x1a6,0x1c9)](_0x26e3e7[_0x264dfb(0x246,0x255,0x1cf,0x1b2)],_0x4da29d);throw new Error(_0x5e8316(0x352,0x3e8,0x396,0x330)+_0x1460f9[_0x5e8316(0x308,0x3c9,0x385,0x352)]+',\x20详情:\x20'+_0x4da29d);}const _0x5ccbf4=await _0x1460f9[_0x5e8316(0x32d,0x3e7,0x3ae,0x377)]();let _0xfc7cd7='';try{const _0x1b9585=JSON[_0x5e8316(0x314,0x31e,0x300,0x34f)](_0x5ccbf4);_0xfc7cd7=_0x1b9585[_0x264dfb(0xd2,0xee,0x12b,0xaf)][-0x893*0x1+-0x3*-0xa76+-0x16cf];}catch(_0x3e02a2){if(_0x26e3e7[_0x264dfb(0xf1,0x134,0x180,0x103)](_0x26e3e7['AWpzv'],_0x264dfb(0xfa,0xed,0x163,0x1a2)))addLog(_0x26e3e7[_0x5e8316(0x412,0x3fd,0x3dc,0x3c1)]),_0xfc7cd7=_0x5ccbf4;else{const _0x35c2b3=_0x26e3e7[_0x264dfb(0x20d,0x1c6,0x17c,0x1b8)]['split']('|');let _0x4f6106=-0x148b+0x1*0x1d5+-0x2*-0x95b;while(!![]){switch(_0x35c2b3[_0x4f6106++]){case'0':_0x953d1d['error'](_0x264dfb(0x216,0x166,0x1ca,0x24a)+_0x5e8316(0x32f,0x2d6,0x2f9,0x356)+_0x264dfb(0x60,0x129,0xc7,0x105),_0x4153f5);continue;case'1':_0x49fcf0[_0x264dfb(0x144,0x12d,0x147,0x138)]=!![];continue;case'2':_0x452bed=null;continue;case'3':throw _0x364f75;continue;case'4':if(_0x26e3e7[_0x5e8316(0x323,0x37e,0x3a2,0x437)](_0x31ad5c[_0x264dfb(0x109,0xad,0x116,0x15a)],_0x5e8316(0x335,0x35d,0x316,0x35b))){}else _0x3a0d85[_0x5e8316(0x34f,0x33d,0x2fd,0x383)+'sk'](_0x1f16f7,![]);continue;case'5':_0x2f96e7(_0x264dfb(0x10b,0x127,0x193,0x188)+_0xce97ef[_0x5e8316(0x3a0,0x30d,0x326,0x332)]);continue;}break;}}}const _0x284726=_0x26e3e7[_0x264dfb(0x194,0x103,0x155,0x197)](_0x26e3e7[_0x264dfb(0x10f,0x1bd,0x17e,0x14a)],_0xfc7cd7);_0x26e3e7['QtgEY'](addLog,_0x5e8316(0x30c,0x2ad,0x2cc,0x30a)+'化为\x20data\x20UR'+'L。'),taskQueue[_0x5e8316(0x347,0x2c5,0x2fd,0x367)+'sk'](_0x4583f3,!![]),currentTaskId=null;const _0x355999={};return _0x355999['image']=_0x284726,_0x355999[_0x5e8316(0x3fa,0x38f,0x3cd,0x33d)]=_0x1cb6a8||'',_0x355999;}}else{if(!taskQueue[_0x5e8316(0x269,0x2fc,0x2fc,0x309)+'eue'](_0x4583f3)){_0x26e3e7[_0x264dfb(0x1c2,0x149,0x1a9,0x124)](addLog,_0x26e3e7[_0x5e8316(0x3a4,0x3e2,0x34f,0x3b8)]);throw new Error(_0x26e3e7['nTpPN']);}const _0x383018=new URL(_0x26e3e7[_0x264dfb(0xdd,0x16b,0x155,0x198)](_0x3f744b,_0x5e8316(0x2e0,0x35e,0x2ed,0x36d)+'txt2img'));window[_0x5e8316(0x3b6,0x311,0x357,0x312)]=![];const _0x2d4fc6=await _0x26e3e7[_0x5e8316(0x2b7,0x27d,0x2dd,0x2ca)](fetch,_0x383018,{'method':_0x26e3e7[_0x5e8316(0x243,0x34e,0x2c5,0x272)],'body':JSON[_0x5e8316(0x2e1,0x30b,0x368,0x3c6)](_0xd4c13a),'headers':{'Content-Type':_0x5e8316(0x36b,0x2dd,0x2de,0x339)+'n/json','Authorization':_0x26e3e7[_0x5e8316(0x33e,0x363,0x389,0x301)](getsdAuth)}});window['xiancheng']=!![];if(!_0x2d4fc6['ok']){const _0x14a281=await _0x2d4fc6[_0x264dfb(0x21f,0x22d,0x19e,0x116)]();_0x26e3e7[_0x5e8316(0x342,0x31b,0x32b,0x39d)](addLog,'SD\x20API\x20返回错'+_0x264dfb(0xff,0x131,0x18e,0x1f1)+_0x2d4fc6[_0x5e8316(0x2fe,0x304,0x385,0x405)]+_0x5e8316(0x328,0x367,0x30f,0x2ca)+_0x14a281),console[_0x5e8316(0x3c1,0x444,0x3b6,0x414)](_0x26e3e7['iRamG'],_0x14a281);throw new Error(_0x264dfb(0x146,0x116,0x186,0x208)+_0x2d4fc6[_0x264dfb(0x179,0x180,0x175,0x193)]+',\x20详情:\x20'+_0x14a281);}const _0x10fb06=await _0x2d4fc6['json']();if(!_0x10fb06[_0x264dfb(0x9c,0x1b7,0x12b,0x15a)]||_0x10fb06[_0x5e8316(0x2d2,0x2b7,0x33b,0x34e)][_0x5e8316(0x351,0x356,0x3d7,0x401)]===-0x1*0xca4+0x42c*-0x1+-0x10d*-0x10)throw new Error(_0x26e3e7['qPDPR']);const _0x37262f=_0x10fb06[_0x264dfb(0x158,0xa8,0x12b,0x16a)][0x14ac+0x12*-0xf3+-0x22*0x1b],_0x1dfd2a=_0x26e3e7['wwlIi'](_0x26e3e7[_0x264dfb(0x20c,0x1a9,0x17e,0x1c1)],_0x37262f);return _0x26e3e7[_0x264dfb(0x145,0x56,0xca,0xc5)](addLog,_0x26e3e7['uMdDN']),taskQueue[_0x5e8316(0x28c,0x340,0x2fd,0x2ae)+'sk'](_0x4583f3,!![]),currentTaskId=null,{'image':_0x1dfd2a,'change':_0x26e3e7[_0x5e8316(0x3a5,0x28d,0x322,0x358)](_0x3dbabb,'')};}}catch(_0x378ed7){const _0xf9fcf8=_0x26e3e7[_0x5e8316(0x3d3,0x343,0x37f,0x3df)][_0x264dfb(0x138,0x136,0x127,0x17c)]('|');let _0x1dbe27=0x1*0x1e15+0x1*0x347+-0x215c;while(!![]){switch(_0xf9fcf8[_0x1dbe27++]){case'0':currentTaskId=null;continue;case'1':if(_0x26e3e7['fVIIA'](_0x378ed7[_0x5e8316(0x2e7,0x2b2,0x326,0x379)],_0x26e3e7[_0x264dfb(0x13b,0x109,0x19c,0x12b)])){}else taskQueue[_0x5e8316(0x275,0x286,0x2fd,0x359)+'sk'](_0x4583f3,![]);continue;case'2':throw _0x378ed7;continue;case'3':_0x26e3e7['Xkavh'](addLog,_0x264dfb(0x188,0x214,0x193,0x15c)+_0x378ed7[_0x5e8316(0x39a,0x314,0x326,0x2ef)]);continue;case'4':window[_0x264dfb(0x164,0x1a0,0x147,0xc5)]=!![];continue;case'5':console[_0x264dfb(0x1b2,0x189,0x1a1,0x17f)](_0x26e3e7[_0x5e8316(0x2ce,0x302,0x2e7,0x261)],_0x378ed7);continue;}break;}}}async function sdGenerate(_0x165427){function _0x274314(_0x220272,_0x29e075,_0x40bee7,_0x179e66){return _0x3026(_0x40bee7- -0x3c9,_0x29e075);}const _0x3e30c3={'eUFJD':function(_0x5aa02a,_0xd3f201){return _0x5aa02a(_0xd3f201);},'nntuj':function(_0x42f049,_0x247cbe){return _0x42f049+_0x247cbe;},'ezMYg':_0x37a6a1(0x40b,0x3ac,0x355,0x429),'WbuLv':function(_0x31cc5f,_0x1449d1){return _0x31cc5f===_0x1449d1;},'HRJxw':_0x37a6a1(0x3b8,0x326,0x29e,0x398),'ssuNd':_0x274314(-0x27e,-0x1d0,-0x1ef,-0x17e),'kzcZZ':function(_0x5ed0d3,_0x142a80){return _0x5ed0d3(_0x142a80);},'AVXKW':function(_0x4b5786,_0x3ec25e){return _0x4b5786!==_0x3ec25e;},'KPLCB':_0x274314(-0x25f,-0x204,-0x23b,-0x20d),'FLFRr':function(_0x8b3280,_0x20d472){return _0x8b3280!=_0x20d472;},'hHODg':function(_0x45d598,_0x3ffde3,_0x2fb5b5,_0x330a14){return _0x45d598(_0x3ffde3,_0x2fb5b5,_0x330a14);},'sxINc':function(_0xf7cd16,_0x5ae18d){return _0xf7cd16(_0x5ae18d);}};function _0x37a6a1(_0x4edeba,_0x2dc362,_0x43c7e0,_0x1bfa01){return _0x3026(_0x2dc362-0x246,_0x4edeba);}const {id:_0x55beab,prompt:_0x1f318f,width:_0x227846,height:_0x2efc06,change:_0x2bd8cd}=_0x165427;_0x3e30c3[_0x274314(-0x308,-0x372,-0x308,-0x2db)](addLog,'收到SD生图请求\x20('+_0x37a6a1(0x2cc,0x332,0x33f,0x37a)+_0x55beab+(')\x20-\x20Prompt'+':\x20')+_0x1f318f+(_0x2bd8cd?'\x20-\x20Change:'+'\x20'+_0x2bd8cd:''));if(_0x2bd8cd&&_0x2bd8cd['includes'](_0x3e30c3[_0x274314(-0x232,-0x16d,-0x1dd,-0x14b)])){if(_0x3e30c3[_0x37a6a1(0x361,0x3f9,0x483,0x3db)](_0x3e30c3[_0x274314(-0x316,-0x206,-0x27f,-0x2d2)],_0x3e30c3[_0x274314(-0x282,-0x276,-0x288,-0x2fc)])){_0x3e30c3[_0x274314(-0x300,-0x387,-0x308,-0x356)](_0x52b8c2,_0x37a6a1(0x451,0x419,0x440,0x433)+_0x9d816a[_0x37a6a1(0x3dc,0x3d6,0x3e6,0x3d8)]+'\x20'+_0x1f938b[_0x274314(-0x23b,-0x1e2,-0x22f,-0x213)]);throw new _0x4152cb('获取模型失败:\x20'+_0xcf1ee[_0x37a6a1(0x44d,0x3d6,0x3c4,0x468)]+'\x20'+_0x46668d[_0x37a6a1(0x3ce,0x3e0,0x3b0,0x433)]);}else{_0x3e30c3[_0x37a6a1(0x38a,0x385,0x3b5,0x393)](bananaGenerate,_0x165427);return;}}try{if(_0x3e30c3[_0x274314(-0x21c,-0x26c,-0x280,-0x2d9)]('AHhDk',_0x3e30c3['KPLCB']))_0x92b0c7[_0x37a6a1(0x2ce,0x35d,0x35c,0x353)+_0x4cea50+_0x274314(-0x201,-0x2cd,-0x262,-0x2eb)]&&(_0x1645b2=_0x3e30c3[_0x274314(-0x379,-0x29e,-0x2e2,-0x2c9)](_0x452baa,',\x20')+_0x3e30c3[_0x37a6a1(0x2c2,0x307,0x372,0x32b)](_0x4850bf,_0x3ea1fc[_0x274314(-0x2ea,-0x296,-0x2b2,-0x331)+_0xd61d98+'\x20Prompt']));else{const {image:_0x3826e5,change:_0x267c87}=await generateSDImage({'prompt':_0x1f318f,'width':_0x227846,'height':_0x2efc06,'change':_0x2bd8cd});if(_0x3e30c3[_0x274314(-0x1d6,-0x1af,-0x1fe,-0x23a)](extension_settings[extensionName]['cache'],'0')){const _0x4c5890={};_0x4c5890[_0x274314(-0x214,-0x1bd,-0x1f1,-0x1f2)]=_0x267c87,await _0x3e30c3['hHODg'](setItemImg,_0x1f318f,_0x3826e5,_0x4c5890),_0x3e30c3['eUFJD'](addLog,_0x274314(-0x2f2,-0x2f3,-0x277,-0x2a7)+_0x37a6a1(0x3d2,0x389,0x408,0x375)+'\x20'+_0x1f318f);}else addLog('缓存设置为不存入数据'+'库');const _0x40e19b={};_0x40e19b['id']=_0x55beab,_0x40e19b[_0x37a6a1(0x35d,0x37f,0x306,0x2e7)]=!![],_0x40e19b[_0x274314(-0x29e,-0x287,-0x2f4,-0x275)]=_0x3826e5,_0x40e19b[_0x37a6a1(0x349,0x355,0x31c,0x347)]=_0x1f318f,_0x40e19b['change']=_0x267c87,eventSource[_0x274314(-0x359,-0x2e6,-0x2d8,-0x2b0)](EventType[_0x274314(-0x2a3,-0x2a6,-0x2f1,-0x2d0)+_0x37a6a1(0x423,0x3fa,0x39d,0x476)+'NSE'],_0x40e19b),_0x3e30c3['kzcZZ'](addLog,_0x274314(-0x204,-0x19a,-0x1f9,-0x235)+'\x20(ID:\x20'+_0x55beab+')');}}catch(_0x355d66){const _0x18fc8c=_0x274314(-0x24f,-0x21e,-0x204,-0x289)+_0x274314(-0x271,-0x2db,-0x25f,-0x1d1)+_0x55beab+_0x37a6a1(0x303,0x33d,0x30c,0x300)+_0x355d66[_0x37a6a1(0x3d7,0x377,0x370,0x305)];_0x3e30c3[_0x274314(-0x2be,-0x1d2,-0x24d,-0x2ce)](addLog,'错误:\x20'+_0x18fc8c),console[_0x37a6a1(0x3b8,0x402,0x402,0x417)](_0x274314(-0x219,-0x174,-0x1e4,-0x1f5)+_0x274314(-0x357,-0x285,-0x2c3,-0x2d5)+_0x37a6a1(0x392,0x3a7,0x357,0x39a),_0x355d66);const _0x4e8bde={};_0x4e8bde['id']=_0x55beab,_0x4e8bde[_0x37a6a1(0x3c0,0x37f,0x3dd,0x338)]=![],_0x4e8bde['error']=_0x355d66[_0x274314(-0x25c,-0x2d5,-0x298,-0x2d0)],_0x4e8bde[_0x37a6a1(0x35e,0x355,0x3a3,0x2ce)]=_0x1f318f,eventSource['emit'](EventType[_0x37a6a1(0x3a6,0x31e,0x342,0x34c)+'MAGE_RESPO'+_0x37a6a1(0x3ec,0x41f,0x3a1,0x3d2)],_0x4e8bde),_0x3e30c3[_0x37a6a1(0x36d,0x307,0x2c9,0x2f6)](addLog,_0x37a6a1(0x3a5,0x344,0x334,0x2e6)+_0x274314(-0x2b6,-0x2d5,-0x257,-0x2bc)+_0x55beab+')');}}function initializeSDListener(){function _0x5f0752(_0x2b3962,_0x46c623,_0x3a34e7,_0x292819){return _0x3026(_0x292819- -0x19,_0x3a34e7);}function _0x3a23f7(_0xc67116,_0x330a59,_0x64bad7,_0x5a7524){return _0x3026(_0x330a59-0x221,_0xc67116);}eventSource['on'](EventType[_0x5f0752(0x41,0x107,0xce,0xbf)+_0x5f0752(0x83,0xde,0xb9,0xf1)+'ST'],sdGenerate),addLog(_0x5f0752(0xd8,0x17e,0xdd,0x142)+'已初始化。');}export async function replaceWithSd(){function _0x2ff9a0(_0x36d496,_0x523295,_0x3b695d,_0x5dd681){return _0x3026(_0x5dd681-0x8e,_0x36d496);}function _0x15e88b(_0x3586ba,_0x66e844,_0x58ffe1,_0xfa86f){return _0x3026(_0xfa86f- -0x33e,_0x66e844);}const _0x56f057={'TRdEg':function(_0x3a0757,_0x50660c){return _0x3a0757+_0x50660c;},'KGjmh':_0x2ff9a0(0x163,0x165,0x22d,0x1f1),'LoNAb':function(_0x162244){return _0x162244();},'WQvOJ':_0x15e88b(-0x25d,-0x252,-0x1c4,-0x1e3)+_0x2ff9a0(0x29d,0x28f,0x20c,0x243)};extension_settings[extensionName][_0x15e88b(-0x242,-0x1a7,-0x1eb,-0x239)]=='sd'?(!window[_0x15e88b(-0x299,-0x272,-0x2ef,-0x258)+_0x15e88b(-0x1d5,-0x1f7,-0x18d,-0x1e1)]&&(_0x56f057[_0x2ff9a0(0x17a,0x22a,0x227,0x1f3)]!==_0x2ff9a0(0x195,0x19a,0x17d,0x1f1)?_0x17a17a['Character\x20'+_0x1dad83+'\x20Prompt']&&(_0x4aeec7=_0x56f057[_0x15e88b(-0x20f,-0x153,-0x126,-0x1a8)](_0x56f057[_0x15e88b(-0x1a7,-0x202,-0x22d,-0x1a8)](_0x479f0a,',\x20'),_0xb33ead[_0x2ff9a0(0x116,0x18a,0x1d6,0x1a5)+_0x6ef9a6+_0x15e88b(-0x231,-0x184,-0x1c9,-0x1d7)])):(window[_0x2ff9a0(0xfb,0x1b0,0x1f0,0x174)+'SDListener']=!![],initializeSDListener())),_0x56f057[_0x15e88b(-0x1d5,-0x1a1,-0x1dd,-0x225)](initializeImageProcessing)):window[_0x2ff9a0(0x135,0xed,0x156,0x174)+_0x2ff9a0(0x267,0x239,0x193,0x1eb)]&&(eventSource[_0x2ff9a0(0x1b2,0x177,0x162,0x19a)+_0x15e88b(-0x1cf,-0x230,-0x1c3,-0x1e6)](EventType['GENERATE_I'+_0x15e88b(-0x26f,-0x1ea,-0x27a,-0x234)+'ST'],sdGenerate),window['initialize'+'SDListener']=![],addLog(_0x56f057['WQvOJ']));}