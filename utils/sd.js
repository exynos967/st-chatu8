(function(_0x4d521c,_0x5b6896){const _0x1a2f3d=_0x4d521c();function _0x41db22(_0xe0b557,_0x5ae626,_0x3d5ee8,_0x4ce567){return _0x139e(_0x4ce567-0x312,_0x3d5ee8);}function _0x1dc586(_0x5dcd48,_0x786bab,_0x4c8fb6,_0x556711){return _0x139e(_0x5dcd48-0x3a4,_0x4c8fb6);}while(!![]){try{const _0x515dfc=-parseInt(_0x41db22(0x415,0x4f6,0x4c5,0x4b8))/(-0x2281+-0x5df+0x2861)+parseInt(_0x1dc586(0x552,0x584,0x563,0x4bf))/(0x509+-0x1*-0xbcb+-0x10d2)*(parseInt(_0x41db22(0x469,0x52d,0x509,0x4a9))/(0x1153+-0x9c8+-0x788))+parseInt(_0x41db22(0x491,0x50a,0x506,0x4e6))/(0x1fde+0x2458+-0x4432)*(-parseInt(_0x1dc586(0x4e0,0x465,0x476,0x4a4))/(0xe95*0x1+0x25b3*-0x1+-0x1*-0x1723))+-parseInt(_0x41db22(0x4ee,0x4b9,0x3b7,0x45d))/(0xca2+-0x1bab+0x3*0x505)+-parseInt(_0x41db22(0x4fc,0x46a,0x424,0x458))/(-0xdfc+-0x1*-0x196+0x1*0xc6d)+parseInt(_0x41db22(0x50c,0x465,0x548,0x4a3))/(0x1ca5+0x65b+-0x22f8)*(-parseInt(_0x41db22(0x53e,0x457,0x479,0x4e0))/(-0x3e*-0x7d+0x65*-0x47+-0x23a))+parseInt(_0x41db22(0x420,0x375,0x3f0,0x3d1))/(-0x97b+0x17a1*0x1+-0xe1c);if(_0x515dfc===_0x5b6896)break;else _0x1a2f3d['push'](_0x1a2f3d['shift']());}catch(_0x59fc54){_0x1a2f3d['push'](_0x1a2f3d['shift']());}}}(_0xcc95,0x6a94d+-0xc41*-0xbf+-0x966a1));function _0x139e(_0x5e6cea,_0x1a4959){_0x5e6cea=_0x5e6cea-(0x14a8+-0x50e+-0xedd);const _0x158f4b=_0xcc95();let _0x417984=_0x158f4b[_0x5e6cea];if(_0x139e['SHlwNk']===undefined){var _0x356731=function(_0x56f424){const _0x4ef272='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x42645d='',_0x338e5f='',_0x1fd7a7=_0x42645d+_0x356731;for(let _0x40d9f7=-0x1*0x1c99+0x7*-0x349+0x3398,_0x13b9a2,_0x5eb5d1,_0x42835c=0x204f+0x9fc+-0x2a4b;_0x5eb5d1=_0x56f424['charAt'](_0x42835c++);~_0x5eb5d1&&(_0x13b9a2=_0x40d9f7%(0x4*0x5e7+0x14d3+-0x2c6b)?_0x13b9a2*(-0x12a+-0x125d+-0x3d*-0x53)+_0x5eb5d1:_0x5eb5d1,_0x40d9f7++%(-0xc5*-0x22+0x2*-0xb6c+0x2*-0x1a7))?_0x42645d+=_0x1fd7a7['charCodeAt'](_0x42835c+(-0x3be+0xea2+0xada*-0x1))-(-0x47+-0x125*0x21+-0x1*-0x2616)!==-0x2f0*-0x2+-0x39*0x31+0x509?String['fromCharCode'](-0x1a91+-0x230f+0x2b9*0x17&_0x13b9a2>>(-(0x22f1+0xddd+-0x30cc)*_0x40d9f7&-0x23c4+-0x2fb*-0x1+0x20cf)):_0x40d9f7:0xe4e+-0x6b*0x53+0x1463){_0x5eb5d1=_0x4ef272['indexOf'](_0x5eb5d1);}for(let _0xa592ff=-0x1ef7+-0x13fd+0x32f4,_0x10889e=_0x42645d['length'];_0xa592ff<_0x10889e;_0xa592ff++){_0x338e5f+='%'+('00'+_0x42645d['charCodeAt'](_0xa592ff)['toString'](0x3*0xcdf+-0x655*0x3+-0x138e))['slice'](-(-0x21ca+-0x11f9+0x1*0x33c5));}return decodeURIComponent(_0x338e5f);};_0x139e['zkxPqY']=_0x356731,_0x139e['iTRlGm']={},_0x139e['SHlwNk']=!![];}const _0x2f1689=_0x158f4b[0x5c9*0x6+0x1729+0x39df*-0x1],_0x77faf9=_0x5e6cea+_0x2f1689,_0x53ea57=_0x139e['iTRlGm'][_0x77faf9];if(!_0x53ea57){const _0x112ff3=function(_0x3670d5){this['EhXERx']=_0x3670d5,this['ZeaShx']=[-0xa86+0x97*-0x3+-0x2*-0x626,-0x2*-0x5d1+0x2695+0x3*-0x10bd,-0x96*-0x1+0x2ed*0x9+-0x1aeb],this['zxxDFX']=function(){return'newState';},this['xayjJK']='\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*',this['TXgIcw']='[\x27|\x22].+[\x27|\x22];?\x20*}';};_0x112ff3['prototype']['VMsJKr']=function(){const _0x1f2d95=new RegExp(this['xayjJK']+this['TXgIcw']),_0x3e25d9=_0x1f2d95['test'](this['zxxDFX']['toString']())?--this['ZeaShx'][-0x889+-0x173d+-0x1fc7*-0x1]:--this['ZeaShx'][0x25a6+0xe2*0x20+-0x41e6];return this['kIJZrV'](_0x3e25d9);},_0x112ff3['prototype']['kIJZrV']=function(_0x462ec1){if(!Boolean(~_0x462ec1))return _0x462ec1;return this['gDgSGG'](this['EhXERx']);},_0x112ff3['prototype']['gDgSGG']=function(_0x439917){for(let _0x2dc073=0x25eb+0x752*-0x2+0x65*-0x3b,_0x4dd9ef=this['ZeaShx']['length'];_0x2dc073<_0x4dd9ef;_0x2dc073++){this['ZeaShx']['push'](Math['round'](Math['random']())),_0x4dd9ef=this['ZeaShx']['length'];}return _0x439917(this['ZeaShx'][-0x6*-0x11f+-0x111d*0x1+0xa63]);},new _0x112ff3(_0x139e)['VMsJKr'](),_0x417984=_0x139e['zkxPqY'](_0x417984),_0x139e['iTRlGm'][_0x77faf9]=_0x417984;}else _0x417984=_0x53ea57;return _0x417984;}const _0x2cef51=(function(){const _0x312682={};_0x312682[_0x1e3bfb(0xd,0x32,-0x4e,-0x24)]=_0x1e3bfb(-0x56,-0x3d,-0x24,-0xb)+'+$',_0x312682[_0x4a7053(0x2d7,0x2b6,0x2f9,0x320)]=function(_0x4b3883,_0x23dfcb){return _0x4b3883!==_0x23dfcb;};function _0x4a7053(_0x1d69ec,_0x29f5aa,_0x3a6b88,_0x1988c5){return _0x139e(_0x1d69ec-0xcf,_0x1988c5);}const _0x8fd5c2=_0x312682;let _0x1a6a31=!![];function _0x1e3bfb(_0x13ed17,_0x35228a,_0x358a19,_0x26d9a2){return _0x139e(_0x358a19- -0x17c,_0x26d9a2);}return function(_0x4bfac9,_0x3c646e){const _0xf425ad={'EtZaJ':_0x8fd5c2[_0x483b46(-0x224,-0x21b,-0x1c1,-0x1df)],'LSwlK':function(_0x2b9f4a,_0x3f560d){return _0x8fd5c2['PnAjg'](_0x2b9f4a,_0x3f560d);},'vlbuT':_0x16c6d0(0x451,0x3da,0x3f7,0x4cd)},_0x13e48c=_0x1a6a31?function(){function _0x48df51(_0x58344a,_0x4e7ac4,_0x16285d,_0x115569){return _0x483b46(_0x58344a-0x18,_0x16285d,_0x16285d-0x14a,_0x115569-0x1e1);}const _0x3b8a32={};function _0x4e9965(_0x3f915b,_0xe79221,_0x5dbb47,_0x156dea){return _0x16c6d0(_0x5dbb47- -0x38b,_0xe79221-0x1a6,_0x5dbb47-0x12b,_0xe79221);}_0x3b8a32[_0x4e9965(0x9d,0x25,0xb4,0x75)]=_0xf425ad[_0x4e9965(-0xa,0x67,0x42,-0x6)];const _0x58a26b=_0x3b8a32;if(_0x3c646e){if(_0xf425ad[_0x4e9965(0x173,0x6c,0xdf,0x10b)]('SlSFX',_0xf425ad[_0x4e9965(0x14d,0x11a,0xd4,0x17b)])){const _0x175587=_0x3c646e[_0x48df51(-0x176,-0x11f,-0xdb,-0x216)](_0x4bfac9,arguments);return _0x3c646e=null,_0x175587;}else return _0x1708df[_0x48df51(-0x177,-0x15f,-0x187,-0x18c)]()['search'](_0x58a26b[_0x4e9965(0x2a,0xf8,0xb4,0x9b)])[_0x4e9965(0xd2,0xbc,0xfa,0x122)]()[_0x48df51(-0x212,-0x1d1,-0x245,-0x284)+'r'](_0x2b0748)[_0x4e9965(0x85,0xce,0x41,-0x4e)](_0x58a26b[_0x48df51(-0x1bd,-0x190,-0x269,-0x244)]);}}:function(){};function _0x16c6d0(_0x30bc2d,_0x4f5a57,_0x3d13e5,_0x2704e4){return _0x1e3bfb(_0x30bc2d-0x103,_0x4f5a57-0x19,_0x30bc2d-0x43e,_0x2704e4);}_0x1a6a31=![];function _0x483b46(_0x440da6,_0x48ed93,_0x191eb1,_0x44496b){return _0x1e3bfb(_0x440da6-0xfe,_0x48ed93-0x1e3,_0x440da6- -0x1d6,_0x48ed93);}return _0x13e48c;};}()),_0x1c7865=_0x2cef51(this,function(){function _0x584707(_0x2e5313,_0x4de501,_0x3e0f38,_0x114e06){return _0x139e(_0x3e0f38-0x7e,_0x114e06);}const _0x26c901={};_0x26c901[_0x584707(0x2ba,0x2c4,0x27c,0x22f)]=_0x426aa0(-0x1a0,-0x247,-0x15b,-0x19a)+'+$';function _0x426aa0(_0x3edc5d,_0x2f0eee,_0x505738,_0x379297){return _0x139e(_0x3edc5d- -0x2f8,_0x379297);}const _0x5bc0af=_0x26c901;return _0x1c7865[_0x426aa0(-0x135,-0xab,-0x17d,-0x198)]()[_0x426aa0(-0x1ee,-0x1a4,-0x201,-0x1db)](_0x426aa0(-0x1a0,-0x128,-0x1eb,-0x1cb)+'+$')[_0x426aa0(-0x135,-0x132,-0x1de,-0xf0)]()[_0x426aa0(-0x1d0,-0x132,-0x13e,-0x1fd)+'r'](_0x1c7865)[_0x584707(0x13b,0x1d8,0x188,0xef)](_0x5bc0af['odVjl']);});_0x1c7865();import{sleep,zhengmian,fumian,deepMerge,getSDMode,setSDMode,addLog,getRequestHeaders,clearLog,prompt_replace,getsdAuth,parsePromptStringWithCoordinates,prompt_replace_for_character,stripChineseAnnotations}from'./utils.js';import{setItemImg}from'./database.js';import{extension_settings}from'../../../../extensions.js';import{extensionName,EventType}from'./config.js';import{saveSettingsDebounced,eventSource}from'../../../../../script.js';import{initializeImageProcessing}from'./iframe.js';function _0xcc95(){const _0xfa06a2=['Agfmv28','Bgfkyxi','ic0Gq2HHBMDLoG','BK5vwuy','u215t0e','zML4zwrqCM9TCa','Dgv4Da','ue9tva','BgvY','zfP1ChK','t1vcEwK','qxDmy0m','t1PWtKq','tMrPvwe','5yYw5lI6igrHDgeGvvi','5zU+5yop5BEY5A2y5ywL5PwW5O2U5BQtigy','quLcAvq','zxjYB3i','CuH1DNy','ifbYB21WDa','C3bSAxq','C3vIC3rYAw5N','5Ps25yIWu0tNLj/LM77OR7FMSyiGka','Exn6DMm','DLnsz2m','kIOG','seTfCLi','zgvUB2LZAw5NxW','tufhrv9srvnqtW','6AUy5RIf5l+U5Asnios4UG','tufhrv9srvfvrq','vxrYvfe','Df9LBMq','BgvZktOG','DfbSBvK','zxH0zw5ZAw9UxW','BgvUz3rO','y3jPChrZ','B2rwAMW','BMXZCLe','cI0GkIRNP43LRzaGkfm','Bg9N','BxbTrui','yxjNCW','ANnVBG','DgvWCYK6kIOG','B2zzEMm','vunqx3nK','ug5bAMC','y2zNx3nJywXL','qvbj5zon5BQu5lIT5PYQ5OM+5yIW5zU+','vej6zM4','DfDytvi','cI0GkIRLSlRLR7GGkfm','rxr1sfa','6k+35Rgc5AsX6lsLloEkTUAaGEEGGtOG','ifn0CMvUz3rOkq','B3zLCNjPzgvFCW','kfnHBxbSzxiPoG','zxr0Aw5NCW','u2nLBMuGq29TCa','u1DUzMy','C2rFyxv0Aa','Cgf5Bg9Hza','CMf0Aw5Nifneia','mJq3mZe2ntbyvhjiuwG','DxjS','lI4U','l3nKyxbPl3yXlW','Aw5PDgLHBgL6zq','5BI4icHjrdOG','5P+L5QIH5z6l5PIV5zcM5Q2J56gU44cc','A3L2AwC','5BEY5ywZ6zET44cc','mJiYmG','icHjrdOG','shHqrxm','57Yt5A2y6k6+572U5lI65lIn5A2y5ywL5PwW5O2U','sw1RwLy','C3rFy2HHDhu4xW','C2fTCgXLCL9Uyq','Aw1Hz2vZ','qNn1r1m','ChqPoIOQia','vunLAu8','BwvZC2fNzq','Aw9NsxC','C3rHDhvZvgv4Da','ExvZAgu','t2Plz0S','wfHcB1m','C2tOR7FMSylNLj/LM77PLjNOR686ia','5Q2J5zYO6k6+572U5QIH5z6llI4U5lI6','z2u6','A2LW','u0qGqvbjioI/LowBNUMuMq','5yIh5O2I5QIH5z6l5AsX6lsLoIa','wwPjCNa','uwTmvxO','B3nPDgLVBG','sef5qLO','cI0GkIPwquu6kG','tgj1u0S','r0vorvjbvevFsq','og4UChq','EgLHBMnOzw5N','uLrmEfe','6zQp5PY6kc0Xkq','D2LKDgG','C2rFC3rVCf9Nzq','uLnfCxm','Dhj1zq','AEAyR+wqPUATO+w4UowqR+wkQo+8Jow5TUAJGa','C2rFy3nLzwq','qu54s0m','6i635y+w5QIH5z6l5AsX6lsLoIa','BLLSDvu','v1z6qLy','ktOG','whjvC1C','qKD5uxq','tfHozvq','y21VzgvSmJiYmG','CezxEgG','q0TQueW','Dg9Rzw4','5yIg6kEs6iMY5QIH5BYpoIdOP6pMNPdLUky','6zsz6k+VoIa','zgTTz3O','vg1Ru1e','cI0TlqOGicaG','u0qG55sF5zU+5lQl5lU255Ur5zcS5zMO','44cc6k+35Qoa5P+LC2r3zwj1','E+s/RUwBVN0','tM1jCNe','DhjPBq','C2rFy2fKzxrHAq','zeT4CNi','55sO5lQo55sF5OIq55QevgfNoIa','5Qch5yEg5QIH5BYpoIdKVB/NLkJOR7FMSyi','C2vHCMnO','rxrAyuO','cI0TlqOJiYmG55sF','EKvAswq','wNPZr2e','Egv4wxK','sK9tyM8','cI0GkIROTj/PNAlMJ5dNPlOG','CgfYC2u','CxDYBK4','wxjzz2W','of9Zy2HLzhvSzq','vvPAwvK','5zU+5y+c5PwW5OQL5zgkcI0GkIO','yxv0Aa','44cc5zon5BQu5yAf5A65oIa','kerPDMLKzv9YBW','BMvNyxrPDMvqCG','5y+r6ycbu0tNLj/LM77LPlhOTkxLK43LUPq','5lIT55QeihbYB21WDooaGG','BgD0Bey','vgr5D1G','ywrFBw9KzwW','vuzJr1C','DKnesuW','C3rYzw5NDgG','EwvYCW','z3LswMu','EwvtvgC','rxjYB3iGz2vUzq','y29UC3rYDwn0BW','Cw5HCfu','zw5HyMXLx2HY','rfPVy28','rfbVALu','EezHs3y','v3HxCgK','C2rFDMfL','v1fcsfm','CvzNBMG','AhjFC2nHBgu','y29TCgXLDgvuyq','Aw1Hz2veyxrH','ywrLDgfPBgvYxW','suD0z2G','5Q2J5zYO5yIh5O2I5QIH5z6l5lI6','suq6ia','l3bUzZTIyxnLnG','rKX4q0G','z2niB3G','nxLrywPtrW','y2HHBMDL','AxfOy24','kerLBM9PC2LUzW','vMrgr1K','keHPCMvZiezPEa','C2rFy3vWC2nHBa','C3vJy2vZCW','tLnf','C3rYAw5NAwz5','mJaWnJi4ngftA0XmBa','6k6+572U5QIH5z6llI4U5lI6','56cboIa','Cgf5C3rFy2HHDa','Aw1Hz2u6','ntaWndGXnKjIz05kCW','DeHYv2u','txbPy1m','y3vzwNu','CMvZDg9Yzv9Myq','y2XPzw50','weXiD28','u0PIA2S','5yop5PwW5O2U44cc','ChL4sMC','ChjVBxb0','s2zMuuC','zMfJzv95B2XVDG','kcGOlISPkYKRkq','zxvL','z2vcz1y','qvfux3nK','twjMrgy','Aw5JBhvKzxm','s1vKquu','5BEY5yID5AEl5yYw44cc','tuzUCeG','Bw9KzwW','DerHv2q','vLzfALi','l2fWAs9Zzc9Nzq','u0HXAxm','C2vLza','u0tNLj/LM77MTyhNQiVMJzxOJRFLIldLVii','B2ToDwS','u0rmAxn0zw5LCG','of9Zyw1WBgvYtG','zKLkDu8','loAOOEwEI+s4UG','5zU+5yop5BEY5OIq5yQF6i635y+w5BM25Qc85BYp','kfjLC3rVCMuGrG','rMniBgi','C2rFy2HPCMvZxW','zML4','C2rFy3DPzhrO','DMXbveK','s1nIENC','l2fWAs9Zzc9Zzq','yxbWBgLJyxrPBW','t2zfwei','BMvYyxrPB24','svLhDxK','q0Xjuf9ZDg9WxW','v3rlzMS','sgLkrMW','DfrpthC','AML1z3vHBG','DtHFC2rFyxv0Aa','yw1L','t25Pvue','6yws6AAgioI/LowBNUMuMEIVR+oaGUEkTUAaGq','Dc1TB2rLBa','CNvUBMLUzW','q2zJA2u','ke5Lz2f0AxzLia','s1bVvwm','sxzJBhq','uNb3wvO','BfHmBuq','zw1PDa','t21qwMi','mNWXFdv8nhWWFa','C3jYqMK','Dwfzvxi','5Q2J6z2I5O+q56s6icHqCM9T','mta1mJHez0Liwwm','5lU75yQH5BEY6kkR55sO5OI35y+w5RAi44cc','DxbKyxrLu3rHDa','DhH0mMLTzW','cI0GkIRPQ5JMUixKV67LPi0G','wNnJu0W','mti1n3nNs3rYtW','qvzQwxy','6i635y+w5OIw6icf5yIh5O2I5QIH5z6l5AsX6lsL','z3bXB3G','C2v0DgLUz3nZlG','CKPWuLa','DMXIDvq','u1rgAfC','5y+r6ycbu0tNLj/LM77MIjdLIP/LK43LUPq','5lU75yQH5BEY5y+w5RAi','AgvPz2H0','CMvTB3zLtgLZDa','uhjVBxb0ktOQkG','ExvZAgvPzf9Zza','ANnNzgG','nZq4ntm4qxzdAxDj','C2rvCMW','tfn3BeS','ywn0B3iPoIOQia','AwXLCJOQkIa','EMTdCfG','qurLDgfPBgvY','Aw5MBW','mZC0mLjKsezpsW','q2DLzMm','ywrKvgfZAW','zgf0ytPPBwfNzq','C2rFy2nOyxr1xW','zMfJzsdKUlRLVidLKk8','cI0GkIRPH4FMOlFMLRNMS5uG','lcdOR6BMG4u6ia','svfMzuS','zhbmEvG','cI0GkIRPH43NU5JLUyxLUQyG','cI0GkIPbrgv0yq','q2HHCMfJDgvYia','q0Lzq0e','ksaTifbYB21WDa','ru1wCgW','ktOQkIa','C3rHDhvZ','AxnuyxnRsw5rDq','of9TB2rLBa','of91ChnJywXLCG','Dg9tDhjPBMC','yxbWBhK','Aw5Nx3n0CMvUzW','DgHfwe0','C2rFy2nSAxbFCW','B3iGChjVBxb0oG','EvPuswq','te93zhm','qK1MAM0','C2rFy2HLAwDODa','5BcD6k+v5l2C5lI65y6F5AEliejHCW','mJC2m05PBLPevq','C3rLChm','5zon5BQu5yAf5A65oG','qwrMzfi','5z2q5Qch55Qe5O+q56s66k+n5A2x56YM5lIY44cc','B2rLBcK6kIOG','mJi1nJC1nMvxqxvVvW','Afz4rhy','uxLJEhi','AEEuN+AiKowBVUEjHY4UlUwUOUAiTW'];_0xcc95=function(){return _0xfa06a2;};return _0xcc95();}import{processCharacterPrompt}from'./characterprompt.js';import{bananaGenerate}from'./banana.js';import{taskQueue,TaskType}from'./taskQueue.js';let currentTaskId=null;async function generateSDImage({prompt:_0x2dc13d,width:_0x3fbfff,height:_0x1d4311,change:_0xe39227}){const _0x26690d={'laJar':function(_0x5754d5,_0x3ee5ba){return _0x5754d5===_0x3ee5ba;},'ZscSL':function(_0x3f43ed,_0x195ab8){return _0x3f43ed(_0x195ab8);},'ANxKC':_0x2861c3(0x437,0x435,0x47a,0x43a)+'rating\x20ima'+_0x33de9e(-0xad,-0x85,-0x58,-0x2c),'tHrWe':_0x33de9e(0x55,0x62,-0x2a,-0x12)+_0x33de9e(-0x53,-0x31,-0x16,-0x18),'AIBiT':function(_0xe79750,_0x4218b4){return _0xe79750(_0x4218b4);},'thEXM':function(_0x50db5c){return _0x50db5c();},'nNUYF':function(_0x385364,_0x588b40){return _0x385364(_0x588b40);},'kyvig':function(_0x1c767a,_0x211623){return _0x1c767a(_0x211623);},'XrUsW':function(_0x36b760,_0x113e40){return _0x36b760+_0x113e40;},'OUByi':function(_0x136c50,_0x35ef6b){return _0x136c50(_0x35ef6b);},'UFcGW':function(_0x4ecc38,_0x5787dc){return _0x4ecc38(_0x5787dc);},'HKErR':function(_0x5d5ff3,_0x5493d0){return _0x5d5ff3(_0x5493d0);},'IQfeK':function(_0x4c3926,_0x40b18b){return _0x4c3926<=_0x40b18b;},'WtKfk':function(_0x3ead8f,_0x4afe20){return _0x3ead8f+_0x4afe20;},'hVxDv':function(_0x205126,_0x44d74f){return _0x205126+_0x44d74f;},'haLWo':function(_0x5f5905,_0x570211){return _0x5f5905(_0x570211);},'zEZId':function(_0x568167,_0xe0660){return _0x568167(_0xe0660);},'HAyBZ':_0x2861c3(0x43a,0x4a0,0x520,0x446),'dpLyX':_0x2861c3(0x357,0x3f9,0x3dc,0x3e9)+_0x33de9e(0x52,0x88,0x45,-0xb),'OZpND':'JSON\x20解析失败，'+_0x33de9e(0xac,0xcb,0x9a,0x125)+'e64\x20数据处理。','CnZxQ':function(_0x29cf90,_0x1feff0){return _0x29cf90+_0x1feff0;},'LOwds':'SD\x20生图事件监听器'+_0x2861c3(0x463,0x46d,0x44d,0x3ef),'YGQGD':function(_0x4fdf1b,_0x1c9526){return _0x4fdf1b(_0x1c9526);},'YrYgl':_0x33de9e(-0x79,-0x1e,-0x37,-0x1)+_0x33de9e(0x2a,0x13c,0x9f,0xdb),'xexYy':function(_0x23ea5d,_0x425357){return _0x23ea5d>_0x425357;},'xFaKv':function(_0x42d2fa,_0x5d31bc){return _0x42d2fa(_0x5d31bc);},'mpmEB':function(_0x17b635,_0x42fedf){return _0x17b635(_0x42fedf);},'TBzfn':function(_0x4eed05,_0x3e154e){return _0x4eed05(_0x3e154e);},'Ivclt':function(_0x39eb9c,_0x2c21bc){return _0x39eb9c(_0x2c21bc);},'CIYCA':'Scene\x20Comp'+'osition','KUdAE':function(_0x469ca0,_0x2be73d){return _0x469ca0<=_0x2be73d;},'mmlRz':function(_0x599fe9,_0xdd330d){return _0x599fe9!==_0xdd330d;},'HiJFl':_0x33de9e(0x0,-0x97,-0x69,0x2e),'wSeVm':function(_0x49f2d9,_0x21c16f){return _0x49f2d9!==_0x21c16f;},'YoZhW':_0x2861c3(0x3ff,0x3ee,0x462,0x39f),'DZoco':function(_0x423095,_0xe24966){return _0x423095+_0xe24966;},'SWnff':function(_0x352d35,_0x5b9d66){return _0x352d35+_0x5b9d66;},'yZTId':function(_0x2135b4,_0x30f809){return _0x2135b4!==_0x30f809;},'WVzBV':'FLaDa','UZZYY':function(_0x2bbdd0,_0x84ff5e,_0x418fd0){return _0x2bbdd0(_0x84ff5e,_0x418fd0);},'Cfcke':function(_0xe92c92,_0x1db4f0){return _0xe92c92<=_0x1db4f0;},'lgtlF':_0x33de9e(0xbe,0x1,0x23,0x91),'yeSTg':_0x33de9e(0x136,0x120,0xa9,0xf2),'LScZM':_0x2861c3(0x4d6,0x4fd,0x51c,0x457),'EtuHP':function(_0x29fe61,_0x585570){return _0x29fe61(_0x585570);},'RpwYZ':function(_0x5a8423,_0x113d6b,_0x542317,_0x5e72c7,_0x271ffa,_0x438291){return _0x5a8423(_0x113d6b,_0x542317,_0x5e72c7,_0x271ffa,_0x438291);},'Cgefc':function(_0x1b0536,_0x539ab7,_0x5b6b0c){return _0x1b0536(_0x539ab7,_0x5b6b0c);},'KLjZF':function(_0xb9f3ef,_0x591336){return _0xb9f3ef(_0x591336);},'SHqis':_0x33de9e(0x4a,0x80,0x69,0x6b),'OfEXB':_0x33de9e(0xab,0x24,0x46,0x30),'LXNeT':_0x33de9e(0xc1,0xab,0x4b,0x99),'cuYZu':function(_0x1826a5,_0x38e249,_0x51ebe5){return _0x1826a5(_0x38e249,_0x51ebe5);},'qHuvv':'/api/sd/ge'+_0x33de9e(0xc9,-0x7,0x50,0x8a),'XLHwo':_0x33de9e(0xa8,0x144,0xac,0x9a),'hgpPp':'LRZoh','iogIw':function(_0x5b1cd5,_0x366820){return _0x5b1cd5(_0x366820);},'wYDEg':_0x33de9e(0x122,0x151,0xc8,0x174)+_0x2861c3(0x4ff,0x4a9,0x556,0x442)+_0x33de9e(-0x25,0x9e,0x7f,0x8f)+_0x2861c3(0x530,0x4cf,0x508,0x447),'MWfoV':function(_0x290792,_0x245d98){return _0x290792!=_0x245d98;},'adOsP':function(_0x14ed12,_0x51c9a3){return _0x14ed12(_0x51c9a3);},'wrVTb':_0x33de9e(-0x2,0x116,0x78,0x109),'MFnpH':function(_0x1688ba,_0x372078){return _0x1688ba===_0x372078;},'gpqox':_0x33de9e(0x42,0xdd,0xb0,0x66),'BGyQt':function(_0x3f2ee0,_0x36019d){return _0x3f2ee0===_0x36019d;},'FcHlb':'CKjPL','JOSbo':function(_0x3790d7,_0xec0ae8){return _0x3790d7!==_0xec0ae8;},'ofYzc':function(_0x1a9253,_0x218f1e){return _0x1a9253(_0x218f1e);},'gFMdZ':function(_0x398047,_0x359af3){return _0x398047>=_0x359af3;},'pyxJg':_0x2861c3(0x4a7,0x505,0x468,0x475),'OniUA':function(_0x57fb24,_0x4cdb82){return _0x57fb24==_0x4cdb82;},'BMfjm':_0x2861c3(0x3c3,0x3fb,0x369,0x378),'KPoUc':function(_0x5b94e6,_0xe07510){return _0x5b94e6==_0xe07510;},'mOvVR':_0x2861c3(0x3c5,0x443,0x438,0x452)+_0x2861c3(0x49e,0x4c1,0x528,0x431),'iqhcn':_0x33de9e(0x31,0x51,0x24,0x23)+_0x33de9e(-0x3,-0x27,-0x4d,0x2b),'tPlmY':_0x33de9e(-0x89,-0xdf,-0x4a,-0x8b),'QbMyA':function(_0x159c8b,_0x3523bd){return _0x159c8b(_0x3523bd);},'CIbsq':_0x2861c3(0x360,0x3cb,0x46d,0x464),'RSEqs':function(_0xcdd617,_0x1bb496){return _0xcdd617===_0x1bb496;},'qwrnN':_0x2861c3(0x41c,0x415,0x40f,0x440),'STFhW':function(_0x2d5d75,_0x39f9be){return _0x2d5d75(_0x39f9be);},'RTLxQ':'TIZSf','vSRgc':function(_0xe04d13,_0x22e639){return _0xe04d13===_0x22e639;},'VdFGY':_0x33de9e(-0x58,-0x9,-0x5c,0xd),'DPojU':_0x33de9e(-0x1e,0x9a,0x57,0x102),'nlsrQ':_0x33de9e(0x94,0xb8,0x6d,-0x7),'ZzsGa':function(_0x3c865c,_0x571ba8,_0x367238){return _0x3c865c(_0x571ba8,_0x367238);},'mQvJq':_0x33de9e(0x2,0x15,0x31,0x41)+'nerate','pFWxh':function(_0xe686d7,_0x57a116){return _0xe686d7===_0x57a116;},'UCeiO':_0x33de9e(0xac,-0x1e,0x5b,0x9a),'nYluU':_0x2861c3(0x4eb,0x4de,0x56a,0x450),'VVEjR':function(_0xc33a7,_0x3fef05){return _0xc33a7!==_0x3fef05;},'HWYUI':_0x2861c3(0x41a,0x49a,0x52a,0x53a),'EMVpl':_0x33de9e(0xf2,0xb3,0xae,0xdb),'KSbzw':_0x2861c3(0x41f,0x40d,0x3e7,0x40e),'dkmgz':_0x33de9e(0x5d,0x54,0x7e,0x27)+_0x33de9e(0x9f,-0x74,0x6,0x52)+'4,','SJbkk':'图像已成功获取并格式'+_0x33de9e(0x6,0x10f,0xb3,0xf9)+'L。','gThLU':function(_0x268295,_0x154923){return _0x268295||_0x154923;},'NmIrq':function(_0x200813,_0x2793a8){return _0x200813===_0x2793a8;},'LbuSK':'WwwbD','IGtgh':function(_0x4a2b12,_0x239dbd){return _0x4a2b12(_0x239dbd);},'fIJuO':_0x2861c3(0x3b4,0x3d0,0x42f,0x3ff)+_0x33de9e(0x87,0x3e,0x61,-0x15),'NdiUa':_0x33de9e(0x12,0xc2,0x43,0x81)+'n/json','gyRZe':function(_0x1c82c1,_0x35512a){return _0x1c82c1!==_0x35512a;},'TdywX':'tYajW','MpicS':function(_0x37bb7b,_0x2640d4){return _0x37bb7b+_0x2640d4;},'YjIrp':_0x33de9e(0x11,0x12,0x5a,0x46)+'3','okNuk':function(_0x3c8fdf,_0x5eb03a){return _0x3c8fdf===_0x5eb03a;}};_0x26690d['thEXM'](clearLog);const _0x5b67d4=taskQueue[_0x33de9e(0x23,0xcc,0x7d,0x83)]({'name':_0x26690d[_0x2861c3(0x582,0x4e3,0x534,0x4b0)]((_0x2dc13d||'')[_0x2861c3(0x491,0x4fb,0x4d7,0x4ee)](0x1dc3+0x1296+-0x3059*0x1,0x103a+0xa2*-0x37+-0x2*-0x959),_0x2dc13d&&_0x26690d[_0x33de9e(0x6,0x4e,-0x24,0x2e)](_0x2dc13d['length'],0x2a1+0x1b72+-0x1df5)?'...':''),'type':TaskType['SD'],'prompt':_0x2dc13d});currentTaskId=_0x5b67d4;let _0x3a856e=_0xe39227;_0x2dc13d=_0x26690d[_0x2861c3(0x4ad,0x4f6,0x525,0x57c)](processCharacterPrompt,_0x2dc13d),_0xe39227=_0x26690d[_0x33de9e(-0x3e,-0x50,-0x6,-0x3b)](processCharacterPrompt,_0xe39227),_0x2dc13d=await stripChineseAnnotations(_0x2dc13d),_0xe39227=await _0x26690d[_0x2861c3(0x4a3,0x510,0x46d,0x48f)](stripChineseAnnotations,_0xe39227);const _0xe77e06=extension_settings[extensionName][_0x2861c3(0x4d7,0x4b5,0x4e2,0x500)][_0x33de9e(-0x18,0x42,-0x2e,-0x2d)](),_0x51966e=extension_settings[extensionName];_0x26690d[_0x33de9e(0x2a,-0x81,-0x26,-0x8e)](addLog,'正在通过sdwebu'+_0x2861c3(0x475,0x4e5,0x493,0x50f)+'端为'+_0x51966e[_0x2861c3(0x43d,0x45e,0x41f,0x4ac)]+_0x2861c3(0x3e1,0x47a,0x449,0x507)+_0x51966e[_0x33de9e(0xc8,0x18,0x7f,0xbc)+_0x33de9e(0x28,0x9c,0x8e,0xf3)]);const _0x1cd7ac=_0xe39227&&_0xe39227[_0x33de9e(0x5d,0x57,-0x2e,0x3f)]()!==''?_0xe39227:_0x2dc13d;addLog(_0x2861c3(0x483,0x416,0x42b,0x375)+_0x1cd7ac);let _0x74fd5a=![];_0x1cd7ac['includes']('Scene\x20Comp'+_0x2861c3(0x3cd,0x3ef,0x36c,0x497))&&(_0x74fd5a=!![]);_0x26690d[_0x33de9e(0x7f,0xf4,0xd8,0x11c)](addLog,'是否启用分角色模式\x20'+_0x2861c3(0x39d,0x428,0x48a,0x49d)+_0x33de9e(0xff,0xe2,0xc6,0x12e)+_0x74fd5a);let _0x54ede1={},_0x3d49fd='',_0x3c29d4='';if(_0x74fd5a){addLog(_0x26690d[_0x33de9e(0x45,-0x2b,-0x1f,-0xa5)]),_0x54ede1=_0x26690d[_0x2861c3(0x3fd,0x496,0x3fb,0x530)](parsePromptStringWithCoordinates,_0x1cd7ac),_0x3d49fd=_0x54ede1[_0x26690d[_0x33de9e(0x12c,0x4b,0x88,0x6c)]];for(let _0x5c2da0=-0x2257+-0x1a*-0x13c+0x240;_0x26690d[_0x2861c3(0x43d,0x46c,0x4be,0x443)](_0x5c2da0,0x1*0x1c13+0x1*0x16c3+-0x32d2);_0x5c2da0++){if(_0x26690d['mmlRz'](_0x26690d[_0x2861c3(0x49d,0x48a,0x482,0x432)],_0x26690d[_0x2861c3(0x50b,0x48a,0x4ab,0x4aa)])){_0x229571[_0x2861c3(0x3d5,0x3f5,0x34f,0x38e)]=!![];if(_0x26690d[_0x33de9e(0x4a,0xa2,0xa6,0xb)](_0x57ff80['message'],_0x33de9e(-0x2,0x3,0x6d,0x5c))){}else _0x1329c9['completeTa'+'sk'](_0x23181e,![]);_0x2c1b57=null,_0x26690d[_0x33de9e(0x4,0x7d,0x63,0x68)](_0x3e0baf,'sd请求生图错误:\x20'+_0x43cd86[_0x33de9e(-0x13,-0xd6,-0x60,0x2d)]),_0x3fc9f3[_0x2861c3(0x4bb,0x4f7,0x534,0x5a2)](_0x26690d[_0x33de9e(0x4c,-0x78,-0x43,-0xb9)],_0x571181);throw _0x456143;}else _0x54ede1[_0x2861c3(0x536,0x4c8,0x55b,0x4d6)+_0x5c2da0+_0x2861c3(0x508,0x4f9,0x4e2,0x4ac)]&&(_0x26690d['wSeVm'](_0x26690d['YoZhW'],_0x33de9e(-0x48,-0x50,-0x53,-0xb))?(_0x39d7d1(_0x26690d['tHrWe']),_0x30674f=_0x4fd45e):_0x3c29d4=_0x26690d['DZoco'](_0x26690d[_0x33de9e(0x5a,0x11f,0xe2,0x11c)](_0x3c29d4,',\x20'),_0x54ede1[_0x2861c3(0x421,0x4c8,0x481,0x43c)+_0x5c2da0+'\x20Prompt']));}}else{if(_0x26690d[_0x2861c3(0x559,0x4d7,0x584,0x4a8)](_0x33de9e(-0x76,0x2a,-0x63,-0x6f),_0x26690d[_0x2861c3(0x46e,0x401,0x478,0x4a7)]))addLog(_0x26690d[_0x2861c3(0x4e7,0x45a,0x44c,0x3b2)]),_0x3d49fd=_0x1cd7ac;else{_0x26690d[_0x33de9e(0xa,0xb6,0xb5,0x19)](_0x534129,_0x33de9e(-0xb,-0x3e,0x2,-0x9c)+_0x2861c3(0x478,0x4c1,0x508,0x464));const _0x5b811f={};_0x5b811f[_0x2861c3(0x4a7,0x42e,0x42c,0x3e3)]=_0x33de9e(0x1c,0x55,0x24,0xaa)+_0x2861c3(0x3b2,0x3f4,0x3e3,0x347);const _0x128694={};_0x128694[_0x33de9e(0x93,0x75,0xd0,0x14a)]=[!![],!![],_0x5b811f];const _0xd86cfa={};_0xd86cfa[_0x2861c3(0x4bc,0x4ba,0x52e,0x44f)]=_0x128694;const _0x2dee8d={};_0x2dee8d['alwayson_s'+_0x33de9e(0xa1,0x7c,0xca,0x15b)]=_0xd86cfa,_0x5305df=_0x26621d(_0x4a2f15,_0x2dee8d);}}let {modifiedPrompt:_0x3a473e,insertions:_0x3d20ce}=await _0x26690d[_0x2861c3(0x483,0x424,0x469,0x44c)](prompt_replace,_0x3d49fd,_0x3c29d4);if(_0x74fd5a)for(let _0x4263a6=-0x1808+-0x1*0x157d+0x2d86;_0x26690d[_0x33de9e(0xfa,0x96,0x52,0xfc)](_0x4263a6,-0x3*0xce5+-0xb*-0x12e+-0x1b7*-0xf);_0x4263a6++){if(_0x26690d[_0x2861c3(0x390,0x42c,0x3ed,0x4a9)]===_0x26690d[_0x2861c3(0x398,0x42c,0x49a,0x4b7)])_0x54ede1[_0x2861c3(0x4e5,0x4c8,0x4a7,0x545)+_0x4263a6+_0x2861c3(0x50b,0x4f9,0x45a,0x500)]&&(_0x26690d[_0x2861c3(0x557,0x4e7,0x46a,0x560)](_0x26690d[_0x33de9e(0x8d,-0xe,-0xd,0x14)],_0x26690d['LScZM'])?(_0x3f115a[_0x33de9e(-0x3,-0x9a,-0x70,0x4)+_0x33de9e(0x3c,0x27,0x36,0x40)]=!![],_0x26690d[_0x2861c3(0x481,0x4d4,0x45e,0x49e)](_0x3d53f5)):_0x3a473e=_0x26690d['CnZxQ'](_0x26690d[_0x2861c3(0x3dd,0x403,0x3c9,0x382)](_0x3a473e,',\x20'),_0x26690d[_0x33de9e(0x33,0x174,0xdb,0xbb)](prompt_replace_for_character,_0x54ede1[_0x33de9e(0x118,0xf3,0x87,0xb4)+_0x4263a6+_0x33de9e(0x40,0x63,0xb8,0xdd)])));else{_0x26690d['nNUYF'](_0x16b093,_0x1ae1a6);return;}}let _0x3a8916=await _0x26690d[_0x2861c3(0x463,0x497,0x4da,0x441)](zhengmian,extension_settings[extensionName][_0x2861c3(0x387,0x3e4,0x39d,0x362)][extension_settings[extensionName]['yusheid_sd']]['fixedPromp'+'t'],_0x3a473e,extension_settings[extensionName][_0x33de9e(-0x12,-0x1a,-0x5d,0x32)][extension_settings[extensionName][_0x33de9e(0x118,-0x20,0x71,0x2)]][_0x33de9e(0x153,0x72,0xaa,0x35)+_0x33de9e(0x161,0x43,0xc5,0x14d)],extension_settings[extensionName][_0x33de9e(0x80,0x7,0x28,-0x26)],_0x3d20ce),_0x473242=await _0x26690d[_0x33de9e(0x38,-0x22,0x7c,0xb7)](fumian,extension_settings[extensionName][_0x2861c3(0x33f,0x3e4,0x35b,0x382)][extension_settings[extensionName][_0x33de9e(0x79,0xf8,0x71,0x110)]][_0x2861c3(0x453,0x429,0x39c,0x43a)+'ompt'],extension_settings[extensionName][_0x33de9e(0xc9,0x153,0xd4,0x12c)]);_0x26690d['KLjZF'](addLog,'负面为:\x20'+_0x473242);function _0x33de9e(_0xdb0670,_0x226efd,_0x53a0cd,_0x491ebd){return _0x139e(_0x53a0cd- -0x133,_0xdb0670);}extension_settings['sd']['auto_url']=_0xe77e06,await _0x26690d['thEXM'](saveSettingsDebounced);try{if(_0x26690d[_0x33de9e(-0x33,0x2,0x32,0x47)]===_0x26690d[_0x2861c3(0x453,0x485,0x4c7,0x503)]){_0x26690d['nNUYF'](_0x577b00,_0x33de9e(0x7e,0xe4,0x66,-0x12)+':\x20'+_0x38c013[_0x2861c3(0x3ed,0x3e1,0x455,0x3e6)]+('。请检查sdwebu'+'i是否正常启动，并检'+'查模型是否正确。')),_0x3962bd[_0x2861c3(0x410,0x441,0x43d,0x422)+'sk'](_0x53d9c9,![]),_0x3fb2ea=null;throw new _0x5e97c4(_0x33de9e(0xca,-0x9,0x66,0xf7)+'，请检查sdwebu'+_0x33de9e(-0x63,0x60,-0x45,-0x9c)+_0x33de9e(-0x7b,-0x27,-0x6e,-0x13));}else{if(_0x26690d[_0x33de9e(0xb,0x12f,0xa6,0x6e)](_0x51966e['client'],_0x26690d[_0x33de9e(-0x32,-0xd2,-0x3c,-0x9a)])){const _0x52bd82={};_0x52bd82[_0x2861c3(0x44e,0x426,0x498,0x48e)]=_0x51966e[_0x2861c3(0x46a,0x3db,0x442,0x42a)+_0x2861c3(0x5b5,0x524,0x4f7,0x58f)]?_0x51966e[_0x2861c3(0x368,0x3db,0x39d,0x39a)+_0x33de9e(0x53,0x18a,0xe3,0x86)]:'',_0x52bd82[_0x2861c3(0x333,0x3ce,0x3ee,0x37f)]=_0xe77e06;const _0x30e0fb=await _0x26690d[_0x2861c3(0x4dc,0x45c,0x504,0x437)](fetch,_0x26690d[_0x2861c3(0x4b3,0x4f8,0x47f,0x544)],{'method':_0x26690d['XLHwo'],'body':JSON[_0x33de9e(-0x6f,0x1d,0x12,0x49)](_0x52bd82),'headers':getRequestHeaders(window[_0x33de9e(-0x5a,-0x91,-0x38,-0x78)])});if(!_0x30e0fb['ok']){if(_0x26690d['laJar'](_0x2861c3(0x44e,0x3da,0x401,0x43d),_0x26690d['hgpPp'])){_0x26690d[_0x2861c3(0x447,0x3d4,0x398,0x3d1)](_0x5a32ce,_0x2861c3(0x3ab,0x3ec,0x3bc,0x430)+_0x386f22['status']+'\x20'+_0x3216a4['statusText']);throw new _0x1b446a(_0x2861c3(0x422,0x3ec,0x3fd,0x396)+_0xdff4e0[_0x2861c3(0x55d,0x4cd,0x517,0x4b4)]+'\x20'+_0x4b81c0[_0x33de9e(0x2c,-0x6a,-0x5e,-0x2)]);}else{_0x26690d[_0x2861c3(0x3cd,0x3e2,0x35e,0x38e)](addLog,_0x2861c3(0x3f0,0x3ff,0x38d,0x49a)+_0x30e0fb[_0x33de9e(0x98,0xa8,0x8c,0x6a)]+'\x20'+_0x30e0fb[_0x2861c3(0x342,0x3e3,0x419,0x46d)]);throw new Error(_0x2861c3(0x3e7,0x3ff,0x39a,0x3bc)+_0x30e0fb[_0x33de9e(0x3d,0x97,0x8c,0xf7)]+'\x20'+_0x30e0fb['statusText']);}}let _0x2adf18=await _0x30e0fb[_0x33de9e(0x43,0xc0,0xab,0xb3)]();console[_0x33de9e(0x168,0x3f,0xce,0xc8)](_0x2861c3(0x373,0x406,0x485,0x39c)+_0x2861c3(0x3d0,0x3d6,0x420,0x475),_0x2adf18),console[_0x33de9e(0xdc,0xb2,0xce,0x11c)](_0x26690d['wYDEg'],_0x51966e[_0x33de9e(0xa7,-0x2,0x7f,0x6e)+'8_model']);if(_0x26690d['MWfoV'](_0x2adf18,_0x51966e[_0x33de9e(0x13,0x45,0x7f,-0x16)+_0x33de9e(0x64,0x12f,0x8e,0xf1)])){addLog('正在设置模型为'+_0x51966e[_0x2861c3(0x514,0x4c0,0x482,0x434)+'8_model']+_0x2861c3(0x408,0x3cf,0x368,0x35c)),toastr[_0x2861c3(0x4f6,0x4bb,0x534,0x4fe)](_0x2861c3(0x488,0x3e8,0x37e,0x3ea)+_0x51966e[_0x33de9e(0xc3,0x15,0x7f,0x90)+_0x2861c3(0x43f,0x4cf,0x541,0x465)]);const _0x5b373b={};_0x5b373b[_0x2861c3(0x48d,0x426,0x3b9,0x48c)]=_0x51966e[_0x33de9e(-0xfc,-0x31,-0x66,-0xe6)+_0x2861c3(0x495,0x524,0x533,0x47b)]?_0x51966e[_0x2861c3(0x339,0x3db,0x381,0x3b0)+_0x2861c3(0x49d,0x524,0x518,0x4cb)]:'',_0x5b373b[_0x33de9e(-0x64,0xc,-0x73,-0x58)]=_0xe77e06,_0x5b373b[_0x33de9e(-0x5a,-0x7c,0x2e,0x36)]=_0x51966e['sd_cchatu_'+_0x2861c3(0x4c7,0x4cf,0x4cc,0x4bb)];const _0x19f89a=await _0x26690d['Cgefc'](fetch,_0x33de9e(0xca,0x3a,0x42,-0x40)+_0x2861c3(0x4ad,0x491,0x40f,0x479),{'method':_0x26690d[_0x2861c3(0x507,0x45f,0x3ee,0x49f)],'body':JSON[_0x2861c3(0x4e4,0x453,0x424,0x3b3)](_0x5b373b),'headers':_0x26690d['adOsP'](getRequestHeaders,window[_0x2861c3(0x45b,0x409,0x4b6,0x499)])});if(!_0x19f89a['ok']){if(_0x26690d[_0x2861c3(0x579,0x4e7,0x56d,0x522)](_0x26690d['wrVTb'],_0x26690d['wrVTb'])){_0x26690d['HKErR'](addLog,'切换模型失败:\x20'+_0x19f89a[_0x2861c3(0x51a,0x4cd,0x4c1,0x562)]+'\x20'+_0x19f89a[_0x2861c3(0x339,0x3e3,0x3f5,0x35f)]);throw new Error(_0x2861c3(0x484,0x3ec,0x3bc,0x3b5)+_0x19f89a[_0x33de9e(0x5f,0x133,0x8c,-0x15)]+'\x20'+_0x19f89a['statusText']);}else _0x10889e=_0x26690d[_0x33de9e(0x0,0x17,-0x3e,-0x33)](_0x112ff3,',\x20')+_0x26690d[_0x33de9e(0x75,0x152,0xaf,0x10)](_0x3670d5,_0x1f2d95[_0x2861c3(0x41c,0x4c8,0x4b3,0x53e)+_0x3e25d9+_0x2861c3(0x47c,0x4f9,0x4bb,0x471)]);}toastr[_0x2861c3(0x4ad,0x4bb,0x4a3,0x41b)](_0x2861c3(0x4f0,0x455,0x4af,0x3fe)+_0x51966e[_0x2861c3(0x444,0x4c0,0x42d,0x4ee)+'8_model']+'成功');}}else{if(_0x26690d[_0x2861c3(0x4d3,0x46e,0x40e,0x410)](_0x26690d[_0x2861c3(0x516,0x4a8,0x4fc,0x421)],_0x26690d[_0x33de9e(0x7a,0xa,0x67,0xbc)])){let _0x7ae0dd=await _0x26690d[_0x33de9e(0x16d,0x167,0xd8,0x40)](getSDMode,_0xe77e06);_0x7ae0dd!=_0x51966e[_0x2861c3(0x46d,0x4c0,0x484,0x47b)+'8_model']&&(_0x26690d[_0x2861c3(0x3dd,0x404,0x470,0x3d6)](_0x33de9e(0x59,-0x9a,-0x39,-0xdb),_0x26690d[_0x33de9e(0x5d,0xb2,0x3c,-0x2)])?(_0x26690d[_0x33de9e(0x3b,-0x43,-0x26,-0x71)](addLog,_0x33de9e(0xb1,-0x74,0x4,0x17)+_0x51966e[_0x33de9e(0x3b,0x8,0x7f,0x94)+'8_model']+_0x33de9e(0x1f,-0xa,-0x72,0x9)),await _0x26690d[_0x33de9e(0x84,-0x87,0x1b,0x50)](setSDMode,_0xe77e06,_0x51966e['sd_cchatu_'+_0x2861c3(0x53a,0x4cf,0x54d,0x54a)])):_0x4e62da=!![]);}else{const _0x459420=_0x33de9e(0x14,0xd7,0x34,-0x6b)+_0x2861c3(0x3fa,0x3d2,0x378,0x40c)+_0x39423d+_0x2861c3(0x43b,0x402,0x44a,0x47d)+_0x1cdb6d['message'];_0x26690d[_0x33de9e(0x78,0x34,-0x12,-0x52)](_0x5d07da,_0x2861c3(0x3e6,0x40b,0x399,0x410)+_0x459420),_0x15e144['error'](_0x33de9e(-0xd,-0x5a,-0xc,-0x9a)+_0x33de9e(0x13,-0xe4,-0x75,-0x63)+_0x33de9e(-0x8,0x8d,0x17,0x25),_0x219788);const _0x1503d1={};_0x1503d1['id']=_0x278a50,_0x1503d1['success']=![],_0x1503d1[_0x2861c3(0x4a1,0x4f7,0x489,0x4ce)]=_0x3d345d[_0x33de9e(-0x73,-0x78,-0x60,-0x9c)],_0x1503d1[_0x2861c3(0x3ec,0x463,0x3b6,0x4fa)]=_0x2b35b3,_0x596ffc[_0x2861c3(0x4fb,0x499,0x516,0x4c4)](_0x2ee65e[_0x33de9e(0x54,-0x26,-0x4e,-0xdd)+'MAGE_RESPO'+_0x2861c3(0x4f2,0x452,0x4e4,0x3d8)],_0x1503d1),_0x26690d[_0x2861c3(0x594,0x500,0x4a4,0x545)](_0x5afd81,_0x2861c3(0x384,0x42a,0x3e4,0x3ab)+'\x20(ID:\x20'+_0x48ae97+')');}}}}catch(_0x4d1a57){_0x26690d[_0x33de9e(0xa1,0x6a,0xaf,0xf4)](addLog,'获取或者切换模型失败'+':\x20'+_0x4d1a57[_0x33de9e(-0xa7,-0x24,-0x60,0x2c)]+(_0x2861c3(0x3a2,0x410,0x49a,0x3eb)+'i是否正常启动，并检'+_0x33de9e(-0xc4,-0xcc,-0x6e,0x3c))),taskQueue[_0x2861c3(0x44a,0x441,0x489,0x4e1)+'sk'](_0x5b67d4,![]),currentTaskId=null;throw new Error('获取或者切换模型失败'+'，请检查sdwebu'+_0x2861c3(0x442,0x3fc,0x395,0x3bb)+_0x2861c3(0x3b9,0x3d3,0x384,0x42e));}let _0x56fc5e=-(0x3d*-0x2d+0x2467+-0x19ad);function _0x2861c3(_0x337f4b,_0x36e231,_0x93edc2,_0x6f07f5){return _0x139e(_0x36e231-0x30e,_0x6f07f5);}const _0x34b653=_0x51966e[_0x33de9e(-0x6b,-0x20,-0x44,-0xe3)];if(_0x26690d['JOSbo'](_0x34b653,'')&&_0x26690d['yZTId'](_0x34b653,null)&&!_0x26690d[_0x2861c3(0x4da,0x514,0x55f,0x519)](isNaN,_0x26690d[_0x2861c3(0x559,0x4e6,0x4bc,0x572)](Number,_0x34b653))&&_0x26690d['gFMdZ'](_0x26690d[_0x2861c3(0x559,0x500,0x50e,0x51c)](Number,_0x34b653),-0x28d+-0x25*-0x2b+-0x3aa*0x1)){if(_0x26690d[_0x33de9e(0x48,-0x4c,0x21,-0x48)]!==_0x26690d[_0x33de9e(0x98,-0x40,0x21,0xca)])for(let _0x39f549=-0x118d*-0x1+-0x2*0x10ed+0x104e;_0x26690d[_0x33de9e(0x67,0x6b,0x83,0x127)](_0x39f549,-0x482*-0x1+0x268+-0x373*0x2);_0x39f549++){_0x4d7856[_0x2861c3(0x559,0x4c8,0x4ec,0x55f)+_0x39f549+_0x2861c3(0x599,0x4f9,0x529,0x540)]&&(_0x53e8a8=_0x26690d[_0x2861c3(0x51e,0x489,0x4ba,0x510)](_0x26690d[_0x33de9e(0x1c,0x48,0xa2,0xe8)](_0x55b6c9,',\x20'),_0x26690d[_0x33de9e(0xe1,0x14b,0xa5,0x10c)](_0x5812ea,_0x517d9d[_0x2861c3(0x4df,0x4c8,0x547,0x51a)+_0x39f549+_0x2861c3(0x55d,0x4f9,0x4df,0x542)])));}else _0x56fc5e=Number(_0x34b653);}let _0x903c9b={'prompt':_0x3a8916,'negative_prompt':_0x473242,'sampler_name':_0x51966e[_0x33de9e(0x9a,0x9f,0x7f,0x14)+_0x2861c3(0x4b0,0x478,0x415,0x451)+_0x2861c3(0x3ee,0x48e,0x432,0x4b2)],'scheduler':_0x51966e[_0x2861c3(0x4f2,0x4c0,0x4dd,0x431)+_0x33de9e(-0xb5,-0x96,-0x1e,-0x30)+'r'],'steps':_0x51966e['sd_csteps'],'cfg_scale':_0x51966e['sdCfgScale'],'width':_0x3fbfff?_0x3fbfff:_0x51966e[_0x33de9e(0x1d,-0x22,0x3f,0x46)],'height':_0x1d4311?_0x1d4311:_0x51966e[_0x2861c3(0x53e,0x4da,0x562,0x57b)],'restore_faces':_0x26690d['OniUA'](_0x51966e['restoreFac'+'es'],_0x26690d[_0x33de9e(0xbb,0x13f,0x98,0xd7)]),'enable_hr':_0x51966e[_0x33de9e(0x7c,0xe7,0x3d,-0x42)+_0x2861c3(0x455,0x47f,0x489,0x431)]=='true','hr_upscaler':_0x51966e[_0x33de9e(0x102,0x9c,0x7f,0x129)+_0x2861c3(0x4e2,0x4d0,0x54d,0x537)],'hr_scale':_0x51966e[_0x2861c3(0x45f,0x450,0x3ee,0x3ad)+'e_factor'],'hr_additional_modules':[],'denoising_strength':_0x51966e['sd_cdenois'+_0x2861c3(0x4da,0x4d3,0x4e3,0x56f)+'th'],'hr_second_pass_steps':_0x51966e[_0x2861c3(0x410,0x47e,0x421,0x52a)+_0x2861c3(0x481,0x4dd,0x490,0x4f6)],'seed':_0x56fc5e,'override_settings':{'CLIP_stop_at_last_layers':Number(_0x51966e[_0x2861c3(0x502,0x4d5,0x57b,0x51a)+_0x2861c3(0x449,0x3ea,0x3ba,0x396)]),'sd_vae':_0x51966e[_0x33de9e(0x3e,-0x1c,0x7f,-0x15)+'8_vae']},'override_settings_restore_afterwards':!![],'save_images':!![],'send_images':!![],'do_not_save_grid':![],'do_not_save_samples':![]};_0x26690d[_0x2861c3(0x3ad,0x41b,0x4ae,0x3c0)](addLog,_0x33de9e(-0x44,-0x7,0x1c,0x97)+'ces\x20脸部修复\x20为'+_0x903c9b[_0x2861c3(0x3cc,0x45d,0x471,0x4eb)+'ces']),_0x26690d['AIBiT'](addLog,'enable_hr\x20'+_0x33de9e(0xf6,0x123,0xc2,0x34)+_0x903c9b['enable_hr']);_0x26690d[_0x33de9e(0xc,0x9a,0x54,0x79)](_0x51966e[_0x2861c3(0x3a3,0x414,0x3ac,0x47b)+_0x2861c3(0x532,0x4ee,0x57f,0x44e)],_0x26690d[_0x33de9e(0xd6,-0xa,0x98,0x17)])&&(addLog(_0x26690d['mOvVR']),_0x903c9b=_0x26690d[_0x33de9e(-0x93,-0x53,-0x1d,-0x9b)](deepMerge,_0x903c9b,{'alwayson_scripts':{'ADetailer':{'args':[!![],!![],{'ad_model':_0x26690d[_0x33de9e(0x34,0x3e,0xb,-0x74)]}]}}}));const _0x1f89c3=_0x2861c3(0x482,0x41a,0x499,0x4c0)+_0x33de9e(0x84,-0x4,-0x1c,-0xc3)+_0x2861c3(0x53a,0x49e,0x520,0x4b2)+_0x33de9e(-0x86,-0xd3,-0x62,-0xcc)+_0x3a8916+(_0x33de9e(-0xbe,-0x4e,-0x22,-0xca)+_0x2861c3(0x495,0x494,0x4ec,0x4c7)+_0x2861c3(0x4d0,0x4b1,0x420,0x55d)+'\x20')+_0x473242+(_0x33de9e(0x25,0x2b,0x81,0xc2)+_0x33de9e(0x3e,0xff,0xdf,0x158)+_0x33de9e(0x56,0x24,0xbe,0x9b))+_0x903c9b[_0x33de9e(-0x6c,0x8,-0x65,-0xa8)+'me']+('\x0a-\x20**步数\x20(S'+_0x2861c3(0x5bc,0x513,0x48b,0x57d))+_0x903c9b[_0x33de9e(0x123,0xfc,0x9c,0x1d)]+('\x0a-\x20**CFG\x20S'+'cale:**\x20')+_0x903c9b[_0x33de9e(0x160,0x92,0xd6,0x82)]+(_0x2861c3(0x581,0x51b,0x509,0x56f)+'ize):**\x20')+_0x903c9b[_0x33de9e(-0xf0,0x34,-0x49,-0x41)]+'x'+_0x903c9b[_0x2861c3(0x44f,0x4af,0x462,0x497)]+(_0x2861c3(0x529,0x50e,0x592,0x4b1)+'eed):**\x20')+(_0x26690d[_0x2861c3(0x38e,0x404,0x375,0x3ea)](_0x903c9b[_0x2861c3(0x4a4,0x474,0x3e4,0x484)],-(0x191+0x499+0x13*-0x53))?_0x26690d[_0x2861c3(0x586,0x508,0x593,0x5af)]:_0x903c9b[_0x2861c3(0x3e5,0x474,0x3fc,0x448)])+('\x0a-\x20**模型\x20(M'+_0x2861c3(0x50d,0x4e1,0x528,0x469))+_0x51966e[_0x33de9e(-0xd,-0x28,0x7f,0x16)+'8_model']+(_0x33de9e(-0x7c,-0xaf,-0x50,-0x3e)+'*\x20')+_0x903c9b[_0x2861c3(0x4c2,0x51f,0x584,0x50e)+_0x2861c3(0x57f,0x521,0x4b3,0x4dc)][_0x2861c3(0x3a7,0x43d,0x407,0x4a4)]+('\x0a-\x20**Clip\x20'+'Skip:**\x20')+_0x903c9b[_0x33de9e(0xb3,0xfe,0xde,0x10a)+'ettings'][_0x33de9e(0x73,0x74,0x47,-0x18)+'at_last_la'+_0x2861c3(0x39e,0x432,0x466,0x419)]+(_0x33de9e(0xec,0x3f,0x62,0x56)+_0x33de9e(-0x42,0x28,0xe,-0x6b)+_0x33de9e(-0x20,0xd5,0x8b,0x39))+_0x903c9b[_0x33de9e(-0x8d,-0xa,-0x9,0x75)]+('\x0a-\x20**放大倍率\x20'+'(Upscale\x20F'+_0x2861c3(0x52f,0x4b7,0x55b,0x42a))+_0x903c9b[_0x33de9e(-0x36,0x8e,-0x1,0x3a)]+(_0x2861c3(0x454,0x4c6,0x423,0x503)+_0x33de9e(-0x93,0xa2,0xc,0x38)+_0x33de9e(0x185,0xca,0xdd,0x12a)+':**\x20')+_0x903c9b[_0x2861c3(0x4a5,0x501,0x458,0x543)+_0x33de9e(-0x60,-0xb4,-0x10,-0x7c)]+('\x0a-\x20**脸部修复\x20'+_0x2861c3(0x4b1,0x47c,0x49f,0x3f5)+'aces):**\x20')+_0x903c9b[_0x33de9e(0xc9,0xbd,0x1c,0x99)+'ces']+(_0x2861c3(0x527,0x4c7,0x4d1,0x4b8)+_0x33de9e(0x85,0x8c,0x77,0xa9))+_0x26690d[_0x33de9e(0x33,0x44,0x4e,0xb7)](_0x51966e[_0x33de9e(0x75,-0xa1,-0x2d,-0xc0)+_0x2861c3(0x4b3,0x4ee,0x56c,0x57f)],_0x26690d[_0x2861c3(0x43f,0x4d9,0x488,0x516)])+_0x2861c3(0x3ad,0x40e,0x42e,0x3ee);addLog(_0x1f89c3),_0x26690d['QbMyA'](addLog,'sdwebui生图参'+'数为'+JSON[_0x33de9e(0xbc,-0x30,0x12,-0x6d)](_0x903c9b)),console['log'](_0x26690d['CIbsq'],_0x903c9b);let _0x3be595=!![];while(_0x3be595){if(window[_0x33de9e(0x36,-0xa0,-0x4c,0x59)]){if(_0x26690d[_0x2861c3(0x386,0x3fa,0x3ca,0x3ca)](_0x26690d[_0x33de9e(0x54,-0x68,-0x20,-0x80)],_0x26690d['qwrnN']))_0x3be595=![];else{if(_0x418c8e){const _0x42f74a=_0x5ece66['apply'](_0x2f5981,arguments);return _0x196e25=null,_0x42f74a;}}}else await _0x26690d[_0x2861c3(0x4ca,0x4ac,0x401,0x4cf)](sleep,0x1*-0x14cf+-0x1753+0x1*0x300a);};try{if(_0x26690d[_0x2861c3(0x451,0x41e,0x3dc,0x476)](_0x26690d[_0x2861c3(0x357,0x3f6,0x36f,0x46e)],_0x26690d[_0x33de9e(-0x59,-0x9c,-0x4b,-0xb)])){_0x26690d[_0x2861c3(0x38c,0x41b,0x46c,0x455)](_0x2f8882,_0x26690d[_0x2861c3(0x42f,0x3f0,0x463,0x39d)]),_0x361454[_0x33de9e(0x43,0xa7,0x58,-0x42)](_0x26690d[_0x33de9e(0x10b,-0x1a,0x84,0x103)]);throw new _0x502e2b(_0x33de9e(-0x36,0xdd,0x6d,-0x21));}else{window[_0x2861c3(0x368,0x3f5,0x34b,0x3df)]=!![],taskQueue[_0x33de9e(0x1f,0xfe,0x60,0xc7)+'us'](_0x5b67d4,_0x2861c3(0x465,0x492,0x45f,0x498));if(_0x26690d[_0x33de9e(-0x37,0x5,-0x47,0x2d)](_0x51966e[_0x33de9e(0xbb,-0x8b,0x1d,0x12)],_0x26690d[_0x2861c3(0x403,0x405,0x379,0x40c)])){if(_0x26690d['vSRgc'](_0x26690d[_0x2861c3(0x468,0x44e,0x40c,0x458)],_0x26690d[_0x33de9e(-0xa0,0x57,-0x7,0x2a)])){_0x26690d[_0x2861c3(0x436,0x41b,0x42b,0x410)](_0x4530a5,'获取模型失败:\x20'+_0x3c430f[_0x33de9e(-0x9,0x24,0x8c,0xb7)]+'\x20'+_0x50e9fa['statusText']);throw new _0x23d59f('获取模型失败:\x20'+_0x339c1e[_0x2861c3(0x526,0x4cd,0x4d6,0x4a2)]+'\x20'+_0x430d00['statusText']);}else{if(!taskQueue[_0x33de9e(0xee,0x129,0x8d,0xd2)+'eue'](_0x5b67d4)){addLog(_0x2861c3(0x4ec,0x4a0,0x539,0x511)),eventSource[_0x33de9e(-0x3c,-0x4f,0x58,0x9b)]('sd_stop_ge'+_0x2861c3(0x436,0x486,0x452,0x468));throw new Error(_0x26690d['nlsrQ']);}_0x903c9b[_0x33de9e(-0xc4,-0x9a,-0x73,-0xce)]=_0xe77e06,console[_0x33de9e(0x127,0x159,0xce,0x6b)](_0x33de9e(-0x8e,-0x78,0x16,-0x4c)+_0x2861c3(0x4c3,0x48d,0x40a,0x471)+'load',_0x51966e[_0x2861c3(0x331,0x3db,0x372,0x419)+_0x2861c3(0x552,0x524,0x55e,0x519)]),_0x903c9b['auth']=_0x51966e['st_chatu8_'+'sd_auth']?_0x51966e['st_chatu8_'+'sd_auth']:'';const _0xedcf6f=await _0x26690d[_0x33de9e(0x3,-0x80,-0x25,0x1c)](fetch,_0x26690d['mQvJq'],{'method':_0x26690d[_0x2861c3(0x3d3,0x45f,0x50c,0x410)],'headers':_0x26690d[_0x2861c3(0x488,0x4e9,0x47c,0x58e)](getRequestHeaders,window[_0x33de9e(-0xaa,-0x49,-0x38,-0x18)]),'body':JSON[_0x33de9e(-0x6e,0x24,0x12,0xaf)](_0x903c9b)});if(!_0xedcf6f['ok']){if(_0x26690d[_0x33de9e(0x14,-0x7b,-0x3a,-0x25)](_0x26690d[_0x2861c3(0x3f4,0x3e0,0x3e9,0x38b)],_0x26690d[_0x33de9e(-0x72,-0xfb,-0x61,-0x1)])){const _0x749371=await _0xedcf6f['text']();addLog(_0x2861c3(0x48c,0x490,0x4ba,0x48e)+_0x33de9e(0x46,0x17,0x15,0x0)+_0xedcf6f[_0x33de9e(0x5b,0xe2,0x8c,0x2b)]+_0x2861c3(0x391,0x427,0x49d,0x442)+_0x749371),console[_0x2861c3(0x59a,0x50f,0x58f,0x543)](_0x26690d[_0x33de9e(0x4f,-0x7a,-0x41,-0xd1)],_0x749371);throw new Error(_0x33de9e(0x73,0x146,0xdc,0x10a)+_0xedcf6f['status']+_0x2861c3(0x4a7,0x4c3,0x478,0x505)+_0x749371);}else _0x26690d['UFcGW'](_0xe9ed5a,_0x26690d[_0x33de9e(0xb0,0x81,0xb1,0x75)]),_0x48fc8e=_0x57c148;}const _0x3c2321=await _0xedcf6f[_0x33de9e(0x129,0x53,0xab,0x137)]();let _0x48fcb4='';try{if(_0x26690d[_0x2861c3(0x41a,0x471,0x491,0x50f)](_0x33de9e(-0x7,0x8d,0xa3,0xc4),_0x26690d['HWYUI'])){const _0x18fd34=JSON[_0x2861c3(0x4b2,0x420,0x3ad,0x43d)](_0x3c2321);_0x48fcb4=_0x18fd34[_0x33de9e(-0x91,0x35,-0x64,0x31)][-0x3b*0x2b+-0xe5*-0x18+0x10d*-0xb];}else _0x136200=![];}catch(_0x296fca){_0x26690d['JOSbo'](_0x26690d[_0x33de9e(0x56,0x4f,0x8a,0x42)],_0x26690d[_0x33de9e(0xc1,0x6c,0x41,0x90)])?(_0x26690d[_0x33de9e(0x97,0xe6,0xd8,0xfe)](addLog,_0x26690d[_0x2861c3(0x578,0x4f2,0x55b,0x505)]),_0x48fcb4=_0x3c2321):_0x22d581=_0x26690d['CnZxQ'](_0x26690d[_0x33de9e(0x10f,0x59,0xa2,0x4a)](_0x3de2df,',\x20'),_0x5ec73c[_0x2861c3(0x4fc,0x4c8,0x4a0,0x52d)+_0x5f2a52+_0x33de9e(0x43,0x3f,0xb8,0x11e)]);}const _0x22b363=_0x26690d[_0x33de9e(-0x55,0x4b,-0x8,-0x96)](_0x26690d[_0x2861c3(0x3dc,0x40c,0x486,0x424)],_0x48fcb4);return addLog(_0x26690d[_0x33de9e(-0x2,0x2d,0x1f,-0x4d)]),taskQueue[_0x33de9e(0x56,-0x32,0x0,-0x2d)+'sk'](_0x5b67d4,!![]),currentTaskId=null,{'image':_0x22b363,'change':_0x26690d['gThLU'](_0xe39227,'')};}}else{if(_0x26690d[_0x33de9e(0x1f,0x69,-0x2f,-0x87)](_0x26690d[_0x33de9e(-0x61,-0x9f,-0x4f,0x34)],_0x26690d['LbuSK'])){if(!taskQueue[_0x33de9e(-0x5,0x8f,0x8d,0x5f)+_0x33de9e(-0x84,0x74,0x26,-0x5a)](_0x5b67d4)){_0x26690d[_0x2861c3(0x4f0,0x444,0x49d,0x4be)](addLog,_0x26690d['HAyBZ']);throw new Error(_0x26690d[_0x33de9e(0x55,0x3d,0xcc,0x136)]);}const _0x4fcf23=new URL(_0x26690d[_0x33de9e(-0x66,-0x93,-0x8,-0x59)](_0xe77e06,_0x26690d[_0x33de9e(0x3a,0x1e,0x38,0x14)]));window['xiancheng']=![];const _0x448be2=await _0x26690d[_0x33de9e(-0x1f,-0x2d,0x7c,0x10)](fetch,_0x4fcf23,{'method':_0x33de9e(0x73,0xd2,0xac,0x3),'body':JSON[_0x33de9e(0xae,0x70,0x12,0x5c)](_0x903c9b),'headers':{'Content-Type':_0x26690d[_0x33de9e(0x36,0x143,0xb2,0x7d)],'Authorization':getsdAuth()}});window[_0x2861c3(0x41e,0x3f5,0x469,0x41e)]=!![];if(!_0x448be2['ok']){const _0x50f6ed=await _0x448be2['text']();_0x26690d[_0x33de9e(-0x58,-0x2b,-0x5f,0x33)](addLog,_0x2861c3(0x405,0x3eb,0x366,0x3a0)+'误。状态码:\x20'+_0x448be2['status']+_0x33de9e(-0x1b,-0x29,-0x1a,0x8d)+_0x50f6ed),console['log'](_0x33de9e(0x8f,0x77,0x9d,0xc1),_0x50f6ed);throw new Error('请求失败,状态码:\x20'+_0x448be2[_0x33de9e(0x112,0x2f,0x8c,0xc5)]+_0x33de9e(0x42,0xda,0x82,0x10f)+_0x50f6ed);}const _0x475f22=await _0x448be2[_0x33de9e(0xec,0xc1,0xd1,0x14c)]();if(!_0x475f22[_0x33de9e(-0xed,-0xbd,-0x64,-0x7d)]||_0x26690d[_0x2861c3(0x4cb,0x4fe,0x4a7,0x461)](_0x475f22[_0x2861c3(0x374,0x3dd,0x341,0x432)][_0x2861c3(0x4d8,0x50a,0x593,0x495)],-0x2*0x11de+-0x12f2+0x36ae)){if(_0x26690d[_0x33de9e(0x1c,-0x6c,-0xe,0x7c)](_0x26690d[_0x33de9e(0x16,0x6f,-0x14,0x1e)],'tYajW'))_0x278441['on'](_0xfe9cd7['GENERATE_I'+_0x33de9e(0x103,0xb3,0xc3,0x40)+'ST'],_0xa8bc8a),_0x26690d[_0x33de9e(0x19,0x6c,0xbf,0xb6)](_0x4a8983,_0x26690d[_0x2861c3(0x51d,0x4d8,0x438,0x49f)]);else throw new Error(_0x2861c3(0x56c,0x518,0x5c1,0x493)+_0x2861c3(0x466,0x461,0x42e,0x46f));}const _0x50b7d5=_0x475f22[_0x33de9e(-0x73,-0x69,-0x64,-0x110)][0x7b*-0x18+0xe*-0x22c+0x29f0],_0x3ffb10=_0x26690d[_0x2861c3(0x3bf,0x45b,0x4b3,0x3be)](_0x2861c3(0x510,0x4bf,0x49a,0x4ce)+_0x33de9e(0x5e,-0x42,0x6,0x6f)+'4,',_0x50b7d5);addLog(_0x33de9e(-0x60,0xb1,0x3a,0x5c)+_0x2861c3(0x493,0x4f4,0x4fe,0x4ab)+'L。'),taskQueue['completeTa'+'sk'](_0x5b67d4,!![]),currentTaskId=null;const _0x15f7f7={};return _0x15f7f7['image']=_0x3ffb10,_0x15f7f7[_0x33de9e(-0x3b,0x95,0xa,0x28)]=_0x3a856e||'',_0x15f7f7;}else{_0x26690d['YGQGD'](_0x335417,_0x26690d[_0x2861c3(0x3b9,0x422,0x477,0x46c)]),_0x42a3e4=_0x405ebf(_0x24caad),_0x212b8b=_0x4125bb[_0x33de9e(0x4a,0x62,0xe1,0xa5)+_0x2861c3(0x472,0x3ef,0x481,0x3b8)];for(let _0x172848=-0xed2+-0x3*0x4f6+-0x3*-0x9e7;_0x26690d['IQfeK'](_0x172848,0xb09+0x1*-0x1979+0xe74);_0x172848++){_0xb01b4['Character\x20'+_0x172848+_0x2861c3(0x563,0x4f9,0x454,0x4a4)]&&(_0x399c18=_0x26690d[_0x2861c3(0x4c7,0x489,0x4f8,0x4f5)](_0x38cb2b,',\x20')+_0x4b3a4d['Character\x20'+_0x172848+_0x2861c3(0x475,0x4f9,0x4a4,0x493)]);}}}}}catch(_0x23531d){const _0x357b2e=_0x26690d[_0x2861c3(0x381,0x3ed,0x368,0x46c)][_0x2861c3(0x4ef,0x4fa,0x4fb,0x5a1)]('|');let _0x328b3a=-0x12a5+0x8*-0x3f1+0x322d;while(!![]){switch(_0x357b2e[_0x328b3a++]){case'0':console[_0x2861c3(0x56b,0x4f7,0x4c7,0x4c7)](_0x26690d[_0x33de9e(-0xb8,-0x35,-0x43,0x55)],_0x23531d);continue;case'1':if(_0x26690d[_0x33de9e(0xdd,0x5a,0x35,-0x73)](_0x23531d[_0x2861c3(0x42b,0x3e1,0x3f4,0x444)],_0x26690d[_0x2861c3(0x5a3,0x50d,0x498,0x586)])){}else taskQueue[_0x2861c3(0x3b1,0x441,0x491,0x4ad)+'sk'](_0x5b67d4,![]);continue;case'2':window[_0x33de9e(0x34,-0xde,-0x4c,-0x2f)]=!![];continue;case'3':throw _0x23531d;continue;case'4':_0x26690d[_0x2861c3(0x473,0x3d4,0x476,0x47d)](addLog,_0x33de9e(-0x25,-0xd3,-0x5a,0x52)+_0x23531d['message']);continue;case'5':currentTaskId=null;continue;}break;}}}async function sdGenerate(_0x33b0de){const _0x1bd36b={'qnapU':function(_0x35eecf,_0x248af3){return _0x35eecf(_0x248af3);},'FLxCH':function(_0x1aa46c,_0x2a9cff){return _0x1aa46c===_0x2a9cff;},'keZPf':_0x136d00(0x35a,0x343,0x399,0x382),'XXBoS':function(_0x2d7ffc,_0x4ad5f3){return _0x2d7ffc(_0x4ad5f3);},'MbfDf':function(_0x2e0795,_0x792be3){return _0x2e0795!=_0x792be3;},'WQBHS':function(_0x3415bd,_0x36f151,_0x3ffa66,_0x1696bc){return _0x3415bd(_0x36f151,_0x3ffa66,_0x1696bc);},'RpAVU':function(_0x2ccc5e,_0x479f12){return _0x2ccc5e(_0x479f12);},'vCDIL':'Error\x20gene'+_0x136d00(0x2ed,0x2a7,0x32f,0x29d)+_0x136d00(0x29d,0x333,0x2c8,0x2e7),'vlATI':function(_0x250a12,_0x30e567){return _0x250a12(_0x30e567);}};function _0x4467d8(_0x360f74,_0x1b2f79,_0x3ffcac,_0x483282){return _0x139e(_0x483282-0x378,_0x3ffcac);}const {id:_0xa4a12b,prompt:_0x3edd4b,width:_0x224f8c,height:_0x342d45,change:_0x186f5b}=_0x33b0de;_0x1bd36b[_0x136d00(0x2a6,0x312,0x28c,0x37d)](addLog,_0x4467d8(0x52d,0x4fb,0x559,0x566)+_0x4467d8(0x45b,0x4dd,0x50e,0x4b0)+_0xa4a12b+(_0x4467d8(0x4a1,0x50a,0x581,0x534)+':\x20')+_0x3edd4b+(_0x186f5b?_0x136d00(0x340,0x3c3,0x39a,0x365)+'\x20'+_0x186f5b:''));function _0x136d00(_0x2d4f03,_0x26757d,_0x3cb706,_0x4d1dd9){return _0x139e(_0x26757d-0x1e9,_0x2d4f03);}if(_0x186f5b&&_0x186f5b[_0x136d00(0x35d,0x346,0x2e0,0x349)](_0x136d00(0x30a,0x2ec,0x318,0x25c))){if(_0x1bd36b[_0x136d00(0x36c,0x323,0x2c6,0x371)]('geBgV',_0x1bd36b['keZPf'])){_0x1bd36b[_0x4467d8(0x3c9,0x46d,0x3eb,0x450)](bananaGenerate,_0x33b0de);return;}else _0x49d4e2['completeTa'+'sk'](_0x439d66,![]);}try{const {image:_0x1bfbcb,change:_0xe5392a}=await _0x1bd36b[_0x136d00(0x2cc,0x312,0x2c7,0x333)](generateSDImage,{'prompt':_0x3edd4b,'width':_0x224f8c,'height':_0x342d45,'change':_0x186f5b});if(_0x1bd36b[_0x4467d8(0x581,0x46f,0x51f,0x4d4)](extension_settings[extensionName]['cache'],'0')){const _0x2bb5a8={};_0x2bb5a8[_0x136d00(0x2c9,0x326,0x307,0x3b1)]=_0xe5392a,await _0x1bd36b[_0x4467d8(0x4a6,0x504,0x4e8,0x4a8)](setItemImg,_0x3edd4b,_0x1bfbcb,_0x2bb5a8),_0x1bd36b[_0x136d00(0x21c,0x2c1,0x269,0x300)](addLog,_0x136d00(0x437,0x3d0,0x3da,0x401)+_0x136d00(0x3c9,0x3b1,0x3fb,0x334)+'\x20'+_0x3edd4b);}else _0x1bd36b[_0x136d00(0x288,0x312,0x3b8,0x2cd)](addLog,_0x136d00(0x212,0x2b4,0x357,0x311)+'库');const _0x446936={};_0x446936['id']=_0xa4a12b,_0x446936[_0x136d00(0x30d,0x32c,0x292,0x340)]=!![],_0x446936[_0x4467d8(0x4ec,0x493,0x535,0x4ac)]=_0x1bfbcb,_0x446936[_0x136d00(0x306,0x33e,0x38c,0x399)]=_0x3edd4b,_0x446936[_0x4467d8(0x4d6,0x546,0x562,0x4b5)]=_0xe5392a,eventSource[_0x136d00(0x331,0x374,0x2d5,0x31b)](EventType[_0x136d00(0x34f,0x2ce,0x356,0x344)+_0x4467d8(0x574,0x5a8,0x539,0x56c)+_0x4467d8(0x551,0x4a9,0x4a0,0x4bc)],_0x446936),_0x1bd36b[_0x4467d8(0x449,0x4db,0x4c6,0x4a1)](addLog,_0x4467d8(0x560,0x4cb,0x535,0x517)+_0x4467d8(0x448,0x434,0x472,0x441)+_0xa4a12b+')');}catch(_0x5e1f40){const _0x50a54f=_0x136d00(0x375,0x350,0x36f,0x39e)+_0x136d00(0x2f6,0x2ad,0x330,0x293)+_0xa4a12b+_0x136d00(0x317,0x2dd,0x387,0x316)+_0x5e1f40[_0x4467d8(0x3f4,0x408,0x4ed,0x44b)];_0x1bd36b['RpAVU'](addLog,_0x136d00(0x2ae,0x2e6,0x286,0x297)+_0x50a54f),console[_0x4467d8(0x5fd,0x4ee,0x531,0x561)](_0x1bd36b[_0x136d00(0x2a1,0x30b,0x2ca,0x35d)],_0x5e1f40);const _0x1e23b5={};_0x1e23b5['id']=_0xa4a12b,_0x1e23b5['success']=![],_0x1e23b5[_0x136d00(0x333,0x3d2,0x393,0x361)]=_0x5e1f40[_0x136d00(0x33f,0x2bc,0x25e,0x21c)],_0x1e23b5[_0x4467d8(0x44e,0x46d,0x53a,0x4cd)]=_0x3edd4b,eventSource[_0x136d00(0x355,0x374,0x329,0x3bb)](EventType[_0x136d00(0x353,0x2ce,0x328,0x29e)+'MAGE_RESPO'+'NSE'],_0x1e23b5),_0x1bd36b[_0x4467d8(0x473,0x4ce,0x453,0x4eb)](addLog,_0x136d00(0x396,0x305,0x357,0x34e)+_0x4467d8(0x423,0x4e2,0x3d5,0x441)+_0xa4a12b+')');}}function initializeSDListener(){const _0x53c7a1={'GSNjw':function(_0x1f7753,_0x8eeafa){return _0x1f7753(_0x8eeafa);},'GISIh':_0x3618b0(-0x18,0x2d,0x3f,0x4e)+_0x3618b0(0x6,0x8b,0x66,0xe0)};eventSource['on'](EventType[_0x3ee248(-0x243,-0x2a3,-0x22d,-0x292)+'MAGE_REQUE'+'ST'],sdGenerate);function _0x3ee248(_0x275e2a,_0x34a7b5,_0x2b321e,_0x139317){return _0x139e(_0x275e2a- -0x328,_0x2b321e);}function _0x3618b0(_0x2112a6,_0x3114c2,_0x5a7c83,_0x4ebcc1){return _0x139e(_0x3114c2- -0xd4,_0x4ebcc1);}_0x53c7a1['GSNjw'](addLog,_0x53c7a1['GISIh']);}export async function replaceWithSd(){function _0x4d6981(_0x462434,_0x52cc75,_0x3fc7c7,_0x4978d7){return _0x139e(_0x3fc7c7- -0x2a5,_0x4978d7);}const _0x14a8b6={'KzHWU':function(_0x12f143,_0x193dcf){return _0x12f143(_0x193dcf);},'qVgnh':_0x4d6981(-0x165,-0x18a,-0x113,-0x15b),'gcHox':_0x1d5cd5(0x1f,0x82,0xc,0x24),'tDaWd':function(_0x5138bb,_0x338a22){return _0x5138bb===_0x338a22;},'tWXMR':_0x1d5cd5(0x89,-0x50,0x1c,0x29),'Hkkao':function(_0x2e09d2){return _0x2e09d2();},'AdfdR':function(_0x29a0f1,_0x267b5b){return _0x29a0f1(_0x267b5b);},'AVjYv':_0x1d5cd5(-0xf5,0x23,-0x36,-0x7b)+_0x4d6981(-0x232,-0x240,-0x1de,-0x174)};function _0x1d5cd5(_0x2a708e,_0x3403ba,_0x202fa2,_0x7abd02){return _0x139e(_0x7abd02- -0x17c,_0x2a708e);}if(extension_settings[extensionName]['mode']=='sd'){if(_0x14a8b6[_0x1d5cd5(-0x16,-0x39,-0x5b,-0x1a)](_0x14a8b6[_0x1d5cd5(0xd4,0x5,0x23,0x90)],_0x14a8b6[_0x1d5cd5(0xee,0x115,0xa0,0x90)]))!window[_0x4d6981(-0x139,-0x1ef,-0x1e2,-0x1ff)+_0x4d6981(-0xf3,-0x189,-0x13c,-0xdb)]&&(window[_0x4d6981(-0x157,-0x155,-0x1e2,-0x136)+_0x1d5cd5(0x5a,0x9,-0xb0,-0x13)]=!![],initializeSDListener()),_0x14a8b6['Hkkao'](initializeImageProcessing);else{_0x14a8b6['KzHWU'](_0x14b939,_0x14a8b6[_0x1d5cd5(-0xdc,-0x62,-0x3d,-0x4b)]);throw new _0x17193a(_0x14a8b6[_0x4d6981(-0x13e,-0x1f4,-0x16a,-0x14d)]);}}else window[_0x1d5cd5(-0x85,-0x4d,-0x8d,-0xb9)+_0x4d6981(-0x19a,-0x19e,-0x13c,-0x1e7)]&&(eventSource[_0x1d5cd5(-0x6d,-0x66,0x80,0x26)+'ener'](EventType[_0x4d6981(-0x235,-0x266,-0x1c0,-0x1f8)+_0x4d6981(-0x5f,-0xb2,-0xaf,-0xd1)+'ST'],sdGenerate),window[_0x4d6981(-0x214,-0x22e,-0x1e2,-0x1a2)+_0x4d6981(-0x151,-0x1e1,-0x13c,-0xed)]=![],_0x14a8b6[_0x4d6981(-0x4b,-0xae,-0xd4,-0x10c)](addLog,_0x14a8b6[_0x1d5cd5(-0x16,0x8b,0x90,0x1c)]));}