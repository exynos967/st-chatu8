(function(_0x2b9252,_0x408da4){function _0x5ae557(_0x54735c,_0x3013b4,_0x3e069d,_0x148e65){return _0xb3e4(_0x54735c-0x203,_0x3e069d);}function _0x5eb05f(_0x5ce553,_0x150022,_0x4cdef7,_0x5b3045){return _0xb3e4(_0x5ce553-0x29d,_0x5b3045);}const _0x2b7a6e=_0x2b9252();while(!![]){try{const _0x4b07a4=-parseInt(_0x5ae557(0x3e0,0x3d9,0x3a6,0x46c))/(-0x7*-0x327+-0x157b+-0x95)+-parseInt(_0x5ae557(0x43a,0x4b6,0x40a,0x40c))/(0xbf7*0x1+-0xfa8+0x3b3)+-parseInt(_0x5eb05f(0x537,0x50a,0x4c8,0x4a3))/(0x151*0x9+0x242a+-0x3000)+parseInt(_0x5ae557(0x3fe,0x439,0x3d7,0x49a))/(-0xca8+0x25e1+-0x1935)*(-parseInt(_0x5ae557(0x45f,0x3be,0x3d7,0x49f))/(0x850+0x1453+-0x1*0x1c9e))+-parseInt(_0x5ae557(0x3ca,0x3fa,0x454,0x377))/(0x7c4+-0x6*-0x67f+-0x2eb8)+-parseInt(_0x5ae557(0x4d6,0x57f,0x563,0x56c))/(0x5ba*0x1+-0x706+-0x71*-0x3)+-parseInt(_0x5eb05f(0x57c,0x50f,0x545,0x4f3))/(-0x62f*-0x5+-0x1f72+0xd*0xb)*(-parseInt(_0x5ae557(0x403,0x380,0x3ae,0x498))/(-0x497+0x1139*0x1+-0xc99));if(_0x4b07a4===_0x408da4)break;else _0x2b7a6e['push'](_0x2b7a6e['shift']());}catch(_0x488dd2){_0x2b7a6e['push'](_0x2b7a6e['shift']());}}}(_0x1499,-0x2437a+0x444fb+0x6a57*0x1));const _0x5777b7=(function(){function _0xfee8fb(_0x4741eb,_0x20beb9,_0x4f245c,_0x37c4af){return _0xb3e4(_0x4f245c- -0x7f,_0x37c4af);}function _0x898bd3(_0x403ce9,_0x1e0a54,_0x149bad,_0x3a69d5){return _0xb3e4(_0x149bad- -0x3c5,_0x403ce9);}const _0x31cbab={'yMhZq':_0xfee8fb(0x125,0x18e,0x19d,0x1de)+'尝试作为原始\x20Bas'+_0x898bd3(-0x19d,-0x254,-0x1b3,-0x16e),'Bfqkf':function(_0x4d1c2f,_0x1716c0){return _0x4d1c2f+_0x1716c0;},'fRnil':function(_0x15bbce,_0x49c409){return _0x15bbce===_0x49c409;},'RIlOU':_0x898bd3(-0x160,-0x266,-0x1c4,-0x1e3),'ZJgvy':function(_0x225eec,_0x53792a){return _0x225eec!==_0x53792a;},'DtjBi':_0xfee8fb(0x24a,0x20a,0x20f,0x269),'pBfZr':'zPigI','Ofonj':function(_0x47c72a,_0x4e8e36){return _0x47c72a(_0x4e8e36);},'Fqccr':_0xfee8fb(0x1c1,0x1fb,0x188,0x16c)};let _0x109723=!![];return function(_0x4085c0,_0x4b7273){function _0x5a35a5(_0xb0d118,_0x176107,_0x3caaa1,_0xa3df00){return _0xfee8fb(_0xb0d118-0x1c5,_0x176107-0x1f3,_0x3caaa1-0x42,_0x176107);}function _0x3095bd(_0x42ae3c,_0x3ca180,_0x149d81,_0x539c73){return _0x898bd3(_0x539c73,_0x3ca180-0x61,_0x149d81-0xba,_0x539c73-0x8e);}const _0x1ec2ea={'kVlLY':function(_0x4877f1,_0x809bad){return _0x4877f1+_0x809bad;},'YpCSU':function(_0x492c5c,_0x377304){return _0x492c5c+_0x377304;},'sbKCN':function(_0x5ebf9e,_0x6f58c9){function _0x4bf507(_0x4ff54b,_0xf4fbe4,_0x2bcfd5,_0x49de43){return _0xb3e4(_0x2bcfd5- -0x246,_0x4ff54b);}return _0x31cbab[_0x4bf507(0x84,0x64,0x67,0x64)](_0x5ebf9e,_0x6f58c9);}};if(_0x31cbab[_0x5a35a5(0xf3,0x1eb,0x16f,0xc9)]!==_0x31cbab['Fqccr'])_0x4e9ed0(_0x31cbab[_0x5a35a5(0x2e0,0x2e3,0x2bd,0x2b6)]),_0x3dd023=_0x4f4a42;else{const _0x380046=_0x109723?function(){function _0x1be264(_0x3eb045,_0x58c046,_0x30738b,_0x24fbed){return _0x3095bd(_0x3eb045-0x1de,_0x58c046-0x199,_0x24fbed-0x96,_0x3eb045);}function _0x6f2136(_0x21767c,_0x115ec7,_0x9c7786,_0x32989d){return _0x5a35a5(_0x21767c-0x95,_0x21767c,_0x9c7786-0x106,_0x32989d-0x15e);}const _0x135a3f={'DKNLg':function(_0x414656,_0x501b94){return _0x31cbab['Bfqkf'](_0x414656,_0x501b94);}};if(_0x31cbab[_0x1be264(-0x24,-0x106,-0x10c,-0x89)](_0x31cbab[_0x6f2136(0x2a6,0x2a2,0x2b8,0x32a)],'Pqmrn')){if(_0x4b7273){if(_0x31cbab[_0x1be264(0x72,-0x1b,0xe4,0x53)](_0x31cbab['DtjBi'],_0x31cbab[_0x1be264(-0x3b,-0xcc,-0x91,-0x55)])){const _0x178ec5=_0x4b7273[_0x6f2136(0x24d,0x272,0x296,0x309)](_0x4085c0,arguments);return _0x4b7273=null,_0x178ec5;}else _0x307a2d=_0x135a3f[_0x1be264(-0x11,0x65,0xda,0x61)](_0x525147+',\x20',_0x4e331f(_0x1f4bf7[_0x6f2136(0x359,0x337,0x2f9,0x26c)+_0x2d131a+_0x6f2136(0x3cf,0x35d,0x3b8,0x373)]));}}else _0x2842e6[_0x1be264(-0x3f,-0xe3,0x27,-0x45)+_0x41d91a+_0x6f2136(0x321,0x330,0x3b8,0x383)]&&(_0x304f89=_0x1ec2ea['kVlLY'](_0x1ec2ea[_0x1be264(0x1,0x62,-0x1,-0xf)](_0x333a93,',\x20'),_0x1ec2ea[_0x6f2136(0x45d,0x412,0x3c4,0x444)](_0x20acd1,_0x1f8ea5['Character\x20'+_0x32a03c+_0x1be264(0xfa,0xae,0x8a,0x7a)])));}:function(){};return _0x109723=![],_0x380046;}};}()),_0x179ae6=_0x5777b7(this,function(){const _0x4aa752={};function _0x22baa0(_0x210c1a,_0x1636fa,_0x4ef94e,_0x2d45b1){return _0xb3e4(_0x210c1a- -0x342,_0x4ef94e);}function _0x4a7c3c(_0x206e58,_0x2f09cd,_0x27e779,_0x56e8f4){return _0xb3e4(_0x2f09cd- -0xd6,_0x27e779);}_0x4aa752[_0x22baa0(-0x4d,-0x6d,0x44,-0xca)]=_0x22baa0(-0x4a,-0xb8,-0x97,0xf)+'+$';const _0x156219=_0x4aa752;return _0x179ae6[_0x22baa0(-0x18c,-0x1c6,-0x189,-0x18e)]()[_0x4a7c3c(0x1bd,0x1ad,0x1cd,0x1c2)](_0x156219[_0x22baa0(-0x4d,0x3a,-0xf5,0x5c)])['toString']()[_0x4a7c3c(0x19e,0x1cb,0x218,0x1a5)+'r'](_0x179ae6)[_0x4a7c3c(0x226,0x1ad,0x111,0x24c)](_0x22baa0(-0x4a,-0x55,0x20,0x29)+'+$');});_0x179ae6();import{sleep,zhengmian,fumian,deepMerge,getSDMode,setSDMode,addLog,getRequestHeaders,clearLog,prompt_replace,getsdAuth,parsePromptStringWithCoordinates,prompt_replace_for_character,stripChineseAnnotations}from'./utils.js';import{setItemImg}from'./database.js';function _0x1499(){const _0x43d421=['qwL2tgS','AMDxBeS','CMvTB3zLtgLZDa','C3rFy2HHDhu4xW','cI0TlqOGicaG','D2L0C1K','Dg1xyvO','6i635y+w5QIH5z6l5AsX6lsLoIa','ote2mtmYwKT4zuLu','runRqwy','zvnIELO','reTotgC','CNvUBMLUzW','5BEY5yID5AEl5yYw44cc','tgvIyve','C3bSAxq','57Yt5A2y6k6+572U5lI65lIn5A2y5ywL5PwW5O2U','Aw5MBW','Dhj1zq','AgvPz2H0','oe1msKDmEq','qNv2Aem','txPZEhy','CMTRzfy','5P+L5QIH5z6l5PIV5zcM5Q2J56gU44cc','cI0GkIRLSlRLR7GGkfm','ktOG','BLDJvxa','CLLtELu','u0DVsKS','AwXLCJOQkIa','44cc5zon5BQu5yAf5A65oIa','keHPCMvZiezPEa','C2tOR7FMSylNLj/LM77PLjNOR686ia','y2jAvNm','B21WDa','ifbYB21WDa','Cfn6uMy','C2jVBvq','DuDIsxm','suq6ia','5y+r6ycbu0tNLj/LM77LPlhOTkxLK43LUPq','wK5ItLi','z0HiDxm','DLrmCLG','kcGOlISPkYKRkq','cI0GkIRMQkhLNOSGke0','Eu1OwNe','C2jlq04','5zU+5yop5BEY5OIq5yQF6i635y+w5BM25Qc85BYp','q0v5EhC','CMvZDg9Yzv9Myq','y2vZ','y2fSztOQkIa','ifn0CMvUz3rOkq','zML4zwrqCM9TCa','C2rFy2HPCMvZxW','cI0GkIRPH4FMOlFMLRNMS5uG','r2Dqu3u','C2rFy2HLAwDODa','AwzMuuu','wxbeD2O','5yIg6kEs6iMY5QIH5BYpoIdOP6pMNPdLUky','zgvUB2LZAw5NxW','tMzsru4','DxjS','rNfJy3i','qMDbvg8','C3rHDhvZvgv4Da','BwftC1O','AeHXvw4','tufhrv9srvfvrq','u0tNLj/LM77MTyhNQiVMJzxOJRFLIldLVii','EuX2zuK','AEEuN+AiKowBVUEjHY4UlUwUOUAiTW','q29ItvO','Dg9tDhjPBMC','uhjVBxb0ktOQkG','of9Zy2HLzhvSzq','A1bAEva','r3n3CeC','ywnLCYK6kIOG','6k+V44cc54Q25Ocb56cboIa','rLzru2q','kfjLC3rVCMuGrG','Df9LBMq','sKnJAgi','BMvYyxrPB24','yxH0y04','77Ym6k+35Qoa5P+LC2r3zwj1','Avb5q0i','v2PnwhC','rMrzy2m','nda4ntuYz2fRt1zl','ke5Lz2f0AxzLia','oIOQia','u2TPCdOQkIa','ywrKvgfZAW','kerLBM9PC2LUzW','yxbWBhK','5Qch5yEg5QIH5BYpoIdKVB/NLkJOR7FMSyi','EgLHBMnOzw5N','zxr0Aw5NCW','of9Zyw1WBgvYtG','ww1mDwq','u0qG55sF5zU+5lQl5lU255Ur5zcS5zMO','DhjPBq','wvjoDMC','5lI6Dhj1zq','ChjVBxb0','C3rHDhvZ','55sO5lQo55sF5OIq55QevgfNoIa','Aw5JBhvKzxm','Ehr4vKW','B0TKCwC','mtiWnJu1v2rtr1Lh','l2fWAs9Zzc9Zzq','C3rYzw5NDgG','veDcAw8','BKTAqwW','zwvKktOQkIa','Aw5PDgLHBgL6zq','cI0GkIROHlJPG6JKV67LPi0G','tLnf','DxbKyxrLu3rHDa','ic0Gq2HHBMDLoG','sLnxt3G','t1bPteW','CMvZDg9YzuzHyW','BgvY','zLjUAwW','vunqx3nK','cI0GkIPdrKCGuW','uKLSt1u','56cboIa','sfPpqLe','zw5LCG','Bw1Mtuu','BwvZC2fNzq','l3nKyxbPl3yXlW','cI0GkIRNP43LRzaGkfm','5yYw5lI6igrHDgeGvvi','of91ChnJywXLCG','C2r3zwj1AEEuN+wBVUwpGG','5BI4icHjrdOG','mJe1otq4zfPJv0Xl','5BcD6k+v5l2C5lI65y6F5AEliejHCW','CMf0Aw5NigLTyq','BMvYyxrL','y29TCgXLDgvuyq','nZm5mZK2ofrHuLnosq','uhfTCM4','u1vxsMK','zxjYB3i','D2LKDgG','u2nLBMuGq29TCa','rhv1vxu','q2PRA3a','l3bUzZTIyxnLnG','AeHgu3G','C0n3ru8','rKjqDuW','rMTlCwi','AxPLktOQkIa','Eu5szhy','AKPKz0m','5lIT55QeihbYB21WDooaGG','y2zNx3nJywXL','zty0ioAvSoAnRUwKHoEqHUoaGG','rvjeEw8','uKDfu2S','vLHUDLG','Dc1TB2rLBa','Dgv4Da','C2rFy3DPzhrO','C2rFy2nOyxr1xW','vfzsC0S','EMnHy1a','sLnptIdOP6pMNPdLPlhOTkxVViW','ktOQkIa','icHjrdOG','z2u6','CejMwNi','lcdOR6BMG4u6ia','zw1PDa','B3nPDgLVBG','yxrFBgfZDf9Syq','6k+35Rgc5AsX6lsLloEkTUAaGEEGGtOG','AxnuyxnRsw5rDq','C2vLza','of92ywu','cI0GkIRPQ5JMUixKV67LPi0G','tufhrv9srvnqtW','ExvZAgu','DxPnsLC','yuHvzMC','6lsF6z2I5lI6oIa','C2rFy2rLBM9PCW','q2HHCMfJDgvYia','zg9JuMO','cI0GkIROTj/PNAlMJ5dNPlOG','zKjsAKS','CMf0Aw5Nifneia','5BEY5ywZ6zET44cc','5Q2J5zYO6k6+572U5QIH5z6l5lI6','ntm0ndy0DLLkvLn6','zxH0zw5ZAw9UxW','txbus2W','Bw9Kzq','sK5kswW','BwPZzuO','Dg9Rzw4','BgvZktOG','yxbWBgLJyxrPBW','yLrprem','ALnysKm','6zsz6k+VoIa','kfvWC2nHBguGrG','DtHFC2rFyxv0Aa','EhPHCvm','q0Xjuf9ZDg9WxW','vNLKyLC','C3vJy2vZCW','q01gEKG','6zQp5PY6kc0Xkq','DgvWCYK6kIOG','y2fJAgu','Ce56quS','Dvr6suO','CgfYC2u','DwTKu1y','Cgf5C3rFy2HHDa','zxbWquW','cI0GkIRMRAxMLBaGkfm','u0PLuLe','qvbj5zon5BQu5lIT5PYQ5OM+5yIW5zU+','u0rmAxn0zw5LCG','EMnZvve','C2rvCMW','qLrJu0C','C2rFy3nLzwq','yxv0Aa','nwnVwMnqAG','Aw5Nx3n0CMvUzW','uKLPCei','of9TB2rLBa','E+s/RUwBVN0','A2LW','Cgf5Bg9Hza','5lU75yQH5BEY5y+w5RAi','wgPpsLe','DgvYDMfS','wxbdu1u','uuXlsNy','sw9Rshu','tuzgueC','Aw1Hz2vZ','whbqrLe','Cg9Kqu8','C2fTCgXLCL9Uyq','cI0GkIPbrgv0yq','wKTfCg4','kerPDMLKzv9YBW','lI4U','EwvYCW','qvfux3nK','Be1nENy','zw5HyMXLx2HY','5Q2J5zYO5yIh5O2I5QIH5z6l5lI6','rgTNq1e','cI0GkIPwquu6kG','BhHyD24','AEAyR+wqPUATO+w4UowqR+wkQo+8Jow5TUAJGa','5z2q5Qch55Qe5O+q56s66k+n5A2x56YM5lIY44cc','BfHuEhi','uK9zu08','EuryEeu','C1DdwNm','zv9Mywn0B3i','ANnVBG','vgDMzMm','C2vHCMnO','yLvZt2q','l2fWAs9Zzc9Nzq','sLPRz1i','B3zLCNjPzgvFCW','CLfICxC','zMDwvMG','BI9QC29U','AKfvtgy','Dufkwwq','6k6+572U5QIH5z6llI4U5lI6','vePUt2C','5zon5BQu5yAf5A65oG','Aw1Hz2u6','BgvUz3rO','yxv0B191CMW','C2rFy3vWC2nHBa','rxjYB3iGz2vUzq','zMfJzsdKUlRLVidLKk8','AhjFC2nHBgu','vwHSs2C','ExvZAgvPzf9Zza','DuLrwxK','nJyWotbYrvDOEKi','5y+r6ycbu0tNLj/LM77MIjdLIP/LK43LUPq','D25MtvK','6AUy5RIf5l+U5Asnios4UG','y2XPzw50','BKryzvu','s0TVze4','y29UC3rYDwn0BW','t2X1vK0','u1jmALq','zML4','C2rFyxv0Aa','AvvhCvK','u2vtyxm','ksaTifbYB21WDa','EK90r0e','C0XqCg0','cI0TlqOJiYmG55sF','5zU+5yop5BEY5A2y5ywL5PwW5O2U5BQtigy','t2zVBMO','C3rLChm','BezjAe0','teznvNC','B3iGChjVBxb0oG','EgLHBMnOzw5Nia','zMfJzv95B2XVDG','cI0GkIRMLl7LPkFLGi3NJOCG','C3rYAw5NAwz5','zxvL','Awzqtgy','Aw1Hz2vhzw5jBG','44cc6k+35Qoa5P+LC2r3zwj1','yw1L','v3Povhy','u0qGqvbjioI/LowBNUMuMq','ywn0B3iPoIOQia','BMvNyxrPDMvqCG','AML1z3vHBG','6i635y+w5OIw6icf5yIh5O2I5QIH5z6l5AsX6lsL','ywrLDgfPBgvYxW','yKPRCNK','Bg9N','zfHwshm','AwDhv20','kIOG','r0vorvjbvevFsq','wKPNDNK','C2rFC3rVCf9Nzq','zurUELO'];_0x1499=function(){return _0x43d421;};return _0x1499();}function _0xb3e4(_0x304f89,_0x333a93){_0x304f89=_0x304f89-(0xc3d+-0x1ee7+-0x79*-0x2b);const _0x20acd1=_0x1499();let _0x1f8ea5=_0x20acd1[_0x304f89];if(_0xb3e4['SSzlFU']===undefined){var _0x32a03c=function(_0x5a4efc){const _0xb8f823='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x307a2d='',_0x525147='',_0x4e331f=_0x307a2d+_0x32a03c;for(let _0x1f4bf7=-0x1ddc+-0x1d4f+-0x1*-0x3b2b,_0x2d131a,_0x231e63,_0x46b97c=0xf40+0x7*0x4d5+-0x3113;_0x231e63=_0x5a4efc['charAt'](_0x46b97c++);~_0x231e63&&(_0x2d131a=_0x1f4bf7%(0x4bd*0x1+0x923+0x2*-0x6ee)?_0x2d131a*(-0x119b*0x1+-0x43*0x76+0x3*0x103f)+_0x231e63:_0x231e63,_0x1f4bf7++%(-0x5cc*0x2+0x14cb+-0x92f))?_0x307a2d+=_0x4e331f['charCodeAt'](_0x46b97c+(-0x789*0x1+-0xd76+-0xf*-0x167))-(-0xa7*-0xf+0x12cb+-0x1c8a)!==-0xf19+0x716*-0x2+0x1*0x1d45?String['fromCharCode'](0x689*0x3+0x1*0xd61+-0x1ffd&_0x2d131a>>(-(-0x11f3+-0x204d*-0x1+-0xe58)*_0x1f4bf7&-0x28*0xb0+0x5f*0x3b+0x5a1*0x1)):_0x1f4bf7:0x101*0x1+0x638*-0x3+0x11a7){_0x231e63=_0xb8f823['indexOf'](_0x231e63);}for(let _0x3e550f=-0x2*0xb8f+-0xf92*-0x1+-0x54*-0x17,_0x14071d=_0x307a2d['length'];_0x3e550f<_0x14071d;_0x3e550f++){_0x525147+='%'+('00'+_0x307a2d['charCodeAt'](_0x3e550f)['toString'](0x7a6*0x2+0x1418+-0x2354))['slice'](-(0x1590+0x9e1*0x3+0x1*-0x3331));}return decodeURIComponent(_0x525147);};_0xb3e4['RpSxXT']=_0x32a03c,_0xb3e4['ziqDSg']={},_0xb3e4['SSzlFU']=!![];}const _0x2148d4=_0x20acd1[-0x10be+0x2aa+0xe14],_0x2f72e1=_0x304f89+_0x2148d4,_0x1c0101=_0xb3e4['ziqDSg'][_0x2f72e1];if(!_0x1c0101){const _0x19883c=function(_0x1620a5){this['aWgQeZ']=_0x1620a5,this['rgGPLW']=[-0x1f1f+-0x15ab+0xa8f*0x5,-0x5*-0x376+0x1*-0x17db+-0x27*-0x2b,0xf*0x1ff+-0x19b2+-0x43f*0x1],this['mHuACY']=function(){return'newState';},this['OgrRec']='\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*',this['VFEjcr']='[\x27|\x22].+[\x27|\x22];?\x20*}';};_0x19883c['prototype']['VLmcor']=function(){const _0x3f361e=new RegExp(this['OgrRec']+this['VFEjcr']),_0x53a3a3=_0x3f361e['test'](this['mHuACY']['toString']())?--this['rgGPLW'][0xe23+-0xb*0x1a5+0x3f5]:--this['rgGPLW'][0x4fd*0x5+0x1*-0x215+-0x16dc];return this['wUiJcz'](_0x53a3a3);},_0x19883c['prototype']['wUiJcz']=function(_0x552857){if(!Boolean(~_0x552857))return _0x552857;return this['XmKTpo'](this['aWgQeZ']);},_0x19883c['prototype']['XmKTpo']=function(_0x4e2b5f){for(let _0x5823eb=-0x1d27+0x1a*-0x7b+0x29a5,_0x68faf7=this['rgGPLW']['length'];_0x5823eb<_0x68faf7;_0x5823eb++){this['rgGPLW']['push'](Math['round'](Math['random']())),_0x68faf7=this['rgGPLW']['length'];}return _0x4e2b5f(this['rgGPLW'][0x26*-0x29+0xee1+-0x8cb*0x1]);},new _0x19883c(_0xb3e4)['VLmcor'](),_0x1f8ea5=_0xb3e4['RpSxXT'](_0x1f8ea5),_0xb3e4['ziqDSg'][_0x2f72e1]=_0x1f8ea5;}else _0x1f8ea5=_0x1c0101;return _0x1f8ea5;}import{extension_settings}from'../../../../extensions.js';import{extensionName,EventType}from'./config.js';import{saveSettingsDebounced,eventSource}from'../../../../../script.js';import{initializeImageProcessing}from'./iframe.js';import{processCharacterPrompt}from'./characterprompt.js';import{bananaGenerate}from'./banana.js';import{taskQueue,TaskType}from'./taskQueue.js';let currentTaskId=null;async function generateSDImage({prompt:_0x4c1e7d,width:_0x16e6c6,height:_0x345f25,change:_0x16f04a}){const _0xae62c0={'sCwEO':function(_0x97b1c8,_0x33d3cb){return _0x97b1c8(_0x33d3cb);},'SOzky':_0x152949(0x1f0,0x14a,0x20c,0x227)+_0x152949(0x232,0x28c,0x233,0x2c2),'JNJIl':'任务已被用户取消。','jJdgC':_0x152949(0x285,0x314,0x2b9,0x20f),'SRLjT':function(_0x552e1b,_0xeda894){return _0x552e1b(_0xeda894);},'NfREN':function(_0x3ee971,_0x40ca60){return _0x3ee971(_0x40ca60);},'VydbW':function(_0x40c947){return _0x40c947();},'YmLud':_0x152949(0x1f5,0x20e,0x186,0x1a5)+_0x152949(0x257,0x256,0x29e,0x1a9),'RIipB':function(_0x48b863,_0x496445){return _0x48b863(_0x496445);},'cbZVs':function(_0x1b2394,_0x5bf60e){return _0x1b2394!==_0x5bf60e;},'uIQYy':'bDkda','zcsUQ':_0x152949(0x2f7,0x355,0x35a,0x248),'CEyxw':'xiancheng\x20'+'为true','RGESk':function(_0x3bd27e,_0x188cbe){return _0x3bd27e+_0x188cbe;},'BgATo':function(_0x11f4be,_0x156af1){return _0x11f4be!==_0x156af1;},'jgWlK':'mZEFZ','jSXJC':function(_0x4c5c3b,_0x103a99){return _0x4c5c3b(_0x103a99);},'AivLk':_0x152949(0x2eb,0x33b,0x27d,0x2ea)+_0x152949(0x1e3,0x1cc,0x292,0x22e),'UhlKg':function(_0x558d5a,_0x256fd7){return _0x558d5a+_0x256fd7;},'aHUfg':function(_0x3388a8){return _0x3388a8();},'ikNxe':function(_0x5e7905,_0x57b9d0){return _0x5e7905>_0x57b9d0;},'uAJYd':_0x152949(0x293,0x2e9,0x1fd,0x300),'bJkry':function(_0x1127f7,_0x4e8813){return _0x1127f7(_0x4e8813);},'IdNis':function(_0x4e4907,_0x22ac67){return _0x4e4907(_0x22ac67);},'eDnzZ':function(_0x32b612,_0x2ea5e6){return _0x32b612(_0x2ea5e6);},'uakOn':'Scene\x20Comp'+_0xfb5591(0x7a,0x9b,0xff,0x180),'fgVVh':function(_0x33db55,_0x2df190){return _0x33db55===_0x2df190;},'BuvhC':'hWnXL','nKZAl':'CkeLA','XjOJQ':_0x152949(0x22b,0x204,0x218,0x1dd),'maSsZ':_0x152949(0x32b,0x27c,0x332,0x2fc)+_0xfb5591(0x15f,0xda,0x157,0x19a),'QLKJv':function(_0x1abd5f,_0x120439){return _0x1abd5f<=_0x120439;},'MpTKl':_0xfb5591(0x1a8,0xfb,0x17c,0x139),'SJeRQ':function(_0x3872d6,_0x1e337a){return _0x3872d6!==_0x1e337a;},'yNRdv':_0xfb5591(0x182,0x102,0x12c,0xc4),'CMFzH':function(_0x288cbc,_0x4cf229){return _0x288cbc(_0x4cf229);},'eppAL':function(_0x16a0af,_0x5e3009,_0x122869){return _0x16a0af(_0x5e3009,_0x122869);},'MFFPG':function(_0x3fce59,_0x59d1e3){return _0x3fce59+_0x59d1e3;},'YpDwj':function(_0x1d512f,_0x1fb7fe,_0x234891,_0x497cd4,_0x5bd238,_0x1bcfb2){return _0x1d512f(_0x1fb7fe,_0x234891,_0x497cd4,_0x5bd238,_0x1bcfb2);},'witsY':function(_0x1d91e3,_0x106852){return _0x1d91e3(_0x106852);},'kHUqJ':_0xfb5591(0x19f,0x1dc,0x16e,0x1ae),'FBPuL':function(_0x19996a,_0xbb5644){return _0x19996a===_0xbb5644;},'TVRsK':_0x152949(0x2e1,0x2cc,0x351,0x352),'gHHus':'/api/sd/ge'+_0xfb5591(0x12c,0x183,0xf2,0x14a),'LebaQ':'POST','jAULf':function(_0x10e90f,_0x54f26b){return _0x10e90f(_0x54f26b);},'iffQE':_0xfb5591(0xa2,0x83,0x114,0xba)+'settingss.'+_0x152949(0x23b,0x28f,0x26e,0x2ca)+_0xfb5591(0x1e3,0x15d,0x13b,0x1ce),'DkgCQ':function(_0x49b392,_0x140cf5){return _0x49b392===_0x140cf5;},'lxXwn':_0xfb5591(0xc5,0x197,0x162,0xc4),'bUsOd':function(_0x32b03c,_0x5d7b32,_0x2caf84){return _0x32b03c(_0x5d7b32,_0x2caf84);},'OPiLL':_0xfb5591(0x13a,0xf,0xba,0x8d)+_0x152949(0x238,0x1ee,0x1c0,0x1bc),'CHMDP':function(_0x3b3c62,_0x4861fa){return _0x3b3c62(_0x4861fa);},'OluVM':_0xfb5591(0x110,0x6b,0xef,0x190),'GULFG':_0xfb5591(0x74,0x18a,0xe2,0x134),'rQbqw':function(_0x24ef42,_0x16a7b1){return _0x24ef42!=_0x16a7b1;},'OuAng':function(_0x5342e9,_0x1f36f6){return _0x5342e9!==_0x1f36f6;},'zDAkC':function(_0x4ffcf7,_0x462b14){return _0x4ffcf7(_0x462b14);},'uzMJW':function(_0x56e5d3,_0x11296f){return _0x56e5d3>=_0x11296f;},'FVQSd':function(_0x3fb591,_0x55e460){return _0x3fb591(_0x55e460);},'IokHu':function(_0x320465,_0x3042d1){return _0x320465==_0x3042d1;},'iPyCB':_0xfb5591(0x118,0x1ef,0x1b9,0x129),'yDXxE':function(_0x515faa,_0x21aaaa){return _0x515faa==_0x21aaaa;},'sWCZs':_0xfb5591(0x1a3,0x172,0x19d,0x117)+_0xfb5591(0x131,0x11c,0x171,0xcb),'LFMVw':_0x152949(0x2d5,0x2a2,0x2bc,0x254)+'8n.pt','bTODC':function(_0x3fd24b,_0x1d9ec8){return _0x3fd24b===_0x1d9ec8;},'axtcN':_0x152949(0x26c,0x2e0,0x2ff,0x277),'fBRjK':function(_0x2a58cb,_0x3d1a5a){return _0x2a58cb==_0x3d1a5a;},'xtxVL':function(_0x2c9684,_0x50df7f){return _0x2c9684(_0x50df7f);},'rkkdV':_0xfb5591(0x1d5,0xfa,0x13e,0x16a),'JSWOx':function(_0xd89227,_0x82c0a){return _0xd89227(_0x82c0a);},'sbomT':function(_0x575509,_0x541dc3){return _0x575509===_0x541dc3;},'HhOMa':_0xfb5591(0x1b3,0x1ae,0x12d,0x1c0)+_0xfb5591(0xfa,0xb3,0x120,0xba)+'load','nDXeU':function(_0x1ac02d,_0xaa1164,_0x1c6cc4){return _0x1ac02d(_0xaa1164,_0x1c6cc4);},'mjseJ':function(_0x52ba6f,_0x224cc1){return _0x52ba6f(_0x224cc1);},'EzGTQ':_0x152949(0x303,0x2dc,0x296,0x311),'hHqUn':function(_0x30b417,_0x56bc22){return _0x30b417(_0x56bc22);},'eNSkt':_0x152949(0x1f7,0x15f,0x1a3,0x28e),'wnfMY':_0x152949(0x30a,0x3a7,0x2c2,0x357),'BTcSG':_0x152949(0x23e,0x226,0x1d0,0x196)+_0x152949(0x21e,0x282,0x2ba,0x1e6)+_0x152949(0x234,0x1de,0x1b8,0x1d4),'SRlvj':function(_0x454a73,_0x1f4f88){return _0x454a73+_0x1f4f88;},'xzaqS':_0xfb5591(0x198,0x1bd,0x1d8,0x242)+_0x152949(0x219,0x1b9,0x276,0x194)+'L。','igGWm':function(_0x4154d5,_0xaa3026,_0x20f96f){return _0x4154d5(_0xaa3026,_0x20f96f);},'WzNTv':function(_0x800285,_0x18ed3e){return _0x800285||_0x18ed3e;},'tVuHu':_0xfb5591(0xbb,0xa2,0xf1,0x7c),'TkqEp':_0xfb5591(0x1d3,0xcb,0x148,0x103),'zOtGA':'Gabuj','lMMzv':_0xfb5591(0x68,0xb9,0xd1,0x3f)+'txt2img','scQuj':function(_0x333990,_0x3247dc,_0x376937){return _0x333990(_0x3247dc,_0x376937);},'njrJK':_0x152949(0x261,0x1d7,0x1fe,0x2db)+_0xfb5591(0xdd,0x179,0x166,0x151),'GswpG':function(_0xf90268,_0x43e257){return _0xf90268(_0x43e257);},'DKFFm':function(_0x31880d,_0x36797a){return _0x31880d===_0x36797a;},'FdYcc':_0x152949(0x1e2,0x27b,0x1c2,0x263),'ROYSO':function(_0x509bfc,_0x36f7e8){return _0x509bfc+_0x36f7e8;},'qwCki':'data:image'+_0xfb5591(0xb1,0x3c,0xe4,0xb8)+'4,','sLPpm':function(_0x1ba3d8,_0x13ebc1){return _0x1ba3d8===_0x13ebc1;},'ifPLf':_0xfb5591(0xa4,0xa0,0xbc,0x15b),'WJzeb':'5|3|2|4|0|'+'1','Tgffc':_0xfb5591(0xbf,0x1a1,0x170,0x209)+_0xfb5591(0x4b,0x120,0xd9,0x91)+_0x152949(0x241,0x265,0x29c,0x256),'uGbIs':function(_0x79fc7d,_0x2cd00d){return _0x79fc7d===_0x2cd00d;}};_0xae62c0['aHUfg'](clearLog);const _0x572afd=taskQueue[_0x152949(0x1ed,0x260,0x175,0x254)]({'name':_0xae62c0[_0xfb5591(0x13a,0x1fa,0x173,0x221)]((_0x4c1e7d||'')['substring'](-0x1*-0xeef+-0x1*-0x1a09+-0x28f8,-0x2681+0x23be+0x2e1),_0x4c1e7d&&_0xae62c0['ikNxe'](_0x4c1e7d[_0xfb5591(0x19a,0xf7,0x16d,0x18e)],0x13c6+0x2055+-0x33fd)?_0xae62c0[_0x152949(0x2ae,0x34c,0x222,0x237)]:''),'type':TaskType['SD'],'prompt':_0x4c1e7d});currentTaskId=_0x572afd;let _0x489c16=_0x16f04a;_0x4c1e7d=processCharacterPrompt(_0x4c1e7d),_0x16f04a=_0xae62c0[_0xfb5591(0x1f7,0x230,0x19e,0x1bf)](processCharacterPrompt,_0x16f04a),_0x4c1e7d=await _0xae62c0['IdNis'](stripChineseAnnotations,_0x4c1e7d),_0x16f04a=await _0xae62c0[_0x152949(0x2ec,0x2dd,0x311,0x25e)](stripChineseAnnotations,_0x16f04a);const _0x309935=extension_settings[extensionName][_0x152949(0x27a,0x329,0x1dc,0x1fd)][_0x152949(0x1f6,0x29d,0x24a,0x25c)](),_0x26adbc=extension_settings[extensionName];_0xae62c0['sCwEO'](addLog,'正在通过sdwebu'+_0x152949(0x1d6,0x26c,0x132,0x14e)+'端为'+_0x26adbc[_0x152949(0x2c0,0x212,0x343,0x2ce)]+',模型为'+_0x26adbc[_0x152949(0x23b,0x2bd,0x24e,0x1de)+_0xfb5591(0xb3,0x199,0x13b,0x158)]);const _0x7e3c6c=_0x16f04a&&_0x16f04a[_0xfb5591(0xd9,0x96,0xb0,0x2d)]()!==''?_0x16f04a:_0x4c1e7d;addLog(_0xfb5591(0x121,0x5b,0xb5,0x19)+_0x7e3c6c);let _0x2b808e=![];_0x7e3c6c[_0x152949(0x1fc,0x273,0x283,0x248)](_0xae62c0['uakOn'])&&(_0xae62c0[_0x152949(0x2ab,0x29c,0x35c,0x231)](_0xae62c0[_0xfb5591(0x25c,0x162,0x1bc,0x1db)],_0xae62c0[_0x152949(0x203,0x26c,0x1a5,0x2a0)])?(_0x553145['log'](_0x152949(0x2d4,0x33f,0x253,0x2eb)+'为true'),_0x9b0ef['xiancheng']=!![]):_0x2b808e=!![]);_0xae62c0['sCwEO'](addLog,'是否启用分角色模式\x20'+_0x152949(0x292,0x2d6,0x2bf,0x263)+_0xfb5591(0x8f,0x166,0x11a,0x80)+_0x2b808e);let _0x2c437e={},_0x2d4552='',_0x319c86='';function _0x152949(_0x4cc291,_0x23a6f0,_0x4eb742,_0x1b4cad){return _0xb3e4(_0x4cc291-0x22,_0x23a6f0);}if(_0x2b808e){if(_0xae62c0[_0x152949(0x2ab,0x308,0x221,0x350)](_0xfb5591(0xec,0xda,0x182,0x130),_0xae62c0[_0xfb5591(0x142,0xa3,0x140,0xcf)])){const _0x4c31dc=_0x3ad767?function(){function _0x7261be(_0x3d6f89,_0x506335,_0x4ed73f,_0x7304f){return _0xfb5591(_0x506335,_0x506335-0x16b,_0x4ed73f- -0x218,_0x7304f-0x140);}if(_0x1a32c5){const _0x1a6298=_0x5a27aa[_0x7261be(-0x16f,-0x192,-0x16f,-0xec)](_0x1be6e5,arguments);return _0x422993=null,_0x1a6298;}}:function(){};return _0x3a8d1d=![],_0x4c31dc;}else{_0xae62c0[_0xfb5591(0x9c,-0x28,0x86,0x57)](addLog,_0xae62c0[_0xfb5591(0x128,0x11d,0x8b,0x12b)]),_0x2c437e=_0xae62c0[_0xfb5591(0xf8,0x99,0x86,0xc5)](parsePromptStringWithCoordinates,_0x7e3c6c),_0x2d4552=_0x2c437e[_0x152949(0x227,0x1a2,0x2b7,0x252)+_0xfb5591(0x11d,0x12e,0xff,0x65)];for(let _0x3a4e92=-0x8*-0x434+-0x1555+-0x16*0x8f;_0xae62c0[_0xfb5591(0x1e6,0x14b,0x143,0x11f)](_0x3a4e92,0x2684+0xea*0x21+-0x44aa);_0x3a4e92++){_0x2c437e[_0xfb5591(0x13f,0x10a,0x10c,0x133)+_0x3a4e92+_0xfb5591(0x1db,0x159,0x1cb,0x214)]&&(_0xae62c0[_0xfb5591(0x1a3,0x1f1,0x165,0x185)](_0xfb5591(0x129,0x79,0xde,0x69),_0xae62c0[_0x152949(0x25b,0x264,0x2ed,0x2fe)])?_0xae62c0[_0x152949(0x22c,0x1f8,0x194,0x2a8)](_0xbaea85,_0x152949(0x2fd,0x3a9,0x276,0x299)+'库'):_0x319c86=_0xae62c0[_0xfb5591(0x1cb,0x105,0x173,0x1ba)](_0x319c86+',\x20',_0x2c437e['Character\x20'+_0x3a4e92+_0xfb5591(0x13e,0x15b,0x1cb,0x20d)]));}}}else _0xae62c0[_0x152949(0x276,0x236,0x2d6,0x1c8)](_0xfb5591(0x1c2,0x1ba,0x12c,0x1ca),_0xae62c0[_0x152949(0x230,0x240,0x1d0,0x250)])?(_0xae62c0['sCwEO'](_0x56f2cb,_0xae62c0['SOzky']),_0x44ceb8=_0x1292a2):(_0xae62c0['CMFzH'](addLog,'标准模式:\x20使用请求'+'中的\x20prompt。'),_0x2d4552=_0x7e3c6c);let {modifiedPrompt:_0x524330,insertions:_0x530631}=await _0xae62c0['eppAL'](prompt_replace,_0x2d4552,_0x319c86);if(_0x2b808e)for(let _0x363e80=-0x759+0x13a+0x10*0x62;_0xae62c0['QLKJv'](_0x363e80,-0x949*0x4+0xa2b*0x1+0x1afd);_0x363e80++){_0x2c437e['Character\x20'+_0x363e80+_0xfb5591(0x190,0x25a,0x1cb,0x17c)]&&(_0x524330=_0xae62c0[_0x152949(0x28b,0x237,0x283,0x1f9)](_0xae62c0[_0x152949(0x2b9,0x212,0x2e8,0x2d0)](_0x524330,',\x20'),_0xae62c0['CMFzH'](prompt_replace_for_character,_0x2c437e[_0xfb5591(0x1bc,0x85,0x10c,0x69)+_0x363e80+'\x20Prompt'])));}let _0x96e638=await _0xae62c0[_0xfb5591(0x184,0x150,0x1e4,0x17f)](zhengmian,extension_settings[extensionName][_0x152949(0x24d,0x1b9,0x22f,0x19e)][extension_settings[extensionName][_0x152949(0x2ba,0x23c,0x2df,0x2a6)]][_0x152949(0x324,0x39b,0x2e3,0x2c8)+'t'],_0x524330,extension_settings[extensionName][_0x152949(0x24d,0x201,0x1dd,0x2e5)][extension_settings[extensionName][_0xfb5591(0xfd,0xe8,0x174,0x172)]][_0xfb5591(0x17e,0x24d,0x1de,0x1cb)+_0x152949(0x1e1,0x1ff,0x16f,0x28a)],extension_settings[extensionName][_0x152949(0x295,0x2b8,0x287,0x2bf)],_0x530631),_0xad9e75=await fumian(extension_settings[extensionName]['yushe'][extension_settings[extensionName]['yusheid_sd']][_0xfb5591(0x110,0x241,0x19a,0x244)+_0x152949(0x310,0x345,0x297,0x35b)],extension_settings[extensionName][_0xfb5591(0x164,0x53,0xc9,0x12d)]);_0xae62c0[_0xfb5591(0x119,0x249,0x1ac,0x16b)](addLog,_0xfb5591(0x15d,0x1b3,0x10a,0x12f)+_0xad9e75),extension_settings['sd'][_0xae62c0['kHUqJ']]=_0x309935,await saveSettingsDebounced();try{if(_0xae62c0[_0xfb5591(0x119,0x42,0xe7,0x162)](_0x26adbc['client'],_0xae62c0[_0xfb5591(0xe3,0xb5,0xf6,0x81)])){const _0x5611b6={};_0x5611b6[_0xfb5591(0x1cd,0x19f,0x137,0x134)]=_0x26adbc[_0x152949(0x2f0,0x34c,0x296,0x2d1)+_0xfb5591(0xef,0xde,0x181,0x210)]?_0x26adbc[_0xfb5591(0x234,0x13b,0x1aa,0x1dc)+_0x152949(0x2c7,0x34c,0x256,0x235)]:'',_0x5611b6['url']=_0x309935;const _0x28502c=await fetch(_0xae62c0[_0x152949(0x318,0x28c,0x2d0,0x2f6)],{'method':_0xae62c0[_0xfb5591(0x1d5,0x211,0x1b5,0x11b)],'body':JSON[_0x152949(0x2d7,0x34e,0x335,0x342)](_0x5611b6),'headers':_0xae62c0[_0x152949(0x2ad,0x263,0x2a5,0x316)](getRequestHeaders,window['token'])});if(!_0x28502c['ok']){addLog(_0xfb5591(0x1ae,0x183,0x1ae,0x24c)+_0x28502c[_0xfb5591(0x9f,0x8b,0xb4,0x70)]+'\x20'+_0x28502c['statusText']);throw new Error(_0x152949(0x2f4,0x362,0x2cc,0x305)+_0x28502c[_0xfb5591(0xe4,0x4c,0xb4,0x15)]+'\x20'+_0x28502c[_0xfb5591(-0x1b,0xc6,0x8a,0x8)]);}let _0xaaf732=await _0x28502c['text']();console[_0x152949(0x2e5,0x294,0x2d2,0x2fe)]('cmodel2222'+'2222',_0xaaf732),console[_0x152949(0x2e5,0x267,0x365,0x342)](_0xae62c0[_0xfb5591(0x28a,0x266,0x1e3,0x1f2)],_0x26adbc[_0x152949(0x23b,0x1da,0x225,0x1e7)+'8_model']);if(_0xaaf732!=_0x26adbc[_0xfb5591(0x14a,0x7d,0xf5,0xbf)+_0xfb5591(0x114,0x194,0x13b,0x1c7)]){if(_0xae62c0[_0xfb5591(0x172,0xb0,0x153,0x1e4)](_0xae62c0[_0x152949(0x29b,0x26c,0x33f,0x281)],_0xae62c0[_0x152949(0x29b,0x212,0x30f,0x2e0)])){addLog(_0x152949(0x258,0x2b3,0x1fe,0x2cb)+_0x26adbc[_0x152949(0x23b,0x253,0x295,0x1d3)+_0x152949(0x281,0x313,0x277,0x24c)]+_0xfb5591(0x13a,0x181,0x14d,0xec)),toastr[_0x152949(0x2fe,0x257,0x314,0x263)]('正在设置模型...为'+_0x26adbc[_0x152949(0x23b,0x27a,0x1a3,0x2de)+'8_model']);const _0x114231={};_0x114231[_0x152949(0x27d,0x2aa,0x2b6,0x202)]=_0x26adbc[_0xfb5591(0x22e,0x1ca,0x1aa,0x154)+_0xfb5591(0x179,0xff,0x181,0xfc)]?_0x26adbc[_0x152949(0x2f0,0x269,0x24e,0x2c0)+_0xfb5591(0x131,0x211,0x181,0x1fe)]:'',_0x114231['url']=_0x309935,_0x114231['model']=_0x26adbc[_0xfb5591(0x160,0x156,0xf5,0x11e)+_0xfb5591(0x19c,0xc8,0x13b,0x91)];const _0x48bd4f=await _0xae62c0[_0xfb5591(0xc8,0xd6,0x160,0xf1)](fetch,_0xae62c0[_0xfb5591(0x10a,0xa8,0xc5,0x2f)],{'method':_0xae62c0[_0xfb5591(0x1c7,0x25b,0x1b5,0x1cf)],'body':JSON[_0xfb5591(0xe1,0x1dd,0x191,0x179)](_0x114231),'headers':_0xae62c0['CHMDP'](getRequestHeaders,window[_0xfb5591(0x87,0x18a,0x119,0x6c)])});if(!_0x48bd4f['ok']){if(_0xae62c0[_0x152949(0x2ab,0x2e8,0x2b0,0x25f)](_0xae62c0[_0xfb5591(0x1a1,0x158,0x17e,0x1fa)],_0xae62c0['GULFG'])){_0x36662f(_0xae62c0[_0x152949(0x25d,0x2a7,0x209,0x1fa)]);throw new _0x47f887(_0xae62c0[_0xfb5591(0x4b,0x141,0xeb,0xa7)]);}else{addLog('切换模型失败:\x20'+_0x48bd4f[_0xfb5591(0xbc,0xd9,0xb4,0xb)]+'\x20'+_0x48bd4f[_0xfb5591(0x7f,0x42,0x8a,0x122)]);throw new Error('切换模型失败:\x20'+_0x48bd4f['status']+'\x20'+_0x48bd4f[_0x152949(0x1d0,0x14d,0x139,0x23b)]);}}toastr['info'](_0x152949(0x2af,0x216,0x2bd,0x30e)+_0x26adbc[_0x152949(0x23b,0x18c,0x1c2,0x271)+'8_model']+'成功');}else{const _0x5f080f=_0xfb5591(0xe5,0x6c,0x8e,0xd1)+'常\x20(ID:\x20'+_0x258652+_0x152949(0x307,0x375,0x279,0x326)+_0x561a51[_0xfb5591(0x100,0x13f,0xd0,0x38)];_0xae62c0[_0xfb5591(0x158,0x1bf,0x17f,0x117)](_0x5ce51a,'错误:\x20'+_0x5f080f),_0x4bf87d[_0xfb5591(0x133,0xbd,0xdf,0x15e)]('Error\x20gene'+_0x152949(0x256,0x1b2,0x275,0x256)+_0x152949(0x2b2,0x31a,0x206,0x297),_0x300231);const _0x37136c={};_0x37136c['id']=_0x622f14,_0x37136c['success']=![],_0x37136c[_0xfb5591(0x12f,0x14c,0xdf,0x65)]=_0x55f75b[_0xfb5591(0xee,0xed,0xd0,0x108)],_0x37136c[_0xfb5591(0x139,0x74,0xb3,0x83)]=_0x46d2a5,_0x247966[_0xfb5591(0x53,0x9d,0xfe,0x77)](_0x155d19[_0xfb5591(0x17d,0x1ff,0x1a3,0x120)+'MAGE_RESPO'+_0xfb5591(0x2e,0x13c,0xc1,0x68)],_0x37136c),_0xae62c0[_0xfb5591(0xdb,0x3f,0x86,0xbc)](_0xee0e7b,_0xfb5591(0x12b,0x1ed,0x1d0,0x19c)+_0xfb5591(0xe6,0xae,0xfa,0x15e)+_0x5d03dc+')');}}}else{let _0x542af9=await _0xae62c0['jSXJC'](getSDMode,_0x309935);_0xae62c0[_0x152949(0x2aa,0x21c,0x2fc,0x203)](_0x542af9,_0x26adbc['sd_cchatu_'+_0x152949(0x281,0x2a5,0x221,0x28a)])&&(_0xae62c0[_0xfb5591(0x15b,0x187,0x167,0x127)](addLog,_0xfb5591(0xb4,0x187,0x152,0x15e)+_0x26adbc[_0x152949(0x23b,0x2a1,0x2da,0x222)+_0x152949(0x281,0x2a1,0x246,0x28a)]+'...'),await _0xae62c0['eppAL'](setSDMode,_0x309935,_0x26adbc[_0x152949(0x23b,0x263,0x2d2,0x1b6)+_0x152949(0x281,0x2a9,0x244,0x329)]));}}catch(_0x1123ff){addLog(_0xfb5591(0x124,0x240,0x19c,0xf4)+':\x20'+_0x1123ff[_0xfb5591(0x13b,0x105,0xd0,0x13c)]+(_0xfb5591(0x1b6,0x178,0x195,0x174)+_0x152949(0x29c,0x213,0x349,0x211)+'查模型是否正确。')),taskQueue[_0xfb5591(0x61,0x115,0xdb,0x39)+'sk'](_0x572afd,![]),currentTaskId=null;throw new Error('获取或者切换模型失败'+_0x152949(0x1e5,0x1ce,0x276,0x289)+_0xfb5591(0xb6,0x201,0x156,0x12b)+_0xfb5591(0x14c,0x194,0x1bf,0x1de));}let _0x10401f=-(0x1c87*-0x1+0x7*-0x11f+-0x2461*-0x1);const _0x43bb4b=_0x26adbc[_0x152949(0x27c,0x28f,0x1e6,0x225)];_0xae62c0['OuAng'](_0x43bb4b,'')&&_0xae62c0[_0xfb5591(0x23c,0x26e,0x1c9,0x264)](_0x43bb4b,null)&&!_0xae62c0[_0xfb5591(0x12b,0x110,0x17f,0x10b)](isNaN,_0xae62c0['zDAkC'](Number,_0x43bb4b))&&_0xae62c0[_0xfb5591(0x61,0x8d,0x108,0xe8)](_0xae62c0['IdNis'](Number,_0x43bb4b),0x1*0x2701+0xe2c+0x1*-0x352d)&&(_0x10401f=_0xae62c0[_0x152949(0x1df,0x1f2,0x146,0x17f)](Number,_0x43bb4b));let _0x236d4f={'prompt':_0x96e638,'negative_prompt':_0xad9e75,'sampler_name':_0x26adbc['sd_cchatu_'+_0xfb5591(0x100,0xc2,0xad,0x32)+_0x152949(0x2dc,0x26e,0x34e,0x31a)],'scheduler':_0x26adbc[_0x152949(0x23b,0x20f,0x26a,0x29b)+_0x152949(0x1da,0x276,0x1b4,0x1c9)+'r'],'steps':_0x26adbc['sd_csteps'],'cfg_scale':_0x26adbc['sdCfgScale'],'width':_0x16e6c6?_0x16e6c6:_0x26adbc[_0xfb5591(0x9d,0x155,0xf4,0x102)],'height':_0x345f25?_0x345f25:_0x26adbc[_0x152949(0x328,0x2b5,0x29e,0x306)],'restore_faces':_0xae62c0[_0xfb5591(0x13e,0xc8,0x144,0x19b)](_0x26adbc[_0xfb5591(0x139,0xb4,0xc6,0x8e)+'es'],_0xae62c0[_0x152949(0x1e6,0x1c3,0x18d,0x235)]),'enable_hr':_0xae62c0[_0x152949(0x28a,0x330,0x2b8,0x2ae)](_0x26adbc[_0xfb5591(0x27d,0x278,0x1df,0x261)+_0xfb5591(0x201,0x127,0x180,0x15e)],'true'),'hr_upscaler':_0x26adbc['sd_cchatu_'+_0x152949(0x21a,0x2bf,0x24b,0x1d1)],'hr_scale':_0x26adbc[_0xfb5591(0x19a,0xd0,0x16f,0x21a)+_0x152949(0x2a2,0x340,0x2ca,0x28c)],'hr_additional_modules':[],'denoising_strength':_0x26adbc[_0x152949(0x251,0x2bc,0x1d8,0x2fe)+_0xfb5591(0x13d,0xda,0x139,0x11c)+'th'],'hr_second_pass_steps':_0x26adbc[_0xfb5591(0x238,0x134,0x1df,0x131)+_0xfb5591(0x12f,0x1c9,0x18a,0x1b4)],'seed':_0x10401f,'override_settings':{'CLIP_stop_at_last_layers':Number(_0x26adbc['sd_cclip_s'+_0x152949(0x283,0x2d3,0x328,0x219)]),'sd_vae':_0x26adbc[_0x152949(0x23b,0x253,0x203,0x27d)+_0x152949(0x24a,0x23f,0x2c9,0x259)]},'override_settings_restore_afterwards':!![],'save_images':!![],'send_images':!![],'do_not_save_grid':![],'do_not_save_samples':![]};_0xae62c0[_0x152949(0x26b,0x304,0x2d2,0x238)](addLog,_0xfb5591(0x266,0x1b4,0x1da,0x1e9)+'ces\x20脸部修复\x20为'+_0x236d4f[_0xfb5591(0x25b,0x226,0x1da,0x19d)+_0xfb5591(0x1f5,0x247,0x1db,0x26a)]),addLog('enable_hr\x20'+_0xfb5591(0x103,0x1f3,0x179,0x147)+_0x236d4f[_0x152949(0x297,0x29f,0x2dd,0x250)]);_0xae62c0[_0xfb5591(0x1ed,0x1e6,0x15a,0x1d5)](_0x26adbc['sd_cadetai'+_0x152949(0x20d,0x161,0x216,0x1ee)],_0xae62c0['iPyCB'])&&(addLog(_0xae62c0[_0xfb5591(0x1a3,0x157,0x15b,0xb3)]),_0x236d4f=_0xae62c0[_0xfb5591(0xf8,0x146,0x12e,0xc2)](deepMerge,_0x236d4f,{'alwayson_scripts':{'ADetailer':{'args':[!![],!![],{'ad_model':_0xae62c0[_0x152949(0x2d2,0x314,0x327,0x29c)]}]}}}));function _0xfb5591(_0x4929f4,_0x1c38c1,_0x2f236f,_0xbb056f){return _0xb3e4(_0x2f236f- -0x124,_0x4929f4);}const _0x3ebc21=_0xfb5591(0xe3,0x1fb,0x187,0x167)+'图参数报告\x0a-\x20**'+'正面提示\x20(Prom'+'pt):**\x20'+_0x96e638+(_0x152949(0x254,0x214,0x22c,0x1f5)+_0xfb5591(0xd8,0x4a,0xa4,0x54)+_0xfb5591(0x124,0xef,0x93,0x16)+'\x20')+_0xad9e75+(_0x152949(0x326,0x27e,0x39f,0x2fa)+'(Sampler):'+_0xfb5591(0x23e,0x1df,0x1a2,0x145))+_0x236d4f[_0xfb5591(0x1b9,0xf0,0x149,0x104)+'me']+(_0x152949(0x275,0x26f,0x21f,0x1ce)+_0xfb5591(0x160,0x19a,0x127,0xec))+_0x236d4f[_0x152949(0x2d0,0x2b8,0x338,0x376)]+(_0xfb5591(0x142,0xe3,0xca,0x13a)+_0x152949(0x322,0x3b1,0x28c,0x2de))+_0x236d4f[_0x152949(0x233,0x28b,0x221,0x2ab)]+(_0xfb5591(0x1ee,0x1b3,0x1c0,0x1fe)+_0xfb5591(0x178,0x81,0xe9,0xa6))+_0x236d4f[_0xfb5591(0x7f,0xe2,0xe0,0x9e)]+'x'+_0x236d4f[_0x152949(0x300,0x25c,0x362,0x383)]+(_0xfb5591(0xa1,0xdf,0xd2,0x11b)+_0x152949(0x204,0x1c1,0x257,0x167))+(_0xae62c0[_0xfb5591(0x1b3,0x6d,0x11c,0x81)](_0x236d4f[_0x152949(0x249,0x1d7,0x276,0x269)],-(-0x1*-0xa81+0x2*-0xf25+0x13ca))?_0xae62c0[_0x152949(0x1e4,0x28a,0x1b7,0x292)]:_0x236d4f[_0xfb5591(0xc6,0x9a,0x103,0x126)])+(_0x152949(0x31b,0x2db,0x396,0x30c)+'odel):**\x20')+_0x26adbc[_0x152949(0x23b,0x261,0x20a,0x1f8)+_0x152949(0x281,0x303,0x252,0x25e)]+(_0x152949(0x29a,0x2d5,0x26e,0x2f6)+'*\x20')+_0x236d4f['override_s'+_0x152949(0x1f2,0x1a8,0x298,0x1ef)]['sd_vae']+('\x0a-\x20**Clip\x20'+_0xfb5591(0x101,0xf3,0xa6,0x12f))+_0x236d4f[_0xfb5591(0x196,0xd9,0x163,0x1e9)+_0x152949(0x1f2,0x23a,0x265,0x1b8)][_0xfb5591(0x10a,0xdb,0x122,0x1d0)+_0x152949(0x246,0x210,0x236,0x26d)+_0xfb5591(0x1ef,0xc3,0x14e,0x11b)]+(_0xfb5591(0xbf,0x1b0,0x105,0x147)+_0xfb5591(0x153,0x1b4,0x1c7,0x1e7)+_0xfb5591(0x14c,0x1a8,0xf9,0x101))+_0x236d4f['enable_hr']+(_0x152949(0x2d6,0x373,0x229,0x327)+_0xfb5591(0xe9,0x7c,0x11f,0x81)+_0xfb5591(0x1ba,0x169,0x199,0x1a1))+_0x236d4f[_0x152949(0x2b8,0x366,0x269,0x2e3)]+('\x0a-\x20**重绘幅度\x20'+_0xfb5591(0x8f,0x148,0xa8,0x38)+_0x152949(0x323,0x2a4,0x32f,0x36d)+_0xfb5591(0x127,0xdc,0xa5,0x14b))+_0x236d4f[_0x152949(0x1cb,0x172,0x24a,0x224)+_0x152949(0x201,0x174,0x1de,0x1d0)]+(_0xfb5591(0x57,0x7d,0xc0,0x13a)+_0xfb5591(0x51,0x13,0x9a,0x10d)+_0x152949(0x1dd,0x16b,0x1f1,0x1ff))+_0x236d4f[_0xfb5591(0x180,0x240,0x1da,0x15e)+_0x152949(0x321,0x2fd,0x302,0x319)]+(_0x152949(0x290,0x2f7,0x296,0x235)+_0x152949(0x30b,0x2db,0x30c,0x27b))+_0xae62c0[_0x152949(0x255,0x292,0x222,0x2e0)](_0x26adbc['sd_cadetai'+_0x152949(0x20d,0x162,0x1cb,0x193)],_0xae62c0[_0x152949(0x1e6,0x1ac,0x28c,0x266)])+_0xfb5591(0x109,0x1ab,0x1ab,0x178);_0xae62c0[_0xfb5591(0xac,0xe,0xb7,0xd0)](addLog,_0x3ebc21),addLog(_0xfb5591(0x82,0x9f,0xd5,0x32)+'数为'+JSON['stringify'](_0x236d4f)),console[_0x152949(0x2e5,0x34f,0x2e3,0x358)](_0xae62c0[_0xfb5591(0x237,0x18d,0x1be,0x208)],_0x236d4f);while(!window['xiancheng']){await _0xae62c0[_0xfb5591(0xf9,0x172,0xc4,0x5d)](sleep,-0x16e6+-0x4ff*-0x4+-0x1*-0x6d2);};try{window[_0xfb5591(0x11a,0x99,0xab,0x31)]=![],taskQueue[_0xfb5591(0x4f,0x10f,0xc2,0x3e)+'us'](_0x572afd,_0x152949(0x2f9,0x2dc,0x2ef,0x34e));if(_0xae62c0[_0xfb5591(0x277,0x1e3,0x1cd,0x206)](_0x26adbc[_0xfb5591(0x15e,0x213,0x17a,0xd1)],_0xae62c0[_0xfb5591(0xb9,0x19e,0xf6,0x6d)])){if(!taskQueue[_0xfb5591(0x85,0x52,0x102,0x1a6)+_0x152949(0x2d8,0x35b,0x2bf,0x2c0)](_0x572afd)){addLog(_0xae62c0[_0xfb5591(0x154,0xaf,0x117,0x1b2)]),eventSource[_0xfb5591(0x10f,0x12e,0xfe,0xa8)](_0xae62c0['AivLk']);throw new Error(_0xfb5591(0x19a,0x133,0x13f,0x146));}_0x236d4f[_0x152949(0x1cd,0x151,0x227,0x249)]=_0x309935,console[_0x152949(0x2e5,0x361,0x2e1,0x2d4)](_0xae62c0['HhOMa'],_0x26adbc[_0xfb5591(0x1ea,0x21f,0x1aa,0x1c5)+_0xfb5591(0x232,0x1ad,0x181,0xf1)]),_0x236d4f[_0xfb5591(0x102,0xa0,0x137,0x161)]=_0x26adbc[_0x152949(0x2f0,0x2b1,0x283,0x2ef)+_0xfb5591(0x14c,0x10e,0x181,0x1e5)]?_0x26adbc[_0x152949(0x2f0,0x2c5,0x350,0x297)+_0x152949(0x2c7,0x2ba,0x2c0,0x370)]:'';const _0x2f1765=await _0xae62c0[_0xfb5591(0x1c8,0x17e,0x17b,0x1b8)](fetch,_0x152949(0x2a7,0x321,0x27c,0x2b1)+_0x152949(0x220,0x170,0x198,0x1b2),{'method':_0xae62c0[_0xfb5591(0x180,0x199,0x1b5,0x221)],'headers':_0xae62c0[_0xfb5591(0x183,0xa7,0x118,0xf9)](getRequestHeaders,window[_0xfb5591(0xbd,0xfd,0x119,0x18c)]),'body':JSON['stringify'](_0x236d4f)});if(!_0x2f1765['ok']){if(_0xae62c0[_0x152949(0x313,0x3a2,0x29c,0x353)](_0xfb5591(0xa8,0x38,0x91,0x13f),_0xae62c0['EzGTQ']))!_0x21af25[_0x152949(0x205,0x21f,0x214,0x164)+_0x152949(0x278,0x2db,0x2cc,0x25f)]&&(_0x1bba7f[_0x152949(0x205,0x277,0x208,0x156)+'SDListener']=!![],_0xae62c0[_0x152949(0x269,0x277,0x22b,0x2ec)](_0x4ba0e0)),_0xae62c0['VydbW'](_0x770f4);else{const _0x5c912a=await _0x2f1765[_0x152949(0x239,0x256,0x298,0x251)]();_0xae62c0[_0xfb5591(0xd1,0x2a,0x8c,-0x22)](addLog,'酒馆\x20返回错误。状态'+_0x152949(0x212,0x2a7,0x26b,0x17a)+_0x2f1765[_0x152949(0x1fa,0x22e,0x1a4,0x1fd)]+_0x152949(0x30c,0x2f3,0x37f,0x3a9)+_0x5c912a),console[_0x152949(0x2e5,0x320,0x30e,0x24a)](_0xfb5591(0x1ec,0xd3,0x16b,0x1dd),_0x5c912a);throw new Error(_0x152949(0x247,0x1da,0x1d8,0x217)+_0x2f1765[_0xfb5591(0x137,0xa4,0xb4,0x52)]+_0xfb5591(0x111,0x114,0xfd,0x19d)+_0x5c912a);}}const _0x504d8f=await _0x2f1765[_0x152949(0x239,0x2e7,0x189,0x1ed)]();let _0x2255e0='';try{if(_0xae62c0['eNSkt']!==_0xae62c0[_0xfb5591(0x211,0xd5,0x178,0x1e2)]){const _0x1d97b9=JSON[_0x152949(0x271,0x2e3,0x214,0x2ec)](_0x504d8f);_0x2255e0=_0x1d97b9[_0x152949(0x28c,0x284,0x2f6,0x1ff)][0x181e+-0xf01+-0x91d];}else _0x11a02f['initialize'+_0x152949(0x278,0x20f,0x2c0,0x2d9)]&&(_0x167481[_0x152949(0x2ef,0x2ab,0x375,0x2ca)+'ener'](_0x2ecf21[_0xfb5591(0x22e,0x1c9,0x1a3,0x1f5)+_0xfb5591(0x113,0xae,0x8d,0xfc)+'ST'],_0x1b6139),_0x3d10f2[_0x152949(0x205,0x1eb,0x15e,0x1e2)+_0xfb5591(0xfd,0x170,0x132,0xbc)]=![],_0xae62c0[_0xfb5591(0x8c,0x92,0x86,0x55)](_0x3566ae,_0xae62c0[_0x152949(0x1f4,0x27f,0x222,0x28f)]));}catch(_0x2600ad){_0xae62c0[_0xfb5591(0x5,0xeb,0x99,0x50)](addLog,_0xae62c0[_0xfb5591(0x16f,0xce,0x135,0x14d)]),_0x2255e0=_0x504d8f;}const _0xbb0961=_0xae62c0['SRlvj']('data:image'+_0xfb5591(0xd6,0x9a,0xe4,0xd6)+'4,',_0x2255e0);_0xae62c0['NfREN'](addLog,_0xae62c0[_0xfb5591(0x162,0xf5,0x121,0xfb)]),_0xae62c0[_0x152949(0x2e7,0x2dc,0x30f,0x324)](setTimeout,()=>{function _0x3237b0(_0x1454ff,_0x184e67,_0x71bfc8,_0x35caa4){return _0xfb5591(_0x1454ff,_0x184e67-0x1be,_0x71bfc8-0x1b6,_0x35caa4-0xed);}function _0x5808e5(_0x20964e,_0x3ce9dd,_0x75049,_0x2b65db){return _0xfb5591(_0x20964e,_0x3ce9dd-0x1c5,_0x2b65db-0x75,_0x2b65db-0x1e7);}_0xae62c0[_0x3237b0(0x370,0x365,0x37f,0x371)](_0xae62c0[_0x5808e5(0x146,0x21d,0x188,0x1ea)],_0xae62c0[_0x3237b0(0x310,0x37a,0x2e9,0x379)])?(console['log'](_0xae62c0[_0x3237b0(0x3dc,0x34c,0x38f,0x2fa)]),window[_0x5808e5(0x95,0x16e,0x164,0x120)]=!![]):_0x2a4581=_0xae62c0[_0x3237b0(0x276,0x2d2,0x2f0,0x324)](_0x58da44,_0x1d3b34);},extension_settings[extensionName][_0xfb5591(0x1d7,0x168,0x194,0x1e0)+'terval']);;return taskQueue['completeTa'+'sk'](_0x572afd,!![]),currentTaskId=null,{'image':_0xbb0961,'change':_0xae62c0[_0x152949(0x2dd,0x2da,0x34f,0x26f)](_0x16f04a,'')};}else{if(_0xae62c0[_0x152949(0x1cf,0x193,0x24e,0x20e)](_0x152949(0x1fe,0x1a0,0x1a4,0x218),_0xae62c0['tVuHu'])){if(!taskQueue[_0x152949(0x248,0x1af,0x2ea,0x1df)+'eue'](_0x572afd)){if(_0xae62c0['TkqEp']===_0xae62c0[_0xfb5591(0x148,0xec,0x185,0x11d)])_0x1df2eb[_0xfb5591(0x107,0x24c,0x19f,0x1ec)](_0x152949(0x2d4,0x363,0x257,0x37a)+_0xfb5591(0xe5,0xe9,0xb2,0x133)),_0x34c60b[_0xfb5591(0x121,0x9a,0xab,0x128)]=!![];else{addLog(_0xae62c0[_0x152949(0x25d,0x1be,0x1f9,0x2aa)]);throw new Error(_0xae62c0[_0xfb5591(0x155,0x176,0xeb,0x42)]);}}const _0x4a0555=new URL(_0xae62c0[_0x152949(0x28b,0x2a1,0x22a,0x2cf)](_0x309935,_0xae62c0[_0xfb5591(0x1cc,0x1c5,0x150,0xb0)]));window[_0xfb5591(0x84,0x97,0xab,0xb1)]=![];const _0x14f3ab=await _0xae62c0['scQuj'](fetch,_0x4a0555,{'method':_0xae62c0[_0x152949(0x2fb,0x24f,0x358,0x2f5)],'body':JSON[_0xfb5591(0x1d9,0xfb,0x191,0x236)](_0x236d4f),'headers':{'Content-Type':_0xae62c0['njrJK'],'Authorization':_0xae62c0[_0x152949(0x24f,0x219,0x2b1,0x2db)](getsdAuth)}});_0xae62c0[_0x152949(0x2a6,0x21a,0x2f0,0x312)](setTimeout,()=>{function _0x512e37(_0x3d4f79,_0x1fb9ad,_0x596bdd,_0x1a855a){return _0x152949(_0x596bdd- -0x3da,_0x1fb9ad,_0x596bdd-0x178,_0x1a855a-0x21);}function _0xdca597(_0x287123,_0x59da8c,_0x358304,_0x144b09){return _0x152949(_0x144b09- -0x1ab,_0x358304,_0x358304-0xe2,_0x144b09-0x84);}_0xae62c0[_0xdca597(0x46,0xaa,0xa3,0x24)](_0xae62c0[_0x512e37(-0x7e,-0x149,-0xec,-0x189)],_0xae62c0[_0x512e37(-0x105,-0x58,-0xec,-0x13a)])?_0x310382['Character\x20'+_0x588695+'\x20Prompt']&&(_0x196c04=_0xae62c0[_0x512e37(-0x248,-0x1af,-0x1a4,-0x219)](_0xae62c0[_0xdca597(0xb0,0x2a,0x16,0x8b)](_0x448d5e,',\x20'),_0x559fa1[_0xdca597(0xcc,0x122,0x72,0xa7)+_0x54d145+'\x20Prompt'])):(console[_0x512e37(-0x81,-0x10e,-0xf5,-0x55)](_0xae62c0['CEyxw']),window[_0x512e37(-0x269,-0x278,-0x1e9,-0x209)]=!![]);},extension_settings[extensionName]['imageGenIn'+_0xfb5591(0x16f,0xc0,0x141,0x15a)]);;if(!_0x14f3ab['ok']){const _0xb3065=await _0x14f3ab[_0xfb5591(0x115,0x13b,0xf3,0x15d)]();_0xae62c0[_0xfb5591(0x6d,0x22,0x96,0xb8)](addLog,_0x152949(0x2de,0x278,0x2d7,0x2bc)+_0x152949(0x1de,0x1b3,0x130,0x189)+_0x14f3ab[_0x152949(0x1fa,0x1d7,0x26a,0x1e4)]+_0x152949(0x30c,0x2be,0x279,0x330)+_0xb3065),console[_0xfb5591(0x1f1,0x15e,0x19f,0x1d7)](_0x152949(0x2b1,0x25d,0x202,0x26a),_0xb3065);throw new Error(_0xfb5591(0x75,0x11d,0x101,0xb0)+_0x14f3ab['status']+_0xfb5591(0x10c,0xd7,0xfd,0x78)+_0xb3065);}const _0x4db1f5=await _0x14f3ab[_0x152949(0x2a3,0x25f,0x316,0x28f)]();if(!_0x4db1f5[_0xfb5591(0xe2,0x150,0x146,0x12c)]||_0xae62c0['DKFFm'](_0x4db1f5[_0xfb5591(0xfd,0x113,0x146,0xd7)][_0x152949(0x2b3,0x2c4,0x202,0x291)],-0xeae*-0x2+0x2*0x8d6+-0x4b4*0xa)){if(_0xae62c0['BgATo']('KWDCu',_0xae62c0[_0xfb5591(0x34,-0x7,0xa2,0x114)]))throw new Error(_0x152949(0x277,0x2cb,0x2b4,0x261)+'像数据。');else{_0xae62c0[_0xfb5591(0x1cb,0x1bf,0x11d,0x8e)](_0x41e93f,_0xae62c0[_0x152949(0x25d,0x2a7,0x289,0x219)]),_0x55b1fa[_0xfb5591(0x171,0x184,0xfe,0x16d)](_0xae62c0[_0xfb5591(0x15a,0x118,0x1a7,0x24c)]);throw new _0x463f57(_0xae62c0[_0x152949(0x231,0x1db,0x1f1,0x1c6)]);}}const _0x479d3c=_0x4db1f5['images'][0xd7a+0x2*-0xe5d+-0x4*-0x3d0],_0x1fd0e8=_0xae62c0[_0xfb5591(0x128,0x105,0x159,0xfa)](_0xae62c0['qwCki'],_0x479d3c);return _0xae62c0[_0x152949(0x263,0x1db,0x1bd,0x1c9)](addLog,_0xae62c0[_0x152949(0x267,0x233,0x2fb,0x314)]),taskQueue[_0xfb5591(0xb7,0x145,0xdb,0x90)+'sk'](_0x572afd,!![]),currentTaskId=null,{'image':_0x1fd0e8,'change':_0xae62c0[_0x152949(0x2dd,0x2ce,0x2ab,0x271)](_0x489c16,'')};}else _0x52097b=_0xae62c0['UhlKg'](_0x787d69+',\x20',_0x9b4087[_0xfb5591(0x130,0xe2,0x10c,0xc9)+_0x153e8a+_0x152949(0x311,0x357,0x2d1,0x303)]);}}catch(_0x10fe2f){if(_0xae62c0[_0x152949(0x2cc,0x2b5,0x37a,0x236)](_0xae62c0[_0xfb5591(0x1ed,0x16a,0x193,0x1bd)],_0xae62c0['ifPLf'])){const _0x4ac45d=_0xae62c0['WJzeb'][_0xfb5591(0x22e,0x1c0,0x1b6,0x165)]('|');let _0x667750=-0x13e+0xd23*-0x2+0x1b84;while(!![]){switch(_0x4ac45d[_0x667750++]){case'0':console['error'](_0xae62c0[_0xfb5591(0xae,0x18c,0x15e,0x157)],_0x10fe2f);continue;case'1':throw _0x10fe2f;continue;case'2':currentTaskId=null;continue;case'3':if(_0xae62c0[_0x152949(0x314,0x2ba,0x28b,0x2ae)](_0x10fe2f[_0xfb5591(0x126,0xda,0xd0,0x17e)],_0xae62c0['jJdgC'])){}else taskQueue[_0xfb5591(0x110,0x4b,0xdb,0x86)+'sk'](_0x572afd,![]);continue;case'4':addLog(_0xfb5591(0x1b9,0x1ba,0x1c8,0x1bc)+_0x10fe2f['message']);continue;case'5':window['xiancheng']=!![];continue;}break;}}else{if(_0x2ea615){const _0x40284c=_0x2cffe6[_0x152949(0x1ef,0x16a,0x22b,0x208)](_0x270abe,arguments);return _0x49d41f=null,_0x40284c;}}}}async function sdGenerate(_0x360019){const _0x5c6bdb={'pSzRf':function(_0x120b79,_0x1802ad){return _0x120b79(_0x1802ad);},'kPZyP':_0x5549ab(0x119,0x105,0xc6,0x1ba),'nWcUp':function(_0x4f3555,_0x422f2f){return _0x4f3555===_0x422f2f;},'yLveI':'vhLJk','pNzAK':'rmPLD','HZOBQ':function(_0x4612a4,_0x481477){return _0x4612a4(_0x481477);},'docRj':function(_0x82af1f,_0xb5e29e){return _0x82af1f!=_0xb5e29e;},'YTylR':function(_0x54c8f6,_0x2bb4b2,_0x537286,_0x15ba9c){return _0x54c8f6(_0x2bb4b2,_0x537286,_0x15ba9c);},'tmWaZ':function(_0x2ea2c8,_0x5e56c1){return _0x2ea2c8!==_0x5e56c1;},'WjMXw':_0x5549ab(0x1a0,0x234,0x1cc,0x1a6),'gsgWd':_0x5549ab(0x14d,0x1ca,0x1e3,0x1df)+'rating\x20SD\x20'+_0x5549ab(0x149,0x1f6,0xc3,0x1c5)},{id:_0x2fafce,prompt:_0xe8a263,width:_0x1e37e3,height:_0x313e26,change:_0xbab9fb}=_0x360019;function _0x5549ab(_0x477a1f,_0x4dffd5,_0x902f35,_0x33e2f9){return _0xb3e4(_0x477a1f- -0x147,_0x902f35);}addLog('收到SD生图请求\x20('+_0x5549ab(0x1ac,0x11d,0x201,0x232)+_0x2fafce+(_0x3f63ca(-0xd4,-0xff,-0xc5,-0xd8)+':\x20')+_0xe8a263+(_0xbab9fb?_0x3f63ca(-0x22b,-0x1c0,-0x14f,-0x266)+'\x20'+_0xbab9fb:''));function _0x3f63ca(_0x5ec37a,_0x13ed87,_0x4e1107,_0x3a4598){return _0xb3e4(_0x13ed87- -0x3a7,_0x3a4598);}if(_0xbab9fb&&_0xbab9fb[_0x5549ab(0x93,0x136,0x37,0x62)](_0x5c6bdb[_0x3f63ca(-0x236,-0x1ee,-0x21a,-0x272)])){if(_0x5c6bdb[_0x3f63ca(-0xec,-0xc1,-0x46,-0xa1)](_0x5c6bdb[_0x5549ab(0x6c,0x22,0x77,-0x13)],_0x5c6bdb[_0x3f63ca(-0x17c,-0x15a,-0x153,-0x14d)])){_0x5c6bdb[_0x3f63ca(-0x2a,-0xb7,-0x8c,-0x21)](_0x3f14d1,_0x3bee2e);return;}else{_0x5c6bdb['HZOBQ'](bananaGenerate,_0x360019);return;}}try{const {image:_0x17289d,change:_0x12b557}=await generateSDImage({'prompt':_0xe8a263,'width':_0x1e37e3,'height':_0x313e26,'change':_0xbab9fb});if(_0x5c6bdb[_0x5549ab(0xea,0x78,0x10b,0xb4)](extension_settings[extensionName][_0x3f63ca(-0x136,-0x15b,-0x1f7,-0xb6)],'0')){const _0x345229={};_0x345229['change']=_0x12b557,await _0x5c6bdb['YTylR'](setItemImg,_0xe8a263,_0x17289d,_0x345229),_0x5c6bdb['HZOBQ'](addLog,_0x3f63ca(-0x106,-0xfb,-0x93,-0x116)+_0x3f63ca(-0x16d,-0xf6,-0x176,-0x114)+'\x20'+_0xe8a263);}else _0x5c6bdb[_0x5549ab(0x18a,0x1ea,0x1a3,0xf1)](_0x5c6bdb[_0x3f63ca(-0x22d,-0x1e2,-0x182,-0x244)],_0x5549ab(0x107,0x183,0x5f,0x6f))?_0x5c6bdb[_0x3f63ca(-0x204,-0x1b6,-0x253,-0x150)](addLog,_0x5549ab(0x194,0x1db,0x187,0x128)+'库'):_0x5547d8[_0x3f63ca(-0x1b0,-0x1a8,-0x240,-0x117)+'sk'](_0x1cb206,![]);const _0x3dd1ac={};_0x3dd1ac['id']=_0x2fafce,_0x3dd1ac['success']=!![],_0x3dd1ac['imageData']=_0x17289d,_0x3dd1ac[_0x3f63ca(-0x252,-0x1d0,-0x256,-0x13d)]=_0xe8a263,_0x3dd1ac['change']=_0x12b557,eventSource[_0x5549ab(0xdb,0x4d,0x139,0x10f)](EventType['GENERATE_I'+_0x3f63ca(-0x1a6,-0x17d,-0x13f,-0xce)+_0x3f63ca(-0x237,-0x1c2,-0x19e,-0x258)],_0x3dd1ac),_0x5c6bdb[_0x3f63ca(-0x1f3,-0x1b6,-0x1a0,-0x25d)](addLog,_0x3f63ca(-0x193,-0x10c,-0x5e,-0x16e)+_0x3f63ca(-0x1a8,-0x189,-0x18a,-0xee)+_0x2fafce+')');}catch(_0x10a4ac){const _0x5c55c9=_0x5549ab(0x6b,0x107,-0x21,-0x3b)+_0x5549ab(0xb3,0xb1,0xcb,0xbc)+_0x2fafce+_0x5549ab(0x19e,0x240,0x11a,0x23c)+_0x10a4ac[_0x5549ab(0xad,0xe,0x23,0x44)];_0x5c6bdb[_0x5549ab(0x1a9,0x24d,0x227,0x1de)](addLog,_0x5549ab(0xfb,0x185,0x11b,0x6c)+_0x5c55c9),console[_0x5549ab(0xbc,0x15d,0x12b,0xdf)](_0x5c6bdb['gsgWd'],_0x10a4ac);const _0x31e494={};_0x31e494['id']=_0x2fafce,_0x31e494[_0x5549ab(0x101,0x61,0xe3,0x181)]=![],_0x31e494[_0x3f63ca(-0x22c,-0x1a4,-0x21c,-0x1eb)]=_0x10a4ac['message'],_0x31e494['prompt']=_0xe8a263,eventSource['emit'](EventType[_0x5549ab(0x180,0x1fb,0x213,0x19a)+'MAGE_RESPO'+'NSE'],_0x31e494),_0x5c6bdb[_0x5549ab(0x1a9,0x197,0x217,0x123)](addLog,'发送SD生图失败响应'+_0x5549ab(0xd7,0xb5,0x16b,0x6d)+_0x2fafce+')');}}function initializeSDListener(){const _0x21c01c={'vTLrX':function(_0x20fd6f,_0x174863){return _0x20fd6f(_0x174863);},'mmfME':_0x2970f2(0x3bc,0x3af,0x382,0x333)+_0x4e8f17(0x492,0x4c5,0x41b,0x420)};function _0x4e8f17(_0x16cb8d,_0x473a78,_0x498480,_0x466421){return _0xb3e4(_0x498480-0x143,_0x16cb8d);}eventSource['on'](EventType['GENERATE_I'+_0x4e8f17(0x26e,0x2ee,0x2f4,0x248)+'ST'],sdGenerate);function _0x2970f2(_0x3c3a01,_0x49d12a,_0x3da4e0,_0x1b4b5b){return _0xb3e4(_0x49d12a-0x1dc,_0x3da4e0);}_0x21c01c[_0x2970f2(0x55d,0x4d3,0x578,0x4ef)](addLog,_0x21c01c[_0x2970f2(0x41b,0x3cf,0x46b,0x429)]);}export async function replaceWithSd(){const _0x255849={'aIOyp':function(_0x22c11e,_0x31c695){return _0x22c11e(_0x31c695);},'lXTxr':function(_0x455ad5,_0x4361a5){return _0x455ad5(_0x4361a5);},'SeSas':function(_0x591414,_0x2da24a){return _0x591414==_0x2da24a;},'ZKEpn':function(_0x9f2594,_0x225408){return _0x9f2594===_0x225408;},'XpPFQ':_0x4003d1(0x272,0x1fd,0x20a,0x1f4),'dXVHs':_0x4003d1(0x1b9,0x170,0x1be,0x1c5),'lFIhM':function(_0x5abbe8){return _0x5abbe8();},'RkYlY':function(_0x46e9bb){return _0x46e9bb();},'GgPSu':function(_0x49cc18,_0x22913e){return _0x49cc18(_0x22913e);},'fzxcb':_0x4003d1(0x171,0x19b,0x1e1,0xe3)+_0x4003d1(0x1d3,0x23a,0x199,0x209)};function _0x4003d1(_0x48f177,_0x127605,_0x59e560,_0x4969ed){return _0xb3e4(_0x48f177- -0x62,_0x127605);}function _0x23e881(_0x5338ae,_0x1f2f84,_0x433a1f,_0x6b91bf){return _0xb3e4(_0x1f2f84- -0x228,_0x6b91bf);}if(_0x255849[_0x23e881(-0x23,0x7f,0x120,0xbf)](extension_settings[extensionName][_0x23e881(0x52,0x12,-0x65,-0x4c)],'sd')){if(_0x255849[_0x4003d1(0x20d,0x2b0,0x272,0x189)](_0x255849[_0x4003d1(0x209,0x176,0x276,0x21e)],_0x23e881(-0xf,-0x1c,0x66,-0x94))){_0x255849['aIOyp'](_0x3f361e,_0x4003d1(0x270,0x215,0x2b8,0x305)+_0x53a3a3[_0x23e881(-0x23,-0x50,-0xff,-0xb8)]+'\x20'+_0x552857['statusText']);throw new _0x4e2b5f(_0x23e881(0x152,0xaa,0x3b,0x72)+_0x5823eb['status']+'\x20'+_0x68faf7['statusText']);}else{if(!window[_0x23e881(-0xdb,-0x45,0x63,-0x4f)+'SDListener']){if(_0x255849[_0x23e881(0xd,0x9c,0x4,0xfd)]===_0x4003d1(0x1b9,0x185,0x186,0x1d0))window[_0x23e881(0x60,-0x45,0x58,-0x82)+_0x4003d1(0x1f4,0x270,0x1e0,0x19f)]=!![],_0x255849[_0x4003d1(0x24d,0x29c,0x240,0x26a)](initializeSDListener);else{_0x255849[_0x4003d1(0x21a,0x253,0x2c8,0x23b)](_0x53c96a,_0x23e881(-0x17,0x98,0x42,0x13)+':\x20'+_0x43fbcb[_0x23e881(0x5b,-0x34,-0xd9,0x50)]+(_0x23e881(0xdc,0x91,0x120,0x4a)+_0x4003d1(0x218,0x168,0x16e,0x2bf)+_0x23e881(0x6d,0xbb,0xb8,0xd2))),_0x42090a[_0x4003d1(0x19d,0x106,0xff,0x1f6)+'sk'](_0x2ef0f5,![]),_0x427c49=null;throw new _0x15858d('获取或者切换模型失败'+_0x23e881(-0x51,-0x65,0x12,-0x2)+_0x23e881(0xe6,0x52,0xc,-0x52)+'查模型是否正确。');}}_0x255849['RkYlY'](initializeImageProcessing);}}else window[_0x23e881(0x4e,-0x45,0x42,-0xb9)+'SDListener']&&(eventSource[_0x23e881(0x15,0xa5,0x4a,0x99)+_0x4003d1(0x190,0x103,0x184,0xeb)](EventType[_0x4003d1(0x265,0x2bf,0x308,0x257)+_0x4003d1(0x14f,0x1c9,0xe7,0x1c7)+'ST'],sdGenerate),window['initialize'+'SDListener']=![],_0x255849[_0x23e881(0xca,0xdd,0x90,0xf0)](addLog,_0x255849['fzxcb']));}