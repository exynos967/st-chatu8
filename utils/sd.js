(function(_0x2d2df9,_0x2a154d){const _0x165ad0=_0x2d2df9();function _0x567c84(_0x21aaad,_0x352d35,_0xdc1783,_0x36b326){return _0x52f7(_0x21aaad- -0x26c,_0x36b326);}function _0x53c952(_0x422a1a,_0x5d1044,_0x87dadd,_0x4eeb8d){return _0x52f7(_0x422a1a- -0x5f,_0x5d1044);}while(!![]){try{const _0x394966=-parseInt(_0x567c84(0x9e,0x75,-0xf,0xbb))/(-0x20*-0x13+0xa*0xef+-0xbb5)*(-parseInt(_0x53c952(0x21a,0x1be,0x20c,0x2ac))/(0x627+0x25af*0x1+-0x2bd4))+-parseInt(_0x53c952(0x1c4,0x1a6,0x188,0x1b6))/(-0x1*-0x1610+0x5*-0x3ee+0x5*-0x7b)+-parseInt(_0x53c952(0x277,0x305,0x280,0x281))/(0x3*-0x8b5+0x40d+0x1616)+parseInt(_0x567c84(-0xa5,-0x2c,-0x144,-0x64))/(-0x6d*0x37+-0x4d8+0x1c48)+parseInt(_0x53c952(0x20e,0x240,0x179,0x21b))/(-0x1*-0xb67+-0x1621+-0xac0*-0x1)*(parseInt(_0x53c952(0x2c2,0x2c5,0x2cf,0x30e))/(-0xf3f+-0x668+0x15ae))+-parseInt(_0x53c952(0x18b,0x133,0x146,0x195))/(0x1f*0x67+0x20ab+0x2d1c*-0x1)*(-parseInt(_0x53c952(0x17b,0x171,0x19f,0x230))/(-0x1*-0x1336+-0x2eb+-0x821*0x2))+-parseInt(_0x53c952(0x192,0x169,0x15b,0x12f))/(-0x14cf+-0x47*0x3d+0x25c4)*(-parseInt(_0x567c84(-0x7e,-0x55,-0x15,-0x89))/(0xa1f*0x1+-0xa6f+0x5b));if(_0x394966===_0x2a154d)break;else _0x165ad0['push'](_0x165ad0['shift']());}catch(_0x33f044){_0x165ad0['push'](_0x165ad0['shift']());}}}(_0x8d60,-0xaf714+0xa4176+0x1*0x83d01));const _0x35c726=(function(){let _0xbb5268=!![];return function(_0xa2cc22,_0x1137c1){const _0x6aab03=_0xbb5268?function(){function _0x4326b3(_0x1f5dfa,_0x4e48fd,_0x38de36,_0x3c4e87){return _0x52f7(_0x3c4e87- -0x28b,_0x38de36);}if(_0x1137c1){const _0x19dd88=_0x1137c1[_0x4326b3(-0xe9,-0xb0,-0x5e,-0xbb)](_0xa2cc22,arguments);return _0x1137c1=null,_0x19dd88;}}:function(){};return _0xbb5268=![],_0x6aab03;};}()),_0x444b41=_0x35c726(this,function(){function _0x30f24d(_0x4dbc80,_0x78a295,_0x1be3e6,_0x373281){return _0x52f7(_0x4dbc80-0x170,_0x1be3e6);}const _0x41f478={};function _0x3c17fb(_0x1369a3,_0x38b1f4,_0x29473b,_0x4ce7c7){return _0x52f7(_0x29473b-0x13a,_0x38b1f4);}_0x41f478[_0x30f24d(0x452,0x430,0x4d7,0x40c)]=_0x30f24d(0x368,0x3ba,0x2f5,0x33d)+'+$';const _0x6085d8=_0x41f478;return _0x444b41[_0x30f24d(0x400,0x448,0x481,0x3d1)]()[_0x30f24d(0x3ff,0x481,0x399,0x485)](_0x6085d8[_0x30f24d(0x452,0x41e,0x4a1,0x507)])[_0x3c17fb(0x437,0x3d6,0x3ca,0x34c)]()[_0x30f24d(0x3b3,0x3dc,0x44a,0x367)+'r'](_0x444b41)['search'](_0x6085d8[_0x30f24d(0x452,0x3e9,0x47b,0x496)]);});_0x444b41();import{sleep,zhengmian,fumian,deepMerge,getSDMode,setSDMode,addLog,getRequestHeaders,clearLog,prompt_replace,getsdAuth,parsePromptStringWithCoordinates,prompt_replace_for_character,stripChineseAnnotations,convertImageToJpeg}from'./utils.js';import{setItemImg}from'./database.js';import{extension_settings}from'../../../../extensions.js';function _0x52f7(_0x1b32c8,_0x2756b9){_0x1b32c8=_0x1b32c8-(0x3a*0x75+-0x82f*0x4+-0x1*-0x7fb);const _0x2eb36f=_0x8d60();let _0x499871=_0x2eb36f[_0x1b32c8];if(_0x52f7['ReleNH']===undefined){var _0x48f508=function(_0x8e61ce){const _0xf8c5d6='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x536cab='',_0x564583='',_0x59ce45=_0x536cab+_0x48f508;for(let _0x25703b=0x1f*0xa3+0x7*0x1e8+-0x2115,_0x5d3fb2,_0x4bcc88,_0x193dbc=0x1b16*-0x1+-0x226*-0xb+0x374;_0x4bcc88=_0x8e61ce['charAt'](_0x193dbc++);~_0x4bcc88&&(_0x5d3fb2=_0x25703b%(0x14e0+0x8c3*0x2+-0x1*0x2662)?_0x5d3fb2*(0x1310+-0x1d5*-0xb+-0x26f7)+_0x4bcc88:_0x4bcc88,_0x25703b++%(-0x13ee+-0x64*-0x27+-0x1*-0x4b6))?_0x536cab+=_0x59ce45['charCodeAt'](_0x193dbc+(-0x202f+0x1365+0xcd4))-(-0x21a7*-0x1+0x1a8d+-0x3c2a)!==0x1*0xb2a+0x112*0x1d+-0x2a34?String['fromCharCode'](-0x1*-0x2029+0xa8c+-0x13*0x232&_0x5d3fb2>>(-(0x7*-0x362+0x161+-0x164f*-0x1)*_0x25703b&0x1a1f+0x2008+-0x1*0x3a21)):_0x25703b:0x192d*-0x1+0x154*0x2+0x1*0x1685){_0x4bcc88=_0xf8c5d6['indexOf'](_0x4bcc88);}for(let _0x3155d7=-0x193d+-0x3a0*0x4+0x3*0xd3f,_0x1906e2=_0x536cab['length'];_0x3155d7<_0x1906e2;_0x3155d7++){_0x564583+='%'+('00'+_0x536cab['charCodeAt'](_0x3155d7)['toString'](0x218+-0x105+-0x103))['slice'](-(0x6f*0x31+-0x581+-0xfbc));}return decodeURIComponent(_0x564583);};_0x52f7['GGUtGK']=_0x48f508,_0x52f7['QctLwS']={},_0x52f7['ReleNH']=!![];}const _0x458d9d=_0x2eb36f[-0x1edb+0x814+0x341*0x7],_0x571029=_0x1b32c8+_0x458d9d,_0x4b209=_0x52f7['QctLwS'][_0x571029];if(!_0x4b209){const _0x21cb71=function(_0x370def){this['dfDrLy']=_0x370def,this['jZhttJ']=[0x35a+0x1*0x193b+-0xec*0x1f,-0x4*-0x901+-0xf93+-0x1471,0x31*-0x57+-0x24f4+0x1*0x359b],this['zHTDgE']=function(){return'newState';},this['gkMhAT']='\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*',this['JpyhSZ']='[\x27|\x22].+[\x27|\x22];?\x20*}';};_0x21cb71['prototype']['pSpzAb']=function(){const _0x3e02d9=new RegExp(this['gkMhAT']+this['JpyhSZ']),_0x5de51a=_0x3e02d9['test'](this['zHTDgE']['toString']())?--this['jZhttJ'][0x8e*0x1a+0x1b*0x90+-0x247*0xd]:--this['jZhttJ'][-0xf85+0xb1*-0x7+0xa2e*0x2];return this['JGmJLN'](_0x5de51a);},_0x21cb71['prototype']['JGmJLN']=function(_0x21aaa4){if(!Boolean(~_0x21aaa4))return _0x21aaa4;return this['cOrAWp'](this['dfDrLy']);},_0x21cb71['prototype']['cOrAWp']=function(_0x1a18e3){for(let _0x6a7053=0x9*-0x4f+-0x6*0x10e+-0x309*-0x3,_0x3096bb=this['jZhttJ']['length'];_0x6a7053<_0x3096bb;_0x6a7053++){this['jZhttJ']['push'](Math['round'](Math['random']())),_0x3096bb=this['jZhttJ']['length'];}return _0x1a18e3(this['jZhttJ'][0x9*0x38+-0x5c*0x26+0xbb0]);},new _0x21cb71(_0x52f7)['pSpzAb'](),_0x499871=_0x52f7['GGUtGK'](_0x499871),_0x52f7['QctLwS'][_0x571029]=_0x499871;}else _0x499871=_0x4b209;return _0x499871;}import{extensionName,EventType}from'./config.js';import{saveSettingsDebounced,eventSource}from'../../../../../script.js';import{initializeImageProcessing}from'./iframe.js';function _0x8d60(){const _0x3acda4=['Bg9N','vMPsANm','q0nXz24','v09LANO','CvD3r1G','BMvYyxrPB24','EMGTq04SEMG7Cq','C2rdzMDty2fSzq','y29UC3rYDwn0BW','5lU75yQH5BEY6kkR55sO5OI35y+w5RAi44cc','qwvjCKG','C3bSAxq','Aw1Hz2veyxrH','zMfJzsdKUlRLVidLKk8','5Ps25yIWu0tNLj/LM77OR7FMSyiGka','B3zLCNjPzgvFCW','6zQp5PY6kc0Xkq','AgvPz2H0','qvbj5zon5BQu5lIT5PYQ5OM+5yIW5zU+','sMTWCxK','ruf6y2m','vMjLyKq','ChvAuM4','y2v6B1y','y21VzgvSmJiYmG','ue9tva','zLrPC2C','B29pAgO','y2vZioIeUoMdQos/RUwKJsdKUlO','q2fJAguTq29UDa','y2vZ','tLv4u2O','q2HHCMfJDgvYia','suvPz1C','r21hDwC','ifn0CMvUz3rOkq','y2zNx3nJywXL','sMDJzuS','C2rFy2rLBM9PCW','5lI6Dhj1zq','6AUy5RIf5l+U5Asnios4UG','D2LKDgG','BgvY','AfLlCNO','oIOQia','l2fWAs9Zzc9Nzq','zvzfANe','ifbYB21WDa','CKDJEMC','DtHFC2rFyxv0Aa','nK1ICuj2tW','C2rFy2HPCMvZxW','yw1L','C3rLChm','DxbKyxrLu3rHDa','q29UDgvUDc1uEq','B3nPDgLVBG','qwnJzxb0','yxbWBgLJyxrPBW','vev4tLa','zfnnv1K','B2rLBcK6kIOG','mZe1odK0qNvHBMDL','sLLMrhu','A1jfEMm','mxWZFdb8nhWYFa','C2rFy2HLAwDODa','tuHHvey','v2LUnJq7ihG2na','uhPTt0m','wKTqreK','5Q2J5zYO6ycA6l+hC2r3zwj1','of92ywu','zhbKB1q','55sO5lQo55sF5OIq55QevgfNoIa','vKPmreK','of9TB2rLBa','C2rFyxv0Aa','svDjqMi','6zsz6k+VoIa','ywrLDgfPBgvYxW','C2r3zwj1AEEuN+wBVUwpGG','DxjS','Dgv4Da','C2vHCMnO','Dg9tDhjPBMC','C2rFC3rVCf9Nzq','rxjYB3iGz2vUzq','Cgf5C3rFy2HHDa','cI0GkIRPQ5JMUixKV67LPi0G','AML1z3vHBG','lcdOR6BMG4u6ia','kerPDMLKzv9YBW','quTHA0O','u2TPCdOQkIa','CxHYsgm','kfjLC3rVCMuGrG','BM8Ty2fJAgu','6k+35Rgc5AsX6lsLloEkTUAaGEEGGtOG','DKrUy2K','tufhrv9srvnqtW','EwDkzNq','icHlsfrntcWGBa','ugvoB0W','CMf0Aw5NigLTyq','r3PxA1a','DxblBum','zw1PDa','Burlt3e','ExvZAgu','vxnLCI1bz2vUDa','zxvL','5yIh5O2I5QIH5z6l5AsX6lsLoIa','AKj6BMK','zv9Mywn0B3i','DvvptwS','BMvYyxrL','5BEY5yID5AEl5yYw44cc','AK9OEhm','lI4U','v2riC2u','ywnLCYK6kIOG','u2nLBMuGq29TCa','sMHsExC','CM9S','r2X5t2y','EgLHBMnOzw5Nia','B3jvvNG','ksaTifbYB21WDa','CgP4zKK','wK9HAK0','BxD0Cxi','Bw9KzwW','ww1Ku0q','CejMDxe','kerLBM9PC2LUzW','cI0GkIRMQkhLNOSGke0','EgLHBMnOzw5N','44cc5zon5BQu5yAf5A65oIa','s3HNwgi','kfnHBxbSzxiPoG','C2fTCgXLCL9Uyq','thLZB28','ienOCM9Tzs8XmG','of9Zy2HLzhvSzq','Aw1Hz2u','ktOG','5zon5BQu5yAf5A65oG','sgTYA0C','z2zQq1e','Cgf5Bg9Hza','ufLyz2C','Dhj1zq','cI0GkIPbrgv0yq','A2LW','mZi5odaXmM93ugDsBW','y2fSztOQkIa','6i635y+w5QIH5z6l5AsX6lsLoIa','cI0GkIPdBgLWia','5zU+5y+c5PwW5OQL5zgkcI0GkIO','AEAyR+wqPUATO+w4UowqR+wkQo+8Jow5TUAJGa','uvH3AMS','u3fTEwq','CNr1uwC','zw5HyMXLx2HYia','D01cwNa','5z2q5Qch55Qe5O+q56s66k+n5A2x56YM5lIY44cc','DLbQCeW','DgvYDMfS','CMvZDg9Yzv9Myq','rg9KCxK','AvDVAfu','Aw9U','zMfJzv95B2XVDG','cI0GkIRMRAxMLBaGkfm','zgf0ytPPBwfNzq','5BcD6k+v5l2C5lI65y6F5AEliejHCW','s055vNC','A3DuEuK','5Q2J6z2I5O+q56s6icHqCM9T','6k6+572U5QIH5z6llI4U5lI6','vKXQwMC','vKzxv1K','r0vorvjbvevFsq','vurvt2O','cI0TlqOJiYmG55sF','C3rHDhvZ','ENLiBvC','zgHQAgm','ksbbChbSzvDLyG','Df9LBMq','AxnuyxnRsw5rDq','zgvUB2LZAw5NxW','u0rmAxn0zw5LCG','D05Vque','uhjVBxb0ktOQkG','runACuO','cI0GkIROHlJPG6JKV67LPi0G','Bw9Kzq','cI0GkIRPH43NU5JLUyxLUQyG','DhjPBq','zML4zwrqCM9TCa','ywrKvgfZAW','ExvZAgvPzf9Zza','y0nPrMm','DwrjwuG','uKryvvu','mw9IyNvVsG','CMf0Aw5Nifneia','zw5HyMXLx2HY','qwHkBNi','5Q2J5zYO6k6+572U5QIH5z6llI4U5lI6','5lU75yQH5BEY5y+w5RAi','icHjrdOG','D1jKvhi','ic0Gq2HHBMDLoG','5P+L5QIH5z6l5PIV5zcM5Q2J56gU44cc','5y+r6ycbu0tNLj/LM77LPlhOTkxLK43LUPq','sfz6sMC','C2rFy2nOyxr1xW','vM1AC28','CNvUBMLUzW','5lIT55QeihbYB21WDooaGG','cI0TlqOGicaG','ke5Lz2f0AxzLia','z2r1DKK','Dg9Rzw4','kI8Q','cI0GkIRPH4FMOlFMLRNMS5uG','zfrHuvC','mJK2mta3mfvZExfSsa','uLL1q1u','cI0GkIRNP43LRzaGkfm','DhH0mMLTzW','DfftB00','E+s/RUwBVN0','6yws6AAgioI/LowBNUMuMEIVR+oaGUEkTUAaGq','Aw5PDgLHBgL6zq','wgLvu1e','EuHty0O','5Q2J5zYO6k6+572U5QIH5z6l5lI6','C2vLza','Bg9Hza','Aw1Hz2vZ','C3rFy2HHDhu4xW','5yYw5lI6igrHDgeGvvi','y2HHBMDL','mZa4nZC1nwLot0vivq','6i635y+w5OIw6icf5yIh5O2I5QIH5z6l5AsX6lsL','u0qG55sF5zU+5lQl5lU255Ur5zcS5zMO','yxv0Aa','u0qGqvbjioI/LowBNUMuMq','zxr0Aw5NCW','Buvwt20','BLHAtxq','zwvKktOQkIa','yxbWBhK','uKjtuMK','AK1dsuO','ktOQkIa','A21bqNG','BuzwvwG','y2fJAgu','5Q2J5zYO5yIh5O2I5QIH5z6l5lI6','Egzlzxy','5zU+5yop5BEY5A2y5ywL5PwW5O2U5BQtigy','mtu1oda4yxzotNPu','BgvUz3rO','CgvNu3rVCMfNzq','BgXHveK','5BI4icHjrdOG','z3vHz2u','y29UDMvYDfrVsG','CMvZDg9YzuzHyW','kIOG','sen0D1i','57Yt5A2y6k6+572U5lI65lIn5A2y5ywL5PwW5O2U','tufhrv9srvfvrq','of91ChnJywXLCG','ptaUosXLBJTXpq','zMfYAs81mZCUmW','mc4WlJaUmcbtyq','mtyWv2HktKfU','yMTUzNu','C2rFy2nSAxbFCW','ru1PAKq','mtfiAwLyC3C','Bu9YAKq','qvfux3nK','mJu5ndG2mfLqsNnSDG','44cc6k+35Qoa5P+LC2r3zwj1','y0f0D1e','C2tOR7FMSylNLj/LM77PLjNOR686ia','DKj0qu0','wNfyq1m','uxzPr3y','kcGOlISPkYKRkq','zty0ioAvSoAnRUwKHoEqHUoaGG','q1vqBKK','suq6ia','5Qch5yEg5QIH5BYpoIdKVB/NLkJOR7FMSyi','Aw1Hz2u6','C2rFy3n0zxbZ','qMrOs2y','AgTQyMW','BwvZC2fNzq','BwfYzuq','BgTVyvG','ChjAuvu','of9Zyw1WBgvYtG','uxHXwuG','C2rFDMfL','ie5uideWlJa7ia','C3rYAw5NAwz5','ru91uem','cI0GkIRMLl7LPkFLGi3NJOCG','Dc1TB2rLBa','q0Xjuf9ZDg9WxW','C2rFy2fKzxrHAq','zxH0zw5ZAw9UxW','zw5LCG','C3rHDhvZvgv4Da','AEEuN+AiKowBVUEjHY4UlUwUOUAiTW','EhzSCwG','Aw1Hz2vhzw5jBG','EfLuyKe','zML4','5BEY5ywZ6zET44cc','sKnSsLO','s2L0lZuZnY4ZnG','tgrsC28','DMjswfG','u0tNLj/LM77MTyhNQiVMJzxOJRFLIldLVii','zxjYB3i','t3foDM0','suTwtgO','kfvWC2nHBguGrG','AwTLieDLy2TVkq','r0rMDhu','mtq1odK2mgDLAKPsAa','Aw5JBhvKzxm','y29TCgXLDgvuyq','B1LMq3q','C2rFy3vWC2nHBa','56cboIa','sLnptIdOP6pMNPdLPlhOTkxVViW','r1blANq','z2u6','C2v0DgLUz3nZlG','C3vJy2vZCW','cI0GkIROTj/PNAlMJ5dNPlOG','tLnf','uhjHz21H','DfjrB3q','y2XPzw50','DKvjCeC','ChjVBxb0','tfvMB3q','AKHZA0W','loAOOEwEI+s4UG','vMTNqK0','zgPsDMG','CgfYC2u'];_0x8d60=function(){return _0x3acda4;};return _0x8d60();}import{processCharacterPrompt}from'./characterprompt.js';import{bananaGenerate}from'./banana.js';import{taskQueue,TaskType}from'./taskQueue.js';function getDirectHeaders(_0x76321c=null,_0x38bd9c=null){const _0x32f699={};function _0x426e1c(_0x3b6203,_0x39574b,_0x3bd208,_0x94b0d0){return _0x52f7(_0x3bd208-0x3da,_0x3b6203);}_0x32f699['tRQot']=_0x426e1c(0x67b,0x64b,0x64c,0x63e)+'pe',_0x32f699[_0x426e1c(0x6e6,0x62d,0x692,0x600)]=function(_0x54d94a,_0x5c8ebc){return _0x54d94a+_0x5c8ebc;},_0x32f699[_0x3c806a(0x482,0x55d,0x4e5,0x4b8)]='Mozilla/5.'+'0\x20(Windows'+_0x426e1c(0x5ea,0x5e6,0x5e2,0x5e5)+_0x426e1c(0x6ce,0x6a3,0x659,0x65d)+_0x3c806a(0x606,0x548,0x5b7,0x5cc)+_0x426e1c(0x698,0x540,0x5f3,0x5ef)+_0x426e1c(0x5ea,0x68f,0x67b,0x5f6)+_0x426e1c(0x683,0x570,0x5fb,0x62a)+_0x426e1c(0x635,0x6e4,0x6a4,0x5f7)+_0x3c806a(0x489,0x47b,0x4a8,0x434)+_0x426e1c(0x649,0x5f4,0x5c2,0x566)+'6',_0x32f699[_0x3c806a(0x487,0x4c9,0x4fd,0x516)]=_0x3c806a(0x5b7,0x658,0x5dd,0x5d1),_0x32f699[_0x426e1c(0x737,0x6d7,0x69a,0x6d8)]=_0x3c806a(0x47a,0x522,0x500,0x55a)+_0x426e1c(0x5c4,0x50c,0x5c1,0x564)+'0.8',_0x32f699['Sqmyd']=_0x3c806a(0x593,0x5ed,0x55b,0x5b1),_0x32f699[_0x426e1c(0x60b,0x630,0x634,0x5e6)]=function(_0x35847b,_0x40fe04){return _0x35847b!==_0x40fe04;},_0x32f699[_0x3c806a(0x584,0x61b,0x59d,0x597)]=_0x426e1c(0x596,0x552,0x5b2,0x5a3);function _0x3c806a(_0x120b7a,_0x2f4973,_0x3865e4,_0x69f6eb){return _0x52f7(_0x3865e4-0x2bf,_0x69f6eb);}_0x32f699['CUPnI']=function(_0x3fcffb,_0xe283f2){return _0x3fcffb!==_0xe283f2;},_0x32f699[_0x3c806a(0x5a8,0x59d,0x536,0x4d4)]='IEigW',_0x32f699[_0x426e1c(0x64b,0x6fc,0x688,0x730)]='Authorizat'+_0x426e1c(0x6e2,0x6bd,0x6c1,0x6c9);const _0x378437=_0x32f699,_0x383b21={};_0x383b21[_0x426e1c(0x650,0x6d8,0x683,0x5dc)]=_0x378437[_0x3c806a(0x55e,0x4ea,0x4e5,0x515)],_0x383b21[_0x426e1c(0x63d,0x5d7,0x64e,0x675)]=_0x378437[_0x3c806a(0x583,0x5ac,0x4fd,0x59b)],_0x383b21['Accept-Lan'+_0x3c806a(0x4d7,0x422,0x49e,0x497)]=_0x378437[_0x3c806a(0x58e,0x512,0x57f,0x600)],_0x383b21[_0x426e1c(0x649,0x5cc,0x632,0x583)+_0x3c806a(0x53d,0x536,0x576,0x5f8)]=_0x378437[_0x426e1c(0x734,0x635,0x6b7,0x6d3)],_0x383b21[_0x426e1c(0x65d,0x636,0x60a,0x55b)]=_0x378437['Sqmyd'];const _0x49b036=_0x383b21;return _0x76321c&&(_0x378437[_0x3c806a(0x529,0x5ba,0x519,0x4d4)](_0x378437[_0x426e1c(0x761,0x6ef,0x6b8,0x675)],'xfKev')?_0x40e87d[_0x378437['tRQot']]=_0x8fd8a0:_0x49b036[_0x378437[_0x3c806a(0x4ae,0x51f,0x4f0,0x470)]]=_0x76321c),_0x38bd9c&&(_0x378437[_0x426e1c(0x659,0x685,0x5d4,0x623)](_0x378437['dSMWY'],_0x3c806a(0x4d1,0x49e,0x51b,0x5a4))?_0x53ff48=_0x378437[_0x3c806a(0x5ef,0x53c,0x577,0x61a)](_0x378437[_0x3c806a(0x5ef,0x61c,0x577,0x5bf)](_0x51c886,',\x20'),_0x58019e(_0x55f156[_0x3c806a(0x4c1,0x465,0x51a,0x481)+_0x1ad90a+_0x426e1c(0x5a1,0x6ed,0x644,0x5a6)])):_0x49b036[_0x378437[_0x426e1c(0x6dc,0x72a,0x688,0x61a)]]=_0x38bd9c),_0x49b036;}let currentTaskId=null;async function generateSDImage({prompt:_0x57f86b,width:_0x217613,height:_0x66d285,change:_0x17e703}){const _0x25f35c={'PeNoL':function(_0x7f32e9,_0x3b8985){return _0x7f32e9(_0x3b8985);},'kwTyI':function(_0x36bbff,_0x620a45){return _0x36bbff(_0x620a45);},'mQDYl':_0x2fcc31(0x172,0x208,0x17b,0x198)+'5','qxrHc':_0x2fcc31(0x2ac,0x21e,0x28a,0x2cb)+_0x2fcc31(0x1a6,0x22f,0x1ae,0x201)+_0x2fcc31(0x1d5,0x1b7,0x10b,0x22d),'JClJZ':_0x2fcc31(0x200,0x29b,0x224,0x21d),'vbRXX':function(_0x456454,_0x570828){return _0x456454(_0x570828);},'eJFUt':_0x4e2d1f(0x39,0xac,0x6e,0x5)+'rating\x20SD\x20'+_0x2fcc31(0x1c5,0x189,0x166,0x14c),'wOvHo':function(_0x555e15,_0x168e23){return _0x555e15<=_0x168e23;},'RBSRi':function(_0x1ecd65,_0x51cb7c){return _0x1ecd65+_0x51cb7c;},'tQSoM':_0x2fcc31(0x1de,0x1d0,0x1e9,0x14d),'gduvI':_0x4e2d1f(0xac,0xbf,0x1a,0x2c)+_0x2fcc31(0x169,0x1ee,0x2a4,0x1d6),'upKmC':'Authorizat'+'ion','hkjbl':_0x4e2d1f(-0x69,-0x93,-0x7c,-0x87),'RDXUU':function(_0xafb396,_0xc8fee4){return _0xafb396+_0xc8fee4;},'EAzcc':function(_0x266c67){return _0x266c67();},'DxknX':function(_0xc00529,_0x3c64d2){return _0xc00529||_0x3c64d2;},'mareD':_0x4e2d1f(-0x88,-0x87,-0x2e,0x25),'ygJft':function(_0xfab747,_0x1930eb){return _0xfab747(_0x1930eb);},'RYuCU':function(_0x49f1c4,_0xd5d232){return _0x49f1c4(_0xd5d232);},'dTaQW':_0x2fcc31(0x1d7,0x241,0x288,0x218)+_0x2fcc31(0x232,0x1ff,0x251,0x296),'puZRn':'NDMED','kCgGr':_0x4e2d1f(0x101,0x123,0xa7,0x7b),'fTisg':'分角色模式:\x20解析带'+_0x4e2d1f(0x74,0x5b,-0xd,0x54),'nXZMt':function(_0x32bbca,_0x3bb81d){return _0x32bbca<=_0x3bb81d;},'VJLDI':_0x2fcc31(0x103,0x188,0xf5,0x172)+_0x2fcc31(0x203,0x2a5,0x25c,0x234),'qWwGX':_0x4e2d1f(0x30,0x18,-0x49,0xb),'KNyVw':_0x2fcc31(0x246,0x1e2,0x233,0x21d),'BOZRJ':function(_0x484fef,_0x1dfb6c){return _0x484fef<=_0x1dfb6c;},'BdhKf':function(_0x1abca6,_0xafb63){return _0x1abca6!==_0xafb63;},'slOMy':_0x2fcc31(0x1dc,0x160,0xbd,0x12a),'mwtqr':_0x4e2d1f(-0x6c,-0xc6,-0xcb,-0xb0),'pBfuq':function(_0x105ad9,_0x4e81ce,_0x3935d1,_0x11b863,_0x384a85,_0x589f31){return _0x105ad9(_0x4e81ce,_0x3935d1,_0x11b863,_0x384a85,_0x589f31);},'orUVx':function(_0x57a2e2,_0x4cdbd7,_0x1a0c0c){return _0x57a2e2(_0x4cdbd7,_0x1a0c0c);},'cLjrW':function(_0x719174,_0x4f5d52){return _0x719174(_0x4f5d52);},'wMBZp':'auto_url','xqNci':function(_0x265888){return _0x265888();},'mDKOq':function(_0x2ac494,_0x458659){return _0x2ac494===_0x458659;},'WiuTs':'MMFfi','zyHmW':'DSlXT','EOuPC':_0x4e2d1f(0x62,0x90,-0xa7,-0x25)+_0x4e2d1f(-0x9d,-0x110,-0x18,-0x81),'sTrBO':_0x2fcc31(0x163,0x1df,0x220,0x263)+'2222','aIGNh':'/api/sd/se'+_0x4e2d1f(-0x4,0xc,-0x49,-0x81),'dpdoT':'POST','jMCIJ':function(_0x350c2a,_0xd8f541){return _0x350c2a!=_0xd8f541;},'ztPal':function(_0x26ff91,_0x2d516e){return _0x26ff91===_0x2d516e;},'GDftu':_0x2fcc31(0x1d5,0x1c5,0x24e,0x15d),'cezoV':function(_0x5aa3c4,_0x31c61f){return _0x5aa3c4(_0x31c61f);},'GzWkP':_0x4e2d1f(0xac,-0x41,-0x1e,0x3c),'OqNvm':function(_0x526bcf,_0x1fc52a){return _0x526bcf!==_0x1fc52a;},'KxgXb':function(_0x283f54,_0x10276c){return _0x283f54(_0x10276c);},'ZOajM':function(_0x1ba1f0,_0x212737){return _0x1ba1f0(_0x212737);},'VFWWY':function(_0x4410f3,_0x25c6c4){return _0x4410f3>=_0x25c6c4;},'iYQxB':function(_0x22b8a3,_0xd78ef1){return _0x22b8a3(_0xd78ef1);},'iWohU':function(_0xe06eef,_0x265ce8){return _0xe06eef(_0x265ce8);},'jBzni':function(_0x3ef723,_0x8b8043){return _0x3ef723==_0x8b8043;},'VbebD':_0x2fcc31(0x2d6,0x25f,0x2d9,0x275),'iPwQd':function(_0x283a5b,_0xd95c74){return _0x283a5b==_0xd95c74;},'GmGug':function(_0x1639e7,_0x19a2bd){return _0x1639e7(_0x19a2bd);},'dhjhc':_0x2fcc31(0x177,0x217,0x209,0x1f7)+_0x4e2d1f(0x61,-0x8b,-0x16,-0x45),'LdRso':function(_0x37a82a,_0x3b6f25,_0x36421f){return _0x37a82a(_0x3b6f25,_0x36421f);},'RWqEG':_0x4e2d1f(0xc8,-0x47,-0xc,0x5b)+'8n.pt','IWIBb':_0x2fcc31(0x272,0x1d7,0x14d,0x1ee),'FCxKW':function(_0x236bbf,_0xfee448){return _0x236bbf==_0xfee448;},'RFAkA':_0x2fcc31(0x1db,0x25d,0x20a,0x1c9),'GPKjt':_0x2fcc31(0x24c,0x2b6,0x22e,0x26b),'vDnci':function(_0x1eb85f,_0x465d9e){return _0x1eb85f(_0x465d9e);},'LUfot':_0x4e2d1f(0x49,-0x5,0x115,0x8b),'ZKPDI':function(_0x4c7fca,_0x56646b){return _0x4c7fca===_0x56646b;},'prZQU':_0x4e2d1f(0x1c,-0x41,0x97,0x4)+_0x2fcc31(0x269,0x1cc,0x21e,0x154),'UDUOj':_0x2fcc31(0x1f3,0x21f,0x294,0x248)+_0x2fcc31(0x230,0x1f8,0x219,0x29d)+_0x2fcc31(0xf6,0x14e,0x1a0,0xba),'hYKrz':_0x2fcc31(0x213,0x1f4,0x290,0x22b)+_0x2fcc31(0x209,0x23b,0x209,0x20b),'jOhxs':_0x4e2d1f(0x80,0xaa,-0x39,0x41),'HVzJg':function(_0x357a08,_0x5b1a5d){return _0x357a08===_0x5b1a5d;},'AcqbL':_0x4e2d1f(-0x35,-0x79,0xb,0x29),'ACBfS':_0x4e2d1f(-0xf5,-0xfa,0x44,-0x64)+_0x4e2d1f(0x1,0x9b,0x1a,0x5e)+_0x2fcc31(0x133,0x185,0x119,0x19b),'mOrjD':_0x2fcc31(0x211,0x201,0x1cf,0x29b)+'n/json','vBtAM':function(_0x3ce23e,_0x499c6d,_0x342fd2){return _0x3ce23e(_0x499c6d,_0x342fd2);},'RcfTl':function(_0x2cc294,_0x3054e6){return _0x2cc294+_0x3054e6;},'VLjZg':_0x4e2d1f(0x2a,0x2c,-0x27,0x5d)+'/png;base6'+'4,','eVEjq':'图像已成功获取并格式'+_0x2fcc31(0x1f3,0x151,0x183,0x127)+'L。','pjxfI':function(_0x18fd3b,_0x3751f1){return _0x18fd3b(_0x3751f1);},'TExNP':_0x4e2d1f(0x18,0x1a,0x44,0x4f),'cAtwQ':'ugzKt','AhJnr':function(_0x4ab9a7,_0x370048){return _0x4ab9a7===_0x370048;},'wRdTr':_0x4e2d1f(-0xef,-0x35,-0xeb,-0x8a),'vEIpG':_0x2fcc31(0x21d,0x1a1,0xf7,0x222)};_0x25f35c[_0x4e2d1f(0x26,-0x43,0x57,-0x3e)](clearLog);const _0x3399a5=taskQueue[_0x4e2d1f(0xc6,0x1e,0xed,0x78)]({'name':_0x25f35c[_0x4e2d1f(0x11b,-0xf,0x12f,0x7c)](_0x25f35c['DxknX'](_0x57f86b,'')['substring'](0x1861+0xdd7+0x8*-0x4c7,0x247e+0x1f25+0x5*-0xd81),_0x57f86b&&_0x57f86b[_0x4e2d1f(-0x100,-0x12d,-0x96,-0xb2)]>0x379+-0xa3*-0x2e+0x1*-0x20a5?_0x25f35c[_0x2fcc31(0x1f9,0x18e,0x14d,0x18d)]:''),'type':TaskType['SD'],'prompt':_0x57f86b});currentTaskId=_0x3399a5;let _0x1379a4=_0x17e703;_0x57f86b=_0x25f35c['ygJft'](processCharacterPrompt,_0x57f86b);function _0x4e2d1f(_0x5679a2,_0x32328a,_0x1c03e9,_0x1020ff){return _0x52f7(_0x1020ff- -0x28d,_0x5679a2);}_0x17e703=processCharacterPrompt(_0x17e703),_0x57f86b=await _0x25f35c[_0x4e2d1f(0x37,0x55,0x5b,0x15)](stripChineseAnnotations,_0x57f86b),_0x17e703=await _0x25f35c[_0x4e2d1f(0x9b,0xf,-0x11,0x95)](stripChineseAnnotations,_0x17e703);function _0x2fcc31(_0x4e8249,_0x2f60b0,_0x2d1f79,_0x504e1e){return _0x52f7(_0x2f60b0- -0x74,_0x2d1f79);}const _0x571f20=extension_settings[extensionName]['sdUrl'][_0x2fcc31(0x308,0x28f,0x2fd,0x1fb)](),_0x30d46c=extension_settings[extensionName];addLog(_0x4e2d1f(-0x6c,0x57,-0x58,-0xb)+_0x2fcc31(0x253,0x19e,0x1b1,0x1e6)+'端为'+_0x30d46c[_0x2fcc31(0x136,0x1be,0x24b,0x1a4)]+_0x4e2d1f(-0xe9,-0xee,-0x82,-0x56)+_0x30d46c[_0x4e2d1f(0x19,0xac,0xcf,0x89)+'8_model']);const _0x59cfb3=_0x17e703&&_0x17e703['trim']()!==''?_0x17e703:_0x57f86b;_0x25f35c[_0x4e2d1f(0xb3,-0x42,0x12,0x15)](addLog,_0x4e2d1f(-0x56,0x4c,-0xc,-0x8)+_0x59cfb3);let _0x362c14=![];_0x59cfb3[_0x2fcc31(0x185,0x1b0,0x20c,0x12a)](_0x25f35c[_0x2fcc31(0x2f9,0x2ac,0x349,0x258)])&&(_0x25f35c[_0x2fcc31(0x1fb,0x1dd,0x293,0x272)]===_0x25f35c['kCgGr']?(_0x25f35c[_0x4e2d1f(0x29,0x3c,0x58,0x15)](_0x123118,_0x4e2d1f(-0x2d,-0xbf,-0x105,-0x64)+_0x2fcc31(0x2cd,0x277,0x30b,0x20a)+_0x2fcc31(0x1c9,0x185,0x138,0x15c)),_0x14abc3=_0x478e80):_0x362c14=!![]);_0x25f35c[_0x2fcc31(0x205,0x1a7,0x155,0x156)](addLog,'是否启用分角色模式\x20'+_0x2fcc31(0x1b7,0x223,0x22f,0x2be)+'les):\x20'+_0x362c14);let _0x2f13bf={},_0x219389='',_0x5e0909='';if(_0x362c14){_0x25f35c['kwTyI'](addLog,_0x25f35c[_0x2fcc31(0x1df,0x1e1,0x1f6,0x148)]),_0x2f13bf=parsePromptStringWithCoordinates(_0x59cfb3),_0x219389=_0x2f13bf[_0x25f35c[_0x4e2d1f(0xbc,0x27,0x126,0x93)]];for(let _0x4b2614=-0x1*0x1dbf+-0x1*0x20f+0x1fcf;_0x25f35c[_0x4e2d1f(-0x170,-0xa6,-0x11e,-0xbf)](_0x4b2614,0x2127+-0x2*-0x577+-0x2c11);_0x4b2614++){_0x2f13bf[_0x2fcc31(0x1ce,0x1e7,0x258,0x141)+_0x4b2614+_0x4e2d1f(0x68,0x7c,0x88,-0x23)]&&(_0x5e0909=_0x25f35c[_0x4e2d1f(0x1,0x71,-0x2b,0x7c)](_0x25f35c[_0x2fcc31(0x334,0x295,0x2da,0x324)](_0x5e0909,',\x20'),_0x2f13bf[_0x4e2d1f(-0xdc,-0x2,0x47,-0x32)+_0x4b2614+_0x2fcc31(0x29a,0x1f6,0x171,0x213)]));}}else _0x25f35c['vbRXX'](addLog,_0x25f35c[_0x4e2d1f(-0x92,0x2,0x8,-0x7)]),_0x219389=_0x59cfb3;let {modifiedPrompt:_0x27face,insertions:_0x268f9d}=await prompt_replace(_0x219389,_0x5e0909);if(_0x362c14){if(_0x25f35c[_0x4e2d1f(-0x79,-0x18,-0xe9,-0x4e)]===_0x25f35c[_0x2fcc31(0x1ef,0x278,0x2c0,0x29b)]){_0x25f35c[_0x4e2d1f(-0x2c,0xe8,0xf4,0x60)](_0x2ad8ff,_0x2fcc31(0xf5,0x154,0xaa,0x190)+':\x20'+_0x2ca7cd['message']+(_0x2fcc31(0x1ea,0x17e,0xdb,0x1cb)+_0x4e2d1f(0xe5,-0xa,0xf0,0x4e)+_0x4e2d1f(0x24,0x42,0xdb,0x86))),_0xe2a230[_0x4e2d1f(-0x72,0x7,-0x85,-0x68)+'sk'](_0x4cc07e,![]),_0x53fdf6=null;throw new _0x3d8201(_0x4e2d1f(-0x5e,-0x129,-0xb6,-0xc5)+'，请检查sdwebu'+'i是否正常启动，并检'+_0x4e2d1f(0x3f,0x61,-0x12,0x86));}else for(let _0xdcf310=0x67d+-0x1fe3+-0x1967*-0x1;_0x25f35c['BOZRJ'](_0xdcf310,0xb97+0x14d9+-0x206c);_0xdcf310++){_0x2f13bf[_0x2fcc31(0x163,0x1e7,0x198,0x25e)+_0xdcf310+_0x4e2d1f(-0x3d,-0x1,-0x77,-0x23)]&&(_0x25f35c[_0x4e2d1f(-0x4e,-0x3c,-0xe6,-0x8e)](_0x25f35c['slOMy'],_0x25f35c[_0x2fcc31(0x28d,0x24a,0x23a,0x20f)])?_0x27face=_0x25f35c['RBSRi'](_0x25f35c[_0x4e2d1f(0xc6,0xaa,0x6a,0x7c)](_0x27face,',\x20'),prompt_replace_for_character(_0x2f13bf[_0x4e2d1f(0x64,-0xc7,-0xcc,-0x32)+_0xdcf310+_0x2fcc31(0x20f,0x1f6,0x16c,0x145)])):(_0x41d409('标准模式:\x20使用请求'+_0x2fcc31(0x24f,0x2a5,0x345,0x24a)),_0x5cbe31=_0xca3d53));}}let _0x235278=await _0x25f35c[_0x2fcc31(0x1ac,0x24d,0x210,0x1b8)](zhengmian,extension_settings[extensionName][_0x2fcc31(0x287,0x234,0x1ba,0x2a3)][extension_settings[extensionName][_0x4e2d1f(0xd9,0xae,0xbb,0x79)]]['fixedPromp'+'t'],_0x27face,extension_settings[extensionName][_0x4e2d1f(0xb5,-0x42,0x94,0x1b)][extension_settings[extensionName]['yusheid_sd']][_0x4e2d1f(0x39,0xdd,0x3e,0x77)+_0x2fcc31(0x1e4,0x285,0x1ec,0x2eb)],extension_settings[extensionName][_0x2fcc31(0x1ac,0x17c,0x204,0x160)],_0x268f9d),_0x24be0b=await _0x25f35c[_0x4e2d1f(0x5b,0x21,-0x2f,0x2d)](fumian,extension_settings[extensionName][_0x2fcc31(0x1f1,0x234,0x28e,0x186)][extension_settings[extensionName][_0x2fcc31(0x250,0x292,0x227,0x21b)]]['negativePr'+'ompt'],extension_settings[extensionName]['UCP_sd']);_0x25f35c['cLjrW'](addLog,'负面为:\x20'+_0x24be0b),extension_settings['sd'][_0x25f35c[_0x2fcc31(0x236,0x26c,0x1f5,0x1dc)]]=_0x571f20,await _0x25f35c['xqNci'](saveSettingsDebounced);try{if(_0x25f35c[_0x2fcc31(0x2c9,0x233,0x2e8,0x23e)](_0x30d46c[_0x4e2d1f(0x39,-0x84,-0x4b,-0x5b)],_0x4e2d1f(0x6a,-0x42,-0x1d,0x8))){if(_0x25f35c['WiuTs']===_0x25f35c[_0x2fcc31(0x2a2,0x282,0x2ea,0x27c)])_0x88cdbb=_0x25f35c[_0x2fcc31(0x1ad,0x22e,0x29b,0x2cd)](_0x5526c6,_0x55fe89);else{const _0x17cdb7={};_0x17cdb7[_0x4e2d1f(-0x2e,-0x57,-0x90,-0xc3)]=_0x30d46c[_0x2fcc31(0x112,0x150,0xe5,0x132)+_0x2fcc31(0x1aa,0x214,0x171,0x25e)]?_0x30d46c[_0x2fcc31(0x19e,0x150,0x166,0x1f6)+'sd_auth']:'',_0x17cdb7[_0x2fcc31(0x200,0x219,0x25f,0x273)]=_0x571f20;const _0x3f82e0=await _0x25f35c['orUVx'](fetch,_0x25f35c[_0x4e2d1f(0x26,-0x47,0x4,-0x83)],{'method':_0x2fcc31(0x1a3,0x1e0,0x255,0x1ee),'body':JSON[_0x2fcc31(0x187,0x195,0xf2,0x167)](_0x17cdb7),'headers':getRequestHeaders(window[_0x2fcc31(0x267,0x2a9,0x259,0x28c)])});if(!_0x3f82e0['ok']){_0x25f35c[_0x4e2d1f(0xcf,0x69,0x4a,0x60)](addLog,'获取模型失败:\x20'+_0x3f82e0[_0x2fcc31(0x2df,0x281,0x234,0x2cc)]+'\x20'+_0x3f82e0[_0x2fcc31(0x17f,0x19d,0x146,0x217)]);throw new Error(_0x2fcc31(0x210,0x264,0x292,0x2d1)+_0x3f82e0[_0x4e2d1f(0x84,0x13,0x113,0x68)]+'\x20'+_0x3f82e0['statusText']);}let _0x49e43d=await _0x3f82e0[_0x2fcc31(0x25d,0x21a,0x283,0x23f)]();console[_0x2fcc31(0x1e7,0x1c7,0x212,0x179)](_0x25f35c['sTrBO'],_0x49e43d),console[_0x4e2d1f(0x2,-0x84,-0xa6,-0x52)](_0x4e2d1f(-0xd2,-0xa6,-0xe7,-0x7e)+_0x2fcc31(0x1bb,0x1b8,0x170,0x122)+_0x2fcc31(0x2a4,0x2a2,0x208,0x278)+_0x4e2d1f(0x31,0x46,-0x61,-0x6),_0x30d46c['sd_cchatu_'+_0x2fcc31(0x27b,0x213,0x1df,0x212)]);if(_0x49e43d!=_0x30d46c[_0x4e2d1f(0x12c,-0x24,0xf0,0x89)+'8_model']){_0x25f35c['PeNoL'](addLog,_0x4e2d1f(0x18,0x10d,0x72,0x9e)+_0x30d46c[_0x4e2d1f(0x83,0xfe,0xd4,0x89)+_0x4e2d1f(0x8d,-0x8b,-0x8,-0x6)]+_0x4e2d1f(0x86,0x40,0x2f,0x25)),toastr['info'](_0x2fcc31(0x291,0x29a,0x2c1,0x26b)+_0x30d46c[_0x4e2d1f(0x44,0xb1,0xd2,0x89)+'8_model']);const _0x43cdd6={};_0x43cdd6['auth']=_0x30d46c['st_chatu8_'+_0x2fcc31(0x1a3,0x214,0x16a,0x20b)]?_0x30d46c[_0x4e2d1f(-0x15b,-0x5d,-0x177,-0xc9)+_0x2fcc31(0x1f7,0x214,0x1f5,0x1be)]:'',_0x43cdd6[_0x4e2d1f(-0x20,0x0,0x4d,0x0)]=_0x571f20,_0x43cdd6[_0x4e2d1f(-0x65,-0x36,-0x4a,0x32)]=_0x30d46c['sd_cchatu_'+_0x4e2d1f(0xa7,0xa1,-0x1d,-0x6)];const _0x336dec=await fetch(_0x25f35c['aIGNh'],{'method':_0x25f35c[_0x4e2d1f(0x29,-0x52,0x2,-0x9)],'body':JSON[_0x4e2d1f(-0x5e,-0x62,0xa,-0x84)](_0x43cdd6),'headers':_0x25f35c[_0x4e2d1f(0x66,0x83,0x91,0x60)](getRequestHeaders,window[_0x4e2d1f(0x7d,0x12d,0x3,0x90)])});if(!_0x336dec['ok']){addLog(_0x4e2d1f(-0x2,-0x55,-0x77,0x1e)+_0x336dec[_0x2fcc31(0x264,0x281,0x2a2,0x22a)]+'\x20'+_0x336dec[_0x4e2d1f(-0x74,-0x71,-0x3e,-0x7c)]);throw new Error(_0x4e2d1f(0x3f,0x4a,0x98,0x1e)+_0x336dec[_0x4e2d1f(-0xe,0x81,0xc5,0x68)]+'\x20'+_0x336dec[_0x4e2d1f(-0x5f,-0xe8,-0x16,-0x7c)]);}toastr['info'](_0x2fcc31(0x2e1,0x27b,0x1d7,0x1d2)+_0x30d46c[_0x4e2d1f(0x5e,0xd7,-0x4,0x89)+_0x4e2d1f(0x1c,-0x99,-0x50,-0x6)]+'成功');}}}else{let _0x10aa8f=await _0x25f35c[_0x4e2d1f(0x7e,0x12c,0xe7,0x95)](getSDMode,_0x571f20);if(_0x25f35c[_0x2fcc31(0x114,0x15e,0x12d,0x1de)](_0x10aa8f,_0x30d46c[_0x4e2d1f(-0x8,0xd8,0x12a,0x89)+_0x2fcc31(0x1d7,0x213,0x245,0x209)])){if(_0x25f35c['ztPal']('VzUBc',_0x25f35c[_0x2fcc31(0x199,0x1ae,0x153,0x16d)])){const _0x3de74e=_0x25f35c['mQDYl'][_0x2fcc31(0x1ac,0x1d2,0x232,0x14e)]('|');let _0x429ffb=0x1*-0xe96+0x251*-0x5+0x7*0x3bd;while(!![]){switch(_0x3de74e[_0x429ffb++]){case'0':_0x4e6574=null;continue;case'1':_0x1a7cb1[_0x2fcc31(0x2ae,0x250,0x1c8,0x1f4)]=!![];continue;case'2':_0xf3d348[_0x2fcc31(0x1c8,0x1a9,0x1b5,0x1b3)](_0x25f35c[_0x4e2d1f(-0x64,-0x7f,-0x52,0xd)],_0x2b9259);continue;case'3':if(_0x806922[_0x2fcc31(0x1c8,0x18d,0x1e7,0xdc)]===_0x25f35c['JClJZ']){}else _0x10f583[_0x4e2d1f(-0x78,0x3d,0x17,-0x68)+'sk'](_0x12bf58,![]);continue;case'4':_0x25f35c['vbRXX'](_0x34c8cb,_0x2fcc31(0x15a,0x180,0x1ea,0x10b)+_0x546930[_0x4e2d1f(0xe,-0x71,0x1f,-0x8c)]);continue;case'5':throw _0x5b081a;continue;}break;}}else _0x25f35c[_0x4e2d1f(-0xca,0x2e,-0x8d,-0x3b)](addLog,_0x2fcc31(0xbe,0x163,0xf4,0x1f8)+_0x30d46c[_0x4e2d1f(0x31,0x89,0x70,0x89)+_0x4e2d1f(-0x9d,-0x6d,0x3a,-0x6)]+_0x2fcc31(0x21c,0x23e,0x259,0x240)),await _0x25f35c[_0x2fcc31(0x1e9,0x246,0x1dc,0x271)](setSDMode,_0x571f20,_0x30d46c[_0x2fcc31(0x239,0x2a2,0x26b,0x2a4)+_0x4e2d1f(0x5c,-0x69,0xab,-0x6)]);}}}catch(_0x47b3d3){if(_0x25f35c[_0x4e2d1f(0xc,0x8f,0x7f,0x1a)](_0x2fcc31(0x193,0x1c4,0x1ce,0x221),_0x25f35c[_0x4e2d1f(-0x38,-0x71,0x7d,0x17)])){const _0x58d3a8=_0x4e2d1f(-0xf0,-0x23,-0x11b,-0x71)+'常\x20(ID:\x20'+_0x2e0642+_0x4e2d1f(-0x55,0xbb,0x42,0x40)+_0x1a69a7[_0x4e2d1f(-0xe5,-0x25,-0x1,-0x8c)];_0x25f35c['vbRXX'](_0x710aaa,_0x2fcc31(0x269,0x216,0x29b,0x2ca)+_0x58d3a8),_0x1c5631[_0x2fcc31(0x156,0x1a9,0x113,0x225)](_0x25f35c['eJFUt'],_0x2d841a);const _0xe186cf={};_0xe186cf['id']=_0x257f0a,_0xe186cf[_0x2fcc31(0x1f2,0x1b9,0x123,0x1d1)]=![],_0xe186cf[_0x2fcc31(0x177,0x1a9,0x257,0x1ed)]=_0x295924[_0x2fcc31(0x20d,0x18d,0x114,0x121)],_0xe186cf[_0x2fcc31(0x201,0x1c0,0x273,0x186)]=_0x1a30f8,_0x484f70[_0x4e2d1f(-0x92,0x1,0x97,0x19)](_0x4f055c[_0x4e2d1f(-0x13,0x24,0x54,0x65)+_0x2fcc31(0x182,0x22b,0x182,0x227)+_0x2fcc31(0x19b,0x1bb,0x19f,0x1b1)],_0xe186cf),_0x25f35c[_0x4e2d1f(-0x20,0x104,0x3,0x60)](_0x2c7965,_0x4e2d1f(-0x15,0x8a,0x40,0x87)+_0x4e2d1f(0x6b,0x129,0x11d,0x83)+_0x5082c8+')');}else{addLog(_0x4e2d1f(-0x19,-0xe8,-0x8a,-0xc5)+':\x20'+_0x47b3d3[_0x2fcc31(0x1a1,0x18d,0x107,0x229)]+(_0x2fcc31(0x1ed,0x17e,0x17a,0xc8)+_0x2fcc31(0x21d,0x267,0x29d,0x1f8)+_0x2fcc31(0x1f1,0x29f,0x2ba,0x2c3))),taskQueue[_0x4e2d1f(-0xc4,-0xc9,-0xf6,-0x68)+'sk'](_0x3399a5,![]),currentTaskId=null;throw new Error(_0x2fcc31(0x1ad,0x154,0x122,0x154)+'，请检查sdwebu'+'i是否正常启动，并检'+_0x4e2d1f(0xed,-0x13,0x130,0x86));}}let _0x4f8b24=-(0x1d*0x155+0xfe7+-0x3687);const _0x1d2657=_0x30d46c['sd_cseed'];_0x1d2657!==''&&_0x25f35c[_0x4e2d1f(-0x63,-0x9f,-0xfe,-0x6f)](_0x1d2657,null)&&!_0x25f35c[_0x4e2d1f(0x5b,0x5b,0xab,0x39)](isNaN,_0x25f35c[_0x4e2d1f(0xcc,-0x76,0x71,0x30)](Number,_0x1d2657))&&_0x25f35c[_0x2fcc31(0x32b,0x27d,0x24a,0x203)](_0x25f35c['iYQxB'](Number,_0x1d2657),0x675*0x4+-0x135d*-0x2+-0x2047*0x2)&&(_0x4f8b24=_0x25f35c['iWohU'](Number,_0x1d2657));let _0x537560={'prompt':_0x235278,'negative_prompt':_0x24be0b,'sampler_name':_0x30d46c[_0x4e2d1f(0x118,0xa6,0x4f,0x89)+_0x4e2d1f(-0x71,0x25,-0x7b,-0x88)+_0x4e2d1f(-0x30,-0x97,-0x49,-0x1e)],'scheduler':_0x30d46c[_0x4e2d1f(0xee,0xf,0xda,0x89)+_0x2fcc31(0x299,0x257,0x1d5,0x247)+'r'],'steps':_0x30d46c[_0x2fcc31(0x201,0x18a,0x218,0xec)],'cfg_scale':_0x30d46c[_0x4e2d1f(-0x41,-0x44,-0x18,-0x4b)],'width':_0x217613?_0x217613:_0x30d46c['sd_cwidth'],'height':_0x66d285?_0x66d285:_0x30d46c[_0x2fcc31(0x1f4,0x209,0x21a,0x1b2)],'restore_faces':_0x25f35c[_0x2fcc31(0x262,0x238,0x1f3,0x241)](_0x30d46c[_0x4e2d1f(-0x104,-0x8c,-0x12c,-0xac)+'es'],_0x25f35c[_0x2fcc31(0x210,0x1dc,0x1c7,0x222)]),'enable_hr':_0x25f35c['iPwQd'](_0x30d46c[_0x2fcc31(0x29b,0x1fa,0x15e,0x178)+_0x2fcc31(0x238,0x1a2,0x11f,0x249)],_0x25f35c[_0x2fcc31(0x26c,0x1dc,0x226,0x245)]),'hr_upscaler':_0x30d46c[_0x4e2d1f(0xf3,0x124,0x125,0x89)+_0x4e2d1f(-0x3b,-0x13c,-0x144,-0xa7)],'hr_scale':_0x30d46c[_0x2fcc31(0x203,0x1b3,0x14d,0x14b)+_0x4e2d1f(-0x4d,0x75,0xd4,0x20)],'hr_additional_modules':[],'denoising_strength':_0x30d46c[_0x4e2d1f(0x4,-0xdf,0x47,-0x2c)+'ing_streng'+'th'],'hr_second_pass_steps':_0x30d46c[_0x2fcc31(0x1f5,0x1fa,0x18c,0x2a6)+_0x2fcc31(0x1ea,0x1fc,0x264,0x182)],'seed':_0x4f8b24,'override_settings':{'CLIP_stop_at_last_layers':Number(_0x30d46c[_0x2fcc31(0x14c,0x178,0x215,0x1fc)+_0x2fcc31(0x2bc,0x261,0x1f3,0x25f)]),'sd_vae':_0x30d46c[_0x2fcc31(0x241,0x2a2,0x2d0,0x2fb)+_0x4e2d1f(-0x32,-0x13,-0xbd,-0xa)]},'override_settings_restore_afterwards':!![],'save_images':!![],'send_images':!![],'do_not_save_grid':![],'do_not_save_samples':![]};_0x25f35c[_0x4e2d1f(-0xaa,-0x5c,-0xe2,-0x3b)](addLog,_0x2fcc31(0x2ab,0x270,0x1ed,0x2bf)+_0x4e2d1f(0x62,0x24,-0x87,-0x36)+_0x537560[_0x4e2d1f(-0x26,0xfc,-0x4,0x57)+_0x4e2d1f(-0x8d,-0x4d,-0xbb,-0x34)]),_0x25f35c[_0x4e2d1f(-0x1c,0x65,0xc,0x59)](addLog,_0x4e2d1f(0x9d,0x5b,-0x17,0x52)+_0x2fcc31(0x1fc,0x1ef,0x151,0x259)+_0x537560[_0x4e2d1f(0xfa,0x12e,0xcf,0x7f)]);_0x30d46c[_0x4e2d1f(-0xe5,0x16,-0xa5,-0x7f)+_0x2fcc31(0x148,0x1f1,0x18b,0x176)]==_0x25f35c['VbebD']&&(_0x25f35c[_0x2fcc31(0x1d6,0x1e9,0x183,0x1ca)](addLog,_0x25f35c[_0x4e2d1f(0x59,0x48,0xec,0x6a)]),_0x537560=_0x25f35c[_0x4e2d1f(-0x93,-0x1e,0xf,-0x73)](deepMerge,_0x537560,{'alwayson_scripts':{'ADetailer':{'args':[!![],!![],{'ad_model':_0x25f35c['RWqEG']}]}}}));const _0x1b00bb=_0x2fcc31(0x230,0x280,0x292,0x30f)+_0x2fcc31(0x2d6,0x266,0x30c,0x1bd)+_0x2fcc31(0x252,0x27a,0x28f,0x24e)+'pt):**\x20'+_0x235278+(_0x2fcc31(0x176,0x1ba,0x226,0x20a)+_0x4e2d1f(-0x20,-0xf,0x94,0x8e)+_0x2fcc31(0x1fd,0x28a,0x2e6,0x2e2)+'\x20')+_0x24be0b+(_0x2fcc31(0x2e1,0x2ab,0x26b,0x2d6)+_0x4e2d1f(0x6a,-0x4a,0x42,0x3a)+_0x2fcc31(0x108,0x16e,0x1a7,0x156))+_0x537560[_0x2fcc31(0x235,0x254,0x2ed,0x21d)+'me']+(_0x4e2d1f(0xc6,-0x3a,0x1a,0x5c)+'teps):**\x20')+_0x537560['steps']+('\x0a-\x20**CFG\x20S'+_0x2fcc31(0x210,0x263,0x286,0x2eb))+_0x537560[_0x2fcc31(0x1cf,0x1eb,0x1e6,0x1eb)]+('\x0a-\x20**尺寸\x20(S'+'ize):**\x20')+_0x537560[_0x4e2d1f(-0xd7,-0x32,0x33,-0x29)]+'x'+_0x537560[_0x2fcc31(0x18d,0x1d8,0x257,0x1e4)]+(_0x2fcc31(0x2c0,0x2af,0x32e,0x307)+_0x2fcc31(0x18b,0x15b,0x100,0xfa))+(_0x25f35c[_0x4e2d1f(0x7b,0xc,0x0,0x1a)](_0x537560[_0x2fcc31(0x15a,0x14d,0x11c,0xbb)],-(-0x18a0+-0x1c8e+-0x799*-0x7))?_0x25f35c[_0x4e2d1f(-0x66,-0x7a,0x97,-0x4)]:_0x537560[_0x2fcc31(0x127,0x14d,0x11c,0x1df)])+(_0x4e2d1f(0x36,-0x14,0x86,0x36)+_0x4e2d1f(0x89,0x92,-0x87,-0x15))+_0x30d46c[_0x4e2d1f(0xb8,0xbe,0x30,0x89)+_0x2fcc31(0x22b,0x213,0x21f,0x262)]+('\x0a-\x20**VAE:*'+'*\x20')+_0x537560[_0x2fcc31(0x1d8,0x1d6,0x203,0x168)+_0x4e2d1f(-0x65,-0xe2,-0x5c,-0xc1)][_0x2fcc31(0x18f,0x193,0x13c,0x15d)]+(_0x4e2d1f(0x9c,0xd1,-0x31,0x4c)+_0x2fcc31(0x19e,0x225,0x20c,0x19b))+_0x537560['override_s'+_0x2fcc31(0x20e,0x158,0x11c,0x1eb)][_0x4e2d1f(-0xfa,-0xff,-0x12,-0x80)+'at_last_la'+'yers']+(_0x4e2d1f(-0x7,0x57,-0x76,0x7)+'(Hires\x20Fix'+_0x2fcc31(0x16a,0x15f,0x15d,0x1c9))+_0x537560[_0x4e2d1f(0xfa,0x115,0x111,0x7f)]+(_0x2fcc31(0x104,0x197,0x152,0x130)+_0x2fcc31(0x159,0x1ac,0x1ae,0x229)+'actor):**\x20')+_0x537560['hr_scale']+(_0x4e2d1f(0x43,-0x34,-0x22,0x75)+_0x2fcc31(0x2a6,0x24e,0x248,0x1da)+_0x2fcc31(0x154,0x1ea,0x19f,0x1f0)+_0x2fcc31(0x1ce,0x1f3,0x25c,0x264))+_0x537560[_0x2fcc31(0x2e8,0x287,0x320,0x246)+'strength']+(_0x4e2d1f(0x85,-0x10,0xc4,0x73)+_0x2fcc31(0x2d2,0x227,0x250,0x28d)+_0x2fcc31(0x1b8,0x240,0x28c,0x25f))+_0x537560['restore_fa'+_0x4e2d1f(-0x11,-0xdf,0x17,-0x34)]+(_0x4e2d1f(0xae,0xb0,-0x5d,0x47)+'iler:**\x20')+_0x25f35c['FCxKW'](_0x30d46c[_0x4e2d1f(-0x6,-0x120,0x10,-0x7f)+_0x4e2d1f(0x3,0xf,-0xa3,-0x28)],_0x25f35c['VbebD'])+_0x2fcc31(0x285,0x2a6,0x205,0x208);_0x25f35c['cLjrW'](addLog,_0x1b00bb),_0x25f35c['iWohU'](addLog,_0x2fcc31(0x1da,0x218,0x266,0x18f)+'数为'+JSON[_0x2fcc31(0x10c,0x195,0x201,0x171)](_0x537560)),console[_0x2fcc31(0x158,0x1c7,0x1d5,0x186)](_0x25f35c['RFAkA'],_0x537560);while(!window[_0x4e2d1f(0x6,0xb9,-0x5c,0x37)]){_0x25f35c['GPKjt']===_0x25f35c[_0x2fcc31(0x1c9,0x1b6,0x104,0x1b4)]?await _0x25f35c[_0x4e2d1f(-0x1e,-0x9,0x72,0x11)](sleep,0x1e48+-0x1*-0x14e3+-0xfc1*0x3):(_0x36b816['on'](_0x16b944[_0x2fcc31(0x2f6,0x27e,0x282,0x1ed)+_0x4e2d1f(-0x35,-0x95,-0x3c,-0xa8)+'ST'],_0x5df4b1),_0x9a4a9e('SD\x20生图事件监听器'+_0x2fcc31(0x21a,0x23c,0x23a,0x1e0)));};try{window[_0x2fcc31(0x1a5,0x250,0x271,0x300)]=![],taskQueue[_0x4e2d1f(-0xad,0x5e,-0x29,-0x1c)+'us'](_0x3399a5,_0x25f35c[_0x2fcc31(0x207,0x1c1,0x1f9,0x1b2)]);if(_0x25f35c[_0x2fcc31(0x23d,0x20d,0x22e,0x19f)](_0x30d46c['client'],_0x2fcc31(0x1d2,0x221,0x1e7,0x1cb))){if(!taskQueue[_0x2fcc31(0x325,0x286,0x294,0x290)+'eue'](_0x3399a5)){if(_0x25f35c['OqNvm'](_0x2fcc31(0x32b,0x28b,0x221,0x2ff),'cEfgS')){_0x25f35c[_0x2fcc31(0x248,0x272,0x235,0x2ca)](addLog,_0x25f35c['tQSoM']),eventSource[_0x4e2d1f(-0x10,0x60,0x26,0x19)](_0x25f35c[_0x4e2d1f(-0x60,-0x86,-0x134,-0x89)]);throw new Error(_0x25f35c[_0x2fcc31(0x217,0x1a4,0x22c,0x1d8)]);}else for(let _0x1925f8=0x1*-0x1279+-0x6ab+-0x1925*-0x1;_0x25f35c['wOvHo'](_0x1925f8,-0x1ac9+0x1cce+-0x9*0x39);_0x1925f8++){_0x32171a['Character\x20'+_0x1925f8+_0x2fcc31(0x2a4,0x1f6,0x25a,0x259)]&&(_0x12c3e7=_0x25f35c['RBSRi'](_0x25f35c[_0x2fcc31(0x1d5,0x15d,0xb8,0x1a2)](_0x2405e1,',\x20'),_0x25f35c[_0x2fcc31(0x1d4,0x22e,0x1dc,0x211)](_0x1b32c8,_0x2756b9[_0x4e2d1f(-0x9b,-0x40,-0xe,-0x32)+_0x1925f8+_0x4e2d1f(-0x59,-0x13,-0xf,-0x23)])));}}_0x537560[_0x2fcc31(0x24b,0x219,0x1ab,0x1cb)]=_0x571f20,console[_0x4e2d1f(-0xdd,-0x1f,-0x15,-0x52)](_0x25f35c[_0x4e2d1f(0xd9,0xfa,0xf7,0x66)],_0x30d46c[_0x2fcc31(0xee,0x150,0x204,0x101)+_0x4e2d1f(-0x86,-0x3c,0x2e,-0x5)]),_0x537560['auth']=_0x30d46c['st_chatu8_'+_0x4e2d1f(-0x8b,-0x32,0xd,-0x5)]?_0x30d46c[_0x4e2d1f(-0xf9,-0x82,-0x54,-0xc9)+_0x4e2d1f(-0xbb,-0x87,0x22,-0x5)]:'';const _0xdabbed=await _0x25f35c[_0x4e2d1f(0x83,0x9,0xa,0x2d)](fetch,_0x25f35c[_0x4e2d1f(-0x86,0x6a,-0xdc,-0x27)],{'method':_0x25f35c['dpdoT'],'headers':_0x25f35c[_0x2fcc31(0x290,0x279,0x304,0x25d)](getRequestHeaders,window[_0x4e2d1f(0x91,0x144,0x64,0x90)]),'body':JSON['stringify'](_0x537560)});if(!_0xdabbed['ok']){const _0x425dce=await _0xdabbed[_0x4e2d1f(0x7,-0x45,-0x78,0x1)]();addLog(_0x2fcc31(0x31e,0x2b3,0x330,0x340)+_0x2fcc31(0x122,0x1b4,0x174,0x1a3)+_0xdabbed[_0x2fcc31(0x1fd,0x281,0x2d1,0x223)]+_0x2fcc31(0x1fe,0x251,0x2be,0x2a1)+_0x425dce),console['log'](_0x25f35c['jOhxs'],_0x425dce);throw new Error(_0x4e2d1f(0xb2,0x8b,0x8,0x10)+_0xdabbed['status']+_0x4e2d1f(-0x4a,0x65,-0x6d,0x9)+_0x425dce);}const _0x29fa91=await _0xdabbed['text']();let _0x1de228='';try{const _0x1991ec=JSON[_0x2fcc31(0x25c,0x1c6,0x1c5,0x1e7)](_0x29fa91);_0x1de228=_0x1991ec[_0x2fcc31(0xda,0x14f,0xcc,0xcc)][0x24bf+0xb*0x307+-0x460c*0x1];}catch(_0x40f5a1){if(_0x25f35c['HVzJg'](_0x25f35c['AcqbL'],_0x25f35c['AcqbL']))addLog(_0x25f35c['ACBfS']),_0x1de228=_0x29fa91;else{_0x25f35c[_0x4e2d1f(-0x32,-0x84,0x1e,-0x72)](_0x310b33,_0x25f35c[_0x4e2d1f(0x4c,0x10,0x57,0x98)]);throw new _0x5a2467(_0x25f35c[_0x4e2d1f(-0xfb,-0x85,-0x77,-0x75)]);}}const _0x53e7d7='data:image'+'/png;base6'+'4,'+_0x1de228;_0x25f35c['kwTyI'](addLog,'图像已成功获取并格式'+'化为\x20data\x20UR'+'L。'),_0x25f35c[_0x2fcc31(0x1b6,0x246,0x196,0x213)](setTimeout,()=>{function _0x394ba6(_0x29b44b,_0x52f62d,_0x32c89d,_0x4b26c5){return _0x4e2d1f(_0x52f62d,_0x52f62d-0xb9,_0x32c89d-0x131,_0x32c89d- -0xad);}console[_0x550b2b(0x2ee,0x266,0x2f6,0x37d)](_0x25f35c[_0x394ba6(0x30,0xb,-0x1e,-0xb9)]);function _0x550b2b(_0x50713f,_0x464999,_0x55fcfd,_0x2b0f83){return _0x2fcc31(_0x50713f-0x11a,_0x50713f-0x127,_0x55fcfd,_0x2b0f83-0x185);}window[_0x550b2b(0x377,0x393,0x2fc,0x3f9)]=!![];},extension_settings[extensionName]['imageGenIn'+_0x2fcc31(0x1cb,0x26f,0x1ba,0x2e3)]);;taskQueue['completeTa'+'sk'](_0x3399a5,!![]),currentTaskId=null;_0x25f35c[_0x4e2d1f(-0x44,-0x1a,-0x2a,0x30)](String,extension_settings[extensionName][_0x2fcc31(0x11b,0x16c,0xd1,0x11f)+_0x2fcc31(0x1a7,0x168,0x120,0x188)])===_0x4e2d1f(-0x31,-0x4e,0x5c,0x46)&&(_0x53e7d7=await _0x25f35c['vbRXX'](convertImageToJpeg,_0x53e7d7));const _0x3a4c29={};return _0x3a4c29[_0x4e2d1f(0xbd,0x38,0xec,0x3f)]=_0x53e7d7,_0x3a4c29[_0x4e2d1f(-0x148,-0x71,-0xe4,-0xc7)]=_0x17e703||'',_0x3a4c29;}else{if(!taskQueue[_0x2fcc31(0x272,0x286,0x2a2,0x202)+_0x4e2d1f(-0x1d,-0x8c,0xab,0x1d)](_0x3399a5)){addLog(_0x25f35c[_0x2fcc31(0x346,0x2b1,0x271,0x2d3)]);throw new Error(_0x25f35c['JClJZ']);}const _0x4326f9=new URL(_0x25f35c[_0x4e2d1f(-0xcd,-0xae,-0xe6,-0xbc)](_0x571f20,'/sdapi/v1/'+_0x4e2d1f(0xf4,0x3c,0xd9,0x97)));window['xiancheng']=![];const _0x1c85cb=await fetch(_0x4326f9,{'method':_0x25f35c[_0x2fcc31(0x21c,0x210,0x1d6,0x1d4)],'body':JSON[_0x2fcc31(0x139,0x195,0x10c,0x1b2)](_0x537560),'headers':getDirectHeaders(_0x25f35c[_0x2fcc31(0x1b7,0x17b,0x1f7,0x192)],getsdAuth())});_0x25f35c[_0x2fcc31(0x141,0x181,0x13e,0x211)](setTimeout,()=>{function _0x3d902e(_0x4aa0ae,_0x407e63,_0x263713,_0x5ac387){return _0x4e2d1f(_0x4aa0ae,_0x407e63-0x1e,_0x263713-0x8c,_0x407e63-0x514);}function _0x4ad746(_0x3d9ba9,_0x68ad61,_0x1751ef,_0x1d69c6){return _0x2fcc31(_0x3d9ba9-0x1e4,_0x1751ef- -0x18f,_0x68ad61,_0x1d69c6-0x73);}_0x25f35c[_0x3d902e(0x529,0x487,0x50c,0x4d2)]!==_0x25f35c[_0x4ad746(0xa3,-0xb1,-0x3,0xd)]?_0x4f9274[_0x25f35c[_0x3d902e(0x529,0x52c,0x5da,0x593)]]=_0x56c906:(console[_0x3d902e(0x4b3,0x4c2,0x4e5,0x544)](_0x25f35c['gduvI']),window[_0x4ad746(0x163,0x69,0xc1,0x7b)]=!![]);},extension_settings[extensionName][_0x4e2d1f(-0x101,-0xfa,-0x10a,-0x79)+_0x2fcc31(0x1f6,0x26f,0x1d0,0x1cf)]);;if(!_0x1c85cb['ok']){const _0x6fa1ac=await _0x1c85cb[_0x4e2d1f(-0x90,-0x7,0x59,0x1)]();_0x25f35c[_0x2fcc31(0x23e,0x279,0x282,0x272)](addLog,_0x4e2d1f(-0xc5,-0x169,-0x102,-0xc2)+'误。状态码:\x20'+_0x1c85cb[_0x2fcc31(0x2e6,0x281,0x229,0x239)]+_0x4e2d1f(0x23,-0x66,-0x61,0x38)+_0x6fa1ac),console['log'](_0x25f35c[_0x4e2d1f(-0x2f,0x1e,0x76,0x24)],_0x6fa1ac);throw new Error(_0x4e2d1f(0xae,0x6,0x6b,0x10)+_0x1c85cb[_0x2fcc31(0x1f9,0x281,0x248,0x259)]+_0x4e2d1f(0x15,0x47,0xbd,0x9)+_0x6fa1ac);}const _0x3ffb0f=await _0x1c85cb['json']();if(!_0x3ffb0f[_0x4e2d1f(-0x125,-0x88,-0x166,-0xca)]||_0x25f35c['ZKPDI'](_0x3ffb0f[_0x2fcc31(0xce,0x14f,0x1c0,0x178)][_0x2fcc31(0x142,0x167,0x211,0x1ff)],-0x1150+0x4ef*0x3+0x283*0x1))throw new Error(_0x2fcc31(0x12c,0x1d9,0x144,0x14b)+'像数据。');const _0x2bd5cc=_0x3ffb0f[_0x4e2d1f(-0x1d,-0xd6,-0xf9,-0xca)][-0x1d*-0x4+-0x29*-0xa7+-0x1b33],_0x1882ac=_0x25f35c['RcfTl'](_0x25f35c[_0x2fcc31(0x303,0x27c,0x1d5,0x26f)],_0x2bd5cc);_0x25f35c[_0x2fcc31(0x138,0x1a7,0x230,0x22d)](addLog,_0x25f35c[_0x4e2d1f(0x20,-0x15,-0x1a,-0x24)]),taskQueue[_0x4e2d1f(-0xfb,-0x7d,-0x5f,-0x68)+'sk'](_0x3399a5,!![]),currentTaskId=null;_0x25f35c[_0x2fcc31(0x334,0x2ae,0x2b6,0x2f0)](String,extension_settings[extensionName]['convertToJ'+_0x2fcc31(0x149,0x168,0x1e2,0x1b4)])===_0x4e2d1f(0x71,0x9d,0xae,0x46)&&(_0x1882ac=await _0x25f35c[_0x4e2d1f(0x90,-0x57,-0x4c,0x2f)](convertImageToJpeg,_0x1882ac));const _0x449278={};return _0x449278[_0x2fcc31(0x299,0x258,0x229,0x264)]=_0x1882ac,_0x449278['change']=_0x1379a4||'',_0x449278;}}catch(_0x382c2a){if(_0x25f35c[_0x4e2d1f(0xd,0x26,0x83,-0x17)]===_0x25f35c[_0x2fcc31(0x1ab,0x17f,0x22e,0x12d)])_0x536cab[_0x4e2d1f(-0x66,0x81,-0x23,-0x32)+_0x564583+'\x20Prompt']&&(_0x3155d7=_0x25f35c['RDXUU'](_0x25f35c['RDXUU'](_0x1906e2,',\x20'),_0x21cb71(_0x370def[_0x2fcc31(0x23e,0x1e7,0x1f8,0x1a1)+_0x3e02d9+_0x4e2d1f(0x37,-0x8e,-0xa2,-0x23)])));else{window[_0x4e2d1f(0x8,0x67,0x2a,0x37)]=!![];if(_0x25f35c[_0x4e2d1f(0x44,-0x15,0x8,0x80)](_0x382c2a[_0x2fcc31(0x100,0x18d,0x17a,0x211)],_0x25f35c[_0x4e2d1f(-0x55,-0xfb,-0xd4,-0x75)])){}else _0x25f35c[_0x2fcc31(0x29c,0x2a1,0x2f0,0x221)](_0x25f35c[_0x4e2d1f(0xa,0xb7,0xf2,0x84)],_0x25f35c[_0x4e2d1f(-0x10f,-0x75,0x43,-0x5a)])?_0x259942=!![]:taskQueue['completeTa'+'sk'](_0x3399a5,![]);currentTaskId=null,_0x25f35c[_0x4e2d1f(-0x11,-0x99,0x65,0x13)](addLog,_0x4e2d1f(-0x92,-0x78,-0xcc,-0x99)+_0x382c2a[_0x4e2d1f(-0x12e,-0xc4,-0xe,-0x8c)]),console['error'](_0x25f35c['qxrHc'],_0x382c2a);throw _0x382c2a;}}}async function sdGenerate(_0x43a4e0){const _0x57f01b={'jHskL':_0x354ba3(-0xb,-0x1a,-0x1b,-0x9)+'+$','rGczg':function(_0xb63fc3,_0x2ed6c9){return _0xb63fc3(_0x2ed6c9);},'ggonP':_0x29fc9b(0x622,0x650,0x5e7,0x6b1),'EMijD':function(_0x2b9023,_0x4868d0){return _0x2b9023===_0x4868d0;},'IKVLj':'ZZQvv','PYXgg':_0x29fc9b(0x60c,0x566,0x5b9,0x524),'MHaTF':function(_0x40872f,_0x52cd0a){return _0x40872f===_0x52cd0a;},'JYfDu':'yzQlI','HCtwR':function(_0x375f53,_0x2ce596){return _0x375f53(_0x2ce596);},'QZEJZ':function(_0x19b878,_0x780006){return _0x19b878!=_0x780006;},'CCqgn':function(_0x4b9458,_0x1f2b9f){return _0x4b9458!==_0x1f2b9f;},'xvlqh':_0x354ba3(0x12b,0xb5,0x116,0x19f),'JgceK':_0x354ba3(0x154,0x96,0x104,0x140),'wNoAA':_0x29fc9b(0x566,0x5bc,0x571,0x52d)+_0x354ba3(0x5d,0x13a,0xf8,0x19e)+_0x29fc9b(0x4b4,0x527,0x52b,0x49d)},{id:_0x216f37,prompt:_0x34d05f,width:_0x428c40,height:_0x526abe,change:_0x1c9372}=_0x43a4e0;_0x57f01b[_0x354ba3(0xde,0x80,0x58,0x4a)](addLog,_0x29fc9b(0x4ed,0x573,0x5d7,0x4f2)+_0x29fc9b(0x5a7,0x525,0x5b0,0x556)+_0x216f37+(_0x354ba3(0x54,0x13,0xa8,0x150)+':\x20')+_0x34d05f+(_0x1c9372?_0x29fc9b(0x5b0,0x63c,0x63a,0x607)+'\x20'+_0x1c9372:''));if(_0x1c9372&&_0x1c9372[_0x29fc9b(0x54e,0x54e,0x4f8,0x594)](_0x57f01b['ggonP'])){if(_0x57f01b[_0x29fc9b(0x590,0x517,0x50a,0x49c)](_0x57f01b[_0x29fc9b(0x5fe,0x549,0x5df,0x4ee)],_0x57f01b[_0x354ba3(0xa7,0x161,0xbf,0x137)]))_0x1975f0(_0x29fc9b(0x52b,0x50e,0x53f,0x5aa)+'库');else{bananaGenerate(_0x43a4e0);return;}}function _0x354ba3(_0x40c80f,_0x4a0362,_0x509267,_0x71ab30){return _0x52f7(_0x509267- -0x213,_0x71ab30);}function _0x29fc9b(_0x30246a,_0x11638e,_0x2738ea,_0x3dee84){return _0x52f7(_0x11638e-0x32a,_0x30246a);}try{if(_0x57f01b[_0x29fc9b(0x5af,0x5a8,0x643,0x5da)](_0x57f01b[_0x354ba3(0x6c,0x85,0x67,-0x27)],_0x57f01b[_0x354ba3(-0x5,0x83,0x67,0x2a)])){const {image:_0x2fc231,change:_0x4a8fde}=await _0x57f01b[_0x29fc9b(0x4b5,0x50d,0x563,0x552)](generateSDImage,{'prompt':_0x34d05f,'width':_0x428c40,'height':_0x526abe,'change':_0x1c9372});if(_0x57f01b['QZEJZ'](extension_settings[extensionName][_0x354ba3(-0xc6,-0x9b,-0x3d,-0xb9)],'0')){const _0x103590={};_0x103590['change']=_0x4a8fde,await setItemImg(_0x34d05f,_0x2fc231,_0x103590),_0x57f01b[_0x29fc9b(0x525,0x595,0x513,0x596)](addLog,_0x354ba3(-0x49,-0xab,-0x3a,-0xb1)+'or\x20prompt:'+'\x20'+_0x34d05f);}else _0x57f01b[_0x354ba3(-0x4c,0x1a,-0x30,-0xda)](addLog,_0x29fc9b(0x4f3,0x50e,0x467,0x4ab)+'库');const _0x52c52c={};_0x52c52c['id']=_0x216f37,_0x52c52c['success']=!![],_0x52c52c[_0x29fc9b(0x4c0,0x571,0x4df,0x59e)]=_0x2fc231,_0x52c52c[_0x354ba3(0xcd,0x15,0x21,-0x4)]=_0x34d05f,_0x52c52c[_0x354ba3(-0x4,-0xe5,-0x4d,-0x4)]=_0x4a8fde,eventSource[_0x354ba3(0x97,-0x11,0x93,0x132)](EventType['GENERATE_I'+_0x29fc9b(0x594,0x5c9,0x5db,0x614)+_0x354ba3(0x24,0x1d,0x1c,0x82)],_0x52c52c),_0x57f01b[_0x29fc9b(0x4e5,0x595,0x59f,0x5c3)](addLog,'发送SD生图成功响应'+'\x20(ID:\x20'+_0x216f37+')');}else return _0x3fe0bf[_0x354ba3(0x5,0x11f,0x7d,0x84)]()['search'](RfNQMD[_0x354ba3(0x7,0x7c,0x23,0x2a)])[_0x29fc9b(0x64e,0x5ba,0x5cd,0x54e)]()[_0x29fc9b(0x5bb,0x56d,0x59e,0x4f5)+'r'](_0x3ade56)[_0x29fc9b(0x5c5,0x5b9,0x5b5,0x64e)](RfNQMD[_0x354ba3(-0x26,-0x3d,0x23,0xcc)]);}catch(_0x3e19a6){if(_0x57f01b[_0x29fc9b(0x4d4,0x567,0x559,0x53d)](_0x57f01b[_0x29fc9b(0x534,0x53d,0x4f8,0x5e9)],_0x57f01b[_0x29fc9b(0x4da,0x58a,0x5f6,0x5af)])){const _0x4194e2=_0x29fc9b(0x513,0x546,0x535,0x4d9)+_0x29fc9b(0x5af,0x508,0x560,0x546)+_0x216f37+_0x354ba3(0x53,0x14f,0xba,0x55)+_0x3e19a6['message'];addLog(_0x354ba3(-0x2c,-0x3f,0x77,0x59)+_0x4194e2),console[_0x354ba3(-0x8a,0x5f,0xa,-0x1d)](_0x57f01b[_0x354ba3(0x51,0x127,0xea,0x80)],_0x3e19a6);const _0x504405={};_0x504405['id']=_0x216f37,_0x504405[_0x354ba3(0xc6,0x86,0x1a,-0x7b)]=![],_0x504405[_0x354ba3(0x51,-0x37,0xa,-0x3e)]=_0x3e19a6[_0x29fc9b(0x4e3,0x52b,0x528,0x533)],_0x504405[_0x29fc9b(0x611,0x55e,0x50b,0x500)]=_0x34d05f,eventSource[_0x354ba3(0x54,0xb,0x93,0x11)](EventType[_0x29fc9b(0x569,0x61c,0x685,0x6c0)+_0x354ba3(0x33,0x11,0x8c,-0x24)+_0x354ba3(-0x8d,-0x72,0x1c,-0x96)],_0x504405),_0x57f01b[_0x354ba3(-0x78,-0xb3,-0x30,-0x80)](addLog,_0x29fc9b(0x5e5,0x63e,0x62c,0x638)+'\x20(ID:\x20'+_0x216f37+')');}else{const _0x2a8898=_0x406d5d[_0x354ba3(-0xb2,-0x31,-0x43,-0xa2)](_0xa48a0e,arguments);return _0x2526cb=null,_0x2a8898;}}}function initializeSDListener(){function _0x336aa5(_0x529ef8,_0x1e497d,_0x2c7947,_0x529930){return _0x52f7(_0x2c7947- -0xbf,_0x529ef8);}const _0x79c018={'QUhov':function(_0x5f96ef,_0x55ff70){return _0x5f96ef(_0x55ff70);},'AeIrH':_0x336aa5(0x90,0x10e,0x10a,0x7c)+_0x402bc2(0x1ab,0x1e9,0x17c,0x19a)};function _0x402bc2(_0x588c75,_0x34ad81,_0x559cf5,_0x33ec94){return _0x52f7(_0x34ad81- -0xc7,_0x559cf5);}eventSource['on'](EventType[_0x336aa5(0x216,0x1cb,0x233,0x2d5)+_0x402bc2(0x1b6,0x11e,0x10c,0x92)+'ST'],sdGenerate),_0x79c018['QUhov'](addLog,_0x79c018[_0x402bc2(0x180,0x17e,0xcf,0x14b)]);}export async function replaceWithSd(){const _0x4db172={'bknfu':function(_0x23de77){return _0x23de77();},'QviGv':function(_0x42662b,_0x1f6aca){return _0x42662b+_0x1f6aca;},'gfjCQ':function(_0x11a53c,_0xd6407){return _0x11a53c+_0xd6407;},'Dodqy':function(_0x17dbfd,_0x1674ba){return _0x17dbfd===_0x1674ba;},'HkrkG':_0x5042d2(0x494,0x3c5,0x497,0x3f2),'Jkpqy':function(_0x41d7f6){return _0x41d7f6();},'kREzc':function(_0x1375df,_0x15d185){return _0x1375df!==_0x15d185;},'mEVOm':'rKSkg','WdHse':'IcgLB','cCiFc':_0x1ca52e(0xbb,0x1d9,0xa6,0x149),'ZqXCS':_0x5042d2(0x414,0x347,0x3dc,0x3e6)+_0x1ca52e(0x63,0xa4,0x113,0xe0)};function _0x1ca52e(_0x4a88a8,_0x2d0227,_0x24380e,_0x23936f){return _0x52f7(_0x23936f- -0x137,_0x2d0227);}function _0x5042d2(_0x408205,_0x2d6bef,_0x1fdede,_0x30d37d){return _0x52f7(_0x30d37d-0x21d,_0x1fdede);}if(extension_settings[extensionName][_0x1ca52e(0x149,0x141,0x1c1,0x1ca)]=='sd')!window[_0x5042d2(0x5c0,0x4b7,0x4f7,0x545)+'SDListener']&&(_0x4db172[_0x1ca52e(0x246,0x1fd,0x141,0x1ae)]('mFVUh',_0x4db172[_0x1ca52e(0x114,0x149,0x156,0x198)])?(window[_0x5042d2(0x593,0x4dc,0x4df,0x545)+_0x5042d2(0x4a2,0x51f,0x54b,0x519)]=!![],_0x4db172[_0x5042d2(0x3e0,0x4b5,0x506,0x46b)](initializeSDListener)):(!_0x5343c5[_0x5042d2(0x4ff,0x56c,0x5d3,0x545)+'SDListener']&&(_0x1160a7['initialize'+_0x1ca52e(0x18c,0x243,0x24a,0x1c5)]=!![],_0x2713c1()),_0x4db172[_0x5042d2(0x492,0x3b0,0x483,0x408)](_0x253d86))),_0x4db172['Jkpqy'](initializeImageProcessing);else{if(_0x4db172[_0x1ca52e(0x16d,0x19d,0x1f3,0x144)](_0x4db172[_0x5042d2(0x3a6,0x3de,0x341,0x3ea)],_0x4db172[_0x5042d2(0x36c,0x477,0x384,0x3ea)])){const _0x36a548=_0x34f1c3?function(){function _0x15de49(_0x43b7b1,_0x113ce0,_0x1eb210,_0x2c2671){return _0x1ca52e(_0x43b7b1-0x134,_0x2c2671,_0x1eb210-0x79,_0x113ce0-0x350);}if(_0x504ced){const _0xfe0a49=_0x46f425[_0x15de49(0x424,0x3e9,0x460,0x3f0)](_0x484956,arguments);return _0x249bf6=null,_0xfe0a49;}}:function(){};return _0x2be8a5=![],_0x36a548;}else window['initialize'+_0x1ca52e(0x253,0x168,0x1da,0x1c5)]&&(_0x4db172[_0x5042d2(0x530,0x53f,0x4e5,0x498)](_0x4db172[_0x1ca52e(0xf3,0x154,0x179,0x17c)],_0x4db172[_0x5042d2(0x473,0x53e,0x5c0,0x524)])?(eventSource['removeList'+_0x1ca52e(0x9a,0xbe,0x128,0xd9)](EventType[_0x5042d2(0x52d,0x501,0x588,0x50f)+_0x1ca52e(0x98,0x5d,0x143,0xae)+'ST'],sdGenerate),window[_0x5042d2(0x541,0x564,0x4e9,0x545)+'SDListener']=![],addLog(_0x4db172[_0x5042d2(0x446,0x41f,0x41c,0x413)])):_0x32a574[_0x5042d2(0x45b,0x4fa,0x4ed,0x478)+_0x5b38e4+_0x1ca52e(0xd3,0xf2,0x114,0x133)]&&(_0x252809=_0x4db172[_0x1ca52e(0x18,0x90,0x5a,0xc0)](_0x4db172[_0x1ca52e(0x1ed,0xf8,0x196,0x199)](_0x109d42,',\x20'),_0x18a467[_0x5042d2(0x460,0x447,0x3e6,0x478)+_0x1b5da2+_0x1ca52e(0x189,0x141,0xa1,0x133)])));}}