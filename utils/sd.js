(function(_0x53b6be,_0x16ac07){const _0x159e0e=_0x53b6be();function _0x181cac(_0x895ef7,_0x1bee8a,_0x132a37,_0x328561){return _0x3c53(_0x895ef7-0x323,_0x328561);}function _0x331333(_0xfcc2c6,_0x4b8449,_0x1c7a43,_0x116ddd){return _0x3c53(_0x4b8449- -0x41,_0x116ddd);}while(!![]){try{const _0xba932f=-parseInt(_0x181cac(0x5ce,0x5da,0x640,0x5f9))/(-0xff0+0x189*-0x16+-0x485*-0xb)+-parseInt(_0x331333(0x22d,0x26d,0x2b7,0x30c))/(0x2*0x7da+-0x11c4+0x212)*(parseInt(_0x181cac(0x4fd,0x4b9,0x550,0x51c))/(-0x1066+0x2f*0x47+-0x6*-0x90))+-parseInt(_0x181cac(0x5bf,0x61a,0x614,0x58d))/(-0x10b9*0x1+-0x13f*0xb+0x1e72)*(-parseInt(_0x181cac(0x55d,0x5a0,0x51c,0x575))/(-0xd*0x15d+0x3*0x8dd+-0x8d9))+-parseInt(_0x331333(0x256,0x1d2,0x257,0x173))/(-0x7a8+0x1*-0x1fd5+0x2783)*(parseInt(_0x181cac(0x5b1,0x521,0x5e6,0x649))/(-0x7b8*-0x2+-0x9*0x242+0x4e9))+parseInt(_0x181cac(0x559,0x5e1,0x4f4,0x5ed))/(-0x36d*0x2+0x542*-0x1+0xc24)+parseInt(_0x181cac(0x5dc,0x5b8,0x5d2,0x601))/(-0xc3e*-0x2+-0x10f3+0x5*-0x180)*(-parseInt(_0x181cac(0x59c,0x62c,0x61e,0x54f))/(-0x1*0x277+-0x1*0xf86+0x1207))+parseInt(_0x181cac(0x539,0x524,0x536,0x586))/(0x3*0x325+0x1*-0x106c+0x78*0xf);if(_0xba932f===_0x16ac07)break;else _0x159e0e['push'](_0x159e0e['shift']());}catch(_0x41f45b){_0x159e0e['push'](_0x159e0e['shift']());}}}(_0xcf1f,-0x29*0x26cf+-0x57a7*-0x7+-0x1232*-0xcd));const _0x2494c6=(function(){function _0x2badb6(_0xcd739e,_0xc36827,_0x25dc8b,_0x57c4e4){return _0x3c53(_0xc36827-0xb,_0x25dc8b);}const _0x3ecf46={'IKwQI':function(_0x346012,_0x3421df){return _0x346012!==_0x3421df;},'lhaQL':_0x2badb6(0x100,0x1a5,0x21d,0x108),'tNEtu':function(_0x49c004,_0x384b6f){return _0x49c004!==_0x384b6f;},'QNrlx':'BjDBa','bxnRk':function(_0x48477f,_0x4eb4a2){return _0x48477f+_0x4eb4a2;},'PMsMA':function(_0x464f79,_0xbc562d){return _0x464f79(_0xbc562d);}};let _0x21f337=!![];return function(_0x3ca2e9,_0xee7cfd){const _0x1c1b61={'NfwUR':function(_0x432dbc,_0x284e90){return _0x3ecf46['bxnRk'](_0x432dbc,_0x284e90);},'KboSZ':function(_0x5c3b96,_0x50aaa1){function _0xd6faf1(_0x2d8d69,_0x399561,_0x5e94c3,_0x2f50c2){return _0x3c53(_0x399561- -0x2a4,_0x5e94c3);}return _0x3ecf46[_0xd6faf1(-0x80,-0x25,-0x4e,0x69)](_0x5c3b96,_0x50aaa1);}},_0x4096cb=_0x21f337?function(){function _0x5e6108(_0x4a6f0c,_0x227d03,_0x2106aa,_0xe593ed){return _0x3c53(_0x4a6f0c- -0xeb,_0x227d03);}function _0xa6b3eb(_0x1217fc,_0x419bdc,_0x12b94a,_0x125ccc){return _0x3c53(_0x125ccc-0x263,_0x419bdc);}if(_0x3ecf46[_0x5e6108(0x131,0x17b,0x16b,0x192)](_0xa6b3eb(0x420,0x486,0x4df,0x4b7),_0x3ecf46['lhaQL'])){if(_0xee7cfd){if(_0x3ecf46[_0xa6b3eb(0x5ae,0x4e8,0x592,0x533)]('BjDBa',_0x3ecf46['QNrlx']))for(let _0x54a13c=-0x9*0x443+-0x3*0xb91+0x490f;_0x54a13c<=-0x3e1*-0x1+0x7*0x55b+-0x295a;_0x54a13c++){_0x10dd80['Character\x20'+_0x54a13c+_0x5e6108(0x15e,0x1bb,0x12f,0x1d6)]&&(_0x5bf08d=_0x1c1b61['NfwUR'](_0x2ee609+',\x20',_0x174f2a(_0x4d2518[_0xa6b3eb(0x4d1,0x48a,0x54a,0x4ab)+_0x54a13c+'\x20Prompt'])));}else{const _0x3d4201=_0xee7cfd['apply'](_0x3ca2e9,arguments);return _0xee7cfd=null,_0x3d4201;}}}else _0x37d833=_0x1c1b61['KboSZ'](_0x2f5cd8,_0x15d6ab);}:function(){};return _0x21f337=![],_0x4096cb;};}()),_0x33a1e6=_0x2494c6(this,function(){function _0x24f760(_0x149dde,_0x42c386,_0x3643c6,_0xb350bc){return _0x3c53(_0x42c386- -0x183,_0xb350bc);}const _0x59cb76={};_0x59cb76[_0x16fe4d(-0x3d,-0xad,-0x53,-0xef)]=_0x16fe4d(-0x27,-0x2f,-0x3f,-0x80)+'+$';const _0x32ce40=_0x59cb76;function _0x16fe4d(_0x1d8e32,_0x258598,_0x52ceac,_0x6832dd){return _0x3c53(_0x52ceac- -0x310,_0x1d8e32);}return _0x33a1e6[_0x16fe4d(-0x52,-0x2a,-0xc1,-0xa3)]()[_0x24f760(0xd8,0x138,0xca,0x95)](_0x32ce40[_0x24f760(0x1d1,0x13a,0x1a5,0xdf)])[_0x24f760(0x131,0xcc,0x5e,0x73)]()[_0x16fe4d(-0xe3,-0x3d,-0x3e,-0xa6)+'r'](_0x33a1e6)[_0x16fe4d(-0x81,0x2a,-0x55,-0x2d)](_0x24f760(0xf7,0x14e,0xc8,0x15f)+'+$');});function _0xcf1f(){const _0x53ba5c=['C2rFy3vWC2nHBa','nJG1mdC2B0HgAfLv','ue9tva','z2u6','l2fWAs9Zzc9Zzq','6zsz6k+VoIa','B1Pbzu4','yxv0B191CMW','C3rFy2HHDhu4xW','5Qch5yEg5QIH5BYpoIdKVB/NLkJOR7FMSyi','z1HYyu4','C3rLChm','wungAwq','AwT0uNG','5yYw5lI6igrHDgeGvvi','5Q2J5zYO5yIh5O2I5QIH5z6l5lI6','mta5mtC1oefdvhvjtW','se92vLi','t29VDuK','nta0nZaWBNrUzxPt','55sO5lQo55sF5OIq55QevgfNoIa','u2nLBMuGq29TCa','zgvUB2LZAw5NxW','kerLBM9PC2LUzW','zv9Mywn0B3i','Aw1Hz2vZ','Awnttfy','cI0GkIPdrKCGuW','r09TCeK','C3rHDhvZ','ndeWnti2shP5rgTI','cI0TlqOGicaG','C2vHCMnO','AML1z3vHBG','q1PdAMS','CxDICM4','B0D4vMe','CMvZDg9Yzv9Myq','t0HHD08','5lU75yQH5BEY5y+w5RAi','zw5HyMXLx2HYia','y29bqMq','vKnxzgu','C3vJy2vZCW','CgfYC2u','C2rFy2nSAxbFCW','zMfJzv95B2XVDG','rLrhy0K','C2rFy2HPCMvZxW','5Q2J6z2I5O+q56s6icHqCM9T','EeXLuuG','tvnADuO','ChqPoIOQia','De5fDhu','kcGOlISPkYKRkq','y29UC3rYDwn0BW','B3zLCNjPzgvFCW','u0qG55sF5zU+5lQl5lU255Ur5zcS5zMO','Cxvbuee','u0rmAxn0zw5LCG','ifn0CMvUz3rOkq','CNvUBMLUzW','B2jHrK8','lI4U','zgrKq2u','AgrcC0u','y2vZ','B3iGChjVBxb0oG','D0LTBK0','Aw5MBW','EgLHBMnOzw5Nia','CMf0Aw5NigLTyq','zxr0Aw5NCW','ywn0B3iPoIOQia','ELvXCwW','s0jfBeW','kfnHBxbSzxiPoG','BI9QC29U','zMzoyNG','vgLpwxC','qxrpqMK','yxrFBgfZDf9Syq','B21WDa','44cc5zon5BQu5yAf5A65oIa','Aw5PDgLHBgL6zq','y2fSztOQkIa','Dhj1zq','AwHrueG','C2rFy3nLzwq','BeX6zwS','zMfJzsdKUlRLVidLKk8','C2rFyxv0Aa','DtHFC2rFyxv0Aa','AEEuN+AiKowBVUEjHY4UlUwUOUAiTW','DNzJAwO','ywrKvgfZAW','zMXsyuC','6k6+572U5QIH5z6llI4U5lI6','C2r3zwj1AEEuN+wBVUwpGG','6lsF6z2I5lI6oIa','BKXXy0C','C2rdzMDty2fSzq','6i635y+w5OIw6icf5yIh5O2I5QIH5z6l5AsX6lsL','6i635y+w5QIH5z6l5AsX6lsLoIa','EgLHBMnOzw5N','BgvY','5zU+5y+c5PwW5OQL5zgkcI0GkIO','Dg9Rzw4','DgvWCYK6kIOG','mJiYmG','ugTWuw0','Df9LBMq','5BEY5yID5AEl5yYw44cc','AwXLCJOQkIa','6yws6AAgioI/LowBNUMuMEIVR+oaGUEkTUAaGq','77Ym6k+35Qoa5P+LC2r3zwj1','vxDYAg0','C2rFy2nOyxr1xW','ke5Lz2f0AxzLia','5P+L5QIH5z6l5PIV5zcM5Q2J56gU44cc','Cgf5Bg9Hza','44cc6k+35Qoa5P+LC2r3zwj1','cI0GkIRPH43NU5JLUyxLUQyG','u3P5zu8','lcdOR6BMG4u6ia','Eg5uq3C','zKjJqMu','AgvPz2H0','Bw9Kzq','keHPCMvZiezPEa','ywrLDgfPBgvYxW','AxPLktOQkIa','C3rHDhvZvgv4Da','5BEY5ywZ6zET44cc','5z2q5Qch55Qe5O+q56s66k+n5A2x56YM5lIY44cc','cI0GkIRMQkhLNOSGke0','Bg9Hza','qxPzsKe','y29TCgXLDgvuyq','5yop5PwW5O2U44cc','zw5HyMXLx2HY','y2vZioIeUoMdQos/RUwKJsdKUlO','kerPDMLKzv9YBW','ovfAveDyAq','C2vLza','ktOG','5yIh5O2I5QIH5z6l5AsX6lsLoIa','cI0GkIPwquu6kG','tufhrv9srvnqtW','u2TPCdOQkIa','zwvKktOQkIa','u0tNLj/LM77MTyhNQiVMJzxOJRFLIldLVii','r2Lbthq','BMvNyxrPDMvqCG','Aw5Nx3n0CMvUzW','DxjS','qwnMAey','y2fJAgu','5zon5BQu5yAf5A65oG','B2rLBcK6kIOG','CwvRwwu','CwfNvvK','l3bUzZTIyxnLnG','l3nKyxbPl3yXlW','of9TB2rLBa','vNHKu3q','DgvYDMfS','sgDxr0O','y0zRB04','tNHhwNe','uvz4uve','AxnuyxnRsw5rDq','svjJywK','C2rFC3rVCf9Nzq','BMvYyxrL','Aw1Hz2u','y2HHBMDL','AxHkqxu','z0fLwfK','r0vorvjbvevFsq','zxvL','uhjUwLG','5Q2J5zYO6k6+572U5QIH5z6llI4U5lI6','of9Zy2HLzhvSzq','DMz3B24','z0nbBuG','oIOQia','u2fpwe0','ChjVBxb0','Dgv4Da','C2rFy2rLBM9PCW','cI0GkIPbrgv0yq','yxbWBgLJyxrPBW','vunqx3nK','6AUy5RIf5l+U5Asnios4UG','rLvYENy','t0vMCNi','loAOOEwEI+s4UG','Dg5xwwy','r2rIrfu','odK5otriDwPLCM4','vgTfCeu','v01dExa','mtK3odaXntzUEKDwzfm','cI0GkIRPQ5JMUixKV67LPi0G','yw1L','DvvlD3a','cI0GkIRNP43LRzaGkfm','Dc1TB2rLBa','suT3uuK','5zU+5yop5BEY5OIq5yQF6i635y+w5BM25Qc85BYp','B3LAugW','DuLrCLu','uNHbyKG','5BI4icHjrdOG','AK5jt3u','s0nkwvG','BMvYyxrPB24','Ae5tvvy','EwvYCW','cI0GkIRLSlRLR7GGkfm','zezQtgy','uujjChC','qxznqM0','zgjwy1y','sLzqvg4','zty0ioAvSoAnRUwKHoEqHUoaGG','zML4zwrqCM9TCa','uhjVBxb0ktOQkG','vwjiyMq','y2XPzw50','qwf2r24','C2fTCgXLCL9Uyq','CMvTB3zLtgLZDa','Bg9N','otKWodGYnfzwu0HMrG','C2rFy2HLAwDODa','zgvIrvK','qvbj5zon5BQu5lIT5PYQ5OM+5yIW5zU+','ndbdt1noyvC','qLfKAxe','6k+V44cc54Q25Ocb56cboIa','zxPfA2W','wgXSChq','DK5dBwi','q2vrBNK','cI0GkIROHlJPG6JKV67LPi0G','C3rUBuG','D2LKDgG','suq6ia','C3rYAw5NAwz5','zg1pCKS','DK5rq2u','q2HHCMfJDgvYia','ifbYB21WDa','v09xC1K','6zQp5PY6kc0Xkq','Den4wKe','tufhrv9srvfvrq','5BcD6k+v5l2C5lI65y6F5AEliejHCW','Dg9tDhjPBMC','ufLMwNG','5Ps25yIWu0tNLj/LM77OR7FMSyiGka','C2rFy2fKzxrHAq','5zU+5yop5BEY5A2y5ywL5PwW5O2U5BQtigy','yKnkAu0','ExvZAgvPzf9Zza','Auz3uwK','cI0GkIROTj/PNAlMJ5dNPlOG','5lI6Dhj1zq','zw5LCG','ic0Gq2HHBMDLoG','A2fTBxG','icHjrdOG','tNz6sgu','B3nPDgLVBG','ExvZAgu','BenzvM0','zw1PDa','txHKC2q','5Q2J5zYO6ycA6l+hC2r3zwj1','cI0GkIRMRAxMLBaGkfm','C2rFy3DPzhrO','rvjpsuq','Bw9KzwW','l2fWAs9Zzc9Nzq','CMf0Aw5Nifneia','uMXctu8','A2LW','56cboIa','yKn3qwe','og4UChq','DxbKyxrLu3rHDa','kIOG','yxbWBhK','vuDOvxe','kfvWC2nHBguGrG','rxjYB3iGz2vUzq','wNPyExy','sw1WrKC','Aw5JBhvKzxm','5lIT55QeihbYB21WDooaGG','mtqWD056BKzy','cI0GkIPdBgLWia','CuveufG','zgf0ytPPBwfNzq','AEAyR+wqPUATO+w4UowqR+wkQo+8Jow5TUAJGa','BgvUz3rO','ue1Ztue','ExDlDxK','zxjYB3i','y1HZs0G','CMvZDg9YzuzHyW','DgrktKq','wMTUsgm','tLnf','BuzZshG','5y+r6ycbu0tNLj/LM77LPlhOTkxLK43LUPq','uvHPrNO','zML4','C2rvCMW','ywPJz1C','Bw53BNq','nty3BwHVrxvj','C2tOR7FMSylNLj/LM77PLjNOR686ia','DhjPBq','AMX2swO','sLnptIdOP6pMNPdLPlhOTkxVViW','kfjLC3rVCMuGrG','r2XOz1u','y2zNx3nJywXL','C2rFy3n0zxbZ','ksaTifbYB21WDa','yxv0Aa','BwvZC2fNzq','Aw1Hz2vhzw5jBG'];_0xcf1f=function(){return _0x53ba5c;};return _0xcf1f();}_0x33a1e6();import{sleep,zhengmian,fumian,deepMerge,getSDMode,setSDMode,addLog,getRequestHeaders,clearLog,prompt_replace,getsdAuth,parsePromptStringWithCoordinates,prompt_replace_for_character,stripChineseAnnotations}from'./utils.js';import{setItemImg}from'./database.js';import{extension_settings}from'../../../../extensions.js';import{extensionName,EventType}from'./config.js';import{saveSettingsDebounced,eventSource}from'../../../../../script.js';import{initializeImageProcessing}from'./iframe.js';import{processCharacterPrompt}from'./characterprompt.js';import{bananaGenerate}from'./banana.js';import{taskQueue,TaskType}from'./taskQueue.js';function _0x3c53(_0x47588d,_0x57e6db){_0x47588d=_0x47588d-(0x23e1+-0x2*-0x10b9+-0x43cf);const _0x50656b=_0xcf1f();let _0x568f4b=_0x50656b[_0x47588d];if(_0x3c53['CwMzce']===undefined){var _0x3e63df=function(_0x321a1e){const _0x3e1e32='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x36a8e5='',_0x479545='',_0x5e883e=_0x36a8e5+_0x3e63df;for(let _0x519191=0xa5b+0x2*-0x1223+0x19eb,_0x30ff11,_0x30b785,_0x4d19ca=0x303+-0x2*-0xdff+-0x1f01;_0x30b785=_0x321a1e['charAt'](_0x4d19ca++);~_0x30b785&&(_0x30ff11=_0x519191%(-0x5*0x682+-0xea2*0x1+0x12e*0x28)?_0x30ff11*(-0x3*0x359+-0x23d6*-0x1+0xd*-0x1f7)+_0x30b785:_0x30b785,_0x519191++%(0x93a+0x571+-0xea7))?_0x36a8e5+=_0x5e883e['charCodeAt'](_0x4d19ca+(-0x14a1+0xe9+0x13c2))-(0x10c2+-0x5e3*-0x1+-0x169b*0x1)!==-0x19b+0xfd3*0x2+-0x1e0b?String['fromCharCode'](0x736+-0x167e*0x1+0x1cf*0x9&_0x30ff11>>(-(0x31*-0x43+0x7db+0x4fa)*_0x519191&0x2251+-0x1fbe+-0x28d)):_0x519191:0xa21*-0x2+-0x5*-0x61a+-0xa40){_0x30b785=_0x3e1e32['indexOf'](_0x30b785);}for(let _0x26842a=0x2424+0x11c6+-0x35ea,_0x14a1fb=_0x36a8e5['length'];_0x26842a<_0x14a1fb;_0x26842a++){_0x479545+='%'+('00'+_0x36a8e5['charCodeAt'](_0x26842a)['toString'](-0xe7c+0xb52+-0x1*-0x33a))['slice'](-(-0x8bd*0x1+-0xd48+0x1607));}return decodeURIComponent(_0x479545);};_0x3c53['dhlNDU']=_0x3e63df,_0x3c53['UOWIvq']={},_0x3c53['CwMzce']=!![];}const _0x2a01e6=_0x50656b[-0x5d*0x11+-0x259e+0x6f*0x65],_0x19d67c=_0x47588d+_0x2a01e6,_0x452590=_0x3c53['UOWIvq'][_0x19d67c];if(!_0x452590){const _0x45a1ea=function(_0x3e7716){this['zfouUR']=_0x3e7716,this['npiOUk']=[0x2*0x97a+0x1*-0x209+-0x10ea,0xe9b+0x1c*0x122+-0x1*0x2e53,-0x2*-0xb65+0xc9*0x11+0x1d*-0x13f],this['XZjWxY']=function(){return'newState';},this['DkqrrH']='\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*',this['zQswHn']='[\x27|\x22].+[\x27|\x22];?\x20*}';};_0x45a1ea['prototype']['PvkTbi']=function(){const _0xb8e759=new RegExp(this['DkqrrH']+this['zQswHn']),_0x2521e3=_0xb8e759['test'](this['XZjWxY']['toString']())?--this['npiOUk'][-0x3dd+-0x1*-0x95f+-0x581]:--this['npiOUk'][0x1ee5+-0x417*-0x4+0x2f41*-0x1];return this['SADgLb'](_0x2521e3);},_0x45a1ea['prototype']['SADgLb']=function(_0x4b462d){if(!Boolean(~_0x4b462d))return _0x4b462d;return this['ikWeiS'](this['zfouUR']);},_0x45a1ea['prototype']['ikWeiS']=function(_0x585758){for(let _0xb06356=0x2442+0xa6*-0x1+-0x239c,_0xfd5720=this['npiOUk']['length'];_0xb06356<_0xfd5720;_0xb06356++){this['npiOUk']['push'](Math['round'](Math['random']())),_0xfd5720=this['npiOUk']['length'];}return _0x585758(this['npiOUk'][-0x2a9*-0x4+0x963+-0x6ad*0x3]);},new _0x45a1ea(_0x3c53)['PvkTbi'](),_0x568f4b=_0x3c53['dhlNDU'](_0x568f4b),_0x3c53['UOWIvq'][_0x19d67c]=_0x568f4b;}else _0x568f4b=_0x452590;return _0x568f4b;}let currentTaskId=null;async function generateSDImage({prompt:_0x46d9b5,width:_0x1adcac,height:_0x11dffa,change:_0x427bec}){const _0x1b8f80={'jNIOu':function(_0x1abad7,_0x3cbfa8){return _0x1abad7(_0x3cbfa8);},'stnmH':_0xf09857(0x47b,0x485,0x466,0x42c)+_0xf09857(0x436,0x441,0x4e0,0x452)+_0xf09857(0x485,0x420,0x412,0x45b),'icSLV':function(_0x53f5ac,_0x9b85f8){return _0x53f5ac(_0x9b85f8);},'tCxZA':function(_0x3322aa){return _0x3322aa();},'gCAmH':'分角色模式:\x20解析带'+_0xf09857(0x45d,0x3c4,0x364,0x464),'VxdSt':_0x21833c(0x59,0x12e,0xcf,0xb8)+_0x21833c(0x11e,0x125,0x7d,0x6e),'ENlJM':function(_0x45a678,_0x460e30){return _0x45a678<=_0x460e30;},'tdJND':function(_0x4ebca4,_0x425c5b){return _0x4ebca4+_0x425c5b;},'NvzHe':function(_0x2729c9,_0x509b11){return _0x2729c9!==_0x509b11;},'BQdiq':'FJzkv','ZzXyv':_0x21833c(-0x3a,-0x4a,-0x50,-0x67)+_0xf09857(0x4dc,0x44b,0x3e2,0x4f1),'EdSgy':_0xf09857(0x35b,0x377,0x3aa,0x2fe)+'已初始化。','FUrzv':_0x21833c(0x92,0x15a,0xf0,0x60)+'+$','PYfZx':function(_0x466da3,_0x256c45){return _0x466da3!==_0x256c45;},'ImpFG':function(_0x8d7874,_0x54f786){return _0x8d7874(_0x54f786);},'ihQPH':function(_0xd4aa93,_0x412e6b){return _0xd4aa93(_0x412e6b);},'lLzek':function(_0x111afa,_0x5c7ded){return _0x111afa(_0x5c7ded);},'KCJYX':function(_0x5eb082,_0x4dc240){return _0x5eb082(_0x4dc240);},'ezEkl':function(_0x52f9bc,_0x3586cf){return _0x52f9bc===_0x3586cf;},'jlvIj':_0x21833c(0x4e,0x4c,0x34,-0xd),'FTGcI':_0xf09857(0x36a,0x39c,0x3da,0x41a),'iktRx':function(_0x47f389,_0x5bc49d){return _0x47f389(_0x5bc49d);},'JAUep':function(_0x3903d7,_0x2ebf21){return _0x3903d7(_0x2ebf21);},'SaOXM':function(_0x4e48c5,_0x5f3fd6){return _0x4e48c5<=_0x5f3fd6;},'bCwAa':'obaFO','dUndt':_0x21833c(0xb3,0x110,0xed,0x96),'SzyeO':function(_0xec1c70,_0x80875c){return _0xec1c70+_0x80875c;},'Uwrhm':function(_0x527d03,_0x25b134,_0x5c24cf){return _0x527d03(_0x25b134,_0x5c24cf);},'NGryt':function(_0xa3f932,_0x79b56b){return _0xa3f932<=_0x79b56b;},'oZAeN':function(_0x133462,_0x1cd05c,_0x144c70,_0x3821de,_0x471a81,_0x149c26){return _0x133462(_0x1cd05c,_0x144c70,_0x3821de,_0x471a81,_0x149c26);},'gXraN':function(_0x16fbf9,_0x4da79e){return _0x16fbf9(_0x4da79e);},'rhJNw':function(_0xcf575,_0x352dcf){return _0xcf575!==_0x352dcf;},'JVPTn':_0xf09857(0x3fd,0x3da,0x449,0x452),'kammx':_0x21833c(0x7f,0xfb,0xbc,0x6b),'cFkoN':'cmodel2222'+_0x21833c(0x61,0x7f,-0x29,0x5e),'ywKuy':'extension_'+'settingss.'+'sd_cchatu_'+'8_model','sFHWi':function(_0x5cbd28,_0x69702d){return _0x5cbd28!=_0x69702d;},'ajcgW':_0x21833c(0x144,0x176,0xe4,0x9c),'fBcBe':function(_0x4759df,_0x5cb30a){return _0x4759df(_0x5cb30a);},'OHawO':_0x21833c(0xa3,0x96,0xbe,0x43)+_0xf09857(0x371,0x40e,0x37e,0x3eb),'qwbrn':function(_0x16b888,_0x3059cc){return _0x16b888(_0x3059cc);},'UGhUq':'affFa','KsxXm':function(_0x1a0df5,_0x32293d){return _0x1a0df5!=_0x32293d;},'hNSUV':_0xf09857(0x3e3,0x407,0x363,0x398),'EROID':_0x21833c(-0x6b,-0x2a,-0x19,-0x78),'mFsHx':function(_0x42122e,_0x521b6d){return _0x42122e(_0x521b6d);},'wtBRx':function(_0x18370c,_0x38fdfc){return _0x18370c>=_0x38fdfc;},'AavGn':function(_0x253054,_0x2f9375){return _0x253054==_0x2f9375;},'dmOrK':_0x21833c(0x55,-0xe3,-0x40,-0x91),'BfeoN':function(_0xf28922,_0x210c34){return _0xf28922==_0x210c34;},'qagUY':function(_0x13d254,_0x21a276){return _0x13d254(_0x21a276);},'OEfrr':function(_0x3fc3d0,_0x4cd097,_0x59ed13){return _0x3fc3d0(_0x4cd097,_0x59ed13);},'vNCmb':_0xf09857(0x478,0x4bc,0x443,0x4ac)+_0x21833c(0x12a,-0x16,0x8d,0x106),'quAPA':function(_0x423744,_0x5bd58f){return _0x423744===_0x5bd58f;},'zUqql':_0xf09857(0x4c5,0x43e,0x418,0x4c3),'UAQBb':function(_0x455eef,_0x2d51ee){return _0x455eef(_0x2d51ee);},'RrXsR':_0x21833c(0x38,-0x83,-0x1e,-0x99),'ilaSJ':_0xf09857(0x41a,0x37b,0x2f7,0x323),'OoouI':function(_0x5c32d2,_0x20d798){return _0x5c32d2===_0x20d798;},'PrnZX':'任务已被用户取消。','Xllpt':_0xf09857(0x49a,0x4b5,0x433,0x519),'FiJfF':'payst_chat'+_0xf09857(0x3e6,0x39a,0x3dc,0x313)+_0xf09857(0x3b5,0x3c6,0x42a,0x39e),'vszlp':function(_0x4e83fc,_0x45888b){return _0x4e83fc(_0x45888b);},'vMYMi':_0x21833c(-0x8a,0x2,0x8,0xa9),'IRcai':function(_0x2b66fc,_0x1bacda){return _0x2b66fc+_0x1bacda;},'YCFid':_0xf09857(0x3d5,0x46f,0x441,0x50f)+_0xf09857(0x482,0x3e0,0x346,0x349)+'4,','GdbDU':_0xf09857(0x3f2,0x410,0x422,0x473)+_0x21833c(0x53,0x45,0xc8,0xb9)+'L。','hdBsE':function(_0x4dda43,_0x33f5ce){return _0x4dda43||_0x33f5ce;},'sFpNv':'igtSD','oyZPl':_0x21833c(0x3f,0xab,0x5f,0x66),'HgWGJ':_0x21833c(0x66,0x4e,0xd,0xa4)+'txt2img','uUKwp':_0xf09857(0x44a,0x3fe,0x3ee,0x3fd)+_0xf09857(0x3d7,0x38b,0x3cf,0x404),'mnwnt':_0xf09857(0x38d,0x423,0x3f1,0x425),'iFwQi':_0x21833c(0x6,-0x1e,0x3e,-0x2a),'GiALt':function(_0x516ee8,_0x1b9eae){return _0x516ee8(_0x1b9eae);},'ixJAu':function(_0x143d17,_0xef36c){return _0x143d17===_0xef36c;},'AvMBm':_0xf09857(0x49f,0x42c,0x419,0x4c8)+_0xf09857(0x44d,0x3c9,0x381,0x42f),'RxAbH':function(_0x2e20e6,_0x52ee3b){return _0x2e20e6+_0x52ee3b;},'cXsKH':function(_0x36e12b,_0xf5efd){return _0x36e12b(_0xf5efd);},'UKRyt':_0x21833c(0x146,0x170,0xec,0x143),'GlhgU':function(_0xf1e0c2,_0x2e6f7a){return _0xf1e0c2!==_0x2e6f7a;},'tnWYf':_0xf09857(0x4c5,0x4aa,0x41b,0x54a),'qEDPX':function(_0x51830f,_0x17d2e6){return _0x51830f(_0x17d2e6);},'flRaG':_0xf09857(0x3d5,0x467,0x4a3,0x3bf)+_0xf09857(0x3f3,0x385,0x330,0x403)+_0x21833c(0x141,0x4a,0xbd,0x125)};_0x1b8f80[_0xf09857(0x445,0x43f,0x3d1,0x4b9)](clearLog);const _0x3122c2=taskQueue[_0xf09857(0x435,0x39d,0x402,0x356)]({'name':_0x1b8f80[_0x21833c(0x106,0x4d,0xa3,0x14a)]((_0x46d9b5||'')['substring'](-0xe57*-0x2+-0x32*-0x28+-0x247e,-0x1a26+0x129+-0x1*-0x191b),_0x46d9b5&&_0x46d9b5[_0xf09857(0x3e9,0x471,0x3f8,0x477)]>0x1244+-0xcf2+0x534*-0x1?'...':''),'type':TaskType['SD'],'prompt':_0x46d9b5});currentTaskId=_0x3122c2;let _0x361073=_0x427bec;_0x46d9b5=_0x1b8f80[_0xf09857(0x30a,0x395,0x309,0x36c)](processCharacterPrompt,_0x46d9b5),_0x427bec=_0x1b8f80['lLzek'](processCharacterPrompt,_0x427bec),_0x46d9b5=await stripChineseAnnotations(_0x46d9b5),_0x427bec=await _0x1b8f80['icSLV'](stripChineseAnnotations,_0x427bec);const _0x5ac747=extension_settings[extensionName][_0x21833c(0x6b,0x17,0xaa,0x10c)][_0xf09857(0x4a4,0x483,0x50e,0x3ee)](),_0x25bf0d=extension_settings[extensionName];_0x1b8f80[_0x21833c(0x8e,0xbf,0x42,-0x1c)](addLog,_0xf09857(0x40a,0x456,0x3b9,0x4e6)+_0x21833c(-0x8d,-0x72,-0x39,-0x79)+'端为'+_0x25bf0d[_0x21833c(0x98,0xb5,0x50,0x83)]+_0xf09857(0x3d3,0x403,0x475,0x479)+_0x25bf0d[_0x21833c(0x3d,0x40,-0x21,-0x58)+_0x21833c(-0x42,-0x1d,0xe,0xf)]);const _0x44bdc9=_0x427bec&&_0x427bec[_0x21833c(0xb4,0xa1,0xaf,0xd3)]()!==''?_0x427bec:_0x46d9b5;addLog(_0xf09857(0x470,0x4a2,0x519,0x4b6)+_0x44bdc9);let _0x36b2ce=![];_0x44bdc9[_0xf09857(0x47e,0x46a,0x3d9,0x404)]('Scene\x20Comp'+_0xf09857(0x3d3,0x451,0x4ad,0x3d6))&&(_0x36b2ce=!![]);_0x1b8f80[_0xf09857(0x431,0x416,0x440,0x490)](addLog,'是否启用分角色模式\x20'+_0x21833c(-0x4a,0x26,-0x8,-0x5b)+'les):\x20'+_0x36b2ce);function _0xf09857(_0x5c9477,_0x1b7f55,_0x58d96e,_0x121c1d){return _0x3c53(_0x1b7f55-0x1f3,_0x5c9477);}let _0x5c9660={},_0x3bb00a='',_0x31014c='';if(_0x36b2ce){if(_0x1b8f80['ezEkl'](_0x1b8f80[_0xf09857(0x49a,0x484,0x487,0x417)],_0x1b8f80[_0xf09857(0x4a6,0x4bd,0x423,0x44b)]))_0x1b8f80[_0x21833c(0x33,0xaa,0x41,0x8b)](_0x561eec,_0x1b8f80[_0xf09857(0x3db,0x435,0x4cb,0x40d)]),_0xf3be78=_0x8b3f46;else{_0x1b8f80[_0xf09857(0x40f,0x49b,0x51d,0x420)](addLog,_0x1b8f80[_0xf09857(0x442,0x3f7,0x469,0x35e)]),_0x5c9660=_0x1b8f80['JAUep'](parsePromptStringWithCoordinates,_0x44bdc9),_0x3bb00a=_0x5c9660[_0x21833c(0x113,0x159,0xcf,0x95)+_0xf09857(0x4dd,0x451,0x4c9,0x3dc)];for(let _0x3c5a63=-0x3d5*-0x2+-0x2*-0x585+-0x12b3;_0x1b8f80[_0xf09857(0x373,0x3f9,0x403,0x40f)](_0x3c5a63,-0xfa3+0x12f4+-0x41*0xd);_0x3c5a63++){if(_0xf09857(0x3ac,0x37c,0x3b0,0x3a0)===_0x1b8f80[_0x21833c(-0xc,0xb3,0x8c,0x99)]){if(_0x5c9660[_0x21833c(-0xc,-0x3c,0x67,0xae)+_0x3c5a63+'\x20Prompt']){if(_0x1b8f80['dUndt']===_0x21833c(0x96,0x112,0xed,0x74))_0x31014c=_0x1b8f80[_0x21833c(0xe3,0x9e,0xa3,0x119)](_0x1b8f80[_0x21833c(-0xb0,-0x4d,-0x1b,0x29)](_0x31014c,',\x20'),_0x5c9660[_0xf09857(0x4b3,0x43b,0x484,0x4c8)+_0x3c5a63+_0x21833c(0xda,0x6,0x68,0x9)]);else{_0x1b8f80[_0x21833c(0x23,-0x2b,0x41,0xd5)](_0x41a612,_0xf09857(0x37d,0x3a5,0x400,0x31b)+_0x281b4f[_0xf09857(0x544,0x4ab,0x47b,0x508)]+'\x20'+_0x1c03c2[_0xf09857(0x327,0x3c2,0x3d4,0x34f)]);throw new _0x1b1db9(_0x21833c(0x5e,-0xd3,-0x2f,-0x2)+_0x460744[_0xf09857(0x460,0x4ab,0x42d,0x42f)]+'\x20'+_0x5ae36d[_0xf09857(0x32f,0x3c2,0x44d,0x39e)]);}}}else _0x1b8f80[_0x21833c(-0x32,0xd6,0x41,-0x1f)](_0x49b419,_0x21833c(0x60,0x10e,0xc3,0x15b)+_0xf09857(0x43d,0x46b,0x3e0,0x41f)),_0x2e6e29=_0x4b8047;}}}else _0x1b8f80['JAUep'](addLog,_0x21833c(0x2a,0xd6,0xc3,0x131)+_0xf09857(0x4c4,0x46b,0x4a2,0x3cd)),_0x3bb00a=_0x44bdc9;let {modifiedPrompt:_0xd3c368,insertions:_0x1d89ad}=await _0x1b8f80[_0x21833c(-0x4c,-0x26,-0x22,-0x2)](prompt_replace,_0x3bb00a,_0x31014c);if(_0x36b2ce)for(let _0x1e0f51=-0xc4c+0x3*0xc0c+-0x17d7;_0x1b8f80['NGryt'](_0x1e0f51,0x262f+-0xd23*-0x1+-0x334e);_0x1e0f51++){_0x5c9660[_0x21833c(-0x33,-0x1d,0x67,0xab)+_0x1e0f51+_0xf09857(0x4d3,0x43c,0x3e1,0x442)]&&(_0xd3c368=_0x1b8f80[_0x21833c(0xd2,0x40,0xa3,0x145)](_0xd3c368,',\x20')+prompt_replace_for_character(_0x5c9660[_0xf09857(0x46a,0x43b,0x424,0x3c0)+_0x1e0f51+_0x21833c(0x2,0x45,0x68,0x1a)]));}let _0x5cc3dc=await _0x1b8f80[_0xf09857(0x47a,0x494,0x434,0x3f2)](zhengmian,extension_settings[extensionName][_0xf09857(0x477,0x452,0x424,0x3c8)][extension_settings[extensionName][_0x21833c(0x4a,-0x2d,0x74,0x9f)]][_0xf09857(0x4a6,0x421,0x437,0x431)+'t'],_0xd3c368,extension_settings[extensionName][_0x21833c(0xf8,-0x1c,0x7e,0x6a)][extension_settings[extensionName]['yusheid_sd']][_0xf09857(0x3a9,0x421,0x4ac,0x3e0)+_0x21833c(0x7f,-0x6a,-0x27,0x3b)],extension_settings[extensionName]['AQT_sd'],_0x1d89ad),_0x45ea7e=await fumian(extension_settings[extensionName][_0xf09857(0x4a0,0x452,0x45c,0x3d7)][extension_settings[extensionName]['yusheid_sd']][_0x21833c(0x74,0x5a,0x3,-0xf)+_0xf09857(0x3bc,0x390,0x36a,0x312)],extension_settings[extensionName][_0x21833c(0x6,-0x6d,0x2b,-0x26)]);_0x1b8f80[_0xf09857(0x53f,0x498,0x47b,0x48e)](addLog,_0xf09857(0x344,0x3a1,0x325,0x352)+_0x45ea7e),extension_settings['sd'][_0x21833c(0x2b,0xf0,0xc1,0x6d)]=_0x5ac747,await saveSettingsDebounced();try{if(_0x1b8f80['ezEkl'](_0x25bf0d[_0xf09857(0x3bb,0x424,0x4b3,0x3b3)],_0x21833c(0x171,0x102,0xdb,0x10a))){if(_0x1b8f80['rhJNw'](_0x1b8f80[_0x21833c(-0x30,0x8d,0x4b,0x93)],_0x1b8f80[_0x21833c(-0xd,0x3d,0x4b,0x34)]))_0xe63d91[_0x21833c(-0x7e,-0x30,-0xc,0x7a)+'sk'](_0x3b9902,![]);else{const _0x289039={};_0x289039['auth']=_0x25bf0d[_0xf09857(0x4b8,0x496,0x409,0x42e)+_0x21833c(-0x1d,-0xe1,-0x3b,0x62)]?_0x25bf0d[_0xf09857(0x523,0x496,0x51f,0x3fa)+_0xf09857(0x30c,0x399,0x352,0x329)]:'',_0x289039[_0xf09857(0x3bd,0x3d9,0x333,0x47c)]=_0x5ac747;const _0x2b5a69=await fetch(_0x21833c(0x2a,0x40,0x87,0x15)+_0x21833c(0x8f,0x87,0x3a,-0x7),{'method':_0x1b8f80[_0xf09857(0x400,0x44e,0x4b3,0x42f)],'body':JSON[_0xf09857(0x400,0x438,0x3a5,0x3e2)](_0x289039),'headers':getRequestHeaders(window[_0xf09857(0x400,0x3a9,0x40a,0x31e)])});if(!_0x2b5a69['ok']){if(_0x1b8f80[_0x21833c(0x10,-0x34,0x5c,0x1a)](_0xf09857(0x437,0x47c,0x464,0x4ec),_0xf09857(0x4f0,0x47c,0x3e2,0x431))){_0x1b8f80[_0x21833c(0xc0,0x95,0x41,-0x29)](addLog,_0x21833c(0x4a,-0x97,-0x2f,-0xb4)+_0x2b5a69[_0xf09857(0x470,0x4ab,0x4fb,0x4f0)]+'\x20'+_0x2b5a69[_0x21833c(0x84,0x60,-0x12,0x8e)]);throw new Error(_0xf09857(0x3cd,0x3a5,0x35c,0x33b)+_0x2b5a69[_0xf09857(0x457,0x4ab,0x507,0x53a)]+'\x20'+_0x2b5a69['statusText']);}else{_0x1b8f80['icSLV'](_0x5703b7,_0x4e2251);return;}}let _0x4bf8c8=await _0x2b5a69[_0x21833c(0x8c,0x51,0x27,0xa2)]();console[_0x21833c(-0x7,0xae,0x54,0x20)](_0x1b8f80[_0xf09857(0x346,0x3e6,0x39f,0x472)],_0x4bf8c8),console['log'](_0x1b8f80[_0xf09857(0x416,0x473,0x419,0x510)],_0x25bf0d[_0x21833c(-0x84,-0x86,-0x21,-0xb0)+_0xf09857(0x3d4,0x3e2,0x38f,0x3cf)]);if(_0x1b8f80['sFHWi'](_0x4bf8c8,_0x25bf0d[_0x21833c(0x83,0x6a,-0x21,0x1c)+_0x21833c(0x51,0x2d,0xe,0xac)])){if(_0x1b8f80[_0xf09857(0x431,0x443,0x3af,0x4c0)](_0x1b8f80[_0x21833c(0x2e,0xb1,0xab,0xa8)],_0x21833c(0xf5,-0x27,0x7f,0xaf))){_0x1b8f80[_0x21833c(-0x5e,-0x1e,-0x18,0xb)](addLog,'正在设置模型为'+_0x25bf0d[_0xf09857(0x30f,0x3b3,0x3c5,0x3b7)+_0x21833c(0x3b,0x1a,0xe,0x6f)]+_0xf09857(0x349,0x37d,0x36a,0x34e)),toastr['info'](_0x21833c(-0x49,-0x42,0x20,0xc7)+_0x25bf0d[_0xf09857(0x438,0x3b3,0x36a,0x391)+'8_model']);const _0x2bf252={};_0x2bf252['auth']=_0x25bf0d[_0x21833c(0x15b,0x72,0xc2,0x13a)+_0xf09857(0x31d,0x399,0x2f4,0x2ff)]?_0x25bf0d[_0xf09857(0x45f,0x496,0x52f,0x460)+_0xf09857(0x3cc,0x399,0x360,0x428)]:'',_0x2bf252[_0xf09857(0x471,0x3d9,0x46e,0x34d)]=_0x5ac747,_0x2bf252[_0xf09857(0x4b7,0x45a,0x3e8,0x43c)]=_0x25bf0d[_0xf09857(0x343,0x3b3,0x3e7,0x426)+_0x21833c(0x99,-0x14,0xe,-0x70)];const _0x2d28b0=await _0x1b8f80[_0x21833c(0x26,-0xa9,-0x22,0x8)](fetch,_0x1b8f80[_0x21833c(0xc2,0x89,0xe0,0x125)],{'method':_0x21833c(0x109,0x9f,0xbc,0x63),'body':JSON[_0x21833c(0xdc,0x9,0x64,0x43)](_0x2bf252),'headers':_0x1b8f80[_0xf09857(0x495,0x415,0x451,0x43d)](getRequestHeaders,window[_0x21833c(-0x54,-0x55,-0x2b,0x50)])});if(!_0x2d28b0['ok']){_0x1b8f80[_0xf09857(0x446,0x4b1,0x48b,0x554)](addLog,'切换模型失败:\x20'+_0x2d28b0[_0x21833c(0xfc,0xd1,0xd7,0x43)]+'\x20'+_0x2d28b0[_0x21833c(-0x70,0x74,-0x12,-0x52)]);throw new Error(_0x21833c(0x38,-0x7b,-0x4,0x75)+_0x2d28b0[_0xf09857(0x4ec,0x4ab,0x4e0,0x490)]+'\x20'+_0x2d28b0[_0xf09857(0x3d0,0x3c2,0x441,0x331)]);}toastr[_0x21833c(-0xd5,-0x70,-0x51,0x15)](_0x21833c(-0xad,-0x1a,-0x35,-0x87)+_0x25bf0d[_0x21833c(0x1f,-0x94,-0x21,0x56)+_0x21833c(-0x70,0x1,0xe,-0x86)]+'成功');}else _0x4fc78a['initialize'+_0x21833c(-0x4a,-0x74,-0x5b,0xc)]=!![],_0x1b8f80[_0xf09857(0x49d,0x43f,0x4a5,0x49e)](_0x4bf1fb);}}}else{if(_0x1b8f80[_0xf09857(0x40c,0x465,0x3e2,0x4b2)]===_0x1b8f80[_0xf09857(0x44c,0x465,0x47b,0x427)]){let _0x1cfe7d=await _0x1b8f80[_0xf09857(0x35e,0x397,0x352,0x31c)](getSDMode,_0x5ac747);if(_0x1b8f80['KsxXm'](_0x1cfe7d,_0x25bf0d[_0x21833c(0x20,-0x52,-0x21,0x29)+_0xf09857(0x42d,0x3e2,0x41a,0x361)])){if(_0x1b8f80[_0x21833c(0xcc,-0x13,0x7c,0x101)](_0x1b8f80[_0xf09857(0x429,0x418,0x417,0x43b)],_0x1b8f80[_0x21833c(0x10e,0x88,0x85,0xbb)]))_0x1b8f80[_0x21833c(0x6f,0xa7,0xa6,0x11e)](addLog,_0x21833c(0xd6,0x157,0xc9,0x94)+_0x25bf0d[_0xf09857(0x42e,0x3b3,0x34a,0x36f)+_0x21833c(0xf,-0x14,0xe,-0x28)]+'...'),await _0x1b8f80[_0x21833c(-0x57,0x2a,-0x22,0xe)](setSDMode,_0x5ac747,_0x25bf0d[_0x21833c(-0x45,0x73,-0x21,0x4d)+'8_model']);else{if(_0x2efa77){const _0x2dcc3f=_0x9e22a8[_0xf09857(0x47e,0x464,0x3fe,0x469)](_0x60e476,arguments);return _0x44246a=null,_0x2dcc3f;}}}}else{_0x1b8f80[_0x21833c(0x115,0x164,0xd4,0xc8)](_0x1b4445,_0x1b8f80[_0xf09857(0x473,0x3f7,0x351,0x476)]),_0x5992e9=_0x1b8f80['jNIOu'](_0x8f2ea4,_0x26230f),_0x68353c=_0xa8a597[_0x1b8f80[_0xf09857(0x3b5,0x3e3,0x47b,0x3d0)]];for(let _0x2f18ea=-0x2*0x80b+-0x26e8+0x36ff;_0x1b8f80['ENlJM'](_0x2f18ea,0x90d*-0x1+0x189a+-0x29*0x61);_0x2f18ea++){_0x45621e[_0x21833c(0xad,-0xa,0x67,0xbd)+_0x2f18ea+_0x21833c(0xc1,-0x1f,0x68,-0x2b)]&&(_0x1e01f9=_0x1b8f80[_0x21833c(0xf1,-0x2,0xa3,0xd2)](_0x1b8f80['tdJND'](_0x3d81c5,',\x20'),_0x1bb9fb[_0x21833c(-0x2,0x61,0x67,0xbb)+_0x2f18ea+_0xf09857(0x3e0,0x43c,0x403,0x45b)]));}}}}catch(_0xba5666){_0x1b8f80['lLzek'](addLog,_0xf09857(0x343,0x3a4,0x418,0x37d)+':\x20'+_0xba5666['message']+(_0xf09857(0x36e,0x3b7,0x345,0x39b)+_0xf09857(0x4cf,0x470,0x49c,0x481)+_0x21833c(0x2e,0xa,-0x1f,-0x9e))),taskQueue['completeTa'+'sk'](_0x3122c2,![]),currentTaskId=null;throw new Error(_0xf09857(0x421,0x3a4,0x3b0,0x3e5)+_0xf09857(0x336,0x3b1,0x3d7,0x3b6)+_0x21833c(0xea,0x5b,0x9c,0x0)+_0xf09857(0x432,0x3b5,0x336,0x35a));}function _0x21833c(_0x18baa6,_0x4d1dcb,_0x5c54f9,_0x380e20){return _0x3c53(_0x5c54f9- -0x1e1,_0x380e20);}let _0x4268f9=-(-0xd8c+-0x15d3*0x1+0x11b*0x20);const _0x3618f7=_0x25bf0d[_0xf09857(0x3f9,0x396,0x360,0x337)];_0x3618f7!==''&&_0x1b8f80[_0xf09857(0x3d6,0x450,0x3e2,0x44f)](_0x3618f7,null)&&!isNaN(_0x1b8f80[_0xf09857(0x4ba,0x416,0x43c,0x4ba)](Number,_0x3618f7))&&_0x1b8f80['wtBRx'](_0x1b8f80[_0xf09857(0x33e,0x3bc,0x315,0x357)](Number,_0x3618f7),0x3e*0x4f+0xd10+-0x1019*0x2)&&(_0x4268f9=_0x1b8f80[_0xf09857(0x4ab,0x4a8,0x4bf,0x501)](Number,_0x3618f7));let _0x2e40be={'prompt':_0x5cc3dc,'negative_prompt':_0x45ea7e,'sampler_name':_0x25bf0d[_0xf09857(0x38e,0x3b3,0x357,0x3f8)+'8_samplerN'+_0x21833c(0x51,0x59,0x37,-0x3a)],'scheduler':_0x25bf0d[_0xf09857(0x32a,0x3b3,0x356,0x34e)+_0x21833c(-0x53,-0x27,0x21,-0x69)+'r'],'steps':_0x25bf0d[_0x21833c(0xe2,0x139,0xb5,0xa0)],'cfg_scale':_0x25bf0d[_0xf09857(0x34a,0x3a3,0x3ba,0x378)],'width':_0x1adcac?_0x1adcac:_0x25bf0d[_0x21833c(0x39,0xff,0x84,0x10e)],'height':_0x11dffa?_0x11dffa:_0x25bf0d[_0xf09857(0x3aa,0x42a,0x4c6,0x38c)],'restore_faces':_0x1b8f80[_0x21833c(0x1e,0xca,0x51,-0x13)](_0x25bf0d[_0x21833c(-0x5,0xa3,0xa2,0xd1)+'es'],_0x21833c(-0x46,-0x92,-0x40,-0x7e)),'enable_hr':_0x1b8f80[_0x21833c(0x82,0x38,0x51,-0x2f)](_0x25bf0d[_0xf09857(0x498,0x4be,0x514,0x491)+_0xf09857(0x4fa,0x47d,0x438,0x48c)],_0x1b8f80[_0x21833c(0xda,0x55,0x65,0xd6)]),'hr_upscaler':_0x25bf0d[_0x21833c(-0x23,0x45,-0x21,-0x93)+'8_upscaler'],'hr_scale':_0x25bf0d[_0x21833c(0x70,0xfb,0xba,0x5b)+_0x21833c(0x37,0x30,0xd2,0x3b)],'hr_additional_modules':[],'denoising_strength':_0x25bf0d[_0xf09857(0x3e5,0x3fc,0x39d,0x3dc)+_0x21833c(-0x86,0xaa,0x4,0x6f)+'th'],'hr_second_pass_steps':_0x25bf0d['sd_chires_'+_0x21833c(0xd1,0x154,0xc5,0x8a)],'seed':_0x4268f9,'override_settings':{'CLIP_stop_at_last_layers':_0x1b8f80[_0xf09857(0x3f4,0x395,0x3e7,0x364)](Number,_0x25bf0d[_0x21833c(0x94,0x173,0xe7,0xcc)+_0x21833c(0x2d,0x6d,0x8a,0x75)]),'sd_vae':_0x25bf0d[_0xf09857(0x3cc,0x3b3,0x35a,0x332)+'8_vae']},'override_settings_restore_afterwards':!![],'save_images':!![],'send_images':!![],'do_not_save_grid':![],'do_not_save_samples':![]};_0x1b8f80[_0xf09857(0x3f1,0x416,0x469,0x4b6)](addLog,_0x21833c(0xcb,0x184,0xdf,0x8c)+_0xf09857(0x471,0x3cb,0x38c,0x400)+_0x2e40be[_0xf09857(0x411,0x4b3,0x540,0x46d)+_0x21833c(-0x10,0x2c,-0x54,-0xf9)]),addLog(_0x21833c(0x142,0xc0,0xe2,0x13b)+_0xf09857(0x47f,0x400,0x3f7,0x42d)+_0x2e40be[_0xf09857(0x39b,0x3ca,0x3b7,0x40d)]);_0x1b8f80['BfeoN'](_0x25bf0d[_0x21833c(0xa6,0x54,0x71,0x96)+_0x21833c(-0x35,0xd,-0x2d,0x23)],_0xf09857(0x313,0x394,0x40d,0x36a))&&(_0x1b8f80[_0x21833c(-0x27,-0x44,0xb,-0x5a)](addLog,_0x21833c(-0x73,0x27,-0x14,0x68)+_0xf09857(0x400,0x398,0x354,0x312)),_0x2e40be=_0x1b8f80[_0xf09857(0x3e9,0x402,0x3e2,0x465)](deepMerge,_0x2e40be,{'alwayson_scripts':{'ADetailer':{'args':[!![],!![],{'ad_model':_0x1b8f80[_0xf09857(0x478,0x432,0x3f9,0x3a3)]}]}}}));const _0x597a1d='\x0a---\x0a###\x20生'+_0xf09857(0x3a2,0x3a8,0x3c4,0x341)+_0x21833c(0x184,0x145,0xeb,0x103)+_0xf09857(0x4b5,0x4c2,0x501,0x4bd)+_0x5cc3dc+(_0xf09857(0x3cb,0x44a,0x460,0x479)+_0x21833c(0x15,0x63,-0x20,-0x1)+_0xf09857(0x44d,0x422,0x39e,0x48a)+'\x20')+_0x45ea7e+('\x0a-\x20**采样方法\x20'+_0xf09857(0x413,0x38a,0x360,0x3e6)+_0x21833c(0x3c,0xbd,0x8f,0x2e))+_0x2e40be[_0xf09857(0x49e,0x426,0x457,0x46e)+'me']+(_0xf09857(0x3e8,0x457,0x4e9,0x3e5)+_0xf09857(0x315,0x3aa,0x344,0x34d))+_0x2e40be['steps']+(_0x21833c(0x165,0x3d,0xd5,0x143)+_0x21833c(-0xa,0x7,-0x41,0x19))+_0x2e40be[_0xf09857(0x4f0,0x488,0x42a,0x40f)]+(_0x21833c(0xbe,0x5e,0x46,0xa3)+_0x21833c(-0x4b,0x2a,-0x13,-0x14))+_0x2e40be[_0x21833c(-0x18,0x9,0x62,0x98)]+'x'+_0x2e40be[_0x21833c(-0x79,0x14,-0x17,0x7b)]+(_0xf09857(0x371,0x40d,0x36e,0x3fb)+_0xf09857(0x437,0x3d4,0x43e,0x3f5))+(_0x1b8f80[_0x21833c(-0x52,-0xcc,-0x5c,-0x5d)](_0x2e40be[_0x21833c(-0x87,0x5,-0x6,-0x99)],-(-0x1d*0x4a+-0x18b+0x9ee))?_0x1b8f80[_0xf09857(0x39d,0x388,0x30e,0x3e1)]:_0x2e40be['seed'])+(_0xf09857(0x37a,0x3c5,0x34d,0x3ee)+_0xf09857(0x45c,0x3dd,0x3c8,0x3e0))+_0x25bf0d[_0x21833c(-0x60,0x6a,-0x21,-0x93)+'8_model']+(_0x21833c(0x14,0x32,-0x3,0x68)+'*\x20')+_0x2e40be[_0xf09857(0x54a,0x4c6,0x45e,0x547)+_0xf09857(0x3be,0x386,0x418,0x315)]['sd_vae']+(_0x21833c(0x72,0x1a,0x99,0x94)+_0xf09857(0x433,0x3d3,0x3e5,0x45c))+_0x2e40be[_0x21833c(0x118,0x14b,0xf2,0xc1)+_0x21833c(-0x6f,-0x7e,-0x4e,-0x57)]['CLIP_stop_'+_0x21833c(-0xd,-0xbd,-0x45,-0xe3)+_0x21833c(0xae,0x59,0x45,0x19)]+(_0xf09857(0x3a1,0x40a,0x3d1,0x3c7)+_0x21833c(0x62,-0x6e,-0x15,-0x61)+'):**\x20')+_0x2e40be[_0xf09857(0x3ab,0x3ca,0x3aa,0x344)]+('\x0a-\x20**放大倍率\x20'+_0xf09857(0x3c6,0x466,0x47d,0x4e2)+_0x21833c(-0x54,-0x65,-0x4d,0x4d))+_0x2e40be['hr_scale']+(_0xf09857(0x392,0x3b8,0x41e,0x44c)+_0xf09857(0x44d,0x4a5,0x4fb,0x4e0)+_0x21833c(0x4d,-0x57,-0x5a,-0xc1)+_0xf09857(0x40e,0x3f8,0x43d,0x3b7))+_0x2e40be[_0x21833c(0x127,0x170,0xd0,0x94)+'strength']+(_0xf09857(0x46d,0x434,0x3d4,0x4a1)+_0x21833c(0x37,0x130,0xb2,0xa1)+'aces):**\x20')+_0x2e40be[_0x21833c(0x13a,0x122,0xdf,0x13e)+'ces']+(_0xf09857(0x43c,0x3fd,0x362,0x483)+_0xf09857(0x3a4,0x3af,0x318,0x33f))+_0x1b8f80[_0x21833c(0xa0,0x4c,0x51,-0x7)](_0x25bf0d[_0x21833c(-0x30,0x1,0x71,0x71)+_0xf09857(0x414,0x3a7,0x302,0x3b0)],'true')+_0xf09857(0x43b,0x4ad,0x536,0x54b);_0x1b8f80['UAQBb'](addLog,_0x597a1d),_0x1b8f80[_0x21833c(0xd5,0x75,0xd4,0x102)](addLog,_0xf09857(0x34e,0x3a0,0x35f,0x31d)+'数为'+JSON[_0xf09857(0x48f,0x438,0x3c6,0x3f4)](_0x2e40be)),console['log'](_0x1b8f80['RrXsR'],_0x2e40be);while(!window['xiancheng']){await _0x1b8f80[_0x21833c(0x84,0xe7,0xc4,0x8b)](sleep,0x30c+0x4c6+-0x3ea);};try{window['xiancheng']=![],taskQueue[_0xf09857(0x4ac,0x462,0x4de,0x4ce)+'us'](_0x3122c2,_0x1b8f80['ilaSJ']);if(_0x1b8f80[_0xf09857(0x40f,0x4a0,0x4f5,0x469)](_0x25bf0d[_0x21833c(-0x4,0x9c,0x50,0x98)],_0x21833c(0x12b,0x17c,0xdb,0x52))){if(!taskQueue[_0x21833c(0x45,0x80,0x15,-0x5)+_0x21833c(0xa3,-0x67,0x1e,0x36)](_0x3122c2)){_0x1b8f80[_0x21833c(0x8e,0x7f,0xdd,0xbf)](addLog,_0x1b8f80[_0xf09857(0x3c9,0x3f3,0x3c4,0x3a2)]),eventSource[_0xf09857(0x4a4,0x454,0x41c,0x48c)](_0x21833c(-0x11,-0x2f,0x17,0x4c)+_0xf09857(0x3af,0x417,0x37f,0x449));throw new Error(_0x1b8f80[_0xf09857(0x42c,0x431,0x3fd,0x3f3)]);}_0x2e40be[_0x21833c(-0x3,-0x6f,0x5,-0x7b)]=_0x5ac747,console[_0x21833c(0xad,0xaf,0x54,0xf2)](_0x1b8f80['FiJfF'],_0x25bf0d['st_chatu8_'+'sd_auth']),_0x2e40be[_0x21833c(0x101,0xa6,0xb7,0x9a)]=_0x25bf0d[_0xf09857(0x4ae,0x496,0x423,0x4cd)+'sd_auth']?_0x25bf0d[_0xf09857(0x465,0x496,0x425,0x51b)+'sd_auth']:'';const _0x1eba4f=await _0x1b8f80[_0x21833c(-0x78,0xb5,0x2e,-0x11)](fetch,'/api/sd/ge'+_0xf09857(0x3a0,0x3ec,0x456,0x47e),{'method':_0xf09857(0x525,0x490,0x421,0x4f4),'headers':_0x1b8f80['vszlp'](getRequestHeaders,window[_0xf09857(0x3e5,0x3a9,0x43b,0x3dd)]),'body':JSON[_0x21833c(0x18,-0x3,0x64,0xa0)](_0x2e40be)});if(!_0x1eba4f['ok']){const _0x38f616=await _0x1eba4f[_0xf09857(0x453,0x3fb,0x41d,0x3e1)]();_0x1b8f80[_0x21833c(0xcf,0xba,0x42,-0x65)](addLog,_0x21833c(0x20,0x78,-0x24,-0xf)+_0x21833c(0x116,0xed,0x8b,0x103)+_0x1eba4f[_0xf09857(0x43a,0x4ab,0x529,0x48c)]+_0xf09857(0x3e3,0x391,0x3fc,0x3f6)+_0x38f616),console['log'](_0x1b8f80['vMYMi'],_0x38f616);throw new Error('请求失败,状态码:\x20'+_0x1eba4f[_0x21833c(0x140,0x5f,0xd7,0x5d)]+_0xf09857(0x32f,0x3ba,0x45f,0x389)+_0x38f616);}const _0xf1a4d8=await _0x1eba4f['text']();let _0x48b65c='';try{const _0x4025dc=JSON[_0x21833c(0xd1,0xf0,0xe6,0x95)](_0xf1a4d8);_0x48b65c=_0x4025dc[_0xf09857(0x4b4,0x4a7,0x53c,0x4c3)][-0x1f*0x15+-0x1508+-0x5*-0x4b7];}catch(_0x266b87){addLog(_0x1b8f80[_0x21833c(0x89,0x8e,0x61,0x4d)]),_0x48b65c=_0xf1a4d8;}const _0x3d2ee7=_0x1b8f80[_0xf09857(0x360,0x3ea,0x478,0x477)](_0x1b8f80[_0xf09857(0x4fd,0x49a,0x444,0x469)],_0x48b65c);_0x1b8f80['jNIOu'](addLog,_0x1b8f80[_0xf09857(0x485,0x405,0x3a1,0x40d)]),_0x1b8f80['OEfrr'](setTimeout,()=>{function _0x58f49b(_0x4c2bde,_0x530f3d,_0x78521b,_0x147430){return _0x21833c(_0x4c2bde-0x7d,_0x530f3d-0x195,_0x78521b-0x22e,_0x4c2bde);}function _0x542b64(_0x26546f,_0x38062b,_0x5ad302,_0x3a3648){return _0x21833c(_0x26546f-0x181,_0x38062b-0x187,_0x3a3648- -0x16e,_0x26546f);}if(_0x1b8f80[_0x58f49b(0x20c,0x205,0x2aa,0x2c8)](_0x1b8f80[_0x58f49b(0x299,0x246,0x288,0x219)],_0x58f49b(0x201,0x21c,0x241,0x2e2)))console[_0x58f49b(0x319,0x2db,0x282,0x26a)](_0x1b8f80['ZzXyv']),window[_0x542b64(-0x1e2,-0x172,-0x102,-0x19c)]=!![];else{const _0x5ee982=_0x3e1475[_0x58f49b(0x28d,0x35f,0x2be,0x278)](_0x3462a2,arguments);return _0x2dbac6=null,_0x5ee982;}},extension_settings[extensionName][_0x21833c(0x7d,0x82,0xb9,0xd5)+'terval']);;return taskQueue[_0xf09857(0x3c1,0x3c8,0x381,0x395)+'sk'](_0x3122c2,!![]),currentTaskId=null,{'image':_0x3d2ee7,'change':_0x1b8f80[_0x21833c(-0xcf,-0xe0,-0x55,-0xa6)](_0x427bec,'')};}else{if(!taskQueue[_0xf09857(0x405,0x3e9,0x406,0x352)+'eue'](_0x3122c2)){if(_0x1b8f80['sFpNv']===_0x1b8f80[_0x21833c(0x15,0x50,0x3d,0xde)])_0x5bc257['on'](_0x240f0c[_0x21833c(-0x34,0x4f,0x1d,0xbe)+_0xf09857(0x4c8,0x440,0x423,0x3ad)+'ST'],_0x26e85a),_0x11612f(_0x1b8f80['EdSgy']);else{_0x1b8f80[_0x21833c(-0x3d,-0xa2,-0x3d,0xf)](addLog,_0x1b8f80[_0x21833c(0x1e,0x97,0x1f,-0x82)]);throw new Error(_0x1b8f80[_0x21833c(0x74,0x2d,0x5d,0xb0)]);}}const _0x4c24b9=new URL(_0x1b8f80[_0xf09857(0x3f9,0x3ea,0x41a,0x48a)](_0x5ac747,_0x1b8f80[_0x21833c(-0x11,0x7c,0x11,-0x8c)]));window[_0xf09857(0x33c,0x3a6,0x392,0x33f)]=![];const _0x1f013a=await fetch(_0x4c24b9,{'method':_0x21833c(0x122,0x4e,0xbc,0xe3),'body':JSON['stringify'](_0x2e40be),'headers':{'Content-Type':_0x1b8f80[_0x21833c(0xa1,0x52,0x38,-0x3c)],'Authorization':_0x1b8f80[_0x21833c(0x5c,0x4e,0x6b,0x80)](getsdAuth)}});setTimeout(()=>{function _0x22c0e4(_0x479f3a,_0x46c975,_0x419f04,_0x276e72){return _0x21833c(_0x479f3a-0x5e,_0x46c975-0xb5,_0x419f04-0x232,_0x46c975);}function _0x35e256(_0x1114b5,_0x408563,_0x517f55,_0x3a7ecf){return _0x21833c(_0x1114b5-0xd4,_0x408563-0x1e8,_0x3a7ecf-0x203,_0x517f55);}if(_0x1b8f80[_0x22c0e4(0x306,0x2f8,0x2a1,0x28d)](_0x35e256(0x231,0x240,0x23d,0x1ad),_0x22c0e4(0x1ca,0x14d,0x1dc,0x21b)))return _0x4b2182[_0x22c0e4(0x249,0x2e4,0x2a0,0x277)]()[_0x22c0e4(0x2d2,0x2f3,0x30c,0x284)](mKonIL[_0x35e256(0x1d7,0x242,0x1e8,0x230)])[_0x35e256(0x2c3,0x22a,0x2df,0x271)]()['constructo'+'r'](_0x516eba)[_0x35e256(0x272,0x320,0x2d1,0x2dd)](mKonIL['FUrzv']);else console[_0x35e256(0x240,0x24d,0x254,0x257)](_0x1b8f80[_0x22c0e4(0x25f,0x2c6,0x2c6,0x28f)]),window[_0x22c0e4(0x1ba,0x163,0x204,0x255)]=!![];},extension_settings[extensionName][_0x21833c(0x7f,0xe8,0xb9,0x5d)+_0xf09857(0x413,0x3e4,0x44a,0x3d0)]);;if(!_0x1f013a['ok']){if(_0x1b8f80[_0x21833c(0xba,0xeb,0x6f,0xfa)](_0x1b8f80[_0x21833c(0x49,0xfd,0xac,0xb3)],_0x1b8f80[_0x21833c(0x116,-0xd,0x75,0xbb)])){const _0x52fed5=await _0x1f013a[_0x21833c(0x72,0xb7,0x27,0xc2)]();_0x1b8f80[_0xf09857(0x34a,0x3d6,0x470,0x336)](addLog,'SD\x20API\x20返回错'+_0x21833c(0xe2,0xc,0x5b,0x5a)+_0x1f013a[_0x21833c(0x163,0x68,0xd7,0xab)]+_0xf09857(0x30d,0x391,0x35b,0x3cc)+_0x52fed5),console[_0x21833c(-0x9,0xf2,0x54,0xb8)](_0x1b8f80['vMYMi'],_0x52fed5);throw new Error('请求失败,状态码:\x20'+_0x1f013a['status']+_0x21833c(-0xa1,0xa,-0x1a,0x56)+_0x52fed5);}else _0x4d19ca=_0x1b8f80['tdJND'](_0x26842a,',\x20')+_0x1b8f80[_0x21833c(0x59,0xc7,0x95,0x24)](_0x14a1fb,_0x45a1ea['Character\x20'+_0x3e7716+_0x21833c(0xb,0x3e,0x68,0x54)]);}const _0x41d564=await _0x1f013a['json']();if(!_0x41d564['images']||_0x1b8f80[_0x21833c(0x47,0xa7,0x1b,0x99)](_0x41d564[_0xf09857(0x4f8,0x4a7,0x52d,0x4f5)][_0x21833c(0x64,-0x8,0x9d,0x98)],0x2367+0x66*-0x3b+-0x69*0x1d))throw new Error(_0x1b8f80[_0xf09857(0x45a,0x41d,0x411,0x3e7)]);const _0x27b84c=_0x41d564[_0x21833c(0x107,0x103,0xd3,0xba)][-0x1aaa+-0x2f*-0x6d+0x6a7],_0xf8d46b=_0x1b8f80[_0x21833c(0xa1,-0x69,0x3f,0x33)](_0x1b8f80[_0xf09857(0x477,0x49a,0x46e,0x529)],_0x27b84c);_0x1b8f80[_0xf09857(0x465,0x475,0x474,0x514)](addLog,_0x1b8f80['GdbDU']),taskQueue[_0xf09857(0x42a,0x3c8,0x3c4,0x3c1)+'sk'](_0x3122c2,!![]),currentTaskId=null;const _0x3d8767={};return _0x3d8767[_0xf09857(0x348,0x3ed,0x347,0x45c)]=_0xf8d46b,_0x3d8767[_0xf09857(0x425,0x3ee,0x381,0x425)]=_0x361073||'',_0x3d8767;}}catch(_0x490456){if(_0x1b8f80['PYfZx'](_0x1b8f80['UKRyt'],_0xf09857(0x40c,0x45d,0x495,0x4b3))){window['xiancheng']=!![];if(_0x1b8f80[_0x21833c(-0x47,-0x96,-0x5c,0x3a)](_0x490456[_0x21833c(0x7a,0x127,0xb8,0x3d)],_0x1b8f80[_0x21833c(0x6b,-0x32,0x5d,-0x2d)])){}else _0x1b8f80[_0x21833c(0xba,0xb2,0xb3,0x135)](_0x1b8f80[_0x21833c(0x4a,0x5d,0x30,0x9)],_0x21833c(-0x27,0x11b,0x81,0xf))?taskQueue[_0xf09857(0x40d,0x3c8,0x3c2,0x37a)+'sk'](_0x3122c2,![]):(_0x2226ab[_0xf09857(0x3f7,0x428,0x49c,0x4b9)](_0xf09857(0x334,0x384,0x3af,0x403)+_0x21833c(0x105,-0x1f,0x77,0x47)),_0x59cd9f[_0xf09857(0x426,0x3a6,0x445,0x3ba)]=!![]);currentTaskId=null,_0x1b8f80[_0xf09857(0x4cb,0x46e,0x47b,0x453)](addLog,_0xf09857(0x434,0x482,0x445,0x509)+_0x490456[_0xf09857(0x453,0x48c,0x41d,0x3f7)]),console[_0x21833c(0x148,0x75,0xa0,0x12a)](_0x1b8f80[_0xf09857(0x35d,0x39e,0x3eb,0x37d)],_0x490456);throw _0x490456;}else{_0x1b8f80[_0xf09857(0x40e,0x415,0x481,0x4a4)](_0x3d6cdc,_0xf09857(0x460,0x3d0,0x443,0x3fe)+_0x543f94[_0x21833c(0x116,0x13a,0xd7,0x51)]+'\x20'+_0x2b2fdf['statusText']);throw new _0x376e6c(_0x21833c(0xa2,0x81,-0x4,-0x98)+_0x5be061[_0xf09857(0x488,0x4ab,0x446,0x475)]+'\x20'+_0x5a70f6[_0xf09857(0x378,0x3c2,0x367,0x45d)]);}}}async function sdGenerate(_0x287b00){const _0x16811f={'ZknHc':function(_0x2880a6,_0x1eeaa4){return _0x2880a6+_0x1eeaa4;},'qekYe':function(_0x5239fb,_0x35e716){return _0x5239fb+_0x35e716;},'KBElL':function(_0x36fb2f,_0xb5c398){return _0x36fb2f(_0xb5c398);},'nLqcG':'{修图}','PkpQm':function(_0x467f5c,_0x13387c,_0x59f7ae,_0xcf37f9){return _0x467f5c(_0x13387c,_0x59f7ae,_0xcf37f9);},'debEY':function(_0x1d7ab3,_0x10804){return _0x1d7ab3(_0x10804);},'gAeXY':function(_0x17b156,_0x4ada7e){return _0x17b156===_0x4ada7e;},'WOWsY':_0x562484(0x371,0x39a,0x40f,0x389),'dbVcV':function(_0x1e20e4,_0x401853){return _0x1e20e4===_0x401853;},'dFjLf':_0x47760d(-0x150,-0x6a,-0x181,-0x100),'ypRDP':function(_0x18ed7f,_0x5af3aa){return _0x18ed7f(_0x5af3aa);},'oGxVa':_0x562484(0x3f7,0x3c7,0x376,0x3ec)+_0x47760d(-0xe5,-0xdc,-0x1de,-0x15b)+'image:','wImnM':function(_0x766107,_0x22f9a8){return _0x766107(_0x22f9a8);}};function _0x47760d(_0x10d8d4,_0xe68a0,_0x51e031,_0x2b6f93){return _0x3c53(_0x2b6f93- -0x3c4,_0x51e031);}function _0x562484(_0x1c1a88,_0x39ce99,_0x31c01f,_0x34aacf){return _0x3c53(_0x39ce99-0x153,_0x34aacf);}const {id:_0x40a913,prompt:_0x5a51ba,width:_0x103a7f,height:_0x18ba7f,change:_0x1ff8d1}=_0x287b00;_0x16811f[_0x562484(0x28d,0x2e9,0x298,0x38d)](addLog,_0x47760d(-0xcd,-0xd9,-0x122,-0x173)+_0x562484(0x346,0x397,0x38c,0x3e3)+_0x40a913+(_0x562484(0x3f2,0x3ea,0x3e3,0x3a0)+':\x20')+_0x5a51ba+(_0x1ff8d1?_0x47760d(-0x1ee,-0x14f,-0x168,-0x16a)+'\x20'+_0x1ff8d1:''));if(_0x1ff8d1&&_0x1ff8d1['includes'](_0x16811f[_0x562484(0x391,0x302,0x35e,0x2da)])){_0x16811f[_0x562484(0x2ee,0x2e9,0x290,0x24c)](bananaGenerate,_0x287b00);return;}try{const {image:_0x5cecc4,change:_0x32ec2c}=await _0x16811f[_0x562484(0x272,0x2e9,0x2ef,0x311)](generateSDImage,{'prompt':_0x5a51ba,'width':_0x103a7f,'height':_0x18ba7f,'change':_0x1ff8d1});if(extension_settings[extensionName][_0x47760d(-0x27d,-0x279,-0x1d2,-0x1dc)]!='0'){const _0x89ca9a={};_0x89ca9a[_0x562484(0x2c3,0x34e,0x316,0x378)]=_0x32ec2c,await _0x16811f[_0x47760d(-0x18e,-0x19a,-0x275,-0x20b)](setItemImg,_0x5a51ba,_0x5cecc4,_0x89ca9a),_0x16811f[_0x562484(0x3cc,0x38b,0x40f,0x3d3)](addLog,_0x562484(0x43f,0x3a6,0x421,0x334)+_0x47760d(-0x1b7,-0x1b2,-0x206,-0x236)+'\x20'+_0x5a51ba);}else _0x16811f[_0x47760d(-0x13c,-0x1c7,-0x25f,-0x1c7)](_0x16811f[_0x562484(0x3df,0x39d,0x3cf,0x32e)],_0x16811f['WOWsY'])?_0x16811f['KBElL'](addLog,'缓存设置为不存入数据'+'库'):(_0x475b4d[_0x562484(0x2eb,0x388,0x35e,0x39b)](_0x562484(0x2da,0x2e4,0x297,0x2e3)+_0x47760d(-0x146,-0x1af,-0x1f3,-0x16c)),_0x3750cc[_0x47760d(-0x247,-0x269,-0x1aa,-0x211)]=!![]);const _0x3ab53f={};_0x3ab53f['id']=_0x40a913,_0x3ab53f[_0x47760d(-0x124,-0xaf,-0x193,-0xfe)]=!![],_0x3ab53f['imageData']=_0x5cecc4,_0x3ab53f[_0x562484(0x2cb,0x35a,0x33b,0x2de)]=_0x5a51ba,_0x3ab53f[_0x47760d(-0x23d,-0x178,-0x197,-0x1c9)]=_0x32ec2c,eventSource[_0x47760d(-0x15e,-0x16b,-0xea,-0x163)](EventType['GENERATE_I'+_0x562484(0x2b5,0x332,0x2e2,0x295)+_0x47760d(-0x137,-0xb4,-0x1b3,-0x13e)],_0x3ab53f),addLog('发送SD生图成功响应'+_0x562484(0x309,0x3af,0x348,0x428)+_0x40a913+')');}catch(_0x2d539c){if(_0x16811f[_0x47760d(-0x1d2,-0x200,-0x1ce,-0x199)](_0x16811f[_0x562484(0x35c,0x37b,0x3f2,0x31f)],_0x16811f[_0x47760d(-0x1f8,-0x159,-0x1be,-0x19c)])){const _0x3f2bb5=_0x562484(0x2fd,0x335,0x340,0x34f)+_0x562484(0x40e,0x374,0x304,0x344)+_0x40a913+_0x47760d(-0x14f,-0x17f,-0x258,-0x1e8)+_0x2d539c['message'];_0x16811f['ypRDP'](addLog,_0x562484(0x475,0x3f3,0x3f7,0x379)+_0x3f2bb5),console['error'](_0x16811f[_0x562484(0x42c,0x412,0x459,0x481)],_0x2d539c);const _0x186303={};_0x186303['id']=_0x40a913,_0x186303[_0x562484(0x38a,0x419,0x44c,0x3ab)]=![],_0x186303[_0x47760d(-0x1bc,-0x154,-0xf6,-0x143)]=_0x2d539c['message'],_0x186303[_0x47760d(-0x230,-0x180,-0x13b,-0x1bd)]=_0x5a51ba,eventSource[_0x562484(0x41d,0x3b4,0x36a,0x325)](EventType['GENERATE_I'+_0x562484(0x394,0x332,0x2a6,0x334)+_0x47760d(-0x1c7,-0x119,-0xff,-0x13e)],_0x186303),_0x16811f[_0x562484(0x283,0x2e2,0x2d7,0x382)](addLog,_0x562484(0x3d9,0x3db,0x38e,0x392)+'\x20(ID:\x20'+_0x40a913+')');}else _0x240700[_0x47760d(-0x1d7,-0x11e,-0x14a,-0x17c)+_0x1a0d0f+_0x47760d(-0x1bb,-0x1a7,-0x1fe,-0x17b)]&&(_0x2e7016=_0x16811f[_0x562484(0x3a0,0x3d8,0x39b,0x386)](_0x16811f[_0x562484(0x35d,0x33e,0x391,0x36a)](_0x43b6e3,',\x20'),_0x4b8f4b[_0x562484(0x382,0x39b,0x42f,0x381)+_0x46d21a+_0x562484(0x371,0x39c,0x30d,0x37c)]));}}function initializeSDListener(){const _0x3dba22={'QVxQQ':function(_0x79e692,_0x357b5a){return _0x79e692(_0x357b5a);},'QBIpw':'SD\x20生图事件监听器'+_0x56ee97(0x19a,0x226,0x2b0,0x2a9)};function _0x2c2e17(_0x19ad94,_0x1393ea,_0x258af2,_0x4cf310){return _0x3c53(_0x1393ea-0x34a,_0x258af2);}eventSource['on'](EventType[_0x56ee97(0x1e9,0x269,0x223,0x1df)+_0x2c2e17(0x5ef,0x597,0x4f7,0x5f5)+'ST'],sdGenerate);function _0x56ee97(_0xd68718,_0xd11e99,_0x2d0e01,_0x3f0fd4){return _0x3c53(_0xd11e99-0x6b,_0xd68718);}_0x3dba22[_0x2c2e17(0x51b,0x53f,0x56a,0x583)](addLog,_0x3dba22[_0x56ee97(0x32e,0x294,0x2b3,0x28b)]);}export async function replaceWithSd(){function _0x499735(_0x392e7b,_0x5cafb3,_0x398117,_0x332106){return _0x3c53(_0x332106-0x114,_0x5cafb3);}const _0x126fc9={'vfwon':function(_0x2f0485,_0x387b9e){return _0x2f0485+_0x387b9e;},'ffNbx':function(_0x25cf6a,_0x63bd33){return _0x25cf6a(_0x63bd33);},'DNIsR':function(_0x42cf25,_0x514d58){return _0x42cf25===_0x514d58;},'AzYJA':'OMBbo','HOvVR':function(_0x571566){return _0x571566();},'qniFI':function(_0x349817){return _0x349817();},'AtOBi':_0x2bb8fc(0x146,0x209,0x1bb,0x1e8)+_0x2bb8fc(0x28d,0x1d2,0x207,0x239)};function _0x2bb8fc(_0x5c06c1,_0x4ddfd1,_0x3e46da,_0x3c1cea){return _0x3c53(_0x3e46da-0x37,_0x5c06c1);}extension_settings[extensionName][_0x499735(0x281,0x325,0x2aa,0x2df)]=='sd'?_0x126fc9['DNIsR'](_0x126fc9[_0x2bb8fc(0x25a,0x226,0x20b,0x1b4)],'OMBbo')?(!window[_0x499735(0x224,0x358,0x2c3,0x2b3)+_0x2bb8fc(0x23b,0x21d,0x1bd,0x1d0)]&&(window[_0x2bb8fc(0x243,0x130,0x1d6,0x22a)+_0x499735(0x2bf,0x304,0x27b,0x29a)]=!![],_0x126fc9[_0x2bb8fc(0x2be,0x258,0x2e3,0x257)](initializeSDListener)),_0x126fc9['qniFI'](initializeImageProcessing)):_0x12d0f9['Character\x20'+_0x47588d+_0x2bb8fc(0x268,0x2fd,0x280,0x1ef)]&&(_0x19d67c=_0x126fc9[_0x2bb8fc(0x201,0x1c4,0x23a,0x2c1)](_0x452590,',\x20')+_0x126fc9['ffNbx'](_0x321a1e,_0x3e1e32[_0x499735(0x2b5,0x3cc,0x3a3,0x35c)+_0x36a8e5+'\x20Prompt'])):window['initialize'+_0x2bb8fc(0x230,0x171,0x1bd,0x159)]&&(eventSource[_0x499735(0x2df,0x3d9,0x3e3,0x348)+_0x499735(0x333,0x3be,0x407,0x36d)](EventType['GENERATE_I'+'MAGE_REQUE'+'ST'],sdGenerate),window[_0x2bb8fc(0x148,0x22d,0x1d6,0x16b)+_0x499735(0x298,0x262,0x316,0x29a)]=![],_0x126fc9[_0x499735(0x324,0x2ca,0x33b,0x2ad)](addLog,_0x126fc9[_0x499735(0x2ac,0x2b4,0x294,0x2af)]));}