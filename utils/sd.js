(function(_0x3eea8e,_0x11d1eb){function _0x3a71c1(_0x5ee35a,_0x30d948,_0x61987b,_0x31335f){return _0x3034(_0x61987b-0x217,_0x5ee35a);}const _0x6af43=_0x3eea8e();function _0x14dcc6(_0x35464d,_0x36341e,_0x5e97c1,_0x4ce3e1){return _0x3034(_0x36341e-0x2b,_0x35464d);}while(!![]){try{const _0x444deb=-parseInt(_0x3a71c1(0x44b,0x3cf,0x40b,0x450))/(0xe35*0x1+-0xc39+-0x1fb)*(parseInt(_0x14dcc6(0x1e6,0x1ee,0x25a,0x164))/(-0x26*-0xa+-0xcdf*-0x1+0x1*-0xe59))+-parseInt(_0x3a71c1(0x3e6,0x443,0x3a0,0x33a))/(0xea5+0x1892+-0x2734)*(parseInt(_0x14dcc6(0x252,0x1bb,0x230,0x1f9))/(0x100e+-0xe*0x7f+0x61*-0x18))+-parseInt(_0x14dcc6(0x2f0,0x299,0x29d,0x242))/(0xaf5+0x56c*0x3+0x4*-0x6cd)+-parseInt(_0x3a71c1(0x3df,0x32b,0x3c9,0x3e4))/(0x1*-0x61+-0x1*-0xac5+-0xa5e*0x1)+parseInt(_0x3a71c1(0x37e,0x3be,0x383,0x42a))/(-0x75*0x4f+0xad*-0x1d+0x37bb)*(parseInt(_0x14dcc6(0x2fa,0x2a1,0x27b,0x280))/(-0x26*-0x97+0x13aa+0x33c*-0xd))+-parseInt(_0x14dcc6(0x2aa,0x21c,0x1a6,0x1e7))/(0x2454+-0x1*-0x16ae+0x3af9*-0x1)+parseInt(_0x3a71c1(0x4e2,0x44d,0x444,0x468))/(-0x11b3+0x112d+0x90*0x1);if(_0x444deb===_0x11d1eb)break;else _0x6af43['push'](_0x6af43['shift']());}catch(_0x2d73ae){_0x6af43['push'](_0x6af43['shift']());}}}(_0x1b1b,0x151902+0x13c0e+-0xaba53));const _0x384288=(function(){const _0x3ae273={'iUHGu':function(_0x457704,_0x2abd7e){return _0x457704===_0x2abd7e;},'EDkou':_0x49e31c(0x151,0x26d,0x1dd,0x22f),'gkiav':_0x4064f9(-0x105,-0x14e,-0x102,-0xf9),'xBVqp':function(_0x1d1e61,_0x327b21){return _0x1d1e61===_0x327b21;},'DXsMf':_0x4064f9(-0xb9,-0xf6,-0x131,-0x146),'OgyKl':'2|0|5|1|4|'+'3','vcIxb':_0x4064f9(-0x165,-0x12e,-0xb2,-0x1cc),'KXcNH':function(_0x5632ab,_0x5da2d0){return _0x5632ab(_0x5da2d0);}};function _0x4064f9(_0x127ec9,_0x53d0af,_0x19dcec,_0x5af897){return _0x3034(_0x53d0af- -0x389,_0x5af897);}function _0x49e31c(_0x52f9be,_0xdfdb9e,_0x429602,_0x5901ff){return _0x3034(_0x429602-0x0,_0x5901ff);}let _0x38b729=!![];return function(_0x2f8737,_0x7d3cdd){const _0x370e63={'ZKwFG':_0x3ae273['OgyKl'],'dOJKn':function(_0x53cf74,_0xe33a0){function _0x469ba4(_0x30668f,_0x3b2c74,_0x2ba3b9,_0xec1de6){return _0x3034(_0x30668f- -0x354,_0x3b2c74);}return _0x3ae273[_0x469ba4(-0xbf,-0x17,-0xf9,-0x3d)](_0x53cf74,_0xe33a0);},'ddEMQ':_0x3ae273['vcIxb'],'aFvho':function(_0x50d7b6,_0x59be29){function _0x57c2ff(_0x2de22d,_0xd4834,_0x16989e,_0x2bef8c){return _0x3034(_0x2de22d- -0x14b,_0x2bef8c);}return _0x3ae273[_0x57c2ff(0x85,0x91,0x7c,0xb2)](_0x50d7b6,_0x59be29);},'EjvnC':'Error\x20gene'+_0x4dde5a(0x569,0x591,0x573,0x57d)+'ge:'},_0xab18f2=_0x38b729?function(){function _0x2ae07a(_0x1f8e7b,_0x3fcac9,_0xe9a322,_0x1d4cd6){return _0x4dde5a(_0x1f8e7b-0x62,_0x3fcac9,_0xe9a322-0x42,_0x1f8e7b-0x72);}function _0x681bfa(_0x2d0e3e,_0x1d7f37,_0x340748,_0x5a43eb){return _0x4dde5a(_0x2d0e3e-0x153,_0x5a43eb,_0x340748-0x18f,_0x340748- -0x681);}if(_0x3ae273[_0x2ae07a(0x616,0x6b5,0x582,0x61f)](_0x3ae273[_0x2ae07a(0x5d5,0x637,0x560,0x58f)],_0x3ae273['gkiav']))_0x3c6af8(_0x681bfa(-0x183,-0x129,-0x145,-0xa0)+'库');else{if(_0x7d3cdd){if(_0x3ae273[_0x2ae07a(0x628,0x624,0x636,0x6cb)](_0x3ae273['DXsMf'],_0x2ae07a(0x602,0x59d,0x65b,0x5fb))){const _0x484cda=_0x370e63[_0x681bfa(-0x17a,-0x1a5,-0x15e,-0x10d)][_0x681bfa(-0x148,-0x188,-0x1a3,-0x1cd)]('|');let _0x10ff01=0x2*0x806+-0x1763*-0x1+0x7e3*-0x5;while(!![]){switch(_0x484cda[_0x10ff01++]){case'0':if(_0x370e63[_0x681bfa(-0x195,-0x16e,-0x18a,-0x1e2)](_0x1d4125[_0x681bfa(-0xe2,-0x13f,-0x188,-0xf7)],_0x370e63['ddEMQ'])){}else _0x5a2eec[_0x2ae07a(0x521,0x556,0x53b,0x5bf)+'sk'](_0x52ca19,![]);continue;case'1':_0x370e63[_0x2ae07a(0x5ed,0x546,0x615,0x680)](_0x2c8088,_0x2ae07a(0x522,0x512,0x55e,0x4be)+_0x8cb109[_0x2ae07a(0x56b,0x5b3,0x52c,0x503)]);continue;case'2':_0x63cbb1[_0x681bfa(-0x163,-0x19e,-0x15d,-0xea)]=!![];continue;case'3':throw _0x28de57;continue;case'4':_0x2e86de['error'](_0x370e63[_0x681bfa(-0x8d,-0xcd,-0x10e,-0x1a8)],_0x3c1139);continue;case'5':_0x42630b=null;continue;}break;}}else{const _0x501ed6=_0x7d3cdd[_0x2ae07a(0x516,0x5a1,0x54f,0x576)](_0x2f8737,arguments);return _0x7d3cdd=null,_0x501ed6;}}}}:function(){};function _0x4dde5a(_0x36ba87,_0x3575a0,_0x170e62,_0x3e4c27){return _0x49e31c(_0x36ba87-0x17d,_0x3575a0-0x1de,_0x3e4c27-0x321,_0x3575a0);}return _0x38b729=![],_0xab18f2;};}()),_0x5e83b8=_0x384288(this,function(){function _0x10f42d(_0x2d9262,_0x423fe8,_0x47355b,_0x7b870c){return _0x3034(_0x47355b-0x234,_0x2d9262);}const _0x18e263={};_0x18e263['szKwR']='(((.+)+)+)'+'+$';function _0x3d86dc(_0x1ebff4,_0xa0bd03,_0x4b85e7,_0x371d5c){return _0x3034(_0xa0bd03- -0x9d,_0x1ebff4);}const _0x429fbf=_0x18e263;return _0x5e83b8[_0x3d86dc(0x120,0x187,0x1bb,0xf2)]()[_0x10f42d(0x482,0x515,0x484,0x400)](_0x429fbf['szKwR'])[_0x3d86dc(0x12a,0x187,0x1ef,0x178)]()[_0x10f42d(0x485,0x403,0x479,0x42e)+'r'](_0x5e83b8)['search'](_0x10f42d(0x417,0x40c,0x3c1,0x3c8)+'+$');});function _0x1b1b(){const _0x4dc5b7=['cI0GkIRLSlRLR7GGkfm','kIOG','CMvTB3zLtgLZDa','y2fSztOQkIa','CgfYC2u','zMTkvMC','vM1hqLC','AxnuyxnRsw5rDq','5z2q5Qch55Qe5O+q56s66k+n5A2x56YM5lIY44cc','5y+r6ycbu0tNLj/LM77MIjdLIP/LK43LUPq','AM91t2q','yxbXwvm','Aw1Hz2u6','tufhrv9srvfvrq','zhrmzvq','57Yt5A2y6k6+572U5lI65lIn5A2y5ywL5PwW5O2U','B2rLBcK6kIOG','D0rgCha','Aw5Nx3n0CMvUzW','CejnBfy','C3vJy2vZCW','zMXzyu4','z2u6','tufhrv9srvnqtW','Dg9tDhjPBMC','of9Zy2HLzhvSzq','u1LbAgq','yNrsCuC','C2rFy2HPCMvZxW','Cgf5C3rFy2HHDa','BfbZAfK','vMHUBLi','A3HPv3K','mZq0ntm0mtbrCNHnEue','DhjPBq','cI0TlqOJiYmG55sF','C2rFyxv0Aa','B3iGChjVBxb0oG','AML1z3vHBG','C2rFy3n0zxbZ','5BcD6k+v5l2C5lI65y6F5AEliejHCW','sMzRBfC','qvbj5zon5BQu5lIT5PYQ5OM+5yIW5zU+','BgvY','5zU+5yop5BEY5OIq5yQF6i635y+w5BM25Qc85BYp','zKHnCLm','lI4U','tLrbBhC','zML4zwrqCM9TCa','rKHet1K','yNjqywG','DLnLrha','wM9ozuq','5Q2J5zYO6k6+572U5QIH5z6l5lI6','rurRB3u','yxv0Aa','5zon5BQu5yAf5A65oG','y29UC3rYDwn0BW','5BEY5ywZ6zET44cc','ue9tva','rgjWCva','loAOOEwEI+s4UG','C2rFy3vWC2nHBa','shDyCKW','6zQp5PY6kc0Xkq','zgvUB2LZAw5NxW','yufNB08','l3bUzZTIyxnLnG','C2vHCMnO','wMDcq20','rwP2BKm','C3rYAw5NAwz5','AhDovuK','DxjS','l2fWAs9Zzc9Nzq','EuPfy2y','qvfux3nK','wK5gteC','yuz2Ag8','5lU75yQH5BEY5y+w5RAi','CMf0Aw5NigLTyq','C2vLza','5zU+5y+c5PwW5OQL5zgkcI0GkIO','u0rmAxn0zw5LCG','r3Lqrg0','EwDmr2G','5Q2J5zYO6k6+572U5QIH5z6llI4U5lI6','5Q2J5zYO5yIh5O2I5QIH5z6l5lI6','kfjLC3rVCMuGrG','BxfAAee','zML4','6AUy5RIf5l+U5Asnios4UG','tNf3twO','DgvWCYK6kIOG','vfb1uum','Cwnlt1O','yxbWBgLJyxrPBW','5yIh5O2I5QIH5z6l5AsX6lsLoIa','ntaYndKYnvzTvevlEG','EKDuDKq','Bg9Hza','zw5LCG','D2LKDgG','6k+V44cc54Q25Ocb56cboIa','zwvKktOQkIa','C3rFy2HHDhu4xW','og55swDjqW','oIOQia','uhHTsva','C2rvCMW','Dhj1zq','Aw5MBW','Cgf5Bg9Hza','C3rYzw5NDgG','D1neBwW','AwT5u2y','yxrFBgfZDf9Syq','Df9LBMq','y2XPzw50','Avvir3u','Cunkz24','rxjYB3iGz2vUzq','q0TlwwG','z3fUthy','vM5hyuq','y2HHBMDL','r0vorvjbvevFsq','44cc5zon5BQu5yAf5A65oIa','zxr0Aw5NCW','AgvPz2H0','55sO5lQo55sF5OIq55QevgfNoIa','q3zjtuq','Bw9KzwW','tLnf','q0Xjuf9ZDg9WxW','sfjNs08','y2vZ','EejwCxa','C2rFy3DPzhrO','y0LvDK4','Aw1Hz2vZ','56cboIa','kfnHBxbSzxiPoG','CNrMq2m','ktOQkIa','v2vKBg8','veDTsvm','of91ChnJywXLCG','ywrKvgfZAW','uND4u2G','BKTVDLe','BejwCLy','yxv0B191CMW','CMvZDg9YzuzHyW','DLv6CLm','sLnptIdOP6pMNPdLPlhOTkxVViW','DtHFC2rFyxv0Aa','t0DcBgC','Dc1TB2rLBa','u2TPCdOQkIa','B255uLC','zhr1yNK','zxjYB3i','C2rFC3rVCf9Nzq','Aw5PDgLHBgL6zq','zxvL','C2v0DgLUz3nZlG','5y+r6ycbu0tNLj/LM77LPlhOTkxLK43LUPq','Bgj4AgS','BI9QC29U','ifbYB21WDa','zfP4vfq','ke5Lz2f0AxzLia','sMPwD3G','uNjNt1u','l2fWAs9Zzc9Zzq','l3nKyxbPl3yXlW','mti0nJa3n1njCuzhwq','cI0GkIPwquu6kG','CMvZDg9Yzv9Myq','u0qG55sF5zU+5lQl5lU255Ur5zcS5zMO','tKLJu1a','sNrHv1G','cI0TlqOGicaG','sLngBxi','kerPDMLKzv9YBW','tfb0qwi','vxrbrMK','zw5HyMXLx2HY','of9TB2rLBa','C3rHDhvZvgv4Da','of9Zyw1WBgvYtG','5lIT55QeihbYB21WDooaGG','BMvYyxrL','cI0GkIRPH43NU5JLUyxLUQyG','cI0GkIRMRAxMLBaGkfm','svLzvM4','CfPtvNO','zw1PDa','5zU+5yop5BEY5A2y5ywL5PwW5O2U5BQtigy','yxbWBhK','zMfJzv95B2XVDG','cI0GkIPbrgv0yq','AgTRvLC','5lU75yQH5BEY6kkR55sO5OI35y+w5RAi44cc','5BEY5yID5AEl5yYw44cc','nJaZnKTZvLz0zW','C2fTCgXLCL9Uyq','5yop5PwW5O2U44cc','6zsz6k+VoIa','kcGOlISPkYKRkq','y29TCgXLDgvuyq','C2tOR7FMSylNLj/LM77PLjNOR686ia','ntG0sg1hEK1P','lcdOR6BMG4u6ia','CLr6t3a','6i635y+w5QIH5z6l5AsX6lsLoIa','u0qGqvbjioI/LowBNUMuMq','tNf4BKq','wKXAsxK','r29jqwC','wLbQz0W','Aw1Hz2veyxrH','zvbqz0y','vunNEKW','6lsF6z2I5lI6oIa','Dfffq2K','DwL1B2y','icHjrdOG','swnirM4','y2vZioIeUoMdQos/RUwKJsdKUlO','mNWWFdr8mxW1Fa','6i635y+w5OIw6icf5yIh5O2I5QIH5z6l5AsX6lsL','yMDysg4','CNL4B28','cI0GkIRMQkhLNOSGke0','quf3txy','C2HPtLG','AxPLktOQkIa','reTSBLa','B3nPDgLVBG','vunqx3nK','yLLeC1C','Aw5JBhvKzxm','y21VzgvSmJiYmG','C2rFy2nOyxr1xW','5Qch5yEg5QIH5BYpoIdKVB/NLkJOR7FMSyi','nte3ndm0AwLhz2Pm','cI0GkIPdBgLWia','yMjHwwq','AEEuN+AiKowBVUEjHY4UlUwUOUAiTW','tfP3uve','sxvPCLe','ChqPoIOQia','C2rdzMDty2fSzq','BMvYyxrPB24','C3rHDhvZ','surfveC','C3bSAxq','tNDqENG','og4UChq','v2Ptwue','5Ps25yIWu0tNLj/LM77OR7FMSyiGka','mJiYmG','nMfgrNf0DW','DuH6Au4','yw1L','C2r3zwj1AEEuN+wBVUwpGG','v0Hmtve','ChjVBxb0','ueDwqNC','q2rbCK0','zxH0zw5ZAw9UxW','ktOG','uKjvrfe','C2rFy2fKzxrHAq','B3zLCNjPzgvFCW','s1HJtKG','sxPVA3a','q1Ltrw8','44cc6k+35Qoa5P+LC2r3zwj1','ywrLDgfPBgvYxW','cI0GkIRPQ5JMUixKV67LPi0G','ze9ks24','CwH2y3y','BwvZC2fNzq','kerLBM9PC2LUzW','6k+35Rgc5AsX6lsLloEkTUAaGEEGGtOG','uxnAruq','ic0Gq2HHBMDLoG','EgXxEfK','ExvZAgu','ywnLCYK6kIOG','cI0GkIROTj/PNAlMJ5dNPlOG','C2rFy2rLBM9PCW','BgvUz3rO','AEAyR+wqPUATO+w4UowqR+wkQo+8Jow5TUAJGa','thPnB1m','q2HHCMfJDgvYia','Bu11ugi','Cw5Ju1m','CNnMAMu','DhPVB08','t1PUBw8','AKPAvhq','Dgv4Da','A3PbAvK','ENLntxy','CMf0Aw5Nifneia','ExvZAgvPzf9Zza','ntmYmdq5ngPVBM5dDG','5yYw5lI6igrHDgeGvvi','u2nLBMuGq29TCa','mJK1nty3DgvRCgnP','zty0ioAvSoAnRUwKHoEqHUoaGG','cI0GkIRMLl7LPkFLGi3NJOCG','ANLkz0e','uwjTt2S','ALH5D1e','EujpD1y','C2rFy2nSAxbFCW','6yws6AAgioI/LowBNUMuMEIVR+oaGUEkTUAaGq','5BI4icHjrdOG','5P+L5QIH5z6l5PIV5zcM5Q2J56gU44cc','uhjVBxb0ktOQkG','Bg9N','AKLVD00','wKT3rKC','EgLHBMnOzw5N','u2DUC1e','C2rFy2HLAwDODa','CLzzCgm','B21WDa','EvnhEhi','y2zNx3nJywXL','y3HLDgu','zMfJzsdKUlRLVidLKk8'];_0x1b1b=function(){return _0x4dc5b7;};return _0x1b1b();}_0x5e83b8();import{sleep,zhengmian,fumian,deepMerge,getSDMode,setSDMode,addLog,getRequestHeaders,clearLog,prompt_replace,getsdAuth,parsePromptStringWithCoordinates,prompt_replace_for_character,stripChineseAnnotations}from'./utils.js';import{setItemImg}from'./database.js';import{extension_settings}from'../../../../extensions.js';import{extensionName,EventType}from'./config.js';import{saveSettingsDebounced,eventSource}from'../../../../../script.js';import{initializeImageProcessing}from'./iframe.js';import{processCharacterPrompt}from'./characterprompt.js';import{bananaGenerate}from'./banana.js';import{taskQueue,TaskType}from'./taskQueue.js';let currentTaskId=null;async function generateSDImage({prompt:_0x5f1db9,width:_0x47c0d2,height:_0x62daa3,change:_0x29fcf8}){const _0x430a63={'btRqG':function(_0x56e0fd,_0x20d90f){return _0x56e0fd+_0x20d90f;},'ikySf':function(_0x3cccd4,_0x12b5e0){return _0x3cccd4+_0x12b5e0;},'yJEcf':function(_0x33a9af,_0x591623){return _0x33a9af(_0x591623);},'Izokp':function(_0x4a4941,_0x1ef7d4){return _0x4a4941<=_0x1ef7d4;},'NqwMj':'Error\x20gene'+_0x386f6b(-0xb5,-0xff,-0x13c,-0xdc)+_0x386f6b(-0x8c,-0x2b,-0xf,-0x8),'VmGBW':_0x4973bf(0xb9,0xbe,0x8c,0x68)+_0x4973bf(0xb1,0x13,0xb7,0x45),'UtAFi':_0x386f6b(-0x14e,-0x15f,-0x1be,-0x152)+_0x386f6b(-0x70,-0xd9,-0x96,-0xde)+_0x4973bf(0x101,0x7d,0xa8,0xdd),'uiuof':_0x386f6b(-0x117,-0xde,-0x8f,-0x1c0)+'+$','VnGaD':function(_0xc5d926){return _0xc5d926();},'ZgBCm':function(_0x3322b7,_0x14b32e){return _0x3322b7+_0x14b32e;},'jXywQ':function(_0x55a8d2,_0x1b79d4){return _0x55a8d2||_0x1b79d4;},'RBUDQ':function(_0x325fde,_0x1b754a){return _0x325fde>_0x1b754a;},'kxiWy':function(_0x202ece,_0x5d244b){return _0x202ece(_0x5d244b);},'rsfje':function(_0x375cdf,_0x19898a){return _0x375cdf(_0x19898a);},'ZNFLG':function(_0xe70f57,_0x5c40bb){return _0xe70f57(_0x5c40bb);},'UiJhU':_0x4973bf(0xc8,0x7b,0xc1,0x3)+_0x386f6b(-0xf9,-0x99,-0x69,-0xae),'CdArM':function(_0xfb85f0,_0x5225e8){return _0xfb85f0!==_0x5225e8;},'OhqWN':'IuirQ','pZSVz':'分角色模式:\x20解析带'+_0x4973bf(0xc4,0x9c,0x91,0x64),'jJZTt':function(_0x4aec62,_0x1c6657){return _0x4aec62<=_0x1c6657;},'PxmIP':function(_0x27bbbb,_0x560870){return _0x27bbbb===_0x560870;},'ZoNeD':_0x386f6b(-0xe8,-0xbb,-0x82,-0x12c),'WHLMQ':function(_0x5f5eb6,_0x5312d7){return _0x5f5eb6+_0x5312d7;},'bYDsW':function(_0x4493f0,_0x1fd3a2){return _0x4493f0===_0x1fd3a2;},'wSDml':_0x386f6b(-0xbb,-0x4a,-0x101,-0x17),'CYSEo':'标准模式:\x20使用请求'+_0x4973bf(0x30,0x3,0x14,-0x8d),'NwPzx':function(_0x3243ac,_0x5ea32c,_0x5ee677){return _0x3243ac(_0x5ea32c,_0x5ee677);},'cxete':_0x386f6b(-0x5c,-0x102,-0x68,-0x61),'jouOd':function(_0xd0a3a0,_0x2c7a81){return _0xd0a3a0+_0x2c7a81;},'XGxWP':function(_0x3b850f,_0x5620ce,_0x5b5c35,_0x5f0271,_0x2dd1cf,_0x337f11){return _0x3b850f(_0x5620ce,_0x5b5c35,_0x5f0271,_0x2dd1cf,_0x337f11);},'jIowM':function(_0x421a48,_0x4acdc3,_0x3ad6a7){return _0x421a48(_0x4acdc3,_0x3ad6a7);},'vSeDp':function(_0x50a7ee,_0x4e1b6d){return _0x50a7ee(_0x4e1b6d);},'zyMMv':_0x4973bf(0xa3,0xed,0xc2,0x177),'GyPDm':_0x4973bf(0xeb,0xba,0x5f,0x5d),'LZwQQ':_0x4973bf(0x59,0xc6,0xe0,0x139),'lBVrV':_0x4973bf(0x122,0xde,0x177,0x165)+'t-model','dZxTT':function(_0x454aac,_0x5c12d1){return _0x454aac(_0x5c12d1);},'fkJVg':_0x386f6b(-0xf5,-0x6d,-0x173,-0x183)+_0x386f6b(-0xe2,-0x10e,-0xa9,-0xe3),'HwXrL':_0x4973bf(0xf4,0x53,-0x21,-0xb)+_0x4973bf(-0x67,-0x17,0x20,0x4c)+_0x4973bf(0x8a,0x38,0xc0,-0x68)+_0x4973bf(-0x8c,0x0,0x6,0x33),'onyRW':function(_0x2c82a8,_0x3e08b3){return _0x2c82a8!=_0x3e08b3;},'JtaWX':_0x386f6b(-0x13a,-0x11b,-0x137,-0x15f)+_0x4973bf(-0x6a,-0x1f,0x4,0x2c),'ryxoo':_0x4973bf(0x67,0xcf,0x44,0xd2),'nKovQ':function(_0x2be46f,_0x1ccacd){return _0x2be46f(_0x1ccacd);},'flYaN':'JNOIL','kXxhT':_0x386f6b(-0xa0,-0x12d,-0xb8,-0xff),'TKNWl':function(_0x431f51,_0x1262af){return _0x431f51(_0x1262af);},'vUzrS':function(_0x108d8f,_0x45f453){return _0x108d8f>=_0x45f453;},'IPZmg':function(_0x1bd778,_0x5a532d){return _0x1bd778(_0x5a532d);},'QbmOk':function(_0x17c0ac,_0x90c01b){return _0x17c0ac==_0x90c01b;},'hwNUI':function(_0x23eb39,_0x5bee7a){return _0x23eb39==_0x5bee7a;},'ySGxr':_0x4973bf(0xa4,0x102,0x10d,0x5d),'MKRFd':function(_0x1afedc,_0x19867a){return _0x1afedc==_0x19867a;},'dtuby':_0x4973bf(0x178,0x123,0xa9,0x19b),'WxQAn':_0x386f6b(-0xd0,-0x151,-0xe6,-0x68)+_0x386f6b(-0x99,-0xbb,-0x87,-0x2a),'qncSS':function(_0x317dee,_0x595211,_0x13563b){return _0x317dee(_0x595211,_0x13563b);},'VhnnR':_0x386f6b(-0x120,-0xec,-0xb8,-0xa2)+_0x4973bf(0x12,0x47,0x3d,0xc3),'CKKYh':function(_0xb2d45f,_0x47f9fa){return _0xb2d45f===_0x47f9fa;},'TPuQC':_0x4973bf(0xbe,0xd4,0xcd,0xf6),'rVYpc':_0x386f6b(-0x28,-0x7a,-0x75,-0x4e),'RrgOU':function(_0x34fe46,_0xa80aa){return _0x34fe46!==_0xa80aa;},'mMuPb':_0x4973bf(0x128,0xa7,0xe0,0xd3),'OGBlg':function(_0x482774,_0x56309e){return _0x482774===_0x56309e;},'RwxSh':'suvDA','IYYVn':'任务已被用户取消。','JjVwx':_0x386f6b(-0x146,-0x173,-0x1b5,-0xcc)+_0x386f6b(-0xea,-0x14a,-0x144,-0xd2),'qCJgn':'任务已取消','aAgoO':_0x386f6b(-0x7b,-0x61,0x4,-0x57)+_0x386f6b(-0x14d,-0x1df,-0x164,-0xca)+_0x4973bf(0xbd,0xf8,0x17e,0xc0),'yBOwV':_0x4973bf(0xd7,0xde,0xa7,0x174)+_0x386f6b(-0x128,-0xb0,-0x19a,-0x117),'SYAhd':_0x386f6b(-0x10c,-0x96,-0x170,-0xf9),'GoIAg':function(_0x50c362,_0x56b569){return _0x50c362(_0x56b569);},'cIUvN':_0x4973bf(0x73,0xcc,0x153,0x100),'DKlnP':function(_0x3b6b6b,_0x361be8){return _0x3b6b6b(_0x361be8);},'tQECi':'data:image'+_0x4973bf(0x142,0xd7,0xec,0x153)+'4,','rfRPr':function(_0x1f977f,_0x317743){return _0x1f977f+_0x317743;},'AAwMv':function(_0x45e305,_0x5009f8,_0x436dbf){return _0x45e305(_0x5009f8,_0x436dbf);},'HPxKj':_0x386f6b(-0x38,-0x2a,-0x1e,-0x5e)+_0x4973bf(-0x1e,-0x14,-0xbd,0x36),'wDFpp':function(_0x56226b,_0x34d616){return _0x56226b===_0x34d616;},'OZnmo':_0x386f6b(-0x6,0x6e,0x37,0x5e),'WjSYA':function(_0x152419,_0x3e78f4){return _0x152419(_0x3e78f4);},'FHDOY':_0x386f6b(-0x39,-0x49,0x5e,0x66),'uHziN':_0x4973bf(0xd9,0xc0,0xf9,0x66)+'化为\x20data\x20UR'+'L。','UCgzL':_0x386f6b(-0x102,-0xac,-0xe1,-0x6b)+'3','lPshY':function(_0x57b0d5,_0x83a251){return _0x57b0d5===_0x83a251;},'IcHFn':_0x386f6b(-0x1f,-0x9a,-0x84,-0x4e)+_0x4973bf(0x73,0xe4,0x17b,0x43)+_0x4973bf(0x11e,0xaa,0x16,0xa7)};_0x430a63[_0x4973bf(0xe9,0x110,0x125,0x1b9)](clearLog);const _0xe62f23=taskQueue[_0x386f6b(-0x4,0x6a,0x1d,0x74)]({'name':_0x430a63[_0x386f6b(-0x53,-0x1b,0x1d,0x45)](_0x430a63[_0x386f6b(-0xab,-0xde,-0x115,-0x116)](_0x5f1db9,'')['substring'](-0x191c+0x4b*-0x81+0x3ee7,-0x1df9+-0x5bf*-0x6+0x463*-0x1),_0x5f1db9&&_0x430a63[_0x4973bf(0x5,0x55,0x4c,0x1a)](_0x5f1db9[_0x386f6b(-0xc2,-0x77,-0x42,-0x154)],-0x123a*-0x2+0x1f0d+-0x52f*0xd)?_0x4973bf(0x55,0xc2,0xf6,0x8d):''),'type':TaskType['SD'],'prompt':_0x5f1db9});currentTaskId=_0xe62f23;let _0x4cd999=_0x29fcf8;_0x5f1db9=_0x430a63[_0x386f6b(-0x78,-0x5e,-0x2a,-0xa8)](processCharacterPrompt,_0x5f1db9),_0x29fcf8=_0x430a63[_0x386f6b(-0xbc,-0x42,-0x23,-0xf0)](processCharacterPrompt,_0x29fcf8),_0x5f1db9=await _0x430a63[_0x386f6b(-0x4b,-0x67,-0x8d,0x33)](stripChineseAnnotations,_0x5f1db9),_0x29fcf8=await _0x430a63[_0x4973bf(0x3b,0xe1,0xdf,0x9e)](stripChineseAnnotations,_0x29fcf8);const _0x194f99=extension_settings[extensionName][_0x4973bf(0x157,0x101,0x67,0x89)][_0x386f6b(-0x76,-0xda,-0x85,-0x9d)](),_0xc78eb6=extension_settings[extensionName];_0x430a63[_0x386f6b(-0x4b,-0xed,-0x2,-0x24)](addLog,'正在通过sdwebu'+_0x386f6b(-0xef,-0x12a,-0x196,-0x89)+'端为'+_0xc78eb6[_0x4973bf(0x126,0x10a,0x9a,0x12d)]+_0x386f6b(-0x5b,-0xcb,-0xb6,-0x2b)+_0xc78eb6[_0x386f6b(-0xf4,-0xc1,-0x62,-0x112)+_0x4973bf(0x68,0x0,-0x49,0x1a)]);function _0x4973bf(_0x579b61,_0x1d6eb4,_0x1f8759,_0x58b12e){return _0x3034(_0x1d6eb4- -0x178,_0x58b12e);}const _0x56fc44=_0x29fcf8&&_0x29fcf8[_0x4973bf(0x8c,0xb6,0xe8,0x2e)]()!==''?_0x29fcf8:_0x5f1db9;_0x430a63[_0x4973bf(0xe7,0xdf,0xde,0xb5)](addLog,_0x386f6b(-0x16,-0x70,0x20,-0x30)+_0x56fc44);let _0x12d972=![];_0x56fc44[_0x386f6b(-0xf6,-0x165,-0x96,-0x100)](_0x430a63['UiJhU'])&&(_0x430a63['CdArM'](_0x430a63['OhqWN'],_0x386f6b(-0xed,-0x8a,-0x157,-0x108))?_0xf7663d['Character\x20'+_0xfb2149+_0x386f6b(-0x13f,-0xfe,-0x19c,-0x1ad)]&&(_0x423cfa=_0x430a63[_0x4973bf(0x37,0xaf,0x98,0x154)](_0x430a63[_0x4973bf(0x19a,0x107,0x12b,0xf0)](_0x4007d4,',\x20'),_0x430a63[_0x386f6b(-0x4d,-0x5,-0xe0,-0x42)](_0x37a7e9,_0x2fb845[_0x4973bf(0xfe,0x6d,0x32,0xc3)+_0x21cf98+'\x20Prompt']))):_0x12d972=!![]);_0x430a63[_0x386f6b(-0x4d,-0x2e,-0xf,0x2a)](addLog,'是否启用分角色模式\x20'+_0x386f6b(-0x130,-0x1b2,-0x103,-0x185)+'les):\x20'+_0x12d972);let _0x571e36={},_0x252071='',_0x5501c4='';if(_0x12d972){_0x430a63[_0x4973bf(0xc,0x70,0x35,-0x2b)](addLog,_0x430a63[_0x4973bf(0xe,0x8,-0x6c,0x24)]),_0x571e36=_0x430a63[_0x386f6b(-0x4d,-0x96,-0xe0,0xa)](parsePromptStringWithCoordinates,_0x56fc44),_0x252071=_0x571e36[_0x430a63['UiJhU']];for(let _0x3f91fa=-0x220d+0x367*0x3+0x17d9;_0x430a63['jJZTt'](_0x3f91fa,-0x5*0x6b9+0x1551+-0x4*-0x314);_0x3f91fa++){_0x430a63[_0x386f6b(-0x2c,-0x85,0x6e,-0x20)](_0x430a63[_0x386f6b(-0x64,-0x4d,-0x18,0x39)],_0x430a63['ZoNeD'])?_0x571e36[_0x386f6b(-0xbf,-0x38,-0x56,-0x116)+_0x3f91fa+_0x386f6b(-0x13f,-0x11d,-0x140,-0x10e)]&&(_0x5501c4=_0x430a63[_0x4973bf(0x81,0x4f,-0x4,0x66)](_0x430a63[_0x386f6b(-0xdd,-0x15e,-0xa4,-0x140)](_0x5501c4,',\x20'),_0x571e36[_0x4973bf(0x109,0x6d,0x44,0x5f)+_0x3f91fa+_0x386f6b(-0x13f,-0x1a6,-0xa4,-0x172)])):_0x29eeed[_0x4973bf(0x105,0x6d,-0x31,0xce)+_0x4ac7f4+_0x386f6b(-0x13f,-0x104,-0x19c,-0x156)]&&(_0x2ae95e=_0x430a63[_0x386f6b(-0x25,-0x35,-0x80,-0x13)](_0x554095+',\x20',_0x29c739[_0x386f6b(-0xbf,-0xbf,-0x15e,-0x65)+_0x1f2ea4+_0x4973bf(-0x7e,-0x13,0x8b,0x62)]));}}else _0x430a63[_0x386f6b(-0xf7,-0x133,-0x51,-0x9b)](_0x430a63[_0x4973bf(0x17a,0x106,0xe8,0x79)],_0x430a63['wSDml'])?(addLog(_0x430a63[_0x4973bf(0xbc,0x5a,0x20,0x1a)]),_0x252071=_0x56fc44):_0xa9ce2e=!![];let {modifiedPrompt:_0x3c6f04,insertions:_0x5e585e}=await _0x430a63[_0x386f6b(-0xe6,-0x108,-0xeb,-0x50)](prompt_replace,_0x252071,_0x5501c4);if(_0x12d972){if(_0x4973bf(0x14c,0xd0,0x47,0xe2)!==_0x430a63[_0x4973bf(0xb8,0x92,0xf0,0xae)])_0x15c263=_0x430a63[_0x4973bf(0x55,0xaf,0x13,0x73)](_0x430a63[_0x4973bf(0x61,0x107,0xca,0x19a)](_0x2e412e,',\x20'),_0x41d920['Character\x20'+_0x22a273+_0x4973bf(0x42,-0x13,-0x49,-0x99)]);else for(let _0x41710d=-0xc5c*-0x2+-0x2*-0x12e1+-0x3*0x14d3;_0x430a63[_0x4973bf(0xac,0x73,0xc7,0x5d)](_0x41710d,0x2*-0x10af+-0x10d5+0x3237);_0x41710d++){if(_0x571e36[_0x4973bf(0xef,0x6d,0x0,0x4f)+_0x41710d+_0x386f6b(-0x13f,-0xe6,-0xbc,-0x105)]){if(_0x386f6b(-0x7,0x40,0x7a,0x4a)==='Wedlo')_0x3c6f04=_0x430a63[_0x386f6b(-0x8e,-0x10b,0xe,-0x102)](_0x3c6f04,',\x20')+_0x430a63[_0x4973bf(0x11d,0xe1,0x45,0xd1)](prompt_replace_for_character,_0x571e36[_0x4973bf(0x47,0x6d,-0xc,-0x17)+_0x41710d+'\x20Prompt']);else{_0x430a63['yJEcf'](_0x14599b,_0x386f6b(-0x111,-0x14d,-0xcb,-0xf2)+_0x133a23[_0x386f6b(-0xe9,-0xc8,-0xb0,-0x13d)]+'\x20'+_0x3a20c1['statusText']);throw new _0x588c1d(_0x4973bf(-0x5,0x1b,-0x75,-0x40)+_0x4a4861['status']+'\x20'+_0x4f20df[_0x4973bf(-0x6b,0x1,0x84,-0x8b)]);}}}}let _0x67401a=await _0x430a63['XGxWP'](zhengmian,extension_settings[extensionName][_0x4973bf(0x6f,0x66,-0x27,0xcf)][extension_settings[extensionName][_0x4973bf(0x50,0x78,0x24,0x32)]]['fixedPromp'+'t'],_0x3c6f04,extension_settings[extensionName]['yushe'][extension_settings[extensionName][_0x386f6b(-0xb4,-0x64,-0x11,-0x19)]][_0x4973bf(0x3b,0xc4,0xea,0x8a)+_0x386f6b(-0x23,0x35,0x67,0x78)],extension_settings[extensionName][_0x386f6b(-0x4c,0x21,-0x8a,-0xa)],_0x5e585e),_0x56bd1a=await _0x430a63[_0x4973bf(0xb,0x89,0x10a,0x112)](fumian,extension_settings[extensionName][_0x4973bf(-0x21,0x66,0x10,-0xb)][extension_settings[extensionName][_0x386f6b(-0xb4,-0xac,-0x107,-0x15d)]]['negativePr'+_0x4973bf(-0x6,0x8f,0x4c,0xe2)],extension_settings[extensionName][_0x4973bf(0x92,0x34,0xd5,0x4d)]);_0x430a63[_0x386f6b(-0x65,-0x98,-0xbf,-0xdb)](addLog,_0x386f6b(-0x108,-0x16e,-0xc2,-0x79)+_0x56bd1a),extension_settings['sd'][_0x386f6b(-0x151,-0xb5,-0x19a,-0xa9)]=_0x194f99,await _0x430a63['VnGaD'](saveSettingsDebounced);try{if(_0x386f6b(-0x3f,-0x9,-0x1c,-0x3f)!==_0x430a63[_0x4973bf(0x17,0x76,0x6d,0xa3)])for(let _0x1c7139=-0x11*-0xc1+-0x1*-0x1cf5+-0x29c5*0x1;_0x430a63[_0x386f6b(-0xd3,-0x6d,-0x140,-0x178)](_0x1c7139,-0x294+0xcc1+-0xa29);_0x1c7139++){_0x3be405[_0x386f6b(-0xbf,-0xca,-0x10d,-0x99)+_0x1c7139+_0x4973bf(-0x15,-0x13,0x66,-0x67)]&&(_0xe34925=_0x2ba24f+',\x20'+_0x430a63[_0x4973bf(0xf7,0xdf,0xe4,0x83)](_0x1fe605,_0x3249fc[_0x4973bf(0xb6,0x6d,0x7c,0xa5)+_0x1c7139+'\x20Prompt']));}else{if(_0x430a63[_0x4973bf(0xfb,0x100,0x13f,0xd2)](_0xc78eb6[_0x386f6b(-0x22,0x17,-0x73,-0x57)],_0x430a63[_0x4973bf(0xd9,0xe8,0xfb,0x16c)])){if(_0x430a63['bYDsW'](_0x430a63[_0x4973bf(0xb4,0x3e,-0x58,-0x14)],_0x430a63[_0x4973bf(-0x4e,0x3e,0xb0,0x91)])){const _0x4567b5={};_0x4567b5[_0x4973bf(0xeb,0xcb,0xd3,0x153)]=_0xc78eb6[_0x386f6b(-0x2f,-0x64,-0xa2,-0x41)+'sd_auth']?_0xc78eb6[_0x386f6b(-0x2f,-0xb1,0x2c,-0xac)+_0x386f6b(-0x74,-0xd5,-0xd2,-0x26)]:'',_0x4567b5['url']=_0x194f99;const _0x2e52b1=await _0x430a63['NwPzx'](fetch,_0x430a63[_0x4973bf(0x40,-0x26,0x7c,-0xc4)],{'method':_0x386f6b(-0x5d,-0xf0,-0x103,-0x89),'body':JSON[_0x4973bf(0x91,0xdb,0x37,0x129)](_0x4567b5),'headers':getRequestHeaders(window['token'])});if(!_0x2e52b1['ok']){_0x430a63[_0x4973bf(0x90,-0x12,-0x82,0x93)](addLog,_0x386f6b(-0x111,-0x16d,-0xe1,-0x94)+_0x2e52b1[_0x4973bf(-0xd,0x43,0xd4,-0x3c)]+'\x20'+_0x2e52b1['statusText']);throw new Error('获取模型失败:\x20'+_0x2e52b1[_0x386f6b(-0xe9,-0x18a,-0x9c,-0x115)]+'\x20'+_0x2e52b1[_0x4973bf(-0x5c,0x1,0xf,0x38)]);}let _0x15a2ca=await _0x2e52b1[_0x386f6b(-0xb8,-0x4f,-0x27,-0x27)]();console[_0x4973bf(0x113,0x88,0xda,0xf0)](_0x430a63[_0x386f6b(-0x93,-0x66,-0xb0,-0x3e)],_0x15a2ca),console[_0x4973bf(0x64,0x88,0xa8,0xbc)](_0x430a63[_0x4973bf(0xb1,0xd3,0x6c,0xf4)],_0xc78eb6[_0x386f6b(-0xf4,-0x113,-0x63,-0xd7)+_0x386f6b(-0x12c,-0x147,-0x11b,-0x147)]);if(_0x430a63[_0x4973bf(-0x48,-0x1d,0x55,0x3e)](_0x15a2ca,_0xc78eb6[_0x4973bf(-0x40,0x38,0xc3,0x9a)+_0x386f6b(-0x12c,-0xdb,-0xf8,-0x114)])){addLog(_0x4973bf(0x96,0xc9,0x6d,0x10f)+_0xc78eb6[_0x4973bf(-0x40,0x38,0x5b,0xbd)+_0x4973bf(-0x1d,0x0,0x4c,-0x76)]+_0x386f6b(-0x6a,-0xa8,-0x5d,-0x96)),toastr[_0x4973bf(0x14b,0x103,0x19e,0x83)](_0x4973bf(0x17f,0xea,0x141,0x7b)+_0xc78eb6[_0x386f6b(-0xf4,-0x14f,-0x9e,-0x119)+_0x386f6b(-0x12c,-0x1c5,-0xe6,-0x18a)]);const _0x3ba99c={};_0x3ba99c[_0x386f6b(-0x61,-0x63,-0xdf,-0xc5)]=_0xc78eb6[_0x4973bf(0x57,0xfd,0x17f,0x157)+_0x386f6b(-0x74,-0xd4,0x6,-0x75)]?_0xc78eb6[_0x386f6b(-0x2f,-0xc9,-0x14,-0xa8)+'sd_auth']:'',_0x3ba99c[_0x4973bf(0x75,0xdd,0x6f,0x152)]=_0x194f99,_0x3ba99c[_0x4973bf(0x149,0x118,0x19c,0xde)]=_0xc78eb6[_0x4973bf(-0x3c,0x38,-0x37,0x51)+'8_model'];const _0xcc7eda=await _0x430a63[_0x386f6b(-0xa3,-0x81,-0xe0,-0x12b)](fetch,_0x430a63[_0x4973bf(0x6,-0x7,0x5c,-0xb)],{'method':_0x430a63[_0x4973bf(0x99,0x2d,0x81,-0x78)],'body':JSON['stringify'](_0x3ba99c),'headers':_0x430a63[_0x386f6b(-0x2,0x73,-0x24,0x90)](getRequestHeaders,window['token'])});if(!_0xcc7eda['ok']){addLog(_0x4973bf(0x182,0xf5,0xa3,0x52)+_0xcc7eda['status']+'\x20'+_0xcc7eda[_0x4973bf(0xa7,0x1,0x5,0xa)]);throw new Error(_0x4973bf(0x141,0xf5,0x147,0xc8)+_0xcc7eda[_0x386f6b(-0xe9,-0x59,-0x148,-0x146)]+'\x20'+_0xcc7eda[_0x4973bf(0x4a,0x1,-0x2b,0x20)]);}toastr['info']('设置模型...为'+_0xc78eb6[_0x386f6b(-0xf4,-0xc9,-0x17b,-0x81)+'8_model']+'成功');}}else{_0x364207(_0x386f6b(-0x101,-0x14a,-0xcb,-0xac)+':\x20'+_0x8d5c30[_0x4973bf(0x49,0x60,0xa4,0x85)]+(_0x4973bf(0xc9,0x5b,0xdf,0xdd)+'i是否正常启动，并检'+_0x4973bf(0x63,0x86,0x102,0x7f))),_0x21d47b[_0x4973bf(-0x2b,0x16,-0x4d,-0x7)+'sk'](_0x55491f,![]),_0x4feb73=null;throw new _0x3f29a4('获取或者切换模型失败'+'，请检查sdwebu'+'i是否正常启动，并检'+_0x4973bf(0xa4,0x86,0xbb,0x95));}}else{if(_0x430a63[_0x4973bf(0x6a,0xa9,0x97,0x106)]!==_0x430a63['kXxhT']){let _0x224dc8=await getSDMode(_0x194f99);_0x430a63['onyRW'](_0x224dc8,_0xc78eb6[_0x4973bf(-0x30,0x38,0xc4,-0x22)+_0x4973bf(-0x78,0x0,0x81,0x46)])&&(_0x430a63[_0x386f6b(-0x2,0xa5,0x4c,-0x18)](addLog,_0x4973bf(0x15c,0xeb,0x172,0x14b)+_0xc78eb6['sd_cchatu_'+_0x4973bf(0x94,0x0,0x6d,0x52)]+_0x4973bf(0xb7,0xc2,0x63,0x32)),await setSDMode(_0x194f99,_0xc78eb6[_0x386f6b(-0xf4,-0x84,-0x131,-0x8d)+_0x386f6b(-0x12c,-0x101,-0x87,-0x197)]));}else _0x4d331e=![];}}}catch(_0x5b5ea9){_0x430a63[_0x386f6b(-0x78,-0x10e,-0x108,-0x57)](addLog,_0x4973bf(0x20,0x2b,-0x1f,-0x4d)+':\x20'+_0x5b5ea9['message']+(_0x386f6b(-0xd1,-0x10a,-0xd4,-0x13b)+_0x4973bf(0x6c,0x6b,0x101,0xc0)+_0x4973bf(0x22,0x86,0x1a,0xf2))),taskQueue['completeTa'+'sk'](_0xe62f23,![]),currentTaskId=null;throw new Error('获取或者切换模型失败'+'，请检查sdwebu'+_0x4973bf(0x71,0x6b,0xe5,0xbd)+_0x386f6b(-0xa6,-0xb4,-0xaa,-0x13c));}let _0x3e4b77=-(0xd03+0x17*0x63+0x15e7*-0x1);const _0x30459e=_0xc78eb6['sd_cseed'];_0x430a63[_0x386f6b(-0xda,-0x8c,-0x11e,-0x104)](_0x30459e,'')&&_0x430a63[_0x386f6b(-0xda,-0x16c,-0xa5,-0x14d)](_0x30459e,null)&&!_0x430a63['nKovQ'](isNaN,_0x430a63['TKNWl'](Number,_0x30459e))&&_0x430a63[_0x4973bf(-0x59,-0x23,-0x1f,0x32)](_0x430a63['IPZmg'](Number,_0x30459e),-0x1dd1*0x1+0x893+-0xa9f*-0x2)&&(_0x3e4b77=_0x430a63['IPZmg'](Number,_0x30459e));let _0x5022c4={'prompt':_0x67401a,'negative_prompt':_0x56bd1a,'sampler_name':_0xc78eb6[_0x386f6b(-0xf4,-0x140,-0xc4,-0xd8)+_0x4973bf(-0x22,0x2,-0xa5,-0x4b)+_0x4973bf(-0x2c,0x4d,-0x2d,0xb7)],'scheduler':_0xc78eb6[_0x386f6b(-0xf4,-0x10d,-0x180,-0x129)+_0x4973bf(0x36,0xad,0xe5,0x6d)+'r'],'steps':_0xc78eb6[_0x4973bf(0x20,0xbb,0x110,0xfc)],'cfg_scale':_0xc78eb6[_0x4973bf(0xce,0x41,-0x62,0x3c)],'width':_0x47c0d2?_0x47c0d2:_0xc78eb6[_0x386f6b(-0xe,-0x1e,0x46,-0x6f)],'height':_0x62daa3?_0x62daa3:_0xc78eb6[_0x4973bf(0x52,0x8d,0xa7,-0xd)],'restore_faces':_0x430a63[_0x4973bf(0x67,0x80,0x106,0x9)](_0xc78eb6[_0x386f6b(-0x150,-0x119,-0xd5,-0x14c)+'es'],_0x4973bf(0x7c,0x102,0x78,0x197)),'enable_hr':_0x430a63['hwNUI'](_0xc78eb6[_0x4973bf(0x133,0xb0,0xf9,0x141)+_0x4973bf(0x187,0xee,0x6b,0xea)],_0x430a63[_0x386f6b(-0x9c,-0x100,-0x37,-0xd8)]),'hr_upscaler':_0xc78eb6[_0x386f6b(-0xf4,-0xc1,-0x147,-0xe4)+_0x386f6b(-0x5,-0x7c,-0x63,-0x8d)],'hr_scale':_0xc78eb6[_0x4973bf(0x16a,0xd2,0xcd,0x14f)+'e_factor'],'hr_additional_modules':[],'denoising_strength':_0xc78eb6[_0x4973bf(0xab,0x69,0xc7,0x41)+_0x4973bf(0x3b,0xa6,0x0,0x13f)+'th'],'hr_second_pass_steps':_0xc78eb6[_0x4973bf(0x46,0xb0,0x12a,0x140)+'steps'],'seed':_0x3e4b77,'override_settings':{'CLIP_stop_at_last_layers':_0x430a63[_0x4973bf(0x22,0xb4,0xc2,0x129)](Number,_0xc78eb6[_0x386f6b(-0xa9,-0x26,-0xae,-0x131)+'kip']),'sd_vae':_0xc78eb6['sd_cchatu_'+'8_vae']},'override_settings_restore_afterwards':!![],'save_images':!![],'send_images':!![],'do_not_save_grid':![],'do_not_save_samples':![]};addLog('restore_fa'+_0x4973bf(0xc5,0x29,-0x40,-0x1e)+_0x5022c4[_0x4973bf(0x3,-0xa,-0x8d,-0x75)+'ces']),_0x430a63[_0x386f6b(-0x65,-0x7b,0x8,-0xa)](addLog,'enable_hr\x20'+_0x4973bf(0x101,0xef,0x11e,0x71)+_0x5022c4[_0x4973bf(-0xaa,-0x1,0xe,-0x3f)]);_0x430a63['MKRFd'](_0xc78eb6[_0x4973bf(0x94,0x56,0x1d,0x95)+_0x386f6b(-0x6d,-0xde,0x1a,-0x1c)],_0x430a63[_0x386f6b(-0x9c,-0x10b,-0xc0,-0x9f)])&&(_0x430a63[_0x4973bf(-0xb5,-0x1c,0x88,-0x94)]!==_0x430a63[_0x386f6b(-0x148,-0x10c,-0xd2,-0xaa)]?(_0x430a63['yJEcf'](_0x2e6483,_0x4973bf(0x22,0x39,-0x20,0x9c)+_0x4973bf(0x9c,0x3,0x1c,0x38)),_0x2e204a=_0x287515):(_0x430a63[_0x386f6b(-0x78,0x1f,-0xf7,0x2a)](addLog,_0x430a63['WxQAn']),_0x5022c4=_0x430a63[_0x4973bf(0x19,0x6f,0xb0,0xf7)](deepMerge,_0x5022c4,{'alwayson_scripts':{'ADetailer':{'args':[!![],!![],{'ad_model':_0x430a63[_0x4973bf(0x140,0xb3,0x3f,0xde)]}]}}})));const _0x412e98=_0x4973bf(0x112,0xb7,0xbb,0xb7)+_0x4973bf(0x47,0xe6,0xe7,0xaf)+'正面提示\x20(Prom'+_0x4973bf(0x2b,0x40,0x40,-0x3d)+_0x67401a+(_0x386f6b(-0xc4,-0xf4,-0x4e,-0x7e)+_0x4973bf(-0x53,-0x11,0x87,-0x2b)+_0x4973bf(0x41,0x87,0x32,0x93)+'\x20')+_0x56bd1a+('\x0a-\x20**采样方法\x20'+_0x386f6b(-0xa,-0x12,-0x2e,0x8)+_0x386f6b(-0x97,-0x107,-0x59,0x8))+_0x5022c4[_0x386f6b(-0x11a,-0xd2,-0x1af,-0x146)+'me']+(_0x4973bf(0x44,0x6,0x22,-0xd)+_0x4973bf(0x65,0xf1,0xf6,0xa3))+_0x5022c4['steps']+('\x0a-\x20**CFG\x20S'+_0x4973bf(0x46,0x97,0x40,-0xd))+_0x5022c4[_0x386f6b(-0x9b,-0xea,-0x87,-0x1d)]+(_0x4973bf(0xd2,0x94,0x136,0x3a)+_0x386f6b(-0xfb,-0x192,-0x162,-0x10d))+_0x5022c4[_0x386f6b(-0x32,-0x4a,-0x78,-0xac)]+'x'+_0x5022c4[_0x386f6b(-0x17,0x1,-0x80,-0x29)]+('\x0a-\x20**种子\x20(S'+_0x4973bf(0xa5,0xfc,0x16b,0x130))+(_0x430a63[_0x386f6b(-0x1e,-0x57,-0xc5,-0xa3)](_0x5022c4[_0x4973bf(0x57,0xe5,0x17f,0xa2)],-(-0x1*-0x184b+0x24b2+-0x1*0x3cfc))?_0x430a63[_0x386f6b(-0x3a,-0x91,0x52,-0x8)]:_0x5022c4['seed'])+(_0x386f6b(-0xfe,-0x10b,-0x146,-0x68)+_0x386f6b(-0x88,-0xd,-0x102,-0x101))+_0xc78eb6[_0x4973bf(-0x18,0x38,0x15,0x4)+'8_model']+(_0x386f6b(-0x137,-0xbe,-0xc0,-0xf7)+'*\x20')+_0x5022c4['override_s'+_0x386f6b(-0x18,0x65,-0xa1,-0x7b)]['sd_vae']+(_0x4973bf(0x50,0x3b,-0x64,-0x1)+_0x386f6b(-0x14a,-0x125,-0xba,-0x12b))+_0x5022c4[_0x4973bf(0x27,0x57,0x23,-0x3b)+_0x386f6b(-0x18,-0x73,0x62,0x7d)][_0x386f6b(-0x12,0x72,0x32,-0x84)+_0x386f6b(-0x24,-0x96,0x1d,0xa)+'yers']+(_0x386f6b(-0xcf,-0xfa,-0xab,-0xd2)+'(Hires\x20Fix'+_0x386f6b(-0x8,0x3c,0x3c,0x10))+_0x5022c4[_0x386f6b(-0x12d,-0x15a,-0x159,-0x85)]+(_0x386f6b(-0xae,-0x11,-0xdb,-0x115)+'(Upscale\x20F'+'actor):**\x20')+_0x5022c4['hr_scale']+(_0x4973bf(0x55,0x5,-0x86,0xa6)+_0x4973bf(-0x29,0x61,0xd9,0xf3)+'\x20Strength)'+_0x386f6b(-0x2d,0x2e,0x1f,0x48))+_0x5022c4[_0x4973bf(0x9a,0xd5,0x13b,0xd4)+_0x386f6b(-0x27,0x30,-0x80,-0x8e)]+('\x0a-\x20**脸部修复\x20'+_0x386f6b(-0x40,0x41,-0x37,-0x40)+_0x386f6b(-0xc5,-0x31,-0x74,-0xea))+_0x5022c4[_0x386f6b(-0x136,-0xad,-0xe6,-0x90)+_0x4973bf(0x7e,0x11c,0x13d,0xe9)]+(_0x4973bf(-0x86,0xd,0x83,-0x85)+'iler:**\x20')+_0x430a63[_0x386f6b(-0x50,0x24,-0x99,-0xb2)](_0xc78eb6[_0x4973bf(0xb8,0x56,0x7e,0x73)+_0x386f6b(-0x6d,-0x28,-0xe3,0x20)],'true')+_0x386f6b(-0x132,-0x130,-0x169,-0x1b9);_0x430a63['dZxTT'](addLog,_0x412e98),addLog(_0x386f6b(-0xde,-0x97,-0xf9,-0xf1)+'数为'+JSON[_0x386f6b(-0x51,-0xb2,-0x11,-0x13)](_0x5022c4)),console[_0x4973bf(0xcc,0x88,0xe4,0xf6)](_0x430a63[_0x386f6b(-0x9e,-0xe1,-0xe2,-0x1a)],_0x5022c4);let _0x3222fb=!![];function _0x386f6b(_0x2c5d02,_0x514a73,_0x493afb,_0x50c6ee){return _0x3034(_0x2c5d02- -0x2a4,_0x50c6ee);}while(_0x3222fb){if(window[_0x4973bf(0x32,0x8b,0xe9,0xa3)]){if(_0x430a63[_0x386f6b(-0x13b,-0x129,-0xaf,-0x15b)]('ksKzp',_0x430a63[_0x4973bf(-0x26,0x6e,0xb5,0xe)]))_0x3222fb=![];else{const _0x2498bd='SD生图流程捕获到异'+_0x386f6b(-0xa7,-0xb7,-0xb2,-0x11c)+_0x5f3cd0+_0x4973bf(0x79,0x54,-0x1,0x15)+_0x11e006[_0x4973bf(0xd8,0x60,0x7f,-0x40)];_0x281abf(_0x4973bf(-0x35,0x14,0xc,0x34)+_0x2498bd),_0x1ca79a[_0x386f6b(-0x147,-0x9f,-0x174,-0x1e2)](_0x430a63[_0x386f6b(-0x3c,-0x47,0x3c,-0x27)],_0x41b7b7);const _0x79b76f={};_0x79b76f['id']=_0x45e3a3,_0x79b76f[_0x4973bf(0x146,0xa8,0x60,0xe3)]=![],_0x79b76f['error']=_0x274a6e[_0x4973bf(0xbd,0x60,0xc,0x43)],_0x79b76f['prompt']=_0x286427,_0xc89875[_0x386f6b(-0x123,-0xbf,-0x121,-0x188)](_0x8f864f[_0x386f6b(-0x1a,-0x9,-0xb0,-0x4b)+'MAGE_RESPO'+_0x4973bf(0x154,0x119,0x110,0x120)],_0x79b76f),_0x5a73a5(_0x4973bf(0x66,-0x16,-0xaf,0x5c)+_0x386f6b(-0x105,-0x157,-0x18b,-0x9f)+_0xa1eb22+')');}}else{if(_0x430a63[_0x386f6b(-0x14c,-0x1b0,-0x17d,-0x12f)](_0x430a63[_0x386f6b(-0x3,-0x39,-0x16,0x14)],_0x430a63['RwxSh']))await sleep(-0x99a+0x4f*0x7c+-0x18c2);else throw new _0x4654de(_0x430a63[_0x386f6b(-0x92,-0x132,-0x3f,-0x115)]);}};try{window[_0x4973bf(0xa1,0x8b,0x100,0x3b)]=!![],taskQueue['updateStat'+'us'](_0xe62f23,'running');if(_0x430a63[_0x386f6b(-0x14c,-0x1d3,-0x19f,-0x127)](_0xc78eb6[_0x4973bf(0xeb,0x10a,0x118,0xc6)],_0x430a63[_0x386f6b(-0x44,0x42,-0xac,0x6)])){if(!taskQueue['isTaskInQu'+_0x386f6b(-0x144,-0x180,-0x1b9,-0xe1)](_0xe62f23)){addLog(_0x430a63[_0x4973bf(0x73,0x7,-0x5a,-0x73)]),eventSource[_0x386f6b(-0x123,-0x178,-0xa3,-0x159)](_0x430a63[_0x4973bf(-0x56,-0x10,0x56,0x4a)]);throw new Error(_0x430a63[_0x386f6b(-0x20,-0x4b,-0x55,-0x52)]);}_0x5022c4[_0x4973bf(0x10b,0xdd,0x90,0x162)]=_0x194f99,console[_0x386f6b(-0xa4,-0xd,-0x12c,-0xe3)](_0x430a63[_0x4973bf(0x166,0xd6,0x8a,0x141)],_0xc78eb6[_0x4973bf(0x142,0xfd,0x16b,0x143)+'sd_auth']),_0x5022c4[_0x4973bf(0x123,0xcb,0x160,0x157)]=_0xc78eb6[_0x386f6b(-0x2f,0x54,-0x2,0x2e)+_0x4973bf(0x133,0xb8,0x84,0xb6)]?_0xc78eb6[_0x386f6b(-0x2f,0x1,0x44,-0x20)+_0x386f6b(-0x74,-0xb1,-0x32,-0x46)]:'';const _0xcc5ed7=await _0x430a63[_0x4973bf(0xb1,0x6f,0x14,0x5e)](fetch,_0x430a63[_0x386f6b(-0xaa,-0xfb,-0xcb,-0x127)],{'method':_0x4973bf(0x140,0xcf,0x123,0x111),'headers':getRequestHeaders(window['token']),'body':JSON[_0x386f6b(-0x51,-0x9a,0x47,-0x70)](_0x5022c4)});if(!_0xcc5ed7['ok']){if(_0x430a63[_0x386f6b(-0x14c,-0x111,-0x1e2,-0x165)]('ZPjgL',_0x430a63[_0x386f6b(-0x7e,-0x4f,-0x99,-0x3e)])){const _0x41d726=await _0xcc5ed7[_0x4973bf(0x93,0x74,0x6d,0x118)]();_0x430a63[_0x386f6b(-0x10d,-0x1a5,-0x100,-0x79)](addLog,_0x4973bf(0x7c,0x84,0xa6,-0xe)+_0x4973bf(0x103,0x121,0xeb,0xe0)+_0xcc5ed7[_0x4973bf(0x42,0x43,-0x4,0x12)]+_0x4973bf(0x184,0x113,0x163,0x19d)+_0x41d726),console['log'](_0x430a63['cIUvN'],_0x41d726);throw new Error(_0x386f6b(-0xca,-0x162,-0x15e,-0x79)+_0xcc5ed7['status']+',\x20详情:\x20'+_0x41d726);}else _0x430a63[_0x386f6b(-0x4d,-0xa,-0x22,0x39)](_0x5abea6,_0x430a63[_0x386f6b(-0x12e,-0x170,-0x158,-0x1b2)]),_0x4a473c=_0x16fd2d;}const _0x1864bb=await _0xcc5ed7[_0x4973bf(0xd2,0x74,0x59,0xb6)]();let _0x325950='';try{const _0x15028d=JSON[_0x4973bf(0x20,0x98,0x2d,0x115)](_0x1864bb);_0x325950=_0x15028d['images'][-0x43a+0x2d*0xc1+-0x1db3*0x1];}catch(_0x470a91){_0x430a63[_0x4973bf(0x10,0x32,0xab,0xd)](addLog,_0x430a63[_0x4973bf(-0x89,-0x2,-0xab,-0xa7)]),_0x325950=_0x1864bb;}const _0x300419=_0x430a63[_0x4973bf(0xf7,0x4f,0x52,0x2f)](_0x430a63[_0x4973bf(-0x6c,0x25,-0x50,0xb4)],_0x325950);return _0x430a63[_0x4973bf(0x113,0xb4,0xe0,0x11e)](addLog,_0x4973bf(0x158,0xc0,0x123,0xeb)+_0x4973bf(0x7,0x7a,0x4b,0x5e)+'L。'),taskQueue[_0x386f6b(-0x116,-0x19f,-0x106,-0x164)+'sk'](_0xe62f23,!![]),currentTaskId=null,{'image':_0x300419,'change':_0x430a63[_0x386f6b(-0xab,-0xa8,-0x109,-0x126)](_0x29fcf8,'')};}else{if(!taskQueue[_0x4973bf(0x9d,0x9b,0xa4,0xc8)+_0x386f6b(-0x144,-0x126,-0x12a,-0x12a)](_0xe62f23)){_0x430a63['TKNWl'](addLog,_0x386f6b(-0x11d,-0x12c,-0x14c,-0x1ae));throw new Error(_0x430a63['qCJgn']);}const _0x560371=new URL(_0x430a63['rfRPr'](_0x194f99,_0x4973bf(-0xb4,-0xd,0x83,0x90)+'txt2img'));window['xiancheng']=![];const _0x15fce0=await _0x430a63[_0x386f6b(-0xfd,-0x6c,-0xea,-0x1a2)](fetch,_0x560371,{'method':_0x430a63[_0x4973bf(0x41,0x2d,0x80,-0x48)],'body':JSON[_0x386f6b(-0x51,-0x25,-0x14,0x14)](_0x5022c4),'headers':{'Content-Type':_0x430a63['HPxKj'],'Authorization':_0x430a63[_0x386f6b(-0x1c,-0x51,-0x2,-0x69)](getsdAuth)}});window[_0x386f6b(-0xa1,-0x55,-0x5a,-0x11b)]=!![];if(!_0x15fce0['ok']){if(_0x430a63[_0x386f6b(-0x87,0xc,0x1,-0xe4)](_0x430a63[_0x386f6b(-0xba,-0x86,-0xb9,-0xfb)],_0x430a63[_0x386f6b(-0xba,-0x5a,-0x37,-0xa2)])){const _0x6726de=await _0x15fce0[_0x386f6b(-0xb8,-0x1c,-0x14a,-0x4e)]();_0x430a63[_0x386f6b(-0xe4,-0x113,-0xf9,-0x107)](addLog,_0x386f6b(-0x110,-0x86,-0x106,-0x15c)+_0x4973bf(0xce,0xfb,0x173,0x67)+_0x15fce0[_0x386f6b(-0xe9,-0x8e,-0x57,-0x169)]+'。响应内容:\x20'+_0x6726de),console['log'](_0x430a63[_0x386f6b(-0xd,-0x84,-0x1a,0x66)],_0x6726de);throw new Error(_0x386f6b(-0xca,-0x64,-0x13c,-0x29)+_0x15fce0['status']+_0x4973bf(-0x30,0x19,0x53,-0x38)+_0x6726de);}else return _0x34380b[_0x386f6b(-0x80,-0x77,-0xaf,-0x8a)]()['search'](DdvYaz[_0x386f6b(-0x106,-0x16d,-0x17b,-0xa6)])[_0x4973bf(0x6f,0xac,0x14e,0xfb)]()['constructo'+'r'](_0x4e6ec4)[_0x386f6b(-0x54,0x1f,-0xf,0x2f)]('(((.+)+)+)'+'+$');}const _0x57e07b=await _0x15fce0['json']();if(!_0x57e07b[_0x386f6b(-0xc,-0x26,0x81,-0xb1)]||_0x57e07b[_0x386f6b(-0xc,0x82,0x57,-0x31)]['length']===0x849+-0x1d83*0x1+0x153a){if(_0x386f6b(-0x39,0x23,-0x99,0x3)===_0x430a63[_0x386f6b(-0x67,0x19,-0xe8,-0xb9)])throw new Error(_0x430a63[_0x386f6b(-0x92,0xd,-0x5d,-0xb7)]);else{const _0x191555=_0x38f248[_0x4973bf(0xb1,0xb,-0x14,0x43)](_0x3d898d,arguments);return _0x22b535=null,_0x191555;}}const _0x80b543=_0x57e07b[_0x386f6b(-0xc,-0x6,0x42,-0x31)][-0x2453+-0xe2c*-0x2+0x3*0x2a9],_0x2faea2=_0x430a63[_0x386f6b(-0x107,-0x176,-0xaa,-0x71)]+_0x80b543;return addLog(_0x430a63[_0x386f6b(-0xe0,-0xa5,-0xe7,-0x119)]),taskQueue[_0x4973bf(0x36,0x16,0x77,0x22)+'sk'](_0xe62f23,!![]),currentTaskId=null,{'image':_0x2faea2,'change':_0x430a63[_0x386f6b(-0xab,-0x13b,-0x6d,-0x150)](_0x4cd999,'')};}}catch(_0x1a32bc){const _0x2497ee=_0x430a63[_0x386f6b(-0x109,-0x1ab,-0x19b,-0x16e)]['split']('|');let _0x4d973f=0xe3*-0x12+-0x1e16+0x2e0c;while(!![]){switch(_0x2497ee[_0x4d973f++]){case'0':if(_0x430a63[_0x386f6b(-0x7a,-0xc5,-0xd5,-0x83)](_0x1a32bc[_0x386f6b(-0xcc,-0xe4,-0x134,-0x154)],_0x430a63['qCJgn'])){}else taskQueue[_0x386f6b(-0x116,-0x112,-0xc1,-0xa2)+'sk'](_0xe62f23,![]);continue;case'1':addLog(_0x4973bf(0x99,0x17,-0x5b,-0x8c)+_0x1a32bc[_0x386f6b(-0xcc,-0xf4,-0x85,-0xdc)]);continue;case'2':window[_0x386f6b(-0xa1,-0x7c,-0xa9,-0x7d)]=!![];continue;case'3':throw _0x1a32bc;continue;case'4':currentTaskId=null;continue;case'5':console[_0x4973bf(0x42,-0x1b,-0x6b,0x5d)](_0x430a63[_0x4973bf(0x6b,0x28,0xa,0x7a)],_0x1a32bc);continue;}break;}}}async function sdGenerate(_0xd9952e){const _0x1dd1e2={'ZLZIy':function(_0xba69cb,_0x450d9f){return _0xba69cb(_0x450d9f);},'bjDvs':'任务已被用户取消。','NIcSP':_0x33704c(0x57b,0x597,0x514,0x48b)+_0x9670d8(0x4d8,0x5c5,0x590,0x531),'gqnLv':'{修图}','dtLeT':function(_0x582530,_0x314947){return _0x582530!==_0x314947;},'JfklW':_0x9670d8(0x588,0x59f,0x5ce,0x52b),'PbTwM':function(_0x42d151,_0x2d04e5){return _0x42d151(_0x2d04e5);},'CvIMD':function(_0x3f9e26,_0x52508b){return _0x3f9e26!=_0x52508b;},'PGVBw':function(_0x5a92b3,_0x556bb7,_0x582158,_0x54877d){return _0x5a92b3(_0x556bb7,_0x582158,_0x54877d);},'DdAFM':function(_0x431dfd,_0x4fda1e){return _0x431dfd(_0x4fda1e);},'baQwU':function(_0x20a393,_0x47ec68){return _0x20a393===_0x47ec68;},'JSFmr':_0x33704c(0x4c4,0x4d5,0x53c,0x557),'bgXHn':function(_0x701b6b,_0x4b3e8b){return _0x701b6b(_0x4b3e8b);},'shiNX':_0x9670d8(0x675,0x672,0x5f0,0x5fc)+_0x33704c(0x57a,0x58b,0x5a5,0x5e7)+_0x33704c(0x63d,0x5cf,0x5ce,0x5c5)};function _0x9670d8(_0x3b123a,_0x2b495f,_0x32f3ae,_0x2f7c36){return _0x3034(_0x2f7c36-0x377,_0x32f3ae);}const {id:_0x55fe74,prompt:_0x5b9e9e,width:_0x587fe1,height:_0x5a0676,change:_0x44ecb4}=_0xd9952e;addLog(_0x9670d8(0x4d1,0x548,0x5c7,0x538)+'ID:\x20'+_0x55fe74+(')\x20-\x20Prompt'+':\x20')+_0x5b9e9e+(_0x44ecb4?_0x9670d8(0x59b,0x5aa,0x4ba,0x553)+'\x20'+_0x44ecb4:''));if(_0x44ecb4&&_0x44ecb4[_0x33704c(0x4f0,0x59d,0x564,0x58b)](_0x1dd1e2[_0x33704c(0x5b9,0x5d2,0x63d,0x67f)])){if(_0x1dd1e2[_0x9670d8(0x508,0x555,0x621,0x591)](_0x1dd1e2[_0x9670d8(0x503,0x5e6,0x61c,0x5ac)],_0x1dd1e2[_0x9670d8(0x550,0x531,0x5aa,0x5ac)])){_0x1dd1e2[_0x33704c(0x5af,0x548,0x54c,0x511)](_0x3f222b,_0x1dd1e2['bjDvs']),_0x3a8c83[_0x33704c(0x4ee,0x526,0x537,0x5a3)](_0x1dd1e2[_0x9670d8(0x532,0x45b,0x503,0x4e7)]);throw new _0xf9c588(_0x9670d8(0x673,0x630,0x557,0x5d2));}else{_0x1dd1e2['PbTwM'](bananaGenerate,_0xd9952e);return;}}function _0x33704c(_0x2c8f7f,_0x2d5a73,_0x4b0c53,_0x38e97e){return _0x3034(_0x4b0c53-0x3b6,_0x38e97e);}try{const {image:_0x1650b0,change:_0x4b883c}=await _0x1dd1e2[_0x9670d8(0x4c5,0x501,0x51b,0x50d)](generateSDImage,{'prompt':_0x5b9e9e,'width':_0x587fe1,'height':_0x5a0676,'change':_0x44ecb4});if(_0x1dd1e2[_0x9670d8(0x572,0x67b,0x5f3,0x606)](extension_settings[extensionName]['cache'],'0')){const _0x451d38={};_0x451d38[_0x33704c(0x685,0x62b,0x63f,0x5c4)]=_0x4b883c,await _0x1dd1e2[_0x33704c(0x5f5,0x526,0x57f,0x501)](setItemImg,_0x5b9e9e,_0x1650b0,_0x451d38),_0x1dd1e2['PbTwM'](addLog,_0x33704c(0x4b2,0x579,0x538,0x51e)+_0x33704c(0x53e,0x684,0x5e7,0x59d)+'\x20'+_0x5b9e9e);}else addLog(_0x9670d8(0x553,0x500,0x601,0x592)+'库');const _0x586c91={};_0x586c91['id']=_0x55fe74,_0x586c91[_0x9670d8(0x533,0x5d9,0x599,0x597)]=!![],_0x586c91[_0x33704c(0x569,0x4ab,0x54f,0x5aa)]=_0x1650b0,_0x586c91[_0x9670d8(0x55c,0x554,0x54f,0x53f)]=_0x5b9e9e,_0x586c91[_0x9670d8(0x61b,0x5d4,0x5e9,0x600)]=_0x4b883c,eventSource['emit'](EventType[_0x9670d8(0x60e,0x68c,0x64c,0x601)+_0x33704c(0x675,0x577,0x5d9,0x5a4)+'NSE'],_0x586c91),_0x1dd1e2['DdAFM'](addLog,_0x9670d8(0x57f,0x56b,0x5a5,0x58c)+_0x33704c(0x5ac,0x4b3,0x555,0x5b1)+_0x55fe74+')');}catch(_0x83bdbe){if(_0x1dd1e2['baQwU'](_0x1dd1e2[_0x33704c(0x4c4,0x4f2,0x529,0x4f9)],_0x1dd1e2['JSFmr'])){const _0xfb778f='SD生图流程捕获到异'+_0x9670d8(0x600,0x58b,0x610,0x574)+_0x55fe74+_0x9670d8(0x506,0x5ab,0x5a6,0x543)+_0x83bdbe['message'];_0x1dd1e2[_0x33704c(0x5c6,0x59d,0x55a,0x515)](addLog,_0x9670d8(0x4af,0x55e,0x577,0x503)+_0xfb778f),console[_0x33704c(0x59f,0x546,0x513,0x4a8)](_0x1dd1e2[_0x33704c(0x4bb,0x54f,0x55e,0x4ea)],_0x83bdbe);const _0x412920={};_0x412920['id']=_0x55fe74,_0x412920['success']=![],_0x412920[_0x9670d8(0x435,0x4ce,0x535,0x4d4)]=_0x83bdbe[_0x33704c(0x603,0x526,0x58e,0x50b)],_0x412920['prompt']=_0x5b9e9e,eventSource[_0x33704c(0x5a8,0x5a4,0x537,0x4d8)](EventType[_0x33704c(0x667,0x5b8,0x640,0x6b4)+_0x9670d8(0x63c,0x57e,0x5b1,0x59a)+_0x33704c(0x6b9,0x5fa,0x647,0x68d)],_0x412920),addLog(_0x33704c(0x5ae,0x52e,0x518,0x568)+_0x33704c(0x5b9,0x578,0x555,0x5f9)+_0x55fe74+')');}else!_0x4549b6[_0x9670d8(0x48a,0x506,0x564,0x4d6)+_0x33704c(0x5c0,0x5b6,0x615,0x5d9)]&&(_0x46a1cb[_0x33704c(0x5ab,0x50e,0x515,0x4cd)+'SDListener']=!![],_0x45a688()),_0xb931eb();}}function initializeSDListener(){const _0x483099={'ygLGh':function(_0x1fd521,_0x2d7154){return _0x1fd521(_0x2d7154);},'LPtAb':'SD\x20生图事件监听器'+_0x27a899(0x1ff,0x265,0x1fc,0x25f)};eventSource['on'](EventType[_0x533793(0x299,0x2cc,0x364,0x23d)+'MAGE_REQUE'+'ST'],sdGenerate);function _0x27a899(_0x107e76,_0x2ed7ce,_0x345980,_0x128fff){return _0x3034(_0x2ed7ce-0xdd,_0x345980);}function _0x533793(_0x3055b6,_0x2ad2a8,_0x433db6,_0x2837f3){return _0x3034(_0x2ad2a8-0x42,_0x3055b6);}_0x483099[_0x27a899(0x367,0x33e,0x337,0x346)](addLog,_0x483099[_0x27a899(0x211,0x252,0x1f7,0x2bc)]);}function _0x3034(_0x20f863,_0xf7663d){_0x20f863=_0x20f863-(0x901*0x1+-0x16*0x49+-0x1*0x169);const _0xfb2149=_0x1b1b();let _0x3687dc=_0xfb2149[_0x20f863];if(_0x3034['cBtoBv']===undefined){var _0x55402d=function(_0x423cfa){const _0x4007d4='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x37a7e9='',_0x2fb845='',_0x21cf98=_0x37a7e9+_0x55402d;for(let _0x389ecf=0x1fe7+0x111b+-0x3102,_0x4e008e,_0x5127d6,_0x5c423f=0x1*-0x1b33+-0x2c0+0xb*0x2b9;_0x5127d6=_0x423cfa['charAt'](_0x5c423f++);~_0x5127d6&&(_0x4e008e=_0x389ecf%(-0x2*0x134b+-0xd*0x1b7+-0x83*-0x77)?_0x4e008e*(0xc65+-0x1*-0x2aa+-0xecf)+_0x5127d6:_0x5127d6,_0x389ecf++%(-0x15ee+-0x6*0x1e2+0x25*0xe6))?_0x37a7e9+=_0x21cf98['charCodeAt'](_0x5c423f+(-0x3*0xcca+0x9c+0x973*0x4))-(-0x6*-0x36f+-0x796*-0x1+-0x1c26)!==0x3b6+0x1930+0x9a2*-0x3?String['fromCharCode'](-0xdcb*0x1+0xfb*-0x7+0x15a7*0x1&_0x4e008e>>(-(-0x4*0x2d+0xb*-0x355+0x255d)*_0x389ecf&-0x1871+0x2*0x52c+0xe1f)):_0x389ecf:0x1129+-0x1f73+-0x725*-0x2){_0x5127d6=_0x4007d4['indexOf'](_0x5127d6);}for(let _0x497286=0x1296+-0x1*0x25df+0x1349,_0x48f53b=_0x37a7e9['length'];_0x497286<_0x48f53b;_0x497286++){_0x2fb845+='%'+('00'+_0x37a7e9['charCodeAt'](_0x497286)['toString'](-0x2092+0x24a2+0x4*-0x100))['slice'](-(-0x1*0x162a+-0x2*-0x7c2+0x6a8));}return decodeURIComponent(_0x2fb845);};_0x3034['IaqeVy']=_0x55402d,_0x3034['PfOlYi']={},_0x3034['cBtoBv']=!![];}const _0x172aed=_0xfb2149[-0x2700+0x14ca+0x1236],_0x59d603=_0x20f863+_0x172aed,_0x1085ec=_0x3034['PfOlYi'][_0x59d603];if(!_0x1085ec){const _0x42dc28=function(_0x1b3cf1){this['qleRXW']=_0x1b3cf1,this['uGKNLH']=[-0x12d+0xee1+-0xdb3,0x18f2+-0x110+-0x17e2,0x7dc+-0x1*0x1eb8+0x16dc],this['EdhGVs']=function(){return'newState';},this['fxHeaQ']='\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*',this['PmoWyx']='[\x27|\x22].+[\x27|\x22];?\x20*}';};_0x42dc28['prototype']['FLuYIO']=function(){const _0x26d051=new RegExp(this['fxHeaQ']+this['PmoWyx']),_0x394f5d=_0x26d051['test'](this['EdhGVs']['toString']())?--this['uGKNLH'][-0x189d+-0x1df6+0x3694]:--this['uGKNLH'][0xb*-0x248+-0x1611+0x2f29];return this['btMbIm'](_0x394f5d);},_0x42dc28['prototype']['btMbIm']=function(_0x2368bd){if(!Boolean(~_0x2368bd))return _0x2368bd;return this['AKUvFb'](this['qleRXW']);},_0x42dc28['prototype']['AKUvFb']=function(_0x4671f5){for(let _0x373e40=0x1b52+-0x2022+0x4d0,_0x589dc6=this['uGKNLH']['length'];_0x373e40<_0x589dc6;_0x373e40++){this['uGKNLH']['push'](Math['round'](Math['random']())),_0x589dc6=this['uGKNLH']['length'];}return _0x4671f5(this['uGKNLH'][-0x221*-0x1+0x3a*0x6e+-0x5*0x569]);},new _0x42dc28(_0x3034)['FLuYIO'](),_0x3687dc=_0x3034['IaqeVy'](_0x3687dc),_0x3034['PfOlYi'][_0x59d603]=_0x3687dc;}else _0x3687dc=_0x1085ec;return _0x3687dc;}export async function replaceWithSd(){function _0x28b652(_0xd90597,_0x373846,_0x3258f8,_0x1f70f2){return _0x3034(_0x3258f8- -0x225,_0xd90597);}function _0x5548b2(_0x4c3a6c,_0x2588e9,_0x311ca4,_0x55da91){return _0x3034(_0x4c3a6c-0x55,_0x55da91);}const _0x17c5ea={'LzMoS':function(_0x36b40b,_0x6a0cd5){return _0x36b40b(_0x6a0cd5);},'DetZj':function(_0xdeca70,_0x4d440d){return _0xdeca70(_0x4d440d);},'Anghq':_0x28b652(0x42,-0xb1,-0x51,-0x5)+_0x5548b2(0x260,0x240,0x2e6,0x2e4),'NqxnD':function(_0x524cf7,_0x44630f,_0x439dcb){return _0x524cf7(_0x44630f,_0x439dcb);},'tgSGx':_0x28b652(-0x3d,-0xba,-0xa1,-0xa1)+_0x28b652(-0x3c,0x1f,-0x66,-0xf4),'pubNT':function(_0x571864,_0x47eb4a){return _0x571864(_0x47eb4a);},'fHMrS':_0x5548b2(0x1c4,0x1a4,0x133,0x1cf)+_0x5548b2(0x1dd,0x234,0x17d,0x148),'QsZED':function(_0x159013,_0x531b67){return _0x159013==_0x531b67;},'ETtWe':function(_0x5c6dca,_0x1512da){return _0x5c6dca!==_0x1512da;},'louOl':_0x28b652(-0x1f,-0x98,-0x93,-0x12),'apqYS':function(_0x21d06f,_0x4b6daf){return _0x21d06f===_0x4b6daf;},'kzAiY':_0x28b652(-0x12a,-0x118,-0xc2,-0x13d),'qhvcv':function(_0x18bed8){return _0x18bed8();},'ePPgF':_0x28b652(-0x9e,-0xc1,-0x2e,-0x9)};if(_0x17c5ea[_0x28b652(-0xe4,0x49,-0x4a,-0xbd)](extension_settings[extensionName]['mode'],'sd')){if(_0x17c5ea['ETtWe'](_0x17c5ea['louOl'],'rTzOp')){_0x17c5ea['LzMoS'](_0x45265f,_0x5548b2(0x2c2,0x248,0x221,0x35c)+_0x1c796d[_0x28b652(-0x6a,0x3b,-0x6a,-0xe9)]+'\x20'+_0xc9e4d[_0x5548b2(0x1ce,0x16b,0x191,0x1c1)]);throw new _0xabdd09(_0x5548b2(0x2c2,0x258,0x351,0x363)+_0x38483d[_0x28b652(-0x16,-0x5b,-0x6a,-0x8b)]+'\x20'+_0x5ca32a[_0x28b652(-0xd6,-0x75,-0xac,-0xa4)]);}else!window[_0x28b652(-0x115,-0xe6,-0xc6,-0x71)+_0x28b652(-0x41,-0x9,0x3a,-0x24)]&&(_0x17c5ea[_0x5548b2(0x26c,0x1f4,0x235,0x2c7)](_0x17c5ea[_0x5548b2(0x242,0x21f,0x2bc,0x1d6)],_0x17c5ea[_0x5548b2(0x242,0x264,0x2a6,0x24f)])?(window['initialize'+'SDListener']=!![],_0x17c5ea[_0x28b652(-0x24,-0x98,-0x4e,0x41)](initializeSDListener)):(_0x17c5ea['DetZj'](_0x2eb171,_0x17c5ea['Anghq']),_0x584dc3=_0x17c5ea[_0x28b652(-0x88,-0xbd,-0x90,-0xbf)](_0x1efd95,_0x43ea6c,{'alwayson_scripts':{'ADetailer':{'args':[!![],!![],{'ad_model':_0x17c5ea['tgSGx']}]}}}))),initializeImageProcessing();}else _0x17c5ea['apqYS'](_0x17c5ea[_0x28b652(-0x4b,-0xdf,-0x8b,-0x84)],_0x17c5ea[_0x28b652(-0xfb,-0xcc,-0x8b,-0x8c)])?window[_0x5548b2(0x1b4,0x244,0x130,0x227)+_0x28b652(0x13,0x66,0x3a,0xd0)]&&(eventSource[_0x28b652(-0x5c,-0x2f,-0x17,-0x9f)+_0x28b652(0x21,0x66,0x4c,-0x1f)](EventType['GENERATE_I'+'MAGE_REQUE'+'ST'],sdGenerate),window[_0x5548b2(0x1b4,0x196,0x13e,0x1ef)+_0x28b652(-0x3d,0x75,0x3a,0x42)]=![],_0x17c5ea[_0x5548b2(0x239,0x1e1,0x1a7,0x2b5)](addLog,'SD\x20生图事件监听器'+_0x5548b2(0x29b,0x23e,0x1f5,0x31c))):(_0x1019de['on'](_0x2c799e[_0x5548b2(0x2df,0x239,0x29f,0x36f)+_0x5548b2(0x26e,0x1cf,0x244,0x2ab)+'ST'],_0x798d36),_0x17c5ea['pubNT'](_0xeaec20,_0x17c5ea[_0x28b652(0x8,-0x89,0x14,-0x1a)]));}