(function(_0x44454c,_0x387318){function _0x23358e(_0x46d4bd,_0x38e98c,_0x479a82,_0x411e42){return _0x6eeb(_0x46d4bd-0x107,_0x479a82);}const _0x38c061=_0x44454c();function _0x4af18a(_0x4d7f7f,_0x11c185,_0xc142b6,_0x479b99){return _0x6eeb(_0x479b99- -0x26f,_0x11c185);}while(!![]){try{const _0x528727=-parseInt(_0x23358e(0x2b3,0x27a,0x2b8,0x2f1))/(0x2bd+0x7ad*-0x2+0xc9e)*(-parseInt(_0x23358e(0x2cd,0x2f4,0x309,0x2b7))/(0x7f6+-0x1755+-0x1*-0xf61))+parseInt(_0x4af18a(-0x71,-0x68,-0x6a,-0x5f))/(0x23ef+-0x7*0x9f+-0x3b*0x89)+parseInt(_0x23358e(0x295,0x2ba,0x30d,0x2d9))/(0x1ba*0xd+-0x147c*0x1+-0x1f2)*(parseInt(_0x4af18a(-0x26,-0x11,-0xa,-0x13))/(-0x1d0c+0x1db+0x1b36))+-parseInt(_0x4af18a(-0xba,-0xb2,-0x84,-0xce))/(0x3*0xfd+0x98d+0x63f*-0x2)+-parseInt(_0x4af18a(-0x46,-0x15,-0x100,-0x82))/(0xcc5+-0x1e10+0x1152)*(parseInt(_0x23358e(0x2d5,0x328,0x314,0x28b))/(0x2*0x552+-0xccf*0x3+0x1bd1))+parseInt(_0x23358e(0x2f0,0x2d5,0x318,0x2a4))/(-0x1e5e+0xf2e+0xf39)+-parseInt(_0x23358e(0x2e7,0x32c,0x2e0,0x2fe))/(-0x1e8*-0x7+-0x6*-0x347+0x4*-0x83e);if(_0x528727===_0x387318)break;else _0x38c061['push'](_0x38c061['shift']());}catch(_0x161462){_0x38c061['push'](_0x38c061['shift']());}}}(_0x36e5,0x66bc2+0x5*-0x146f6+0x3c22c));const _0xf0d03f=(function(){function _0x48da43(_0x4be57d,_0x3a99a0,_0x359b8e,_0x208a43){return _0x6eeb(_0x359b8e-0x11f,_0x4be57d);}const _0x7dd84e={'rkpjO':_0x52d1d8(0x430,0x422,0x4d1,0x487)+_0x52d1d8(0x475,0x3e2,0x41a,0x421)+'elAI\x20image'+':','UzvNx':function(_0xcb7ff1,_0x452306){return _0xcb7ff1(_0x452306);},'oIFXX':function(_0x41558f,_0x19863e){return _0x41558f+_0x19863e;},'xqHJL':function(_0x1177e1,_0x4788ab){return _0x1177e1!==_0x4788ab;},'sKKdx':'koMYg'};let _0x508505=!![];function _0x52d1d8(_0x62c44a,_0x1c3f82,_0x557913,_0x24beb7){return _0x6eeb(_0x24beb7-0x24f,_0x557913);}return function(_0x44cc7d,_0xd8a04c){function _0x560031(_0x190fe4,_0x1ceccc,_0x3907ce,_0x5868dd){return _0x52d1d8(_0x190fe4-0x1ef,_0x1ceccc-0x194,_0x1ceccc,_0x190fe4-0xcd);}function _0x4a346e(_0x57b3ef,_0x2109f8,_0x1a58c4,_0xbd2bc8){return _0x52d1d8(_0x57b3ef-0x2a,_0x2109f8-0x1f,_0xbd2bc8,_0x1a58c4- -0x189);}if(_0x7dd84e[_0x4a346e(0x2cc,0x31c,0x2c9,0x260)](_0x7dd84e['sKKdx'],_0x7dd84e[_0x560031(0x56b,0x51e,0x567,0x5b4)]))_0x3e2f66[_0x560031(0x57d,0x5cd,0x5e4,0x5dc)](_0x7dd84e[_0x560031(0x557,0x529,0x4dd,0x566)],_0x5861a5),_0x7dd84e[_0x4a346e(0x3a5,0x37b,0x330,0x2d3)](_0x3b7976,_0x7dd84e[_0x4a346e(0x2f6,0x2f2,0x34a,0x2eb)](_0x560031(0x4b4,0x4dc,0x4c4,0x4be),_0x59b924[_0x4a346e(0x2fd,0x34f,0x34f,0x333)]));else{const _0x49b155=_0x508505?function(){if(_0xd8a04c){const _0x2e9feb=_0xd8a04c['apply'](_0x44cc7d,arguments);return _0xd8a04c=null,_0x2e9feb;}}:function(){};return _0x508505=![],_0x49b155;}};}()),_0x4d4b87=_0xf0d03f(this,function(){function _0x1f63fd(_0x1cb639,_0x53d4f8,_0x119974,_0x2623cd){return _0x6eeb(_0x2623cd- -0x3d9,_0x119974);}const _0x49d8ab={};_0x49d8ab[_0xc7c58a(0x3d0,0x3f6,0x3ac,0x395)]=_0xc7c58a(0x2fd,0x354,0x32d,0x2c5)+'+$';function _0xc7c58a(_0xb8db95,_0x40554f,_0x204f7c,_0xf0e494){return _0x6eeb(_0x204f7c-0x135,_0x40554f);}const _0x57fff=_0x49d8ab;return _0x4d4b87[_0x1f63fd(-0x1be,-0x150,-0x20f,-0x1ba)]()['search'](_0x57fff[_0xc7c58a(0x3b3,0x3aa,0x3ac,0x346)])[_0x1f63fd(-0x151,-0x182,-0x1ce,-0x1ba)]()['constructo'+'r'](_0x4d4b87)[_0xc7c58a(0x307,0x331,0x2cb,0x2a5)](_0x57fff[_0xc7c58a(0x38f,0x378,0x3ac,0x3ea)]);});_0x4d4b87();import{extension_settings}from'../../../../../extensions.js';import{saveSettingsDebounced}from'../../../../../../script.js';import{extensionName}from'../config.js';import{processUploadedImage,processUploadedImageToBlob,addLog}from'../utils.js';import{dbs}from'../database.js';const NAI_VIBE_CACHE_KEY=_0x15dafa(-0x14c,-0x150,-0x170,-0x10d)+_0x3d78b7(0x590,0x5cf,0x55c,0x51e)+_0x3d78b7(0x4c1,0x444,0x502,0x4dd)+'age',NAI_CHAR_REF_CACHE_KEY=_0x15dafa(-0x14c,-0x132,-0x117,-0x145)+_0x3d78b7(0x53d,0x582,0x5ab,0x58b)+_0x15dafa(-0x217,-0x20f,-0x1b1,-0x1ad),COMFYUI_REF_CACHE_KEY='cache_comf'+_0x3d78b7(0x500,0x535,0x4a5,0x4e1)+'age';let nai3VibeTransferImageMimeType=_0x3d78b7(0x4c5,0x500,0x502,0x52f),nai3CharRefImageMimeType=_0x15dafa(-0x1f8,-0x20f,-0x19e,-0x21d),comfyuiImageObjectURL=null;function _0x3d78b7(_0x5d5f03,_0x53d4dc,_0x342da5,_0x54d256){return _0x6eeb(_0x5d5f03-0x311,_0x342da5);}function _0x6eeb(_0x5d3d1d,_0x1305d0){_0x5d3d1d=_0x5d3d1d-(0xb0*0x16+0x14bf+-0x31f*0xb);const _0x3ad9c0=_0x36e5();let _0x1380e5=_0x3ad9c0[_0x5d3d1d];if(_0x6eeb['oCwWgM']===undefined){var _0x20da99=function(_0x314581){const _0x88dfb6='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x1a8806='',_0xc99d72='',_0xcf903c=_0x1a8806+_0x20da99;for(let _0x1da6b4=-0x92f*0x1+-0x1b55*-0x1+-0x1226,_0xbec0e3,_0x3e258d,_0x3a25fc=-0x12*-0x161+-0x4*-0x21a+-0x213a;_0x3e258d=_0x314581['charAt'](_0x3a25fc++);~_0x3e258d&&(_0xbec0e3=_0x1da6b4%(0x2601*-0x1+-0x2*0x235+0x2a6f)?_0xbec0e3*(-0x143*-0x2+-0x8ff+-0x6b9*-0x1)+_0x3e258d:_0x3e258d,_0x1da6b4++%(0x2639+-0x1182*-0x2+-0x1*0x4939))?_0x1a8806+=_0xcf903c['charCodeAt'](_0x3a25fc+(0x1b14+-0x8*0x3ef+0x46e))-(0x6cd*-0x1+-0x1da7+0x247e)!==0x3a5*-0x1+-0x3*-0x72f+-0x11e8?String['fromCharCode'](-0x1660+-0xcfb+-0x245a*-0x1&_0xbec0e3>>(-(0x144b+0x163d+-0x2a86)*_0x1da6b4&-0x1e90+-0x31d*0x1+-0x1*-0x21b3)):_0x1da6b4:-0x1ac1+0x1574+-0x3b*-0x17){_0x3e258d=_0x88dfb6['indexOf'](_0x3e258d);}for(let _0x19a961=-0x1af9*-0x1+-0x2*-0x337+0x2167*-0x1,_0x32ed67=_0x1a8806['length'];_0x19a961<_0x32ed67;_0x19a961++){_0xc99d72+='%'+('00'+_0x1a8806['charCodeAt'](_0x19a961)['toString'](-0x3e*-0x4d+0x271+-0x1507))['slice'](-(0x13cd+0x5f7*-0x4+0x411));}return decodeURIComponent(_0xc99d72);};_0x6eeb['ENnwpE']=_0x20da99,_0x6eeb['mFdCsX']={},_0x6eeb['oCwWgM']=!![];}const _0x474fc2=_0x3ad9c0[-0x1bd*-0x1+0x12f7+-0xa5a*0x2],_0x15e6a3=_0x5d3d1d+_0x474fc2,_0x301e0d=_0x6eeb['mFdCsX'][_0x15e6a3];if(!_0x301e0d){const _0x5702c3=function(_0xa921b2){this['cxyMER']=_0xa921b2,this['qRGFrK']=[-0x14c*-0xf+0x4e7+-0x185a,-0x2*0x114+-0x8*-0x186+-0xa08,-0x18ed+0x10b1*0x1+0x83c],this['gGbSuH']=function(){return'newState';},this['wQDFVt']='\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*',this['qGGTnZ']='[\x27|\x22].+[\x27|\x22];?\x20*}';};_0x5702c3['prototype']['ckmgeN']=function(){const _0xfa8e63=new RegExp(this['wQDFVt']+this['qGGTnZ']),_0x3e70e8=_0xfa8e63['test'](this['gGbSuH']['toString']())?--this['qRGFrK'][0x7a6+-0xff5+0x428*0x2]:--this['qRGFrK'][0xd*-0x138+0x1*-0x1451+0x1*0x2429];return this['MRqRYG'](_0x3e70e8);},_0x5702c3['prototype']['MRqRYG']=function(_0x6084d1){if(!Boolean(~_0x6084d1))return _0x6084d1;return this['jrzLrW'](this['cxyMER']);},_0x5702c3['prototype']['jrzLrW']=function(_0x3c22d1){for(let _0x12a52b=0x2511+-0x180b+0x1*-0xd06,_0xaa0bfd=this['qRGFrK']['length'];_0x12a52b<_0xaa0bfd;_0x12a52b++){this['qRGFrK']['push'](Math['round'](Math['random']())),_0xaa0bfd=this['qRGFrK']['length'];}return _0x3c22d1(this['qRGFrK'][0x3*-0xc0d+0x1cfd+0x72a*0x1]);},new _0x5702c3(_0x6eeb)['ckmgeN'](),_0x1380e5=_0x6eeb['ENnwpE'](_0x1380e5),_0x6eeb['mFdCsX'][_0x15e6a3]=_0x1380e5;}else _0x1380e5=_0x301e0d;return _0x1380e5;}function updateNovelaiImagePreview(_0x35b2a7){const _0x472037={};_0x472037[_0x47b774(0xa7,0x68,0x2e,-0x2)]='previewIma'+_0x4faf80(0x314,0x314,0x2bd,0x343),_0x472037[_0x47b774(-0x2,0x2d,0x6c,0x4f)]='#novelai-i'+_0x47b774(-0x3,-0x4f,0xd,0x26)+_0x4faf80(0x2f0,0x2ca,0x295,0x2d8)+_0x47b774(0xa7,0xab,0x4e,0x84)+_0x47b774(-0x24,-0x53,-0x4d,-0x32)+_0x4faf80(0x34c,0x36e,0x387,0x32b)+'r',_0x472037[_0x4faf80(0x2de,0x355,0x344,0x2d7)]=_0x4faf80(0x27e,0x29c,0x28b,0x2ca)+'move-image'+_0x4faf80(0x35f,0x2eb,0x27e,0x293),_0x472037[_0x4faf80(0x32a,0x381,0x331,0x33e)]='data:image',_0x472037[_0x4faf80(0x282,0x2e8,0x28d,0x314)]=_0x4faf80(0x387,0x341,0x2d4,0x2f9),_0x472037[_0x47b774(-0x1c,0xcf,0x5c,-0x21)]='none';function _0x4faf80(_0x3bd685,_0x3e854f,_0x3913ae,_0x473c82){return _0x3d78b7(_0x3e854f- -0x210,_0x3e854f-0x73,_0x473c82,_0x473c82-0x71);}_0x472037['swLZH']=_0x47b774(-0x12,0xf,-0x15,0x24)+'x',_0x472037[_0x4faf80(0x30c,0x305,0x344,0x323)]='2|0|4|3|1',_0x472037['Lhjla']=_0x4faf80(0x346,0x35f,0x2f9,0x346);function _0x47b774(_0x201b07,_0xe5320d,_0x5c219e,_0x1c869b){return _0x15dafa(_0x5c219e-0x1a4,_0x1c869b,_0x5c219e-0x1c9,_0x1c869b-0x1b3);}const _0x231817=_0x472037,_0x19ff80=document[_0x47b774(-0x13,-0x1,-0x63,0x7)+_0x47b774(-0xab,-0xd,-0x74,-0x8a)](_0x231817[_0x4faf80(0x3b6,0x337,0x2d3,0x3b5)]),_0x639ae=document['querySelec'+'tor'](_0x231817[_0x4faf80(0x3b9,0x375,0x300,0x397)]),_0x23eed6=document[_0x47b774(-0x7a,-0x10,-0x63,0x13)+_0x4faf80(0x269,0x295,0x2b3,0x307)](_0x231817['mFEYu']);if(_0x35b2a7&&_0x35b2a7[_0x47b774(0x77,0x16,0x5b,0xa5)](_0x231817[_0x4faf80(0x3cc,0x381,0x3f4,0x334)])){_0x19ff80[_0x4faf80(0x399,0x34c,0x2ef,0x312)]=_0x35b2a7,_0x19ff80[_0x4faf80(0x2b5,0x2a5,0x263,0x2b2)]['display']=_0x231817[_0x4faf80(0x2c0,0x2e8,0x2d1,0x29c)],_0x639ae[_0x4faf80(0x240,0x2a5,0x23b,0x243)][_0x4faf80(0x3e5,0x37c,0x3e9,0x368)]=_0x231817[_0x4faf80(0x393,0x365,0x3b0,0x32e)],_0x23eed6['style'][_0x4faf80(0x307,0x37c,0x374,0x3e9)]=_0x231817[_0x47b774(0xa,0x1f,-0x35,0x47)];const _0x427b8a=_0x35b2a7[_0x47b774(0xb5,0xf,0x6e,0x8)](','),_0xa87ad2=_0x427b8a[0x250*-0x10+-0x6*-0x296+0x2c*0x7d]['split'](':')[-0xb*0x1c5+-0xde5+0x215d][_0x4faf80(0x38f,0x377,0x3ac,0x344)](';')[-0x89*-0x17+-0x1a2a+0xddb];nai3VibeTransferImageMimeType=_0xa87ad2,window[_0x4faf80(0x320,0x303,0x2c2,0x362)+_0x4faf80(0x3b8,0x33d,0x2c9,0x391)+'e']=_0x427b8a[0x2126*0x1+0x1*-0x2127+-0x2*-0x1];const _0x621a3f={};_0x621a3f['id']=NAI_VIBE_CACHE_KEY,_0x621a3f[_0x4faf80(0x347,0x351,0x320,0x2fc)]=_0x35b2a7,dbs['storeReadW'+_0x4faf80(0x290,0x2fd,0x345,0x2d3)](_0x621a3f);}else{const _0x33ffa1=_0x231817[_0x47b774(0x0,-0xb,-0x4,-0x25)]['split']('|');let _0x36d384=0x1*-0x1010+0x1*-0x3cd+0x13dd;while(!![]){switch(_0x33ffa1[_0x36d384++]){case'0':_0x19ff80[_0x4faf80(0x25a,0x2a5,0x265,0x235)][_0x47b774(0x41,0x20,0x73,0x88)]=_0x231817[_0x4faf80(0x2f4,0x365,0x392,0x371)];continue;case'1':window[_0x4faf80(0x2a4,0x303,0x32d,0x2e7)+_0x4faf80(0x2c7,0x33d,0x2e9,0x3b7)+'e']=null;continue;case'2':_0x19ff80['src']='';continue;case'3':_0x23eed6[_0x4faf80(0x254,0x2a5,0x316,0x2ac)][_0x4faf80(0x300,0x37c,0x311,0x365)]=_0x231817[_0x47b774(0x2c,0x95,0x5c,0xb9)];continue;case'4':_0x639ae[_0x47b774(-0x47,0xb,-0x64,-0x5d)][_0x47b774(0xb5,0x15,0x73,0x86)]=_0x231817['Lhjla'];continue;}break;}}}function removeNovelaiImage(){function _0x1b864d(_0x4db6cc,_0xe34e7f,_0x394b50,_0x45d276){return _0x3d78b7(_0x45d276- -0x3b0,_0xe34e7f-0x137,_0x4db6cc,_0x45d276-0x1cc);}const _0x1dc1a4={'MMjsy':function(_0x4e2a12,_0x1e9240){return _0x4e2a12(_0x1e9240);}};_0x1dc1a4[_0x1b864d(0x154,0x1bd,0x14b,0x142)](updateNovelaiImagePreview,null),dbs['storeDelet'+'e'](NAI_VIBE_CACHE_KEY);}async function handleNovelaiImageUpload(_0x1311ec){function _0x423707(_0x241c65,_0x13cde9,_0x14083f,_0x2b8ddf){return _0x3d78b7(_0x13cde9-0xb9,_0x13cde9-0x10a,_0x2b8ddf,_0x2b8ddf-0x22);}const _0x55d7ec={'WgaiP':function(_0x5bf0d8,_0x26340d,_0x3717e9){return _0x5bf0d8(_0x26340d,_0x3717e9);},'GwDsh':function(_0x4b3110,_0x85471){return _0x4b3110(_0x85471);},'WWJaM':'Error\x20proc'+_0x423707(0x5bc,0x59c,0x5e1,0x596)+_0x47ad75(0x54,0x90,0x3,0x68)+':','SHYsH':_0x423707(0x5d1,0x562,0x5d2,0x562)},_0x4038b0=_0x1311ec[_0x423707(0x5ed,0x5a1,0x613,0x611)][_0x47ad75(0x2d,0x2b,-0xf,-0x3a)][-0x194*0x17+-0x1*0x923+0x2d6f];if(!_0x4038b0)return;function _0x47ad75(_0x3cc120,_0xad9288,_0x5e1201,_0x2fec12){return _0x15dafa(_0x3cc120-0x246,_0x5e1201,_0x5e1201-0xd9,_0x2fec12-0xb5);}try{const _0x19f0b6=await _0x55d7ec['WgaiP'](processUploadedImage,_0x4038b0,!![]);_0x55d7ec[_0x423707(0x584,0x5fd,0x666,0x5d6)](updateNovelaiImagePreview,_0x19f0b6);}catch(_0x2f9bdd){console[_0x47ad75(0xfb,0xa1,0xce,0xea)](_0x55d7ec[_0x47ad75(0x98,0xeb,0xa7,0x74)],_0x2f9bdd),_0x55d7ec[_0x423707(0x63d,0x5fd,0x61b,0x5b3)](alert,_0x55d7ec['SHYsH']+_0x2f9bdd[_0x47ad75(0x123,0xdd,0x119,0x187)]);}}function updateNovelaiCharRefImagePreview(_0x5001f1){const _0x5ce95f={};_0x5ce95f[_0x41e0fe(0x197,0xe4,0xe1,0x11a)]=_0x4c82c3(0x50d,0x541,0x4f4,0x4cf)+'ge_nai_cha'+_0x41e0fe(0x15a,0x119,0x1d1,0x155),_0x5ce95f[_0x4c82c3(0x4f7,0x4af,0x56c,0x4ad)]='novelai-re'+_0x4c82c3(0x53b,0x4c9,0x51d,0x4c3)+'ref-image-'+_0x41e0fe(0x142,0xf2,0x1d0,0x15d),_0x5ce95f[_0x4c82c3(0x532,0x4ed,0x562,0x565)]=_0x4c82c3(0x542,0x4f4,0x4f1,0x50f);function _0x41e0fe(_0x56dcaf,_0x684937,_0x554154,_0x46ee21){return _0x15dafa(_0x46ee21-0x2f2,_0x554154,_0x554154-0xb5,_0x46ee21-0xe5);}_0x5ce95f['SqQyD']='none',_0x5ce95f[_0x41e0fe(0x1cd,0x1c8,0x194,0x18c)]='flex';const _0x4d8436=_0x5ce95f,_0x129842=document['getElement'+_0x41e0fe(0xc4,0x77,0x157,0xda)](_0x4d8436[_0x4c82c3(0x4d6,0x480,0x50a,0x528)]);function _0x4c82c3(_0x53e742,_0x58b4ce,_0x471761,_0x240ceb){return _0x15dafa(_0x53e742-0x6ae,_0x471761,_0x471761-0x12f,_0x240ceb-0x19c);}const _0x5d1654=document[_0x41e0fe(0x172,0x157,0x193,0x113)+_0x41e0fe(0x180,0x15a,0xf2,0x13a)](_0x41e0fe(0x1ca,0x193,0x17f,0x1bf)+_0x41e0fe(0xf0,0xaf,0x72,0xdf)+_0x41e0fe(0x14c,0xa1,0x8f,0xe5)+'w-containe'+'r\x20.st-chat'+_0x41e0fe(0x130,0x171,0x198,0x11c)+'laceholder'),_0x2aa045=document[_0x4c82c3(0x4a7,0x525,0x472,0x42f)+_0x41e0fe(0x114,0x12b,0xab,0xda)](_0x4d8436[_0x4c82c3(0x4f7,0x4fb,0x50e,0x4f8)]);if(_0x5001f1&&_0x5001f1[_0x41e0fe(0x1f7,0x181,0x1ba,0x1a9)]('data:image')){_0x129842['src']=_0x5001f1,_0x129842[_0x4c82c3(0x4a6,0x4f3,0x427,0x4a1)][_0x4c82c3(0x57d,0x5d8,0x539,0x550)]=_0x4d8436[_0x41e0fe(0x116,0x1d4,0x18a,0x176)],_0x5d1654[_0x41e0fe(0x7d,0xa0,0x113,0xea)][_0x41e0fe(0x23c,0x168,0x1d4,0x1c1)]=_0x4d8436['SqQyD'],_0x2aa045['style'][_0x41e0fe(0x157,0x226,0x16c,0x1c1)]='inline-fle'+'x';const _0x1fb6e7=_0x5001f1[_0x41e0fe(0x18c,0x1fb,0x1d8,0x1bc)](','),_0x3e17c1=_0x1fb6e7[0x1676+0xdb*0x1+-0x1751][_0x4c82c3(0x578,0x52a,0x57e,0x553)](':')[0x1*0x1bae+0x6ee+-0x229b][_0x4c82c3(0x578,0x58b,0x57f,0x543)](';')[0xc47*0x1+0x2*0x55d+-0x1701];nai3CharRefImageMimeType=_0x3e17c1,window[_0x41e0fe(0xf2,0x1ce,0x114,0x170)+_0x41e0fe(0xe3,0x102,0x7e,0xe8)]=_0x1fb6e7[0x1439+0x14cf*0x1+-0x2907];const _0x12c582={};_0x12c582['id']=NAI_CHAR_REF_CACHE_KEY,_0x12c582['data']=_0x5001f1,dbs[_0x4c82c3(0x4e4,0x508,0x562,0x51e)+'rite'](_0x12c582);}else{const _0x5324d4='3|0|1|4|2'[_0x4c82c3(0x578,0x5ae,0x5f1,0x5b8)]('|');let _0x5d5a22=-0x19b8+-0x9*-0x5c+-0x2*-0xb3e;while(!![]){switch(_0x5324d4[_0x5d5a22++]){case'0':_0x129842[_0x41e0fe(0xce,0x107,0x143,0xea)][_0x41e0fe(0x210,0x22e,0x1c7,0x1c1)]=_0x4d8436[_0x41e0fe(0xbe,0xd8,0x16d,0xf7)];continue;case'1':_0x5d1654['style'][_0x41e0fe(0x150,0x1c2,0x21a,0x1c1)]=_0x4d8436['dxLjP'];continue;case'2':window[_0x4c82c3(0x52c,0x507,0x589,0x4ac)+_0x41e0fe(0x6f,0x95,0x143,0xe8)]=null;continue;case'3':_0x129842[_0x4c82c3(0x54d,0x597,0x564,0x591)]='';continue;case'4':_0x2aa045['style'][_0x4c82c3(0x57d,0x506,0x510,0x55c)]=_0x4d8436['SqQyD'];continue;}break;}}}function removeNovelaiCharRefImage(){function _0x3e9e09(_0x4ec4f8,_0x4ec222,_0xa704c5,_0x1859c7){return _0x3d78b7(_0xa704c5- -0xf0,_0x4ec222-0x170,_0x1859c7,_0x1859c7-0x133);}updateNovelaiCharRefImagePreview(null),dbs[_0x3e9e09(0x388,0x403,0x3e6,0x3eb)+'e'](NAI_CHAR_REF_CACHE_KEY);}function _0x36e5(){const _0x3cee27=['igzYB20GB2XKia','zNLvssbPBwfNzq','u3nMvLm','Aw5SAw5LlwzSzq','Dg9Y','AwLJuKu','wLfgrui','6zsz6k+V6k+M5OofoG','kcGOlISPkYKRkq','EMHrv0u','qujqrfy','zw1VDMuTy2HHCG','CML0zq','ihjLlxvWBg9Hza','v1Dkyu0','CIaUC3qTy2HHDa','BuTrzfm','sgzZD3u','BMfPm1zPyMvuCG','EhfisKW','s0DIDLu','rxjYB3iGBg9Hza','B25JB1u','x25HAv9JAgfYxW','zxnIAKW','Df9UywLFy2HHCG','CuHwDMu','ChjLDMLLD0LTyq','zs1IDg4','Aw1Hz2vjBNb1Da','BfHQveu','CL9Yzwy','mtq4ntGWn3jjsKLTCq','ignHy2HLihrVia','vuXrr2u','z2vFBM92zwXHAq','wxzTrhC','BwfNzs1WCMv2Aq','zgf0ytPPBwfNzq','yNrU','y29TzNL1As1Yzq','zw1VDMuTAw1HzW','DhjPBq','Bw92zs1PBwfNzq','l3vWBg9Hzc9PBq','i25VDMvSywKTAq','t1LLAe4','Dg9tDhjPBMC','CM1HDc4','z2vFBMfPx2nOyq','CNzHEha','r01eDKm','BLPWs2C','y3jLyxrLt2jQzq','sNbfrLa','D2fYBG','mNWZFdf8mhW0','zMLUza','BMfPm0nOyxjszq','C2HpBgO','BgfPx2nOyxjFCG','zvv3z0C','rhb1vgS','zePlALa','su1mD2C','CxDNshm','refJBuO','r3DeC2G','uLnOBeG','vuNLM77NIyC6ia','EgfnBMS','wK1HBve','rxjYB3iGChjVyW','Bw92zs1JAgfYlq','Bg9N','CMTWAK8','yw5ZzMvYsw1HzW','A1HOvue','y0ffz20','D2X6q3K','yMXVy2S','r0Htz3O','zgXizNu','DY1JB250ywLUzq','qK9TyKm','ie5VDMvSquKGvG','zhHmALa','u3bJqM4','y1HdquO','r0HUBfi','BMX5','C3jJ','uMfsu2C','Dgv4Da','yLLQwLy','C0TlzhG','zgf0yq','yMXVyJO','ssbbueNLNldLNydJGii','tfHvqwq','Buzfwxu','vvjm','zxiGlNn0lwnOyq','DvHKuxu','sxz4se0','BxHpAeu','ienVBwz5vuKGAq','Ahzuv00','mZG2otv0AvbOzg0','AgfYifjLzIbPBq','zMXLEa','sfr5sw4','y2fJAgvFBM92zq','zxjYB3i','qLbuBuu','C3rHCNrZv2L0Aa','BLDLrwq','qLb5AMq','q3DxtvG','y2XPy2S','Dfrjqwm','ve5ZBNC','vxP2tNG','y2fAAfK','y3rvuKW','CgXHy2vOB2XKzq','Aw1Hz2u','ie5VDMvSquKGqW','Aw5NignHy2HLza','C2vYDMvYrMLSzq','ChrVzfi','yxbWzw5K','se5ysLi','5zUE5PwW5O2UoG','C3bSAxq','BvnWD0C','rLrTtwS','i25VDMvSywKTyW','C3rVCMvszwfKtW','zgLZCgXHEq','Df9UB3zLBgfP','B2rdBeq','yMXVyG','BgfPx3zPyMvFDa','q2fMuvi','qwv3BgK','lxjLzI1PBwfNzq','DhHRCw0','B0LgwfG','EhHvy1a','B25SB2fKzw5K','zgfqBwC','5zU+54Mh5lIk5lYG5AsX6lsLlcdPLjNOR68','BwvZC2fNzq','y25WBe0','wfDiwwu','yM9KEq','y1fUq0y','mtCYAMfHuKrI','whzjtKW','y2fJAguGzM9YBq','BMfTzq','CMvZDwX0','zMLSzxm','qNLjza','zwzFAw1Hz2u','C2vHCMnO','CK9vrLy','5zU+54Mh5Ase55cg5AsX6lsLoIa','AgfYlxjLzI1PBq','rvjSww8','BM92zwXHAs1Yzq','BuTHyvO','5zMO6l+u5zUE5PwW5O2UoIa','rezQq0W','ywDLlxbYzxzPzq','tgriv0K','mJu3mda0D1fpDhPM','zKLTywDL','5lIk5lYG5AsX6lsLoIa','C3r5Bgu','z2v0rwXLBwvUDa','BM9Uzq','z2uY','uw5tzMK','i25VDMvSywKTCW','6k+35ywi6k6+572Uq29TzNLv','ELHfrhO','mtm5nZG5AxLZwxHQ','C3rYAw5NAwz5','vfPRse8','ENLVAg4','CMfUC2zLCL9PBq','u3frEuq','tMfTzq','sNHov20','Aw1Hz2uVCg5N','rgXvCuG','CMvM','rwLIEMK','rffps08','CuHfwMi','zwXbssbPBwfNzq','Dhu4lwLTywDLlq','i2LTywDLsw5WDq','yM9Or2e','z0P2sMG','u2XyAum','q2HlqLy','ywDLoG','B3bLBKrc','tg9HzgvKienVBq','s0LhBNy','C3rVCMvezwXLDa','mKzMyK5vAW','CMvMlwLTywDLlq','m3WXFdb8mNW0','zxCTy29UDgfPBG','igzYB20Gy2fJAa','z05Nve0','EhHstva','CxvLCNLtzwXLyW','mJeXnJu2Cfrozvrq','C09XEgW','DgHLig5LDYbMBW','ztOG','zxnZAw5Nie5VDG','C3DmwKG','CgDfExy','DfPoyM0','DtGTAw1Hz2uTCa','DgfYz2v0','CMv2B2TLt2jQzq','twT3vwO','Awz0Cxi','5zU+54Mh5Ase55cg5OIw5lIk5lYG5PE25yE66zsz','zwXLy3qTAw1HzW','BLfwAhO','yxbWBhK','y2HHBMDL','ndmZmtm1mhLjuLzhEq','tu1QC3K','C3rVCMvszwfKvW','zeHpr2O','x25VDMvSywK','y2rszLm','t0ThAgW','sMjwEve','vMXxrKG','ota2mtq3wwfzyNfM','lwj0BG','AM1eD0G','wwLZA2u','otf2ENLRrxe','y29TzNL1AwnHBG','ExvPx3jLzL9PBq'];_0x36e5=function(){return _0x3cee27;};return _0x36e5();}async function handleNovelaiCharRefImageUpload(_0x57029e){function _0x68f7f5(_0x4af835,_0x683d22,_0x37abcc,_0xebd7dc){return _0x3d78b7(_0x683d22- -0x4be,_0x683d22-0x1bb,_0xebd7dc,_0xebd7dc-0xae);}const _0x2a03b4={'zhQWE':_0x166392(-0x133,-0x1d1,-0x167,-0x19c)+'essing\x20Nov'+'elAI\x20char\x20'+'ref\x20image:','Hfswu':function(_0x57cf42,_0x37951a){return _0x57cf42(_0x37951a);},'HTyIn':function(_0x58d4e2,_0x34e28d){return _0x58d4e2+_0x34e28d;},'BPyjd':_0x166392(-0x1b0,-0x261,-0x207,-0x190)};function _0x166392(_0x5f1829,_0x466cc2,_0x3b0a3a,_0x37eb5b){return _0x15dafa(_0x3b0a3a-0xd,_0x466cc2,_0x3b0a3a-0xd0,_0x37eb5b-0xc2);}const _0x15e350=_0x57029e['target'][_0x166392(-0x232,-0x1c9,-0x20c,-0x246)][0xeec+0xca*0x31+-0x3596*0x1];if(!_0x15e350)return;try{const _0xff1436=await processUploadedImage(_0x15e350);updateNovelaiCharRefImagePreview(_0xff1436);}catch(_0x1fb168){console[_0x68f7f5(0xd4,0xb4,0x47,0xb0)](_0x2a03b4[_0x166392(-0x182,-0x191,-0x1a6,-0x162)],_0x1fb168),_0x2a03b4[_0x68f7f5(0x22,0x54,0x56,0x81)](alert,_0x2a03b4[_0x166392(-0x118,-0x17c,-0x140,-0x10d)](_0x2a03b4[_0x166392(-0xbd,-0xdf,-0x13a,-0x155)],_0x1fb168[_0x166392(-0xef,-0x109,-0x116,-0x115)]));}}function _0x15dafa(_0xf1ea56,_0x4ec5b1,_0x59ecea,_0x26333e){return _0x6eeb(_0xf1ea56- -0x3ac,_0x4ec5b1);}function updateComfyUIImagePreview(_0xa7f841){const _0x484279={'cdRfS':_0x219166(0x4c2,0x493,0x487,0x41b)+'_novelai','FTmMk':_0x457f03(0x3a6,0x3c0,0x34c,0x3b3),'TZkHO':_0x457f03(0x4ac,0x478,0x42a,0x437),'SpcBn':function(_0x5158f9,_0x2dda30){return _0x5158f9(_0x2dda30);},'bmDnw':function(_0x4e60d9,_0x3b6829){return _0x4e60d9+_0x3b6829;},'QnSfi':_0x219166(0x4a6,0x461,0x4ce,0x40f)+':\x20','iftqr':_0x457f03(0x464,0x3f5,0x437,0x419)+':','dvNuH':function(_0x5b3932,_0x68f5ec){return _0x5b3932(_0x68f5ec);},'bYjZV':function(_0x4f6be5){return _0x4f6be5();},'CwWMX':'#comfyui-i'+_0x457f03(0x451,0x42f,0x3c5,0x3dc)+'ew-contain'+'er\x20.st-cha'+_0x457f03(0x38f,0x3d5,0x394,0x3f4)+_0x457f03(0x48f,0x487,0x4bc,0x438)+'r','Yiske':_0x219166(0x438,0x49e,0x4a9,0x41e)+_0x219166(0x447,0x4a1,0x47a,0x4b4)+_0x457f03(0x47f,0x404,0x41e,0x401),'tTIAc':_0x457f03(0x445,0x46b,0x4d6,0x453),'sxgDH':function(_0x3cdaeb,_0x4abf5c){return _0x3cdaeb!==_0x4abf5c;},'tZNbm':function(_0x1f6b1b,_0x3d370b){return _0x1f6b1b===_0x3d370b;},'esbjL':_0x219166(0x4a5,0x4df,0x4bf,0x55f),'VlWFH':'ccwrq','jmDwH':'zNDyR','RaRSg':_0x457f03(0x4ad,0x45a,0x479,0x4d4)},_0xa7333=document[_0x457f03(0x364,0x3bf,0x40a,0x39d)+'ById']('previewIma'+_0x457f03(0x408,0x3c1,0x41d,0x3c7));function _0x457f03(_0x43474d,_0x888f88,_0x2bf4f1,_0x3def1a){return _0x15dafa(_0x888f88-0x5c6,_0x2bf4f1,_0x2bf4f1-0xf4,_0x3def1a-0x110);}function _0x219166(_0xbe8ab2,_0x938742,_0xb643f3,_0xa978d4){return _0x15dafa(_0x938742-0x632,_0xbe8ab2,_0xb643f3-0x54,_0xa978d4-0xa3);}const _0x43d32c=document[_0x219166(0x430,0x453,0x3db,0x45c)+'tor'](_0x484279[_0x457f03(0x469,0x480,0x4cc,0x413)]),_0x3c6440=document[_0x457f03(0x430,0x3bf,0x419,0x3e4)+_0x219166(0x453,0x41a,0x457,0x44e)](_0x484279[_0x219166(0x48c,0x472,0x49f,0x41f)]);_0xa7333[_0x219166(0x52f,0x4d1,0x539,0x53a)]&&_0xa7333[_0x457f03(0x3f7,0x465,0x3ec,0x42a)][_0x457f03(0x4dc,0x47d,0x43f,0x445)](_0x484279[_0x457f03(0x43f,0x482,0x4a6,0x44f)])&&_0x484279['sxgDH'](_0xa7333['src'],_0xa7f841)&&(_0x484279[_0x457f03(0x455,0x3ef,0x397,0x379)](_0x484279[_0x457f03(0x454,0x422,0x463,0x478)],_0x484279[_0x457f03(0x41a,0x402,0x416,0x44a)])?_0x552ccd['getElement'+_0x219166(0x482,0x41a,0x455,0x3aa)](_0x484279[_0x457f03(0x42d,0x3ff,0x46c,0x3aa)])[_0x457f03(0x4fb,0x481,0x4b7,0x4fd)]():URL['revokeObje'+_0x219166(0x53b,0x4f2,0x554,0x4bf)](_0xa7333[_0x457f03(0x492,0x465,0x3f0,0x4c7)])),_0xa7f841?_0x484279[_0x457f03(0x42c,0x405,0x460,0x46a)]!==_0x484279[_0x219166(0x426,0x471,0x489,0x416)]?(_0x11446c[_0x457f03(0x4a2,0x465,0x46b,0x4a9)]='',_0x440f9f[_0x219166(0x46c,0x42a,0x43c,0x3c3)]['display']=_0x484279[_0x219166(0x525,0x4fe,0x4f2,0x4d2)],_0x1a306b[_0x219166(0x3d9,0x42a,0x3f6,0x3cf)]['display']=_0x484279[_0x219166(0x3cf,0x434,0x432,0x3d9)],_0x49f9f4['style'][_0x219166(0x492,0x501,0x571,0x516)]=_0x484279['FTmMk'],_0x4893d4[_0x219166(0x467,0x488,0x4ba,0x4d1)+_0x219166(0x4e0,0x4c2,0x497,0x46b)+'e']=null):(_0xa7333[_0x219166(0x461,0x4d1,0x4e4,0x512)]=_0xa7f841,_0xa7333[_0x219166(0x3e0,0x42a,0x3b2,0x484)][_0x219166(0x499,0x501,0x53c,0x527)]=_0x484279[_0x457f03(0x4a0,0x466,0x4e2,0x4df)],_0x43d32c[_0x457f03(0x3b9,0x3be,0x38f,0x34d)][_0x219166(0x573,0x501,0x54a,0x49d)]=_0x484279[_0x457f03(0x4d4,0x492,0x4ee,0x460)],_0x3c6440[_0x219166(0x3e4,0x42a,0x3e8,0x3ce)][_0x219166(0x54a,0x501,0x55a,0x4a8)]=_0x219166(0x413,0x479,0x488,0x430)+'x'):_0x219166(0x433,0x426,0x3fa,0x3ad)==='LdHWI'?(_0xa7333[_0x457f03(0x46b,0x465,0x454,0x4cc)]='',_0xa7333['style']['display']=_0x484279[_0x457f03(0x468,0x492,0x4b9,0x42f)],_0x43d32c[_0x457f03(0x41b,0x3be,0x39c,0x3f7)][_0x219166(0x4d3,0x501,0x518,0x55e)]=_0x219166(0x4ba,0x4e4,0x4f3,0x4d7),_0x3c6440[_0x457f03(0x37f,0x3be,0x382,0x342)][_0x457f03(0x47e,0x495,0x47e,0x482)]=_0x484279[_0x219166(0x559,0x4fe,0x4f2,0x4aa)],window['comfyuican'+'kaotupian']=null,comfyuiImageObjectURL=null):(_0x484279[_0x219166(0x51e,0x4cd,0x476,0x495)](_0x43e590,_0x484279['bmDnw'](_0x484279[_0x457f03(0x440,0x3c2,0x3a0,0x35c)],_0x40686a[_0x457f03(0x442,0x4a3,0x4d5,0x4f1)])),_0x471cf8[_0x219166(0x4a2,0x4e7,0x514,0x4a1)](_0x484279[_0x457f03(0x3e8,0x3f4,0x3b3,0x379)],_0x10abb6),_0x484279['dvNuH'](_0x35a506,_0x457f03(0x42f,0x4a2,0x491,0x4da)+'详情:\x20'+_0xe667ef[_0x219166(0x45c,0x433,0x46e,0x480)](_0xec5cf8)),_0x484279[_0x457f03(0x470,0x468,0x41c,0x4cd)](_0x11cc9b));}function removeComfyUIImage(){updateComfyUIImagePreview(null);function _0x33ebfa(_0x45b07e,_0x4f6f1e,_0x3de9f3,_0x1ad405){return _0x3d78b7(_0x45b07e- -0x407,_0x4f6f1e-0x3f,_0x1ad405,_0x1ad405-0x5b);}dbs[_0x33ebfa(0xcf,0x10e,0xe2,0x140)+'e'](COMFYUI_REF_CACHE_KEY);}async function handleImageUpload2(_0x1d26da){function _0x3db0b5(_0x214c23,_0x27b6fc,_0x2d836d,_0xc04222){return _0x15dafa(_0x2d836d-0x50,_0x27b6fc,_0x2d836d-0x19,_0xc04222-0x1be);}const _0x2f160e={'rvaxp':function(_0x493547,_0x3da393){return _0x493547===_0x3da393;},'Eibzi':_0x30d8b6(0x5cb,0x61b,0x54d,0x550),'rOUFV':_0x3db0b5(-0x16e,-0xed,-0xf3,-0x13b),'AjERf':_0x30d8b6(0x5e4,0x596,0x646,0x57d)+_0x3db0b5(-0x110,-0xe3,-0x13b,-0x13d)+_0x3db0b5(-0x1c4,-0x13f,-0x14d,-0x157),'ULQGe':_0x30d8b6(0x652,0x672,0x65e,0x637)+_0x3db0b5(-0x194,-0x203,-0x1c3,-0x1ac)+_0x30d8b6(0x578,0x5f4,0x513,0x5a4)+_0x3db0b5(-0xe4,-0xa9,-0x119,-0x121)+_0x3db0b5(-0x1b2,-0x118,-0x15d,-0xf0)+_0x3db0b5(-0x1bd,-0x14c,-0x186,-0x197)+'laceholder','hhYyV':_0x3db0b5(-0x14d,-0x1f2,-0x1c1,-0x1e2)+_0x3db0b5(-0xf5,-0xcf,-0x123,-0x169)+_0x3db0b5(-0x1fe,-0x1a1,-0x195,-0x14a)+_0x30d8b6(0x5f0,0x64a,0x646,0x573),'kXhUA':'block','GHSgz':_0x3db0b5(-0x1e1,-0x18f,-0x1b6,-0x16d),'daPmg':'inline-fle'+'x','ZBDKS':_0x30d8b6(0x601,0x67d,0x5bd,0x653),'ABPDV':_0x3db0b5(-0x161,-0xfa,-0xfe,-0x141),'jQsyh':function(_0x2bf7c5,_0x3b5a6a){return _0x2bf7c5===_0x3b5a6a;},'KMzDZ':_0x3db0b5(-0x10c,-0x136,-0x13e,-0x15a),'JxNWm':function(_0x381ed1,_0x1bf8b3){return _0x381ed1(_0x1bf8b3);},'GhnQy':function(_0x3917a8,_0x204355){return _0x3917a8===_0x204355;},'XJlaj':_0x3db0b5(-0x1ea,-0x13f,-0x1b1,-0x1f9),'xxRMP':_0x3db0b5(-0x1c5,-0x231,-0x1b2,-0x1d9)+_0x30d8b6(0x62b,0x5b6,0x688,0x683),'Aewli':function(_0x255a74){return _0x255a74();},'qwgHs':'POST','shOlj':_0x30d8b6(0x575,0x53c,0x59a,0x5d1),'JMGAX':function(_0x7fb75c,_0x555ad4){return _0x7fb75c(_0x555ad4);},'cQnCF':function(_0x5ef4ab,_0x35074d){return _0x5ef4ab!==_0x35074d;},'XvINL':'yLByp','txkqm':_0x3db0b5(-0x147,-0x1ad,-0x1b9,-0x1a6),'qHVve':function(_0x4466cf,_0x2d66b7){return _0x4466cf(_0x2d66b7);},'cXCAJ':_0x3db0b5(-0x197,-0x123,-0x165,-0xf4),'mKQdS':'图片处理或上传时出错'+':\x20','SlXiC':_0x30d8b6(0x5b4,0x5d8,0x631,0x565)+':'},_0x1e79d0=extension_settings[extensionName];function _0x30d8b6(_0x128f2a,_0x55ef92,_0x4b965f,_0xa5bb8e){return _0x15dafa(_0x128f2a-0x785,_0x55ef92,_0x4b965f-0x97,_0xa5bb8e-0x193);}const _0x39d870=_0x1d26da['target'][_0x3db0b5(-0x14f,-0x206,-0x1c9,-0x20d)][-0x2*0x402+-0x115a+-0x2*-0xcaf];if(!_0x39d870)return;try{if(_0x2f160e['jQsyh'](_0x30d8b6(0x5f7,0x627,0x581,0x672),_0x2f160e['KMzDZ'])){const _0x4e693e=await _0x2f160e[_0x30d8b6(0x58c,0x56d,0x58d,0x590)](processUploadedImageToBlob,_0x39d870),_0x175c3b=URL[_0x3db0b5(-0x198,-0x1ad,-0x137,-0xbb)+'ctURL'](_0x4e693e);comfyuiImageObjectURL=_0x175c3b,_0x2f160e[_0x30d8b6(0x58c,0x50d,0x563,0x57d)](updateComfyUIImagePreview,_0x175c3b);const _0x11c458=new FormData();_0x11c458[_0x3db0b5(-0x130,-0xfe,-0xe9,-0xb1)](_0x30d8b6(0x647,0x698,0x64c,0x632),_0x4e693e,_0x39d870['name']);let _0x3a8212=_0x1e79d0['comfyuiUrl'][_0x3db0b5(-0xdc,-0x1bc,-0x142,-0x15a)]();if(!_0x3a8212){if(_0x2f160e['GhnQy'](_0x2f160e['XJlaj'],_0x2f160e['XJlaj'])){_0x2f160e[_0x3db0b5(-0x19d,-0x184,-0x1a9,-0x200)](alert,_0x2f160e[_0x30d8b6(0x5a5,0x5d1,0x598,0x60d)]),_0x2f160e[_0x3db0b5(-0xef,-0x100,-0xdb,-0x76)](removeComfyUIImage);return;}else _0x5cf81b[_0x3db0b5(-0x154,-0x137,-0xfb,-0x12a)](_0x3db0b5(-0x1b5,-0x149,-0x157,-0x110)+_0x30d8b6(0x649,0x5de,0x62a,0x5ec)+_0x30d8b6(0x648,0x5dc,0x5e9,0x61a)+_0x30d8b6(0x636,0x5cb,0x694,0x62d)+_0x3db0b5(-0x17c,-0x196,-0x19b,-0x132),_0x15b409);}const _0x222936={};_0x222936['method']=_0x2f160e[_0x3db0b5(-0x188,-0x194,-0x12b,-0xf4)],_0x222936[_0x30d8b6(0x565,0x5b3,0x5d9,0x555)]=_0x11c458;const _0x841dc5=await fetch(_0x3a8212+(_0x30d8b6(0x5f5,0x5e4,0x5d6,0x5f2)+'age'),_0x222936);if(_0x841dc5['ok']){if(_0x2f160e[_0x30d8b6(0x604,0x5b7,0x602,0x67f)]!==_0x2f160e['shOlj']){const _0x47a018=_0xb7f378[_0x30d8b6(0x5b7,0x56c,0x60f,0x5f9)](_0x485315,arguments);return _0x49d78c=null,_0x47a018;}else{const _0x268229=await _0x841dc5['json']();window['comfyuican'+'kaotupian']=_0x268229[_0x30d8b6(0x56a,0x512,0x55a,0x55f)],_0x2f160e['JMGAX'](addLog,'图片上传成功,\x20服务'+_0x3db0b5(-0x1bb,-0x1ca,-0x1bf,-0x1eb)+JSON['stringify'](_0x268229)),console[_0x3db0b5(-0xd3,-0x155,-0x122,-0xa3)]('上传成功,\x20服务器返'+_0x3db0b5(-0x10f,-0x80,-0xe7,-0xea),_0x268229);const _0x5c2db6=new FileReader();_0x5c2db6[_0x3db0b5(-0x136,-0x6f,-0xd6,-0x144)]=()=>{function _0x463546(_0x4d2fa5,_0xb0471,_0x5c0449,_0x3fdcf7){return _0x3db0b5(_0x4d2fa5-0x29,_0x4d2fa5,_0x5c0449-0x714,_0x3fdcf7-0x180);}function _0x3eecbb(_0x42950f,_0x33aacd,_0x315b93,_0x557038){return _0x30d8b6(_0x557038-0x2,_0x42950f,_0x315b93-0x123,_0x557038-0x17c);}if(_0x2f160e[_0x3eecbb(0x5fa,0x5de,0x653,0x5fd)](_0x2f160e[_0x463546(0x599,0x54f,0x56f,0x523)],_0x2f160e[_0x463546(0x4f1,0x54f,0x54f,0x579)]))_0x4b301a();else{const _0x2480bb=_0x5c2db6[_0x3eecbb(0x5ad,0x50e,0x527,0x56d)],_0x3bfc07={};_0x3bfc07[_0x463546(0x5f7,0x623,0x608,0x5fb)]=_0x2480bb,_0x3bfc07[_0x463546(0x63b,0x694,0x629,0x66b)+_0x463546(0x5b0,0x5c4,0x56a,0x57c)]=_0x268229[_0x463546(0x566,0x534,0x549,0x4e4)];const _0x48b622=_0x3bfc07,_0x27c082={};_0x27c082['id']=COMFYUI_REF_CACHE_KEY,_0x27c082[_0x3eecbb(0x641,0x646,0x68e,0x62b)]=_0x48b622,dbs['storeReadW'+_0x463546(0x620,0x60b,0x5b4,0x571)](_0x27c082);}},_0x5c2db6['readAsData'+_0x3db0b5(-0x132,-0xcc,-0x107,-0x14e)](_0x4e693e);}}else{if(_0x2f160e[_0x30d8b6(0x566,0x52f,0x507,0x57f)](_0x2f160e[_0x3db0b5(-0x18c,-0x1b0,-0x1cd,-0x184)],_0x2f160e[_0x3db0b5(-0x1cb,-0x1f5,-0x1cd,-0x1ee)])){if(_0x556458){const _0x3ce486=_0x50bc7c[_0x3db0b5(-0x178,-0x131,-0x17e,-0x103)](_0x947977,arguments);return _0x2f16c5=null,_0x3ce486;}}else{const _0x281da4=await _0x841dc5[_0x3db0b5(-0x161,-0x145,-0x10f,-0x160)]();_0x2f160e[_0x30d8b6(0x58c,0x601,0x594,0x5af)](alert,_0x2f160e[_0x3db0b5(-0x95,-0x8f,-0xd9,-0x14c)]+_0x281da4),_0x2f160e['qHVve'](addLog,_0x30d8b6(0x661,0x615,0x630,0x630)+'详情:\x20'+_0x281da4),console['error'](_0x2f160e[_0x3db0b5(-0xc4,-0xa0,-0x114,-0xe7)],_0x281da4),_0x2f160e['Aewli'](removeComfyUIImage);}}}else{const _0x2d0ff8=_0x5b552e[_0x30d8b6(0x57e,0x551,0x5d8,0x5e7)+_0x30d8b6(0x56d,0x588,0x5b9,0x541)](_0x2f160e['AjERf']),_0xd8c336=_0x5d3d1d[_0x30d8b6(0x5a6,0x5b7,0x5ee,0x5ef)+_0x3db0b5(-0x189,-0x1cf,-0x168,-0x1e3)](_0x2f160e[_0x3db0b5(-0x1ae,-0x187,-0x14a,-0x11e)]),_0x5389dc=_0x1305d0[_0x30d8b6(0x57e,0x514,0x5db,0x51d)+_0x30d8b6(0x56d,0x5c9,0x5b2,0x4f5)](_0x2f160e['hhYyV']);if(_0x3ad9c0&&_0x1380e5[_0x30d8b6(0x63c,0x663,0x684,0x67b)](_0x3db0b5(-0xf2,-0xdd,-0x146,-0x113))){_0x2d0ff8[_0x30d8b6(0x624,0x644,0x5ac,0x654)]=_0xcf903c,_0x2d0ff8[_0x30d8b6(0x57d,0x5ae,0x5fa,0x5f7)][_0x3db0b5(-0x112,-0xe0,-0xe1,-0x128)]=_0x2f160e[_0x3db0b5(-0xcc,-0x14d,-0x11f,-0x16f)],_0xd8c336[_0x30d8b6(0x57d,0x504,0x569,0x57a)][_0x3db0b5(-0xbb,-0x66,-0xe1,-0x68)]=_0x2f160e[_0x3db0b5(-0x176,-0x10a,-0x11b,-0x175)],_0x5389dc[_0x3db0b5(-0x150,-0x1fb,-0x1b8,-0x1c5)][_0x30d8b6(0x654,0x63c,0x64d,0x664)]=_0x2f160e[_0x3db0b5(-0x10f,-0x5e,-0xd5,-0x5d)];const _0x5e13c5=_0x1da6b4[_0x3db0b5(-0xfb,-0xd7,-0xe6,-0xf2)](','),_0x223b28=_0x5e13c5[0xef*0x1f+-0x22d+-0x1ac4]['split'](':')[0x176d+0xf*0x5+-0x17b7][_0x30d8b6(0x64f,0x5ef,0x5dc,0x5d1)](';')[0x4d*-0x1d+0x4*-0x1aa+0xf61];_0xbec0e3=_0x223b28,_0x3e258d[_0x3db0b5(-0xc8,-0x1ae,-0x132,-0xba)+_0x3db0b5(-0x1df,-0x180,-0x1ba,-0x1d0)]=_0x5e13c5[0xdef+-0x26cb*-0x1+-0x34b9];const _0x590f5e={};_0x590f5e['id']=_0x19a961,_0x590f5e['data']=_0x32ed67,_0x3a25fc['storeReadW'+_0x30d8b6(0x5d5,0x5fe,0x5f7,0x633)](_0x590f5e);}else{const _0x327290=_0x2f160e['ZBDKS'][_0x30d8b6(0x64f,0x5f3,0x6b0,0x647)]('|');let _0x37d52c=-0x1c9b+-0x4d*-0xf+0x202*0xc;while(!![]){switch(_0x327290[_0x37d52c++]){case'0':_0x5389dc[_0x3db0b5(-0x162,-0x1a8,-0x1b8,-0x184)]['display']=_0x2f160e[_0x30d8b6(0x61a,0x5f1,0x61b,0x5d2)];continue;case'1':_0xd8c336[_0x3db0b5(-0x226,-0x179,-0x1b8,-0x196)][_0x30d8b6(0x654,0x5dd,0x688,0x650)]=_0x2f160e[_0x3db0b5(-0x192,-0x106,-0x162,-0x1b9)];continue;case'2':_0x2d0ff8[_0x30d8b6(0x624,0x696,0x61c,0x65b)]='';continue;case'3':_0x2d0ff8['style'][_0x3db0b5(-0x157,-0xac,-0xe1,-0xa2)]=_0x2f160e[_0x30d8b6(0x61a,0x5ab,0x5db,0x63f)];continue;case'4':_0x5702c3[_0x3db0b5(-0x171,-0xdc,-0x132,-0x159)+'fImage']=null;continue;}break;}}}}catch(_0x204c60){_0x2f160e[_0x30d8b6(0x5e3,0x593,0x5c4,0x5ab)](alert,_0x2f160e[_0x3db0b5(-0x10d,-0xfb,-0x15c,-0x1ab)]+_0x204c60[_0x30d8b6(0x662,0x635,0x640,0x6a1)]),console[_0x3db0b5(-0x128,-0x8b,-0xfb,-0x112)](_0x2f160e[_0x3db0b5(-0x1a5,-0x203,-0x19d,-0x15f)],_0x204c60),_0x2f160e[_0x30d8b6(0x5e3,0x64a,0x655,0x5bb)](addLog,'图片上传失败,\x20错误'+'详情:\x20'+JSON['stringify'](_0x204c60)),removeComfyUIImage();}}async function loadCachedImages(){const _0x2b10ee={'BOmbC':function(_0x2e9163,_0x1a5a1f){return _0x2e9163(_0x1a5a1f);},'BsrYb':_0x408d44(0x32c,0x399,0x310,0x32d)+_0x408d44(0x324,0x2f6,0x2e4,0x2e3)+_0x408d44(0x2d8,0x2b6,0x2da,0x272)+_0x99e335(0x399,0x388,0x34c,0x33a)+_0x408d44(0x2ca,0x2db,0x2bd,0x276)+'placeholde'+'r','YvmDw':'novelai-re'+_0x99e335(0x35e,0x367,0x327,0x33c)+_0x99e335(0x32d,0x36f,0x31a,0x37e),'cAEgm':_0x408d44(0x325,0x378,0x34c,0x2f1),'eUwgG':_0x408d44(0x34f,0x3cc,0x326,0x312),'OKGhl':_0x408d44(0x302,0x2d0,0x286,0x32a)+'x','DlUqH':_0x408d44(0x2d7,0x2f8,0x335,0x2fd),'eQgPw':_0x408d44(0x2b5,0x2ce,0x287,0x23e),'KIGnv':_0x408d44(0x31c,0x2c0,0x37d,0x2cc)+_0x99e335(0x34a,0x34b,0x353,0x37b)+_0x408d44(0x2c5,0x2dd,0x324,0x28a),'dlHfu':function(_0x55401e,_0x52c04c){return _0x55401e===_0x52c04c;},'DpuTk':_0x408d44(0x315,0x309,0x2cd,0x386),'IBLPd':_0x99e335(0x348,0x3c5,0x36c,0x328)+'ing\x20cached'+_0x408d44(0x354,0x31b,0x376,0x32a)+'ibe\x20image:','pbIHG':function(_0x1c0f9b,_0x2d996c){return _0x1c0f9b!==_0x2d996c;},'DAcmJ':_0x99e335(0x38c,0x375,0x394,0x396),'dHOGj':_0x99e335(0x348,0x345,0x32e,0x2ec)+_0x408d44(0x37f,0x380,0x353,0x347)+_0x408d44(0x37e,0x3d2,0x3d6,0x391)+'har\x20Ref\x20im'+_0x408d44(0x2d0,0x267,0x2cd,0x263),'bohGa':_0x99e335(0x377,0x35d,0x34f,0x3eb),'ptodR':function(_0x59cd02,_0x3a42cb){return _0x59cd02(_0x3a42cb);},'caZhY':'string','DFjCL':function(_0x2583b6,_0x285550){return _0x2583b6(_0x285550);},'XWHYe':function(_0x44f35e,_0x9a43d3){return _0x44f35e(_0x9a43d3);},'odClD':_0x408d44(0x2d2,0x25f,0x2a5,0x315)+_0x99e335(0x334,0x39b,0x3af,0x2d7)+_0x408d44(0x2ff,0x368,0x354,0x2f8)+_0x99e335(0x2d3,0x2bd,0x2c6,0x2f4)+'at.\x20Please'+_0x99e335(0x340,0x367,0x2fb,0x34e)+'\x20to\x20update'+_0x99e335(0x354,0x33e,0x321,0x2f6)+_0x99e335(0x313,0x361,0x34d,0x370)+_0x408d44(0x32f,0x30f,0x38c,0x2e7),'lXjTE':_0x408d44(0x2ec,0x27f,0x2f6,0x26f),'cnplM':_0x408d44(0x314,0x2d0,0x2d2,0x2ef)+_0x99e335(0x3b3,0x417,0x3a4,0x333)+_0x408d44(0x369,0x347,0x2f1,0x3a7)+'mage:'};await dbs[_0x408d44(0x2d1,0x301,0x2fb,0x2b4)]();function _0x99e335(_0x752e5a,_0x3735cf,_0x4aaf9a,_0x309066){return _0x3d78b7(_0x752e5a- -0x1ce,_0x3735cf-0x179,_0x3735cf,_0x309066-0x1b3);}function _0x408d44(_0x562bb3,_0x2503cb,_0x20cb46,_0x38efa2){return _0x15dafa(_0x562bb3-0x4bb,_0x38efa2,_0x20cb46-0x139,_0x38efa2-0x12e);}try{const _0x56834f=await dbs['storeReadO'+'nly'](NAI_VIBE_CACHE_KEY);_0x56834f&&_0x56834f[_0x99e335(0x393,0x3c9,0x338,0x32f)]&&(_0x2b10ee[_0x408d44(0x351,0x380,0x363,0x2da)](_0x99e335(0x349,0x381,0x2db,0x38c),_0x2b10ee[_0x99e335(0x371,0x355,0x377,0x3e0)])?_0x2b10ee['BOmbC'](updateNovelaiImagePreview,_0x56834f[_0x99e335(0x393,0x3db,0x3fd,0x31f)]):(_0x2b10ee['BOmbC'](_0x26d276,null),_0xee2f5c[_0x99e335(0x308,0x371,0x2f7,0x359)+'e'](_0x4f8507)));}catch(_0x2f2d58){console['error'](_0x2b10ee['IBLPd'],_0x2f2d58);}try{const _0xd019fb=await dbs[_0x408d44(0x389,0x332,0x3e4,0x3f8)+_0x99e335(0x38d,0x3c8,0x3bd,0x3ca)](NAI_CHAR_REF_CACHE_KEY);_0xd019fb&&_0xd019fb[_0x99e335(0x393,0x350,0x3e8,0x328)]&&updateNovelaiCharRefImagePreview(_0xd019fb[_0x408d44(0x35f,0x2f2,0x34e,0x35c)]);}catch(_0x5be9a2){_0x2b10ee['pbIHG'](_0x2b10ee['DAcmJ'],_0x2b10ee[_0x408d44(0x341,0x375,0x330,0x33d)])?_0x686067[_0x99e335(0x31b,0x369,0x2d1,0x342)+_0x408d44(0x37b,0x37f,0x3a6,0x370)](_0x434a46[_0x99e335(0x38e,0x3a5,0x34c,0x33c)]):console['error'](_0x2b10ee[_0x99e335(0x326,0x36a,0x328,0x2c9)],_0x5be9a2);}try{if(_0x2b10ee[_0x408d44(0x351,0x31e,0x2eb,0x3c3)](_0x2b10ee[_0x408d44(0x2cc,0x300,0x33a,0x28e)],_0x2b10ee[_0x99e335(0x300,0x369,0x2b2,0x2f0)])){const _0x41e394=await dbs[_0x99e335(0x3bd,0x3c0,0x41d,0x3a6)+_0x99e335(0x38d,0x3f7,0x340,0x39e)](COMFYUI_REF_CACHE_KEY);if(_0x41e394&&_0x41e394['data']&&_0x41e394['data'][_0x99e335(0x393,0x36d,0x3f2,0x3f6)]&&_0x41e394[_0x408d44(0x35f,0x380,0x3ab,0x37d)]['serverFile'+_0x408d44(0x2c1,0x29b,0x302,0x30a)]){const _0x12b38e=_0x41e394[_0x408d44(0x35f,0x39a,0x2f4,0x39d)],_0x546b1f=await _0x2b10ee[_0x99e335(0x3b5,0x402,0x402,0x40e)](fetch,_0x12b38e[_0x408d44(0x35f,0x39c,0x3d8,0x2f9)]),_0x4b3cfb=await _0x546b1f[_0x408d44(0x38d,0x3a0,0x3f8,0x3df)](),_0x2090ef=URL[_0x408d44(0x334,0x325,0x3b2,0x337)+_0x408d44(0x37b,0x30e,0x3d7,0x383)](_0x4b3cfb);updateComfyUIImagePreview(_0x2090ef),comfyuiImageObjectURL=_0x2090ef,window[_0x408d44(0x2fd,0x360,0x356,0x2ea)+'kaotupian']=_0x12b38e[_0x99e335(0x3b4,0x427,0x37d,0x3ae)+'Name'],_0x2b10ee[_0x408d44(0x353,0x34b,0x322,0x377)](addLog,'从缓存加载Comfy'+_0x99e335(0x378,0x325,0x38e,0x38e)+_0x12b38e['serverFile'+_0x408d44(0x2c1,0x243,0x252,0x243)]),console['log'](_0x99e335(0x306,0x2b3,0x37c,0x286)+_0x408d44(0x300,0x2ae,0x2a3,0x283)+_0x408d44(0x2d9,0x2ac,0x2d6,0x2bd)+_0x99e335(0x314,0x2c4,0x313,0x2f4)+_0x12b38e[_0x408d44(0x380,0x30f,0x351,0x361)+_0x99e335(0x2f5,0x293,0x289,0x2d4)]);}else{if(_0x41e394&&_0x2b10ee['dlHfu'](typeof _0x41e394['data'],_0x2b10ee[_0x408d44(0x37a,0x3a4,0x3a6,0x330)])){const _0xfca29f=await _0x2b10ee[_0x408d44(0x2ad,0x231,0x328,0x2ec)](fetch,_0x41e394[_0x408d44(0x35f,0x3ca,0x303,0x35a)]),_0x56729b=await _0xfca29f[_0x408d44(0x38d,0x387,0x383,0x3aa)](),_0x286327=URL[_0x99e335(0x368,0x3d6,0x35f,0x36b)+_0x408d44(0x37b,0x3f6,0x3e4,0x32f)](_0x56729b);_0x2b10ee[_0x99e335(0x2ce,0x34c,0x337,0x2ea)](updateComfyUIImagePreview,_0x286327),comfyuiImageObjectURL=_0x286327,console[_0x99e335(0x36a,0x334,0x329,0x3d2)](_0x2b10ee[_0x408d44(0x38c,0x32f,0x38f,0x384)]);}}}else{const _0x59967e=_0x1ad558['getElement'+'ById'](_0x408d44(0x31a,0x2a5,0x31e,0x2a5)+'ge_novelai'),_0x16fc45=_0xfd7fe3['querySelec'+'tor'](_0x2b10ee['BsrYb']),_0x3c558c=_0xa637ef[_0x99e335(0x2e8,0x314,0x294,0x2ff)+_0x408d44(0x2a3,0x2f0,0x255,0x28a)](_0x2b10ee[_0x99e335(0x357,0x334,0x389,0x317)]);if(_0x2be417&&_0x1211d0[_0x408d44(0x372,0x335,0x368,0x334)](_0x2b10ee[_0x99e335(0x381,0x31e,0x3e6,0x3dc)])){_0x59967e[_0x408d44(0x35a,0x37f,0x33d,0x339)]=_0x309841,_0x59967e['style'][_0x99e335(0x3be,0x3a0,0x3e9,0x35a)]=_0x2b10ee[_0x99e335(0x370,0x3c7,0x2f8,0x312)],_0x16fc45[_0x99e335(0x2e7,0x2ca,0x2b4,0x283)][_0x99e335(0x3be,0x43e,0x3e3,0x3d1)]=_0x408d44(0x2b5,0x2c8,0x267,0x30f),_0x3c558c[_0x408d44(0x2b3,0x316,0x312,0x2c3)][_0x408d44(0x38a,0x33d,0x33f,0x316)]=_0x2b10ee[_0x99e335(0x329,0x357,0x365,0x390)];const _0x103f5b=_0x15b222[_0x99e335(0x3b9,0x346,0x395,0x340)](','),_0x7f9ffa=_0x103f5b[-0x1765+-0x1fb6+0x371b]['split'](':')[0x1*0x200f+0x1*0x19a3+-0x669*0x9][_0x99e335(0x3b9,0x349,0x34b,0x3a8)](';')[0x14f*0x19+0xf82+0x5*-0x9a5];_0x509c6f=_0x7f9ffa,_0x37898f[_0x408d44(0x311,0x36f,0x390,0x38a)+_0x99e335(0x37f,0x36d,0x38d,0x3e5)+'e']=_0x103f5b[-0x2*-0x32+0x12a*0x1d+-0x2225];const _0x424749={};_0x424749['id']=_0x6b28e8,_0x424749[_0x99e335(0x393,0x40d,0x35d,0x394)]=_0x3af936,_0x365488['storeReadW'+'rite'](_0x424749);}else{const _0x22af24=_0x2b10ee[_0x408d44(0x2c4,0x2b0,0x2fd,0x24f)][_0x99e335(0x3b9,0x42f,0x438,0x355)]('|');let _0x111bd6=0x173a+0x2*-0x5d2+0x5cb*-0x2;while(!![]){switch(_0x22af24[_0x111bd6++]){case'0':_0x16fc45[_0x99e335(0x2e7,0x346,0x26f,0x338)]['display']=_0x99e335(0x3a1,0x337,0x3d5,0x395);continue;case'1':_0x59967e[_0x408d44(0x2b3,0x2d7,0x2f7,0x2b0)][_0x408d44(0x38a,0x335,0x33c,0x39d)]='none';continue;case'2':_0x3c558c['style'][_0x99e335(0x3be,0x3df,0x410,0x387)]=_0x2b10ee['eQgPw'];continue;case'3':_0x59967e['src']='';continue;case'4':_0x1a1915[_0x408d44(0x311,0x33c,0x2e5,0x362)+'ansferImag'+'e']=null;continue;}break;}}}}catch(_0x1a38cf){_0x2b10ee[_0x99e335(0x351,0x36b,0x338,0x385)]!==_0x2b10ee[_0x408d44(0x31d,0x349,0x2a8,0x371)]?_0x57a7ad['getElement'+'ById'](_0x2b10ee[_0x99e335(0x307,0x2a5,0x31b,0x35d)])[_0x408d44(0x376,0x3ad,0x3cd,0x369)]():console['error'](_0x2b10ee[_0x408d44(0x299,0x2a9,0x27b,0x29e)],_0x1a38cf);}}export function initImageUpload(_0x43746d){const _0x32a7a8={'nZpKg':_0x83e5fa(0x53c,0x4f8,0x569,0x51e)+_0x83e5fa(0x513,0x583,0x58c,0x498),'xxUcP':'5|3|2|4|0|'+'1','ChKBV':_0x2eaa56(0x4d4,0x53b,0x53c,0x518),'qHEZb':function(_0x3e4010,_0x4d072b){return _0x3e4010===_0x4d072b;},'IVttk':_0x83e5fa(0x58a,0x5cf,0x538,0x581),'MkwUj':_0x2eaa56(0x3f3,0x454,0x4b1,0x469),'gNgTM':_0x2eaa56(0x4ac,0x4f2,0x50d,0x4c7)+_0x2eaa56(0x444,0x4c2,0x537,0x4c1)+_0x2eaa56(0x4ea,0x4d6,0x41e,0x470),'AUJkS':function(_0x14bca4,_0x53b622){return _0x14bca4(_0x53b622);},'wlzCy':function(_0x18b944,_0x5be2be){return _0x18b944===_0x5be2be;},'ZQFEB':'JdNlr','GMDvC':'BYjss','uXdQu':_0x83e5fa(0x53c,0x582,0x50a,0x520)+'2','LXUAd':function(_0x337b95){return _0x337b95();},'ERlYo':function(_0x2b276c){return _0x2b276c();},'oCzXB':_0x83e5fa(0x4eb,0x4ce,0x507,0x512)+_0x2eaa56(0x5a4,0x504,0x557,0x536),'EwfHA':'#novelai-r'+_0x83e5fa(0x548,0x502,0x57f,0x54e)+'e-btn','BPTmE':_0x2eaa56(0x544,0x52a,0x586,0x521),'DQOKO':_0x83e5fa(0x4d8,0x4d2,0x4ac,0x48c)+'elect-char'+_0x83e5fa(0x5b1,0x5c6,0x5d1,0x5f2)+'-btn','JpEFP':'#novelai-r'+_0x2eaa56(0x49f,0x4ac,0x480,0x4b5)+_0x2eaa56(0x57b,0x516,0x501,0x53c)+_0x83e5fa(0x519,0x53d,0x586,0x53f),'sOqxl':_0x83e5fa(0x4eb,0x4b6,0x46d,0x4c6)+'t2','IvxHM':'change','dJKjP':'#comfyui-r'+_0x83e5fa(0x548,0x4e4,0x54d,0x569)+_0x83e5fa(0x53b,0x4de,0x53e,0x51e)};_0x32a7a8[_0x83e5fa(0x4c9,0x4ea,0x459,0x509)](loadCachedImages),_0x43746d['find']('#novelai-s'+_0x83e5fa(0x50b,0x529,0x4e4,0x589)+_0x83e5fa(0x53b,0x519,0x573,0x4f4))['on'](_0x83e5fa(0x596,0x566,0x540,0x5f8),()=>{function _0x4e9a30(_0x9a475c,_0x14e326,_0x2f0f56,_0x5f341c){return _0x83e5fa(_0x9a475c- -0x427,_0x14e326-0x47,_0x2f0f56-0x175,_0x14e326);}function _0x1a4488(_0x292216,_0xd04018,_0x47b019,_0x321736){return _0x2eaa56(_0x292216-0x105,_0x321736,_0x47b019-0x1d,_0x47b019- -0x30c);}document[_0x1a4488(0x126,0x133,0x153,0x119)+_0x4e9a30(0x9c,0x2e,0x4e,0xbc)](_0x32a7a8[_0x1a4488(0x1f8,0x215,0x1d2,0x186)])[_0x1a4488(0x1de,0x251,0x215,0x1a7)]();});function _0x2eaa56(_0x4e7806,_0x5a2431,_0x358d06,_0x562e4a){return _0x3d78b7(_0x562e4a- -0x57,_0x5a2431-0x1a9,_0x5a2431,_0x562e4a-0xe6);}_0x43746d[_0x83e5fa(0x558,0x531,0x5d5,0x584)](_0x32a7a8['oCzXB'])['on'](_0x2eaa56(0x46c,0x4e1,0x41b,0x499),handleNovelaiImageUpload),_0x43746d[_0x2eaa56(0x524,0x4e5,0x544,0x4e3)](_0x32a7a8['EwfHA'])['on'](_0x32a7a8[_0x2eaa56(0x4e2,0x4bd,0x559,0x51c)],()=>{const _0x42c4c1={};_0x42c4c1['gxyfK']=_0x32a7a8[_0x2ba767(0x97,0x9c,0x30,0x114)];function _0x2ba767(_0xc35e37,_0x29692c,_0x5e6b16,_0x321119){return _0x83e5fa(_0x29692c- -0x518,_0x29692c-0x7e,_0x5e6b16-0x136,_0x5e6b16);}_0x42c4c1[_0xbd534(-0xcf,-0xb8,-0xaa,-0xc6)]=_0x32a7a8[_0x2ba767(-0x59,-0x29,-0x3e,0x2)],_0x42c4c1[_0xbd534(-0x148,-0x19f,-0x10d,-0x13c)]=_0xbd534(-0x160,-0x15b,-0x164,-0x12f);const _0x29dacb=_0x42c4c1;function _0xbd534(_0x32b069,_0x557a83,_0x1f5247,_0x5b147a){return _0x83e5fa(_0x32b069- -0x635,_0x557a83-0x124,_0x1f5247-0x6c,_0x1f5247);}if(_0x32a7a8[_0x2ba767(-0x2c,-0x30,0x50,0x43)](_0x32a7a8['IVttk'],_0x32a7a8[_0xbd534(-0x12d,-0x131,-0x109,-0x156)])){const _0x26e7b9=_0x29dacb['gxyfK']['split']('|');let _0x5daeae=0x726*-0x4+-0x1708+0x33a0;while(!![]){switch(_0x26e7b9[_0x5daeae++]){case'0':_0x4ec16c[_0x2ba767(-0x9,0x5,-0x68,0x2d)+'kaotupian']=null;continue;case'1':_0x9708ef=null;continue;case'2':_0x5701a2[_0xbd534(-0x162,-0x153,-0x196,-0x134)][_0xbd534(-0x8b,-0xdb,-0x23,-0xbd)]=_0x29dacb['ZMamQ'];continue;case'3':_0x520bb7[_0x2ba767(0x2,-0x45,-0x4f,-0xc0)][_0x2ba767(0xe9,0x92,0x8e,0x56)]=_0x29dacb['gJvJh'];continue;case'4':_0x357805[_0x2ba767(-0x4f,-0x45,-0x86,-0xa9)][_0x2ba767(0x35,0x92,0x82,0x1d)]=_0x29dacb[_0x2ba767(0x45,-0x2b,0x45,0x3c)];continue;case'5':_0xef215c['src']='';continue;}break;}}else removeNovelaiImage();}),_0x43746d[_0x2eaa56(0x489,0x530,0x528,0x4e3)](_0x32a7a8[_0x2eaa56(0x4c0,0x490,0x429,0x472)])['on'](_0x32a7a8[_0x83e5fa(0x591,0x53c,0x5d5,0x54f)],()=>{function _0x5d6d01(_0x78a1d0,_0x5d8c29,_0x4722e8,_0x1a7d02){return _0x2eaa56(_0x78a1d0-0x1e6,_0x1a7d02,_0x4722e8-0x1b8,_0x5d8c29- -0x1ea);}function _0x1eeb20(_0x1deac6,_0x493aef,_0x2f0d51,_0x41d506){return _0x2eaa56(_0x1deac6-0x2b,_0x41d506,_0x2f0d51-0x182,_0x2f0d51- -0x5a3);}document[_0x1eeb20(-0x158,-0x1bf,-0x144,-0x1ab)+_0x5d6d01(0x262,0x264,0x2be,0x2cb)](_0x32a7a8[_0x1eeb20(-0x17b,-0xc0,-0x11e,-0xe6)])[_0x1eeb20(-0x49,-0xf6,-0x82,-0x7a)]();});function _0x83e5fa(_0x424ae7,_0x1f2a4f,_0x5f0666,_0x4aefcb){return _0x15dafa(_0x424ae7-0x6db,_0x4aefcb,_0x5f0666-0x1ad,_0x4aefcb-0x15e);}_0x43746d['find']('#imageInpu'+_0x83e5fa(0x538,0x55b,0x4df,0x5ad)+'_ref')['on'](_0x83e5fa(0x50e,0x4e6,0x54e,0x4aa),handleNovelaiCharRefImageUpload),_0x43746d[_0x83e5fa(0x558,0x53a,0x520,0x512)](_0x32a7a8[_0x83e5fa(0x555,0x5bc,0x4e6,0x582)])['on'](_0x32a7a8[_0x83e5fa(0x591,0x5ea,0x5bc,0x59e)],()=>{function _0x3b52af(_0x5d529b,_0x5ea0d8,_0xda1a9e,_0x44d446){return _0x83e5fa(_0x5ea0d8- -0x38b,_0x5ea0d8-0x80,_0xda1a9e-0x48,_0x5d529b);}function _0x14fa1c(_0x230c51,_0x5e281f,_0x313f25,_0xc272f0){return _0x2eaa56(_0x230c51-0x11b,_0xc272f0,_0x313f25-0x1b2,_0x313f25-0x96);}_0x32a7a8[_0x3b52af(0x186,0x1e3,0x24b,0x211)](_0x32a7a8[_0x14fa1c(0x556,0x4dd,0x546,0x560)],_0x32a7a8[_0x14fa1c(0x5cf,0x5e5,0x573,0x5b7)])?_0x32a7a8['AUJkS'](_0x34eae5,_0x36425d[_0x3b52af(0x244,0x1f4,0x1fc,0x24f)]):removeNovelaiCharRefImage();}),_0x43746d['find']('#comfyui-s'+'elect-imag'+'e-btn')['on'](_0x2eaa56(0x4e6,0x4b9,0x4d1,0x521),()=>{function _0x2623e5(_0x2b3821,_0x2b8ff2,_0x11d922,_0x68a63f){return _0x2eaa56(_0x2b3821-0x76,_0x11d922,_0x11d922-0x198,_0x2b8ff2- -0x670);}function _0x3741ac(_0x1096f0,_0x13f077,_0xefca19,_0x2d7f81){return _0x83e5fa(_0x13f077- -0x589,_0x13f077-0x4a,_0xefca19-0x58,_0x2d7f81);}document[_0x2623e5(-0x1a0,-0x211,-0x1ad,-0x282)+'ById'](_0x32a7a8[_0x2623e5(-0x136,-0x15f,-0x108,-0x132)])[_0x3741ac(0x6c,0xd,-0xf,-0x11)]();}),_0x43746d[_0x83e5fa(0x558,0x504,0x536,0x4dd)](_0x32a7a8[_0x2eaa56(0x444,0x4ba,0x501,0x489)])['on'](_0x32a7a8[_0x83e5fa(0x587,0x586,0x5c4,0x526)],handleImageUpload2),_0x43746d[_0x2eaa56(0x4ff,0x509,0x4f3,0x4e3)](_0x32a7a8[_0x83e5fa(0x55e,0x542,0x525,0x5a7)])['on'](_0x2eaa56(0x4fd,0x547,0x552,0x521),()=>{function _0x1a2d16(_0xfc2d1,_0x11ad1d,_0x303e90,_0x1ad23c){return _0x83e5fa(_0xfc2d1- -0x15d,_0x11ad1d-0x97,_0x303e90-0xa3,_0x11ad1d);}_0x32a7a8[_0x1a2d16(0x425,0x3e3,0x497,0x44c)](removeComfyUIImage);});}export{updateNovelaiImagePreview,updateNovelaiCharRefImagePreview,updateComfyUIImagePreview,nai3VibeTransferImageMimeType,nai3CharRefImageMimeType,comfyuiImageObjectURL};