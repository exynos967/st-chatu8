(function(_0x150a3a,_0x314cb7){function _0x99380d(_0x14b1e1,_0xf9da95,_0x1ed9ae,_0x3549fd){return _0x10d8(_0x3549fd-0xf,_0xf9da95);}const _0x4c7b43=_0x150a3a();function _0x526ed9(_0x495229,_0x4ae7f1,_0x44fcd2,_0x52cc91){return _0x10d8(_0x52cc91- -0x271,_0x44fcd2);}while(!![]){try{const _0x3f40ba=parseInt(_0x526ed9(-0x144,-0x156,-0x188,-0x111))/(-0x246d+-0x782*-0x4+-0x4e*-0x15)+parseInt(_0x99380d(0x1b9,0xf3,0x132,0x156))/(-0x1412+-0x1aea+0x2efe)*(parseInt(_0x526ed9(-0x196,-0x139,-0x157,-0x19a))/(0x192e+0x4*0x53+-0x1a77))+-parseInt(_0x526ed9(-0x1a0,-0xff,-0x143,-0x133))/(0x16a1+0x1b10+0x108f*-0x3)+parseInt(_0x526ed9(-0x168,-0x209,-0x148,-0x1ab))/(-0x1726+-0x8aa+0x1fd5)*(-parseInt(_0x526ed9(-0x4b,-0xb0,-0x102,-0xb5))/(0x6*0x18d+-0x3*-0x399+0x1*-0x1413))+-parseInt(_0x526ed9(-0x111,-0xa3,-0xd5,-0xe4))/(-0x3b9*-0x7+0x59*0x61+-0x3*0x13eb)+-parseInt(_0x526ed9(-0xf1,-0x140,-0x11f,-0x13e))/(0x53*0x71+-0x11da+-0x12c1)+parseInt(_0x526ed9(-0x1c5,-0x17f,-0x148,-0x1c3))/(-0x395+0x435*0x6+0x1*-0x15a0);if(_0x3f40ba===_0x314cb7)break;else _0x4c7b43['push'](_0x4c7b43['shift']());}catch(_0x331d68){_0x4c7b43['push'](_0x4c7b43['shift']());}}}(_0x4cd9,0x4d56b+0x1*0x79af6+-0xe4d9));function _0x4cd9(){const _0x5993d7=['AhLyqKm','zw1VDMuTy2HHCG','i25VDMvSywKTyW','yw5ZzMvYsw1HzW','5lIk5lYG5AsX6lsLoIa','CMv2B2TLt2jQzq','y3rvuKW','ssbbueNLNldLNydJGii','lwj0BG','vezTyKK','m3WWFdv8nhWYFa','sePwAxa','AgfYlxjLzI1PBq','igzYB20Gy2fJAa','rwXtDgy','y2fJAgvFBM92zq','BKjWvee','C3r5Bgu','vw5YEfO','zgvqBei','igzYB20GB2XKia','DgfYz2v0','ywDLoG','wLf6rMC','C3rVCMvezwXLDa','y2HHBMDL','r2TAyKS','Aw1Hz2u','ChLMzxO','mtaYmZu2odbLy2rRDK8','rgX6EhG','Dg9Y','tg9HzgvKienVBq','DwnZuw8','DY1JB250ywLUzq','vurLuNu','CMvMigLTywDLoG','lxjLzI1PBwfNzq','vgzLEKy','Bw92zs1PBwfNzq','nde1mtaYogv6Dw14tG','y1rrwvG','BLzdD1G','sMXiDK8','ignHy2HLihrVia','x25VDMvSywK','ywDL','5zU+54Mh5Ase55cg5AsX6lsLoIa','zw1VDMuTAw1HzW','ntHkB254zvi','EvPUwu8','CML0zq','r1rZufm','B2z3ANG','CMvM','y2XPy2S','BMPQuui','zMXLEa','y2fJAgvFy29TzG','qvzrCNK','zMLUza','6zsz6k+V6k+M5OofoG','CuXoz2W','zuniCei','C3rVCMvszwfKtW','rLnXu1i','vuLRAu8','thHkEhO','D1n6Dei','zxCTy29UDgfPBG','vuNLM77NIyC6ia','rLjUDfm','6k+M5OofoIa','i2nVBwz5DwKTCW','mte0nZq3nK1iChHtvW','qxniB0u','Aw1Hz2vjBNb1Da','6k+35ywi6k6+572Uq29TzNLv','x25HAv9JAgfYxW','mhWZFdj8mxW0','CMPzCMC','z2vFBM92zwXHAq','sLvnBxe','i2LTywDLsw5WDq','C2vYDMvYrMLSzq','EvnkBu0','BwfNzs1WCMv2Aq','yMPbq2y','DhjPBq','i25VDMvSywKTAq','x3jLzG','wwjZEgC','vK1JuMO','z2vFBMfPx2nOyq','ExvPx3jLzL9PBq','ihrVihvWzgf0zq','yMXJy0y','zgLZCgXHEq','y29UC3rYDwn0BW','qKjetNK','A2fuyxy','uwHWzKS','DMLjuMK','zwXbssbJAgfYia','s3jdz3a','CMvMlwLTywDLlq','Dg9tDhjPBMC','z3fWy2K','wgrjthm','v1vys2e','swfus2G','ue9tva','v1PHu2u','CxvLCNLtzwXLyW','ienVBwz5vuKGAq','v25oufO','C2X4ve4','yMXVyG','Aw5SAw5LlwzSzq','ndi5mwP4EuvrAa','rNr0sNy','q3LZrhq','BM92zwXHAs1Yzq','u2PpD0G','CIaUC3qTy2HHDa','zgf0ytPPBwfNzq','CMvZDwX0','ANnVBG','uhfHshe','i2nVBwz5DwKTAq','EgjKv00','yMXVy2S','vfzzB3m','ihjLlxvWBg9Hza','yNDlwhq','C2vHCMnO','EgzTyMy','BMfTzq','tfbeAM4','z01erw4','y29TzNL1AwnHBG','s3LMExC','u1fArxq','vMfQvLa','AurzAve','yKTPCKG','B2rbqLq','kcGOlISPkYKRkq','y3jLyxrLt2jQzq','CL9Yzwy','wxriufe','mNWZFdf8nxW0Fa','A3bWv3i','z2v0rwXLBwvUDa','Cgnevfi','C3rVCMvszwfKvW','q252CMq','ie5VDMvSquKGqW','uhPRB1C','DffWrMi','zs1IDg4','zxnZAw5Nie5VDG','C3rYAw5N','yxqUifbSzwfZzq','zKLTywDL','zgzNC3G','nNPurKHkAq','s3vLwgG','BMfPm0nOyxjszq','vxjTrMq','i2nVBwz5DwKTCG','uxD5AhK','DfH5zK0','BgrHsxm','tfD2EMC','qNLjza','sgv2v3G','m3W0Fdf8mhWY','rxjYB3iGChjVyW','AgfYifjLzIbPBq','A2fVDhvWAwfU','uxLVs2e','tKnZEg0','zxiGlNn0lwnOyq','DK9fv1a','rxjYB3iGBg9Hza','yxbWzw5K','wxD4vM0','Df9UB3zLBgfP','mtaZnZKXmtvjzK9bBLq','uwLVtxm','yw9bA0i','z2uY','yNrU','vNrRBMi','sw5ftLy','sfj1sxy','z2PkAfu','quL2C0K','z3vtsw0','wLngs20','shjAvwO','BwvZC2fNzq','rw1qB3G','C3bSAxq','5zU+54Mh5Ase55cg5OIw5lIk5lYG5PE25yE66zsz','r2TKELG','wfLAvum','BMX5','BgfJzwHVBgrLCG','5zU+54Mh5lIk5lYG5OIq5yQFlcdMNi3LIQe','AKHxywG','BgfPx2nOyxjFCG','mJa0otiXmhD4ENH3CW','tMfTzq','Dgv4Da','se9ft0u','ru5qvMy','BwfNztO','tfbZEvy','Aw5NignHy2HLza','CxvgExq','vw1Suxe','C0nJrLK','AwDmsg4','Aw1Hz2uVCg5N','sw9kqLa','Dhu4lwLTywDLlq','ELnkz2q','seDItMy','mtiYndm5qMjuqvbd','tffRthi','l3vWBg9Hzc9PBq','yMXVyJO','B0XsEfq','Bw92zs1JAgfYlq','qKTOuu8','DtGTAw1Hz2uTCa','revTzKy','EvDOCvC','CxLvuhq','wLzKu3O','u1n2CxK','q3jODvu','zwzFAw1Hz2u','s2PfBfq','CMvHzefZrgf0yq','rMPquva','C3rYAw5NAwz5','tMvXweO','Bw93tK0','y29TzNL1AvvYBa','rhrMAKK','se1tze8','rLjdvMK','tfvnA0u','BMfPm1zPyMvuCG','C3rHCNrZv2L0Aa','ChjLDMLLD0LTyq','mhWYFdv8nhWXFa','zwXLy3qTAw1HzW','A1fesem','i25VDMvSywKTCW','A0jtrvm','ugzduK0','DejNsMW','DuzYDKW','DgHLig5LDYbMBW','zwXbssbPBwfNzq','ie5VDMvSquKGvG','yNvVuxe','y29TzNL1As1Yzq','t1nZBfG','ywDLlxbYzxzPzq','CNr4uwq','5zU+54Mh5lIk5lYG5AsX6lsLlcdPLjNOR68','yxbWBhK','BM9Uzq','s0nqELi','zMLSzxm','zxjYB3i','AwjLigLTywDLoG','CMjuqMy','CgXHy2vOB2XKzq','DgrrzgG','uMLWvha','5lIk5lYG5OIq5yQFlcdMNi3LIQhLMAJOV5q','vKXzvhi','Bg9N','yMvMwxq','zgf0yq','z1jiEgG','C3jJ'];_0x4cd9=function(){return _0x5993d7;};return _0x4cd9();}const _0x4cf72a=(function(){const _0x15f3bc={};function _0x45068e(_0x3b7654,_0x276b4d,_0x314575,_0x23a49f){return _0x10d8(_0x3b7654- -0x332,_0x23a49f);}_0x15f3bc[_0x45068e(-0x1b1,-0x1d7,-0x19a,-0x17d)]=_0x2088d6(-0x197,-0x1ff,-0x191,-0x1bd)+_0x45068e(-0x1ce,-0x16e,-0x205,-0x23b)+_0x45068e(-0x1e6,-0x186,-0x266,-0x252),_0x15f3bc[_0x2088d6(-0x1f4,-0x1c1,-0x213,-0x208)]=function(_0x210fee,_0x4641b3){return _0x210fee===_0x4641b3;},_0x15f3bc[_0x45068e(-0x278,-0x21b,-0x1ed,-0x2a3)]=_0x45068e(-0x295,-0x238,-0x2d0,-0x317);function _0x2088d6(_0x529907,_0x723ebf,_0x5b86c1,_0x1b1f02){return _0x10d8(_0x723ebf- -0x361,_0x5b86c1);}const _0x1508e0=_0x15f3bc;let _0x3008c5=!![];return function(_0x14ac41,_0x20d388){const _0x33054e=_0x3008c5?function(){function _0x4c85e1(_0x2fd41b,_0x159209,_0x1d73c8,_0x4b2c07){return _0x10d8(_0x159209- -0x122,_0x2fd41b);}const _0x23939b={};function _0x4fcd51(_0x4215ea,_0x420fe9,_0x1c8d38,_0x45b641){return _0x10d8(_0x4215ea-0x1d,_0x420fe9);}_0x23939b[_0x4c85e1(0x3f,0x15,0x5,-0x65)]=_0x1508e0[_0x4fcd51(0x19e,0x21f,0x115,0x222)];const _0x204a61=_0x23939b;if(_0x1508e0[_0x4fcd51(0x1bd,0x24f,0x1b8,0x164)](_0x1508e0[_0x4c85e1(0x2a,-0x68,-0x8b,-0x50)],_0x1508e0[_0x4c85e1(-0x1b,-0x68,-0xd,-0x46)])){if(_0x20d388){const _0x3a5137=_0x20d388[_0x4fcd51(0x122,0x96,0x158,0xec)](_0x14ac41,arguments);return _0x20d388=null,_0x3a5137;}}else _0x26f295[_0x4fcd51(0x1cc,0x21c,0x231,0x15a)+_0x4c85e1(-0x10c,-0x82,-0x13,-0x9a)](_0x204a61[_0x4fcd51(0x154,0xf6,0xf1,0x15f)])[_0x4fcd51(0x16a,0xee,0x1b0,0x111)]();}:function(){};return _0x3008c5=![],_0x33054e;};}()),_0x5c3657=_0x4cf72a(this,function(){const _0x9f7428={};function _0x3fc257(_0x3a3dcd,_0x384c75,_0x4cfd3c,_0x528b12){return _0x10d8(_0x528b12-0x131,_0x4cfd3c);}function _0x12ed11(_0x526d44,_0x4f68cc,_0x5d18a9,_0x42934a){return _0x10d8(_0x5d18a9- -0xfd,_0x526d44);}_0x9f7428[_0x3fc257(0x15e,0x1da,0x165,0x1d7)]='(((.+)+)+)'+'+$';const _0x46abdb=_0x9f7428;return _0x5c3657['toString']()['search'](_0x46abdb['QyoKa'])[_0x3fc257(0x253,0x31c,0x2e1,0x2b1)]()[_0x3fc257(0x31b,0x2c8,0x265,0x2a9)+'r'](_0x5c3657)[_0x3fc257(0x31f,0x324,0x324,0x2ce)](_0x46abdb[_0x12ed11(0xa,0x29,-0x57,-0x8d)]);});_0x5c3657();import{extension_settings}from'../../../../../extensions.js';import{saveSettingsDebounced}from'../../../../../../script.js';import{extensionName}from'../config.js';import{processUploadedImage,processUploadedImageToBlob,addLog}from'../utils.js';import{dbs}from'../database.js';const NAI_VIBE_CACHE_KEY=_0x4da2ea(0x176,0xca,0x122,0x140)+'lai_vibe_t'+'ransfer_im'+_0x41454e(-0x10f,-0x1e2,-0x1af,-0x19c),NAI_CHAR_REF_CACHE_KEY='cache_nove'+_0x4da2ea(0x13e,0xbe,0xa2,0xe0)+_0x4da2ea(0xf8,0x177,0x122,0x100),COMFYUI_REF_CACHE_KEY=_0x41454e(-0x209,-0x15d,-0x199,-0x190)+_0x4da2ea(0x214,0x1b8,0x131,0x18f)+_0x41454e(-0x1df,-0x198,-0x1ba,-0x19c);let nai3VibeTransferImageMimeType=_0x4da2ea(0x7b,0x7b,0x157,0xed),nai3CharRefImageMimeType=_0x41454e(-0x250,-0x23f,-0x291,-0x20e),comfyuiImageObjectURL=null;function _0x41454e(_0x10d9b1,_0x12adee,_0x32638b,_0x137e13){return _0x10d8(_0x137e13- -0x2e0,_0x12adee);}function updateNovelaiImagePreview(_0x44f360){const _0x4fd5ae={'FSqSR':_0x4b7f57(0x4cc,0x462,0x42c,0x4b1)+_0x4b7f57(0x54f,0x576,0x500,0x580)+_0x4b7f57(0x51d,0x4bc,0x445,0x438)+':','BBDNy':function(_0x1f7dd2,_0x18af42){return _0x1f7dd2(_0x18af42);},'ugLpQ':function(_0x2fb1e9,_0x2e99f7){return _0x2fb1e9+_0x2e99f7;},'muYKA':'图片处理失败:\x20','HevWx':_0x3b1f30(0x43f,0x4b8,0x528,0x4ed),'ySJmM':_0x4b7f57(0x4df,0x4b2,0x43f,0x467)+'ge_novelai','KrCgp':function(_0x491d60,_0x1a71fe){return _0x491d60!==_0x1a71fe;},'eTpsY':'BKhQO','RipTp':'block','SmPsB':_0x4b7f57(0x524,0x54b,0x501,0x545)+'x','cRGlB':function(_0x1b5c37,_0x1b2c03){return _0x1b5c37===_0x1b2c03;},'rTyJz':_0x3b1f30(0x405,0x44e,0x4bb,0x40b),'JUMmq':_0x3b1f30(0x517,0x501,0x490,0x57f)},_0x32ce66=document[_0x4b7f57(0x5ea,0x56e,0x504,0x516)+'ById'](_0x4fd5ae[_0x4b7f57(0x551,0x52a,0x5ba,0x546)]);function _0x4b7f57(_0x10128e,_0x40b189,_0x3d6a45,_0x56547d){return _0x4da2ea(_0x10128e-0x1d2,_0x10128e,_0x3d6a45-0x17f,_0x40b189-0x3a4);}const _0x2aebc7=document[_0x4b7f57(0x568,0x546,0x505,0x575)+_0x3b1f30(0x45d,0x4e7,0x477,0x538)]('#novelai-i'+_0x3b1f30(0x4e9,0x51e,0x571,0x4fa)+_0x4b7f57(0x573,0x51a,0x565,0x578)+'er\x20.st-cha'+'tu8-image-'+_0x4b7f57(0x47a,0x4cb,0x4dd,0x45e)+'r');function _0x3b1f30(_0xfbe1d,_0x22c46e,_0x39470e,_0x40abea){return _0x4da2ea(_0xfbe1d-0x107,_0x39470e,_0x39470e-0x196,_0x22c46e-0x397);}const _0x1fcd9a=document[_0x4b7f57(0x58b,0x56e,0x593,0x5a6)+_0x4b7f57(0x427,0x45f,0x4a2,0x40d)](_0x4b7f57(0x530,0x54f,0x587,0x56c)+'move-image'+_0x3b1f30(0x544,0x4d0,0x4eb,0x547));if(_0x44f360&&_0x44f360[_0x3b1f30(0x43a,0x4a4,0x52e,0x4bf)](_0x4b7f57(0x514,0x552,0x57e,0x560))){if(_0x4fd5ae[_0x4b7f57(0x5ac,0x53d,0x4ca,0x5a5)](_0x4b7f57(0x485,0x49c,0x45f,0x4cb),_0x4fd5ae['eTpsY']))_0x2ae02a[_0x4b7f57(0x4cc,0x4c8,0x48f,0x528)](_0x4fd5ae[_0x4b7f57(0x49e,0x516,0x4ef,0x4a7)],_0x55df17),_0x4fd5ae[_0x3b1f30(0x4e7,0x52b,0x5b0,0x59f)](_0x285cc0,_0x4fd5ae['ugLpQ'](_0x4fd5ae['muYKA'],_0x1d43f9[_0x4b7f57(0x4a7,0x47a,0x4d9,0x4dc)]));else{_0x32ce66['src']=_0x44f360,_0x32ce66['style'][_0x4b7f57(0x550,0x536,0x55f,0x544)]=_0x4fd5ae[_0x3b1f30(0x545,0x4c0,0x484,0x52c)],_0x2aebc7[_0x3b1f30(0x4fd,0x4d9,0x4c4,0x4ed)]['display']=_0x3b1f30(0x533,0x4b8,0x4e1,0x454),_0x1fcd9a['style'][_0x4b7f57(0x553,0x536,0x54d,0x587)]=_0x4fd5ae['SmPsB'];const _0x252258=_0x44f360[_0x4b7f57(0x424,0x47c,0x4df,0x3ef)](','),_0x1d6334=_0x252258[0xc7*0xb+-0x5d*-0x5+-0xa5e][_0x4b7f57(0x4c4,0x47c,0x491,0x3fe)](':')[0x77+0x19d3+-0x1*0x1a49][_0x4b7f57(0x4da,0x47c,0x4f9,0x454)](';')[0x233e+-0x446*0x7+-0x554];nai3VibeTransferImageMimeType=_0x1d6334,window[_0x3b1f30(0x484,0x4a3,0x4a5,0x513)+_0x3b1f30(0x474,0x4cb,0x46c,0x50f)+'e']=_0x252258[0x1*0x37d+0x1841+-0x1bbd];const _0x37118a={};_0x37118a['id']=NAI_VIBE_CACHE_KEY,_0x37118a[_0x3b1f30(0x43e,0x4c5,0x495,0x53b)]=_0x44f360,dbs[_0x3b1f30(0x5ef,0x563,0x4fb,0x55b)+_0x3b1f30(0x516,0x4fb,0x4bd,0x55c)](_0x37118a);}}else{if(_0x4fd5ae['cRGlB'](_0x4fd5ae['rTyJz'],_0x4b7f57(0x45d,0x4de,0x4df,0x4b1))){const _0x50a3b3='1|4|0|3|2'['split']('|');let _0x58a6d0=0xda4+-0x2c*0xcb+-0x1*-0x1540;while(!![]){switch(_0x50a3b3[_0x58a6d0++]){case'0':_0x2253d[_0x4b7f57(0x4d1,0x4e6,0x462,0x531)][_0x3b1f30(0x513,0x529,0x563,0x50d)]=_0x4b7f57(0x529,0x50e,0x4e8,0x58f);continue;case'1':_0x181337[_0x4b7f57(0x4d3,0x4d4,0x479,0x49e)]='';continue;case'2':_0x364970[_0x3b1f30(0x3d4,0x44b,0x4af,0x423)+'fImage']=null;continue;case'3':_0x43e930[_0x4b7f57(0x482,0x4e6,0x50c,0x488)]['display']=_0x4fd5ae[_0x3b1f30(0x42a,0x453,0x43e,0x47f)];continue;case'4':_0x16c01a[_0x3b1f30(0x551,0x4d9,0x551,0x4e7)]['display']=_0x4fd5ae['HevWx'];continue;}break;}}else{const _0x4dfd08='0|3|2|1|4'['split']('|');let _0x5be5bd=-0x1*0x1ed9+0x492+0x1a47;while(!![]){switch(_0x4dfd08[_0x5be5bd++]){case'0':_0x32ce66['src']='';continue;case'1':_0x1fcd9a['style'][_0x3b1f30(0x591,0x529,0x4f6,0x593)]=_0x4fd5ae[_0x4b7f57(0x4db,0x460,0x471,0x42f)];continue;case'2':_0x2aebc7[_0x4b7f57(0x532,0x4e6,0x4bd,0x4aa)][_0x4b7f57(0x584,0x536,0x4cf,0x513)]=_0x4fd5ae[_0x3b1f30(0x571,0x51a,0x500,0x525)];continue;case'3':_0x32ce66[_0x3b1f30(0x4e4,0x4d9,0x4eb,0x456)][_0x4b7f57(0x540,0x536,0x52e,0x54c)]=_0x4fd5ae[_0x4b7f57(0x4c5,0x460,0x438,0x473)];continue;case'4':window['nai3VibeTr'+'ansferImag'+'e']=null;continue;}break;}}}}function removeNovelaiImage(){updateNovelaiImagePreview(null),dbs['storeDelet'+'e'](NAI_VIBE_CACHE_KEY);}async function handleNovelaiImageUpload(_0x3f4e40){const _0x394fd3={'XdILs':_0x223c98(-0x34,-0x84,-0xb4,-0x46),'SSvqy':'none','dePlB':_0x315d1a(-0x1,-0x86,0x1b,-0x71)+'x','aoAkB':function(_0x421df6,_0x17d10e){return _0x421df6(_0x17d10e);},'FRCVi':function(_0x1e609d,_0x5eba0c){return _0x1e609d===_0x5eba0c;},'HMSdO':_0x223c98(-0x1b,0x23,-0x41,-0x9c),'Ybsxg':_0x315d1a(-0xea,-0xff,-0xf0,-0x8a)+'essing\x20Nov'+_0x223c98(-0xd0,-0xce,-0x83,-0xe3)+':','pcDTR':function(_0x36e6cd,_0x29b29b){return _0x36e6cd+_0x29b29b;},'KueXh':'图片处理失败:\x20'},_0x29d99d=_0x3f4e40['target'][_0x315d1a(-0x85,-0x54,-0x95,-0xc3)][0x1466+0xc6*0x2b+-0x44*0xca];function _0x223c98(_0x2ca7de,_0xfe2673,_0x50143b,_0x5954b2){return _0x41454e(_0x2ca7de-0x5f,_0x5954b2,_0x50143b-0x1a1,_0x2ca7de-0x113);}if(!_0x29d99d)return;function _0x315d1a(_0x5f3ce2,_0x50ca65,_0x1236a8,_0x17bc44){return _0x4da2ea(_0x5f3ce2-0x15,_0x1236a8,_0x1236a8-0x145,_0x5f3ce2- -0x1a8);}try{const _0x3cf8af=await processUploadedImage(_0x29d99d,!![]);_0x394fd3[_0x223c98(-0x11d,-0xdd,-0xea,-0xc2)](updateNovelaiImagePreview,_0x3cf8af);}catch(_0x4b7138){if(_0x394fd3[_0x315d1a(-0x9e,-0x103,-0x51,-0x100)](_0x394fd3['HMSdO'],_0x394fd3[_0x223c98(-0xdf,-0xc6,-0x149,-0xda)]))console[_0x223c98(-0xc4,-0x81,-0x155,-0x58)](_0x394fd3[_0x315d1a(-0x1c,-0x83,-0x1a,0x4e)],_0x4b7138),_0x394fd3[_0x315d1a(-0xdd,-0x13d,-0x91,-0xf4)](alert,_0x394fd3[_0x223c98(-0x1d,0x53,-0x12,0x50)](_0x394fd3[_0x315d1a(0x30,0x83,-0x36,-0x1a)],_0x4b7138[_0x223c98(-0x112,-0x17b,-0x110,-0x104)]));else{_0x26ac25['src']=_0x5e0480,_0x556411['style'][_0x223c98(-0x56,-0xd,-0x61,-0x46)]=_0x394fd3[_0x223c98(-0x4b,-0xb0,-0xc,-0x9d)],_0x2c4cd4[_0x223c98(-0xa6,-0x2a,-0xa4,-0x10b)][_0x223c98(-0x56,-0xd8,-0x44,-0x5)]=_0x394fd3[_0x223c98(-0xea,-0xa7,-0x115,-0x99)],_0x3eb3bf[_0x223c98(-0xa6,-0xf6,-0x1e,-0xaf)][_0x315d1a(-0x16,0x2b,-0x30,-0x9e)]=_0x394fd3[_0x223c98(-0xa4,-0x26,-0xa2,-0x8e)];const _0xf8c56c=_0x323f56[_0x315d1a(-0xd0,-0xf3,-0xd9,-0xaf)](','),_0x127404=_0xf8c56c[-0xabe+0x8ef*-0x1+-0x3*-0x68f][_0x315d1a(-0xd0,-0x162,-0xca,-0xae)](':')[0x3a6+0x149b+-0x2*0xc20]['split'](';')[-0xe7a+0x24*-0x5+0xf2e];_0xcca8a2=_0x127404,_0x14b004['nai3CharRe'+'fImage']=_0xf8c56c[-0x2183+-0x1c05+0x3d89];const _0x52ef48={};_0x52ef48['id']=_0x180130,_0x52ef48[_0x223c98(-0xba,-0x74,-0x89,-0x107)]=_0x231c16,_0x206c6b['storeReadW'+'rite'](_0x52ef48);}}}function updateNovelaiCharRefImagePreview(_0x2ab927){const _0x6eba08={};_0x6eba08['GkZbK']=_0x2b5365(0x545,0x4b1,0x4a6,0x4f8)+'0',_0x6eba08[_0x49d126(-0x18e,-0x1e6,-0x20b,-0x124)]=_0x49d126(-0x152,-0x128,-0x1e3,-0xf6),_0x6eba08[_0x49d126(-0x162,-0x138,-0x166,-0x16d)]=_0x49d126(-0x140,-0xed,-0x153,-0x1c2)+_0x2b5365(0x49e,0x463,0x41f,0x46d)+_0x2b5365(0x4dc,0x3e9,0x41e,0x44d)+_0x49d126(-0x120,-0x117,-0xff,-0xe6)+_0x2b5365(0x4cc,0x497,0x4d0,0x4dd)+_0x2b5365(0x3a0,0x3c4,0x40f,0x429)+_0x2b5365(0x3b9,0x3fe,0x431,0x40d),_0x6eba08[_0x2b5365(0x495,0x52f,0x483,0x506)]=_0x49d126(-0xc8,-0x64,-0x7f,-0x101)+_0x2b5365(0x4b3,0x3e8,0x441,0x427)+_0x49d126(-0xd9,-0xf8,-0xe3,-0x4d)+_0x49d126(-0x1a6,-0x22f,-0x1bb,-0x12f),_0x6eba08[_0x49d126(-0x19f,-0x1e4,-0x174,-0x22d)]=_0x49d126(-0xc5,-0x60,-0x146,-0x9b),_0x6eba08['bjACf']=function(_0x38901c,_0x330883){return _0x38901c===_0x330883;},_0x6eba08[_0x2b5365(0x4bb,0x498,0x486,0x487)]=_0x49d126(-0xa3,-0x56,-0xea,-0xad);function _0x2b5365(_0x5474d9,_0x1730a9,_0x21aa63,_0x32b79d){return _0x4da2ea(_0x5474d9-0x182,_0x1730a9,_0x21aa63-0x180,_0x32b79d-0x330);}_0x6eba08['ldaIs']=_0x2b5365(0x457,0x553,0x55d,0x4e4),_0x6eba08['UmlQq']=_0x2b5365(0x568,0x4db,0x451,0x4d7)+'x';function _0x49d126(_0x55891c,_0x578c5e,_0x535068,_0x2f10f9){return _0x4da2ea(_0x55891c-0x81,_0x578c5e,_0x535068-0x1e9,_0x55891c- -0x273);}_0x6eba08[_0x2b5365(0x465,0x508,0x44f,0x4bd)]=function(_0x25d0db,_0x4e9475){return _0x25d0db!==_0x4e9475;},_0x6eba08['TVYos']=_0x2b5365(0x51d,0x46d,0x576,0x4f0),_0x6eba08[_0x2b5365(0x451,0x469,0x4d4,0x48a)]='flex';const _0x1dfb79=_0x6eba08,_0x17dcc1=document['getElement'+_0x2b5365(0x45f,0x3a6,0x39a,0x3eb)](_0x49d126(-0x165,-0xd3,-0xde,-0x132)+_0x49d126(-0xe5,-0x7c,-0x119,-0x5d)+_0x49d126(-0xad,-0x89,-0x11b,-0x4b)),_0x31e45c=document['querySelec'+_0x2b5365(0x486,0x4a3,0x4c6,0x480)](_0x1dfb79[_0x2b5365(0x3dd,0x497,0x3cc,0x441)]),_0x31b173=document[_0x49d126(-0xa9,-0x122,-0x4f,-0x72)+'ById'](_0x1dfb79['dfgsx']);if(_0x2ab927&&_0x2ab927[_0x2b5365(0x4c7,0x497,0x476,0x43d)](_0x1dfb79[_0x49d126(-0x19f,-0x15b,-0x126,-0x20d)])){if(_0x1dfb79[_0x49d126(-0xeb,-0x13c,-0xe5,-0xc4)](_0x1dfb79[_0x2b5365(0x513,0x3f6,0x44f,0x487)],_0x1dfb79[_0x2b5365(0x4b4,0x45b,0x4c9,0x487)])){_0x17dcc1['src']=_0x2ab927,_0x17dcc1[_0x49d126(-0x131,-0x1b2,-0x13a,-0xa8)][_0x49d126(-0xe1,-0x149,-0x167,-0x13a)]=_0x1dfb79[_0x49d126(-0x1ba,-0x226,-0x230,-0x14d)],_0x31e45c[_0x2b5365(0x423,0x4a3,0x462,0x472)][_0x49d126(-0xe1,-0x16a,-0xad,-0xc5)]=_0x1dfb79[_0x49d126(-0x18e,-0x1d6,-0x1b6,-0x20e)],_0x31b173[_0x2b5365(0x4b8,0x47f,0x4c9,0x472)][_0x49d126(-0xe1,-0xcc,-0x57,-0x117)]=_0x1dfb79[_0x2b5365(0x49f,0x3ee,0x413,0x41a)];const _0x37202f=_0x2ab927[_0x2b5365(0x3b1,0x459,0x434,0x408)](','),_0x47a833=_0x37202f[0x6fd*-0x2+-0x1176+-0x1f7*-0x10][_0x49d126(-0x19b,-0x1a0,-0x14b,-0x158)](':')[-0xe97+0x1*0x209+0x5*0x283][_0x49d126(-0x19b,-0x1de,-0x1e6,-0x1fb)](';')[0xbd8*-0x3+-0x21da+0x6b*0xa6];nai3CharRefImageMimeType=_0x47a833,window[_0x2b5365(0x3db,0x3b3,0x42a,0x3e4)+_0x2b5365(0x58f,0x523,0x52f,0x505)]=_0x37202f[-0xa5b+0x32e*0x2+0x400];const _0x4f2485={};_0x4f2485['id']=NAI_CHAR_REF_CACHE_KEY,_0x4f2485[_0x2b5365(0x3db,0x475,0x474,0x45e)]=_0x2ab927,dbs['storeReadW'+_0x49d126(-0x10f,-0x190,-0xe0,-0x14f)](_0x4f2485);}else{const _0x45e71f=_0x1dfb79[_0x49d126(-0x128,-0x13d,-0xc5,-0x125)]['split']('|');let _0x522811=-0x1*-0x193d+0x1e8+-0x1b25*0x1;while(!![]){switch(_0x45e71f[_0x522811++]){case'0':_0x1a70fa=null;continue;case'1':_0xce3a24[_0x2b5365(0x4d8,0x505,0x4c8,0x472)][_0x49d126(-0xe1,-0x148,-0x11e,-0x7e)]=_0x49d126(-0x109,-0xe1,-0x132,-0xc0);continue;case'2':_0x805fa8['src']='';continue;case'3':_0x3ca989[_0x2b5365(0x479,0x4d4,0x463,0x472)]['display']=_0x1dfb79[_0x2b5365(0x404,0x449,0x3ae,0x415)];continue;case'4':_0x397faa[_0x2b5365(0x4cf,0x4a2,0x56a,0x4ed)+_0x49d126(-0x1b3,-0x1f0,-0x1bb,-0x1fa)]=null;continue;case'5':_0x81690a[_0x49d126(-0x131,-0xb2,-0x183,-0x124)][_0x49d126(-0xe1,-0x61,-0xaa,-0x93)]=_0x49d126(-0x152,-0x1b9,-0x125,-0x1df);continue;}break;}}}else{if(_0x1dfb79[_0x2b5365(0x544,0x52e,0x4cb,0x4bd)](_0x1dfb79[_0x2b5365(0x521,0x455,0x566,0x4e5)],_0x1dfb79[_0x2b5365(0x4b8,0x459,0x4ac,0x4e5)]))_0x1fcc39(_0x398086[_0x2b5365(0x3ec,0x3fd,0x4ee,0x45e)]);else{const _0x55d3ef=_0x2b5365(0x3a7,0x424,0x393,0x3ed)[_0x49d126(-0x19b,-0x130,-0x1ac,-0x1ba)]('|');let _0x3631ef=-0x1*0x1bdb+0x192c+0x2af*0x1;while(!![]){switch(_0x55d3ef[_0x3631ef++]){case'0':_0x31b173[_0x2b5365(0x3e6,0x4f0,0x4e0,0x472)][_0x49d126(-0xe1,-0x71,-0xb2,-0x12e)]=_0x1dfb79['ENPVf'];continue;case'1':_0x31e45c[_0x49d126(-0x131,-0xa8,-0x18c,-0x12c)]['display']=_0x1dfb79['cTQYX'];continue;case'2':window['nai3CharRe'+_0x2b5365(0x4ee,0x4cd,0x53a,0x505)]=null;continue;case'3':_0x17dcc1[_0x2b5365(0x441,0x486,0x42c,0x460)]='';continue;case'4':_0x17dcc1[_0x2b5365(0x3e0,0x44c,0x4e1,0x472)][_0x2b5365(0x550,0x495,0x51f,0x4c2)]=_0x49d126(-0x152,-0xdc,-0x148,-0x181);continue;}break;}}}}function _0x4da2ea(_0x45afc1,_0x5bbd39,_0xf304f0,_0x27aa10){return _0x10d8(_0x27aa10-0x1b,_0x5bbd39);}function _0x10d8(_0x2e734f,_0x42ddc8){_0x2e734f=_0x2e734f-(0x1bbd*-0x1+0xe7d*-0x1+0x2ad3);const _0x19cb8a=_0x4cd9();let _0x4aadfd=_0x19cb8a[_0x2e734f];if(_0x10d8['atgWac']===undefined){var _0x1c183d=function(_0x5ad690){const _0x17a327='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x3cbebe='',_0x40ea95='',_0x54c2f6=_0x3cbebe+_0x1c183d;for(let _0x102143=-0xe0c*0x1+-0x161b+-0xc0d*-0x3,_0x1d7bf6,_0x53f0ce,_0x53ef7b=0x1c8f+-0x1c97*0x1+0x8;_0x53f0ce=_0x5ad690['charAt'](_0x53ef7b++);~_0x53f0ce&&(_0x1d7bf6=_0x102143%(0x56+0x9*-0x3cb+-0x1*-0x21d1)?_0x1d7bf6*(-0x907+-0x2*0x10f1+0x2b29)+_0x53f0ce:_0x53f0ce,_0x102143++%(-0x5*0x2a5+0x525+0x818))?_0x3cbebe+=_0x54c2f6['charCodeAt'](_0x53ef7b+(0x16b3+-0x1e68+-0x295*-0x3))-(-0xbf9+0x145d+0x1*-0x85a)!==-0x1ed+0x2243+-0x2056?String['fromCharCode'](0x39f*-0x2+0x1001*-0x2+0x283f*0x1&_0x1d7bf6>>(-(0x2145+0x780+-0x28c3)*_0x102143&-0x80*0x33+-0x183e+0x31c4)):_0x102143:0x1447*0x1+-0x12cb+-0x17c){_0x53f0ce=_0x17a327['indexOf'](_0x53f0ce);}for(let _0x1f511b=0x11e1+-0xabb+0xb7*-0xa,_0x2ea8f0=_0x3cbebe['length'];_0x1f511b<_0x2ea8f0;_0x1f511b++){_0x40ea95+='%'+('00'+_0x3cbebe['charCodeAt'](_0x1f511b)['toString'](0x230b*-0x1+-0x173*0x7+0x2d40*0x1))['slice'](-(-0x1*-0x24ad+-0x8c1+0x1bea*-0x1));}return decodeURIComponent(_0x40ea95);};_0x10d8['Tsbbdc']=_0x1c183d,_0x10d8['OhhnKL']={},_0x10d8['atgWac']=!![];}const _0x4b9068=_0x19cb8a[0x1*-0x2b+0x16b9+-0x168e],_0x4e8641=_0x2e734f+_0x4b9068,_0x17a41b=_0x10d8['OhhnKL'][_0x4e8641];if(!_0x17a41b){const _0x51bd49=function(_0x2a15dd){this['VWqVjy']=_0x2a15dd,this['TzFJEk']=[-0x1f2f+0x99*-0x1f+0xd*0x3d3,-0x9a2+-0x11af+-0x309*-0x9,-0x25*0x31+-0x11*0xdc+0x15b1],this['AxLTEm']=function(){return'newState';},this['yvmUNa']='\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*',this['VfZyxe']='[\x27|\x22].+[\x27|\x22];?\x20*}';};_0x51bd49['prototype']['dFvmhH']=function(){const _0x50ef46=new RegExp(this['yvmUNa']+this['VfZyxe']),_0x28b10d=_0x50ef46['test'](this['AxLTEm']['toString']())?--this['TzFJEk'][0x6*0x4b2+0x5*0x224+-0x26df]:--this['TzFJEk'][-0x1f5+-0x1*0x91d+0xb12];return this['GPGJZr'](_0x28b10d);},_0x51bd49['prototype']['GPGJZr']=function(_0x4982c3){if(!Boolean(~_0x4982c3))return _0x4982c3;return this['jURsnn'](this['VWqVjy']);},_0x51bd49['prototype']['jURsnn']=function(_0x7bb2ee){for(let _0x18d7e7=0x1f49+-0x601+-0x1948,_0x1a2f99=this['TzFJEk']['length'];_0x18d7e7<_0x1a2f99;_0x18d7e7++){this['TzFJEk']['push'](Math['round'](Math['random']())),_0x1a2f99=this['TzFJEk']['length'];}return _0x7bb2ee(this['TzFJEk'][0x1a4e+0x1bf0+-0x363e]);},new _0x51bd49(_0x10d8)['dFvmhH'](),_0x4aadfd=_0x10d8['Tsbbdc'](_0x4aadfd),_0x10d8['OhhnKL'][_0x4e8641]=_0x4aadfd;}else _0x4aadfd=_0x17a41b;return _0x4aadfd;}function removeNovelaiCharRefImage(){function _0x3c5a24(_0x2c9992,_0x4339fd,_0x2eb70d,_0x1ff083){return _0x41454e(_0x2c9992-0x135,_0x2c9992,_0x2eb70d-0xda,_0x4339fd-0x189);}function _0x56797a(_0x324f1d,_0x4235a4,_0x56adb0,_0x505aaa){return _0x4da2ea(_0x324f1d-0x4,_0x505aaa,_0x56adb0-0xf,_0x56adb0- -0x48);}const _0x54e42e={'iDYiQ':function(_0xa52609,_0x102369){return _0xa52609(_0x102369);}};_0x54e42e[_0x3c5a24(-0x3b,0x4f,-0x41,0x65)](updateNovelaiCharRefImagePreview,null),dbs[_0x56797a(0xbe,0xd7,0x101,0x15f)+'e'](NAI_CHAR_REF_CACHE_KEY);}async function handleNovelaiCharRefImageUpload(_0x40ed8d){const _0x17b43f={'HJVip':_0x2d289c(0x51,-0x7,-0xa,-0x3c)+'ge2','QhpfK':'block','fdVKZ':_0x2d289c(0xea,0x103,0x126,0x17a)+'x','slxTN':_0xb7029a(-0xe8,-0x18a,-0x153,-0x178)+'1','viIRi':_0x2d289c(0x64,0x79,0x7b,0xab),'YtHPQ':'flex','YwxVm':function(_0x12e2f1,_0x20f9f6){return _0x12e2f1(_0x20f9f6);},'gMDEn':function(_0x2b0b0a,_0x1a942e){return _0x2b0b0a===_0x1a942e;},'LUMkE':_0x2d289c(0x97,0x11b,0xc2,0x53),'tdQdh':_0x2d289c(0x82,0xb,0x20,0xce),'guSIm':'Error\x20proc'+_0xb7029a(-0xdf,-0xe2,-0x109,-0xe1)+'elAI\x20char\x20'+_0xb7029a(-0x1ba,-0x174,-0x181,-0x15e),'vOEWP':function(_0x1201b3,_0x40376f){return _0x1201b3+_0x40376f;},'rfLKd':_0x2d289c(0xa3,0x74,0x86,0xcc)},_0x139262=_0x40ed8d[_0x2d289c(0x89,0xa8,0x75,0x73)][_0x2d289c(0x66,0x4e,0x9,0x82)][0x695+0x295*0xe+0x2abb*-0x1];function _0xb7029a(_0x1fc4e8,_0x2d9ba6,_0xf775be,_0x5bad5d){return _0x4da2ea(_0x1fc4e8-0xd2,_0xf775be,_0xf775be-0x22,_0x5bad5d- -0x2b3);}if(!_0x139262)return;function _0x2d289c(_0x2b4297,_0x4e0540,_0x1b2bed,_0x5aa3c0){return _0x4da2ea(_0x2b4297-0xd7,_0x4e0540,_0x1b2bed-0x80,_0x2b4297- -0xbd);}try{const _0x57ed76=await _0x17b43f[_0xb7029a(-0x1b0,-0x1f6,-0x20e,-0x1ec)](processUploadedImage,_0x139262);_0x17b43f[_0x2d289c(0xa,0x75,-0x7c,0x74)](updateNovelaiCharRefImagePreview,_0x57ed76);}catch(_0x4e9340){if(_0x17b43f[_0x2d289c(0xff,0x7e,0xc0,0xf8)](_0x17b43f[_0xb7029a(-0x21a,-0x187,-0x144,-0x1a8)],_0x17b43f[_0x2d289c(0x6b,-0x9,0x29,0x87)])){const _0x110abb=_0x9b7f45['getElement'+_0xb7029a(-0x235,-0x245,-0x195,-0x1f8)](_0x17b43f[_0xb7029a(-0x160,-0x1a6,-0x1f2,-0x177)]),_0xdf6010=_0x4ac98a[_0xb7029a(-0xad,-0xe1,-0x101,-0x111)+_0xb7029a(-0x14e,-0x1c1,-0x1cd,-0x163)](_0x2d289c(0xf5,0xa0,0xac,0x153)+_0x2d289c(0xca,0xa5,0x153,0xdb)+_0x2d289c(0xb9,0xf1,0xb8,0xe7)+_0x2d289c(0x6,0x2,-0x43,-0x21)+_0x2d289c(0x32,-0x9,-0xe,0x9e)+_0x2d289c(0x6a,0x29,0x47,0x5)+'r'),_0x160a0d=_0x1116bf[_0xb7029a(-0x129,-0x91,-0x8c,-0xe9)+_0x2d289c(-0x2,0x20,-0x5d,-0x1d)](_0xb7029a(-0x121,-0x129,-0x222,-0x198)+_0xb7029a(-0x1ed,-0xd0,-0x176,-0x15b)+_0x2d289c(0x7c,0xb3,0x94,0x6d));_0x110abb[_0x2d289c(0x73,0xc2,0xdf,0xc4)]&&_0x110abb['src']['startsWith'](_0xb7029a(-0x199,-0x1ff,-0x137,-0x1be))&&_0x110abb[_0x2d289c(0x73,0xd0,0x46,0x43)]!==_0x5bd50e&&_0xe32d62['revokeObje'+_0x2d289c(0x7a,0x103,0x31,0x34)](_0x110abb['src']);if(_0x44a20c)_0x110abb['src']=_0x18e7bc,_0x110abb[_0xb7029a(-0x199,-0x1a0,-0x171,-0x171)]['display']=_0x17b43f[_0xb7029a(-0x192,-0x19b,-0xc1,-0x11d)],_0xdf6010['style'][_0xb7029a(-0x100,-0x96,-0xfd,-0x121)]=_0x2d289c(0x64,0x1b,0xc5,0x2a),_0x160a0d[_0x2d289c(0x85,0x108,0xc9,0xef)][_0x2d289c(0xd5,0xaa,0xfd,0x83)]=_0x17b43f['fdVKZ'];else{const _0x204940=_0x17b43f[_0x2d289c(0xe8,0xd7,0x7a,0xa2)]['split']('|');let _0x111834=0x59b+0x1644+-0x1bdf;while(!![]){switch(_0x204940[_0x111834++]){case'0':_0x110abb[_0x2d289c(0x85,0x7e,0x10d,0x41)][_0xb7029a(-0x17e,-0x186,-0x119,-0x121)]=_0x17b43f[_0xb7029a(-0x101,-0x160,-0x179,-0x11c)];continue;case'1':_0x2eb487=null;continue;case'2':_0x502cd9[_0xb7029a(-0x9e,-0x7c,-0x180,-0xf6)+'kaotupian']=null;continue;case'3':_0x110abb[_0x2d289c(0x73,0x46,0xc8,0x8a)]='';continue;case'4':_0x160a0d[_0x2d289c(0x85,0xd2,0x21,0x4c)][_0xb7029a(-0x108,-0xe3,-0xbd,-0x121)]='none';continue;case'5':_0xdf6010[_0x2d289c(0x85,0xee,0x3b,0x1c)][_0x2d289c(0xd5,0xe1,0xe1,0x4a)]=_0x17b43f[_0x2d289c(0x10a,0x111,0xe7,0x10b)];continue;}break;}}}else console[_0x2d289c(0x67,0x50,-0x6,0x11)](_0x17b43f[_0x2d289c(0x16,0x9c,0x6,0x9d)],_0x4e9340),alert(_0x17b43f[_0x2d289c(0x7,0x7a,0x1,0x48)](_0x17b43f['rfLKd'],_0x4e9340[_0xb7029a(-0x23a,-0x16c,-0x209,-0x1dd)]));}}function updateComfyUIImagePreview(_0x28baf4){const _0x1e26da={};_0x1e26da[_0x5dff6b(0x1d6,0x14b,0xc3,0x14b)]=_0x5dff6b(0xaa,0xf6,0x119,0x150)+_0x5dff6b(0x13c,0x16a,0x11f,0x139),_0x1e26da['SjOwH']=_0x5dff6b(0x16a,0x172,0x139,0x192)+_0x18ffc9(0x423,0x410,0x3dc,0x43d)+_0x18ffc9(0x412,0x384,0x48c,0x496)+_0x5dff6b(0x78,0xab,0x13e,0x53)+_0x5dff6b(0xb4,0xd7,0x127,0x161)+_0x18ffc9(0x3c3,0x398,0x440,0x35d)+'r',_0x1e26da['qSKbo']=_0x5dff6b(0x18e,0x193,0x1e2,0x181)+_0x18ffc9(0x3f4,0x3a9,0x3cd,0x44e)+_0x5dff6b(0xa2,0x121,0xab,0x11f),_0x1e26da[_0x18ffc9(0x3af,0x37e,0x3c2,0x37b)]='data:image',_0x1e26da[_0x5dff6b(0xa2,0xd3,0xd9,0xea)]=_0x5dff6b(0x161,0x19c,0x1e6,0x16f),_0x1e26da[_0x5dff6b(0x10e,0xfe,0x158,0x143)]=_0x5dff6b(0xe4,0x109,0x8e,0x11e),_0x1e26da[_0x18ffc9(0x380,0x33b,0x36e,0x372)]=_0x18ffc9(0x443,0x4b5,0x4b3,0x3b3)+'x';function _0x18ffc9(_0x5730c5,_0x171e4a,_0x26b3fb,_0x4c259a){return _0x4da2ea(_0x5730c5-0x122,_0x171e4a,_0x26b3fb-0x20,_0x5730c5-0x29c);}function _0x5dff6b(_0x444b96,_0x28b34b,_0xb6a11e,_0x37c54c){return _0x4da2ea(_0x444b96-0x8e,_0xb6a11e,_0xb6a11e-0x12f,_0x28b34b- -0x18);}_0x1e26da[_0x5dff6b(0x11c,0x10e,0x18c,0xcf)]='flex',_0x1e26da['mowNM']=_0x5dff6b(0x175,0xf6,0x187,0x70)+_0x18ffc9(0x368,0x375,0x306,0x31b),_0x1e26da['Dlzxx']=_0x18ffc9(0x44e,0x47b,0x451,0x441)+_0x5dff6b(0x121,0x16f,0x121,0x12d)+_0x5dff6b(0x1db,0x15e,0x131,0x122)+_0x5dff6b(0x19,0xab,0xda,0x11c)+'tu8-image-'+_0x5dff6b(0x192,0x10f,0xc5,0x134)+'r',_0x1e26da[_0x5dff6b(0xcf,0xe3,0xa1,0xf5)]=_0x18ffc9(0x3b7,0x325,0x338,0x3d1)+_0x5dff6b(0x1bc,0x140,0x15e,0x188)+_0x5dff6b(0x155,0x121,0x121,0xbf),_0x1e26da[_0x18ffc9(0x445,0x491,0x442,0x43a)]=function(_0x3b2857,_0x37a5ba){return _0x3b2857!==_0x37a5ba;},_0x1e26da[_0x18ffc9(0x408,0x486,0x3e5,0x386)]=_0x5dff6b(0x1cd,0x157,0xc6,0x1d0),_0x1e26da[_0x18ffc9(0x35e,0x374,0x2fd,0x356)]='hYYNC',_0x1e26da['WUXKa']=_0x5dff6b(0x136,0xf7,0xed,0x8b)+'3';const _0x2c429a=_0x1e26da,_0x3b263a=document[_0x18ffc9(0x466,0x478,0x4db,0x4bb)+_0x5dff6b(0xb6,0xa3,0x77,0x24)](_0x2c429a[_0x5dff6b(0x13e,0xee,0x17a,0xf0)]),_0x31d531=document[_0x18ffc9(0x43e,0x440,0x3fd,0x488)+'tor'](_0x2c429a[_0x5dff6b(0x180,0x137,0x157,0x138)]),_0x5b8114=document[_0x5dff6b(0x20f,0x1b2,0x15e,0x149)+_0x18ffc9(0x357,0x3c4,0x3b3,0x2e9)](_0x2c429a['yWhqW']);if(_0x3b263a[_0x18ffc9(0x3cc,0x371,0x366,0x43b)]&&_0x3b263a[_0x18ffc9(0x3cc,0x37c,0x365,0x3c2)][_0x18ffc9(0x3a9,0x38e,0x3e7,0x3fe)]('blob:')&&_0x2c429a[_0x5dff6b(0x13b,0x191,0x18d,0x138)](_0x3b263a[_0x5dff6b(0x197,0x118,0x14d,0x195)],_0x28baf4)){if(_0x2c429a['AVQry']!==_0x2c429a['NCsxm'])URL[_0x5dff6b(0xb1,0x11e,0x136,0x94)+_0x5dff6b(0x138,0x11f,0x17e,0xef)](_0x3b263a[_0x18ffc9(0x3cc,0x3b7,0x33e,0x33f)]);else{const _0x239df1=_0x121a4a['getElement'+'ById'](_0x2c429a[_0x5dff6b(0x14f,0x14b,0x1d5,0xd1)]),_0x484a72=_0x59b6ec['querySelec'+_0x18ffc9(0x3ec,0x45d,0x3d9,0x38d)](_0x2c429a[_0x5dff6b(0x1d4,0x194,0x11a,0x1fd)]),_0x533cca=_0x14bad3['getElement'+_0x18ffc9(0x357,0x2e1,0x336,0x31f)](_0x2c429a['qSKbo']);if(_0x2be2db&&_0x10b10b[_0x5dff6b(0xd6,0xf5,0xd3,0x10a)](_0x2c429a[_0x18ffc9(0x3af,0x40f,0x379,0x385)])){_0x239df1[_0x18ffc9(0x3cc,0x3d2,0x398,0x389)]=_0x1a6316,_0x239df1[_0x5dff6b(0xa5,0x12a,0xd0,0x105)][_0x18ffc9(0x42e,0x3cf,0x47c,0x499)]=_0x2c429a[_0x18ffc9(0x387,0x40c,0x3f2,0x346)],_0x484a72[_0x18ffc9(0x3de,0x3d2,0x404,0x3eb)][_0x18ffc9(0x42e,0x41a,0x42c,0x431)]=_0x2c429a[_0x18ffc9(0x3b2,0x3be,0x329,0x32a)],_0x533cca[_0x18ffc9(0x3de,0x3ca,0x439,0x35d)][_0x18ffc9(0x42e,0x429,0x486,0x3c6)]=_0x2c429a[_0x18ffc9(0x380,0x3f6,0x2f9,0x356)];const _0x37b854=_0x2d4bc8['split'](','),_0x11d250=_0x37b854[0x1525+0x10c7+0xc*-0x329][_0x18ffc9(0x374,0x31b,0x318,0x306)](':')[-0x1de3*-0x1+0xb*0x90+-0x1*0x2412][_0x18ffc9(0x374,0x38d,0x32b,0x327)](';')[-0x1950+0x11ae+0x7a2];_0x326a4e=_0x11d250,_0x4ea6e7[_0x18ffc9(0x3a8,0x42f,0x41b,0x3c4)+_0x5dff6b(0x1a9,0x11c,0xe4,0x18d)+'e']=_0x37b854[-0x1dbf*0x1+0x12b3+-0xb0d*-0x1];const _0x4096d9={};_0x4096d9['id']=_0x234e5b,_0x4096d9[_0x5dff6b(0x173,0x116,0x194,0x159)]=_0x2fb3dd,_0x4ea5d6[_0x5dff6b(0x1ae,0x1b4,0x19b,0x1af)+_0x5dff6b(0x1ae,0x14c,0x100,0xe9)](_0x4096d9);}else _0x239df1[_0x5dff6b(0x16d,0x118,0x14d,0xf0)]='',_0x239df1['style'][_0x5dff6b(0x130,0x17a,0x1da,0x1eb)]=_0x2c429a[_0x18ffc9(0x3b2,0x387,0x34a,0x405)],_0x484a72['style']['display']=_0x2c429a['rbTBf'],_0x533cca['style']['display']=_0x2c429a[_0x18ffc9(0x3b2,0x3dd,0x33a,0x376)],_0x55c92a['nai3VibeTr'+_0x5dff6b(0xaa,0x11c,0x173,0xa2)+'e']=null;}}if(_0x28baf4)_0x3b263a[_0x5dff6b(0x96,0x118,0x9a,0x14b)]=_0x28baf4,_0x3b263a[_0x5dff6b(0xe1,0x12a,0x11b,0xee)][_0x5dff6b(0x14d,0x17a,0x1d6,0x1fd)]=_0x2c429a['sCcFY'],_0x31d531[_0x5dff6b(0x197,0x12a,0x198,0xc1)][_0x5dff6b(0x198,0x17a,0x1e4,0x11b)]=_0x2c429a[_0x18ffc9(0x3b2,0x414,0x417,0x3dc)],_0x5b8114[_0x18ffc9(0x3de,0x469,0x39c,0x434)]['display']=_0x2c429a[_0x18ffc9(0x380,0x383,0x362,0x3b1)];else{if('GkdzX'!==_0x18ffc9(0x376,0x34a,0x3fd,0x38d)){const _0xfb7df9=_0x5bbe1c[_0x5dff6b(0x12c,0x197,0x10d,0x229)],_0x4b318b={};_0x4b318b[_0x18ffc9(0x3ca,0x3d8,0x384,0x3e0)]=_0xfb7df9,_0x4b318b[_0x18ffc9(0x421,0x4ae,0x3f8,0x461)+_0x5dff6b(0xdf,0xca,0xa7,0x38)]=_0x491ed3[_0x18ffc9(0x456,0x486,0x4b4,0x472)];const _0x42957a=_0x4b318b,_0x22b6a7={};_0x22b6a7['id']=_0x5bd9c1,_0x22b6a7['data']=_0x42957a,_0x764075[_0x5dff6b(0x1d3,0x1b4,0x220,0x1c1)+'rite'](_0x22b6a7);}else{const _0xef6055=_0x2c429a[_0x5dff6b(0x12a,0x186,0x1d1,0x137)][_0x18ffc9(0x374,0x3c9,0x405,0x2eb)]('|');let _0x51bb2f=-0xedd+0x2226+-0x1349;while(!![]){switch(_0xef6055[_0x51bb2f++]){case'0':_0x3b263a[_0x5dff6b(0x109,0x118,0x149,0xd8)]='';continue;case'1':window['comfyuican'+_0x5dff6b(0x102,0xa8,0x10b,0xb7)]=null;continue;case'2':_0x3b263a[_0x18ffc9(0x3de,0x3ad,0x3c7,0x3a9)][_0x5dff6b(0x183,0x17a,0x130,0x169)]=_0x2c429a[_0x18ffc9(0x3b2,0x442,0x32b,0x3a8)];continue;case'3':comfyuiImageObjectURL=null;continue;case'4':_0x5b8114['style'][_0x5dff6b(0x202,0x17a,0x1c4,0x171)]=_0x5dff6b(0x171,0x109,0x18e,0xbb);continue;case'5':_0x31d531['style']['display']=_0x2c429a['rbTBf'];continue;}break;}}}}function removeComfyUIImage(){const _0x200ede={'jXCFZ':function(_0x515606,_0x4bcb2a){return _0x515606(_0x4bcb2a);}};function _0x306fbe(_0x945283,_0x18858d,_0x4f47ef,_0x417f44){return _0x41454e(_0x945283-0xf7,_0x4f47ef,_0x4f47ef-0xe3,_0x417f44-0xe4);}_0x200ede['jXCFZ'](updateComfyUIImagePreview,null),dbs[_0x306fbe(-0x111,-0x14d,-0x9e,-0xce)+'e'](COMFYUI_REF_CACHE_KEY);}async function handleImageUpload2(_0x1ddd54){const _0x1ca86a={'DtfjI':_0x59641d(0x251,0x1f3,0x16b,0x1fb)+'ing\x20cached'+_0x59641d(0x27b,0x35d,0x353,0x304)+_0x59641d(0x1fc,0x1fe,0x1c2,0x1f5)+_0x32ad8b(-0x15a,-0x18c,-0x19b,-0x169),'pyfez':_0x59641d(0x1e4,0x1ed,0x188,0x1f4)+_0x32ad8b(-0x10d,-0xa5,-0x110,-0xd6)+_0x59641d(0x330,0x280,0x32f,0x2ce)+_0x59641d(0x2b2,0x236,0x215,0x28b),'jHWah':function(_0x6521e8,_0x1592bd){return _0x6521e8(_0x1592bd);},'WRHOb':_0x32ad8b(-0x103,-0x14f,-0x182,-0x107),'uKWHQ':_0x59641d(0x2ef,0x2cc,0x23d,0x269)+_0x32ad8b(-0x1b4,-0x20f,-0x1a5,-0x188)+_0x59641d(0x2cf,0x1f7,0x1cc,0x253)+'w-containe'+_0x32ad8b(-0xb0,-0x12f,-0x135,-0x135)+'u8-image-p'+'laceholder','CnwXX':_0x59641d(0x325,0x2db,0x2fb,0x2e1)+'move-char-'+_0x59641d(0x30b,0x344,0x2f1,0x2d0)+_0x59641d(0x237,0x285,0x256,0x203),'mipuD':_0x32ad8b(-0x108,-0x192,-0x134,-0x1b1),'HRuIv':_0x32ad8b(-0x194,-0x207,-0x1c1,-0x1b2),'khPZB':_0x59641d(0x328,0x23f,0x233,0x2b6),'blccF':'flex','CrhuU':function(_0x1d10ea,_0x2a1736){return _0x1d10ea!==_0x2a1736;},'InENV':_0x32ad8b(-0x1c3,-0x208,-0x210,-0x209),'KCPzR':function(_0xfb5cf5,_0x5279e6){return _0xfb5cf5!==_0x5279e6;},'VLYTr':'请先设置ComfyU'+_0x32ad8b(-0x1e7,-0x226,-0x1aa,-0x124),'UnrxZ':function(_0x197502){return _0x197502();},'NeqXJ':function(_0x53cf62,_0x4151b1,_0x4c37f7){return _0x53cf62(_0x4151b1,_0x4c37f7);},'EmPox':_0x32ad8b(-0xf3,-0xdc,-0x142,-0x139),'DKioi':function(_0x462fc5,_0x1393b7){return _0x462fc5===_0x1393b7;},'wSztB':_0x32ad8b(-0x220,-0x1e6,-0x1c6,-0x22b),'bwKXt':_0x59641d(0x297,0x24e,0x2a0,0x222),'kppWr':function(_0x35fc81,_0x351a77){return _0x35fc81+_0x351a77;},'FRntS':function(_0x904329){return _0x904329();},'odABT':_0x32ad8b(-0x1a8,-0x1b5,-0x209,-0x204)+':'},_0x466446=extension_settings[extensionName];function _0x32ad8b(_0x3e73f1,_0x305711,_0xede3e3,_0x58fdb4){return _0x4da2ea(_0x3e73f1-0x1f3,_0x58fdb4,_0xede3e3-0x1ab,_0xede3e3- -0x2e2);}function _0x59641d(_0x1d278a,_0x36e7a2,_0x171cf6,_0x466eb9){return _0x41454e(_0x1d278a-0x64,_0x36e7a2,_0x171cf6-0xfa,_0x466eb9-0x431);}const _0x4aaffc=_0x1ddd54['target'][_0x59641d(0x1f2,0x274,0x2dd,0x259)][0x851+0xd95*-0x1+0x2a2*0x2];if(!_0x4aaffc)return;try{if(_0x1ca86a[_0x32ad8b(-0x222,-0x1ae,-0x1e3,-0x1ad)](_0x1ca86a[_0x59641d(0x1cf,0x215,0x28c,0x205)],_0x1ca86a[_0x59641d(0x1c2,0x1f6,0x1fe,0x205)]))_0xe973f5[_0x32ad8b(-0x1d9,-0x1be,-0x1be,-0x1db)](_0x1ca86a[_0x32ad8b(-0x148,-0x183,-0x1da,-0x249)],_0x374750);else{const _0x5ae74c=await _0x1ca86a['jHWah'](processUploadedImageToBlob,_0x4aaffc),_0x5c8ca0=URL[_0x32ad8b(-0x16d,-0xf3,-0x11d,-0xb2)+_0x59641d(0x268,0x2c3,0x2d2,0x26d)](_0x5ae74c);comfyuiImageObjectURL=_0x5c8ca0,_0x1ca86a[_0x59641d(0x2a3,0x281,0x1a2,0x215)](updateComfyUIImagePreview,_0x5c8ca0);const _0x6fa7d6=new FormData();_0x6fa7d6[_0x59641d(0x25e,0x175,0x1a4,0x1fc)](_0x32ad8b(-0x21f,-0x154,-0x196,-0x1a9),_0x5ae74c,_0x4aaffc['name']);let _0x3bffd4=_0x466446[_0x59641d(0x29a,0x1f8,0x1ca,0x23d)][_0x32ad8b(-0x18f,-0xdf,-0x159,-0x125)]();if(!_0x3bffd4){if(_0x1ca86a['KCPzR']('oDZoP','RUERg')){_0x1ca86a[_0x59641d(0x254,0x185,0x22c,0x215)](alert,_0x1ca86a[_0x32ad8b(-0x231,-0x1b5,-0x1b7,-0x213)]),_0x1ca86a[_0x32ad8b(-0x10d,-0x145,-0x19f,-0x178)](removeComfyUIImage);return;}else _0x3ac4ce();}const _0x2458f2=await _0x1ca86a[_0x32ad8b(-0x252,-0x1c9,-0x1dd,-0x1ad)](fetch,_0x3bffd4+(_0x59641d(0x225,0x24d,0x2a0,0x22a)+_0x59641d(0x311,0x27b,0x22d,0x295)),{'method':_0x1ca86a[_0x32ad8b(-0x1fd,-0x232,-0x20b,-0x23e)],'body':_0x6fa7d6});if(_0x2458f2['ok']){if(_0x1ca86a['DKioi'](_0x1ca86a['wSztB'],_0x1ca86a[_0x32ad8b(-0x184,-0x135,-0x16d,-0x115)])){const _0x4c2867=await _0x2458f2[_0x59641d(0x312,0x2d7,0x262,0x2e6)]();window[_0x59641d(0x27f,0x2da,0x373,0x2f3)+_0x32ad8b(-0x255,-0x20d,-0x222,-0x240)]=_0x4c2867[_0x59641d(0x33f,0x281,0x379,0x2f0)],addLog(_0x32ad8b(-0x276,-0x242,-0x204,-0x27f)+'器返回数据:\x20'+JSON[_0x59641d(0x203,0x2a8,0x1a7,0x23a)](_0x4c2867)),console['log'](_0x59641d(0x26f,0x248,0x1d8,0x260)+'回数据:',_0x4c2867);const _0x43a2d2=new FileReader();_0x43a2d2['onloadend']=()=>{function _0x5a1209(_0xa3ed24,_0x5087a7,_0x3c9c0e,_0x233161){return _0x32ad8b(_0xa3ed24-0xfa,_0x5087a7-0x1bf,_0x5087a7-0xc,_0x233161);}const _0x4f303e=_0x43a2d2['result'];function _0x57b0f8(_0x4732e5,_0x46b444,_0x4775c3,_0x174a19){return _0x32ad8b(_0x4732e5-0x177,_0x46b444-0x1a7,_0x4775c3-0x3f5,_0x4732e5);}const _0x584af3={};_0x584af3[_0x57b0f8(0x205,0x1e3,0x241,0x234)]=_0x4f303e,_0x584af3[_0x57b0f8(0x265,0x30a,0x298,0x31f)+_0x5a1209(-0x1ad,-0x1f4,-0x1ec,-0x187)]=_0x4c2867[_0x5a1209(-0x115,-0x11c,-0x137,-0xa1)];const _0x2bbc7f=_0x584af3,_0xaf41fe={};_0xaf41fe['id']=COMFYUI_REF_CACHE_KEY,_0xaf41fe[_0x57b0f8(0x202,0x294,0x241,0x28c)]=_0x2bbc7f,dbs[_0x5a1209(-0x86,-0x10a,-0x118,-0x87)+_0x5a1209(-0x1b9,-0x172,-0x1ab,-0x171)](_0xaf41fe);},_0x43a2d2[_0x59641d(0x29b,0x1e1,0x2ab,0x238)+'URL'](_0x5ae74c);}else _0x36c29d[_0x59641d(0x26e,0x1cc,0x24a,0x25a)](_0x1ca86a[_0x59641d(0x26f,0x225,0x2b0,0x283)],_0x503089),_0x1ca86a[_0x59641d(0x24d,0x231,0x28a,0x215)](_0x10d73b,_0x1ca86a['WRHOb']+_0x36e3dd[_0x32ad8b(-0x1de,-0x228,-0x20c,-0x259)]);}else{if(_0x1ca86a[_0x59641d(0x262,0x2c2,0x2ba,0x258)]('Ajjrs',_0x1ca86a[_0x59641d(0x2cb,0x278,0x31e,0x2ed)])){const _0x1c055f=await _0x2458f2[_0x59641d(0x19e,0x255,0x28f,0x219)]();alert(_0x1ca86a[_0x32ad8b(-0xbe,-0x174,-0x119,-0xa0)](_0x32ad8b(-0x14a,-0x138,-0x1ad,-0x1d4),_0x1c055f)),_0x1ca86a['jHWah'](addLog,_0x32ad8b(-0x210,-0x168,-0x1c3,-0x247)+_0x59641d(0x2ce,0x326,0x2fe,0x2af)+_0x1c055f),console[_0x59641d(0x246,0x224,0x20e,0x25a)](_0x59641d(0x250,0x2ca,0x226,0x2a4),_0x1c055f),_0x1ca86a[_0x32ad8b(-0x146,-0x184,-0x16a,-0x102)](removeComfyUIImage);}else{const _0x4bb23d=_0x4e8641[_0x59641d(0x2ae,0x34c,0x2b6,0x300)+_0x59641d(0x212,0x23f,0x1ed,0x1f1)](_0x32ad8b(-0x15c,-0x173,-0x1d4,-0x25e)+_0x32ad8b(-0xf1,-0x1d7,-0x154,-0x1dc)+_0x32ad8b(-0xb1,-0xbf,-0x11c,-0x99)),_0x30ca71=_0x17a41b[_0x32ad8b(-0xdd,-0xd2,-0x140,-0x115)+_0x59641d(0x27a,0x216,0x2e1,0x286)](_0x1ca86a['uKWHQ']),_0x3c7967=_0x5ad690['getElement'+_0x59641d(0x278,0x232,0x278,0x1f1)](_0x1ca86a['CnwXX']);if(_0x17a327&&_0x3cbebe['startsWith'](_0x1ca86a['mipuD'])){_0x4bb23d['src']=_0x51bd49,_0x4bb23d['style'][_0x32ad8b(-0x134,-0xef,-0x150,-0x187)]=_0x59641d(0x341,0x31b,0x291,0x2ea),_0x30ca71['style'][_0x32ad8b(-0x164,-0x150,-0x150,-0x143)]=_0x1ca86a[_0x32ad8b(-0x223,-0x245,-0x212,-0x26e)],_0x3c7967[_0x59641d(0x227,0x2d6,0x29d,0x278)][_0x59641d(0x2f6,0x317,0x2f1,0x2c8)]=_0x59641d(0x2e3,0x31d,0x27e,0x2dd)+'x';const _0x171007=_0x2a15dd[_0x59641d(0x1fa,0x204,0x21c,0x20e)](','),_0x3ef4b7=_0x171007[0x1*-0xf7f+-0x91*0x7+-0x2f*-0x6a][_0x32ad8b(-0x29c,-0x203,-0x20a,-0x24c)](':')[-0x263*-0xb+0x3*0x8ef+0x3*-0x11af]['split'](';')[0x12b3*-0x1+-0x2615*-0x1+-0x1362];_0x50ef46=_0x3ef4b7,_0x28b10d[_0x59641d(0x1d2,0x178,0x1ce,0x1ea)+'fImage']=_0x171007[-0x1411+-0x2*-0x9e1+0xa*0x8];const _0x2378c5={};_0x2378c5['id']=_0x7bb2ee,_0x2378c5[_0x59641d(0x1e7,0x1d9,0x235,0x264)]=_0x18d7e7,_0x4982c3[_0x32ad8b(-0x195,-0xf7,-0x116,-0x147)+_0x59641d(0x31c,0x325,0x279,0x29a)](_0x2378c5);}else{const _0x19031d=_0x1ca86a['khPZB'][_0x59641d(0x274,0x214,0x258,0x20e)]('|');let _0x68ce8c=0x35*0x5f+0x25a+-0x1605;while(!![]){switch(_0x19031d[_0x68ce8c++]){case'0':_0x4bb23d[_0x59641d(0x1dd,0x2bf,0x241,0x266)]='';continue;case'1':_0x3c7967['style'][_0x59641d(0x29f,0x32c,0x2da,0x2c8)]=_0x59641d(0x1ce,0x231,0x22c,0x257);continue;case'2':_0x30ca71[_0x32ad8b(-0x140,-0x121,-0x1a0,-0x15f)]['display']=_0x1ca86a[_0x59641d(0x353,0x29a,0x296,0x2c7)];continue;case'3':_0x4bb23d[_0x32ad8b(-0x181,-0x187,-0x1a0,-0x141)][_0x32ad8b(-0x1cd,-0x176,-0x150,-0x14d)]=_0x1ca86a['HRuIv'];continue;case'4':_0x1a2f99['nai3CharRe'+_0x32ad8b(-0x161,-0xc0,-0x10d,-0x138)]=null;continue;}break;}}}}}}catch(_0x113784){_0x1ca86a['jHWah'](alert,_0x1ca86a[_0x32ad8b(-0x183,-0x17a,-0x119,-0x16b)]('图片处理或上传时出错'+':\x20',_0x113784[_0x32ad8b(-0x229,-0x214,-0x20c,-0x213)])),console[_0x59641d(0x27b,0x1e4,0x25f,0x25a)](_0x1ca86a[_0x59641d(0x2df,0x331,0x281,0x2f9)],_0x113784),_0x1ca86a[_0x59641d(0x1a4,0x1b3,0x21c,0x215)](addLog,_0x32ad8b(-0x242,-0x1f2,-0x1c3,-0x205)+_0x32ad8b(-0x176,-0x195,-0x169,-0x19a)+JSON[_0x32ad8b(-0x151,-0x1dd,-0x1de,-0x1fb)](_0x113784)),removeComfyUIImage();}}async function loadCachedImages(){const _0x106ad6={'befYt':function(_0x24f407,_0x5e2f23){return _0x24f407(_0x5e2f23);},'eCHpB':'(((.+)+)+)'+'+$','LPsyV':_0x1311a9(-0x1c7,-0x257,-0x246,-0x27e)+_0x4ca92f(0x33d,0x233,0x2b5,0x315),'KjElT':function(_0x1c8c2d){return _0x1c8c2d();},'xfmbf':function(_0x194452,_0x3a7e79){return _0x194452(_0x3a7e79);},'IoJBP':function(_0x1f9f09,_0x579d6e){return _0x1f9f09===_0x579d6e;},'AsHoE':'gvJWw','tBgJl':_0x1311a9(-0x1fa,-0x270,-0x21a,-0x267),'UIkiO':_0x4ca92f(0x32e,0x30e,0x2fe,0x2eb),'XYZUC':function(_0x3dcd3b,_0x100973){return _0x3dcd3b(_0x100973);},'njjQB':function(_0x5a3779,_0x25bd9a){return _0x5a3779===_0x25bd9a;},'zSJgd':'buoQq','FjPQP':function(_0x46d355,_0x285d0e){return _0x46d355!==_0x285d0e;},'UEWyh':_0x1311a9(-0x2db,-0x294,-0x324,-0x210),'gjJhU':_0x1311a9(-0x2a9,-0x30b,-0x317,-0x294),'PzkoW':_0x4ca92f(0x2b8,0x24e,0x242,0x276)+_0x4ca92f(0x204,0x1e9,0x265,0x2f3)+_0x4ca92f(0x384,0x372,0x34b,0x338)+'har\x20Ref\x20im'+'age:','ofwjx':'meIum','bKirH':_0x4ca92f(0x372,0x31d,0x33c,0x344),'LWvzg':function(_0x7c6e4d,_0x5e5f91){return _0x7c6e4d(_0x5e5f91);},'WZaSe':function(_0x292ba9,_0x55b636){return _0x292ba9===_0x55b636;},'LxJxz':_0x4ca92f(0x241,0x23b,0x24b,0x1fa),'IaTKh':_0x4ca92f(0x2d3,0x2c0,0x2d8,0x280),'CysDt':function(_0x264b06,_0x1b7d99){return _0x264b06(_0x1b7d99);},'WEhWX':_0x1311a9(-0x22b,-0x217,-0x1cb,-0x28a)};await dbs['openDB']();function _0x1311a9(_0x5bb574,_0xd9015,_0x1d292e,_0x268a1c){return _0x41454e(_0x5bb574-0x15f,_0x268a1c,_0x1d292e-0x34,_0xd9015- -0xda);}try{if(_0x106ad6[_0x1311a9(-0x2d0,-0x2e7,-0x317,-0x266)](_0x106ad6['AsHoE'],_0x106ad6[_0x1311a9(-0x1f2,-0x259,-0x2a4,-0x2c8)])){const _0x2cc8ec=await dbs['storeReadO'+_0x1311a9(-0x27a,-0x2f9,-0x370,-0x2a0)](NAI_VIBE_CACHE_KEY);_0x2cc8ec&&_0x2cc8ec[_0x4ca92f(0x287,0x24e,0x2ab,0x2f1)]&&(_0x106ad6['IoJBP'](_0x106ad6[_0x4ca92f(0x325,0x225,0x292,0x2ac)],_0x106ad6[_0x1311a9(-0x2b9,-0x262,-0x231,-0x240)])?(_0x106ad6['befYt'](_0x3da9cb,null),_0x175a09[_0x1311a9(-0x221,-0x28c,-0x239,-0x2e4)+'e'](_0x2d4cb5)):_0x106ad6[_0x4ca92f(0x2ba,0x2de,0x258,0x225)](updateNovelaiImagePreview,_0x2cc8ec[_0x1311a9(-0x234,-0x2a7,-0x24e,-0x261)]));}else return _0x811fae['toString']()[_0x1311a9(-0x267,-0x21d,-0x2a5,-0x288)](CncwkC[_0x1311a9(-0x1f1,-0x265,-0x295,-0x28d)])[_0x4ca92f(0x2e2,0x308,0x318,0x3a1)]()[_0x1311a9(-0x21c,-0x242,-0x253,-0x1b9)+'r'](_0x26d9d4)['search'](_0x4ca92f(0x34f,0x328,0x341,0x343)+'+$');}catch(_0x2fcda9){console['error'](_0x1311a9(-0x39e,-0x310,-0x348,-0x2c7)+'ing\x20cached'+'\x20NovelAI\x20V'+'ibe\x20image:',_0x2fcda9);}try{if(_0x106ad6[_0x4ca92f(0x32e,0x2c7,0x2e6,0x277)](_0x4ca92f(0x294,0x2c5,0x297,0x2e0),_0x106ad6[_0x4ca92f(0x2c2,0x26f,0x26d,0x2e2)])){const _0x4fa063=await dbs[_0x1311a9(-0x2d7,-0x264,-0x2d9,-0x22e)+_0x1311a9(-0x273,-0x2f9,-0x356,-0x332)](NAI_CHAR_REF_CACHE_KEY);if(_0x4fa063&&_0x4fa063['data']){if(_0x106ad6[_0x4ca92f(0x267,0x2a7,0x280,0x2df)](_0x106ad6['UEWyh'],_0x106ad6[_0x4ca92f(0x289,0x23a,0x24e,0x244)]))_0x106ad6[_0x1311a9(-0x324,-0x2a8,-0x2d6,-0x272)](updateNovelaiCharRefImagePreview,_0x4fa063[_0x4ca92f(0x24f,0x21e,0x2ab,0x2a5)]);else{if(_0x279cb5){const _0x12ba08=_0x2aa66b['apply'](_0x588ae6,arguments);return _0x121087=null,_0x12ba08;}}}}else{const _0x387109=_0x5b39e2?function(){function _0x15e0af(_0x7df52a,_0x137fd9,_0x58a98a,_0x339696){return _0x4ca92f(_0x7df52a-0x19e,_0x58a98a,_0x7df52a- -0x11d,_0x339696-0x1f0);}if(_0x5bc58d){const _0x3ac798=_0x20b320[_0x15e0af(0x180,0x12b,0x1f5,0x14c)](_0x3c835f,arguments);return _0x1dc776=null,_0x3ac798;}}:function(){};return _0x40d301=![],_0x387109;}}catch(_0x316764){console[_0x4ca92f(0x314,0x234,0x2a1,0x242)](_0x106ad6[_0x4ca92f(0x393,0x364,0x34c,0x2fa)],_0x316764);}function _0x4ca92f(_0x1a9fca,_0x413f21,_0x37a49b,_0x28bbb2){return _0x4da2ea(_0x1a9fca-0x13a,_0x413f21,_0x37a49b-0x177,_0x37a49b-0x17d);}try{if(_0x106ad6[_0x1311a9(-0x246,-0x2d2,-0x2e1,-0x27a)](_0x106ad6[_0x4ca92f(0x2c9,0x355,0x2e3,0x2b1)],_0x106ad6[_0x4ca92f(0x319,0x33d,0x33f,0x362)])){const _0x5e4f5b=await dbs[_0x1311a9(-0x2c0,-0x264,-0x267,-0x278)+_0x4ca92f(0x247,0x1e6,0x259,0x271)](COMFYUI_REF_CACHE_KEY);if(_0x5e4f5b&&_0x5e4f5b[_0x1311a9(-0x24d,-0x2a7,-0x258,-0x286)]&&_0x5e4f5b[_0x4ca92f(0x24e,0x2e9,0x2ab,0x225)]['data']&&_0x5e4f5b[_0x1311a9(-0x30f,-0x2a7,-0x336,-0x29e)][_0x4ca92f(0x38c,0x2a2,0x302,0x2c0)+_0x1311a9(-0x2dd,-0x2f3,-0x2ab,-0x274)]){const _0x1e97a7=_0x5e4f5b[_0x1311a9(-0x292,-0x2a7,-0x25a,-0x26d)],_0x1e82dc=await _0x106ad6[_0x4ca92f(0x25e,0x1db,0x237,0x2c8)](fetch,_0x1e97a7['data']),_0x25e597=await _0x1e82dc[_0x1311a9(-0x253,-0x22f,-0x1bb,-0x219)](),_0x564ac1=URL['createObje'+'ctURL'](_0x25e597);_0x106ad6[_0x1311a9(-0x30e,-0x31b,-0x383,-0x349)](updateComfyUIImagePreview,_0x564ac1),comfyuiImageObjectURL=_0x564ac1,window[_0x4ca92f(0x344,0x381,0x33a,0x2d3)+'kaotupian']=_0x1e97a7[_0x1311a9(-0x287,-0x250,-0x1c9,-0x2dd)+_0x1311a9(-0x289,-0x2f3,-0x2cf,-0x2b0)],addLog('从缓存加载Comfy'+_0x4ca92f(0x298,0x2e7,0x2f4,0x348)+_0x1e97a7[_0x4ca92f(0x2ad,0x274,0x302,0x2d1)+'Name']),console[_0x4ca92f(0x2bd,0x2cd,0x2a9,0x2ec)]('Loaded\x20Com'+'fyUI\x20image'+_0x1311a9(-0x288,-0x297,-0x226,-0x314)+'e:\x20'+_0x1e97a7[_0x1311a9(-0x281,-0x250,-0x22f,-0x2af)+'Name']);}else{if(_0x5e4f5b&&_0x106ad6['WZaSe'](typeof _0x5e4f5b[_0x1311a9(-0x27c,-0x2a7,-0x2e7,-0x2e3)],_0x4ca92f(0x2ff,0x2ca,0x350,0x3ce))){if(_0x106ad6[_0x1311a9(-0x2a9,-0x234,-0x268,-0x1ec)](_0x106ad6[_0x1311a9(-0x245,-0x261,-0x2ba,-0x219)],_0x106ad6[_0x1311a9(-0x1ed,-0x236,-0x261,-0x270)])){_0xd7cf38(_0x106ad6[_0x1311a9(-0x322,-0x2ee,-0x2d2,-0x2d0)]),_0x106ad6[_0x1311a9(-0x2d8,-0x2d4,-0x34e,-0x2a7)](_0x2051f);return;}else{const _0x166ae2=await fetch(_0x5e4f5b[_0x4ca92f(0x2da,0x334,0x2ab,0x321)]),_0x20fff4=await _0x166ae2[_0x4ca92f(0x3a0,0x35e,0x323,0x3a3)](),_0xebc668=URL[_0x1311a9(-0x1cb,-0x210,-0x294,-0x23d)+_0x1311a9(-0x2fb,-0x29e,-0x2c8,-0x2d9)](_0x20fff4);_0x106ad6[_0x4ca92f(0x2cb,0x347,0x327,0x2d2)](updateComfyUIImagePreview,_0xebc668),comfyuiImageObjectURL=_0xebc668,console['warn'](_0x4ca92f(0x2b1,0x2ce,0x2ce,0x25b)+'fyUI\x20image'+_0x1311a9(-0x2e6,-0x290,-0x2e0,-0x255)+'cache\x20form'+_0x4ca92f(0x309,0x347,0x351,0x3bc)+_0x1311a9(-0x22b,-0x21f,-0x260,-0x1ae)+_0x4ca92f(0x367,0x2c6,0x30d,0x2a4)+_0x4ca92f(0x337,0x30c,0x2da,0x26d)+_0x1311a9(-0x330,-0x2be,-0x2fb,-0x33b)+'rmat.');}}}}else _0x106ad6[_0x1311a9(-0x24b,-0x21c,-0x2a6,-0x20f)](_0x42b8fe,null),_0x331827[_0x4ca92f(0x281,0x293,0x2c6,0x2d7)+'e'](_0x47af38);}catch(_0x1d84b6){_0x106ad6[_0x1311a9(-0x28b,-0x234,-0x1d1,-0x1d0)](_0x106ad6['WEhWX'],_0x4ca92f(0x21f,0x21a,0x279,0x22f))?_0x106ad6[_0x4ca92f(0x30f,0x245,0x27e,0x2b9)](_0x4e9224):console[_0x1311a9(-0x237,-0x2b1,-0x343,-0x32a)](_0x4ca92f(0x283,0x294,0x242,0x1eb)+_0x1311a9(-0x297,-0x2ed,-0x359,-0x33f)+_0x1311a9(-0x279,-0x232,-0x275,-0x1f3)+_0x4ca92f(0x204,0x2a3,0x263,0x2df),_0x1d84b6);}}export function initImageUpload(_0x4b3993){const _0x32811c={'DEmfF':'VnYDM','PfCRM':'ynXsB','LQkLr':'fwhAh','gRHxh':function(_0xd154c5){return _0xd154c5();},'quFyt':'JqlYm','HGbNf':'imageInput'+_0x2ef879(0x1f3,0x24b,0x1d3,0x1df)+_0x2ef879(0x1db,0x1f7,0x153,0x1ba),'oLRxT':_0x5c5f17(0x343,0x3af,0x35e,0x344)+_0x2ef879(0x1d2,0x1b4,0x238,0x170),'xbdWM':function(_0x198162,_0x44a02b){return _0x198162!==_0x44a02b;},'hyXBC':'JUGNE','rtxQd':function(_0x48e3f3){return _0x48e3f3();},'UrmFd':_0x5c5f17(0x34e,0x35e,0x305,0x2d9)+_0x5c5f17(0x286,0x338,0x274,0x2d7)+_0x5c5f17(0x3d4,0x3c2,0x3bf,0x398),'ZQzFg':_0x5c5f17(0x3b8,0x30f,0x316,0x32f),'kaTav':'#novelai-r'+_0x2ef879(0x1d5,0x17a,0x23a,0x1b5)+_0x5c5f17(0x3cc,0x3d6,0x3fc,0x398),'fmUZk':'#novelai-s'+'elect-char'+_0x5c5f17(0x32a,0x361,0x2cc,0x31d)+_0x2ef879(0x1ad,0x1c4,0x17d,0x13e),'JlHvO':_0x5c5f17(0x39e,0x322,0x36e,0x34b)+'t_nai_char'+_0x5c5f17(0x3e3,0x3e3,0x3d4,0x352),'WnNPZ':'change','PqaHq':_0x5c5f17(0x318,0x38a,0x3bc,0x341)+_0x2ef879(0x184,0x1c2,0x1f0,0x15c)+_0x5c5f17(0x350,0x385,0x3db,0x398),'bNSVe':_0x5c5f17(0x374,0x354,0x30b,0x34b)+'t2'};function _0x5c5f17(_0x3a58a4,_0x432bc4,_0x266ed0,_0x3a4da4){return _0x41454e(_0x3a58a4-0x15a,_0x3a58a4,_0x266ed0-0x193,_0x3a4da4-0x4c2);}_0x32811c[_0x5c5f17(0x2eb,0x2c6,0x26c,0x2e5)](loadCachedImages),_0x4b3993[_0x5c5f17(0x364,0x2ea,0x367,0x334)](_0x32811c[_0x5c5f17(0x1fd,0x2ca,0x2f2,0x27c)])['on'](_0x32811c['ZQzFg'],()=>{function _0x15e8ca(_0x2c35ef,_0x438d74,_0x13bfb3,_0x11d7de){return _0x5c5f17(_0x11d7de,_0x438d74-0x186,_0x13bfb3-0x161,_0x13bfb3-0x1f1);}function _0x4bfdbc(_0x1469c3,_0x472679,_0x3522fa,_0x21380d){return _0x5c5f17(_0x472679,_0x472679-0x12,_0x3522fa-0x16a,_0x21380d- -0x1ee);}_0x32811c[_0x4bfdbc(0x11c,0x9c,0x137,0xd3)]!==_0x32811c[_0x4bfdbc(0xd9,0x17f,0xd0,0xed)]?document['getElement'+'ById'](_0x4bfdbc(0x1e5,0x1b8,0x1e2,0x156)+_0x15e8ca(0x4c4,0x567,0x516,0x588))[_0x4bfdbc(0x120,0x122,0xb7,0x141)]():_0x57e36a[_0x4bfdbc(0x120,0xbe,0x122,0xfd)](_0x15e8ca(0x3f8,0x427,0x47d,0x500)+_0x4bfdbc(0x78,0x3e,0x7c,0xc1)+_0x4bfdbc(0x7f,0x63,0x68,0xf2)+_0x15e8ca(0x4bb,0x4d7,0x4dd,0x4ac),_0x39ed95);}),_0x4b3993[_0x2ef879(0x1e1,0x218,0x1c1,0x1af)]('#imageInpu'+_0x2ef879(0x13c,0x137,0x191,0x180))['on'](_0x5c5f17(0x34c,0x2d5,0x29f,0x311),handleNovelaiImageUpload),_0x4b3993[_0x5c5f17(0x3c6,0x378,0x2d1,0x334)](_0x32811c[_0x2ef879(0x209,0x25c,0x182,0x1d5)])['on'](_0x32811c[_0x2ef879(0x1bc,0x22f,0x1a1,0x206)],()=>{function _0x200570(_0x435b44,_0x1ca301,_0x3b6fde,_0x4e83d1){return _0x2ef879(_0x435b44-0x343,_0x1ca301-0x168,_0x4e83d1,_0x4e83d1-0x1e3);}function _0x4bb171(_0x34eedd,_0x35fb0e,_0x5a13d3,_0x8f7a4d){return _0x5c5f17(_0x5a13d3,_0x35fb0e-0xa0,_0x5a13d3-0x16a,_0x8f7a4d- -0x46a);}if(_0x32811c[_0x4bb171(-0x188,-0x160,-0x19b,-0x1b0)]!==_0x32811c[_0x4bb171(-0x140,-0x19d,-0x23b,-0x1b0)]){const _0x2057ed=_0x54960b['apply'](_0x3b925b,arguments);return _0x2d5663=null,_0x2057ed;}else _0x32811c[_0x200570(0x4e6,0x4df,0x471,0x4cb)](removeNovelaiImage);});function _0x2ef879(_0x596309,_0x4cfca9,_0x3be442,_0x4b06ec){return _0x4da2ea(_0x596309-0x1c6,_0x3be442,_0x3be442-0x19b,_0x596309-0x74);}_0x4b3993[_0x2ef879(0x1e1,0x17a,0x1ee,0x1ec)](_0x32811c['fmUZk'])['on'](_0x32811c[_0x5c5f17(0x335,0x38f,0x32a,0x30f)],()=>{function _0x1283e8(_0x5a98d1,_0x521ab2,_0xc5b6df,_0x6196b0){return _0x5c5f17(_0x521ab2,_0x521ab2-0xd6,_0xc5b6df-0x152,_0x5a98d1- -0x2b5);}function _0x303580(_0x43189d,_0x267bc0,_0x1e8ea8,_0x1f20b2){return _0x2ef879(_0x43189d- -0xad,_0x267bc0-0x176,_0x1e8ea8,_0x1f20b2-0xf6);}'JqlYm'===_0x32811c[_0x303580(0xb0,0x1d,0x34,0xba)]?document['getElement'+_0x303580(0x82,0xca,0x8b,0xde)](_0x32811c[_0x303580(0xb8,0x44,0xf1,0xa9)])['click']():(_0x14ae07(null),_0x366846['storeDelet'+'e'](_0x2a64e5));}),_0x4b3993['find'](_0x32811c[_0x5c5f17(0x2a9,0x300,0x36e,0x323)])['on'](_0x32811c[_0x5c5f17(0x337,0x2f9,0x38d,0x36b)],handleNovelaiCharRefImageUpload),_0x4b3993[_0x2ef879(0x1e1,0x223,0x23a,0x20f)]('#novelai-r'+_0x2ef879(0x1a6,0x1ad,0x194,0x22e)+_0x2ef879(0x1ca,0x21c,0x248,0x24f)+_0x2ef879(0x1ad,0x14b,0x207,0x1ec))['on'](_0x2ef879(0x1dc,0x199,0x211,0x23b),()=>{removeNovelaiCharRefImage();}),_0x4b3993[_0x2ef879(0x1e1,0x20a,0x1e8,0x165)](_0x32811c[_0x2ef879(0x225,0x264,0x19d,0x1a8)])['on'](_0x5c5f17(0x3a2,0x319,0x33f,0x32f),()=>{function _0x4adb6f(_0xacac09,_0x467000,_0x26ccf3,_0x56fbf0){return _0x2ef879(_0x26ccf3-0x169,_0x467000-0xc7,_0x467000,_0x56fbf0-0xd6);}function _0xadc758(_0x4e93a1,_0x19c56e,_0x38a7d0,_0x31116c){return _0x2ef879(_0x19c56e-0x329,_0x19c56e-0x155,_0x38a7d0,_0x31116c-0x57);}_0x32811c[_0x4adb6f(0x381,0x3d7,0x390,0x323)](_0x32811c[_0xadc758(0x457,0x4ce,0x4a0,0x443)],_0x4adb6f(0x278,0x270,0x2da,0x33f))?document[_0x4adb6f(0x356,0x3ff,0x3a7,0x385)+_0x4adb6f(0x2e7,0x2d8,0x298,0x281)]('imageInput'+'2')[_0x4adb6f(0x304,0x393,0x345,0x3a4)]():_0x41d45e[_0xadc758(0x542,0x567,0x5d9,0x4d7)+_0x4adb6f(0x22c,0x23e,0x298,0x24a)](_0x32811c[_0xadc758(0x461,0x493,0x4be,0x40c)])['click']();}),_0x4b3993[_0x2ef879(0x1e1,0x1c2,0x20e,0x214)](_0x32811c['bNSVe'])['on'](_0x5c5f17(0x399,0x384,0x398,0x311),handleImageUpload2),_0x4b3993[_0x5c5f17(0x33d,0x303,0x2ec,0x334)](_0x5c5f17(0x25f,0x225,0x242,0x27d)+_0x2ef879(0x1d5,0x234,0x1ed,0x147)+'e-btn')['on'](_0x32811c[_0x5c5f17(0x293,0x30c,0x37b,0x30f)],()=>{removeComfyUIImage();});}export{updateNovelaiImagePreview,updateNovelaiCharRefImagePreview,updateComfyUIImagePreview,nai3VibeTransferImageMimeType,nai3CharRefImageMimeType,comfyuiImageObjectURL};