(function(_0x2555bc,_0x56ed7a){const _0x252cc5=_0x2555bc();function _0x44bed9(_0x2df577,_0x2d4aef,_0x3d2bbb,_0x1d2bfd){return _0x4843(_0x3d2bbb-0x188,_0x2df577);}function _0x1ffc84(_0x4dd887,_0x2d1128,_0x4de54e,_0xc9fbf){return _0x4843(_0x4de54e-0xf3,_0xc9fbf);}while(!![]){try{const _0x3b12b5=-parseInt(_0x1ffc84(0x29b,0x211,0x265,0x1f9))/(-0xe66+0x1f*-0x3d+0x1*0x15ca)*(-parseInt(_0x44bed9(0x37f,0x3d2,0x39e,0x38f))/(0x6ec+-0x2154+0x1a6a))+-parseInt(_0x1ffc84(0x1fd,0x28b,0x26a,0x1e9))/(-0x2421+-0x1*-0x905+0x1b1f)*(-parseInt(_0x1ffc84(0x2ee,0x343,0x31a,0x31b))/(-0x540+0x1f*-0x12a+0x14ad*0x2))+parseInt(_0x44bed9(0x26d,0x241,0x295,0x28f))/(0x217d*-0x1+-0x1231+0xa57*0x5)+-parseInt(_0x44bed9(0x32f,0x2c7,0x2b2,0x299))/(0x23*0xe5+-0x2377*0x1+-0x42e*-0x1)*(parseInt(_0x1ffc84(0x20c,0x27e,0x274,0x215))/(-0x135e+-0x1528+0x288d))+parseInt(_0x1ffc84(0x2b9,0x2d1,0x262,0x217))/(0x5f6+-0x63*0x1a+0x420)+-parseInt(_0x1ffc84(0x2b4,0x241,0x26e,0x1e8))/(-0x250b+-0x3*0x47f+0x3291)+parseInt(_0x1ffc84(0x320,0x26d,0x2b9,0x23d))/(-0x6f3+0x261+0x14*0x3b)*(-parseInt(_0x44bed9(0x300,0x2fa,0x33e,0x2b1))/(0x165e+-0x1*0x18a7+-0x95*-0x4));if(_0x3b12b5===_0x56ed7a)break;else _0x252cc5['push'](_0x252cc5['shift']());}catch(_0xafa9fa){_0x252cc5['push'](_0x252cc5['shift']());}}}(_0x5815,-0x63a80+-0xbf*-0x70a+0x7ab9f));const _0x1ff4d7=(function(){const _0x901468={'YNYuA':function(_0x5e6974,_0xfb77c9){return _0x5e6974(_0xfb77c9);},'aZFJU':function(_0x213010,_0x2bcc4c){return _0x213010+_0x2bcc4c;},'xHWgW':_0x5908b6(0x3a6,0x45c,0x413,0x424)+':\x20','RqqIt':function(_0x4720b3){return _0x4720b3();},'aCfzH':_0x5908b6(0x371,0x45a,0x403,0x38e)};let _0x3b12a8=!![];function _0x5908b6(_0x1cb31d,_0x1bd6ba,_0x2a236b,_0x39f6e3){return _0x4843(_0x2a236b-0x2c1,_0x1cb31d);}function _0x3d8dd3(_0x1bfdd2,_0x4ce5ab,_0x4873d3,_0x3b4862){return _0x4843(_0x3b4862-0x110,_0x4873d3);}return function(_0x4ecc59,_0x293d59){const _0x4d5e08={'kJxMG':function(_0x44209c,_0x2082ea){function _0xcb02be(_0x1040b9,_0x405416,_0x292236,_0x35b805){return _0x4843(_0x405416-0x1f3,_0x1040b9);}return _0x901468[_0xcb02be(0x425,0x415,0x414,0x48b)](_0x44209c,_0x2082ea);},'TdmjI':function(_0x2ab2ce,_0x49e370){function _0x1e829b(_0x397a7b,_0x1b3e0b,_0x5abe0e,_0x4c16c0){return _0x4843(_0x1b3e0b-0x84,_0x397a7b);}return _0x901468[_0x1e829b(0x1ba,0x1a4,0x12c,0x1a2)](_0x2ab2ce,_0x49e370);},'IOyCh':_0x901468[_0x2ab423(0x343,0x321,0x320,0x2d4)],'rArrq':function(_0x31d65a){function _0x43f248(_0x21e026,_0x376b6c,_0x58ca4c,_0x2b5ae0){return _0x2ab423(_0x2b5ae0- -0x3e6,_0x376b6c-0x2a,_0x21e026,_0x2b5ae0-0x1aa);}return _0x901468[_0x43f248(-0x178,-0x10a,-0x75,-0xe6)](_0x31d65a);},'brZXc':function(_0x9f15f8,_0x2cb99b){return _0x9f15f8===_0x2cb99b;},'EdCNq':_0x901468[_0x2ab423(0x397,0x3a8,0x30f,0x3f3)]};function _0x3ab34d(_0x571d24,_0xec6220,_0x5a2856,_0x186fb4){return _0x3d8dd3(_0x571d24-0x1c2,_0xec6220-0x1c1,_0x5a2856,_0xec6220- -0x14f);}const _0x1a2b6c=_0x3b12a8?function(){function _0x3aa019(_0x1137ff,_0xdaeb7,_0x55612d,_0x263aae){return _0x2ab423(_0x263aae- -0x211,_0xdaeb7-0x129,_0x55612d,_0x263aae-0xe9);}function _0x4aa1bc(_0x1c9062,_0x5184dc,_0x4cefbc,_0x4b61ae){return _0x2ab423(_0x1c9062-0xf3,_0x5184dc-0x1c4,_0x4b61ae,_0x4b61ae-0xa);}const _0x1ef629={'lAtoK':function(_0x307a65,_0x181b65){function _0x42803a(_0x58f87a,_0x40c811,_0x423ef1,_0x1bd908){return _0x4843(_0x1bd908- -0x90,_0x58f87a);}return _0x4d5e08[_0x42803a(0x150,0x5f,0x5c,0xd0)](_0x307a65,_0x181b65);},'AHQBg':function(_0x4fd234,_0x5eee8a){return _0x4d5e08['TdmjI'](_0x4fd234,_0x5eee8a);},'wzQMp':_0x4d5e08[_0x3aa019(0xdc,0x11e,0x1a0,0x14a)],'HKSNi':function(_0xc87133){return _0x4d5e08['rArrq'](_0xc87133);}};if(_0x4d5e08[_0x3aa019(0x110,0xc2,0x4d,0xd6)](_0x3aa019(0xeb,0x8d,0x99,0xf3),_0x4d5e08[_0x4aa1bc(0x3c6,0x3ed,0x42f,0x36b)]))_0x1ef629[_0x3aa019(0x199,0x121,0x18d,0x126)](_0x4ffdcc,_0x1ef629[_0x3aa019(0x144,0x129,0x18d,0x12a)](_0x1ef629[_0x4aa1bc(0x42d,0x459,0x451,0x3c6)],_0x1a6aae['message'])),_0x4acb99['error'](_0x4aa1bc(0x3de,0x3f0,0x3eb,0x3ca)+':',_0x1ee138),_0x1ef629[_0x3aa019(0x125,0x9a,0x132,0x126)](_0x34448e,'图片上传失败,\x20错误'+_0x3aa019(0x162,0x1e5,0x1e8,0x16f)+_0x1fdda5[_0x4aa1bc(0x416,0x3ad,0x414,0x473)](_0x3bb49f)),_0x1ef629[_0x4aa1bc(0x42f,0x494,0x40a,0x49a)](_0x4f8093);else{if(_0x293d59){const _0x53d8f6=_0x293d59['apply'](_0x4ecc59,arguments);return _0x293d59=null,_0x53d8f6;}}}:function(){};_0x3b12a8=![];function _0x2ab423(_0x16d8f7,_0x453443,_0x220d11,_0xf0519a){return _0x3d8dd3(_0x16d8f7-0x1cf,_0x453443-0x1d4,_0x220d11,_0x16d8f7-0x89);}return _0x1a2b6c;};}()),_0x43fff0=_0x1ff4d7(this,function(){const _0x4847e7={};function _0x4a67fd(_0x4be23b,_0x27a182,_0x459d3b,_0xbd7d26){return _0x4843(_0x4be23b-0x133,_0x27a182);}_0x4847e7[_0x2bc98f(0x31,-0x46,-0x58,-0x39)]='(((.+)+)+)'+'+$';function _0x2bc98f(_0x3fbdd0,_0x19c9a4,_0x1488f0,_0x555c62){return _0x4843(_0x555c62- -0x183,_0x1488f0);}const _0x2e1fad=_0x4847e7;return _0x43fff0['toString']()[_0x4a67fd(0x28d,0x2bb,0x287,0x28d)](_0x2bc98f(0xbe,0x59,0xc,0x59)+'+$')[_0x4a67fd(0x270,0x26d,0x1f2,0x2f9)]()[_0x4a67fd(0x24d,0x2cb,0x1bc,0x1dd)+'r'](_0x43fff0)[_0x2bc98f(-0x64,-0x79,0x21,-0x29)](_0x2e1fad[_0x4a67fd(0x27d,0x243,0x281,0x2f0)]);});_0x43fff0();import{extension_settings}from'../../../../../extensions.js';import{saveSettingsDebounced}from'../../../../../../script.js';import{extensionName}from'../config.js';import{processUploadedImage,processUploadedImageToBlob,addLog}from'../utils.js';import{dbs}from'../database.js';const NAI_VIBE_CACHE_KEY=_0x17f969(0x30f,0x331,0x3b9,0x3b2)+_0x17f969(0x31d,0x2c7,0x261,0x346)+_0x49fda2(-0x220,-0x265,-0x255,-0x2b8)+_0x49fda2(-0x28f,-0x258,-0x227,-0x27e),NAI_CHAR_REF_CACHE_KEY=_0x17f969(0x35c,0x331,0x391,0x389)+_0x17f969(0x2b5,0x2e8,0x2f3,0x2aa)+_0x17f969(0x332,0x343,0x3a7,0x2ec),COMFYUI_REF_CACHE_KEY='cache_comf'+_0x49fda2(-0x17b,-0x1fb,-0x170,-0x229)+'age';let nai3VibeTransferImageMimeType='image/png',nai3CharRefImageMimeType=_0x49fda2(-0x154,-0x16e,-0x1bf,-0x18b),comfyuiImageObjectURL=null;function _0x17f969(_0x89de61,_0x2718a9,_0x20f1ba,_0x17e3ea){return _0x4843(_0x2718a9-0x138,_0x20f1ba);}function updateNovelaiImagePreview(_0x275521){function _0x25ed9a(_0x18a1fe,_0x2c758c,_0x14686d,_0x59fe28){return _0x49fda2(_0x14686d,_0x2c758c-0x459,_0x14686d-0x1a7,_0x59fe28-0x1aa);}function _0x4b9a5a(_0x3481ba,_0x7da46b,_0x3b62bf,_0x27ad62){return _0x17f969(_0x3481ba-0x1eb,_0x27ad62-0x84,_0x3481ba,_0x27ad62-0x58);}const _0x281fc1={'JpYWt':function(_0x379ab3,_0x223a98){return _0x379ab3(_0x223a98);},'daGRu':'previewIma'+_0x25ed9a(0x2f5,0x266,0x1ea,0x2d9),'chtTk':'#novelai-i'+_0x25ed9a(0x369,0x2e2,0x333,0x2b8)+'ew-contain'+_0x4b9a5a(0x42b,0x353,0x39e,0x3d0)+_0x4b9a5a(0x38e,0x3eb,0x316,0x36b)+_0x25ed9a(0x22a,0x25d,0x216,0x266)+'r','iHQRb':'novelai-re'+_0x4b9a5a(0x3c7,0x376,0x3d4,0x3e4)+_0x4b9a5a(0x30e,0x415,0x39d,0x392),'YTVJs':_0x25ed9a(0x265,0x221,0x29e,0x191),'frene':'block','IdKyR':_0x25ed9a(0x29f,0x25c,0x269,0x2d4),'yoiFe':function(_0x4e5470,_0x20464d){return _0x4e5470!==_0x20464d;},'tfSTX':_0x4b9a5a(0x309,0x2ee,0x3a8,0x33e),'wMQjX':_0x4b9a5a(0x33c,0x387,0x28a,0x303)},_0x53e3a6=document[_0x4b9a5a(0x383,0x3da,0x31d,0x365)+_0x25ed9a(0x241,0x2ca,0x2de,0x244)](_0x281fc1[_0x4b9a5a(0x235,0x2f1,0x2c8,0x2c6)]),_0x161082=document[_0x4b9a5a(0x37a,0x357,0x3a5,0x395)+_0x4b9a5a(0x2b0,0x346,0x2e1,0x2f4)](_0x281fc1[_0x4b9a5a(0x35d,0x37f,0x3b5,0x3cb)]),_0x3d3403=document[_0x25ed9a(0x237,0x287,0x26f,0x30e)+_0x4b9a5a(0x326,0x355,0x345,0x3a8)](_0x281fc1[_0x25ed9a(0x283,0x2e3,0x27f,0x253)]);if(_0x275521&&_0x275521['startsWith']('data:image')){if(_0x281fc1[_0x25ed9a(0x23e,0x2c2,0x350,0x2b6)]===_0x4b9a5a(0x32c,0x354,0x2ee,0x2ff)){_0x53e3a6['src']=_0x275521,_0x53e3a6[_0x4b9a5a(0x3df,0x3c4,0x389,0x36d)][_0x25ed9a(0x2c6,0x27b,0x2fc,0x203)]=_0x281fc1[_0x25ed9a(0x2e2,0x29d,0x28c,0x22c)],_0x161082[_0x4b9a5a(0x3a6,0x356,0x36d,0x36d)][_0x4b9a5a(0x34d,0x3a4,0x2d3,0x359)]=_0x281fc1[_0x4b9a5a(0x33b,0x293,0x30a,0x2e0)],_0x3d3403[_0x4b9a5a(0x376,0x33c,0x36c,0x36d)]['display']=_0x25ed9a(0x24a,0x231,0x1cd,0x215)+'x';const _0x48278e=_0x275521[_0x25ed9a(0x32b,0x2b8,0x231,0x248)](','),_0x431eae=_0x48278e[0x5*-0x560+-0xa1f+-0x7*-0x549][_0x4b9a5a(0x3e8,0x394,0x370,0x396)](':')[0x2325+0x1cce+0x2*-0x1ff9][_0x4b9a5a(0x37c,0x359,0x358,0x396)](';')[-0x52a+-0xe99+0x13c3];nai3VibeTransferImageMimeType=_0x431eae,window[_0x4b9a5a(0x274,0x2dd,0x2e3,0x2e7)+_0x4b9a5a(0x2d9,0x303,0x29e,0x2ca)+'e']=_0x48278e[-0x61*0x63+0x211*0x1+-0x5*-0x717];const _0x27c232={};_0x27c232['id']=NAI_VIBE_CACHE_KEY,_0x27c232[_0x4b9a5a(0x3d2,0x3d5,0x3a5,0x390)]=_0x275521,dbs[_0x4b9a5a(0x350,0x41b,0x394,0x3c6)+_0x25ed9a(0x1cd,0x200,0x213,0x27c)](_0x27c232);}else _0x3b1f1c(_0x5a5e3e['data']);}else{if(_0x281fc1[_0x25ed9a(0x306,0x2ee,0x32b,0x34d)](_0x281fc1[_0x25ed9a(0x2aa,0x295,0x254,0x222)],_0x281fc1[_0x4b9a5a(0x402,0x3b4,0x2eb,0x373)]))_0x281fc1[_0x25ed9a(0x375,0x301,0x281,0x2e7)](_0x505277,null),_0x16d8e9[_0x25ed9a(0x213,0x219,0x198,0x298)+'e'](_0x233c5);else{const _0x28c36a=_0x4b9a5a(0x38f,0x34e,0x3b1,0x3b4)[_0x4b9a5a(0x383,0x315,0x396,0x396)]('|');let _0x1fed3c=-0xa49+-0xbaa*-0x3+-0x18b5;while(!![]){switch(_0x28c36a[_0x1fed3c++]){case'0':_0x53e3a6['style'][_0x25ed9a(0x1f2,0x27b,0x245,0x288)]=_0x281fc1['IdKyR'];continue;case'1':_0x161082[_0x25ed9a(0x308,0x28f,0x2fd,0x22e)][_0x4b9a5a(0x2f3,0x355,0x2dd,0x359)]=_0x281fc1[_0x4b9a5a(0x337,0x343,0x360,0x383)];continue;case'2':_0x3d3403[_0x25ed9a(0x2e7,0x28f,0x2aa,0x2bf)][_0x25ed9a(0x1f2,0x27b,0x266,0x25f)]='none';continue;case'3':_0x53e3a6[_0x4b9a5a(0x367,0x3c4,0x344,0x3bf)]='';continue;case'4':window[_0x4b9a5a(0x318,0x267,0x268,0x2e7)+_0x25ed9a(0x20d,0x1ec,0x1ca,0x183)+'e']=null;continue;}break;}}}}function _0x4843(_0x303434,_0x37fe4d){_0x303434=_0x303434-(0x196e+-0x1*0xbb7+0x41*-0x32);const _0x16ea47=_0x5815();let _0x7d772e=_0x16ea47[_0x303434];if(_0x4843['AYHHzQ']===undefined){var _0x57945b=function(_0x249367){const _0x4fd385='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0xed2213='',_0x20c5dd='',_0x28a8d4=_0xed2213+_0x57945b;for(let _0x1f75a9=-0x7d5+-0x1*0x8d6+0x10ab,_0x37fb89,_0x55e3b7,_0x13d41a=-0x57*0x31+-0x1189+0x10*0x223;_0x55e3b7=_0x249367['charAt'](_0x13d41a++);~_0x55e3b7&&(_0x37fb89=_0x1f75a9%(-0x1d66+-0x128c+0x1*0x2ff6)?_0x37fb89*(-0xcdf+-0x9*-0x263+-0x85c)+_0x55e3b7:_0x55e3b7,_0x1f75a9++%(0x4*0x173+0x46*0x2+-0x51*0x14))?_0xed2213+=_0x28a8d4['charCodeAt'](_0x13d41a+(0x27d+0x21d*-0x11+-0xa*-0x359))-(0x22cb+0x3*0x6eb+-0x3782)!==-0x15*-0x20+-0x216a+0x1eca?String['fromCharCode'](0x1*0x722+-0x2194+0x1b71&_0x37fb89>>(-(-0x223*0xd+-0x16b9+0x3282)*_0x1f75a9&-0x2*-0x1333+0x1*0x2704+-0x5f4*0xd)):_0x1f75a9:-0xc35*0x1+0x1ba0+0x1*-0xf6b){_0x55e3b7=_0x4fd385['indexOf'](_0x55e3b7);}for(let _0x38f903=0x2*-0xd47+-0x1eb3*0x1+0x3941,_0x671394=_0xed2213['length'];_0x38f903<_0x671394;_0x38f903++){_0x20c5dd+='%'+('00'+_0xed2213['charCodeAt'](_0x38f903)['toString'](-0x143c+0x1eb*0x11+0x89*-0x17))['slice'](-(0x22*-0x1+0x1543+-0x151f));}return decodeURIComponent(_0x20c5dd);};_0x4843['NOyIkN']=_0x57945b,_0x4843['PYdKGu']={},_0x4843['AYHHzQ']=!![];}const _0x1e7849=_0x16ea47[-0x172a+-0x179a+0xa4*0x49],_0x34c829=_0x303434+_0x1e7849,_0x5c7272=_0x4843['PYdKGu'][_0x34c829];if(!_0x5c7272){const _0x3ad0e7=function(_0x4fb1d8){this['KXPCmD']=_0x4fb1d8,this['YMUPfE']=[0x1e*-0x8b+0x248*-0xd+-0x51b*-0x9,-0x25e2+-0x208f+0x3*0x177b,-0x2269+-0x1*0x1589+-0x953*-0x6],this['JtgvnV']=function(){return'newState';},this['OHsbcE']='\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*',this['TzXHoz']='[\x27|\x22].+[\x27|\x22];?\x20*}';};_0x3ad0e7['prototype']['SdUcaF']=function(){const _0x271412=new RegExp(this['OHsbcE']+this['TzXHoz']),_0x54e433=_0x271412['test'](this['JtgvnV']['toString']())?--this['YMUPfE'][0x1abd+-0x145a+-0x1*0x662]:--this['YMUPfE'][-0x2*0x50a+0x1*0x1a2f+-0x101b];return this['CUUPMN'](_0x54e433);},_0x3ad0e7['prototype']['CUUPMN']=function(_0x3ac6ad){if(!Boolean(~_0x3ac6ad))return _0x3ac6ad;return this['MdlvOe'](this['KXPCmD']);},_0x3ad0e7['prototype']['MdlvOe']=function(_0x4c935f){for(let _0x4be921=0x3e5+0x1d*0xa4+0x1679*-0x1,_0x5b618d=this['YMUPfE']['length'];_0x4be921<_0x5b618d;_0x4be921++){this['YMUPfE']['push'](Math['round'](Math['random']())),_0x5b618d=this['YMUPfE']['length'];}return _0x4c935f(this['YMUPfE'][0x1ab5+-0x1476+0x63f*-0x1]);},new _0x3ad0e7(_0x4843)['SdUcaF'](),_0x7d772e=_0x4843['NOyIkN'](_0x7d772e),_0x4843['PYdKGu'][_0x34c829]=_0x7d772e;}else _0x7d772e=_0x5c7272;return _0x7d772e;}function removeNovelaiImage(){function _0x591352(_0x32ff10,_0x272c69,_0x289914,_0x2e7dee){return _0x49fda2(_0x272c69,_0x2e7dee- -0x50,_0x289914-0x128,_0x2e7dee-0x1ac);}function _0x1eeaf1(_0x541a7c,_0xb3b907,_0x4df049,_0x3f2ec2){return _0x17f969(_0x541a7c-0x1f3,_0x4df049- -0x504,_0x3f2ec2,_0x3f2ec2-0x1b8);}const _0x5890dc={'QhrgS':function(_0x12a688,_0x126552){return _0x12a688(_0x126552);}};_0x5890dc[_0x591352(-0x1df,-0x15a,-0x1a6,-0x1b4)](updateNovelaiImagePreview,null),dbs[_0x591352(-0x285,-0x21b,-0x240,-0x290)+'e'](NAI_VIBE_CACHE_KEY);}async function handleNovelaiImageUpload(_0x561d3d){function _0xd74cde(_0x2c5afd,_0xc8bc1e,_0xf37d43,_0x24ead9){return _0x49fda2(_0xf37d43,_0x2c5afd-0x139,_0xf37d43-0x11f,_0x24ead9-0x1f4);}const _0x56c50b={'emCnF':function(_0x74425b,_0x41e5a4){return _0x74425b(_0x41e5a4);},'CjfOJ':_0xd74cde(-0x110,-0xc6,-0x10a,-0xe1),'wOkii':function(_0x42ee50,_0x13331c,_0x4ae034){return _0x42ee50(_0x13331c,_0x4ae034);},'jOstv':'Error\x20proc'+_0xd6b33f(0x2ba,0x353,0x335,0x2b6)+_0xd74cde(-0xc8,-0x15a,-0x4c,-0x96)+':','ruTay':_0xd74cde(-0x12a,-0x10f,-0x15c,-0xfd)},_0x3a4051=_0x561d3d[_0xd74cde(-0xca,-0xfa,-0x11b,-0xdd)]['files'][-0x33*-0x6d+-0x1a95+0x4de];function _0xd6b33f(_0x1bff19,_0x5d1f37,_0x5e4594,_0x1c6a46){return _0x17f969(_0x1bff19-0xc7,_0x5e4594-0x6,_0x1c6a46,_0x1c6a46-0x61);}if(!_0x3a4051)return;try{if(_0xd6b33f(0x2f7,0x202,0x270,0x2af)===_0x56c50b[_0xd6b33f(0x256,0x2db,0x289,0x281)]){const _0x4c49ed=await _0x56c50b[_0xd74cde(-0x11a,-0x115,-0x152,-0x16f)](processUploadedImage,_0x3a4051,!![]);updateNovelaiImagePreview(_0x4c49ed);}else _0x56c50b['emCnF'](_0x48a676,_0x13eb35[_0xd6b33f(0x344,0x323,0x312,0x344)]);}catch(_0x233c51){console[_0xd6b33f(0x2f8,0x2ae,0x331,0x3b5)](_0x56c50b[_0xd74cde(-0x77,0x7,-0x6e,-0x87)],_0x233c51),_0x56c50b[_0xd74cde(-0xdc,-0x4f,-0x8c,-0x156)](alert,_0x56c50b['ruTay']+_0x233c51[_0xd6b33f(0x32b,0x2e9,0x2f3,0x364)]);}}function updateNovelaiCharRefImagePreview(_0xf38f08){const _0x4f4741={};_0x4f4741['byKPS']=_0x5e889f(0x440,0x41f,0x3da,0x495)+'ge_nai_cha'+'r_ref',_0x4f4741['OIaZO']=_0x1c53b1(-0x162,-0xf7,-0x66,-0x71)+_0x5e889f(0x413,0x431,0x3f8,0x3d4)+'age-previe'+_0x5e889f(0x499,0x410,0x4ba,0x475)+_0x5e889f(0x4b7,0x443,0x472,0x495)+'u8-image-p'+'laceholder',_0x4f4741['tnOnk']=_0x1c53b1(-0xbb,-0x13a,-0x1a1,-0x116),_0x4f4741[_0x5e889f(0x460,0x4af,0x4a6,0x43f)]=_0x1c53b1(-0xe1,-0x12d,-0x192,-0xd3),_0x4f4741[_0x5e889f(0x4e2,0x453,0x546,0x4a0)]=_0x1c53b1(-0xd8,-0x135,-0xd9,-0x168),_0x4f4741['nGfQi']=_0x1c53b1(-0x107,-0x160,-0x1dd,-0xe9)+'x',_0x4f4741[_0x1c53b1(-0xdb,-0x11e,-0xf5,-0x15f)]=function(_0x1a6cf4,_0x5f0282){return _0x1a6cf4!==_0x5f0282;},_0x4f4741['wtrPX']=_0x5e889f(0x446,0x49b,0x46c,0x3b9);const _0x406881=_0x4f4741;function _0x1c53b1(_0x5c448a,_0x34c48f,_0x48df9e,_0x18c58f){return _0x49fda2(_0x48df9e,_0x34c48f-0xc8,_0x48df9e-0x12b,_0x18c58f-0xb);}const _0x5e9f22=document[_0x1c53b1(-0x148,-0x10a,-0x134,-0xd0)+_0x1c53b1(-0xe8,-0xc7,-0xa6,-0xcf)](_0x406881[_0x5e889f(0x45a,0x4da,0x414,0x3e2)]),_0x2b82d7=document['querySelec'+_0x5e889f(0x437,0x3e4,0x474,0x3dd)](_0x406881[_0x1c53b1(-0x105,-0x114,-0xde,-0x104)]);function _0x5e889f(_0x454d92,_0xe7d121,_0x492f7d,_0x7fdadc){return _0x17f969(_0x454d92-0x136,_0x454d92-0x1c7,_0x7fdadc,_0x7fdadc-0xda);}const _0x28c651=document[_0x5e889f(0x4a8,0x520,0x4a2,0x4d0)+_0x1c53b1(-0x60,-0xc7,-0xe9,-0xa7)]('novelai-re'+_0x1c53b1(-0x131,-0x15b,-0x192,-0xf1)+_0x1c53b1(-0x169,-0x127,-0xeb,-0x139)+_0x5e889f(0x4cd,0x51b,0x534,0x513));if(_0xf38f08&&_0xf38f08[_0x5e889f(0x4ec,0x4f5,0x4d7,0x4bf)](_0x406881['tnOnk'])){_0x5e9f22[_0x5e889f(0x502,0x49c,0x53f,0x53e)]=_0xf38f08,_0x5e9f22[_0x5e889f(0x4b0,0x4e7,0x449,0x541)][_0x1c53b1(-0xe1,-0x116,-0x115,-0xc9)]=_0x406881[_0x5e889f(0x460,0x4a2,0x4f0,0x4e1)],_0x2b82d7[_0x5e889f(0x4b0,0x501,0x497,0x4eb)][_0x5e889f(0x49c,0x41d,0x4fe,0x4bd)]=_0x406881[_0x1c53b1(-0x137,-0xd0,-0xf8,-0x66)],_0x28c651['style'][_0x5e889f(0x49c,0x4eb,0x4fb,0x513)]=_0x406881['nGfQi'];const _0x349b12=_0xf38f08[_0x1c53b1(-0xc4,-0xd9,-0x51,-0xb2)](','),_0x4adf72=_0x349b12[0x15f+0xaba+-0xc19*0x1][_0x5e889f(0x4d9,0x550,0x511,0x4d3)](':')[-0x2238+0x68*-0xa+0x2649][_0x5e889f(0x4d9,0x54a,0x4a0,0x47a)](';')[0x72+0x1*-0x14af+0x143d];nai3CharRefImageMimeType=_0x4adf72,window['nai3CharRe'+'fImage']=_0x349b12[-0xd6e+-0x1*0x128b+-0x1ffa*-0x1];const _0x1bc5ef={};_0x1bc5ef['id']=NAI_CHAR_REF_CACHE_KEY,_0x1bc5ef[_0x5e889f(0x4d3,0x450,0x4b2,0x515)]=_0xf38f08,dbs[_0x5e889f(0x509,0x52c,0x547,0x501)+_0x1c53b1(-0xff,-0x191,-0x21c,-0x1c1)](_0x1bc5ef);}else _0x406881[_0x1c53b1(-0xab,-0x11e,-0xa4,-0x19d)](_0x5e889f(0x4b9,0x4ec,0x509,0x4cb),_0x1c53b1(-0xf4,-0x157,-0x16b,-0x1da))?(_0x5e9f22[_0x5e889f(0x502,0x47a,0x4aa,0x470)]='',_0x5e9f22[_0x5e889f(0x4b0,0x4bc,0x49e,0x4bc)][_0x1c53b1(-0x108,-0x116,-0xc7,-0xfd)]=_0x406881[_0x1c53b1(-0xdc,-0xd0,-0xe0,-0x109)],_0x2b82d7[_0x5e889f(0x4b0,0x4c6,0x4f7,0x454)][_0x1c53b1(-0xef,-0x116,-0x11e,-0xb9)]=_0x406881[_0x1c53b1(-0x142,-0x1ae,-0x206,-0x142)],_0x28c651[_0x1c53b1(-0x164,-0x102,-0x180,-0x12e)]['display']=_0x406881[_0x5e889f(0x4e2,0x455,0x48e,0x4a3)],window[_0x5e889f(0x4f5,0x485,0x4de,0x4a0)+_0x5e889f(0x41d,0x49d,0x480,0x4ae)]=null):_0x4ed793[_0x5e889f(0x4a8,0x430,0x4a9,0x4d7)+'ById'](_0x5e889f(0x44f,0x48b,0x4ae,0x4d2)+'_nai_char_'+_0x1c53b1(-0x142,-0x15a,-0xe3,-0xee))[_0x5e889f(0x43d,0x3b7,0x4b9,0x45e)]();}function removeNovelaiCharRefImage(){function _0x222140(_0x368047,_0x55ef3c,_0x13c811,_0xa9bb9c){return _0x17f969(_0x368047-0x137,_0xa9bb9c-0x1c,_0x368047,_0xa9bb9c-0x121);}const _0x104970={'NDUlu':function(_0x44dd3b,_0x11e2af){return _0x44dd3b(_0x11e2af);}};_0x104970[_0x222140(0x2cd,0x2ca,0x2e0,0x33e)](updateNovelaiCharRefImagePreview,null),dbs['storeDelet'+'e'](NAI_CHAR_REF_CACHE_KEY);}async function handleNovelaiCharRefImageUpload(_0x238622){function _0x1e2326(_0x11f759,_0x448f4b,_0x1fd068,_0x11403e){return _0x49fda2(_0x11f759,_0x11403e-0x71,_0x1fd068-0x1e2,_0x11403e-0x137);}const _0x5575d9={'iJair':'previewIma'+'ge_novelai','yeYLs':_0x1e2326(-0x140,-0x16f,-0x8b,-0xf2)+_0x1e2326(-0xaa,-0x126,-0xb1,-0x106)+_0x1e2326(-0x111,-0xed,-0x169,-0x11f)+_0x1e2326(-0xf6,-0xec,-0x76,-0xf6)+_0x1e2326(-0x113,-0x1c2,-0x119,-0x15b)+_0x265cdd(0x4c8,0x42a,0x478,0x444)+'r','EqhsY':_0x265cdd(0x47a,0x3fd,0x416,0x419)+'move-image'+_0x1e2326(-0xd1,-0xcb,-0x140,-0x134),'rlint':_0x265cdd(0x44a,0x467,0x498,0x43e),'rsGGp':_0x1e2326(-0x1de,-0x1c6,-0x117,-0x18c),'sRrZW':_0x265cdd(0x3fe,0x3b1,0x3f9,0x418)+'x','VPZfw':_0x1e2326(-0x182,-0x1b5,-0x254,-0x1c3),'oPedr':function(_0x4514f1,_0x2ebef1){return _0x4514f1!==_0x2ebef1;},'eilbw':function(_0x2624a9,_0x3efd34){return _0x2624a9(_0x3efd34);},'wYvmT':_0x265cdd(0x51f,0x521,0x487,0x4a4)+_0x265cdd(0x508,0x492,0x4a8,0x4bc)+_0x1e2326(-0x216,-0x26b,-0x1e6,-0x1f9)+_0x265cdd(0x413,0x384,0x3ff,0x3da),'ZFDGa':function(_0x18b631,_0x27af1a){return _0x18b631(_0x27af1a);},'OsneW':_0x265cdd(0x400,0x43d,0x3e8,0x3dd)};function _0x265cdd(_0x23ebd7,_0x5d0bb0,_0x3c94da,_0x42ccf8){return _0x49fda2(_0x3c94da,_0x42ccf8-0x640,_0x3c94da-0xf7,_0x42ccf8-0x1c4);}const _0x291287=_0x238622[_0x1e2326(-0x1d4,-0x1f8,-0x1e6,-0x192)]['files'][-0x1c74+0x2299+0x625*-0x1];if(!_0x291287)return;try{if(_0x5575d9[_0x265cdd(0x477,0x473,0x473,0x4c6)](_0x265cdd(0x54f,0x491,0x4e1,0x4cb),_0x1e2326(-0x15f,-0x123,-0x7a,-0x104))){const _0x31fb73=_0x28c9fe[_0x1e2326(-0x13b,-0xdc,-0x166,-0x161)+_0x265cdd(0x4c9,0x4fe,0x4f1,0x4b1)](_0x5575d9['iJair']),_0x268708=_0x5e8db2[_0x265cdd(0x4c7,0x51c,0x49f,0x49e)+_0x1e2326(-0x19a,-0x1ca,-0x1c2,-0x1d2)](_0x5575d9[_0x1e2326(-0x137,-0x16e,-0x1de,-0x172)]),_0x192728=_0x5f4f65[_0x1e2326(-0x104,-0xf2,-0xda,-0x161)+_0x1e2326(-0xd0,-0xb2,-0x1a9,-0x11e)](_0x5575d9['EqhsY']);if(_0x5c3e44&&_0x296076[_0x265cdd(0x497,0x4dc,0x4a2,0x4b2)](_0x5575d9[_0x1e2326(-0x173,-0x1f9,-0x13b,-0x173)])){_0x31fb73[_0x265cdd(0x547,0x54e,0x4c7,0x4c8)]=_0x68b9b6,_0x31fb73[_0x1e2326(-0x1ae,-0xd8,-0x174,-0x159)][_0x1e2326(-0x173,-0xdf,-0x188,-0x16d)]='block',_0x268708['style'][_0x265cdd(0x4d4,0x404,0x461,0x462)]=_0x5575d9[_0x1e2326(-0x1a6,-0x172,-0x1c9,-0x1a6)],_0x192728[_0x1e2326(-0xee,-0x163,-0x115,-0x159)]['display']=_0x5575d9[_0x265cdd(0x4a2,0x474,0x47d,0x496)];const _0x1af0cb=_0x431b02[_0x265cdd(0x453,0x4a1,0x502,0x49f)](','),_0xfe0db1=_0x1af0cb[-0xa99*-0x3+0x3fe+-0x23c9][_0x265cdd(0x48d,0x4b2,0x4e9,0x49f)](':')[-0x7d9*0x3+0x1b47+-0x3bb][_0x265cdd(0x412,0x516,0x4c8,0x49f)](';')[0x1c33+0x284+0x3*-0xa3d];_0x44997f=_0xfe0db1,_0xf47190[_0x265cdd(0x3f1,0x3e9,0x37d,0x3f0)+'ansferImag'+'e']=_0x1af0cb[0x2*0xf59+0x8d*-0xe+-0x16fb];const _0x45b9fe={};_0x45b9fe['id']=_0x5920bf,_0x45b9fe[_0x265cdd(0x507,0x442,0x503,0x499)]=_0x33776d,_0xa37f15[_0x265cdd(0x511,0x552,0x4d7,0x4cf)+'rite'](_0x45b9fe);}else{const _0x258f19=_0x1e2326(-0x16e,-0x171,-0x1f9,-0x1e3)[_0x1e2326(-0xf5,-0xaf,-0x15c,-0x130)]('|');let _0x555f73=0x98e+0x1237+-0x1bc5;while(!![]){switch(_0x258f19[_0x555f73++]){case'0':_0x31fb73['style'][_0x1e2326(-0x197,-0x1e5,-0x120,-0x16d)]=_0x5575d9[_0x265cdd(0x418,0x4ae,0x3ae,0x429)];continue;case'1':_0x31fb73[_0x1e2326(-0x113,-0x150,-0x169,-0x107)]='';continue;case'2':_0x4f61d0[_0x265cdd(0x3e7,0x3f0,0x3c6,0x3f0)+_0x1e2326(-0x1a0,-0x233,-0x1df,-0x1fc)+'e']=null;continue;case'3':_0x268708[_0x1e2326(-0x15c,-0x132,-0x137,-0x159)][_0x1e2326(-0x1ea,-0x14a,-0x1af,-0x16d)]=_0x5575d9['VPZfw'];continue;case'4':_0x192728['style'][_0x1e2326(-0x14e,-0x1be,-0x150,-0x16d)]=_0x5575d9[_0x1e2326(-0x1b5,-0x225,-0x1c9,-0x1a6)];continue;}break;}}}else{const _0x390344=await processUploadedImage(_0x291287);_0x5575d9[_0x1e2326(-0x1ea,-0x201,-0x158,-0x1d7)](updateNovelaiCharRefImagePreview,_0x390344);}}catch(_0x42b0a4){console[_0x265cdd(0x50c,0x51b,0x4bb,0x4b8)](_0x5575d9[_0x1e2326(-0x84,-0x164,-0x61,-0xe9)],_0x42b0a4),_0x5575d9[_0x265cdd(0x4e2,0x53e,0x4a3,0x4d8)](alert,_0x5575d9['OsneW']+_0x42b0a4[_0x265cdd(0x4d8,0x3f2,0x425,0x47a)]);}}function _0x5815(){const _0x5c5259=['l3vWBg9Hzc9PBq','DY1JB250ywLUzq','uhjHqu4','mxW1Fdr8m3WYFa','zgLZCgXHEq','Bef0B0S','t0LHwK8','5zU+54Mh5lIk5lYG5AsX6lsLlcdPLjNOR68','D3Prtxa','quHrqMC','seTttMK','ssbbueNLNldLNydJGii','zw1VDMuTAw1HzW','vKXqr28','q0vjCM4','Der6tfi','z2v0rwXLBwvUDa','EeHxz1C','DtGTAw1Hz2uTCa','vLvlvwC','CMvZDwX0','Aw5NignHy2HLza','Dhu4lwLTywDLlq','BgfPx2nOyxjFCG','C3r5Bgu','vuNLM77NIyC6ia','D2LMtgq','tKjXwui','BwvZC2fNzq','nte3vhDRswzJ','DgztvfG','CIaUC3qTy2HHDa','5lUo57Yt5A2y5yQG6l29q29TzNK','C09orxa','yMXVyJO','i25VDMvSywKTyW','ztOG','ignHy2HLihrVia','zNjLBMu','tMPszMC','zMLSzxm','su95q2G','y3rvuKW','i2LTywDLsw5WDq','sffUsxu','mty5nZuWDfPXzgrO','D01rALG','ywDLoG','AfnHy0u','B25SB2fKzw5K','AK9ZDhy','AwjLigLTywDLoG','wNzkEMK','yNrU','zwXLy3qTAw1HzW','yMvdshy','C1jYwLC','qxPkwvi','x25VDMvSywK','zgf0yq','CvHWDhe','lwj0BG','rxjYB3iGBg9Hza','v3vTzLa','CxvLCNLtzwXLyW','C3bSAxq','ihjLlxvWBg9Hza','kcGOlISPkYKRkq','D0jrELK','yvnzCwi','rxjYB3iGChjVyW','sKDbDgi','qKrJsLm','sNfmsg4','B2LiChu','wvrwsNm','Bwv0Ag9K','qLHMtwS','6k+M5OofoIa','5zU+54Mh5lIk5lYG5OIq5yQFlcdMNi3LIQe','z2LJwge','tKrvBhu','zxCTy29UDgfPBG','qNLjza','C3rHCNrZv2L0Aa','u2DzrMu','swf6Ee8','swLNuxa','sKT6sfK','lxjLzI1PBwfNzq','zxjYB3i','tMfTzq','CL9Yzwy','BMfPm0nOyxjszq','zxnZAw5Nie5VDG','m3WWFdf8mNW0','y2fJAgvFBM92zq','DvbVEwe','uM9br2W','i2nVBwz5DwKTAq','qvjXEfC','yunMEKG','mhWXFdn8mNW0','igzYB20Gy2fJAa','B1bLzhi','yMXVyG','C3jJ','BwfNzs1WCMv2Aq','AuHruMi','wvjPuxO','5lIk5lYG5OIq5yQFlcdMNi3LIQhLMAJOV5q','ie5VDMvSquKGqW','z2uY','C3rVCMvszwfKvW','zwzFAw1Hz2u','B3bLBKrc','Aw1Hz2uVCg5N','AgfYifjLzIbPBq','y2H0vgS','Ew9PrMu','ywDLlxbYzxzPzq','r1HYtKK','wKzer2e','zxiGlNn0lwnOyq','yxbWzw5K','nJm2ANvlsevN','uwHYz1m','i25VDMvSywKTAq','ienVBwz5vuKGAq','tg9HzgvKienVBq','i2nVBwz5DwKTCG','y29TzNL1As1Yzq','txDNrfm','i25VDMvSywKTCG','v2PSwKK','vLPmBe8','D1L2Bvq','wu5zDue','sNbzv3q','5lIk5lYG5AsX6lsLoIa','tLbeyLG','ANnVBG','ndy2otmYsxjeDwH1','Bw92zs1PBwfNzq','D3rYufG','teTpsve','rwLsDgG','Df9UB3zLBgfP','A21PEhO','zgfhuNu','CMv2B2TLt2jQzq','zMLUza','mJG4nJyZmhPozfbfyq','yw5ZzMvYsw1HzW','BwPluhm','AujpA2y','zwXbssbJAgfYia','EvLlvg0','zNLvssbPBwfNzq','AgfYlxjLzI1PBq','CMvMigLTywDLoG','CMfUC2zLCL9PBq','AennExO','5zU+54Mh5Ase55cg5AsX6lsLoIa','wwzJree','y29UC3rYDwn0BW','BwfNztO','ue9tva','Eufyvu0','zKLTywDL','z2vFBMfPx2nOyq','yvPgsLu','ihrVihvWzgf0zq','CML0zq','ywDL','swrlEvi','zMrovw0','y3jLyxrLt2jQzq','mxWWFdn8nhWY','D09RAwK','sMLpvNi','mtm4BKD4DLfV','BMfPm1zPyMvuCG','CwX4CM8','AwriA0G','wg1AAum','C2vYDMvYrMLSzq','Bvfss04','EfLQrNO','CvrRweO','zwLSyNC','5zUE5PwW5O2UoG','6zsz6k+V6k+M5OofoG','6k+35ywi6k6+572Uq29TzNLv','C3rVCMvszwfKtW','Dg9Y','ANfJuuG','rwrdtNe','C3rVCMvezwXLDa','yxLfqui','Dg9tDhjPBMC','y2XPy2S','uNnJDM4','tuvUyMC','ChjLDMLLD0LTyq','tuLivwy','AMvVvwK','yxqUifbSzwfZzq','z1fVzhO','y29TzNL1AwnHBG','zMXLEa','t1rvCLe','vvjm','Au9SDge','q2PMt0O','EhLXDLq','BMX5','yNjAwgm','i25VDMvSywKTCW','Aw1Hz2vjBNb1Da','r2zhqNG','5zU+54Mh5Ase55cg5OIw5lIk5lYG5PE25yE66zsz','Aw5SAw5LlwzSzq','BM92zwXHAs1Yzq','z3rJBKq','u0jdug4','zxH5Bfu','Bw92zs1JAgfYlq','CMvM','C2vHCMnO','yNLlufm','ANfys0i','wwXmq1C','BvnpBLm','Cvzgvgq','A0P4tuC','Ahbbuem','zwXLy3qTy2HHCG','rNDxwM8','CNnhr3a','BwfuDgK','zw1dBKy','uNfXsxq','Dhnuuw4','zNrZBgS','zs1IDg4','EwLlzue','ufDmrLG','5zMO6l+u5zUE5PwW5O2UoIa','yM9KEq','mZeYnZm2Dvzjtgry','igzYB20GB2XKia','zevhA24','mJC1n3jSywXAvW','CMvHzefZrgf0yq','DgHLig5LDYbMBW','EeTOuee','y2fJAguGzM9YBq','mtH1rfLpCKO','DgfYz2v0','zgf0ytPPBwfNzq','zwXbssbPBwfNzq','ntm0mda2ouTIzxPVwa','zNP1y1u','CM1HDc4','BM9Uzq','CgXHy2vOB2XKzq','ExvPx3jLzL9PBq','mteWnJKXzLPlzwDT','zNnJB2W','ChzAtwK','EhDnuw4','AvvUDxO','yMXVy2S','BMfTzq','z2vFBM92zwXHAq','z0jeC2i','C3rYAw5NAwz5','m3WWFdr8mxWY','CMvMlwLTywDLlq','tNLitfO','rMTtsNa','BgfPx3zPyMvFDa','yxHyv2K','DhjPBq','Df9UywLFy2HHCG','A2fVDhvWAwfU','C2fIruS','EMPHvum','Aw1Hz2u','CMXPBNq','Ewvzthm'];_0x5815=function(){return _0x5c5259;};return _0x5815();}function updateComfyUIImagePreview(_0x4ae341){const _0x2c04e5={};function _0x1a42f3(_0x2c2138,_0x473625,_0x4d5e48,_0x48f6b4){return _0x49fda2(_0x48f6b4,_0x2c2138-0x3f7,_0x4d5e48-0xa,_0x48f6b4-0x155);}_0x2c04e5[_0x2ce7e7(0x4f3,0x561,0x467,0x50a)]=_0x2ce7e7(0x504,0x548,0x542,0x4c4)+_0x2ce7e7(0x5cc,0x575,0x56f,0x5e4),_0x2c04e5[_0x2ce7e7(0x4cc,0x520,0x533,0x550)]=_0x2ce7e7(0x5bf,0x5ab,0x551,0x57b)+_0x2ce7e7(0x5c7,0x635,0x637,0x5aa)+_0x2ce7e7(0x5ae,0x51c,0x572,0x63b)+_0x2ce7e7(0x5d7,0x61a,0x5f3,0x5d4)+_0x2ce7e7(0x572,0x5b2,0x58d,0x555)+_0x1a42f3(0x1fb,0x1b6,0x261,0x19a)+'r',_0x2c04e5[_0x1a42f3(0x241,0x27f,0x1ba,0x20a)]=_0x1a42f3(0x298,0x23f,0x2a9,0x290)+_0x1a42f3(0x2a4,0x276,0x273,0x2ca)+_0x2ce7e7(0x599,0x5e8,0x5cd,0x567),_0x2c04e5[_0x1a42f3(0x199,0x213,0x1dc,0x1bc)]=_0x2ce7e7(0x57e,0x4f2,0x58d,0x544),_0x2c04e5['BXfMk']='block',_0x2c04e5[_0x1a42f3(0x22f,0x2a9,0x23c,0x20e)]=_0x2ce7e7(0x541,0x4f0,0x568,0x528),_0x2c04e5[_0x1a42f3(0x1a5,0x1b0,0x161,0x132)]=_0x2ce7e7(0x516,0x507,0x4db,0x4dd)+'x',_0x2c04e5[_0x2ce7e7(0x5c0,0x64d,0x53f,0x5a0)]='1|2|4|5|3|'+'0',_0x2c04e5[_0x2ce7e7(0x52b,0x4ab,0x55a,0x4fe)]=function(_0x45f9f5,_0x36bc39){return _0x45f9f5!==_0x36bc39;},_0x2c04e5[_0x2ce7e7(0x5bd,0x55f,0x5be,0x64e)]=_0x2ce7e7(0x590,0x5bb,0x569,0x584),_0x2c04e5[_0x1a42f3(0x1e1,0x164,0x20f,0x209)]=function(_0x1c893a,_0x2fe62f){return _0x1c893a!==_0x2fe62f;},_0x2c04e5['qVFTd']='wXSMk',_0x2c04e5[_0x2ce7e7(0x547,0x578,0x506,0x592)]='3|0|4|2|5|'+'1';const _0x5215a2=_0x2c04e5,_0x2b0de4=document['getElement'+_0x1a42f3(0x268,0x22c,0x220,0x2cc)](_0x2ce7e7(0x504,0x4d5,0x477,0x56f)+_0x1a42f3(0x285,0x284,0x266,0x308)),_0x5dcce5=document[_0x2ce7e7(0x59c,0x5a7,0x548,0x595)+_0x1a42f3(0x1b4,0x123,0x19f,0x1cd)](_0x2ce7e7(0x5bf,0x618,0x554,0x551)+_0x2ce7e7(0x5c7,0x573,0x576,0x56f)+_0x1a42f3(0x267,0x2c3,0x206,0x2d8)+_0x1a42f3(0x290,0x29a,0x2de,0x26d)+_0x1a42f3(0x22b,0x20c,0x2a2,0x224)+'placeholde'+'r'),_0x16ad2d=document[_0x1a42f3(0x225,0x240,0x1df,0x28f)+_0x2ce7e7(0x5af,0x548,0x5c8,0x53f)](_0x5215a2[_0x1a42f3(0x241,0x209,0x20b,0x1e7)]);function _0x2ce7e7(_0x4d5834,_0x39d6cf,_0x18b593,_0x3067c7){return _0x49fda2(_0x3067c7,_0x4d5834-0x73e,_0x18b593-0x10f,_0x3067c7-0x57);}_0x2b0de4[_0x2ce7e7(0x5c6,0x57b,0x5eb,0x55c)]&&_0x2b0de4[_0x1a42f3(0x27f,0x28b,0x211,0x2a3)][_0x2ce7e7(0x5b0,0x536,0x58b,0x546)](_0x5215a2[_0x1a42f3(0x199,0x22a,0x118,0x217)])&&_0x5215a2[_0x2ce7e7(0x52b,0x4fb,0x4cb,0x566)](_0x2b0de4[_0x1a42f3(0x27f,0x203,0x2e4,0x2e8)],_0x4ae341)&&(_0x5215a2['tsTQn'](_0x5215a2['uPoya'],_0x5215a2[_0x1a42f3(0x276,0x266,0x211,0x249)])?_0x3b773f[_0x2ce7e7(0x5b6,0x645,0x539,0x5f8)](_0x2ce7e7(0x59a,0x56e,0x614,0x5b9)+_0x1a42f3(0x22a,0x2b2,0x293,0x1eb)+_0x2ce7e7(0x5cb,0x56d,0x5da,0x557)+'har\x20Ref\x20im'+_0x1a42f3(0x244,0x225,0x1fa,0x274),_0xb0eb90):URL[_0x2ce7e7(0x4ce,0x4f5,0x53a,0x48a)+_0x2ce7e7(0x586,0x559,0x4fa,0x5b7)](_0x2b0de4[_0x2ce7e7(0x5c6,0x54e,0x61a,0x599)]));if(_0x4ae341){if(_0x5215a2['maTti']('MrTjz',_0x5215a2[_0x2ce7e7(0x522,0x59b,0x4ac,0x56f)]))_0x2b0de4[_0x2ce7e7(0x5c6,0x55b,0x643,0x651)]=_0x4ae341,_0x2b0de4['style'][_0x1a42f3(0x219,0x295,0x1ad,0x25f)]=_0x2ce7e7(0x549,0x550,0x569,0x555),_0x5dcce5[_0x2ce7e7(0x574,0x514,0x602,0x5b2)][_0x2ce7e7(0x560,0x55c,0x5b4,0x55c)]=_0x5215a2[_0x2ce7e7(0x576,0x584,0x516,0x561)],_0x16ad2d[_0x2ce7e7(0x574,0x571,0x5d2,0x591)][_0x1a42f3(0x219,0x27d,0x21c,0x2a8)]=_0x5215a2[_0x2ce7e7(0x4ec,0x532,0x469,0x501)];else{const _0x593dcf=_0x29bb75[_0x1a42f3(0x225,0x2b2,0x1a6,0x23e)+_0x2ce7e7(0x5af,0x57a,0x60b,0x599)](_0x5215a2[_0x2ce7e7(0x4f3,0x574,0x53f,0x575)]),_0x2b2d94=_0x3a3dcc[_0x1a42f3(0x255,0x28c,0x1d6,0x243)+_0x1a42f3(0x1b4,0x1bc,0x1f5,0x1ae)](_0x5215a2[_0x2ce7e7(0x4cc,0x4c4,0x4fe,0x47d)]),_0x506f9e=_0xf87e7e[_0x1a42f3(0x225,0x244,0x1fc,0x278)+_0x1a42f3(0x268,0x202,0x26a,0x2e7)](_0x5215a2[_0x1a42f3(0x241,0x2a0,0x2d0,0x2c9)]);_0x593dcf[_0x2ce7e7(0x5c6,0x63d,0x650,0x54d)]&&_0x593dcf[_0x1a42f3(0x27f,0x22e,0x2be,0x2e0)][_0x1a42f3(0x269,0x2b6,0x264,0x2b1)](_0x5215a2[_0x2ce7e7(0x4e0,0x4a9,0x524,0x533)])&&_0x593dcf['src']!==_0x41e1e5&&_0x5cb99c['revokeObje'+_0x1a42f3(0x23f,0x23f,0x290,0x1c3)](_0x593dcf['src']);if(_0x26073a)_0x593dcf[_0x1a42f3(0x27f,0x285,0x1f4,0x252)]=_0xd0ede6,_0x593dcf[_0x2ce7e7(0x574,0x53e,0x531,0x511)][_0x1a42f3(0x219,0x1d6,0x26a,0x1bb)]=_0x5215a2[_0x1a42f3(0x262,0x1db,0x28e,0x2a2)],_0x2b2d94[_0x2ce7e7(0x574,0x54e,0x515,0x525)][_0x1a42f3(0x219,0x20f,0x244,0x212)]=_0x5215a2[_0x1a42f3(0x22f,0x1f8,0x228,0x24d)],_0x506f9e[_0x1a42f3(0x22d,0x263,0x1a2,0x28b)]['display']=_0x5215a2[_0x2ce7e7(0x4ec,0x51c,0x522,0x507)];else{const _0x14bd96=_0x5215a2['ARqxW'][_0x1a42f3(0x256,0x278,0x28a,0x1db)]('|');let _0x2fa69e=-0x1*-0xe0c+0x8b5+-0x48d*0x5;while(!![]){switch(_0x14bd96[_0x2fa69e++]){case'0':_0x3ce1a6=null;continue;case'1':_0x593dcf[_0x1a42f3(0x27f,0x2fd,0x2e1,0x1ee)]='';continue;case'2':_0x593dcf['style'][_0x2ce7e7(0x560,0x564,0x5c6,0x59f)]=_0x5215a2['wifLd'];continue;case'3':_0x568a04[_0x1a42f3(0x1c2,0x18c,0x1d3,0x1d3)+_0x1a42f3(0x20f,0x204,0x17d,0x22b)]=null;continue;case'4':_0x2b2d94[_0x1a42f3(0x22d,0x258,0x270,0x282)][_0x1a42f3(0x219,0x20b,0x2aa,0x29a)]=_0x1a42f3(0x1c3,0x14b,0x158,0x244);continue;case'5':_0x506f9e['style'][_0x1a42f3(0x219,0x21a,0x18b,0x218)]=_0x5215a2[_0x2ce7e7(0x576,0x50d,0x5e6,0x5c7)];continue;}break;}}}}else{const _0x46ff7f=_0x5215a2[_0x1a42f3(0x200,0x1f6,0x1ca,0x199)][_0x1a42f3(0x256,0x2c7,0x2d9,0x270)]('|');let _0x560633=0xb*-0x71+0x1b*-0xf6+0x1ecd;while(!![]){switch(_0x46ff7f[_0x560633++]){case'0':_0x2b0de4[_0x2ce7e7(0x574,0x601,0x581,0x4e9)]['display']=_0x5215a2[_0x2ce7e7(0x576,0x566,0x5e7,0x4f4)];continue;case'1':comfyuiImageObjectURL=null;continue;case'2':_0x16ad2d[_0x2ce7e7(0x574,0x50f,0x56d,0x52e)][_0x1a42f3(0x219,0x253,0x19c,0x221)]=_0x5215a2[_0x2ce7e7(0x576,0x606,0x5bd,0x5ec)];continue;case'3':_0x2b0de4['src']='';continue;case'4':_0x5dcce5[_0x2ce7e7(0x574,0x570,0x50b,0x597)]['display']=_0x1a42f3(0x1c3,0x24b,0x1b4,0x15a);continue;case'5':window[_0x2ce7e7(0x509,0x58f,0x4e9,0x52c)+_0x1a42f3(0x20f,0x263,0x237,0x1c5)]=null;continue;}break;}}}function _0x49fda2(_0x2cae5a,_0x48c4e4,_0x374858,_0x258d4f){return _0x4843(_0x48c4e4- -0x37b,_0x2cae5a);}function removeComfyUIImage(){const _0x1b6451={'NjRfg':function(_0x505359,_0x3f874d){return _0x505359(_0x3f874d);}};_0x1b6451[_0x27aad3(0x99,0x22,0x45,0x7e)](updateComfyUIImagePreview,null);function _0x27aad3(_0x3385dc,_0x42dfb5,_0x1c9061,_0xb3d9aa){return _0x17f969(_0x3385dc-0x68,_0x1c9061- -0x2b3,_0x42dfb5,_0xb3d9aa-0x1de);}dbs['storeDelet'+'e'](COMFYUI_REF_CACHE_KEY);}async function handleImageUpload2(_0x397687){const _0x1ee2d6={'FwWZo':_0x23f989(0x2ec,0x30e,0x35d,0x388)+'0','FkSJp':_0x4c6bd4(0x4da,0x589,0x573,0x4f8),'WumfP':_0x4c6bd4(0x58b,0x4ec,0x49e,0x52f),'WjlZI':function(_0xafc8b2,_0x58b505){return _0xafc8b2!==_0x58b505;},'YfcDA':_0x23f989(0x27a,0x32b,0x2ee,0x372),'pvZMi':_0x4c6bd4(0x5ea,0x503,0x514,0x57a),'iUnuz':function(_0x5c34b9,_0x256ebc){return _0x5c34b9(_0x256ebc);},'ayEAB':function(_0x41607d,_0x1cbf9d){return _0x41607d===_0x1cbf9d;},'sDcIH':_0x23f989(0x2f2,0x2ed,0x2d1,0x26f),'VZLlO':_0x23f989(0x2fe,0x28e,0x2f7,0x376)+_0x4c6bd4(0x556,0x4c3,0x4fb,0x555),'PWLFX':function(_0x5114c4){return _0x5114c4();},'cGzQx':function(_0x24bbf4,_0x132432,_0x380e7a){return _0x24bbf4(_0x132432,_0x380e7a);},'YlLCW':_0x4c6bd4(0x564,0x5b3,0x5bc,0x5b8)+_0x23f989(0x2ef,0x306,0x2f5,0x2d3),'MwgDS':function(_0x32aa39,_0x88d595){return _0x32aa39+_0x88d595;},'IazxO':_0x4c6bd4(0x5d2,0x543,0x60c,0x5d5),'NyHLZ':function(_0x510f06,_0x1c3fe5){return _0x510f06(_0x1c3fe5);},'VLPGo':_0x4c6bd4(0x501,0x4d5,0x4e2,0x4e6),'exylU':_0x4c6bd4(0x585,0x514,0x509,0x503)+':\x20'},_0x2f807e=extension_settings[extensionName],_0x4131b7=_0x397687[_0x4c6bd4(0x55a,0x52a,0x566,0x529)][_0x23f989(0x320,0x33a,0x382,0x3de)][-0xad*0x25+0x22a9+-0x9a8];function _0x23f989(_0x479677,_0xbfc165,_0x4a5de,_0x115a28){return _0x17f969(_0x479677-0x149,_0x4a5de-0x89,_0xbfc165,_0x115a28-0x1d9);}if(!_0x4131b7)return;function _0x4c6bd4(_0x5a13ad,_0x4d7919,_0x306e24,_0x3577ea){return _0x49fda2(_0x4d7919,_0x3577ea-0x72c,_0x306e24-0x10b,_0x3577ea-0x78);}try{const _0x1a649e=await processUploadedImageToBlob(_0x4131b7),_0x260931=URL[_0x4c6bd4(0x4de,0x512,0x463,0x4d7)+'ctURL'](_0x1a649e);comfyuiImageObjectURL=_0x260931,_0x1ee2d6[_0x4c6bd4(0x4b4,0x4bb,0x52e,0x536)](updateComfyUIImagePreview,_0x260931);const _0x2958e7=new FormData();_0x2958e7[_0x23f989(0x346,0x3aa,0x3d6,0x454)](_0x4c6bd4(0x4fd,0x590,0x50b,0x547),_0x1a649e,_0x4131b7[_0x23f989(0x3a0,0x353,0x348,0x2cf)]);let _0x37dc83=_0x2f807e['comfyuiUrl'][_0x4c6bd4(0x4d6,0x5ad,0x521,0x542)]();if(!_0x37dc83){if(_0x1ee2d6[_0x23f989(0x2b2,0x2b0,0x2fd,0x362)](_0x23f989(0x3bf,0x3c7,0x36d,0x302),_0x1ee2d6['sDcIH'])){const _0x4cc91c=_0x1ee2d6[_0x23f989(0x2a9,0x316,0x324,0x36b)][_0x23f989(0x324,0x335,0x39b,0x3a0)]('|');let _0x7e69a3=0x1c2d+0x2dd*0x9+-0xaca*0x5;while(!![]){switch(_0x4cc91c[_0x7e69a3++]){case'0':_0x533349=null;continue;case'1':_0x4cd0ba['src']='';continue;case'2':_0x197e30[_0x4c6bd4(0x500,0x504,0x4ae,0x4f7)+_0x23f989(0x39b,0x309,0x354,0x2cc)]=null;continue;case'3':_0x257fce['style'][_0x23f989(0x364,0x339,0x35e,0x3e3)]=_0x4c6bd4(0x57b,0x5a1,0x58c,0x52f);continue;case'4':_0x5aa11c[_0x4c6bd4(0x514,0x5d6,0x5e2,0x562)]['display']=_0x1ee2d6['FkSJp'];continue;case'5':_0x8b90b1[_0x23f989(0x3a9,0x2f1,0x372,0x3b8)][_0x23f989(0x354,0x317,0x35e,0x378)]=_0x1ee2d6['WumfP'];continue;}break;}}else{_0x1ee2d6[_0x4c6bd4(0x4fd,0x56c,0x54f,0x536)](alert,_0x1ee2d6[_0x23f989(0x3c9,0x429,0x3e1,0x37e)]),_0x1ee2d6[_0x23f989(0x2f7,0x353,0x32d,0x3ac)](removeComfyUIImage);return;}}const _0x335680={};_0x335680[_0x23f989(0x426,0x3e7,0x3a6,0x3db)]=_0x4c6bd4(0x44b,0x494,0x48c,0x4cd),_0x335680[_0x4c6bd4(0x515,0x529,0x54e,0x51f)]=_0x2958e7;const _0x52c03d=await _0x1ee2d6['cGzQx'](fetch,_0x37dc83+(_0x4c6bd4(0x522,0x592,0x59f,0x54a)+_0x23f989(0x2f2,0x362,0x2e4,0x276)),_0x335680);if(_0x52c03d['ok']){const _0x297aad=await _0x52c03d[_0x4c6bd4(0x580,0x58e,0x5be,0x5d7)]();window[_0x4c6bd4(0x549,0x4c2,0x51c,0x4f7)+_0x4c6bd4(0x593,0x5ca,0x5ce,0x544)]=_0x297aad[_0x4c6bd4(0x4da,0x58b,0x4f7,0x538)],addLog(_0x23f989(0x3d3,0x3e5,0x3a9,0x3d1)+_0x23f989(0x32f,0x333,0x32e,0x30b)+JSON[_0x23f989(0x356,0x2cc,0x34b,0x315)](_0x297aad)),console['log'](_0x1ee2d6[_0x4c6bd4(0x4df,0x521,0x546,0x50e)],_0x297aad);const _0x59a2c3=new FileReader();_0x59a2c3[_0x4c6bd4(0x55c,0x551,0x59d,0x57b)]=()=>{function _0x35acd3(_0x1ea286,_0x2d3cf4,_0x5d9292,_0x3068fd){return _0x4c6bd4(_0x1ea286-0x78,_0x2d3cf4,_0x5d9292-0xf8,_0x3068fd- -0x367);}function _0x5daad1(_0x4d4fb6,_0x4119c6,_0xf1417f,_0x3df1ea){return _0x23f989(_0x4d4fb6-0x1eb,_0xf1417f,_0x4d4fb6- -0xa6,_0x3df1ea-0x3e);}if(_0x1ee2d6[_0x35acd3(0x243,0x2e9,0x207,0x269)](_0x1ee2d6[_0x35acd3(0xf6,0x164,0x147,0x163)],_0x1ee2d6[_0x5daad1(0x29e,0x289,0x24e,0x225)])){const _0x19e49e=_0x59a2c3[_0x5daad1(0x2c8,0x303,0x242,0x31f)],_0x28b47b={};_0x28b47b[_0x35acd3(0x215,0x1bb,0x276,0x21e)]=_0x19e49e,_0x28b47b[_0x5daad1(0x24a,0x27d,0x21f,0x231)+'Name']=_0x297aad[_0x5daad1(0x2a2,0x2fc,0x257,0x26a)];const _0x1084d6=_0x28b47b,_0x393a41={};_0x393a41['id']=COMFYUI_REF_CACHE_KEY,_0x393a41[_0x5daad1(0x2ef,0x272,0x27a,0x300)]=_0x1084d6,dbs[_0x35acd3(0x226,0x2c6,0x281,0x254)+_0x5daad1(0x23d,0x20a,0x1c2,0x266)](_0x393a41);}else _0x3fb983[_0x5daad1(0x31e,0x2b7,0x374,0x30a)]='',_0x5b0f94[_0x35acd3(0x169,0x242,0x28b,0x1fb)]['display']=_0x35acd3(0x150,0x232,0x165,0x1c8),_0x1566f1['style']['display']=_0x1ee2d6[_0x35acd3(0x181,0x22c,0x1ed,0x1d8)],_0x1a7059[_0x35acd3(0x1ec,0x26a,0x278,0x1fb)][_0x5daad1(0x2b8,0x2db,0x280,0x316)]=_0x1ee2d6[_0x5daad1(0x2f3,0x2e0,0x2cb,0x31d)],_0x36b3ea[_0x5daad1(0x246,0x297,0x270,0x2b4)+_0x5daad1(0x229,0x1ca,0x266,0x1d1)+'e']=null;},_0x59a2c3[_0x4c6bd4(0x5b3,0x4a8,0x4a5,0x524)+_0x4c6bd4(0x4ed,0x53f,0x4ea,0x4fa)](_0x1a649e);}else{const _0xf4d5dd=await _0x52c03d['text']();_0x1ee2d6[_0x4c6bd4(0x50b,0x4b8,0x4cf,0x536)](alert,_0x1ee2d6[_0x4c6bd4(0x634,0x5a3,0x650,0x5ce)](_0x1ee2d6[_0x4c6bd4(0x620,0x55a,0x523,0x5a0)],_0xf4d5dd)),_0x1ee2d6[_0x4c6bd4(0x5c7,0x539,0x4ca,0x53e)](addLog,_0x4c6bd4(0x56f,0x5d7,0x55b,0x551)+_0x23f989(0x426,0x3ab,0x3a8,0x438)+_0xf4d5dd),console[_0x23f989(0x3f4,0x41c,0x3b4,0x3e3)](_0x1ee2d6[_0x23f989(0x328,0x301,0x367,0x3ab)],_0xf4d5dd),removeComfyUIImage();}}catch(_0x5347c6){alert(_0x1ee2d6[_0x23f989(0x3b0,0x3a1,0x3de,0x440)](_0x1ee2d6[_0x4c6bd4(0x562,0x532,0x4c5,0x508)],_0x5347c6[_0x4c6bd4(0x4ee,0x4de,0x542,0x566)])),console['error'](_0x23f989(0x2b0,0x361,0x313,0x367)+':',_0x5347c6),addLog(_0x23f989(0x318,0x2e8,0x361,0x398)+'详情:\x20'+JSON[_0x4c6bd4(0x59a,0x4ed,0x4f4,0x53b)](_0x5347c6)),_0x1ee2d6['PWLFX'](removeComfyUIImage);}}async function loadCachedImages(){const _0x1ba98a={'IigQp':_0x3e08af(0xf8,0x116,0x10c,0x17d),'oKFyb':_0xca5c36(0x3b5,0x35b,0x31e,0x326),'gicXa':'none','SBCPn':_0xca5c36(0x2dd,0x360,0x343,0x358),'beCHv':_0xca5c36(0x346,0x31c,0x305,0x2ce),'zeatn':_0x3e08af(0x156,0x109,0x191,0x1d7)+_0xca5c36(0x345,0x383,0x35a,0x39e)+'\x20NovelAI\x20V'+_0xca5c36(0x39d,0x3a1,0x381,0x32f),'axXWi':_0x3e08af(0xcf,0x126,0xfb,0x66)+'2','CEIrn':function(_0x274170,_0x1a8949){return _0x274170!==_0x1a8949;},'fdNUm':'sJqgY','aSYqb':function(_0x20937d,_0x3867ff){return _0x20937d(_0x3867ff);},'yYKTm':function(_0x5c2788,_0x499d12){return _0x5c2788===_0x499d12;},'GfGBx':'NPDbX','NBqYB':_0x3e08af(0x156,0x199,0xe2,0x161)+_0x3e08af(0x12d,0x1ab,0xe4,0xb1)+_0x3e08af(0x187,0x219,0x133,0x1ef)+_0xca5c36(0x450,0x3e3,0x3cb,0x457)+_0xca5c36(0x3c8,0x39d,0x364,0x31e),'gQodz':_0xca5c36(0x3e5,0x35e,0x3b0,0x376),'ftslk':function(_0x5cb8d7,_0x4c1b49){return _0x5cb8d7(_0x4c1b49);},'xyqvT':function(_0x39b1c4,_0x1c2c7b){return _0x39b1c4===_0x1c2c7b;},'JqLHn':_0x3e08af(0xc7,0xe6,0xdc,0xfc),'xYjFz':_0xca5c36(0x467,0x3ef,0x476,0x413)+_0x3e08af(0x92,0x7e,0xab,0xdf)+_0x3e08af(0xef,0xc6,0x8f,0xfb)+_0x3e08af(0xf5,0x160,0x185,0xef)+_0x3e08af(0xc3,0x94,0xe9,0xd4)+_0xca5c36(0x428,0x3b0,0x39c,0x3c3)+_0x3e08af(0xa0,0x68,0xb0,0x9c)+_0x3e08af(0x13d,0xb7,0x128,0x1cb)+_0x3e08af(0xf3,0xab,0x151,0xaf)+_0xca5c36(0x2e6,0x352,0x2c0,0x3b4),'RoAGl':function(_0x2dab2c,_0x3a8b1d){return _0x2dab2c===_0x3a8b1d;},'mSOnS':_0xca5c36(0x3bf,0x3e7,0x3a0,0x445),'fyRAd':_0x3e08af(0x156,0x146,0xc7,0x177)+'ing\x20cached'+_0xca5c36(0x43c,0x3ee,0x3c1,0x39e)+_0xca5c36(0x2ae,0x2f0,0x290,0x36d)};function _0x3e08af(_0x2dbb19,_0x15ab0e,_0x34617c,_0xad1ca8){return _0x49fda2(_0xad1ca8,_0x2dbb19-0x2fa,_0x34617c-0x117,_0xad1ca8-0xee);}function _0xca5c36(_0x457a85,_0x396769,_0x5201d2,_0x4e3c71){return _0x17f969(_0x457a85-0xf7,_0x396769-0x9d,_0x4e3c71,_0x4e3c71-0x114);}await dbs[_0xca5c36(0x43a,0x3e1,0x3a2,0x415)]();try{const _0x237278=await dbs[_0xca5c36(0x384,0x30c,0x28f,0x28d)+_0xca5c36(0x29d,0x322,0x353,0x2ce)](NAI_VIBE_CACHE_KEY);if(_0x237278&&_0x237278['data']){if(_0x1ba98a[_0xca5c36(0x349,0x37c,0x38e,0x392)](_0x3e08af(0xf4,0xf7,0x69,0x159),_0x1ba98a[_0xca5c36(0x31b,0x2fa,0x271,0x34a)]))_0x1ba98a[_0x3e08af(0x15d,0x190,0x1b6,0xd1)](updateNovelaiImagePreview,_0x237278[_0x3e08af(0x153,0x10d,0xf7,0x1de)]);else{const _0x7f197a=_0x59f1fb['getElement'+_0xca5c36(0x38b,0x3c1,0x3e8,0x403)](_0x3e08af(0xc0,0x11e,0x74,0x147)+_0xca5c36(0x324,0x2f4,0x2e6,0x360)+_0xca5c36(0x3af,0x3ca,0x348,0x43e)),_0x638f1f=_0x5dd873[_0xca5c36(0x34f,0x3ae,0x3c7,0x35d)+_0xca5c36(0x2fc,0x30d,0x318,0x2e2)](_0x3e08af(0x13b,0x16f,0x1a9,0xe1)+'har-ref-im'+_0x3e08af(0x190,0x13d,0x1db,0x15e)+_0xca5c36(0x3fd,0x36f,0x2f4,0x30a)+_0xca5c36(0x375,0x38d,0x347,0x32a)+_0x3e08af(0x12a,0x1ba,0x1b4,0xf5)+'laceholder'),_0x1cf0db=_0x303434['getElement'+_0x3e08af(0x16b,0xdb,0x162,0x1b8)](_0xca5c36(0x2c4,0x329,0x333,0x309)+_0x3e08af(0xd7,0x82,0x112,0x4b)+_0xca5c36(0x30a,0x361,0x3aa,0x340)+_0x3e08af(0x14d,0xbf,0x14a,0xe7));if(_0x37fe4d&&_0x16ea47[_0x3e08af(0x16c,0xe3,0x151,0x155)](_0x1ba98a[_0x3e08af(0x16f,0x1ef,0x140,0x153)])){_0x7f197a['src']=_0x20c5dd,_0x7f197a[_0x3e08af(0x130,0x1b3,0x18d,0xc4)][_0x3e08af(0x11c,0x152,0x1a7,0x187)]=_0x1ba98a['oKFyb'],_0x638f1f[_0xca5c36(0x303,0x386,0x389,0x368)][_0xca5c36(0x32e,0x372,0x3af,0x403)]=_0x1ba98a[_0xca5c36(0x44f,0x3be,0x450,0x384)],_0x1cf0db[_0x3e08af(0x130,0x13f,0xad,0x129)][_0x3e08af(0x11c,0x115,0xe5,0xf5)]=_0xca5c36(0x296,0x328,0x380,0x34e)+'x';const _0x4b59d3=_0x28a8d4[_0xca5c36(0x3c8,0x3af,0x35b,0x35d)](','),_0x1cea9d=_0x4b59d3[0x11d*0xa+-0x1b29+-0x1*-0x1007][_0xca5c36(0x334,0x3af,0x426,0x3c3)](':')[0x39*-0x18+-0x2b5*0xd+-0x288a*-0x1][_0xca5c36(0x393,0x3af,0x34e,0x345)](';')[0x1b8d+-0x1ef8+0x19*0x23];_0x1f75a9=_0x1cea9d,_0x37fb89[_0x3e08af(0x175,0xf0,0x152,0x1a0)+'fImage']=_0x4b59d3[-0x1*-0x1711+-0x7*-0x124+0x4*-0x7c3];const _0xc5ece4={};_0xc5ece4['id']=_0x13d41a,_0xc5ece4['data']=_0x38f903,_0x55e3b7[_0xca5c36(0x467,0x3df,0x39a,0x3ea)+_0x3e08af(0xa1,0xd3,0xf2,0xc3)](_0xc5ece4);}else{const _0x5b8bdd=_0x1ba98a[_0x3e08af(0xd5,0xbf,0xde,0x87)][_0x3e08af(0x159,0x1e0,0x115,0x171)]('|');let _0x261353=-0x1b65+-0x21c3+0x3d28;while(!![]){switch(_0x5b8bdd[_0x261353++]){case'0':_0x7f197a['style'][_0x3e08af(0x11c,0x8c,0x17d,0x10a)]=_0x1ba98a[_0xca5c36(0x365,0x3be,0x335,0x368)];continue;case'1':_0x1cf0db[_0xca5c36(0x361,0x386,0x409,0x3da)][_0xca5c36(0x3bf,0x372,0x3dd,0x3e5)]=_0x1ba98a[_0xca5c36(0x332,0x3be,0x33e,0x35e)];continue;case'2':_0x671394[_0x3e08af(0x175,0x149,0x124,0x1b8)+_0xca5c36(0x27b,0x2f3,0x27a,0x2b7)]=null;continue;case'3':_0x7f197a['src']='';continue;case'4':_0x638f1f['style'][_0x3e08af(0x11c,0x95,0x170,0x111)]=_0x1ba98a[_0xca5c36(0x429,0x3a5,0x382,0x3dc)];continue;}break;}}}}}catch(_0x343e23){console[_0xca5c36(0x361,0x3c8,0x3ae,0x393)](_0x1ba98a['zeatn'],_0x343e23);}try{if(_0x1ba98a[_0xca5c36(0x2e1,0x2e7,0x2c6,0x298)](_0x3e08af(0x1a4,0x1ae,0x143,0x119),_0x1ba98a[_0xca5c36(0x393,0x326,0x37b,0x3ab)])){const _0x31c0f9=await dbs['storeReadO'+_0x3e08af(0xcc,0x64,0x81,0x122)](NAI_CHAR_REF_CACHE_KEY);_0x31c0f9&&_0x31c0f9[_0xca5c36(0x33d,0x3a9,0x373,0x371)]&&updateNovelaiCharRefImagePreview(_0x31c0f9['data']);}else _0x1a2c03(null),_0xaacdac[_0x3e08af(0xba,0xba,0x8f,0x9c)+'e'](_0x2689ca);}catch(_0x43c215){console[_0x3e08af(0x172,0x1c3,0x1c0,0x198)](_0x1ba98a[_0xca5c36(0x3c7,0x389,0x3a8,0x367)],_0x43c215);}try{const _0xc64a29=await dbs['storeReadO'+_0x3e08af(0xcc,0x8e,0x67,0x59)](COMFYUI_REF_CACHE_KEY);if(_0xc64a29&&_0xc64a29['data']&&_0xc64a29['data']['data']&&_0xc64a29['data'][_0xca5c36(0x2f3,0x304,0x276,0x329)+_0x3e08af(0x173,0x16b,0x151,0x1d3)]){if(_0x1ba98a[_0xca5c36(0x32e,0x2e7,0x2a8,0x263)](_0xca5c36(0x2e9,0x314,0x39d,0x2e3),_0x1ba98a[_0x3e08af(0xc4,0x8d,0x7e,0xab)]))_0x16a33a[_0xca5c36(0x36f,0x37e,0x315,0x40b)+'ById'](_0x3e08af(0xcf,0xb9,0x7b,0x47)+'_novelai')[_0xca5c36(0x31d,0x313,0x364,0x287)]();else{const _0x4d01ff=_0xc64a29[_0xca5c36(0x382,0x3a9,0x366,0x41c)],_0x50d238=await fetch(_0x4d01ff[_0xca5c36(0x3e0,0x3a9,0x351,0x379)]),_0x3d624c=await _0x50d238[_0xca5c36(0x387,0x3d7,0x39e,0x44f)](),_0x52cbdd=URL[_0x3e08af(0xa5,0x11c,0x11c,0x5e)+'ctURL'](_0x3d624c);_0x1ba98a[_0xca5c36(0x32f,0x33e,0x309,0x358)](updateComfyUIImagePreview,_0x52cbdd),comfyuiImageObjectURL=_0x52cbdd,window['comfyuican'+_0x3e08af(0x112,0x194,0xac,0xc1)]=_0x4d01ff[_0x3e08af(0xae,0x123,0x11d,0x6a)+_0x3e08af(0x173,0x15e,0x17c,0x1b1)],_0x1ba98a[_0xca5c36(0x36b,0x3b3,0x395,0x390)](addLog,_0x3e08af(0x138,0xc3,0x19d,0x180)+_0x3e08af(0x131,0xc5,0x110,0xf2)+_0x4d01ff['serverFile'+'Name']),console['log'](_0x3e08af(0x199,0x126,0x21b,0x1fe)+_0xca5c36(0x2dd,0x2e8,0x323,0x30c)+_0xca5c36(0x39f,0x3d5,0x40c,0x3f5)+_0xca5c36(0x3f6,0x392,0x3e1,0x414)+_0x4d01ff['serverFile'+_0xca5c36(0x33d,0x3c9,0x355,0x3ac)]);}}else{if(_0xc64a29&&_0x1ba98a[_0x3e08af(0xcb,0x10d,0xd5,0x148)](typeof _0xc64a29[_0x3e08af(0x153,0x124,0xc2,0x1a1)],'string')){if(_0x1ba98a[_0xca5c36(0x3f3,0x37c,0x2f5,0x364)](_0x1ba98a[_0x3e08af(0x161,0xee,0x160,0x1ca)],_0x1ba98a['JqLHn']))_0x3817aa['error'](_0x1ba98a['zeatn'],_0x3fffa0);else{const _0x3267be=await _0x1ba98a[_0xca5c36(0x3bb,0x3b3,0x393,0x409)](fetch,_0xc64a29['data']),_0x3bab0f=await _0x3267be[_0xca5c36(0x39c,0x3d7,0x442,0x35d)](),_0x339bc2=URL[_0xca5c36(0x2fc,0x2fb,0x340,0x299)+_0xca5c36(0x38c,0x398,0x362,0x332)](_0x3bab0f);updateComfyUIImagePreview(_0x339bc2),comfyuiImageObjectURL=_0x339bc2,console['warn'](_0x1ba98a[_0x3e08af(0xb0,0xa0,0xb5,0xe4)]);}}}}catch(_0x1b16c3){_0x1ba98a[_0xca5c36(0x39d,0x3d0,0x40d,0x35f)](_0xca5c36(0x2e3,0x315,0x306,0x36f),_0x1ba98a[_0x3e08af(0xdd,0x10c,0x9f,0x132)])?_0xe5cc4b[_0x3e08af(0x128,0x1b0,0x19a,0x1ab)+_0xca5c36(0x333,0x3c1,0x42a,0x347)](_0x1ba98a[_0x3e08af(0x10f,0xe6,0x101,0xa5)])[_0x3e08af(0xbd,0x12d,0xb1,0x37)]():console[_0x3e08af(0x172,0x17b,0x19c,0x163)](_0x1ba98a['fyRAd'],_0x1b16c3);}}export function initImageUpload(_0x3b95de){const _0x445dfa={'sabEK':'imageInput'+_0x51580c(0x39f,0x362,0x3ed,0x3c2),'fzucU':'imageInput'+'_nai_char_'+'ref','EiRth':function(_0x111c4d){return _0x111c4d();},'gtcnD':_0x2f8264(-0x1f6,-0x24e,-0x216,-0x288),'tDzLR':_0x51580c(0x3a6,0x36f,0x34b,0x34e),'jqcQH':'imageInput'+'2','XmZiC':_0x51580c(0x3e4,0x38e,0x3e4,0x3e4),'OsVmi':_0x2f8264(-0x17c,-0x1ce,-0x19e,-0x157),'wBQzY':function(_0x331307,_0x17da2c){return _0x331307===_0x17da2c;},'SgYFe':_0x51580c(0x2ff,0x29e,0x2c9,0x23f),'dEGkn':_0x51580c(0x2ab,0x2de,0x26e,0x30a)+_0x51580c(0x32c,0x35e,0x340,0x2e3)+'e-btn','BDcJS':_0x2f8264(-0x1c4,-0x186,-0x158,-0x137)+_0x51580c(0x2d5,0x297,0x313,0x327),'AzJYR':'#novelai-r'+_0x2f8264(-0x1f9,-0x1c9,-0x177,-0x1fc)+'e-btn','qlxro':_0x2f8264(-0x237,-0x146,-0x1cd,-0x251)+_0x51580c(0x2d7,0x2f1,0x27f,0x330)+_0x2f8264(-0x148,-0x1aa,-0x12a,-0x11f)+_0x2f8264(-0x10e,-0x14d,-0x146,-0xe4),'hCMyz':_0x51580c(0x2e8,0x2cd,0x322,0x2c6),'JKzHY':_0x2f8264(-0x1df,-0x1bc,-0x158,-0xde)+_0x2f8264(-0x1d7,-0x1d9,-0x18a,-0x15f)+'_ref','PraAN':'change','KEUTr':'#comfyui-s'+'elect-imag'+_0x2f8264(-0x23f,-0x201,-0x1b2,-0x1df),'qXptq':_0x51580c(0x3f1,0x3aa,0x3a5,0x3a1)+_0x2f8264(-0x19e,-0x1de,-0x177,-0xfb)+_0x2f8264(-0x13f,-0x1aa,-0x1b2,-0x185)};_0x445dfa[_0x51580c(0x30c,0x296,0x2ae,0x295)](loadCachedImages);function _0x2f8264(_0x251d86,_0x1ab177,_0x53ba03,_0x380172){return _0x49fda2(_0x1ab177,_0x53ba03-0x5f,_0x53ba03-0x15b,_0x380172-0x88);}_0x3b95de[_0x51580c(0x20f,0x29b,0x283,0x26b)](_0x445dfa[_0x51580c(0x34e,0x300,0x2eb,0x2d3)])['on'](_0x2f8264(-0x262,-0x263,-0x1de,-0x222),()=>{function _0x4e35d2(_0x357018,_0x315d92,_0x5484a6,_0x58b538){return _0x51580c(_0x357018-0x183,_0x5484a6- -0x3c9,_0x357018,_0x58b538-0x139);}function _0xdb49fb(_0x34d8d9,_0x120502,_0x5c1241,_0x175e8c){return _0x51580c(_0x34d8d9-0x8d,_0x34d8d9- -0x56b,_0x5c1241,_0x175e8c-0xf7);}document[_0x4e35d2(-0xc1,-0xff,-0x91,-0xb)+'ById'](_0x445dfa[_0xdb49fb(-0x248,-0x2aa,-0x2c4,-0x224)])[_0x4e35d2(-0x166,-0xeb,-0xfc,-0x142)]();}),_0x3b95de['find'](_0x445dfa[_0x51580c(0x365,0x370,0x36d,0x339)])['on']('change',handleNovelaiImageUpload),_0x3b95de[_0x2f8264(-0x199,-0x1f0,-0x210,-0x1b3)](_0x445dfa[_0x51580c(0x396,0x361,0x327,0x3b9)])['on']('click',()=>{removeNovelaiImage();}),_0x3b95de['find'](_0x445dfa[_0x51580c(0x30f,0x2bb,0x281,0x2c5)])['on'](_0x445dfa[_0x2f8264(-0x219,-0x177,-0x205,-0x185)],()=>{function _0x655f27(_0x1ff43c,_0x2ea14e,_0x127ed6,_0x2dde60){return _0x2f8264(_0x1ff43c-0xce,_0x2ea14e,_0x1ff43c- -0x82,_0x2dde60-0x169);}function _0x5a0b68(_0x5a5643,_0x22f9dc,_0x16591d,_0x408e66){return _0x2f8264(_0x5a5643-0x90,_0x16591d,_0x22f9dc-0x50f,_0x408e66-0x53);}document[_0x655f27(-0x1f5,-0x281,-0x27f,-0x16f)+_0x5a0b68(0x3bd,0x3df,0x384,0x450)](_0x445dfa[_0x5a0b68(0x2e0,0x36f,0x3d1,0x362)])['click']();}),_0x3b95de['find'](_0x445dfa[_0x2f8264(-0xbf,-0x174,-0x12b,-0x148)])['on'](_0x445dfa[_0x51580c(0x360,0x32a,0x2c0,0x2c7)],handleNovelaiCharRefImageUpload);function _0x51580c(_0x4cd2c4,_0x195ba4,_0x270a9b,_0x53ebf4){return _0x49fda2(_0x270a9b,_0x195ba4-0x50a,_0x270a9b-0x106,_0x53ebf4-0x141);}_0x3b95de[_0x51580c(0x2b8,0x29b,0x32b,0x209)](_0x2f8264(-0x77,-0x9f,-0xfe,-0xc2)+'emove-char'+'-ref-image'+'-btn')['on'](_0x445dfa[_0x2f8264(-0x1ab,-0x1f8,-0x205,-0x1c9)],()=>{removeNovelaiCharRefImage();}),_0x3b95de[_0x2f8264(-0x21e,-0x1f0,-0x210,-0x272)](_0x445dfa['KEUTr'])['on'](_0x445dfa['hCMyz'],()=>{function _0x310fea(_0x537ddc,_0x5532ef,_0x3b4770,_0x1c1698){return _0x51580c(_0x537ddc-0x1cb,_0x1c1698- -0x2f0,_0x3b4770,_0x1c1698-0x1ed);}function _0x3916ab(_0x5a62fb,_0x2e323b,_0x3701c9,_0x19df8c){return _0x51580c(_0x5a62fb-0x1c5,_0x5a62fb-0x19b,_0x3701c9,_0x19df8c-0x1c6);}_0x445dfa[_0x310fea(0x1d,0x13,-0x60,-0xc)]===_0x445dfa[_0x310fea(-0x23,0x7c,0xcf,0x47)]?_0x445dfa['EiRth'](_0x287610):document[_0x310fea(-0x2,-0x38,0xa3,0x48)+_0x310fea(0xf2,0x8d,0xe3,0x8b)](_0x445dfa[_0x310fea(0x42,0x63,-0x76,-0x28)])[_0x310fea(-0x97,-0x8c,-0x93,-0x23)]();}),_0x3b95de[_0x2f8264(-0x261,-0x291,-0x210,-0x1a2)](_0x2f8264(-0x183,-0xdc,-0x158,-0xd3)+'t2')['on'](_0x445dfa[_0x2f8264(-0x1e2,-0x10c,-0x181,-0x1a9)],handleImageUpload2),_0x3b95de[_0x2f8264(-0x281,-0x22c,-0x210,-0x241)](_0x445dfa[_0x51580c(0x2fc,0x364,0x3b0,0x38f)])['on'](_0x445dfa[_0x51580c(0x30a,0x2a6,0x2df,0x27f)],()=>{function _0x1c6556(_0x2bd8e2,_0x3be439,_0x43c77b,_0x2be347){return _0x2f8264(_0x2bd8e2-0x122,_0x3be439,_0x43c77b-0xe9,_0x2be347-0x1ef);}function _0x4a19a8(_0x5d608f,_0x10fb08,_0x31db46,_0x3770bd){return _0x51580c(_0x5d608f-0x128,_0x5d608f- -0x206,_0x31db46,_0x3770bd-0x25);}if(_0x445dfa[_0x4a19a8(0x166,0x130,0x1eb,0x1e7)]('mjKPs',_0x445dfa[_0x4a19a8(0x177,0x13a,0x15a,0x136)]))_0x445dfa['EiRth'](removeComfyUIImage);else{const _0xbe8212=_0x445dfa[_0x1c6556(-0x9c,-0x16d,-0x105,-0xf5)][_0x1c6556(-0x4c,-0xce,-0x59,-0x2a)]('|');let _0x1e4744=-0x2*-0x233+0x44c+-0x459*0x2;while(!![]){switch(_0xbe8212[_0x1e4744++]){case'0':_0x1e5215[_0x4a19a8(0x18c,0x13f,0x172,0x14c)]='';continue;case'1':_0x3f2ac4[_0x1c6556(-0xa1,0x0,-0x82,-0xf6)][_0x1c6556(-0xf,-0x5a,-0x96,-0x11)]='none';continue;case'2':_0x4d1b4e['style']['display']=_0x445dfa['OsVmi'];continue;case'3':_0x190f64['style'][_0x4a19a8(0x126,0x142,0x17d,0xf1)]=_0x1c6556(-0x157,-0x15a,-0xec,-0xee);continue;case'4':_0x54af7f[_0x1c6556(-0xae,-0x8b,-0x3d,0xd)+_0x1c6556(-0x13a,-0x117,-0x115,-0x161)]=null;continue;}break;}}});}export{updateNovelaiImagePreview,updateNovelaiCharRefImagePreview,updateComfyUIImagePreview,nai3VibeTransferImageMimeType,nai3CharRefImageMimeType,comfyuiImageObjectURL};
//# sourceMappingURL=http://localhost:8000/image_upload.js.map