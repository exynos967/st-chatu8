(function(_0x28c209,_0x512093){function _0x46d4b2(_0x21530c,_0x443dbc,_0x262bb3,_0x2eafd8){return _0x54c7(_0x21530c- -0x142,_0x443dbc);}function _0x143c5c(_0x11f825,_0xbef98b,_0x7a07e5,_0x33c4d0){return _0x54c7(_0x33c4d0- -0x387,_0xbef98b);}const _0xf2f755=_0x28c209();while(!![]){try{const _0x355a2b=parseInt(_0x143c5c(-0x140,-0x224,-0x195,-0x1a8))/(0xe5*-0x6+0xc9*-0x17+-0x176e*-0x1)+parseInt(_0x143c5c(-0x1f1,-0x1fd,-0x177,-0x17e))/(0x1a0*-0x1+0x1*-0x1431+0x15d3*0x1)*(parseInt(_0x143c5c(-0x238,-0x20d,-0x2ae,-0x290))/(0x3a9+0xd05+-0x10ab))+parseInt(_0x143c5c(-0x203,-0x254,-0x222,-0x224))/(-0xd*-0x58+-0x1675*-0x1+-0x53*0x53)+parseInt(_0x143c5c(-0x175,-0x153,-0x1d3,-0x17d))/(-0xa3b+-0x16*0x12d+0x241e*0x1)+parseInt(_0x46d4b2(0x43,0x29,0xf,0xab))/(-0x1*0x1319+0x1eb0+-0x1*0xb91)*(-parseInt(_0x46d4b2(0xf,0x54,0x86,0x5))/(-0x1626+0x2092*0x1+-0xa65))+parseInt(_0x46d4b2(-0x3d,-0x83,-0x8,-0x6))/(0x10*-0x17+0x1*0x1e12+-0x1c9a)+-parseInt(_0x46d4b2(0x38,0x7,-0x2,0x3d))/(0x5c4+0x82+-0x63d);if(_0x355a2b===_0x512093)break;else _0xf2f755['push'](_0xf2f755['shift']());}catch(_0x2794f0){_0xf2f755['push'](_0xf2f755['shift']());}}}(_0x2197,-0x68939*-0x1+0x466d3+-0x183f7*0x5));const _0x172f12=(function(){function _0x34f206(_0x18bfed,_0x3dc0d5,_0x106c51,_0x33f20c){return _0x54c7(_0x106c51-0x2a3,_0x18bfed);}function _0x468dc1(_0x40c342,_0x282e10,_0x2b2c24,_0x4eb32f){return _0x54c7(_0x2b2c24-0x3d4,_0x40c342);}const _0x1d9921={'jnEQk':_0x34f206(0x4d2,0x4a1,0x4a0,0x418)+'2','jUhxz':function(_0x5c77fb,_0x2a9e56){return _0x5c77fb(_0x2a9e56);},'Niaus':function(_0x45b861,_0x3333e6){return _0x45b861!==_0x3333e6;},'jZodi':_0x468dc1(0x521,0x57f,0x534,0x53d),'jJMDD':function(_0x4f781f,_0x457d2c){return _0x4f781f!==_0x457d2c;},'bpiVM':_0x34f206(0x36c,0x334,0x3aa,0x3b9),'oqvjU':_0x34f206(0x3e6,0x3c7,0x3d5,0x414),'uEyqd':function(_0x35964f,_0x12850f){return _0x35964f===_0x12850f;},'VXKPr':_0x468dc1(0x61e,0x5d6,0x5a4,0x5e6),'EmhgR':_0x34f206(0x4e2,0x413,0x496,0x50a)};let _0x36719e=!![];return function(_0x5705a0,_0x587ff4){function _0x40029e(_0x2af311,_0x4c2257,_0x4c548a,_0x12ab7a){return _0x468dc1(_0x12ab7a,_0x4c2257-0x14d,_0x2af311- -0x1c2,_0x12ab7a-0x1f0);}const _0x12fcab={'BvDkN':_0x40029e(0x40f,0x43c,0x399,0x3a5)+_0x2ba994(-0x47,-0xff,-0xcc,-0x8e),'NxQaw':_0x1d9921[_0x2ba994(-0xee,-0xb3,-0xb9,-0xf0)],'cURWD':function(_0x5c5faf,_0xbfe645){function _0x3a75c6(_0xb0b3f8,_0x131ac5,_0x191194,_0x5724e9){return _0x40029e(_0x131ac5-0x16a,_0x131ac5-0x56,_0x191194-0x1ae,_0x191194);}return _0x1d9921[_0x3a75c6(0x404,0x48d,0x474,0x4e7)](_0x5c5faf,_0xbfe645);},'VxDLs':function(_0x36a49c,_0x295b79){function _0x142110(_0x2bcf91,_0x163cdc,_0x4a7e0f,_0x1eb94b){return _0x2ba994(_0x2bcf91-0x130,_0x2bcf91,_0x4a7e0f-0x1b7,_0x4a7e0f-0x4ce);}return _0x1d9921[_0x142110(0x4ad,0x45e,0x4a7,0x4de)](_0x36a49c,_0x295b79);},'zRlEr':_0x1d9921['jZodi'],'JNSOa':function(_0x5de5f2,_0x3c19ac){return _0x1d9921['jJMDD'](_0x5de5f2,_0x3c19ac);},'LOmUT':_0x1d9921[_0x2ba994(-0xa4,-0xeb,-0x47,-0xc5)],'yOWDz':_0x1d9921['oqvjU']};function _0x2ba994(_0x286326,_0x104bd9,_0x41ce3a,_0x341d11){return _0x34f206(_0x104bd9,_0x104bd9-0xc8,_0x341d11- -0x4af,_0x341d11-0x62);}if(_0x1d9921[_0x40029e(0x312,0x332,0x308,0x361)](_0x1d9921[_0x40029e(0x3d4,0x388,0x373,0x3e4)],_0x1d9921['EmhgR']))_0x5c9816[_0x2ba994(-0x158,-0x10a,-0x14e,-0x109)+'ById'](_0x12fcab[_0x40029e(0x349,0x322,0x2ff,0x2ce)])[_0x40029e(0x35a,0x317,0x355,0x3ab)]();else{const _0x47b989=_0x36719e?function(){function _0x451231(_0x209de6,_0x2aa737,_0xbfe2a,_0x4393c6){return _0x2ba994(_0x209de6-0x1a4,_0x4393c6,_0xbfe2a-0xa,_0x209de6-0xb3);}const _0x29380e={'RpydS':function(_0x8b66dd,_0x3e3046){function _0x41ea5a(_0x1bb928,_0x228f1c,_0x1bcfd8,_0x26321a){return _0x54c7(_0x228f1c-0x2,_0x1bb928);}return _0x12fcab[_0x41ea5a(0x1de,0x179,0x19c,0xed)](_0x8b66dd,_0x3e3046);}};function _0x4242b6(_0x505797,_0x22587b,_0x192fd3,_0xb39b66){return _0x2ba994(_0x505797-0x150,_0x505797,_0x192fd3-0x112,_0xb39b66-0x221);}if(_0x12fcab['VxDLs'](_0x12fcab[_0x451231(0x3f,0xb4,0x8f,0x62)],_0x12fcab[_0x451231(0x3f,0x34,0xa7,0x93)]))_0x38a75b[_0x4242b6(0x111,0x103,0x155,0x118)+'ById'](_0x12fcab[_0x4242b6(0xfd,0x114,0xbc,0x104)])['click']();else{if(_0x587ff4){if(_0x12fcab[_0x4242b6(0xdc,0xdb,0xf7,0x145)](_0x12fcab[_0x451231(-0x60,-0xc9,-0x83,-0xc7)],_0x12fcab[_0x4242b6(0x1e2,0x185,0x1ac,0x1d1)])){const _0x4a6619=_0x587ff4[_0x4242b6(0x1c0,0x102,0x1c9,0x183)](_0x5705a0,arguments);return _0x587ff4=null,_0x4a6619;}else _0x29380e[_0x451231(-0x25,-0x33,-0x34,-0x88)](_0x59cdd1,null),_0x408ea8[_0x4242b6(0x1e6,0x174,0x160,0x167)+'e'](_0x3228d1);}}}:function(){};return _0x36719e=![],_0x47b989;}};}()),_0x240fa7=_0x172f12(this,function(){function _0x3184c4(_0x392e00,_0x264482,_0x4da90c,_0x2133a2){return _0x54c7(_0x4da90c-0x33e,_0x264482);}const _0x382c02={};function _0x1fd460(_0x1a8a0a,_0x448ea8,_0x3c3841,_0x620e86){return _0x54c7(_0x3c3841- -0xce,_0x1a8a0a);}_0x382c02['mVnuR']=_0x1fd460(0x42,0xf9,0xbb,0xba)+'+$';const _0x123881=_0x382c02;return _0x240fa7[_0x3184c4(0x429,0x40d,0x46f,0x3e9)]()[_0x3184c4(0x3cb,0x48a,0x44b,0x44b)](_0x123881[_0x3184c4(0x4df,0x46e,0x4d5,0x470)])['toString']()[_0x1fd460(0xcf,-0x1d,0x4c,0x65)+'r'](_0x240fa7)['search'](_0x123881['mVnuR']);});_0x240fa7();function _0x2197(){const _0x19f53f=['x25HAv9JAgfYxW','5zU+54Mh5Ase55cg5OIw5lIk5lYG5PE25yE66zsz','D3vmAfO','sM9VsKG','yK1dBM4','AfvYqNi','y3vQvNu','z0X5BfO','mtmWodG4nhPguurKyq','ueP6CK0','Aw5SAw5LlwzSzq','qKTzC2m','t3zXBeS','ywDL','BMfTzq','y29TzNL1AwnHBG','i25VDMvSywKTAq','x3jLzG','r0fKDw0','yxbWBhK','z2vFBMfPx2nOyq','t3rUt2S','5lIk5lYG5OIq5yQFlcdMNi3LIQhLMAJOV5q','Cw9RC3i','5zU+54Mh5lIk5lYG5OIq5yQFlcdMNi3LIQe','uLvkBNK','Aw1Hz2uVCg5N','yMXVyJO','y1vsv0q','Bw92zs1JAgfYlq','yu9mu04','nZu0ndiXng1TCfHcCG','AfrWDgW','EefVqNO','y3jLyxrLt2jQzq','x25VDMvSywK','Bw92zs1PBwfNzq','svf3vNm','A2fVDhvWAwfU','qKDgvKO','i25VDMvSywKTCG','ze5nuxO','mtmXmJi2v0PhuKHO','C3jJ','Derzwfa','tK9tzeO','kcGOlISPkYKRkq','rvfcDNi','sKneEwy','DhPvtvK','tMD3Avu','EKr3r1q','yNPvs2G','s2vRt1G','ienVBwz5vuKGAq','sNjVtMG','yNrU','Dg9Y','C3rVCMvszwfKtW','zMLSzxm','BvzUDvi','ELjSrxi','tuzctK0','CevvBNq','z2uY','ENDxwKm','DtGTAw1Hz2uTCa','wLvNrue','zw1VDMuTy2HHCG','B3bLBKrc','6zsz6k+V6k+M5OofoG','C3r5Bgu','A0LJz2W','qNLjza','CMv2B2TLt2jQzq','vxrNDfe','igzYB20Gy2fJAa','vNHYBxu','tNrxz3G','y0jPDuO','Dgv4Da','vuNLM77NIyC6ia','vxzbDxC','C3rYAw5NAwz5','CMvM','BgfPx2nOyxjFCG','ignHy2HLihrVia','C3bSAxq','DgfYz2v0','i2nVBwz5DwKTCW','AM9AzwW','v0rfCvy','ugzvyMS','zKLTywDL','sKPlwNm','zK5zs0S','rxjYB3iGChjVyW','Eu9xrhO','rxjYB3iGBg9Hza','z1zxs0S','tKToyNi','yLLJz0S','seL1zMG','vLHluhi','uhbNq3u','DxHjA3y','sgDIrKW','DhjKCKW','r2XqsMG','z3rkvKy','sNDkEhq','vvjm','yMXVyG','tg9HzgvKienVBq','DMLiEMG','vMD4s0q','swjiDu8','sLrfyMu','sfLRD1a','EhfgEuO','y3rvuKW','CgXHy2vOB2XKzq','yw5ZzMvYsw1HzW','zwXLy3qTAw1HzW','tMfTzq','yK5tvvK','5zU+54Mh5lIk5lYG5AsX6lsLlcdPLjNOR68','BgfPx3zPyMvFDa','CMvHzefZrgf0yq','zwXbssbJAgfYia','uvz3zvm','i25VDMvSywKTCW','oti2mtrnBe55tuC','zxCTy29UDgfPBG','BMX5','uMj1yNK','D1HXr2q','sgfArfe','tMLHDxm','vgXOqMm','zs1IDg4','sMjfCgS','rxbjBKq','C0nAy3m','zNLvssbPBwfNzq','5lUo57Yt5A2y5yQG6l29q29TzNK','zMXLEa','uM9qwfy','ruHLEgq','rwflCg4','BMfPm0nOyxjszq','zgf0ytPPBwfNzq','CxDnrKq','BfnMCMO','BgfJzwHVBgrLCG','t0DXDuG','DY1JB250ywLUzq','i2nVBwz5DwKTCG','Efn1uKu','l3vWBg9Hzc9PBq','y29TzNL1AvvYBa','zgf0yq','Aw1Hz2vjBNb1Da','wuz0Cem','zwzFAw1Hz2u','yMXVy2S','Ag5vuvm','C3rYAw5N','zgLZCgXHEq','r0LZu0y','wvfMu2q','Aw1Hz2u','qMzQDfC','sunjzwC','odj6B05QzNe','mZmXnJe1u0LWwfv6','tNHryxC','Ce9MCwq','tLrHD1u','zwXbssbPBwfNzq','sxHOqva','sufztKK','wvvwBfK','q2Xbvxe','mtK4mJD1CefMtwe','u013Dfi','te9Tvvq','C2vYDMvYrMLSzq','sKjLAw4','y2fJAgvFy29TzG','ihjLlxvWBg9Hza','EeLsDMi','CIaUC3qTy2HHDa','Duv5Cwq','rxjPEhK','CL9Yzwy','z2v0rwXLBwvUDa','BeLxC1e','mJu4nty1nMrcrhn4tW','ugjQug4','Euzcq2m','AgnzuvK','mNWXFdr8nxWWFa','i2nVBwz5DwKTAq','zwXLy3qTy2HHCG','BwvZC2fNzq','C2vHCMnO','A1ftExG','tKj5z24','CMfUC2zLCL9PBq','ALvOEhO','CxvLCNLtzwXLyW','BMfPm1zPyMvuCG','zfb1B0K','u0njAfu','ztOG','EgrHv1K','qurhsgW','y2fJAgvFBM92zq','y29UC3rYDwn0BW','u1Disg4','AM5fuwS','AgfYlxjLzI1PBq','AwLbELy','zMLUza','y2fJAguGzM9YBq','vhbwteO','zw1VDMuTAw1HzW','zxiGlNn0lwnOyq','BLjvCNa','DgHLig5LDYbMBW','BM92zwXHAs1Yzq','qvDVrLu','ChjLDMLLD0LTyq','CML0zq','D0feDwi','ywDLoG','lwj0BG','BNLxDvG','BM9Uzq','AgfYifjLzIbPBq','sK5tt2e','Dg9tDhjPBMC','Eu9js0K','zKLowfO','uNb5zfm','AgL2veq','C3rHCNrZv2L0Aa','qNzeA04','wwndrLq','DhjPBq','Aw5NignHy2HLza','zxnZAw5Nie5VDG','uhb5D3e','BwfNztO','5zU+54Mh5Ase55cg5AsX6lsLoIa','i2LTywDLsw5WDq','tvvAA2u','wuzqsfa','igzYB20GB2XKia','uxLWv1C','DgffDgG','nhWWFdn8mNWX','z3DfvhG','yNbPvK0','y2XPy2S','ie5VDMvSquKGvG','ywDLlxbYzxzPzq','C3rVCMvszwfKvW','swL4wfG','r2HZAeu','ssbbueNLNldLNydJGii','z2vFBM92zwXHAq','y29TzNL1As1Yzq','n3PMvhf6Aa','C3rVCMvezwXLDa','DvjQDhK','6k+35ywi6k6+572Uq29TzNLv','CLbyy0q','r0jSz0y','BwfNzs1WCMv2Aq','zxjYB3i','Dhu4lwLTywDLlq','lxjLzI1PBwfNzq'];_0x2197=function(){return _0x19f53f;};return _0x2197();}import{extension_settings}from'../../../../../extensions.js';import{saveSettingsDebounced}from'../../../../../../script.js';import{extensionName}from'../config.js';function _0x54c7(_0x1229aa,_0x32718a){_0x1229aa=_0x1229aa-(-0x2111+0x1441+0xdbf);const _0x35dec5=_0x2197();let _0x829923=_0x35dec5[_0x1229aa];if(_0x54c7['tVWbbQ']===undefined){var _0x4fa622=function(_0x457d1e){const _0x48984f='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x574798='',_0x17464c='',_0x1eeec3=_0x574798+_0x4fa622;for(let _0x506066=0x1*-0xb8d+-0x1e63*-0x1+-0x12d6,_0x1c49fd,_0x5a795e,_0xd651bc=0x26*0x6d+0xed9+0x1f07*-0x1;_0x5a795e=_0x457d1e['charAt'](_0xd651bc++);~_0x5a795e&&(_0x1c49fd=_0x506066%(-0x257c+0x17b0+-0x374*-0x4)?_0x1c49fd*(0x1929+0x659*0x3+-0x184*0x1d)+_0x5a795e:_0x5a795e,_0x506066++%(0x2*0x120d+0x1344*-0x1+-0x10d2))?_0x574798+=_0x1eeec3['charCodeAt'](_0xd651bc+(-0x365*-0x2+-0x1cd8*-0x1+-0x1*0x2398))-(-0x20e7+-0xe0f+0x2f00)!==-0x221*0x11+-0xfac+-0x47*-0xbb?String['fromCharCode'](-0x55e*0x6+-0x1*-0x1c73+-0x4c0*-0x1&_0x1c49fd>>(-(0x1324+-0xe5a*0x1+-0xcc*0x6)*_0x506066&0x1b4d+-0x1be1+0x9a)):_0x506066:-0x22c5+-0x2f*-0xb5+0x18a){_0x5a795e=_0x48984f['indexOf'](_0x5a795e);}for(let _0x32c0c4=-0x1b84+0xbe4+0xfa0,_0x2a7f1e=_0x574798['length'];_0x32c0c4<_0x2a7f1e;_0x32c0c4++){_0x17464c+='%'+('00'+_0x574798['charCodeAt'](_0x32c0c4)['toString'](0x19f8+-0xd*-0x1eb+-0x32d7))['slice'](-(-0x1*-0x1a4d+-0x7*-0x26+-0x1b55));}return decodeURIComponent(_0x17464c);};_0x54c7['bLdowO']=_0x4fa622,_0x54c7['mlQtBJ']={},_0x54c7['tVWbbQ']=!![];}const _0x530cdb=_0x35dec5[0x261e+-0xaf4*-0x2+-0x3c06],_0x49f043=_0x1229aa+_0x530cdb,_0x1c40dd=_0x54c7['mlQtBJ'][_0x49f043];if(!_0x1c40dd){const _0x13dd98=function(_0x3ccb00){this['lsxtdI']=_0x3ccb00,this['fVMskt']=[0x1738+-0xae+0x281*-0x9,-0xa1*-0x1d+-0x1430+-0x1*-0x1f3,-0x6*0x41f+-0x248b+0x3d45],this['DkJELF']=function(){return'newState';},this['HXXLpH']='\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*',this['eAUMax']='[\x27|\x22].+[\x27|\x22];?\x20*}';};_0x13dd98['prototype']['AcSVtb']=function(){const _0x4896eb=new RegExp(this['HXXLpH']+this['eAUMax']),_0x4d3a96=_0x4896eb['test'](this['DkJELF']['toString']())?--this['fVMskt'][0x117+0x35a+-0x470]:--this['fVMskt'][-0x1*0x178a+-0x3d3+0x1b5d];return this['vkgKHK'](_0x4d3a96);},_0x13dd98['prototype']['vkgKHK']=function(_0x59acbe){if(!Boolean(~_0x59acbe))return _0x59acbe;return this['qVTHxv'](this['lsxtdI']);},_0x13dd98['prototype']['qVTHxv']=function(_0x5d8964){for(let _0xc27dc=0x2*0x11b5+0x1bc1+0x67*-0x9d,_0x499c3d=this['fVMskt']['length'];_0xc27dc<_0x499c3d;_0xc27dc++){this['fVMskt']['push'](Math['round'](Math['random']())),_0x499c3d=this['fVMskt']['length'];}return _0x5d8964(this['fVMskt'][0x2b*-0xdb+-0xcd2+0x319b]);},new _0x13dd98(_0x54c7)['AcSVtb'](),_0x829923=_0x54c7['bLdowO'](_0x829923),_0x54c7['mlQtBJ'][_0x49f043]=_0x829923;}else _0x829923=_0x1c40dd;return _0x829923;}import{processUploadedImage,processUploadedImageToBlob,addLog}from'../utils.js';import{dbs}from'../database.js';function _0x591cca(_0x2a3dae,_0x1775d6,_0x8afcc2,_0x22f5ed){return _0x54c7(_0x1775d6- -0x251,_0x2a3dae);}const NAI_VIBE_CACHE_KEY=_0x591cca(-0x104,-0x138,-0xc3,-0xd7)+_0x591cca(-0xb7,-0x77,-0x11,-0x4e)+_0x47b3ff(0x265,0x222,0x2d1,0x1ef)+'age',NAI_CHAR_REF_CACHE_KEY='cache_nove'+_0x47b3ff(0x305,0x328,0x324,0x2a4)+_0x47b3ff(0x354,0x332,0x2db,0x349),COMFYUI_REF_CACHE_KEY=_0x591cca(-0xd0,-0x155,-0x106,-0x13b)+'yui_ref_im'+'age';let nai3VibeTransferImageMimeType=_0x47b3ff(0x2ca,0x2d4,0x339,0x256),nai3CharRefImageMimeType=_0x591cca(-0x116,-0xdc,-0x120,-0xca),comfyuiImageObjectURL=null;function updateNovelaiImagePreview(_0x133cfb){const _0x5de52f={};_0x5de52f[_0x55992a(0x2c0,0x255,0x212,0x23e)]='previewIma'+'ge_novelai',_0x5de52f[_0x432898(-0x135,-0x136,-0x171,-0x11d)]=_0x55992a(0x240,0x23c,0x1da,0x29b)+'mage-previ'+_0x432898(-0x82,-0xb8,-0x43,-0x145)+_0x55992a(0x1ea,0x1f4,0x216,0x1c1)+'tu8-image-'+'placeholde'+'r',_0x5de52f[_0x55992a(0x169,0x1c4,0x16b,0x17e)]=_0x55992a(0x1b1,0x1f7,0x212,0x204)+_0x55992a(0x2cb,0x250,0x1ec,0x237)+_0x432898(-0x184,-0x16c,-0xf8,-0x187);function _0x432898(_0x2c562c,_0x4eaedd,_0x577c24,_0x26f40d){return _0x47b3ff(_0x4eaedd- -0x3ed,_0x4eaedd-0x1d7,_0x577c24-0xc6,_0x577c24);}_0x5de52f['NTawU']=_0x432898(-0xee,-0xa6,-0x69,-0x81),_0x5de52f[_0x55992a(0x2e9,0x26d,0x2e6,0x267)]=function(_0x1220e5,_0x2f1161){return _0x1220e5!==_0x2f1161;},_0x5de52f[_0x432898(-0x199,-0x14c,-0x194,-0x1bc)]=_0x55992a(0x28a,0x22e,0x1a1,0x20d),_0x5de52f['HgbFL']=_0x55992a(0x31b,0x2d1,0x2aa,0x244),_0x5de52f[_0x55992a(0x2f9,0x286,0x29d,0x225)]=_0x432898(-0x1c4,-0x16a,-0x126,-0xfa),_0x5de52f[_0x432898(-0xd2,-0x93,-0x13,-0x96)]=_0x55992a(0x292,0x236,0x223,0x1ff)+'x',_0x5de52f[_0x432898(-0x120,-0x9a,-0xc,-0x89)]=function(_0x5e9fb4,_0x39341c){return _0x5e9fb4===_0x39341c;},_0x5de52f[_0x55992a(0x1e9,0x241,0x1fe,0x1d7)]='wADub',_0x5de52f[_0x55992a(0x277,0x2bb,0x302,0x29c)]=_0x432898(-0x6f,-0xab,-0xfb,-0x8d);const _0x119faa=_0x5de52f,_0x6afde8=document[_0x55992a(0x1cf,0x1d4,0x1c2,0x25d)+_0x432898(-0x89,-0xf4,-0xa8,-0xc5)](_0x119faa[_0x432898(-0x11a,-0x114,-0xe3,-0xf1)]);function _0x55992a(_0x56feea,_0x3fe812,_0x3cfba3,_0x341f7a){return _0x47b3ff(_0x3fe812- -0x84,_0x3fe812-0x178,_0x3cfba3-0x8b,_0x341f7a);}const _0x2652a1=document[_0x432898(-0x20e,-0x186,-0x1e7,-0x1e5)+'tor'](_0x119faa[_0x55992a(0x1e6,0x233,0x229,0x285)]),_0x19d0a4=document[_0x432898(-0x133,-0x195,-0x216,-0x158)+_0x432898(-0x16f,-0xf4,-0x162,-0xc8)](_0x119faa['IxhAP']);if(_0x133cfb&&_0x133cfb['startsWith'](_0x119faa[_0x55992a(0x1e3,0x1c2,0x237,0x20f)])){if(_0x119faa[_0x432898(-0x9d,-0xfc,-0x10d,-0x7d)](_0x119faa['IixXX'],_0x432898(-0x161,-0x13b,-0x14f,-0xba))){const _0x18b5ce=_0x1f010d?function(){function _0x32ed32(_0xe124c4,_0x355688,_0x43a65e,_0xee7267){return _0x55992a(_0xe124c4-0x116,_0xee7267-0x230,_0x43a65e-0x8a,_0x355688);}if(_0x4e655c){const _0x1ff866=_0x5a0030[_0x32ed32(0x421,0x49a,0x465,0x46f)](_0x585f91,arguments);return _0xf5b7d6=null,_0x1ff866;}}:function(){};return _0x6d00f6=![],_0x18b5ce;}else{_0x6afde8[_0x55992a(0x236,0x257,0x23f,0x2b8)]=_0x133cfb,_0x6afde8[_0x432898(-0xcf,-0xf6,-0x16e,-0x79)][_0x55992a(0x33d,0x2d4,0x265,0x297)]=_0x119faa[_0x432898(-0x13e,-0xd3,-0xce,-0x94)],_0x2652a1[_0x432898(-0x15f,-0xf6,-0x88,-0xec)][_0x432898(-0x118,-0x95,-0xd7,-0xf2)]=_0x119faa[_0x55992a(0x267,0x286,0x1f8,0x25e)],_0x19d0a4[_0x55992a(0x233,0x273,0x27a,0x2be)][_0x432898(-0x42,-0x95,-0xef,-0x17)]=_0x119faa[_0x432898(-0xc8,-0x93,-0xbf,-0x3d)];const _0x30ec3d=_0x133cfb[_0x55992a(0x208,0x283,0x2e2,0x22b)](','),_0x1c2450=_0x30ec3d[-0x1993+-0x2499+0x2*0x1f16]['split'](':')[-0x4*-0x35b+-0x1*0x2001+0x4e*0x3d][_0x432898(-0xf6,-0xe6,-0x78,-0x88)](';')[-0xa7b*-0x1+0x5a7+-0x1022];nai3VibeTransferImageMimeType=_0x1c2450,window[_0x432898(-0x173,-0x185,-0x129,-0x168)+_0x432898(-0x102,-0xc3,-0xcd,-0x11a)+'e']=_0x30ec3d[0x1*-0x4aa+-0x146*0x1+0x5f1];const _0x35c55d={};_0x35c55d['id']=NAI_VIBE_CACHE_KEY,_0x35c55d[_0x55992a(0x2ce,0x2cd,0x2ae,0x305)]=_0x133cfb,dbs[_0x55992a(0x23d,0x21c,0x257,0x286)+'rite'](_0x35c55d);}}else _0x119faa['YFtpC'](_0x432898(-0x1a9,-0x16e,-0x168,-0x115),_0x119faa['OtnOk'])?(_0x6afde8['src']='',_0x6afde8[_0x432898(-0x17d,-0xf6,-0x169,-0xe2)]['display']=_0x119faa[_0x432898(-0x11a,-0xe3,-0x5d,-0x62)],_0x2652a1['style'][_0x432898(-0x83,-0x95,-0x6a,-0xc9)]=_0x119faa['sCZcs'],_0x19d0a4[_0x55992a(0x26c,0x273,0x230,0x301)][_0x55992a(0x2ba,0x2d4,0x35c,0x2c8)]=_0x119faa[_0x55992a(0x298,0x286,0x25c,0x24e)],window[_0x55992a(0x1ce,0x1e4,0x220,0x241)+_0x432898(-0xf9,-0xc3,-0xee,-0x90)+'e']=null):_0x439188[_0x55992a(0x2de,0x276,0x27b,0x262)+_0x55992a(0x2a1,0x2a4,0x2aa,0x31f)](_0x2a8d56['src']);}function removeNovelaiImage(){const _0x325853={'hcYQY':function(_0x162566,_0x1d4d2c){return _0x162566(_0x1d4d2c);}};_0x325853[_0x2b4266(0x10b,0x165,0x15a,0x90)](updateNovelaiImagePreview,null);function _0x2b4266(_0x89b823,_0x1a30c2,_0x26cc82,_0x4dbc4e){return _0x591cca(_0x1a30c2,_0x89b823-0x254,_0x26cc82-0x1c5,_0x4dbc4e-0xc3);}dbs['storeDelet'+'e'](NAI_VIBE_CACHE_KEY);}async function handleNovelaiImageUpload(_0x279b0a){const _0x2ed612={'BfjtW':function(_0x46d97d){return _0x46d97d();},'YMMin':_0x6f7e6c(0x464,0x3f0,0x46d,0x4eb),'ADGHl':function(_0x312651,_0x534291,_0x3676f7){return _0x312651(_0x534291,_0x3676f7);},'mPNUL':function(_0x36833f,_0x23e6b6){return _0x36833f(_0x23e6b6);},'xSuRE':function(_0x156bb3,_0x438030){return _0x156bb3===_0x438030;},'KekOX':_0x6f7e6c(0x4c8,0x4e5,0x485,0x49b),'QVweS':_0x6f7e6c(0x52d,0x4b6,0x522,0x576)+_0x6f7e6c(0x430,0x451,0x4a2,0x430)+_0x6f7e6c(0x4e2,0x3f4,0x459,0x3d3)+':','Vxrmu':function(_0x5b5a5f,_0x4fcc60){return _0x5b5a5f(_0x4fcc60);},'bMCnn':function(_0x338d37,_0x458945){return _0x338d37+_0x458945;},'gCaPi':_0x3ab5ef(0x4f9,0x474,0x573,0x586)},_0x414c2c=_0x279b0a[_0x6f7e6c(0x583,0x52a,0x51a,0x4aa)][_0x6f7e6c(0x58b,0x48d,0x4fd,0x4f1)][0x2*0xe61+0x1*0xa14+-0x26d6];function _0x6f7e6c(_0x284a2f,_0x938250,_0x1d7842,_0x53ad75){return _0x591cca(_0x938250,_0x1d7842-0x5b8,_0x1d7842-0x65,_0x53ad75-0x1b7);}if(!_0x414c2c)return;function _0x3ab5ef(_0x3302e4,_0x398d13,_0x335cfb,_0x4f7f66){return _0x47b3ff(_0x3302e4-0x266,_0x398d13-0x148,_0x335cfb-0x4a,_0x398d13);}try{if(_0x2ed612['YMMin']===_0x6f7e6c(0x475,0x4d1,0x46d,0x46b)){const _0x1f4f66=await _0x2ed612[_0x3ab5ef(0x4d3,0x53c,0x500,0x44c)](processUploadedImage,_0x414c2c,!![]);_0x2ed612['mPNUL'](updateNovelaiImagePreview,_0x1f4f66);}else _0x2ed612[_0x3ab5ef(0x5c2,0x57a,0x626,0x5a2)](_0x546d8f);}catch(_0x378be5){if(_0x2ed612[_0x6f7e6c(0x5ee,0x541,0x560,0x536)](_0x2ed612[_0x3ab5ef(0x54b,0x537,0x5a2,0x5ac)],_0x2ed612[_0x3ab5ef(0x54b,0x53d,0x55d,0x522)]))console[_0x6f7e6c(0x53e,0x50b,0x4bf,0x4d8)](_0x2ed612[_0x3ab5ef(0x598,0x5b7,0x563,0x552)],_0x378be5),_0x2ed612[_0x3ab5ef(0x563,0x560,0x5ae,0x569)](alert,_0x2ed612[_0x6f7e6c(0x49f,0x501,0x4c6,0x53e)](_0x2ed612['gCaPi'],_0x378be5[_0x3ab5ef(0x4c7,0x472,0x4d8,0x478)]));else{const _0x3478b7=_0x122a87['result'],_0x4057ff={};_0x4057ff[_0x3ab5ef(0x5b7,0x5d6,0x601,0x590)]=_0x3478b7,_0x4057ff[_0x3ab5ef(0x4b5,0x4be,0x527,0x4c3)+'Name']=_0x53c5fd[_0x6f7e6c(0x4ef,0x46e,0x4d0,0x53e)];const _0x5deaf0=_0x4057ff,_0x412709={};_0x412709['id']=_0x322595,_0x412709[_0x3ab5ef(0x5b7,0x567,0x642,0x52d)]=_0x5deaf0,_0x5cc168[_0x6f7e6c(0x432,0x441,0x4b2,0x4bd)+_0x6f7e6c(0x409,0x47e,0x490,0x476)](_0x412709);}}}function updateNovelaiCharRefImagePreview(_0x312f11){const _0x2ad0ce={};_0x2ad0ce[_0x4b5106(0xc0,0x75,0xcf,0xea)]='previewIma'+_0x2cf517(0x115,0x23,0x117,0xa0),_0x2ad0ce[_0x2cf517(0x10e,0x111,0x64,0xcc)]=_0x4b5106(0xb3,0x64,0x32,0x17)+'mage-previ'+_0x4b5106(0xfe,0xd9,0xf7,0x95)+_0x2cf517(0x7a,0x25,0x31,0x74)+_0x4b5106(0x4,0x52,-0xa,0x1a)+_0x2cf517(0x191,0x107,0xee,0x125)+'r',_0x2ad0ce[_0x4b5106(-0x57,0xd,0x7f,-0x30)]=_0x4b5106(0x5c,0x1f,0x69,0x5b)+_0x2cf517(0xca,0xe0,0x102,0xd0)+_0x4b5106(-0x4b,0x25,0x3a,0x78),_0x2ad0ce[_0x2cf517(0xb9,0xf5,0xc6,0x108)]='data:image',_0x2ad0ce[_0x2cf517(0xcc,0x18c,0xc6,0x152)]=_0x4b5106(0x125,0xf9,0xee,0x76);function _0x2cf517(_0x1ce0fd,_0x33e524,_0x133a87,_0x17b079){return _0x591cca(_0x33e524,_0x17b079-0x1a2,_0x133a87-0x159,_0x17b079-0x1a0);}_0x2ad0ce[_0x4b5106(-0x6d,-0x3,0x39,0x7d)]='none',_0x2ad0ce['vFZGG']='previewIma'+_0x2cf517(0x7a,0x9e,0xbd,0xc0)+_0x2cf517(-0x20,0xbf,0x7f,0x53),_0x2ad0ce[_0x4b5106(0x9f,0xbf,0xc8,0xe6)]='novelai-re'+_0x4b5106(0xa1,0x71,0x88,0xa0)+'ref-image-'+_0x2cf517(0x5e,0x10a,0x150,0xe4),_0x2ad0ce[_0x2cf517(0x59,0x9a,0x1c,0x8d)]=function(_0x95e40b,_0x4306a2){return _0x95e40b!==_0x4306a2;},_0x2ad0ce[_0x2cf517(0xab,0x83,0xe2,0xe3)]=_0x4b5106(0x22,-0xc,-0x5c,0x4b),_0x2ad0ce[_0x4b5106(0x36,0x20,0xa2,0x82)]=_0x4b5106(0xcd,0x5e,0xea,-0x17)+'x';function _0x4b5106(_0x280986,_0x255c90,_0xcff5f3,_0x54d042){return _0x591cca(_0x54d042,_0x255c90-0x14a,_0xcff5f3-0x14b,_0x54d042-0x33);}_0x2ad0ce[_0x2cf517(0x141,0xc9,0x10a,0xf4)]=_0x2cf517(0xe4,0x16,0xf,0x86),_0x2ad0ce[_0x2cf517(0x126,0x74,0xc3,0xb5)]='0|4|2|1|3',_0x2ad0ce[_0x4b5106(0x7d,0xe1,0x7e,0x93)]='flex';const _0x488a50=_0x2ad0ce,_0x3cf08=document[_0x4b5106(-0x8,-0x4,-0x2f,-0x8f)+_0x2cf517(0x16b,0x130,0x163,0xf5)](_0x488a50['vFZGG']),_0xfcb261=document[_0x4b5106(0x98,0xb,0x93,-0x4b)+_0x4b5106(0xa2,0x8d,0xf8,0x118)]('#novelai-c'+_0x2cf517(0x2a,0xbd,0xfc,0x6e)+_0x4b5106(0x18,0x43,0x73,0xb4)+_0x2cf517(0xdb,0xbe,0x18b,0x148)+_0x4b5106(0x85,-0x8,0xf,-0xc)+_0x4b5106(0x19,0x96,0x110,0x46)+_0x4b5106(0xda,0xee,0x163,0x10d)),_0x234bd0=document[_0x4b5106(-0x10,-0x4,0x2c,0x4c)+_0x2cf517(0xff,0x16b,0x126,0xf5)](_0x488a50[_0x2cf517(0x171,0x9f,0x8d,0x117)]);if(_0x312f11&&_0x312f11['startsWith'](_0x488a50[_0x4b5106(0x139,0xb0,0xe7,0x61)])){if(_0x488a50[_0x2cf517(0xd6,0x10b,0x18,0x8d)](_0x488a50[_0x4b5106(0x2a,0x8b,0xf1,0x6e)],_0x488a50['JroNh'])){if(_0x124c30){const _0x56b7a2=_0xb38738[_0x2cf517(0xf5,0xfe,0x7f,0xbf)](_0x414259,arguments);return _0x291a3b=null,_0x56b7a2;}}else{_0x3cf08['src']=_0x312f11,_0x3cf08[_0x2cf517(0xae,0x83,0xe0,0xf3)][_0x4b5106(0xdd,0xfc,0x167,0x128)]=_0x488a50[_0x2cf517(0x10a,0x190,0x143,0x152)],_0xfcb261[_0x4b5106(0x58,0x9b,0x8f,0x6d)][_0x2cf517(0x18f,0xf7,0x195,0x154)]=_0x488a50[_0x2cf517(-0x12,0x80,0x80,0x55)],_0x234bd0[_0x2cf517(0xd6,0xae,0x103,0xf3)]['display']=_0x488a50[_0x4b5106(0x59,0x20,0x33,-0x6c)];const _0x103fec=_0x312f11['split'](','),_0x546441=_0x103fec[-0x431*0x8+-0x1be5+-0x3d6d*-0x1]['split'](':')[0x324+-0x50b*-0x7+-0x1e*0x148][_0x4b5106(0x12a,0xab,0xdb,0xe5)](';')[-0xd00+-0x24ba*0x1+0x4f9*0xa];nai3CharRefImageMimeType=_0x546441,window['nai3CharRe'+_0x2cf517(0xc0,0x180,0xe4,0x109)]=_0x103fec[-0x131b+-0x16*-0xba+0x320];const _0x496a88={};_0x496a88['id']=NAI_CHAR_REF_CACHE_KEY,_0x496a88[_0x4b5106(0x106,0xf5,0x75,0xb9)]=_0x312f11,dbs['storeReadW'+_0x4b5106(-0x59,0x22,0x8b,0x3)](_0x496a88);}}else{if(_0x4b5106(0xb9,0x2e,-0x34,0x4e)!==_0x488a50[_0x4b5106(0xc2,0x9c,0x9b,0xfc)]){const _0x1730b1=_0x5d8837[_0x4b5106(-0x6e,-0x4,0x89,0x36)+_0x2cf517(0x160,0xc4,0xd0,0xf5)](_0x488a50[_0x2cf517(0x116,0x4d,0xa2,0xcd)]),_0x2bc14a=_0x516da['querySelec'+'tor'](_0x488a50['hTptl']),_0x432c60=_0x53c240[_0x2cf517(0xa1,0x36,-0x30,0x54)+_0x4b5106(0xe1,0x9d,0xcf,0xff)](_0x488a50[_0x2cf517(0xeb,0x11,0xa7,0x65)]);if(_0x95a226&&_0x5101e8[_0x2cf517(0x5d,0x56,0xb,0x87)](_0x488a50['PfUbk'])){_0x1730b1['src']=_0x194f27,_0x1730b1[_0x4b5106(0xc6,0x9b,0x95,0x71)][_0x4b5106(0x178,0xfc,0x12c,0xe7)]=_0x488a50[_0x4b5106(0x141,0xfa,0xda,0x125)],_0x2bc14a[_0x2cf517(0x8d,0xd4,0xc6,0xf3)]['display']=_0x488a50[_0x4b5106(-0x7b,-0x3,0x10,0x62)],_0x432c60[_0x4b5106(0x90,0x9b,0x10f,0x22)][_0x2cf517(0x17b,0x1b7,0xe3,0x154)]='inline-fle'+'x';const _0x15bfaf=_0x69ae5[_0x4b5106(0x109,0xab,0x52,0x2d)](','),_0x5e9e23=_0x15bfaf[0xc49+-0x185c+-0xb*-0x119][_0x2cf517(0x10a,0x100,0x79,0x103)](':')[0x159a+0x1*-0x1e62+0x8c9]['split'](';')[-0xc*-0xf2+-0x21ca+0x1a*0xdd];_0xe1a8f3=_0x5e9e23,_0x3e331f[_0x2cf517(-0x1f,0xcf,0xa2,0x64)+_0x4b5106(0x10a,0xce,0x68,0x55)+'e']=_0x15bfaf[0x2*-0xcb3+-0x1cc3+0x362a];const _0x3f0c8a={};_0x3f0c8a['id']=_0xbd8354,_0x3f0c8a[_0x2cf517(0x18a,0x189,0xc0,0x14d)]=_0x110204,_0x646844[_0x2cf517(0x22,0xc2,0x35,0x9c)+_0x4b5106(0x8f,0x22,-0x51,0x6f)](_0x3f0c8a);}else _0x1730b1[_0x4b5106(0xb0,0x7f,0x8,0xb8)]='',_0x1730b1[_0x2cf517(0x120,0xc5,0xb8,0xf3)][_0x2cf517(0x185,0x152,0xff,0x154)]=_0x488a50['lIWsQ'],_0x2bc14a[_0x4b5106(0x5d,0x9b,0x67,0x54)][_0x4b5106(0x132,0xfc,0x15f,0x7c)]=_0x4b5106(0x15f,0xe6,0x108,0x131),_0x432c60[_0x2cf517(0x73,0xf0,0x110,0xf3)][_0x4b5106(0xcc,0xfc,0xe1,0x88)]=_0x4b5106(0x27,0x27,0xb2,-0x21),_0x4f6210['nai3VibeTr'+_0x4b5106(0x104,0xce,0x6a,0xc0)+'e']=null;}else{const _0x57fd40=_0x488a50[_0x2cf517(0x81,0x33,0xa3,0xb5)][_0x2cf517(0x10c,0x15f,0x152,0x103)]('|');let _0x51cf28=-0x1*-0xb46+0xf96+-0x12*0x17e;while(!![]){switch(_0x57fd40[_0x51cf28++]){case'0':_0x3cf08[_0x2cf517(0xee,0x49,0x72,0xd7)]='';continue;case'1':_0x234bd0[_0x2cf517(0x146,0x16a,0xfd,0xf3)][_0x4b5106(0x170,0xfc,0xfb,0x93)]=_0x488a50[_0x2cf517(0x5f,-0x22,0xac,0x55)];continue;case'2':_0xfcb261[_0x4b5106(0x126,0x9b,0x92,0x9a)][_0x2cf517(0xff,0x182,0x187,0x154)]=_0x488a50[_0x4b5106(0x13a,0xe1,0x103,0x141)];continue;case'3':window[_0x2cf517(0xe3,0xea,0x18e,0x142)+'fImage']=null;continue;case'4':_0x3cf08[_0x4b5106(0xc3,0x9b,0x95,0x8d)][_0x4b5106(0xd6,0xfc,0xf3,0x95)]='none';continue;}break;}}}}function removeNovelaiCharRefImage(){function _0x397ad5(_0x27fa46,_0x13e325,_0x497c26,_0x5cc260){return _0x591cca(_0x13e325,_0x5cc260-0x5e,_0x497c26-0x10e,_0x5cc260-0x16b);}const _0x146075={'qoksr':function(_0x4d3f65,_0x392b47){return _0x4d3f65(_0x392b47);}};function _0x2b52fb(_0x12afbf,_0x316ddc,_0x3e3988,_0x2fd8dc){return _0x47b3ff(_0x316ddc- -0x53d,_0x316ddc-0x81,_0x3e3988-0x90,_0x3e3988);}_0x146075[_0x2b52fb(-0x271,-0x276,-0x28b,-0x231)](updateNovelaiCharRefImagePreview,null),dbs[_0x2b52fb(-0x2b5,-0x296,-0x25f,-0x221)+'e'](NAI_CHAR_REF_CACHE_KEY);}async function handleNovelaiCharRefImageUpload(_0x4aaff0){function _0x2eeba0(_0x403a5a,_0x5169ac,_0x32ff53,_0x4c029a){return _0x47b3ff(_0x32ff53-0x147,_0x5169ac-0x1c6,_0x32ff53-0x1e5,_0x4c029a);}const _0x1a99fe={'OvqlK':function(_0x48e500,_0x26209b){return _0x48e500!==_0x26209b;},'BKYsc':_0x1ff95f(0x21b,0x1ab,0x1e4,0x1b4),'NOSdJ':_0x2eeba0(0x40d,0x402,0x45a,0x434),'ZUgEA':function(_0x2a2197,_0x55fe6f){return _0x2a2197(_0x55fe6f);},'aOLSN':_0x2eeba0(0x401,0x3de,0x457,0x496)+_0x1ff95f(0x207,0x1f1,0x177,0x253)+_0x1ff95f(0x20d,0x292,0x268,0x222)+'ref\x20image:','ClAUq':function(_0x19beb9,_0x3d69ed){return _0x19beb9(_0x3d69ed);},'GIsSF':_0x2eeba0(0x3e2,0x41c,0x3da,0x45a)},_0x182218=_0x4aaff0[_0x2eeba0(0x4d6,0x4a4,0x44f,0x4bb)][_0x2eeba0(0x407,0x411,0x432,0x3d8)][-0x6*0x287+0x2422+-0x14f8];function _0x1ff95f(_0x27f65a,_0x275c58,_0x16145e,_0x7a2dcc){return _0x591cca(_0x16145e,_0x275c58-0x307,_0x16145e-0x133,_0x7a2dcc-0x1);}if(!_0x182218)return;try{if(_0x1a99fe[_0x2eeba0(0x408,0x464,0x403,0x382)](_0x1a99fe[_0x1ff95f(0x212,0x21c,0x1b9,0x272)],_0x1a99fe[_0x1ff95f(0x282,0x23e,0x202,0x1f2)])){const _0x53de2e=await _0x1a99fe[_0x2eeba0(0x3ff,0x463,0x43a,0x46b)](processUploadedImage,_0x182218);updateNovelaiCharRefImagePreview(_0x53de2e);}else _0x223f13[_0x1ff95f(0x14e,0x1b9,0x186,0x23c)+_0x2eeba0(0x481,0x484,0x440,0x3d0)](_0x1ff95f(0x225,0x2b3,0x339,0x23f)+_0x2eeba0(0x398,0x3ad,0x3f7,0x3a3)+_0x2eeba0(0x40b,0x415,0x44b,0x3e2))[_0x1ff95f(0x21c,0x1fe,0x269,0x1cb)]();}catch(_0x4dc6db){console[_0x2eeba0(0x44a,0x3f1,0x3f4,0x380)](_0x1a99fe[_0x2eeba0(0x45a,0x3eb,0x415,0x389)],_0x4dc6db),_0x1a99fe[_0x1ff95f(0x1cf,0x1ac,0x1b8,0x197)](alert,_0x1a99fe[_0x1ff95f(0x289,0x2ba,0x31e,0x262)]+_0x4dc6db[_0x2eeba0(0x412,0x36c,0x3a8,0x3e6)]);}}function updateComfyUIImagePreview(_0x34015d){const _0x299b68={};_0x299b68[_0x2d0e6d(0x1cc,0x184,0x199,0x164)]=_0x2c3692(-0x22e,-0x246,-0x289,-0x2b8),_0x299b68['EQBvr']=_0x2c3692(-0x259,-0x25d,-0x1fd,-0x23e);function _0x2c3692(_0x57725f,_0x49bcca,_0x554b95,_0x53090a){return _0x591cca(_0x53090a,_0x49bcca- -0x13a,_0x554b95-0xf7,_0x53090a-0x4b);}_0x299b68[_0x2d0e6d(0x244,0x28d,0x27f,0x1be)]='previewIma'+_0x2c3692(-0x24e,-0x1f0,-0x19d,-0x269),_0x299b68[_0x2c3692(-0x1e7,-0x1b9,-0x178,-0x17b)]=_0x2c3692(-0x255,-0x281,-0x2f2,-0x2ce)+_0x2d0e6d(0x214,0x270,0x1e1,0x20b)+_0x2c3692(-0x1b4,-0x1ab,-0x14c,-0x1ed)+_0x2c3692(-0x234,-0x268,-0x1f6,-0x218)+_0x2c3692(-0x1c0,-0x232,-0x1b1,-0x1b6)+_0x2d0e6d(0x291,0x289,0x31d,0x2b8)+'r';function _0x2d0e6d(_0x122e4d,_0x671cf9,_0x1aa49a,_0x567cb0){return _0x47b3ff(_0x122e4d- -0x98,_0x671cf9-0x2c,_0x1aa49a-0x144,_0x1aa49a);}_0x299b68[_0x2d0e6d(0x1f0,0x1d8,0x1bb,0x1a9)]=_0x2c3692(-0x2b0,-0x23b,-0x21f,-0x278)+_0x2c3692(-0x28f,-0x20c,-0x1d9,-0x21d)+_0x2d0e6d(0x1e9,0x15c,0x248,0x1a3),_0x299b68[_0x2d0e6d(0x2ac,0x247,0x291,0x338)]='blob:',_0x299b68[_0x2d0e6d(0x1fe,0x283,0x170,0x24e)]=function(_0x47677c,_0x54a92e){return _0x47677c!==_0x54a92e;},_0x299b68['kQSyx']=_0x2d0e6d(0x2bd,0x260,0x2cf,0x244),_0x299b68['fNYKK']='inline-fle'+'x',_0x299b68[_0x2d0e6d(0x231,0x1f0,0x26b,0x29b)]=function(_0x8eb480,_0x26823b){return _0x8eb480===_0x26823b;},_0x299b68[_0x2d0e6d(0x295,0x314,0x2be,0x291)]=_0x2c3692(-0x173,-0x1a9,-0x17e,-0x1c9),_0x299b68[_0x2c3692(-0x246,-0x276,-0x28d,-0x1ef)]=_0x2d0e6d(0x2aa,0x314,0x328,0x21d);const _0x38c7ea=_0x299b68,_0x282629=document[_0x2d0e6d(0x1c0,0x219,0x191,0x233)+_0x2d0e6d(0x261,0x2aa,0x287,0x1e1)](_0x38c7ea['tDYXP']),_0x2644fe=document[_0x2d0e6d(0x1cf,0x176,0x215,0x195)+_0x2c3692(-0x225,-0x1f7,-0x210,-0x206)](_0x38c7ea[_0x2c3692(-0x179,-0x1b9,-0x14c,-0x19c)]),_0x4bd842=document[_0x2c3692(-0x28a,-0x288,-0x279,-0x2c4)+_0x2c3692(-0x1fc,-0x1e7,-0x21e,-0x227)](_0x38c7ea[_0x2d0e6d(0x1f0,0x1f3,0x21d,0x271)]);_0x282629['src']&&_0x282629[_0x2d0e6d(0x243,0x2bf,0x267,0x1d1)]['startsWith'](_0x38c7ea[_0x2d0e6d(0x2ac,0x2c5,0x27e,0x2dd)])&&_0x38c7ea['YFPHP'](_0x282629[_0x2d0e6d(0x243,0x1f0,0x25e,0x1ec)],_0x34015d)&&URL[_0x2d0e6d(0x262,0x27f,0x267,0x1dc)+'ctURL'](_0x282629[_0x2c3692(-0x1f1,-0x205,-0x1cc,-0x1fd)]);if(_0x34015d)_0x282629[_0x2c3692(-0x181,-0x205,-0x1ef,-0x264)]=_0x34015d,_0x282629[_0x2c3692(-0x1c6,-0x1e9,-0x211,-0x1f9)][_0x2d0e6d(0x2c0,0x236,0x345,0x286)]=_0x38c7ea[_0x2d0e6d(0x1cb,0x174,0x21e,0x167)],_0x2644fe[_0x2c3692(-0x225,-0x1e9,-0x1ef,-0x226)][_0x2c3692(-0x13d,-0x188,-0x18a,-0x1d6)]=_0x2c3692(-0x210,-0x25d,-0x224,-0x21c),_0x4bd842[_0x2d0e6d(0x25f,0x23e,0x242,0x26f)][_0x2d0e6d(0x2c0,0x28d,0x28f,0x2dc)]=_0x38c7ea[_0x2c3692(-0x15f,-0x1d1,-0x253,-0x247)];else{if(_0x38c7ea['RUJny'](_0x38c7ea[_0x2d0e6d(0x295,0x230,0x2a6,0x2ac)],_0x2c3692(-0x218,-0x1ff,-0x198,-0x21d))){const _0x307458=_0x38c7ea[_0x2d0e6d(0x1cc,0x178,0x245,0x246)][_0x2c3692(-0x1ca,-0x1d9,-0x21d,-0x194)]('|');let _0x41622b=-0x1fb1+0x1c17+-0x1cd*-0x2;while(!![]){switch(_0x307458[_0x41622b++]){case'0':_0x2ddb4a[_0x2c3692(-0x260,-0x1e9,-0x190,-0x1a5)][_0x2d0e6d(0x2c0,0x33d,0x2ed,0x253)]=_0x38c7ea[_0x2d0e6d(0x247,0x1ec,0x28c,0x1d7)];continue;case'1':_0x33c79c[_0x2c3692(-0x29c,-0x278,-0x209,-0x1ee)+_0x2d0e6d(0x292,0x289,0x263,0x250)+'e']=null;continue;case'2':_0x310526[_0x2c3692(-0x1bd,-0x1e9,-0x1cb,-0x1ff)][_0x2c3692(-0x212,-0x188,-0x1aa,-0x174)]=_0x2c3692(-0x23c,-0x25d,-0x25e,-0x269);continue;case'3':_0x5cb228['style']['display']='flex';continue;case'4':_0x211937[_0x2c3692(-0x179,-0x205,-0x226,-0x27f)]='';continue;}break;}}else _0x282629[_0x2d0e6d(0x243,0x1e0,0x1c1,0x2b5)]='',_0x282629[_0x2d0e6d(0x25f,0x2a4,0x294,0x1db)][_0x2d0e6d(0x2c0,0x291,0x2c0,0x252)]=_0x38c7ea[_0x2d0e6d(0x247,0x224,0x267,0x247)],_0x2644fe[_0x2c3692(-0x1b9,-0x1e9,-0x184,-0x169)]['display']=_0x38c7ea[_0x2d0e6d(0x1d2,0x1eb,0x20e,0x23f)],_0x4bd842[_0x2c3692(-0x222,-0x1e9,-0x190,-0x160)][_0x2c3692(-0x16b,-0x188,-0x1f4,-0x122)]=_0x38c7ea[_0x2c3692(-0x25e,-0x201,-0x27c,-0x1cd)],window[_0x2c3692(-0x22e,-0x221,-0x1ee,-0x22e)+_0x2c3692(-0x1e9,-0x20a,-0x209,-0x26e)]=null,comfyuiImageObjectURL=null;}}function removeComfyUIImage(){const _0x1c3161={'zVuJO':function(_0x27562e,_0x4c47de){return _0x27562e(_0x4c47de);}};function _0x266d68(_0x59874e,_0x54e5c6,_0x4c7aab,_0x45e830){return _0x47b3ff(_0x54e5c6- -0x9e,_0x54e5c6-0xc0,_0x4c7aab-0x5c,_0x4c7aab);}_0x1c3161['zVuJO'](updateComfyUIImagePreview,null),dbs[_0x266d68(0x19f,0x209,0x249,0x1df)+'e'](COMFYUI_REF_CACHE_KEY);}async function handleImageUpload2(_0x4034bd){const _0x5cc08b={'zDwGT':_0x7ac38a(0x9,-0xad,-0x39,-0x29),'xdaWY':_0x7ac38a(-0x121,-0x62,-0xd4,-0x10c)+'x','PfLfj':function(_0x5b30dd,_0x1c8b50){return _0x5b30dd!==_0x1c8b50;},'wXqGd':'RwCNz','JwJxt':function(_0x1c7c63,_0x22e146){return _0x1c7c63(_0x22e146);},'TpVLJ':function(_0xd2d3b7,_0x5cf1e9){return _0xd2d3b7(_0x5cf1e9);},'OGquH':_0x5b4528(0x2cc,0x333,0x2e4,0x2c6),'nyWuX':_0x5b4528(0x1ae,0x188,0x1e5,0x214)+_0x5b4528(0x232,0x273,0x222,0x20e),'QypWW':function(_0x1e33e9,_0x414cd1,_0x18c568){return _0x1e33e9(_0x414cd1,_0x18c568);},'GAdum':'POST','JooJH':function(_0x7e46e3,_0x15cb08){return _0x7e46e3(_0x15cb08);},'HYkwP':_0x5b4528(0x1c4,0x1bd,0x28a,0x231)+'回数据:','Jitam':function(_0x13caec,_0x1fe534){return _0x13caec+_0x1fe534;},'vZDEz':'上传失败:\x20','HaZDQ':function(_0x9d8048,_0x2dcc6d){return _0x9d8048(_0x2dcc6d);},'GlPJh':function(_0x410870){return _0x410870();},'eRwOM':function(_0x455c38,_0xc0f2cf){return _0x455c38+_0xc0f2cf;},'KZfZV':_0x5b4528(0x235,0x250,0x28b,0x21c)+':\x20','viHzh':_0x7ac38a(-0x10c,-0xf8,-0xdd,-0x7f)+':','uxIkv':function(_0xa49d3c,_0x30b63e){return _0xa49d3c(_0x30b63e);}};function _0x5b4528(_0x3a8476,_0x2d42c9,_0x180ac5,_0x718e09){return _0x47b3ff(_0x718e09- -0x95,_0x2d42c9-0x55,_0x180ac5-0x79,_0x2d42c9);}const _0x43a7d7=extension_settings[extensionName],_0x49627e=_0x4034bd['target'][_0x5b4528(0x2cb,0x2db,0x229,0x256)][-0x7d3*0x1+0x22f9+0xa*-0x2b7];if(!_0x49627e)return;function _0x7ac38a(_0x5352d1,_0x552e3a,_0x1a74e0,_0x4981a9){return _0x47b3ff(_0x1a74e0- -0x38e,_0x552e3a-0x1d3,_0x1a74e0-0x140,_0x5352d1);}try{if(_0x5cc08b['PfLfj'](_0x5cc08b['wXqGd'],_0x5cc08b[_0x5b4528(0x266,0x29f,0x296,0x2a3)]))_0x9e71f5[_0x7ac38a(-0x90,-0x50,-0xb3,-0xdd)]=_0x248008,_0x3ff729[_0x7ac38a(-0xb2,-0x8c,-0x97,-0x95)][_0x7ac38a(-0x8b,0x57,-0x36,-0x81)]=_0x5cc08b[_0x5b4528(0x207,0x28a,0x28e,0x24e)],_0x4fcdad['style'][_0x5b4528(0x2a7,0x33d,0x24c,0x2c3)]=_0x5b4528(0x1c8,0x1ff,0x1f6,0x1ee),_0xf8036c[_0x5b4528(0x252,0x2dc,0x272,0x262)][_0x7ac38a(0x15,-0x71,-0x36,-0x42)]=_0x5cc08b[_0x7ac38a(-0xe8,-0x18e,-0x122,-0xa5)];else{const _0x31eac4=await _0x5cc08b[_0x5b4528(0x2de,0x21f,0x29e,0x289)](processUploadedImageToBlob,_0x49627e),_0xef14e7=URL[_0x7ac38a(-0x36,-0x118,-0xbc,-0xbc)+_0x7ac38a(-0x3e,-0x34,-0x66,-0xb2)](_0x31eac4);comfyuiImageObjectURL=_0xef14e7,_0x5cc08b[_0x7ac38a(-0xc5,-0x8b,-0x118,-0xd6)](updateComfyUIImagePreview,_0xef14e7);const _0x3bf9c8=new FormData();_0x3bf9c8['append'](_0x5cc08b[_0x7ac38a(-0x66,0x10,-0x43,0x2b)],_0x31eac4,_0x49627e[_0x5b4528(0x28a,0x20d,0x1aa,0x229)]);let _0x2eb91e=_0x43a7d7[_0x5b4528(0x2a9,0x29b,0x307,0x2bb)][_0x7ac38a(-0x11b,-0xa5,-0x100,-0x156)]();if(!_0x2eb91e){_0x5cc08b[_0x5b4528(0x2bc,0x2fd,0x2e0,0x289)](alert,_0x5cc08b[_0x7ac38a(-0xa1,-0xe0,-0x10c,-0x10a)]),removeComfyUIImage();return;}const _0x26d4f6=await _0x5cc08b[_0x7ac38a(-0x84,-0x160,-0xf6,-0x122)](fetch,_0x2eb91e+(_0x7ac38a(0x4c,-0x35,-0x3f,-0x43)+_0x5b4528(0x231,0x1c8,0x2a6,0x228)),{'method':_0x5cc08b[_0x5b4528(0x22e,0x2b7,0x220,0x22d)],'body':_0x3bf9c8});if(_0x26d4f6['ok']){const _0x5c9458=await _0x26d4f6['json']();window[_0x7ac38a(-0xc2,-0x48,-0xcf,-0x51)+'kaotupian']=_0x5c9458[_0x5b4528(0x1be,0x293,0x1b5,0x229)],_0x5cc08b[_0x7ac38a(-0xd7,-0x6d,-0xdb,-0xb9)](addLog,_0x7ac38a(-0x9c,-0xfa,-0xc6,-0xb4)+'器返回数据:\x20'+JSON['stringify'](_0x5c9458)),console['log'](_0x5cc08b[_0x5b4528(0x2d4,0x246,0x2d6,0x291)],_0x5c9458);const _0x8dd655=new FileReader();_0x8dd655['onloadend']=()=>{const _0x297bde=_0x8dd655['result'],_0x4db07e={};function _0x3c39be(_0x35cf24,_0x273e50,_0x436220,_0x356340){return _0x7ac38a(_0x356340,_0x273e50-0xc8,_0x35cf24-0x35f,_0x356340-0xde);}_0x4db07e[_0x21d613(-0x27,-0x96,-0x8e,-0x1a)]=_0x297bde,_0x4db07e[_0x3c39be(0x220,0x279,0x253,0x276)+_0x21d613(-0x3d,0xb,-0xb7,-0x3f)]=_0x5c9458[_0x3c39be(0x28f,0x2c5,0x2a8,0x299)];const _0x257a2f=_0x4db07e,_0x3b7cd1={};function _0x21d613(_0x192748,_0x3d3778,_0x5d4c52,_0x252269){return _0x5b4528(_0x192748-0x7a,_0x192748,_0x5d4c52-0x55,_0x252269- -0x2d6);}_0x3b7cd1['id']=COMFYUI_REF_CACHE_KEY,_0x3b7cd1[_0x3c39be(0x322,0x314,0x381,0x32c)]=_0x257a2f,dbs['storeReadW'+'rite'](_0x3b7cd1);},_0x8dd655[_0x7ac38a(-0x2a,-0x38,-0x5e,-0xe1)+_0x7ac38a(-0x8d,-0x34,-0x6f,0x1d)](_0x31eac4);}else{const _0x4c6d9e=await _0x26d4f6[_0x7ac38a(-0x44,-0xd7,-0x8e,-0xef)]();_0x5cc08b[_0x7ac38a(-0xd1,-0xda,-0x70,-0x3d)](alert,_0x5cc08b['Jitam'](_0x5cc08b['vZDEz'],_0x4c6d9e)),_0x5cc08b[_0x7ac38a(-0x27,-0x15,-0x55,0x2)](addLog,_0x7ac38a(-0x89,-0xc2,-0x60,-0xba)+'详情:\x20'+_0x4c6d9e),console['error'](_0x7ac38a(-0x124,-0x55,-0x98,-0x126),_0x4c6d9e),_0x5cc08b[_0x5b4528(0x311,0x2ca,0x207,0x287)](removeComfyUIImage);}}}catch(_0x540113){_0x5cc08b['TpVLJ'](alert,_0x5cc08b['eRwOM'](_0x5cc08b['KZfZV'],_0x540113[_0x7ac38a(-0x172,-0x17b,-0x12d,-0x1b0)])),console[_0x7ac38a(-0x144,-0x14a,-0xe1,-0xe8)](_0x5cc08b[_0x7ac38a(-0x31,-0x3b,-0x6c,0x1b)],_0x540113),_0x5cc08b[_0x7ac38a(-0xf8,-0xdd,-0x75,-0xb7)](addLog,_0x7ac38a(-0xe,-0x59,-0x60,-0x1e)+'详情:\x20'+JSON[_0x5b4528(0x241,0x2b1,0x294,0x26e)](_0x540113)),removeComfyUIImage();}}async function loadCachedImages(){const _0xdfabbb={'TlhBc':'0|4|2|1|3','BGFVJ':_0x6a7bbc(-0x249,-0x24b,-0x270,-0x2c4),'cujVu':_0x2972c1(-0x261,-0x26c,-0x273,-0x1f3),'taEth':'#comfyui-i'+'mage-previ'+_0x2972c1(-0x1c3,-0x252,-0x1ec,-0x200)+_0x2972c1(-0x2b9,-0x2f6,-0x316,-0x2bd)+_0x2972c1(-0x2f9,-0x2c4,-0x274,-0x287)+_0x6a7bbc(-0x1a3,-0x15e,-0x187,-0x1b3)+'r','gwETx':_0x6a7bbc(-0x227,-0x270,-0x275,-0x19b)+'move-image'+_0x6a7bbc(-0x24b,-0x1c2,-0x281,-0x21c),'NKNbr':_0x6a7bbc(-0x201,-0x28d,-0x1dd,-0x26f),'gtJVF':function(_0x635239,_0x23b815){return _0x635239!==_0x23b815;},'SWHHn':_0x6a7bbc(-0x177,-0x120,-0x15f,-0x1be),'rPXcD':_0x6a7bbc(-0x212,-0x24a,-0x255,-0x1cb)+'x','pOfqd':_0x2972c1(-0x267,-0x2b3,-0x334,-0x2d7)+'3','uRjty':function(_0x29cb52,_0x111d82){return _0x29cb52(_0x111d82);},'pSnFw':_0x2972c1(-0x20f,-0x27a,-0x1c7,-0x212),'SMwtR':'Error\x20load'+_0x6a7bbc(-0x23d,-0x272,-0x26c,-0x26d)+_0x6a7bbc(-0x22e,-0x20a,-0x277,-0x24e)+'ibe\x20image:','IQwVs':_0x2972c1(-0x248,-0x172,-0x16b,-0x1ec),'UtgtQ':'NwcyH','HIufh':function(_0x226410,_0x22ec76){return _0x226410(_0x22ec76);},'JCDyf':_0x2972c1(-0x1ef,-0x238,-0x29e,-0x223)+_0x6a7bbc(-0x23d,-0x1e7,-0x288,-0x2c0)+'\x20NovelAI\x20C'+_0x2972c1(-0x321,-0x2b7,-0x264,-0x2b1)+_0x2972c1(-0x269,-0x23d,-0x29f,-0x2b5),'QHuXh':function(_0x471102,_0x2f9816){return _0x471102!==_0x2f9816;},'YcCFT':_0x2972c1(-0x1dc,-0x2d5,-0x257,-0x251),'Erixy':_0x2972c1(-0x22b,-0x1e5,-0x238,-0x21d),'qqQdQ':_0x6a7bbc(-0x221,-0x20e,-0x224,-0x1cf),'VetDk':function(_0x526da1,_0x151cd4){return _0x526da1(_0x151cd4);},'JJKZs':function(_0x2f7db9,_0x3045d5){return _0x2f7db9===_0x3045d5;},'GhshE':_0x6a7bbc(-0x175,-0x1a1,-0x123,-0x1da),'eZjmX':function(_0x247ac1,_0x41ee0f){return _0x247ac1(_0x41ee0f);},'pEUnt':_0x6a7bbc(-0x1ba,-0x20c,-0x18c,-0x23b)+'ing\x20cached'+_0x6a7bbc(-0x1e6,-0x24a,-0x1a3,-0x26e)+'mage:'};await dbs[_0x2972c1(-0x29c,-0x23c,-0x262,-0x240)]();function _0x6a7bbc(_0xb451e,_0x356a43,_0x135d52,_0x39905e){return _0x591cca(_0x39905e,_0xb451e- -0x126,_0x135d52-0x168,_0x39905e-0x7d);}function _0x2972c1(_0x549474,_0x43638d,_0x4fae53,_0x25afeb){return _0x591cca(_0x549474,_0x25afeb- -0x18f,_0x4fae53-0x13b,_0x25afeb-0x12c);}try{const _0x17fc3b=await dbs[_0x6a7bbc(-0x1e2,-0x18a,-0x165,-0x225)+_0x2972c1(-0x1a3,-0x174,-0x236,-0x1ff)](NAI_VIBE_CACHE_KEY);_0x17fc3b&&_0x17fc3b['data']&&_0xdfabbb[_0x2972c1(-0x2f7,-0x296,-0x20e,-0x28d)](updateNovelaiImagePreview,_0x17fc3b[_0x6a7bbc(-0x17b,-0x11d,-0x153,-0x12e)]);}catch(_0x1294bd){if(_0xdfabbb['pSnFw']!==_0x6a7bbc(-0x237,-0x28b,-0x21a,-0x1b2))console[_0x6a7bbc(-0x21f,-0x2a0,-0x28a,-0x196)](_0xdfabbb[_0x6a7bbc(-0x27f,-0x296,-0x2db,-0x271)],_0x1294bd);else{const _0x3ac312=_0xdfabbb[_0x6a7bbc(-0x191,-0x209,-0x1f2,-0x123)][_0x6a7bbc(-0x1c5,-0x234,-0x16d,-0x1a7)]('|');let _0xc631b2=0x716+0x1*0x1d77+0xc2f*-0x3;while(!![]){switch(_0x3ac312[_0xc631b2++]){case'0':_0x481bb7[_0x6a7bbc(-0x1f1,-0x238,-0x207,-0x23f)]='';continue;case'1':_0x341b04[_0x2972c1(-0x1db,-0x20b,-0x1d4,-0x23e)][_0x2972c1(-0x1a6,-0x1e1,-0x1a7,-0x1dd)]=_0xdfabbb[_0x2972c1(-0x2e2,-0x210,-0x271,-0x25e)];continue;case'2':_0x1e9efc['style']['display']=_0xdfabbb['cujVu'];continue;case'3':_0x3e2572[_0x6a7bbc(-0x186,-0x115,-0x1ea,-0x117)+_0x6a7bbc(-0x1bf,-0x1b6,-0x148,-0x1c1)]=null;continue;case'4':_0x4cf993[_0x6a7bbc(-0x1d5,-0x16d,-0x14d,-0x1cf)]['display']=_0xdfabbb[_0x6a7bbc(-0x1f5,-0x1e8,-0x215,-0x200)];continue;}break;}}}try{const _0x4db318=await dbs[_0x6a7bbc(-0x1e2,-0x161,-0x17d,-0x221)+_0x2972c1(-0x227,-0x1f2,-0x21c,-0x1ff)](NAI_CHAR_REF_CACHE_KEY);_0x4db318&&_0x4db318[_0x6a7bbc(-0x17b,-0x1d4,-0x131,-0x100)]&&(_0xdfabbb[_0x2972c1(-0x244,-0x227,-0x241,-0x218)](_0xdfabbb[_0x2972c1(-0x243,-0x2a5,-0x23a,-0x260)],_0xdfabbb[_0x6a7bbc(-0x1d1,-0x202,-0x1f9,-0x22a)])?_0xdfabbb[_0x6a7bbc(-0x1b6,-0x215,-0x1af,-0x18a)](updateNovelaiCharRefImagePreview,_0x4db318[_0x6a7bbc(-0x17b,-0x191,-0x121,-0x1bf)]):_0x489e86[_0x2972c1(-0x26b,-0x1ff,-0x2e5,-0x288)](_0x6a7bbc(-0x1ba,-0x189,-0x1dd,-0x1ab)+'ing\x20cached'+_0x2972c1(-0x2b4,-0x1cb,-0x233,-0x24f)+_0x6a7bbc(-0x23a,-0x2c5,-0x280,-0x1ba),_0x4f5fa3));}catch(_0x11bc8b){console['error'](_0xdfabbb[_0x2972c1(-0x2ad,-0x1ea,-0x2be,-0x255)],_0x11bc8b);}try{if(_0xdfabbb['QHuXh'](_0xdfabbb[_0x6a7bbc(-0x23f,-0x1e3,-0x223,-0x27e)],_0xdfabbb[_0x2972c1(-0x32d,-0x26d,-0x227,-0x2a8)])){const _0xec98b6=_0x39e4e1[_0x6a7bbc(-0x274,-0x210,-0x280,-0x25f)+_0x6a7bbc(-0x1d3,-0x1df,-0x1cd,-0x1d2)](_0x2972c1(-0x28e,-0x2d7,-0x2d3,-0x2b8)+_0x2972c1(-0x1ba,-0x258,-0x278,-0x245)),_0x13867f=_0x31c8f3[_0x6a7bbc(-0x265,-0x2d0,-0x26a,-0x270)+'tor'](_0xdfabbb[_0x2972c1(-0x286,-0x284,-0x23f,-0x29c)]),_0xec899d=_0x207983[_0x6a7bbc(-0x274,-0x2ad,-0x2a1,-0x277)+'ById'](_0xdfabbb[_0x2972c1(-0x276,-0x326,-0x256,-0x29a)]);_0xec98b6['src']&&_0xec98b6[_0x2972c1(-0x26c,-0x24d,-0x244,-0x25a)][_0x6a7bbc(-0x241,-0x29d,-0x2cb,-0x28f)](_0xdfabbb[_0x2972c1(-0x254,-0x230,-0x22e,-0x221)])&&_0xdfabbb['gtJVF'](_0xec98b6[_0x6a7bbc(-0x1f1,-0x17c,-0x1d8,-0x235)],_0x5a0e0e)&&_0x141030[_0x2972c1(-0x2a6,-0x205,-0x2c4,-0x23b)+'ctURL'](_0xec98b6[_0x6a7bbc(-0x1f1,-0x246,-0x1b9,-0x178)]);if(_0x5efd52)_0xec98b6['src']=_0x16b3de,_0xec98b6[_0x2972c1(-0x208,-0x25b,-0x281,-0x23e)]['display']=_0xdfabbb[_0x6a7bbc(-0x25c,-0x252,-0x25b,-0x1ea)],_0x13867f[_0x2972c1(-0x224,-0x1bc,-0x20f,-0x23e)][_0x2972c1(-0x25d,-0x1a9,-0x224,-0x1dd)]=_0x2972c1(-0x317,-0x232,-0x31d,-0x2b2),_0xec899d[_0x2972c1(-0x1bb,-0x1c5,-0x226,-0x23e)][_0x2972c1(-0x249,-0x1b2,-0x156,-0x1dd)]=_0xdfabbb[_0x2972c1(-0x2f9,-0x20c,-0x28e,-0x28b)];else{const _0x309430=_0xdfabbb[_0x2972c1(-0x35d,-0x317,-0x28c,-0x2f0)]['split']('|');let _0x5c3b8c=0x131+0x1b2b+-0x717*0x4;while(!![]){switch(_0x309430[_0x5c3b8c++]){case'0':_0x4c713e['comfyuican'+_0x6a7bbc(-0x1f6,-0x183,-0x1c5,-0x239)]=null;continue;case'1':_0xec98b6[_0x2972c1(-0x25e,-0x1d1,-0x276,-0x23e)][_0x6a7bbc(-0x174,-0x186,-0x1b5,-0x163)]=_0x2972c1(-0x290,-0x2c8,-0x284,-0x2b2);continue;case'2':_0xec98b6[_0x2972c1(-0x1d0,-0x2b7,-0x1f1,-0x25a)]='';continue;case'3':_0x5010c9=null;continue;case'4':_0x13867f['style']['display']=_0xdfabbb[_0x2972c1(-0x2bf,-0x2a2,-0x245,-0x27f)];continue;case'5':_0xec899d['style']['display']=_0xdfabbb[_0x6a7bbc(-0x1f5,-0x1e2,-0x27b,-0x228)];continue;}break;}}}else{const _0x16adcc=await dbs[_0x2972c1(-0x24e,-0x1dc,-0x1fa,-0x24b)+_0x2972c1(-0x204,-0x24f,-0x17b,-0x1ff)](COMFYUI_REF_CACHE_KEY);if(_0x16adcc&&_0x16adcc[_0x6a7bbc(-0x17b,-0x170,-0x1e3,-0x140)]&&_0x16adcc[_0x2972c1(-0x22b,-0x1e7,-0x272,-0x1e4)][_0x2972c1(-0x190,-0x19f,-0x157,-0x1e4)]&&_0x16adcc[_0x6a7bbc(-0x17b,-0x1cb,-0x175,-0x197)][_0x6a7bbc(-0x27d,-0x203,-0x209,-0x2af)+_0x6a7bbc(-0x1a0,-0x122,-0x1ac,-0x220)]){if(_0xdfabbb[_0x6a7bbc(-0x276,-0x213,-0x2ed,-0x289)]!==_0xdfabbb['qqQdQ']){const _0x49ee88=_0x16adcc['data'],_0x2ab7d1=await _0xdfabbb[_0x2972c1(-0x195,-0x20e,-0x297,-0x21f)](fetch,_0x49ee88[_0x6a7bbc(-0x17b,-0x115,-0x132,-0x1cc)]),_0x2a44c9=await _0x2ab7d1['blob'](),_0x446ead=URL[_0x2972c1(-0x1dd,-0x26e,-0x225,-0x263)+_0x6a7bbc(-0x1a4,-0x1dd,-0x131,-0x175)](_0x2a44c9);updateComfyUIImagePreview(_0x446ead),comfyuiImageObjectURL=_0x446ead,window['comfyuican'+_0x6a7bbc(-0x1f6,-0x1b4,-0x21c,-0x1b7)]=_0x49ee88[_0x6a7bbc(-0x27d,-0x2d4,-0x2f0,-0x1fb)+_0x2972c1(-0x293,-0x1b5,-0x1fc,-0x209)],_0xdfabbb['VetDk'](addLog,_0x6a7bbc(-0x18b,-0x204,-0x157,-0x195)+_0x6a7bbc(-0x1cb,-0x1fe,-0x246,-0x239)+_0x49ee88[_0x2972c1(-0x359,-0x273,-0x29b,-0x2e6)+'Name']),console['log'](_0x6a7bbc(-0x1ab,-0x13f,-0x1e3,-0x219)+_0x2972c1(-0x1e7,-0x1fa,-0x1d4,-0x1f5)+_0x6a7bbc(-0x1d0,-0x1be,-0x1d2,-0x189)+_0x2972c1(-0x247,-0x291,-0x307,-0x2ca)+_0x49ee88['serverFile'+_0x2972c1(-0x1c5,-0x187,-0x1e9,-0x209)]);}else _0x4224e7();}else{if(_0x16adcc&&_0xdfabbb[_0x2972c1(-0x25f,-0x25c,-0x277,-0x227)](typeof _0x16adcc[_0x2972c1(-0x22c,-0x267,-0x1a2,-0x1e4)],_0xdfabbb[_0x6a7bbc(-0x22a,-0x29a,-0x1f7,-0x1a9)])){const _0x554631=await fetch(_0x16adcc[_0x2972c1(-0x22a,-0x1b9,-0x1e3,-0x1e4)]),_0x9d1e29=await _0x554631[_0x2972c1(-0x1f9,-0x239,-0x1fe,-0x215)](),_0x4629f5=URL[_0x6a7bbc(-0x1fa,-0x18f,-0x1c6,-0x1dd)+_0x2972c1(-0x22c,-0x28d,-0x195,-0x20d)](_0x9d1e29);_0xdfabbb['eZjmX'](updateComfyUIImagePreview,_0x4629f5),comfyuiImageObjectURL=_0x4629f5,console['warn'](_0x2972c1(-0x25a,-0x20d,-0x284,-0x214)+'fyUI\x20image'+_0x2972c1(-0x228,-0x2ba,-0x2f8,-0x29e)+_0x2972c1(-0x2cf,-0x2ec,-0x2f8,-0x2c0)+'at.\x20Please'+_0x6a7bbc(-0x27a,-0x2a7,-0x2de,-0x29d)+'\x20to\x20update'+_0x6a7bbc(-0x1c6,-0x200,-0x199,-0x148)+_0x6a7bbc(-0x252,-0x2a3,-0x2a3,-0x1fe)+'rmat.');}}}}catch(_0x20637f){console[_0x2972c1(-0x281,-0x24b,-0x23a,-0x288)](_0xdfabbb[_0x6a7bbc(-0x1dd,-0x239,-0x18f,-0x179)],_0x20637f);}}export function initImageUpload(_0x21ff7c){const _0x5974eb={'ICIeg':_0x310c6b(0x519,0x4a7,0x4b1,0x4fb)+'_novelai','nRUrp':function(_0x2e4b90){return _0x2e4b90();},'GRVqE':function(_0x3b8de9,_0x10f403){return _0x3b8de9(_0x10f403);},'IbHuO':function(_0x690771,_0x429be1){return _0x690771===_0x429be1;},'EaKpn':_0x419187(0x535,0x4e3,0x4be,0x535),'MMFFf':_0x310c6b(0x428,0x44b,0x4c6,0x4b4),'UvAuw':_0x310c6b(0x522,0x501,0x55c,0x4fb)+'2','RoPXV':_0x310c6b(0x4b3,0x486,0x53f,0x4dc)+_0x419187(0x56b,0x580,0x5a0,0x51c)+'e-btn','EpInD':'click','BzNWm':_0x310c6b(0x46a,0x464,0x437,0x43d)+'t_novelai','NtWgx':'change','LsjDt':_0x310c6b(0x4b9,0x4a7,0x4fb,0x481)+_0x419187(0x48b,0x4bb,0x4ec,0x468)+_0x419187(0x523,0x5a7,0x5b1,0x5bd),'NgwiU':_0x419187(0x571,0x61a,0x5a8,0x62a)+_0x419187(0x4bc,0x449,0x4d5,0x539)+_0x310c6b(0x466,0x434,0x3f8,0x458)+_0x419187(0x475,0x480,0x4f6,0x485),'HcjtW':_0x310c6b(0x3db,0x4bc,0x4c3,0x43d)+'t_nai_char'+_0x419187(0x514,0x5a0,0x536,0x57b),'MFBNM':'#novelai-r'+_0x419187(0x50a,0x4f4,0x569,0x5eb)+'-ref-image'+_0x419187(0x55a,0x47c,0x4f6,0x518),'xIRvb':_0x310c6b(0x4dd,0x501,0x462,0x4b2)+_0x310c6b(0x498,0x490,0x487,0x4d4)+_0x310c6b(0x53a,0x4d0,0x480,0x4e5),'cBiuJ':_0x310c6b(0x49a,0x43a,0x3b6,0x43d)+'t2','bYcgK':_0x310c6b(0x557,0x560,0x492,0x4f6)+_0x419187(0x4ab,0x489,0x4ec,0x4bb)+_0x419187(0x5a1,0x550,0x5b1,0x5ae)};loadCachedImages();function _0x419187(_0x3c96e3,_0x264004,_0x9014ac,_0x2d8f35){return _0x47b3ff(_0x9014ac-0x275,_0x264004-0xad,_0x9014ac-0xa6,_0x3c96e3);}_0x21ff7c[_0x310c6b(0x38f,0x3d5,0x3a8,0x41d)](_0x5974eb[_0x310c6b(0x4bb,0x529,0x538,0x4ec)])['on'](_0x5974eb[_0x310c6b(0x4bc,0x4ca,0x500,0x4e7)],()=>{function _0x246f09(_0x1862a0,_0x423aac,_0x4833f5,_0x3167e4){return _0x419187(_0x1862a0,_0x423aac-0x69,_0x3167e4- -0x75,_0x3167e4-0x1b6);}function _0x4e73f5(_0x44ee3c,_0x1651ca,_0x5ddca6,_0x1ed27f){return _0x419187(_0x5ddca6,_0x1651ca-0x128,_0x1ed27f- -0x7aa,_0x1ed27f-0x1e2);}document[_0x246f09(0x46d,0x422,0x40d,0x458)+_0x246f09(0x49b,0x4f1,0x489,0x4f9)](_0x5974eb[_0x4e73f5(-0x16f,-0x167,-0x20a,-0x1d8)])[_0x4e73f5(-0x226,-0x2bb,-0x2b5,-0x298)]();}),_0x21ff7c[_0x310c6b(0x41a,0x45b,0x3f9,0x41d)](_0x5974eb['BzNWm'])['on'](_0x5974eb[_0x419187(0x5a8,0x59f,0x573,0x574)],handleNovelaiImageUpload),_0x21ff7c[_0x310c6b(0x3b0,0x48e,0x496,0x41d)](_0x5974eb['LsjDt'])['on'](_0x5974eb[_0x419187(0x5b7,0x594,0x5b3,0x575)],()=>{function _0x371641(_0x2cf7c1,_0x5d80cd,_0x2e5f8f,_0x359fea){return _0x310c6b(_0x2cf7c1-0x3b,_0x5d80cd-0x14a,_0x5d80cd,_0x2e5f8f- -0x27b);}_0x5974eb[_0x371641(0x1d1,0x1ac,0x1a7,0x22d)](removeNovelaiImage);});function _0x310c6b(_0x12461e,_0x2d2f14,_0x2b0e95,_0x493ca6){return _0x47b3ff(_0x493ca6-0x1a9,_0x2d2f14-0x1af,_0x2b0e95-0x1cc,_0x2b0e95);}_0x21ff7c[_0x419187(0x479,0x496,0x4e9,0x56b)](_0x5974eb[_0x419187(0x50f,0x51d,0x557,0x51f)])['on'](_0x5974eb[_0x419187(0x565,0x60a,0x5b3,0x613)],()=>{function _0x465253(_0xffe1c4,_0x37b5d0,_0x32853d,_0x2ab7be){return _0x310c6b(_0xffe1c4-0x1a1,_0x37b5d0-0x1ad,_0xffe1c4,_0x37b5d0- -0x2a3);}function _0x1787ef(_0x4d6c38,_0x450750,_0x53e928,_0x5ca46b){return _0x419187(_0x450750,_0x450750-0x1cc,_0x4d6c38- -0x3a7,_0x5ca46b-0xfb);}document[_0x1787ef(0x126,0x149,0xc5,0x162)+'ById']('imageInput'+_0x1787ef(0x17e,0x11c,0x1d7,0x1bb)+_0x1787ef(0x1d2,0x1f5,0x23c,0x215))[_0x465253(0x202,0x1a3,0x179,0x176)]();}),_0x21ff7c[_0x419187(0x539,0x4a5,0x4e9,0x4eb)](_0x5974eb['HcjtW'])['on'](_0x5974eb[_0x419187(0x50f,0x582,0x573,0x5d6)],handleNovelaiCharRefImageUpload),_0x21ff7c[_0x419187(0x56e,0x549,0x4e9,0x4c0)](_0x5974eb[_0x419187(0x596,0x58d,0x563,0x521)])['on'](_0x419187(0x4c2,0x4f7,0x512,0x57f),()=>{function _0x9ca939(_0x4d8cb9,_0x2341c1,_0x559f46,_0x35c607){return _0x419187(_0x4d8cb9,_0x2341c1-0xac,_0x2341c1- -0x5db,_0x35c607-0x80);}_0x5974eb[_0x9ca939(-0x77,-0xed,-0xa8,-0x123)](removeNovelaiCharRefImage);}),_0x21ff7c[_0x419187(0x53d,0x499,0x4e9,0x52b)](_0x5974eb[_0x419187(0x508,0x43c,0x4c8,0x45d)])['on'](_0x5974eb[_0x419187(0x63b,0x558,0x5b3,0x5d4)],()=>{function _0x2f7111(_0x11afb8,_0x2aaa73,_0x2f1ba4,_0x37a169){return _0x419187(_0x2f1ba4,_0x2aaa73-0x2f,_0x11afb8- -0x54e,_0x37a169-0x53);}function _0x4ebdc1(_0x721a46,_0x1735d2,_0x50011e,_0x3887b9){return _0x419187(_0x1735d2,_0x1735d2-0x17b,_0x721a46- -0x10a,_0x3887b9-0x112);}_0x5974eb[_0x4ebdc1(0x48f,0x47f,0x478,0x49e)](_0x5974eb[_0x4ebdc1(0x4b0,0x46e,0x466,0x439)],_0x5974eb['MMFFf'])?_0x5974eb['GRVqE'](_0x3593f6,_0x3da547[_0x4ebdc1(0x4bc,0x4e9,0x533,0x4cb)]):document['getElement'+_0x2f7111(0x20,-0x8,-0x66,-0x49)](_0x5974eb[_0x4ebdc1(0x46d,0x48f,0x423,0x481)])[_0x2f7111(-0x3c,0x2,0x19,-0x11)]();}),_0x21ff7c[_0x419187(0x491,0x53f,0x4e9,0x487)](_0x5974eb[_0x310c6b(0x534,0x504,0x481,0x4a8)])['on'](_0x5974eb[_0x419187(0x569,0x5f9,0x573,0x55d)],handleImageUpload2),_0x21ff7c['find'](_0x5974eb[_0x419187(0x57c,0x60e,0x58a,0x597)])['on'](_0x5974eb[_0x310c6b(0x52e,0x4f5,0x48e,0x4e7)],()=>{removeComfyUIImage();});}function _0x47b3ff(_0x49d082,_0x363a33,_0x4180ba,_0x284e77){return _0x54c7(_0x49d082-0x155,_0x284e77);}export{updateNovelaiImagePreview,updateNovelaiCharRefImagePreview,updateComfyUIImagePreview,nai3VibeTransferImageMimeType,nai3CharRefImageMimeType,comfyuiImageObjectURL};