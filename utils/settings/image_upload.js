(function(_0x5f96eb,_0x3adc17){function _0x2a2e0c(_0x51ac68,_0x7e8b8b,_0xd49062,_0x5bc80d){return _0x548c(_0xd49062- -0x2ec,_0x51ac68);}function _0x1490f6(_0x31b63c,_0x1c4060,_0x3b4046,_0x4a434f){return _0x548c(_0x31b63c- -0x2ea,_0x3b4046);}const _0x3a6414=_0x5f96eb();while(!![]){try{const _0x333473=parseInt(_0x1490f6(-0xbc,-0x117,-0x3b,-0x118))/(0x1056+-0x2*-0xe+-0x1071)*(-parseInt(_0x1490f6(-0x6a,-0xb9,-0x8b,-0x7e))/(-0x1331+-0x1a8f*-0x1+-0x75c))+parseInt(_0x1490f6(-0x58,-0x8a,0x2f,-0x5a))/(-0x1*-0x371+0x1*-0x128d+0xf1f)+parseInt(_0x2a2e0c(0x5e,-0x30,-0x2e,-0xc))/(0x3*0x85d+-0x1*0x10db+-0x838)*(parseInt(_0x1490f6(-0xe8,-0xc6,-0xb7,-0x103))/(-0x8c9+0x1ef6+0x8*-0x2c5))+parseInt(_0x1490f6(-0xa4,-0xf4,-0x2c,-0xab))/(0x1*0x18d9+0x252e+-0x8f*0x6f)*(parseInt(_0x1490f6(-0xd,-0x3f,-0x22,0x17))/(0x20fb+-0x1577+0xb7d*-0x1))+parseInt(_0x1490f6(-0x9f,-0x26,-0x102,-0xab))/(0x2*0xfd+-0x3*-0xdd+-0x489)*(-parseInt(_0x2a2e0c(-0x98,-0x16a,-0xf4,-0x15f))/(0xee9+-0x11*-0x1a+0x5*-0x352))+parseInt(_0x2a2e0c(-0xbb,-0xf8,-0xa4,-0x86))/(0x649*0x2+0x234*-0x9+0x74c)*(-parseInt(_0x2a2e0c(0x35,-0x4b,-0x1c,0x6c))/(-0xbbe+-0xebb+0xd42*0x2))+-parseInt(_0x1490f6(-0xba,-0x4a,-0x93,-0x90))/(-0xc81+-0x1075+0x5e*0x4f)*(-parseInt(_0x2a2e0c(-0x54,0x91,0x14,0x5e))/(0x23cd+-0xe1b+-0x15a5));if(_0x333473===_0x3adc17)break;else _0x3a6414['push'](_0x3a6414['shift']());}catch(_0x3ee908){_0x3a6414['push'](_0x3a6414['shift']());}}}(_0x3515,0x2ff*-0x17f+-0x1*-0x6f497+0x1419b));const _0x37e71e=(function(){let _0x1cc62c=!![];return function(_0x2568e9,_0x594698){const _0x3bab65=_0x1cc62c?function(){function _0x415a4d(_0x7f3415,_0x2dfe7e,_0x4c033e,_0x256ebb){return _0x548c(_0x256ebb-0x2dd,_0x4c033e);}if(_0x594698){const _0x2f8442=_0x594698[_0x415a4d(0x650,0x5d7,0x5e5,0x5e7)](_0x2568e9,arguments);return _0x594698=null,_0x2f8442;}}:function(){};return _0x1cc62c=![],_0x3bab65;};}()),_0x35eab8=_0x37e71e(this,function(){const _0x50f427={};_0x50f427[_0x5df1d2(-0x9b,-0x119,-0x170,-0x194)]='(((.+)+)+)'+'+$';const _0x56fc9e=_0x50f427;function _0x1a6a29(_0x548cd8,_0x45e179,_0x24a61f,_0x463273){return _0x548c(_0x45e179-0x230,_0x548cd8);}function _0x5df1d2(_0x34abec,_0x938bca,_0x2aa9ff,_0x54d96e){return _0x548c(_0x938bca- -0x3bb,_0x2aa9ff);}return _0x35eab8[_0x5df1d2(-0xf0,-0x15e,-0x120,-0x19b)]()['search'](_0x56fc9e[_0x1a6a29(0x50f,0x4d2,0x4a8,0x4c2)])[_0x1a6a29(0x4a5,0x48d,0x4ce,0x43a)]()[_0x1a6a29(0x4c3,0x482,0x4ae,0x4a2)+'r'](_0x35eab8)[_0x5df1d2(-0x1d8,-0x1ae,-0x139,-0x1be)](_0x56fc9e[_0x5df1d2(-0x19b,-0x119,-0x92,-0xe8)]);});_0x35eab8();import{extension_settings}from'../../../../../extensions.js';import{saveSettingsDebounced}from'../../../../../../script.js';function _0x2bd780(_0x3c64c3,_0x3861bc,_0x20472c,_0x112dac){return _0x548c(_0x112dac- -0x166,_0x3c64c3);}import{extensionName}from'../config.js';import{processUploadedImage,processUploadedImageToBlob,addLog}from'../utils.js';import{dbs}from'../database.js';const NAI_VIBE_CACHE_KEY='cache_nove'+_0x59b12a(0x74,0x3d,-0x48,0x2f)+_0x2bd780(0x2a,0x32,0x31,0xa8)+_0x59b12a(0xb5,0x27,0x1e,0x4c),NAI_CHAR_REF_CACHE_KEY=_0x2bd780(0x122,0x7d,0x68,0xcc)+_0x59b12a(-0x3f,0x9d,-0x2e,0x14)+_0x59b12a(-0x9a,-0x4,-0x61,-0x54),COMFYUI_REF_CACHE_KEY=_0x59b12a(0xe,-0x3a,0x44,0x8)+_0x2bd780(0x37,0x4e,0x9d,0x93)+_0x2bd780(0x177,0x17a,0x156,0x183);let nai3VibeTransferImageMimeType=_0x59b12a(0x21,-0x59,0x41,-0x23),nai3CharRefImageMimeType=_0x59b12a(-0x56,-0x1,-0x37,-0x23),comfyuiImageObjectURL=null;function _0x59b12a(_0x4a0c0d,_0x3706d9,_0x13f101,_0x21056e){return _0x548c(_0x21056e- -0x29d,_0x4a0c0d);}function updateNovelaiImagePreview(_0x1ecff9){const _0x52505c={};_0x52505c[_0x16dafa(0x154,0x12f,0x127,0xe0)]=_0x16dafa(0x132,0x163,0x12b,0xd8)+_0x4fd532(0x5c0,0x60b,0x5b1,0x545)+_0x4fd532(0x5d2,0x5ed,0x605,0x5ac),_0x52505c['ghalo']=_0x4fd532(0x559,0x553,0x515,0x59c)+_0x4fd532(0x65a,0x57f,0x5e2,0x64b)+_0x4fd532(0x5cd,0x530,0x569,0x563)+_0x4fd532(0x4e6,0x4f5,0x509,0x57f)+_0x4fd532(0x62a,0x5db,0x5a5,0x5c5)+_0x16dafa(0xb6,0x7d,0x8f,0xf1)+_0x16dafa(0xf0,0x139,0xee,0xef),_0x52505c['uzDUa']=_0x4fd532(0x61c,0x621,0x5b3,0x5ed)+_0x4fd532(0x575,0x5a7,0x56c,0x57f)+_0x16dafa(0x4e,0xa9,0xcc,0x81)+'btn',_0x52505c[_0x4fd532(0x654,0x5b1,0x5d5,0x5bb)]=_0x4fd532(0x61b,0x652,0x5ec,0x5a9),_0x52505c[_0x16dafa(0xab,0x115,0x28,0xaf)]=_0x4fd532(0x5f8,0x68b,0x606,0x68e);function _0x4fd532(_0x139cef,_0x578371,_0xe45b38,_0x1301c1){return _0x59b12a(_0x578371,_0x578371-0x166,_0xe45b38-0x1ed,_0xe45b38-0x59b);}_0x52505c[_0x4fd532(0x5a4,0x50f,0x579,0x561)]=_0x4fd532(0x5a6,0x5f8,0x583,0x60d),_0x52505c[_0x4fd532(0x62a,0x52f,0x5b2,0x5d3)]=_0x16dafa(0xea,0x16c,0x5e,0xe4)+'x',_0x52505c[_0x4fd532(0x5c5,0x4f4,0x54e,0x54c)]=_0x16dafa(0x174,0x94,0x84,0xf8);function _0x16dafa(_0x3dd996,_0x513d6c,_0x572b92,_0x229814){return _0x2bd780(_0x572b92,_0x513d6c-0x11c,_0x572b92-0x3c,_0x229814- -0x7c);}_0x52505c['XVWjd']=_0x16dafa(0x102,0x74,0xcb,0xd9),_0x52505c[_0x16dafa(0x126,0xc7,0x140,0x118)]=_0x4fd532(0x5ae,0x566,0x536,0x597)+_0x4fd532(0x518,0x5d4,0x595,0x512)+_0x16dafa(0x6f,0x79,0xe0,0x5f)+_0x4fd532(0x5ab,0x5a3,0x56b,0x597)+'tu8-image-'+_0x4fd532(0x5ec,0x62f,0x5d6,0x602)+'r',_0x52505c[_0x16dafa(0xa0,0x19,0x3a,0x21)]=function(_0x3ba3ea,_0xdb81e7){return _0x3ba3ea===_0xdb81e7;},_0x52505c[_0x16dafa(0x14e,0x12e,0x7f,0xdb)]=_0x4fd532(0x58c,0x61b,0x5a1,0x594),_0x52505c[_0x16dafa(0xa9,0x76,0xf3,0xdd)]=_0x4fd532(0x4a1,0x56c,0x50f,0x4d5);const _0x2f8ddc=_0x52505c,_0x2a21a6=document['getElement'+_0x16dafa(0xe8,0x172,0xec,0x122)]('previewIma'+_0x16dafa(0xd,0x86,0x5a,0x40)),_0x1f9843=document[_0x4fd532(0x525,0x5e3,0x593,0x5e4)+_0x16dafa(0x36,0x52,0xe4,0x72)](_0x2f8ddc[_0x16dafa(0x15b,0x9b,0x18f,0x118)]),_0xea5e4=document['getElement'+_0x16dafa(0xcc,0x174,0x107,0x122)](_0x16dafa(0x70,0x57,0x9e,0xd3)+'move-image'+'-btn');if(_0x1ecff9&&_0x1ecff9[_0x16dafa(0x7a,-0x3,0x41,0x27)](_0x16dafa(0x142,0x15c,0xe4,0x10c))){_0x2a21a6[_0x4fd532(0x62e,0x64f,0x5f0,0x5f1)]=_0x1ecff9,_0x2a21a6[_0x4fd532(0x529,0x4e8,0x53e,0x58d)][_0x4fd532(0x55d,0x5ab,0x531,0x52e)]=_0x2f8ddc[_0x4fd532(0x56c,0x5fe,0x58f,0x53b)],_0x1f9843[_0x4fd532(0x56e,0x563,0x53e,0x4c5)][_0x16dafa(0x44,0x56,0x64,0x51)]=_0x2f8ddc[_0x16dafa(0x99,0xe2,0xe0,0x99)],_0xea5e4[_0x4fd532(0x5b6,0x5b7,0x53e,0x598)][_0x16dafa(0x93,0x8b,0x6a,0x51)]=_0x2f8ddc[_0x4fd532(0x566,0x57e,0x5b2,0x538)];const _0x29ef1f=_0x1ecff9[_0x4fd532(0x501,0x557,0x504,0x571)](','),_0xc4aa2f=_0x29ef1f[-0x1efd*0x1+-0x1b+0xa*0x31c][_0x4fd532(0x517,0x536,0x504,0x49e)](':')[0x223a*0x1+-0x9a1+-0x1898][_0x16dafa(0x15,-0x49,-0x4a,0x24)](';')[0x15c3+-0x11*0x203+0xc70];nai3VibeTransferImageMimeType=_0xc4aa2f,window[_0x4fd532(0x62c,0x5be,0x5ad,0x625)+_0x4fd532(0x5ca,0x5b3,0x55e,0x554)+'e']=_0x29ef1f[-0xd3*0x29+0x63c+0x1b90];const _0x2c41cc={};_0x2c41cc['id']=NAI_VIBE_CACHE_KEY,_0x2c41cc[_0x16dafa(0xee,0x155,0x50,0xc9)]=_0x1ecff9,dbs[_0x4fd532(0x50d,0x586,0x543,0x4f6)+_0x16dafa(0x9b,0x13a,0x8b,0xf3)](_0x2c41cc);}else{if(_0x2f8ddc[_0x4fd532(0x57a,0x57c,0x501,0x4ab)]('IwcVR',_0x2f8ddc['qzxZh'])){const _0x2c7b43=_0x2f8ddc['fZTfC']['split']('|');let _0x51c809=0x7be*-0x5+-0x1*0x1d99+-0x1d*-0x25b;while(!![]){switch(_0x2c7b43[_0x51c809++]){case'0':_0x2a21a6[_0x16dafa(0xfe,0xae,0x19c,0x110)]='';continue;case'1':_0x1f9843['style'][_0x16dafa(0x67,0x27,0xa2,0x51)]=_0x2f8ddc['XVWjd'];continue;case'2':window[_0x4fd532(0x612,0x55d,0x5ad,0x608)+_0x16dafa(0xd7,0x4d,0x90,0x7e)+'e']=null;continue;case'3':_0xea5e4[_0x4fd532(0x5b8,0x4ba,0x53e,0x4d5)][_0x16dafa(0xc4,0x40,0xb8,0x51)]=_0x2f8ddc[_0x16dafa(0xf2,0xac,0x81,0x99)];continue;case'4':_0x2a21a6[_0x4fd532(0x50f,0x5c4,0x53e,0x4d2)][_0x16dafa(0x9a,0xb3,0x81,0x51)]=_0x2f8ddc[_0x16dafa(0xc2,0x69,0x10b,0x99)];continue;}break;}}else{const _0x3b6bb8=_0x14b0c8['getElement'+'ById'](_0x2f8ddc[_0x16dafa(0x65,0x128,0x10c,0xe0)]),_0x222a31=_0x4975f4[_0x4fd532(0x605,0x596,0x593,0x5d3)+_0x4fd532(0x524,0x508,0x552,0x4f6)](_0x2f8ddc[_0x16dafa(0x45,0x2b,-0x64,0x1b)]),_0x1d169d=_0x590056['getElement'+_0x4fd532(0x59c,0x5e7,0x602,0x652)](_0x2f8ddc['uzDUa']);if(_0x2d6649&&_0x1e5707['startsWith'](_0x2f8ddc[_0x16dafa(0xc9,0xca,0x84,0xf5)])){_0x3b6bb8['src']=_0x4ec5ec,_0x3b6bb8['style'][_0x4fd532(0x58d,0x4e9,0x531,0x50c)]=_0x2f8ddc[_0x4fd532(0x5ff,0x553,0x58f,0x513)],_0x222a31[_0x16dafa(0x8e,0x1b,0xa0,0x5e)][_0x4fd532(0x4ce,0x530,0x531,0x575)]=_0x2f8ddc[_0x4fd532(0x5ec,0x559,0x579,0x5a9)],_0x1d169d['style'][_0x4fd532(0x5a6,0x4a5,0x531,0x5a8)]=_0x2f8ddc[_0x4fd532(0x55d,0x557,0x5b2,0x5d9)];const _0x3b4c2d=_0x356cdb[_0x16dafa(0xa8,-0x3d,-0x38,0x24)](','),_0x7efc5c=_0x3b4c2d[-0x4ea*-0x7+0x131a+0xd60*-0x4][_0x16dafa(0x2b,0x57,-0x22,0x24)](':')[0x106f+0x222f+-0x329d][_0x16dafa(0x50,0x50,0x40,0x24)](';')[-0x1a83+-0x2*0xb5f+0x3141*0x1];_0x50862f=_0x7efc5c,_0x216279[_0x16dafa(0x157,0x14f,0x12c,0xf4)+_0x4fd532(0x5f6,0x5e4,0x577,0x512)]=_0x3b4c2d[0x20ef+0x1ef1+-0x1*0x3fdf];const _0x367278={};_0x367278['id']=_0x1ed5b4,_0x367278[_0x16dafa(0x55,0xd7,0x8a,0xc9)]=_0x1d91bb,_0x10860c[_0x16dafa(0x6a,0x27,0x1,0x63)+_0x16dafa(0xd8,0x130,0xc8,0xf3)](_0x367278);}else{const _0x1f81d1=_0x2f8ddc[_0x16dafa(0x81,0xc5,0xc0,0x6e)][_0x4fd532(0x4b0,0x58b,0x504,0x4e3)]('|');let _0x483524=-0xa0*0xe+-0x1335+0x1a5*0x11;while(!![]){switch(_0x1f81d1[_0x483524++]){case'0':_0x222a31[_0x16dafa(0x6d,0x95,-0x7,0x5e)][_0x16dafa(0xc4,-0x1,0x87,0x51)]=_0x2f8ddc[_0x16dafa(0x72,-0x4f,0x9f,0x34)];continue;case'1':_0x4cf9de[_0x16dafa(0xf0,0xe0,0x153,0xf4)+'fImage']=null;continue;case'2':_0x1d169d[_0x4fd532(0x4b4,0x4dd,0x53e,0x58a)][_0x4fd532(0x50c,0x55f,0x531,0x51d)]=_0x16dafa(0xce,0xa5,0x6b,0xa3);continue;case'3':_0x3b6bb8[_0x16dafa(0xa5,0x42,0xba,0x5e)][_0x16dafa(0x5d,-0x2b,-0x38,0x51)]=_0x2f8ddc[_0x4fd532(0x4f4,0x59b,0x579,0x549)];continue;case'4':_0x3b6bb8[_0x16dafa(0x14b,0x125,0x137,0x110)]='';continue;}break;}}}}}function removeNovelaiImage(){function _0x26357e(_0x264f90,_0xfb04a1,_0x1902f7,_0x1ce102){return _0x2bd780(_0x264f90,_0xfb04a1-0xfd,_0x1902f7-0xf5,_0xfb04a1-0x198);}const _0x53da3e={'gOFVA':function(_0x2c1628,_0x34862d){return _0x2c1628(_0x34862d);}};_0x53da3e['gOFVA'](updateNovelaiImagePreview,null),dbs[_0x26357e(0x1d9,0x233,0x25c,0x1fb)+'e'](NAI_VIBE_CACHE_KEY);}async function handleNovelaiImageUpload(_0x24a1f9){const _0x892377={'NcBSk':_0x51d69d(0x5a0,0x5f2,0x5a0,0x55b)+'2','ruJAv':function(_0x31dd82,_0x51fcf1){return _0x31dd82===_0x51fcf1;},'NWswp':_0x89977c(0x270,0x217,0x255,0x20a),'OvUhr':function(_0x273910,_0x293b68,_0xb5fc2c){return _0x273910(_0x293b68,_0xb5fc2c);},'XbSme':_0x51d69d(0x568,0x539,0x529,0x4e3)+_0x89977c(0x24c,0x26f,0x204,0x18e)+'elAI\x20image'+':','upOXi':function(_0x4dfbf2,_0xe544ed){return _0x4dfbf2(_0xe544ed);},'zRpcd':function(_0x98a4c4,_0x44c6ce){return _0x98a4c4+_0x44c6ce;},'qsfkB':_0x51d69d(0x50c,0x4f9,0x505,0x4ce)};function _0x51d69d(_0x4ad764,_0x53b38a,_0x907446,_0x384b1f){return _0x59b12a(_0x384b1f,_0x53b38a-0x13c,_0x907446-0xa0,_0x4ad764-0x553);}const _0x23f3dd=_0x24a1f9[_0x89977c(0x212,0x23e,0x1fb,0x245)][_0x51d69d(0x57d,0x52c,0x554,0x5d5)][0xce*-0x29+0x4*-0x847+0x1*0x421a];function _0x89977c(_0x43712d,_0x3fa80f,_0x3d127a,_0x1eb882){return _0x2bd780(_0x3fa80f,_0x3fa80f-0xfd,_0x3d127a-0x46,_0x3d127a-0x105);}if(!_0x23f3dd)return;try{if(_0x892377[_0x51d69d(0x537,0x5ad,0x599,0x4ee)](_0x892377[_0x89977c(0x151,0x195,0x1c6,0x243)],_0x892377[_0x89977c(0x1c7,0x18a,0x1c6,0x1f3)])){const _0x180759=await _0x892377[_0x89977c(0x20d,0x19f,0x199,0x195)](processUploadedImage,_0x23f3dd,!![]);updateNovelaiImagePreview(_0x180759);}else _0x3f45a9[_0x51d69d(0x5af,0x595,0x620,0x5d4)+_0x51d69d(0x5ba,0x599,0x540,0x605)](_0x892377[_0x89977c(0x21a,0x216,0x1f8,0x219)])[_0x89977c(0x24a,0x1a4,0x1d8,0x198)]();}catch(_0x3114a1){console[_0x51d69d(0x509,0x540,0x4d9,0x52a)](_0x892377[_0x89977c(0x1fc,0x19c,0x1ca,0x150)],_0x3114a1),_0x892377[_0x51d69d(0x517,0x51e,0x4d3,0x524)](alert,_0x892377[_0x51d69d(0x5b1,0x534,0x60a,0x62e)](_0x892377[_0x51d69d(0x53a,0x4df,0x511,0x5b1)],_0x3114a1[_0x51d69d(0x57e,0x5b4,0x5ee,0x5ce)]));}}function _0x548c(_0x4975f4,_0x590056){_0x4975f4=_0x4975f4-(0x4d2+0x1*0xaab+0x13b*-0xb);const _0x2d6649=_0x3515();let _0x1e5707=_0x2d6649[_0x4975f4];if(_0x548c['KfqGCF']===undefined){var _0x3887ae=function(_0x48facf){const _0x5118cf='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x1411f6='',_0x3c59c3='',_0x4ec5ec=_0x1411f6+_0x3887ae;for(let _0x356cdb=0x121*0x4+0x1*-0x1670+0x1f*0x94,_0x50862f,_0x216279,_0x10860c=0x1e59+-0x25*-0xfd+-0x1*0x42ea;_0x216279=_0x48facf['charAt'](_0x10860c++);~_0x216279&&(_0x50862f=_0x356cdb%(-0x7a+0x25e4+-0x2566)?_0x50862f*(-0x1f*-0xc5+0x1fda+-0x1*0x3775)+_0x216279:_0x216279,_0x356cdb++%(0x1*0xa2a+0x29*-0x9e+-0x3ca*-0x4))?_0x1411f6+=_0x4ec5ec['charCodeAt'](_0x10860c+(0x56e*0x5+-0x165a+0x6*-0xcb))-(0x11c4*0x2+-0x9f9+-0x1985)!==-0x1*-0x154d+-0x2491+0xf44?String['fromCharCode'](-0x2d3*0x1+-0xa43*-0x2+-0x85a*0x2&_0x50862f>>(-(0x281*0xd+-0x23f9*0x1+0x36e)*_0x356cdb&0x81e+-0x1d3*-0xe+-0x21a2*0x1)):_0x356cdb:-0x119*0xe+0x416+0xb48){_0x216279=_0x5118cf['indexOf'](_0x216279);}for(let _0x1ed5b4=0x16e8+0x3a2+0x4f*-0x56,_0x1d91bb=_0x1411f6['length'];_0x1ed5b4<_0x1d91bb;_0x1ed5b4++){_0x3c59c3+='%'+('00'+_0x1411f6['charCodeAt'](_0x1ed5b4)['toString'](-0x1061+-0x18a0+0x2911))['slice'](-(-0x26b9+0x16*-0x52+0x1*0x2dc7));}return decodeURIComponent(_0x3c59c3);};_0x548c['gxClna']=_0x3887ae,_0x548c['ILloxE']={},_0x548c['KfqGCF']=!![];}const _0x2265e4=_0x2d6649[0x27*0xac+-0x25c1+0x1*0xb8d],_0x1d36a1=_0x4975f4+_0x2265e4,_0x4bafb7=_0x548c['ILloxE'][_0x1d36a1];if(!_0x4bafb7){const _0x4cf9de=function(_0x1d7ed7){this['RigNTh']=_0x1d7ed7,this['apJvkJ']=[0x31*-0xa+-0x25ad+-0x5a8*-0x7,0x489*-0x2+-0xc36+0x1548,-0x52f*-0x2+-0x1312+0x4*0x22d],this['evGetb']=function(){return'newState';},this['lUqEiX']='\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*',this['ZBqoXY']='[\x27|\x22].+[\x27|\x22];?\x20*}';};_0x4cf9de['prototype']['Lkvytd']=function(){const _0x1d878b=new RegExp(this['lUqEiX']+this['ZBqoXY']),_0xb841b0=_0x1d878b['test'](this['evGetb']['toString']())?--this['apJvkJ'][0x17f*0xd+0x11cd+-0x253f]:--this['apJvkJ'][0x4e*-0x22+-0x1bd9+0x2635];return this['HWHDtp'](_0xb841b0);},_0x4cf9de['prototype']['HWHDtp']=function(_0x394129){if(!Boolean(~_0x394129))return _0x394129;return this['FxGBoF'](this['RigNTh']);},_0x4cf9de['prototype']['FxGBoF']=function(_0xf6ec67){for(let _0x4503bc=-0x18f3+-0x5*0x463+0x2*0x1771,_0x42b30e=this['apJvkJ']['length'];_0x4503bc<_0x42b30e;_0x4503bc++){this['apJvkJ']['push'](Math['round'](Math['random']())),_0x42b30e=this['apJvkJ']['length'];}return _0xf6ec67(this['apJvkJ'][-0x723+0x1b88+-0x1465]);},new _0x4cf9de(_0x548c)['Lkvytd'](),_0x1e5707=_0x548c['gxClna'](_0x1e5707),_0x548c['ILloxE'][_0x1d36a1]=_0x1e5707;}else _0x1e5707=_0x4bafb7;return _0x1e5707;}function updateNovelaiCharRefImagePreview(_0x1837fa){function _0x1e12a2(_0x4dcb92,_0x3ad47f,_0x201ecb,_0x506da1){return _0x2bd780(_0x201ecb,_0x3ad47f-0x175,_0x201ecb-0x19b,_0x506da1- -0x55);}function _0x4a97ea(_0x9223f7,_0x52d0af,_0x4e9632,_0x53a98f){return _0x59b12a(_0x53a98f,_0x52d0af-0xf,_0x4e9632-0x138,_0x9223f7-0x13c);}const _0x1c93c8={'JlfXf':'请先设置ComfyU'+_0x1e12a2(0xd5,0xed,0x57,0xce),'DZElJ':function(_0x36d8bb){return _0x36d8bb();},'thqcY':_0x4a97ea(0x159,0x162,0x12d,0x119)+_0x1e12a2(0x127,0x11b,0xb3,0xf8)+'r_ref','QLssG':'#novelai-c'+_0x1e12a2(0xe7,0x1b2,0xbb,0x129)+'age-previe'+_0x4a97ea(0xaa,0xe0,0x3f,0x117)+_0x1e12a2(0x14b,0xcc,0xdc,0xec)+'u8-image-p'+'laceholder','cywWf':_0x4a97ea(0x154,0x15d,0x112,0x186)+_0x4a97ea(0x10d,0xb5,0x168,0xdf)+'ref-image-'+_0x4a97ea(0xa3,0xb4,0xfc,0x8c),'PENmx':function(_0x12a4a9,_0xa9275d){return _0x12a4a9!==_0xa9275d;},'AdnSK':_0x4a97ea(0x143,0x173,0x120,0x1c5),'ZSYJb':_0x1e12a2(0x1c4,0x149,0x178,0x14d),'UFERR':_0x4a97ea(0x165,0x136,0x173,0x166)+'x','MxPGp':_0x4a97ea(0x145,0x10c,0x19f,0x113),'Yuzpf':_0x1e12a2(0x42,0x137,0x11c,0xca)},_0x55e3ea=document[_0x1e12a2(0xff,0x1c8,0xb5,0x13e)+_0x1e12a2(0x1b6,0x197,0x14b,0x149)](_0x1c93c8[_0x4a97ea(0x139,0x192,0x1a2,0xe8)]),_0x39a4fd=document[_0x4a97ea(0x134,0x19a,0x181,0xdc)+'tor'](_0x1c93c8['QLssG']),_0x33e181=document[_0x1e12a2(0x12b,0x126,0x1c6,0x13e)+'ById'](_0x1c93c8['cywWf']);if(_0x1837fa&&_0x1837fa[_0x1e12a2(0x4,0x64,0x65,0x4e)](_0x4a97ea(0x18d,0x125,0x1af,0x12f))){if(_0x1c93c8[_0x4a97ea(0x109,0x136,0xaa,0x169)](_0x1c93c8[_0x1e12a2(0x159,0x12f,0xb8,0xf1)],_0x1c93c8[_0x1e12a2(0x10a,0xdf,0x13f,0xf1)])){_0x505191(_0x1c93c8[_0x4a97ea(0x13e,0x126,0xbc,0xfd)]),_0x1c93c8[_0x1e12a2(0x197,0x127,0x16d,0x124)](_0x3cd393);return;}else{_0x55e3ea[_0x1e12a2(0x125,0x133,0x11c,0x137)]=_0x1837fa,_0x55e3ea[_0x4a97ea(0xdf,0x12a,0x102,0x112)][_0x4a97ea(0xd2,0x50,0x106,0x8b)]=_0x1c93c8[_0x4a97ea(0xa7,0xf1,0x12b,0x87)],_0x39a4fd[_0x1e12a2(0x6b,0x1b,0xf2,0x85)][_0x4a97ea(0xd2,0x113,0x15a,0x49)]=_0x1e12a2(0xf0,0x51,0x97,0xca),_0x33e181[_0x4a97ea(0xdf,0x9d,0x127,0x12c)]['display']=_0x1c93c8['UFERR'];const _0x9bba99=_0x1837fa[_0x4a97ea(0xa5,0x46,0x76,0x5b)](','),_0x527fb1=_0x9bba99[0x154d+0x1fe9+0x2*-0x1a9b][_0x1e12a2(0xb1,0x67,0x3,0x4b)](':')[-0x1023+0x1b8b+0x1*-0xb67][_0x1e12a2(-0x3a,0x83,-0x30,0x4b)](';')[-0x1723+-0x390+0x1ab3];nai3CharRefImageMimeType=_0x527fb1,window[_0x4a97ea(0x175,0x136,0x1de,0x198)+_0x1e12a2(0xcb,0xf2,0x80,0xbe)]=_0x9bba99[-0x2405+0x1*-0x1229+-0x1*-0x362f];const _0x4bc7c6={};_0x4bc7c6['id']=NAI_CHAR_REF_CACHE_KEY,_0x4bc7c6[_0x4a97ea(0x14a,0x12f,0x180,0x1a3)]=_0x1837fa,dbs[_0x1e12a2(0x106,0xa6,0x1e,0x8a)+'rite'](_0x4bc7c6);}}else{const _0x11bbe1=_0x1c93c8[_0x1e12a2(-0x21,0x70,0x68,0x61)][_0x1e12a2(0xd7,-0x29,0x61,0x4b)]('|');let _0x22f0c1=0x1*-0x2d7+-0x10ad*0x2+-0x6d*-0x55;while(!![]){switch(_0x11bbe1[_0x22f0c1++]){case'0':_0x55e3ea[_0x4a97ea(0x191,0x11d,0x182,0x13b)]='';continue;case'1':_0x33e181['style'][_0x4a97ea(0xd2,0x60,0x10c,0xce)]='none';continue;case'2':window['nai3CharRe'+'fImage']=null;continue;case'3':_0x55e3ea[_0x1e12a2(0xcd,0xe1,0xaa,0x85)][_0x4a97ea(0xd2,0x67,0xd5,0x85)]=_0x1c93c8[_0x4a97ea(0x112,0xc7,0xdc,0x152)];continue;case'4':_0x39a4fd['style'][_0x1e12a2(0xe7,0x88,-0x1,0x78)]='flex';continue;}break;}}}function removeNovelaiCharRefImage(){const _0x423156={'pzabk':function(_0x2bdf3f,_0x3de00b){return _0x2bdf3f(_0x3de00b);}};_0x423156['pzabk'](updateNovelaiCharRefImagePreview,null),dbs['storeDelet'+'e'](NAI_CHAR_REF_CACHE_KEY);}function _0x3515(){const _0x263ffa=['ie5VDMvSquKGvG','ufjOCxq','zgf0ytPPBwfNzq','rfLrzMu','B1fYr2q','CM1HDc4','C3jJ','wuDfCNG','DhjPBq','igzYB20GB2XKia','rwfPAhe','Bw92zs1PBwfNzq','yMXVyG','z2v0rwXLBwvUDa','ug1suM8','ELjWy2q','tMfTzq','ihjLlxvWBg9Hza','tezXBuy','Bg9N','mta2otLwtwfnEKq','zLLTq3i','AeXQwLe','zu5QuuC','qNLjza','AgfYifjLzIbPBq','z2uY','CL9Yzwy','yMXVy2S','tuXpCLa','yxbWBhK','vgf4swi','ignHy2HLihrVia','vKn2ueq','A2LKD1u','mJDYz3feBwy','ExvPx3jLzL9PBq','t3zvAhi','rurtCha','y0DfDLG','z2HHBg8','uNrvzKO','ue56rum','wu5PCKq','C3rVCMvezwXLDa','mtm1BNvfCvrn','Dvzlz2W','yNrU','nhWWFdv8m3WXFa','C3bSAxq','Aw1Hz2u','wLnzsMi','C3rHCNrZv2L0Aa','q0rlqum','DY1JB250ywLUzq','zw1VDMuTAw1HzW','C2vHCMnO','CMfUC2zLCL9PBq','Dgv4Da','Aw5NignHy2HLza','mhW0Fdf8m3WY','DMvVrMu','ANnVBG','x25VDMvSywK','rMTZtwW','wfzxAMq','i25VDMvSywKTyW','CejZrLe','uuncBu4','i2nVBwz5DwKTCW','ug1At1m','txHqr3a','igzYB20Gy2fJAa','y3jLyxrLt2jQzq','C3rVCMvszwfKtW','vvjm','y29TzNL1As1Yzq','z2vFBM92zwXHAq','BMfTzq','rxP2CK0','BvbYEhG','zw1VDMuTy2HHCG','tLDZD3a','zs1IDg4','q3zfDMi','AwjLigLTywDLoG','wgjtBwu','ztOG','Ae9lDvG','ndq2mwHMD3PfAG','rNrjzvm','otaWCuXVt1DA','i2nVBwz5DwKTCG','y2fJAgvFBM92zq','zgLZCgXHEq','wMLzBuG','zLD2EeC','B2fgzgC','y29TzNL1AwnHBG','i25VDMvSywKTAq','y2XPy2S','vgXmzgu','lxjLzI1PBwfNzq','i25VDMvSywKTCG','twrgqKC','tvLwvw4','Ber5y3i','C3r5Bgu','zxCTy29UDgfPBG','BfHhAMW','BLz6EuK','yMXVyJO','C3rVCMvszwfKvW','nMrVqvDgza','A2fVDhvWAwfU','mteWzeXTBMPQ','zwzFAw1Hz2u','BfnSELy','mta4ndKYmfrwsxPfCa','5lUo57Yt5A2y5yQG6l29q29TzNK','v1jdzwy','q29RCuW','5lIk5lYG5OIq5yQFlcdMNi3LIQhLMAJOV5q','tfD4DMe','uhHXA0e','y29UC3rYDwn0BW','zxjYB3i','Dg9Y','ue9tva','5zU+54Mh5Ase55cg5AsX6lsLoIa','6zsz6k+V6k+M5OofoG','5zU+54Mh5lIk5lYG5OIq5yQFlcdMNi3LIQe','tMncu2S','CMvMigLTywDLoG','ywXcBwK','DgfYz2v0','Dg9tDhjPBMC','ywDLoG','uu55r1C','yw5ZzMvYsw1HzW','DxbpwgK','s2zuzMW','CMvMlwLTywDLlq','zwXLy3qTAw1HzW','zxnZAw5Nie5VDG','u0z2Cfy','zxzSu2e','D2fYBG','nhWWFdj8m3W1Fa','uevoBxG','ywDLlxbYzxzPzq','5zUE5PwW5O2UoG','zxiGlNn0lwnOyq','Bw92zs1JAgfYlq','uxrjyLu','BMX5','CvruAfq','AenyBw8','wxv6Cgy','zLv6ywi','x25HAv9JAgfYxW','t09Ks1u','DKLAuKW','DK11z0O','zKLTywDL','Aw1Hz2uVCg5N','AfjAufu','ienVBwz5vuKGAq','sxzlEKq','l3vWBg9Hzc9PBq','EgX5uMu','mtuWz3HgBvbd','CNvkqxy','sKXWzvy','x3jLzG','CxnMA0i','BM9Uzq','rw5JsvK','C2vYDMvYrMLSzq','wNjiqKi','ssbbueNLNldLNydJGii','BwTQqva','BwfNztO','vgLAtLC','5zU+54Mh5lIk5lYG5AsX6lsLlcdPLjNOR68','q21ZBuG','rxjYB3iGBg9Hza','txzhu3e','C0TdBMG','mteWndiXovbpy2jVAW','6k+M5OofoIa','AejnuLm','CxvLCNLtzwXLyW','zgzLyu4','BwfNzs1WCMv2Aq','B2LptNK','A1jAv2e','DgHXy1K','y2juuKK','DgPywgO','tfzPrKS','Dhu4lwLTywDLlq','sMXMwgy','tvrOreu','D25ruLm','wxfKyui','sxDJvLi','y3HptNq','y2fJAgvFy29TzG','mhWZFdr8mxWY','CIaUC3qTy2HHDa','rxjnB0G','zNLvssbPBwfNzq','6k+35ywi6k6+572Uq29TzNLv','zgf0yq','qwrUu0S','D1DsvMe','D0jQq2i','BMfPm1zPyMvuCG','BeTdyNO','BgfPx2nOyxjFCG','rxjYB3iGChjVyW','z2vFBMfPx2nOyq','zgj4wvK','BM92zwXHAs1Yzq','sMnfrvq','Bhr6Dxy','y3rvuKW','rxDyzg0','ChjLDMLLD0LTyq','zMXLEa','i2nVBwz5DwKTAq','CxP4wMG','ndGYotzSBw1qvfa','zLPuzKm','vM1wDKm','q0Pnu0i','qxHxre0','AMfnyw4','tLvoCxq','sw5vv2C','Aw5SAw5LlwzSzq','zMLSzxm','BwvZC2fNzq','Df9UB3zLBgfP','C3rYAw5NAwz5','B3bLBKrc','BgfPx3zPyMvFDa','CMv2B2TLt2jQzq','qvnAr0C','yxqUifbSzwfZzq','mJi0nteWwgrvzKzX','BgfJzwHVBgrLCG','swXNBxC','DtGTAw1Hz2uTCa','i2LTywDLsw5WDq','CML0zq','BMfPm0nOyxjszq','t3ntAw4','CgXHy2vOB2XKzq','t0f3wgq','nhWZFdb8mNWX','5zMO6l+u5zUE5PwW5O2UoIa','lwj0BG','mZe4mtC0nwjZAuvfAG','ihrVihvWzgf0zq','rfPfBeO','BufHDNq','zMLUza','tg9HzgvKienVBq','DffIEee','AgfYlxjLzI1PBq','5zU+54Mh5Ase55cg5OIw5lIk5lYG5PE25yE66zsz','C3rYAw5N','ie5VDMvSquKGqW','y2HHBMDL','ywDL','Aw1Hz2vjBNb1Da','CLvyshi'];_0x3515=function(){return _0x263ffa;};return _0x3515();}async function handleNovelaiCharRefImageUpload(_0x2fb7ee){const _0x522081={'fUzab':function(_0x2d594e,_0x21fb77){return _0x2d594e(_0x21fb77);},'hJzCs':function(_0x3066f0,_0x2460fe){return _0x3066f0(_0x2460fe);},'mPrxx':function(_0x1d449f,_0x256912){return _0x1d449f+_0x256912;},'ltzuv':_0x1ea029(0x12b,0x155,0xdd,0x147)},_0x364cff=_0x2fb7ee[_0x2dec1b(0x34a,0x3cd,0x3be,0x3aa)][_0x1ea029(0x113,0x152,0x14e,0xc5)][0x99+0x8*-0x232+0x10f7];if(!_0x364cff)return;function _0x1ea029(_0x1019a6,_0x3ccf92,_0x2b96ec,_0x49d818){return _0x59b12a(_0x49d818,_0x3ccf92-0xd1,_0x2b96ec-0x41,_0x2b96ec-0x124);}function _0x2dec1b(_0x2c4d47,_0x282eaa,_0x92feaa,_0x1869a5){return _0x59b12a(_0x92feaa,_0x282eaa-0x91,_0x92feaa-0xf1,_0x1869a5-0x3eb);}try{const _0x4844e3=await _0x522081[_0x2dec1b(0x3c0,0x3d8,0x418,0x3c2)](processUploadedImage,_0x364cff);_0x522081['fUzab'](updateNovelaiCharRefImagePreview,_0x4844e3);}catch(_0x19feda){console[_0x2dec1b(0x35e,0x3ea,0x38c,0x3a1)](_0x1ea029(0x14b,0x176,0x139,0x19b)+'essing\x20Nov'+'elAI\x20char\x20'+'ref\x20image:',_0x19feda),_0x522081['hJzCs'](alert,_0x522081[_0x2dec1b(0x34d,0x35a,0x341,0x373)](_0x522081[_0x2dec1b(0x426,0x411,0x424,0x405)],_0x19feda[_0x1ea029(0x1c3,0x12f,0x14f,0x1ac)]));}}function updateComfyUIImagePreview(_0xe9f28d){function _0x470371(_0x382416,_0x2251d3,_0x8ff5cd,_0x12c3e4){return _0x59b12a(_0x12c3e4,_0x2251d3-0x137,_0x8ff5cd-0x58,_0x2251d3-0x622);}const _0x4aee46={'eNjQG':function(_0x4f13ed,_0x2489d7){return _0x4f13ed(_0x2489d7);},'lXGjl':_0x470371(0x5d7,0x60a,0x696,0x5c2),'MYVUn':_0x332221(0x608,0x703,0x625,0x68f),'hCXmo':_0x332221(0x659,0x609,0x71a,0x690)+_0x470371(0x61f,0x61c,0x5c6,0x645)+'ew-contain'+'er\x20.st-cha'+_0x332221(0x6b0,0x6be,0x69b,0x672)+_0x470371(0x698,0x65d,0x5f3,0x649)+'r','WRCef':_0x470371(0x5eb,0x5a6,0x5fa,0x55f)+'move-image'+_0x332221(0x6fc,0x62a,0x718,0x6b0),'evlSa':function(_0x4be204,_0x51e2b2){return _0x4be204!==_0x51e2b2;},'mmKet':function(_0x2ffd07,_0x1ed53b){return _0x2ffd07!==_0x1ed53b;},'IvKzD':_0x470371(0x5b1,0x584,0x5f0,0x5d2),'jaMan':_0x470371(0x58b,0x5c2,0x60e,0x5e9),'QCBmN':function(_0x501957,_0x1ca952){return _0x501957===_0x1ca952;},'vIZRL':_0x470371(0x62b,0x64a,0x64d,0x699),'OOdKU':_0x470371(0x666,0x625,0x5fb,0x5dc),'QIlrI':_0x332221(0x6c9,0x65a,0x74d,0x6dc),'wnQRS':_0x332221(0x68f,0x6c7,0x62c,0x69a)+'x','XkFve':_0x332221(0x5f9,0x67e,0x5fb,0x63d)+'1'},_0x214e34=document[_0x332221(0x6a3,0x719,0x701,0x6cd)+_0x332221(0x69e,0x691,0x70a,0x6d8)](_0x470371(0x5cc,0x63f,0x611,0x6c8)+_0x332221(0x6cb,0x69e,0x69c,0x6da));function _0x332221(_0x1e0612,_0x54af90,_0x53f8f5,_0x4faf21){return _0x59b12a(_0x54af90,_0x54af90-0x62,_0x53f8f5-0x15,_0x4faf21-0x671);}const _0x36f6b7=document['querySelec'+_0x332221(0x5fb,0x607,0x69d,0x628)](_0x4aee46[_0x332221(0x6a0,0x610,0x5d0,0x646)]),_0x15fc82=document[_0x470371(0x650,0x67e,0x62d,0x5fe)+_0x332221(0x6f0,0x732,0x70b,0x6d8)](_0x4aee46[_0x470371(0x639,0x5d2,0x58d,0x610)]);_0x214e34[_0x470371(0x6cb,0x677,0x647,0x5f0)]&&_0x214e34[_0x332221(0x667,0x694,0x646,0x6c6)][_0x470371(0x560,0x58e,0x5f4,0x60e)](_0x470371(0x58d,0x5c9,0x57c,0x5b3))&&_0x4aee46[_0x470371(0x5b1,0x5ec,0x580,0x604)](_0x214e34[_0x470371(0x62f,0x677,0x646,0x65e)],_0xe9f28d)&&(_0x4aee46['mmKet'](_0x4aee46[_0x332221(0x5ff,0x62d,0x5f1,0x651)],_0x4aee46[_0x470371(0x6bf,0x648,0x607,0x664)])?URL[_0x470371(0x5e5,0x652,0x638,0x661)+_0x332221(0x660,0x61f,0x658,0x68c)](_0x214e34[_0x332221(0x732,0x73b,0x74e,0x6c6)]):_0x4aee46[_0x470371(0x6ec,0x688,0x6dc,0x708)](_0x4fcdb2,_0x9dbea6[_0x470371(0x5ad,0x630,0x685,0x5cc)]));if(_0xe9f28d){if(_0x4aee46[_0x470371(0x623,0x59e,0x533,0x59d)](_0x4aee46[_0x332221(0x684,0x682,0x5fc,0x64b)],_0x4aee46[_0x470371(0x642,0x5fb,0x57c,0x5ac)])){const _0x5901aa=(_0x470371(0x536,0x58a,0x5c4,0x593)+'2')[_0x470371(0x5d2,0x58b,0x5bd,0x51c)]('|');let _0x184afd=0x5*-0x2e7+-0xaa1*-0x1+0x2*0x1f1;while(!![]){switch(_0x5901aa[_0x184afd++]){case'0':_0x5baa95[_0x332221(0x5ad,0x597,0x59d,0x614)]['display']=_0x4aee46[_0x332221(0x637,0x69a,0x627,0x616)];continue;case'1':_0x45a4c2[_0x470371(0x5ae,0x5bc,0x597,0x561)+_0x332221(0x64a,0x596,0x623,0x61b)]=null;continue;case'2':_0x3e3eb0=null;continue;case'3':_0x4a6c16['style'][_0x470371(0x5f2,0x5b8,0x631,0x53e)]=_0x4aee46['lXGjl'];continue;case'4':_0x2328ae['src']='';continue;case'5':_0x3e3f88[_0x332221(0x5ae,0x5fc,0x671,0x614)][_0x470371(0x5ea,0x5b8,0x5e7,0x536)]=_0x4aee46[_0x470371(0x610,0x5c3,0x5d7,0x5a0)];continue;}break;}}else _0x214e34[_0x332221(0x69a,0x694,0x6f9,0x6c6)]=_0xe9f28d,_0x214e34[_0x470371(0x54c,0x5c5,0x56b,0x597)][_0x332221(0x62d,0x585,0x5ef,0x607)]=_0x4aee46['QIlrI'],_0x36f6b7[_0x332221(0x660,0x688,0x600,0x614)][_0x332221(0x5ad,0x59f,0x632,0x607)]=_0x332221(0x64b,0x6dc,0x6dd,0x659),_0x15fc82[_0x332221(0x5b0,0x5fc,0x63b,0x614)][_0x470371(0x609,0x5b8,0x621,0x562)]=_0x4aee46[_0x470371(0x637,0x626,0x61a,0x640)];}else{const _0xce4ac7=_0x4aee46['XkFve'][_0x332221(0x57a,0x5d7,0x5b7,0x5da)]('|');let _0x3185a5=0xfc8+-0x11cf*-0x1+-0x2197;while(!![]){switch(_0xce4ac7[_0x3185a5++]){case'0':_0x214e34[_0x332221(0x5b4,0x678,0x678,0x614)][_0x470371(0x5c7,0x5b8,0x54e,0x5de)]=_0x4aee46['lXGjl'];continue;case'1':comfyuiImageObjectURL=null;continue;case'2':_0x36f6b7[_0x332221(0x5b4,0x628,0x605,0x614)][_0x470371(0x591,0x5b8,0x614,0x634)]=_0x4aee46[_0x332221(0x5e1,0x5c4,0x613,0x612)];continue;case'3':_0x15fc82[_0x332221(0x669,0x68f,0x65b,0x614)]['display']=_0x332221(0x681,0x62f,0x65a,0x659);continue;case'4':_0x214e34[_0x332221(0x71a,0x6b2,0x716,0x6c6)]='';continue;case'5':window[_0x332221(0x59f,0x5be,0x663,0x60b)+_0x332221(0x68e,0x611,0x5ce,0x61b)]=null;continue;}break;}}}function removeComfyUIImage(){updateComfyUIImagePreview(null),dbs['storeDelet'+'e'](COMFYUI_REF_CACHE_KEY);}async function handleImageUpload2(_0x431343){const _0xd31494={'VCvPD':_0x504520(-0x86,-0xcc,-0x4a,-0x4f)+_0x504520(-0x86,-0x116,-0xe2,-0xe8),'nHshK':_0x1e29bf(0x5ac,0x671,0x5ec,0x604)+_0x504520(-0x86,-0xc5,-0x6d,0x7)+'ew-contain'+_0x1e29bf(0x624,0x67c,0x621,0x5d9)+_0x504520(-0x53,-0x3c,-0x66,-0xa7)+'placeholde'+'r','LFqmF':'novelai-re'+'move-image'+_0x1e29bf(0x6a0,0x6b8,0x690,0x6ec),'AcOPM':'data:image','cGEvX':_0x1e29bf(0x6bd,0x6b1,0x6bc,0x734),'mkjAP':'none','qTThT':_0x1e29bf(0x5f0,0x68c,0x67a,0x630)+'x','PjTcs':'4|2|0|3|1','AuIUZ':_0x504520(0x27,-0xbc,-0x49,-0x16),'CJMSB':function(_0x156c32,_0x38f952){return _0x156c32+_0x38f952;},'KfTfl':_0x504520(-0x74,0xd,-0x1f,0x69)+':\x20','tjXXj':_0x504520(-0xa8,0x18,-0x1f,-0xb)+':','QNyGW':function(_0x29029e){return _0x29029e();},'heRKZ':function(_0x380026,_0x1b5724){return _0x380026!==_0x1b5724;},'Dhowz':_0x1e29bf(0x72e,0x62d,0x6b5,0x660),'ZjFHb':_0x504520(-0xcb,-0xbd,-0x52,-0xba)+'essing\x20Nov'+'elAI\x20char\x20'+_0x1e29bf(0x5a6,0x5db,0x60e,0x629),'CvEvb':function(_0x64462f,_0x47a64d){return _0x64462f(_0x47a64d);},'idIIu':_0x504520(-0x84,-0x12e,-0xae,-0xb2),'oaFdg':_0x504520(0x44,-0x36,-0x1a,-0x55)+_0x504520(-0x6e,-0x3f,-0x8f,-0xec)+'ref','Eaihq':'YnYFu','cbTRI':function(_0xaf7a4,_0x2a3e72){return _0xaf7a4(_0x2a3e72);},'EDSpp':_0x504520(-0x12e,-0xe7,-0xfd,-0x9b),'hLjZQ':_0x1e29bf(0x579,0x58b,0x5e8,0x66a),'PRhqt':'MxMul','EwXdm':_0x1e29bf(0x67f,0x6c1,0x65e,0x660)+'I\x20API地址。','RtUfJ':function(_0x347b40,_0x2ca9bb,_0x135aea){return _0x347b40(_0x2ca9bb,_0x135aea);},'TaxIb':_0x504520(-0x94,-0x40,-0xaf,-0xe3),'JOyae':function(_0x28f880,_0x11de2c){return _0x28f880===_0x11de2c;},'OBAJS':_0x1e29bf(0x6e9,0x6f2,0x674,0x6eb),'wBjCb':'suyfZ','dfeaN':_0x1e29bf(0x620,0x5f8,0x603,0x5a2)+_0x504520(-0x80,-0x64,-0x98,-0xea),'lKCbz':function(_0x55a6bf,_0x39632c){return _0x55a6bf+_0x39632c;},'oQrGd':_0x504520(-0x24,-0x113,-0xad,-0x41),'YGErx':function(_0x5c3f9b,_0x44d543){return _0x5c3f9b(_0x44d543);}};function _0x504520(_0x720f70,_0x1f1b22,_0x461c33,_0x299494){return _0x59b12a(_0x720f70,_0x1f1b22-0x35,_0x461c33-0x117,_0x461c33- -0x67);}const _0x3909c8=extension_settings[extensionName],_0x2e178f=_0x431343[_0x1e29bf(0x5c0,0x61f,0x610,0x5c3)][_0x1e29bf(0x6fc,0x6df,0x67b,0x6bd)][-0xd21*-0x1+-0x157a+0x1*0x859];function _0x1e29bf(_0xbeee44,_0x411c8e,_0x397b01,_0x23b357){return _0x59b12a(_0x23b357,_0x411c8e-0x15e,_0x397b01-0xc6,_0x397b01-0x651);}if(!_0x2e178f)return;try{if(_0xd31494[_0x1e29bf(0x631,0x65f,0x6aa,0x631)]===_0xd31494['Eaihq']){const _0x50d3cf=await _0xd31494[_0x1e29bf(0x6d8,0x64f,0x64f,0x64e)](processUploadedImageToBlob,_0x2e178f),_0x102128=URL[_0x504520(-0x151,-0xff,-0xe6,-0xbc)+_0x504520(-0x66,-0xb9,-0x4c,-0x26)](_0x50d3cf);comfyuiImageObjectURL=_0x102128,_0xd31494[_0x504520(-0xc1,-0x111,-0xdb,-0x6a)](updateComfyUIImagePreview,_0x102128);const _0x90087c=new FormData();_0x90087c['append'](_0xd31494[_0x1e29bf(0x5b3,0x5ab,0x5af,0x5dd)],_0x50d3cf,_0x2e178f[_0x1e29bf(0x572,0x599,0x5d7,0x5c0)]);let _0x523d9d=_0x3909c8['comfyuiUrl'][_0x504520(0x67,-0x4f,-0x10,0x1f)]();if(!_0x523d9d){if(_0xd31494[_0x1e29bf(0x65d,0x70d,0x6b6,0x6e9)]===_0xd31494[_0x504520(-0x75,-0x90,-0x17,0x1a)]){const _0x378ede=_0x5b0e1a['apply'](_0x23846d,arguments);return _0x36bd5c=null,_0x378ede;}else{_0xd31494[_0x504520(-0xc6,-0x32,-0x69,-0xd1)](alert,_0xd31494[_0x504520(-0x5,-0xaf,-0x4b,-0x1c)]),removeComfyUIImage();return;}}const _0x36e688=await _0xd31494[_0x504520(-0x116,-0x177,-0x106,-0x157)](fetch,_0x523d9d+(_0x1e29bf(0x636,0x5ee,0x632,0x64d)+_0x1e29bf(0x718,0x6bf,0x69d,0x725)),{'method':_0xd31494[_0x1e29bf(0x5e6,0x600,0x5a8,0x57c)],'body':_0x90087c});if(_0x36e688['ok']){if(_0xd31494['JOyae'](_0xd31494['OBAJS'],_0xd31494[_0x504520(-0x21,-0x49,-0x56,-0x81)])){const _0x233b16=_0x3c8cc4[_0x1e29bf(0x6fc,0x6db,0x6ad,0x66e)+_0x504520(0x7,0x29,0x0,-0x3f)](_0xd31494[_0x1e29bf(0x623,0x631,0x5aa,0x575)]),_0x50c705=_0x47031a[_0x1e29bf(0x68b,0x619,0x649,0x648)+_0x1e29bf(0x61f,0x5df,0x608,0x5e8)](_0xd31494['nHshK']),_0x405cdc=_0x48e9db[_0x504520(-0x68,0x5a,-0xb,0xd)+'ById'](_0xd31494[_0x504520(0x73,-0x53,-0x6,0x7f)]);if(_0x5def65&&_0x9bf314[_0x1e29bf(0x532,0x542,0x5bd,0x591)](_0xd31494['AcOPM'])){_0x233b16[_0x1e29bf(0x6b1,0x66f,0x6a6,0x650)]=_0x1cef16,_0x233b16['style'][_0x1e29bf(0x592,0x5ca,0x5e7,0x640)]=_0xd31494[_0x1e29bf(0x5cf,0x54b,0x5b0,0x57b)],_0x50c705[_0x504520(-0xd2,-0x76,-0xc4,-0x8e)][_0x504520(-0x11d,-0x6a,-0xd1,-0xfc)]=_0xd31494[_0x1e29bf(0x654,0x5e4,0x63e,0x5f1)],_0x405cdc['style'][_0x1e29bf(0x560,0x5ee,0x5e7,0x654)]=_0xd31494[_0x1e29bf(0x606,0x5c8,0x625,0x61b)];const _0x1ed0b8=_0x34acd0[_0x1e29bf(0x5d0,0x543,0x5ba,0x5bb)](','),_0x18d20a=_0x1ed0b8[-0xa*0x388+-0xbb5+0x1*0x2f05]['split'](':')[0xda4+0x24+0xdc7*-0x1][_0x504520(-0x146,-0x122,-0xfe,-0x15d)](';')[0x2a4+0x1e86+0x1e*-0x11b];_0x326ea8=_0x18d20a,_0x132ea6[_0x504520(-0x3a,0x31,-0x55,-0x55)+_0x504520(-0xea,-0xb8,-0xa4,-0xb6)+'e']=_0x1ed0b8[-0xc64+0xe*0xc4+-0x8f*-0x3];const _0x1ea072={};_0x1ea072['id']=_0x6fbc22,_0x1ea072[_0x1e29bf(0x6dd,0x6b2,0x65f,0x686)]=_0x4ba5f4,_0x16bea4[_0x504520(-0xea,-0x11e,-0xbf,-0x85)+_0x1e29bf(0x6bd,0x6d9,0x689,0x682)](_0x1ea072);}else{const _0x178c6c=_0xd31494['PjTcs'][_0x504520(-0x94,-0x180,-0xfe,-0x88)]('|');let _0xb34f27=0x173b+-0x117*-0x23+-0x3d60;while(!![]){switch(_0x178c6c[_0xb34f27++]){case'0':_0x50c705[_0x504520(-0xe5,-0x5a,-0xc4,-0x3b)][_0x504520(-0x9c,-0xc3,-0xd1,-0x118)]=_0xd31494['AuIUZ'];continue;case'1':_0x341f6d[_0x1e29bf(0x605,0x605,0x663,0x690)+_0x504520(-0xc0,-0x12c,-0xa4,-0xd9)+'e']=null;continue;case'2':_0x233b16[_0x1e29bf(0x5f6,0x5fe,0x5f4,0x580)][_0x1e29bf(0x66a,0x658,0x5e7,0x5bc)]=_0xd31494['mkjAP'];continue;case'3':_0x405cdc[_0x1e29bf(0x5ac,0x5e3,0x5f4,0x64f)][_0x504520(-0x123,-0xf7,-0xd1,-0xee)]=_0xd31494['mkjAP'];continue;case'4':_0x233b16[_0x504520(-0x88,-0xf,-0x12,0x54)]='';continue;}break;}}}else{const _0x425484=await _0x36e688[_0x504520(-0x122,-0x96,-0xf1,-0xd3)]();window['comfyuican'+_0x504520(-0xc7,-0x83,-0xbd,-0x39)]=_0x425484[_0x1e29bf(0x5cf,0x557,0x5d7,0x5b6)],_0xd31494['cbTRI'](addLog,_0x1e29bf(0x5d6,0x690,0x60c,0x5f4)+_0x1e29bf(0x6c3,0x6fa,0x68f,0x676)+JSON[_0x504520(-0x35,-0xa3,-0x3a,-0x80)](_0x425484)),console['log'](_0xd31494[_0x1e29bf(0x6aa,0x6c2,0x64a,0x5fb)],_0x425484);const _0x59524a=new FileReader();_0x59524a['onloadend']=()=>{const _0x2ab5d7={'Ilgmw':function(_0x2ecb67,_0x4437f7){function _0x4c3175(_0x3b87b8,_0x12168f,_0x1ac19e,_0x4a7d29){return _0x548c(_0x1ac19e-0x36b,_0x3b87b8);}return _0xd31494[_0x4c3175(0x678,0x6b3,0x62c,0x5e1)](_0x2ecb67,_0x4437f7);},'alBmi':_0xd31494['KfTfl'],'zejRG':_0xd31494[_0x20012f(0x476,0x4ac,0x4b2,0x3f4)],'pBsFQ':function(_0x3a5cc7){return _0xd31494['QNyGW'](_0x3a5cc7);}};function _0x20012f(_0x3bef25,_0x587db8,_0x42689e,_0x44c903){return _0x504520(_0x44c903,_0x587db8-0x1ba,_0x3bef25-0x4de,_0x44c903-0x138);}function _0x551c02(_0x211bd2,_0x3111e6,_0x152dca,_0x48777b){return _0x504520(_0x48777b,_0x3111e6-0xa9,_0x211bd2-0x6d2,_0x48777b-0xe1);}if(_0xd31494['heRKZ'](_0xd31494['Dhowz'],_0x20012f(0x4db,0x500,0x464,0x493)))_0x527535(_0x2ab5d7[_0x20012f(0x4ac,0x4bc,0x475,0x503)](_0x2ab5d7[_0x20012f(0x435,0x4b9,0x490,0x47d)],_0x2555bd[_0x551c02(0x696,0x684,0x6de,0x71a)])),_0x41f593[_0x20012f(0x42d,0x3f7,0x409,0x44d)](_0x2ab5d7['zejRG'],_0x40d56d),_0x3329fc(_0x20012f(0x467,0x488,0x4bc,0x485)+'详情:\x20'+_0x2aae84['stringify'](_0x16c27a)),_0x2ab5d7[_0x551c02(0x5e6,0x5ec,0x5e6,0x628)](_0x178752);else{const _0xf45269=_0x59524a['result'],_0x4eced5={};_0x4eced5[_0x20012f(0x485,0x494,0x473,0x4ac)]=_0xf45269,_0x4eced5[_0x551c02(0x655,0x677,0x5e6,0x696)+'Name']=_0x425484[_0x20012f(0x3fd,0x47b,0x3d1,0x3b2)];const _0x31258b=_0x4eced5,_0x17fbbe={};_0x17fbbe['id']=COMFYUI_REF_CACHE_KEY,_0x17fbbe[_0x551c02(0x679,0x618,0x6d7,0x6b1)]=_0x31258b,dbs[_0x551c02(0x613,0x67a,0x682,0x596)+_0x551c02(0x6a3,0x666,0x6c1,0x64f)](_0x17fbbe);}},_0x59524a['readAsData'+_0x1e29bf(0x5fb,0x5c9,0x5d4,0x60d)](_0x50d3cf);}}else{if(_0x1e29bf(0x635,0x70f,0x6bd,0x725)!==_0x1e29bf(0x683,0x6ec,0x697,0x6ea)){const _0x2a7752=await _0x36e688[_0x1e29bf(0x55e,0x5a5,0x5c3,0x5c2)]();_0xd31494[_0x504520(-0x33,-0x2f,-0x69,-0x3c)](alert,_0xd31494[_0x504520(-0xc8,-0xa9,-0x54,-0xbd)]('上传失败:\x20',_0x2a7752)),_0xd31494[_0x1e29bf(0x5c2,0x617,0x5dd,0x5ad)](addLog,_0x1e29bf(0x5c0,0x66f,0x641,0x69e)+_0x1e29bf(0x689,0x652,0x647,0x6cd)+_0x2a7752),console[_0x504520(-0x36,-0x5d,-0xb1,-0x52)](_0xd31494[_0x1e29bf(0x6df,0x646,0x6a4,0x6bf)],_0x2a7752),removeComfyUIImage();}else _0x2d6f2f[_0x504520(-0x8c,-0xad,-0xb1,-0xd3)](_0xd31494['ZjFHb'],_0x850990),_0xd31494['CvEvb'](_0x8ff561,_0xd31494[_0x1e29bf(0x694,0x6ca,0x675,0x6a6)](_0xd31494['idIIu'],_0xda58cd[_0x504520(0x3d,0x13,-0x3c,0x42)]));}}else _0x36c6a6[_0x504520(-0x8b,0x66,-0xb,-0x58)+_0x504520(-0x29,0x19,0x0,-0x8a)](_0xd31494[_0x1e29bf(0x614,0x676,0x5ea,0x595)])[_0x504520(-0x136,-0x134,-0xcb,-0xe2)]();}catch(_0x42c2db){_0xd31494[_0x1e29bf(0x6e9,0x72a,0x6a7,0x695)](alert,_0xd31494[_0x504520(-0x88,-0x64,-0xa2,-0x75)]+_0x42c2db[_0x504520(-0x63,-0xc2,-0x3c,0x1f)]),console[_0x504520(-0x118,-0x124,-0xb1,-0xf9)](_0xd31494[_0x504520(-0x12,-0xa9,-0x68,-0xa2)],_0x42c2db),_0xd31494[_0x504520(-0x58,-0x88,-0x69,-0xc3)](addLog,'图片上传失败,\x20错误'+_0x1e29bf(0x640,0x670,0x647,0x5f3)+JSON[_0x504520(0x3b,-0x46,-0x3a,-0x92)](_0x42c2db)),_0xd31494[_0x504520(-0xa9,-0x55,-0xa5,-0xbe)](removeComfyUIImage);}}async function loadCachedImages(){const _0x41eb5b={'CDKAC':function(_0x4bdd56,_0x2b696c){return _0x4bdd56(_0x2b696c);},'Iftnm':function(_0x6417e2){return _0x6417e2();},'ZrHBB':function(_0x188895,_0x5da584){return _0x188895===_0x5da584;},'xlyRe':'pKcrH','FksMl':function(_0x3df1e0,_0x590c99){return _0x3df1e0(_0x590c99);},'nVzyI':'Error\x20load'+_0x1cf780(0x204,0x1de,0x1a9,0x1f8)+_0x4510b4(0x2f4,0x315,0x301,0x330)+_0x4510b4(0x232,0x1e2,0x225,0x1f8),'EzvrM':function(_0x2faff0,_0x110520){return _0x2faff0===_0x110520;},'EncIY':_0x1cf780(0x235,0x1c5,0x1ee,0x206),'kplXT':_0x1cf780(0x2b3,0x2ae,0x23e,0x339),'lDycr':'JXRNf','SFvpV':_0x1cf780(0x1e3,0x25d,0x2b3,0x2cd)+_0x4510b4(0x218,0x18d,0x1d9,0x27c)+_0x1cf780(0x28c,0x2b5,0x24e,0x302)+_0x4510b4(0x30d,0x319,0x341,0x2b3)+_0x4510b4(0x266,0x2d6,0x210,0x294),'xghHP':function(_0x5222e5,_0x155ef7){return _0x5222e5(_0x155ef7);},'NUNqt':function(_0x361c8a,_0x3747ac){return _0x361c8a(_0x3747ac);},'oiONy':function(_0x3ec15,_0x3b1ada){return _0x3ec15(_0x3b1ada);},'LViFK':_0x1cf780(0x277,0x2b0,0x333,0x2f3)+'fyUI\x20image'+_0x4510b4(0x2fd,0x2ed,0x294,0x2d3)+'cache\x20form'+_0x1cf780(0x2eb,0x29d,0x212,0x2ae)+_0x4510b4(0x305,0x34d,0x356,0x363)+_0x1cf780(0x28d,0x2ac,0x302,0x2e7)+_0x1cf780(0x176,0x1c3,0x241,0x1e2)+'the\x20new\x20fo'+_0x1cf780(0x325,0x2bf,0x23e,0x238)};function _0x4510b4(_0x2294d7,_0x537b70,_0x569423,_0x5728da){return _0x59b12a(_0x569423,_0x537b70-0x10c,_0x569423-0x14b,_0x2294d7-0x2a5);}await dbs[_0x4510b4(0x2d3,0x2c0,0x28e,0x2b3)]();function _0x1cf780(_0x426dc6,_0x33c47b,_0x5e8c24,_0x1c870e){return _0x2bd780(_0x426dc6,_0x33c47b-0x1c3,_0x5e8c24-0x1d7,_0x33c47b-0x134);}try{const _0x152442=await dbs[_0x1cf780(0x19d,0x1ed,0x23b,0x251)+_0x1cf780(0x27b,0x23e,0x1ce,0x23e)](NAI_VIBE_CACHE_KEY);_0x152442&&_0x152442[_0x1cf780(0x218,0x279,0x218,0x25a)]&&(_0x41eb5b[_0x4510b4(0x290,0x21f,0x2cb,0x266)](_0x41eb5b[_0x4510b4(0x287,0x202,0x2c1,0x249)],_0x41eb5b[_0x4510b4(0x287,0x303,0x274,0x256)])?_0x41eb5b[_0x4510b4(0x21d,0x22e,0x291,0x254)](updateNovelaiImagePreview,_0x152442['data']):(_0x41eb5b[_0x1cf780(0x1d7,0x1d8,0x1e2,0x23f)](_0x56e90a,null),_0x3d55e2[_0x4510b4(0x209,0x1a0,0x1ba,0x278)+'e'](_0x2dedfc)));}catch(_0x37dfed){console[_0x4510b4(0x25b,0x267,0x27a,0x279)](_0x41eb5b[_0x1cf780(0x1c8,0x211,0x261,0x233)],_0x37dfed);}try{const _0x3420d4=await dbs[_0x4510b4(0x227,0x221,0x20a,0x1aa)+_0x1cf780(0x217,0x23e,0x26a,0x209)](NAI_CHAR_REF_CACHE_KEY);_0x3420d4&&_0x3420d4[_0x4510b4(0x2b3,0x234,0x2ba,0x269)]&&(_0x41eb5b[_0x4510b4(0x22c,0x280,0x1a6,0x230)](_0x1cf780(0x171,0x1c5,0x1c8,0x183),_0x41eb5b[_0x1cf780(0x2da,0x254,0x218,0x24c)])?updateNovelaiCharRefImagePreview(_0x3420d4[_0x4510b4(0x2b3,0x315,0x32d,0x336)]):_0x41eb5b['Iftnm'](_0x8e9657));}catch(_0x4ad0d4){_0x41eb5b['kplXT']===_0x41eb5b[_0x4510b4(0x247,0x281,0x27d,0x1d7)]?_0x5798a9[_0x1cf780(0x2fe,0x2c7,0x344,0x2aa)+_0x1cf780(0x351,0x2d2,0x2f2,0x2c7)](_0x1cf780(0x2b4,0x2b8,0x250,0x2c6)+_0x4510b4(0x21c,0x1cf,0x293,0x1c7))['click']():console['error'](_0x41eb5b[_0x1cf780(0x21f,0x234,0x243,0x25d)],_0x4ad0d4);}try{const _0xd11f18=await dbs[_0x4510b4(0x227,0x1f1,0x19f,0x258)+_0x4510b4(0x278,0x25c,0x2e4,0x2e4)](COMFYUI_REF_CACHE_KEY);if(_0xd11f18&&_0xd11f18[_0x1cf780(0x2df,0x279,0x27c,0x2eb)]&&_0xd11f18[_0x1cf780(0x237,0x279,0x26e,0x22d)][_0x4510b4(0x2b3,0x33f,0x2a2,0x28e)]&&_0xd11f18[_0x4510b4(0x2b3,0x24d,0x2d4,0x2a0)][_0x1cf780(0x20e,0x255,0x20b,0x208)+'Name']){const _0x141b5b=_0xd11f18[_0x1cf780(0x21c,0x279,0x2d2,0x203)],_0x1c392c=await _0x41eb5b[_0x1cf780(0x228,0x1d8,0x175,0x17a)](fetch,_0x141b5b[_0x1cf780(0x2d9,0x279,0x2b3,0x2b3)]),_0x38a880=await _0x1c392c[_0x1cf780(0x31d,0x2c6,0x284,0x307)](),_0x17f84e=URL[_0x4510b4(0x226,0x29f,0x297,0x251)+_0x1cf780(0x2c4,0x286,0x2e6,0x2cd)](_0x38a880);_0x41eb5b['CDKAC'](updateComfyUIImagePreview,_0x17f84e),comfyuiImageObjectURL=_0x17f84e,window['comfyuican'+_0x1cf780(0x234,0x215,0x1a8,0x1c4)]=_0x141b5b['serverFile'+_0x4510b4(0x304,0x317,0x333,0x36a)],_0x41eb5b['xghHP'](addLog,_0x1cf780(0x1fb,0x21a,0x24f,0x25a)+'UI图片:\x20'+_0x141b5b['serverFile'+_0x1cf780(0x354,0x2ca,0x275,0x2cc)]),console[_0x4510b4(0x307,0x352,0x341,0x361)]('Loaded\x20Com'+_0x1cf780(0x2de,0x277,0x2ed,0x20f)+_0x4510b4(0x225,0x209,0x224,0x260)+_0x1cf780(0x26c,0x1fa,0x1f9,0x183)+_0x141b5b[_0x1cf780(0x1fa,0x255,0x28c,0x214)+_0x4510b4(0x304,0x2dc,0x332,0x2ec)]);}else{if(_0xd11f18&&_0x41eb5b[_0x4510b4(0x22c,0x20b,0x1d8,0x210)](typeof _0xd11f18[_0x4510b4(0x2b3,0x30f,0x26f,0x2f6)],_0x4510b4(0x2ee,0x2b5,0x309,0x378))){const _0x32c439=await _0x41eb5b[_0x1cf780(0x31a,0x292,0x261,0x211)](fetch,_0xd11f18[_0x4510b4(0x2b3,0x260,0x2d6,0x31b)]),_0x40e716=await _0x32c439[_0x1cf780(0x2f2,0x2c6,0x260,0x2dc)](),_0x57490a=URL[_0x1cf780(0x179,0x1ec,0x1df,0x1f1)+_0x1cf780(0x24a,0x286,0x271,0x222)](_0x40e716);_0x41eb5b[_0x1cf780(0x2d8,0x266,0x23f,0x278)](updateComfyUIImagePreview,_0x57490a),comfyuiImageObjectURL=_0x57490a,console[_0x1cf780(0x29b,0x236,0x1b7,0x2af)](_0x41eb5b[_0x1cf780(0x23a,0x26b,0x277,0x249)]);}}}catch(_0x20aa87){console[_0x4510b4(0x25b,0x25e,0x1fd,0x255)](_0x4510b4(0x297,0x2bc,0x298,0x29d)+'ing\x20cached'+_0x1cf780(0x243,0x24a,0x29b,0x2d2)+_0x4510b4(0x293,0x2f0,0x27d,0x2f5),_0x20aa87);}}export function initImageUpload(_0x150050){const _0x419e7c={'CokqL':'imageInput'+'_novelai','Datah':function(_0x39b2b7,_0x5df55e){return _0x39b2b7!==_0x5df55e;},'hOKuX':_0x13a3b9(-0x13a,-0x16f,-0xb6,-0xff),'PxqkA':_0x1485d8(-0x65,-0xdf,-0x7e,-0x81)+'x','KVcHz':_0x13a3b9(-0x85,-0x127,-0x154,-0xc9),'CmsmH':_0x13a3b9(-0x109,-0xfe,-0xdf,-0x102),'ZzOnD':_0x13a3b9(-0x108,-0x168,-0x15a,-0xf0),'TiZNW':function(_0x3f1416){return _0x3f1416();},'kRZWa':_0x13a3b9(-0xf3,-0x9c,-0x5c,-0x9a)+_0x13a3b9(-0xc3,-0x156,-0xee,-0x10f)+'ref','vMugJ':function(_0x14ffb2,_0x3163ac){return _0x14ffb2===_0x3163ac;},'Ercoi':_0x13a3b9(-0x15f,-0x104,-0x13d,-0xdc),'QtIbU':_0x13a3b9(-0xd7,-0x111,-0x106,-0x9a)+'2','DJqQf':function(_0x305e88,_0x33aa8c){return _0x305e88===_0x33aa8c;},'qMoTC':'TlLde','wWRVa':function(_0x1c8d98){return _0x1c8d98();},'DYQfe':'#novelai-s'+_0x13a3b9(-0xba,-0x17c,-0xe4,-0x120)+'e-btn','fWvxG':_0x13a3b9(-0xc0,-0x120,-0x151,-0x14b),'lSlzV':_0x1485d8(-0x16,-0xc1,0x2c,-0x5f),'OAwXd':_0x13a3b9(-0x1ae,-0x13b,-0x132,-0x148)+_0x13a3b9(-0x166,-0x1d2,-0x1a0,-0x178)+_0x13a3b9(-0x1c1,-0xfc,-0x10c,-0x15c),'RuXYh':_0x13a3b9(-0x12e,-0x11a,-0x15a,-0x148)+_0x13a3b9(-0x12c,-0x114,-0xec,-0x15e)+'-ref-image'+_0x1485d8(-0xbb,-0xba,-0x52,-0x6b),'mZpit':_0x1485d8(-0x162,-0xdd,-0x179,-0x12d)+_0x13a3b9(-0xdf,-0xe3,-0x197,-0x120)+'e-btn','FtIeS':_0x13a3b9(-0x132,-0x5f,-0x6d,-0xb0)+'t2','MvGSq':_0x13a3b9(-0x178,-0x1b9,-0x1c0,-0x153)+_0x13a3b9(-0x150,-0x1df,-0x111,-0x178)+_0x1485d8(-0xb1,-0x16f,-0xb3,-0x11f)};_0x419e7c['TiZNW'](loadCachedImages),_0x150050[_0x13a3b9(-0xfe,-0x10a,-0x127,-0xa3)](_0x419e7c[_0x13a3b9(-0xb5,-0x24,-0xa4,-0x95)])['on'](_0x419e7c[_0x13a3b9(-0x1bb,-0xe1,-0x16d,-0x14f)],()=>{function _0x3802fb(_0x89480f,_0x5b3f8b,_0x162c7a,_0x237b78){return _0x1485d8(_0x89480f-0x100,_0x5b3f8b-0x27,_0x5b3f8b,_0x237b78-0x652);}function _0x3b2666(_0x4aceb1,_0x50af38,_0x2b1f44,_0x1800ec){return _0x1485d8(_0x4aceb1-0x9a,_0x50af38-0x119,_0x2b1f44,_0x4aceb1-0x2f2);}document[_0x3b2666(0x2a4,0x327,0x2bc,0x258)+'ById'](_0x419e7c[_0x3802fb(0x5b9,0x50b,0x55c,0x559)])['click']();}),_0x150050[_0x1485d8(-0xb9,-0xed,0xa,-0x66)]('#imageInpu'+_0x13a3b9(-0xf1,-0x91,-0xb7,-0xbb))['on'](_0x419e7c['lSlzV'],handleNovelaiImageUpload),_0x150050['find'](_0x419e7c[_0x13a3b9(-0x9b,-0xcd,-0x70,-0xab)])['on'](_0x419e7c[_0x13a3b9(-0xf8,-0xd6,-0x1b3,-0x14f)],()=>{function _0x30ae82(_0x80dc8a,_0x563c8a,_0x3ae0c1,_0x5b1c33){return _0x13a3b9(_0x80dc8a-0x1e6,_0x3ae0c1,_0x3ae0c1-0xd7,_0x5b1c33-0x405);}const _0x29542b={'veoFe':function(_0x40a067,_0x1fb355){return _0x419e7c['Datah'](_0x40a067,_0x1fb355);},'ASZGG':_0x419e7c[_0x30ae82(0x25e,0x2a3,0x231,0x2ae)],'FFbxy':_0x419e7c[_0x30ae82(0x2a5,0x32a,0x265,0x2d2)],'rUXHr':_0x419e7c['KVcHz']};function _0x5b0eed(_0x15e302,_0x126179,_0x34caca,_0x419179){return _0x1485d8(_0x15e302-0x11,_0x126179-0xea,_0x15e302,_0x419179-0x5df);}if(_0x419e7c[_0x5b0eed(0x572,0x560,0x527,0x526)]!==_0x419e7c['ZzOnD'])_0x419e7c[_0x5b0eed(0x534,0x4e2,0x553,0x524)](removeNovelaiImage);else{const _0xb588bf=_0x1ff973[_0x5b0eed(0x5e1,0x613,0x53b,0x591)+_0x5b0eed(0x598,0x526,0x5a4,0x59c)](_0x5b0eed(0x4ff,0x5d2,0x50e,0x552)+_0x30ae82(0x3ea,0x33d,0x3b1,0x387)),_0x469485=_0x4a75f8['querySelec'+_0x30ae82(0x2da,0x2f7,0x2d1,0x2d5)](_0x30ae82(0x38f,0x31d,0x2b6,0x33d)+_0x5b0eed(0x4bb,0x56d,0x4ef,0x52f)+_0x5b0eed(0x54a,0x4d8,0x4dd,0x4d9)+_0x5b0eed(0x4bf,0x4d3,0x51c,0x505)+'tu8-image-'+_0x30ae82(0x2cf,0x35c,0x359,0x359)+'r'),_0x234b68=_0xa8a3f6[_0x5b0eed(0x581,0x539,0x55f,0x591)+_0x5b0eed(0x51e,0x5f7,0x58e,0x59c)](_0x5b0eed(0x46c,0x443,0x545,0x4b9)+_0x5b0eed(0x547,0x553,0x5e4,0x58f)+_0x5b0eed(0x5e6,0x593,0x589,0x574));_0xb588bf[_0x5b0eed(0x579,0x611,0x503,0x58a)]&&_0xb588bf[_0x30ae82(0x3f8,0x379,0x3c0,0x373)]['startsWith'](_0x5b0eed(0x4f1,0x4de,0x53d,0x4dc))&&_0x29542b[_0x30ae82(0x21a,0x2b1,0x2a9,0x293)](_0xb588bf[_0x30ae82(0x2fe,0x354,0x312,0x373)],_0x427111)&&_0x183852[_0x5b0eed(0x57b,0x5b5,0x502,0x565)+_0x5b0eed(0x5b0,0x526,0x533,0x550)](_0xb588bf[_0x5b0eed(0x533,0x56a,0x58b,0x58a)]),_0x2c55f9?(_0xb588bf['src']=_0x574d9d,_0xb588bf[_0x5b0eed(0x53f,0x4d4,0x47e,0x4d8)][_0x5b0eed(0x53d,0x551,0x53f,0x4cb)]=_0x30ae82(0x37b,0x402,0x400,0x389),_0x469485[_0x5b0eed(0x45d,0x48c,0x490,0x4d8)][_0x5b0eed(0x472,0x549,0x44e,0x4cb)]=_0x29542b[_0x5b0eed(0x53c,0x5b3,0x587,0x566)],_0x234b68['style'][_0x5b0eed(0x54c,0x531,0x44b,0x4cb)]=_0x29542b['FFbxy']):(_0xb588bf[_0x30ae82(0x3e4,0x33c,0x319,0x373)]='',_0xb588bf['style']['display']=_0x29542b[_0x5b0eed(0x5bb,0x4ff,0x5bf,0x566)],_0x469485[_0x5b0eed(0x49a,0x4bf,0x487,0x4d8)][_0x30ae82(0x2ab,0x23d,0x336,0x2b4)]=_0x29542b[_0x30ae82(0x2f5,0x35b,0x3e0,0x36c)],_0x234b68[_0x30ae82(0x33d,0x2fc,0x272,0x2c1)][_0x5b0eed(0x442,0x456,0x556,0x4cb)]=_0x29542b[_0x30ae82(0x351,0x316,0x335,0x34f)],_0x5f6044[_0x5b0eed(0x557,0x4e6,0x452,0x4cf)+_0x5b0eed(0x506,0x4e1,0x48e,0x4df)]=null,_0x1d4534=null);}}),_0x150050[_0x13a3b9(-0x70,-0x7d,-0xef,-0xa3)]('#novelai-s'+'elect-char'+_0x1485d8(-0x156,-0xf0,-0x18b,-0x10c)+_0x1485d8(-0x4c,-0xae,0x14,-0x6b))['on'](_0x13a3b9(-0xe4,-0x15d,-0x1c3,-0x14b),()=>{function _0x1ef4ae(_0x1c19cc,_0x132613,_0x3638e0,_0x230781){return _0x1485d8(_0x1c19cc-0xae,_0x132613-0x43,_0x3638e0,_0x230781-0x6a0);}function _0x5ebc69(_0x3bd12b,_0x4e7df7,_0x338572,_0x47a3ea){return _0x13a3b9(_0x3bd12b-0x4f,_0x47a3ea,_0x338572-0x15d,_0x338572-0x414);}document[_0x5ebc69(0x322,0x335,0x389,0x355)+_0x1ef4ae(0x669,0x61c,0x68c,0x65d)](_0x419e7c[_0x5ebc69(0x302,0x2f7,0x329,0x2ce)])[_0x5ebc69(0x26e,0x27d,0x2c9,0x2ac)]();});function _0x13a3b9(_0x49ac10,_0x47d0b5,_0x5ab0e1,_0x2f2f59){return _0x59b12a(_0x47d0b5,_0x47d0b5-0x190,_0x5ab0e1-0x78,_0x2f2f59- -0xe7);}function _0x1485d8(_0x3ee3ca,_0x364813,_0x5f1960,_0x3ea031){return _0x2bd780(_0x5f1960,_0x364813-0x89,_0x5f1960-0xb6,_0x3ea031- -0x1e1);}_0x150050[_0x13a3b9(-0x82,-0x108,-0xe3,-0xa3)](_0x13a3b9(-0xc4,-0x12d,-0xc0,-0xb0)+'t_nai_char'+_0x13a3b9(-0x118,-0x109,-0x8b,-0x101))['on'](_0x1485d8(-0xc7,-0xa8,-0x39,-0x5f),handleNovelaiCharRefImageUpload),_0x150050['find'](_0x419e7c['RuXYh'])['on'](_0x419e7c[_0x13a3b9(-0x133,-0x10f,-0x1b5,-0x14f)],()=>{removeNovelaiCharRefImage();}),_0x150050['find'](_0x419e7c['mZpit'])['on'](_0x419e7c[_0x13a3b9(-0xe2,-0x142,-0x118,-0x14f)],()=>{function _0x2bc965(_0x3a2bad,_0x3fa8be,_0xc801b,_0x332dd7){return _0x13a3b9(_0x3a2bad-0x100,_0x3fa8be,_0xc801b-0x143,_0xc801b-0x51);}function _0x165eab(_0x2f3c0d,_0x48df46,_0x2f7bc8,_0xaad0ad){return _0x1485d8(_0x2f3c0d-0xa3,_0x48df46-0xd2,_0x48df46,_0x2f3c0d- -0x83);}const _0x42e318={};_0x42e318[_0x2bc965(-0xe6,-0x11a,-0x118,-0xdb)]='Error\x20load'+_0x2bc965(-0x163,-0x18f,-0x123,-0x164)+'\x20NovelAI\x20V'+_0x165eab(-0x1a0,-0x157,-0x187,-0x1da);const _0x93189=_0x42e318;_0x419e7c[_0x165eab(-0x152,-0x177,-0x138,-0xec)](_0x419e7c['Ercoi'],_0x2bc965(-0xfc,-0x127,-0x133,-0x1a6))?_0x1af1e2[_0x165eab(-0x177,-0x16a,-0x175,-0x1b6)](_0x93189[_0x2bc965(-0x193,-0x90,-0x118,-0x93)],_0x3c8c6d):document[_0x165eab(-0xd1,-0x10c,-0x5c,-0x99)+'ById'](_0x419e7c[_0x2bc965(-0x10e,-0x148,-0xc4,-0x11d)])[_0x165eab(-0x191,-0x111,-0x120,-0x138)]();}),_0x150050['find'](_0x419e7c[_0x13a3b9(-0x187,-0x1e0,-0x1b9,-0x155)])['on'](_0x419e7c[_0x13a3b9(-0x10e,-0x1ad,-0x18a,-0x13a)],handleImageUpload2),_0x150050['find'](_0x419e7c[_0x13a3b9(-0xb5,-0x9f,-0xd1,-0xf4)])['on'](_0x1485d8(-0x158,-0x187,-0xf9,-0x10e),()=>{function _0x5e15e1(_0x1d5b78,_0x432b86,_0x266536,_0x512dfb){return _0x1485d8(_0x1d5b78-0x7,_0x432b86-0x81,_0x266536,_0x512dfb-0x442);}function _0x46ab7e(_0x5a9d60,_0xc06af0,_0x565c17,_0xd783cd){return _0x13a3b9(_0x5a9d60-0x1d9,_0x5a9d60,_0x565c17-0x67,_0xc06af0-0x326);}if(_0x419e7c['DJqQf'](_0x419e7c['qMoTC'],_0x5e15e1(0x31d,0x318,0x399,0x335)))_0x419e7c[_0x46ab7e(0x2d2,0x24f,0x263,0x1e7)](removeComfyUIImage);else{const _0x3bb98c=_0x19551e?function(){function _0x58228a(_0x109d23,_0x366d5b,_0x54fc76,_0x3346b8){return _0x5e15e1(_0x109d23-0x1ab,_0x366d5b-0x139,_0x3346b8,_0x366d5b- -0x2c5);}if(_0x212bc5){const _0x14ecee=_0x5bbd0e[_0x58228a(0x157,0x140,0x1b6,0x188)](_0x182821,arguments);return _0x20e49d=null,_0x14ecee;}}:function(){};return _0x21ae7f=![],_0x3bb98c;}});}export{updateNovelaiImagePreview,updateNovelaiCharRefImagePreview,updateComfyUIImagePreview,nai3VibeTransferImageMimeType,nai3CharRefImageMimeType,comfyuiImageObjectURL};