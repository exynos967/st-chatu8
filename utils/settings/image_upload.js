(function(_0x11f1c2,_0x313230){function _0x164af7(_0x145169,_0x40c9a7,_0x1c74ce,_0x157d49){return _0x3c9d(_0x157d49-0x274,_0x1c74ce);}const _0x3ea96a=_0x11f1c2();function _0x5ec8df(_0x25c290,_0x33d619,_0x8ac363,_0x4a6a18){return _0x3c9d(_0x8ac363-0x159,_0x33d619);}while(!![]){try{const _0x5adc81=-parseInt(_0x164af7(0x3b7,0x360,0x3cd,0x3cf))/(0x1e4d+0x1d*0x133+-0x4113)+-parseInt(_0x164af7(0x3dc,0x412,0x493,0x427))/(0x88d+-0x5*0x573+-0x2a*-0x72)*(parseInt(_0x5ec8df(0x2c2,0x2d9,0x2c5,0x2c4))/(-0xcc8+-0x2*0xb44+0x2353*0x1))+parseInt(_0x5ec8df(0x288,0x2ba,0x282,0x2c1))/(-0x143+-0x130c+-0x1d9*-0xb)+-parseInt(_0x164af7(0x4b7,0x4dd,0x4dd,0x48b))/(0x1201+0x1be9+0x2de5*-0x1)*(-parseInt(_0x5ec8df(0x2df,0x34b,0x335,0x317))/(0x14a1*0x1+-0x6c*0x1+-0x142f))+-parseInt(_0x164af7(0x411,0x3e5,0x37d,0x3cb))/(0x2a1*-0x1+-0x15fe*-0x1+-0x63*0x32)*(parseInt(_0x5ec8df(0x2b0,0x281,0x2a9,0x2d6))/(-0x11+0x1235+-0x4*0x487))+parseInt(_0x164af7(0x42b,0x3bf,0x3fb,0x3d2))/(0x1*-0x64d+-0x13e9+0x1a3f)+-parseInt(_0x164af7(0x444,0x43c,0x46c,0x3f7))/(0x260e*0x1+-0x16*0x181+0x4ee*-0x1)*(-parseInt(_0x164af7(0x38e,0x3d6,0x352,0x3ae))/(-0x152f+-0x1d60+0x329a));if(_0x5adc81===_0x313230)break;else _0x3ea96a['push'](_0x3ea96a['shift']());}catch(_0x221e1e){_0x3ea96a['push'](_0x3ea96a['shift']());}}}(_0x2add,-0xb3461+0x7a4a1+0x1*0xc7ca3));const _0x516e6e=(function(){let _0x5948e0=!![];return function(_0x15655f,_0x26c061){const _0x52e268=_0x5948e0?function(){function _0x5ca82c(_0x393c80,_0x4a4d65,_0x8aaa51,_0x3cd877){return _0x3c9d(_0x4a4d65-0x3d1,_0x393c80);}if(_0x26c061){const _0x424e42=_0x26c061[_0x5ca82c(0x4dc,0x4f7,0x524,0x4b4)](_0x15655f,arguments);return _0x26c061=null,_0x424e42;}}:function(){};return _0x5948e0=![],_0x52e268;};}()),_0x1d75ee=_0x516e6e(this,function(){const _0x476dfe={};_0x476dfe['ogbYZ']='(((.+)+)+)'+'+$';function _0x4074be(_0x24f043,_0x22ffa8,_0x2c78d6,_0x32ea4d){return _0x3c9d(_0x24f043-0x25e,_0x22ffa8);}function _0x50cec0(_0x23e4de,_0x13ae8b,_0xb2c8bb,_0x401091){return _0x3c9d(_0x401091-0x3b8,_0x13ae8b);}const _0x3cd021=_0x476dfe;return _0x1d75ee[_0x50cec0(0x54a,0x549,0x512,0x584)]()['search'](_0x3cd021[_0x50cec0(0x520,0x520,0x4e8,0x56d)])[_0x4074be(0x42a,0x440,0x3e1,0x442)]()[_0x4074be(0x397,0x33e,0x3dc,0x41a)+'r'](_0x1d75ee)[_0x4074be(0x436,0x425,0x4a3,0x3bf)](_0x4074be(0x43c,0x46c,0x49b,0x447)+'+$');});_0x1d75ee();function _0x2add(){const _0x5738fc=['yMXVy2S','Aw5NignHy2HLza','wLfxzhy','EvzhCKy','Df9UB3zLBgfP','y29TzNL1AwnHBG','wNDtwhC','tKLyuMq','BLLnALe','DK1uu3e','wgDzuLi','wwXSuuG','BMfTzq','Bu1hy1y','CM1HDc4','vhz3tMq','mxWZFdr8mNWW','y2fJAgvFBM92zq','qwjJz2G','ve1AD2C','CIaUC3qTy2HHDa','yvjJDhC','vuNLM77NIyC6ia','i2nVBwz5DwKTCG','ANnVBG','zxnZAw5Nie5VDG','DKXcCuG','q3DZz2m','AgfYlxjLzI1PBq','Dhu4lwLTywDLlq','Bw92zs1JAgfYlq','yM9KEq','y3rvuKW','5zUE5PwW5O2UoG','sM9nCxm','s3rPuey','ywDLoG','zs1IDg4','DuTIDNK','Ew9mug0','zxiGlNn0lwnOyq','mxWYFdr8nxWZFa','zgf0ytPPBwfNzq','zMXLEa','zgLorwK','AfbYvwW','mty3ndGXmgjHs3fqEG','sKDQufy','zLfeC2S','Bw92zs1PBwfNzq','C2vYDMvYrMLSzq','sM9nq0y','DerhCvO','CMvHzefZrgf0yq','AhrSBwq','s0zXy2e','tMjnsxa','r29bBwm','Aw1Hz2vjBNb1Da','i25VDMvSywKTCW','Cw5QDLO','C3rYAw5NAwz5','C3rVCMvszwfKtW','ignHy2HLihrVia','i2nVBwz5DwKTAq','wNrSAg4','EhPeBei','DtGTAw1Hz2uTCa','zfLLshe','yMXVyG','rxjYB3iGBg9Hza','z2vFBM92zwXHAq','Dgv4Da','uvrKzMG','A2fVDhvWAwfU','Aw1Hz2uVCg5N','r1nZz0S','yxL2rKq','yxbWBhK','y0nkt1y','lxjLzI1PBwfNzq','mJaWmJuXmNLuv1r1zW','BwfNztO','z3HoBNy','rMnXuhO','lwj0BG','CgnTyuK','tg9HzgvKienVBq','ywDLlxbYzxzPzq','5zU+54Mh5lIk5lYG5OIq5yQFlcdMNi3LIQe','C3rVCMvezwXLDa','tMfTzq','ienVBwz5vuKGAq','zgf0yq','C3DLyve','q3Hir08','5lUo57Yt5A2y5yQG6l29q29TzNK','y29UC3rYDwn0BW','mtfRu0Tyv0m','zxjYB3i','rxjYB3iGChjVyW','rKvrvwy','Cu1dsKe','Bg9N','C3bSAxq','r2jer3C','5zU+54Mh5Ase55cg5AsX6lsLoIa','5zU+54Mh5Ase55cg5OIw5lIk5lYG5PE25yE66zsz','CMfUC2zLCL9PBq','s1L2sve','i25VDMvSywKTAq','wxzVAuG','x3jLzG','Bwv0Ag9K','De5qvgC','quXkv1a','y3jLyxrLt2jQzq','DNrRCMq','ruPVCeK','6zsz6k+V6k+M5OofoG','mZa0D0jQA1fu','x25VDMvSywK','zKP1teS','BMX5','CMvMlwLTywDLlq','BfbItMe','6k+M5OofoIa','ndmXmJDUywrbuMy','DhHOsey','DgHLig5LDYbMBW','DeXgAxG','odqWnZq0rxLwrvLz','rKLfAgW','AgfYifjLzIbPBq','mtG0odi1oeXSC3r5vG','y2XPy2S','DY1JB250ywLUzq','ChPnuKC','Dg9Y','yvzOrwW','yxqUifbSzwfZzq','rgnWB3q','CL9Yzwy','zNLvssbPBwfNzq','C0TMCe8','BM9Uzq','qND1u0G','ChjLDMLLD0LTyq','mtm1ouXTALLquG','BwfNzs1WCMv2Aq','zwXLy3qTAw1HzW','Df9UywLFy2HHCG','sKz6rgu','seHcEhm','r29XyLC','u3LWugK','s1HPA0y','zMLSzxm','rvL1zLu','i2LTywDLsw5WDq','t21yC2y','z2fHvxy','q0zNvMm','CMvMigLTywDLoG','z2vFBMfPx2nOyq','zwzFAw1Hz2u','yNrU','Aw5SAw5LlwzSzq','yMXVyJO','BgfPx2nOyxjFCG','q2nIsLC','mZCZmdbsA1LQzuC','i25VDMvSywKTyW','wxbfwKS','y2fJAguGzM9YBq','wMjpuMq','vvjm','BM92zwXHAs1Yzq','sLruyKS','wKL2A0S','C3rHCNrZv2L0Aa','C3jJ','5zU+54Mh5lIk5lYG5AsX6lsLlcdPLjNOR68','DK9nC0W','sNnLuLq','5lIk5lYG5OIq5yQFlcdMNi3LIQhLMAJOV5q','suzHAhi','DNnguMe','rLzYuKq','q2TZrhG','uujWwxC','yMzxue4','C3r5Bgu','uLbnCxq','ywDL','D3v4A0W','zMLUza','i25VDMvSywKTCG','5lIk5lYG5AsX6lsLoIa','ELHUD2u','C0rmvxm','AwjLigLTywDLoG','vMruzNe','i2nVBwz5DwKTCW','D3neB0m','ihrVihvWzgf0zq','zgLZCgXHEq','yw5ZzMvYsw1HzW','CxvLCNLtzwXLyW','D3j4wxm','vxzMA0S','BgfPx3zPyMvFDa','wgv1sKW','BMDxC2S','C3rVCMvszwfKvW','z2v0rwXLBwvUDa','whjyExy','s2nPEg4','x25HAv9JAgfYxW','mJqYCLLzA1ro','Aw1MDwW','B2DIwvO','yK1eCfa','z2uY','r0TXwK4','AwjLufy','zwXLy3qTy2HHCG','vhHzrw8','uMveD00','txHOshy','uvbPDue','wwj5Eue','B25SB2fKzw5K','Ew1lvfa','u3PJveu','ExvPx3jLzL9PBq','BMfPm1zPyMvuCG','vvDOsKS','s3ntzvm','BgfJzwHVBgrLCG','wMP6t0C','CML0zq','B2HjuLK','vgPTDe4','Dg9tDhjPBMC','CgXHy2vOB2XKzq','sevVvwG','DgfYz2v0','rfzyrvK','z3v0qLG','u2Xkree','qNLjza','CwnfBgm','BwvZC2fNzq','zw1VDMuTy2HHCG','zxPbq1e','C2vHCMnO','zw1VDMuTAw1HzW','uvfYAw4','vhzdAwm','mtHwyLLhEgG','v2D0veK','kcGOlISPkYKRkq','rePVshO','nhWWFdn8mNWX','igzYB20GB2XKia','Duj0A0i','y2HHBMDL','zxCTy29UDgfPBG','zKLTywDL','CMv2B2TLt2jQzq','BMfPm0nOyxjszq','5zMO6l+u5zUE5PwW5O2UoIa'];_0x2add=function(){return _0x5738fc;};return _0x2add();}import{extension_settings}from'../../../../../extensions.js';import{saveSettingsDebounced}from'../../../../../../script.js';function _0x496e5d(_0x520e97,_0x26948c,_0x2cb2fd,_0x19c31e){return _0x3c9d(_0x26948c-0x256,_0x2cb2fd);}import{extensionName}from'../config.js';import{processUploadedImage,processUploadedImageToBlob,addLog}from'../utils.js';import{dbs}from'../database.js';const NAI_VIBE_CACHE_KEY=_0x3b3710(0x4b6,0x43e,0x422,0x3de)+_0x3b3710(0x41c,0x3ef,0x417,0x3f6)+_0x3b3710(0x357,0x388,0x353,0x3f6)+_0x3b3710(0x402,0x3de,0x37e,0x3a9),NAI_CHAR_REF_CACHE_KEY='cache_nove'+_0x3b3710(0x34e,0x3c5,0x377,0x3f0)+_0x496e5d(0x398,0x3d3,0x38a,0x350),COMFYUI_REF_CACHE_KEY='cache_comf'+_0x496e5d(0x3d5,0x419,0x463,0x488)+'age';let nai3VibeTransferImageMimeType=_0x3b3710(0x38c,0x367,0x396,0x397);function _0x3b3710(_0xab37d1,_0x15ad88,_0x48bb4e,_0x32910e){return _0x3c9d(_0x15ad88-0x244,_0x48bb4e);}let nai3CharRefImageMimeType=_0x3b3710(0x314,0x367,0x393,0x387),comfyuiImageObjectURL=null;function updateNovelaiImagePreview(_0x49d87d){const _0x237c6c={};_0x237c6c[_0x5c22d3(0x37d,0x2d4,0x33b,0x352)]=_0x304458(0x259,0x23a,0x206,0x27e)+'x';function _0x304458(_0x1e2a77,_0x312e7b,_0x21a522,_0x2590d5){return _0x3b3710(_0x1e2a77-0x1f4,_0x312e7b- -0x189,_0x1e2a77,_0x2590d5-0x19d);}_0x237c6c[_0x5c22d3(0x2ef,0x2bc,0x2cf,0x2f3)]='previewIma'+_0x304458(0x205,0x1da,0x16d,0x223),_0x237c6c[_0x304458(0x259,0x250,0x2d9,0x2a8)]=_0x304458(0x202,0x201,0x18e,0x1d9)+_0x5c22d3(0x24f,0x2bf,0x29d,0x21c)+_0x304458(0x2dc,0x29f,0x30b,0x25c)+_0x304458(0x2ea,0x2cc,0x2f5,0x2a5)+_0x304458(0x2c4,0x2c1,0x30b,0x2e2)+_0x304458(0x2c3,0x288,0x27b,0x2b1)+'r',_0x237c6c[_0x304458(0x22d,0x1dc,0x1db,0x23d)]=_0x304458(0x276,0x244,0x272,0x207)+_0x5c22d3(0x3a0,0x2f5,0x34a,0x38f)+'-btn',_0x237c6c[_0x304458(0x22e,0x25d,0x1f1,0x239)]=_0x304458(0x263,0x2ce,0x344,0x295),_0x237c6c[_0x304458(0x253,0x28f,0x213,0x2c2)]='none',_0x237c6c[_0x304458(0x2d0,0x268,0x2b7,0x2d5)]=function(_0x3700be,_0x1c4f33){return _0x3700be===_0x1c4f33;},_0x237c6c[_0x5c22d3(0x25a,0x268,0x2c2,0x349)]=_0x304458(0x259,0x231,0x1ca,0x26e),_0x237c6c[_0x5c22d3(0x258,0x23d,0x293,0x2a5)]='EVYnK';function _0x5c22d3(_0x5ecbb9,_0x23d68b,_0x3e0740,_0x4245bc){return _0x496e5d(_0x5ecbb9-0x152,_0x3e0740- -0x126,_0x5ecbb9,_0x4245bc-0x120);}const _0x362433=_0x237c6c,_0x20fa10=document[_0x304458(0x2ec,0x26a,0x29d,0x1f1)+'ById'](_0x362433['zXnwe']),_0x4abef1=document[_0x304458(0x284,0x263,0x26c,0x22e)+_0x5c22d3(0x319,0x20b,0x292,0x21e)](_0x362433[_0x304458(0x20d,0x250,0x2a6,0x269)]),_0x36f94b=document['getElement'+_0x5c22d3(0x292,0x293,0x303,0x347)](_0x362433[_0x5c22d3(0x2aa,0x1fe,0x251,0x27f)]);if(_0x49d87d&&_0x49d87d['startsWith'](_0x362433['VdTfq'])){_0x20fa10['src']=_0x49d87d,_0x20fa10[_0x304458(0x1e8,0x253,0x248,0x272)][_0x304458(0x217,0x261,0x2bb,0x207)]=_0x5c22d3(0x35c,0x292,0x319,0x309),_0x4abef1[_0x5c22d3(0x253,0x2d6,0x2c8,0x2a6)]['display']=_0x362433[_0x304458(0x27a,0x28f,0x215,0x27c)],_0x36f94b[_0x304458(0x29d,0x253,0x2c5,0x2ba)][_0x304458(0x293,0x261,0x1d9,0x23e)]=_0x362433[_0x5c22d3(0x37f,0x344,0x33b,0x35f)];const _0x23d6cc=_0x49d87d[_0x5c22d3(0x2e0,0x2a6,0x270,0x245)](','),_0xdd6867=_0x23d6cc[0x1*0xff7+0x17b1+-0x27a8][_0x5c22d3(0x2d7,0x2d4,0x270,0x254)](':')[0x1160+0xd*0x9a+-0x1931*0x1][_0x5c22d3(0x283,0x261,0x270,0x2c4)](';')[-0xf0b+0x4*0x2d8+0x3ab];nai3VibeTransferImageMimeType=_0xdd6867,window[_0x304458(0x2ee,0x27f,0x280,0x22d)+_0x304458(0x21d,0x262,0x2ae,0x278)+'e']=_0x23d6cc[0x1*0x4c1+0xd50+-0x1210];const _0x5cab04={};_0x5cab04['id']=NAI_VIBE_CACHE_KEY,_0x5cab04[_0x5c22d3(0x2d6,0x208,0x265,0x2a4)]=_0x49d87d,dbs[_0x304458(0x258,0x269,0x279,0x223)+'rite'](_0x5cab04);}else{if(_0x362433[_0x5c22d3(0x277,0x263,0x2dd,0x2a0)](_0x362433[_0x304458(0x220,0x24d,0x26b,0x205)],_0x362433['aVhEl'])){_0x580e31[_0x5c22d3(0x2c9,0x2bb,0x2bd,0x294)]=_0x5853f1,_0x5d2c7c['style'][_0x5c22d3(0x28a,0x2a6,0x2d6,0x2a6)]=_0x5c22d3(0x361,0x332,0x319,0x2f9),_0x13729b[_0x5c22d3(0x281,0x2e5,0x2c8,0x2e2)][_0x5c22d3(0x302,0x2d2,0x2d6,0x268)]='none',_0x217f19[_0x304458(0x1ee,0x253,0x1e6,0x2bb)][_0x304458(0x2d8,0x261,0x229,0x260)]=_0x362433['JoMqs'];const _0x486d07=_0x126d1e['split'](','),_0x5efb35=_0x486d07[-0x813+0x24eb*-0x1+-0x376*-0xd]['split'](':')[0x1*0xa75+0x1d*0xb+-0xbb3][_0x304458(0x277,0x1fb,0x224,0x1bc)](';')[0x1b7a*0x1+0x338+-0x1eb2];_0x5393d5=_0x5efb35,_0x44c4eb[_0x5c22d3(0x33b,0x298,0x317,0x3a0)+_0x5c22d3(0x2f9,0x303,0x315,0x347)]=_0x486d07[0x2cc*0x1+-0xb9f+0x8d4];const _0x3a828a={};_0x3a828a['id']=_0x5ba50c,_0x3a828a[_0x304458(0x18f,0x1f0,0x258,0x1af)]=_0x138eed,_0x549b96[_0x5c22d3(0x2a0,0x33e,0x2de,0x2ec)+'rite'](_0x3a828a);}else _0x20fa10['src']='',_0x20fa10[_0x304458(0x229,0x253,0x219,0x251)]['display']=_0x5c22d3(0x22e,0x2cc,0x299,0x2d1),_0x4abef1[_0x5c22d3(0x32e,0x2ad,0x2c8,0x331)][_0x5c22d3(0x33a,0x2e6,0x2d6,0x279)]='flex',_0x36f94b[_0x5c22d3(0x293,0x2ad,0x2c8,0x2ab)]['display']='none',window[_0x5c22d3(0x2c0,0x362,0x2f4,0x369)+'ansferImag'+'e']=null;}}function removeNovelaiImage(){const _0x2fd352={'pdBQl':function(_0xa3ce8d,_0x597ca7){return _0xa3ce8d(_0x597ca7);}};_0x2fd352['pdBQl'](updateNovelaiImagePreview,null),dbs['storeDelet'+'e'](NAI_VIBE_CACHE_KEY);}async function handleNovelaiImageUpload(_0x207218){const _0xc7ae63={'wsDoC':_0x103ad4(0x22d,0x277,0x1ed,0x29e)+'+$','bMDpP':_0x103ad4(0x238,0x2ba,0x1d8,0x231),'QQrin':_0x5e0092(0x3c1,0x444,0x3ea,0x411),'qnjvZ':_0x5e0092(0x42a,0x42a,0x434,0x45b),'gaZer':function(_0x3a54c4,_0x1fc7e0,_0x481b19){return _0x3a54c4(_0x1fc7e0,_0x481b19);},'nzCYf':function(_0x145978,_0x2b1176){return _0x145978(_0x2b1176);},'gxNnv':function(_0x21299c,_0xbba3b8){return _0x21299c!==_0xbba3b8;},'YvoiH':_0x5e0092(0x3e7,0x457,0x40f,0x382),'TjmtN':_0x5e0092(0x43a,0x41a,0x49f,0x425),'DJoHz':'Error\x20proc'+_0x5e0092(0x45a,0x4b6,0x473,0x3ee)+'elAI\x20image'+':','Kcixn':function(_0x537cb4,_0xf91ea2){return _0x537cb4(_0xf91ea2);},'nYMjQ':function(_0xc279b8,_0x1ec71d){return _0xc279b8+_0x1ec71d;},'ibePV':_0x103ad4(0x191,0x1a3,0x1de,0x18a)},_0x33ce8d=_0x207218[_0x103ad4(0x21e,0x20a,0x23b,0x251)][_0x5e0092(0x3cd,0x3c2,0x422,0x3e5)][0x1b63+0x1e15+0x265*-0x18];if(!_0x33ce8d)return;function _0x5e0092(_0x21290a,_0x3d4f6e,_0x3689cd,_0x1938aa){return _0x496e5d(_0x21290a-0x17b,_0x21290a-0x2,_0x3689cd,_0x1938aa-0x4d);}function _0x103ad4(_0x3a17e8,_0xead454,_0x2aee5c,_0x500f1d){return _0x3b3710(_0x3a17e8-0xa4,_0x3a17e8- -0x1f5,_0x500f1d,_0x500f1d-0xb7);}try{if(_0xc7ae63[_0x103ad4(0x163,0x1bd,0xfc,0x17f)]===_0xc7ae63[_0x5e0092(0x36c,0x375,0x37b,0x369)]){const _0x337576=await _0xc7ae63['gaZer'](processUploadedImage,_0x33ce8d,!![]);_0xc7ae63['nzCYf'](updateNovelaiImagePreview,_0x337576);}else return _0x3ebe6d[_0x103ad4(0x21b,0x1a2,0x285,0x1ac)]()['search'](FRXwsb['wsDoC'])[_0x103ad4(0x21b,0x273,0x282,0x257)]()[_0x5e0092(0x391,0x415,0x3fc,0x3ca)+'r'](_0x5916ad)[_0x103ad4(0x227,0x1fc,0x216,0x228)](FRXwsb[_0x5e0092(0x3fc,0x378,0x378,0x42c)]);}catch(_0x3b294f){_0xc7ae63[_0x103ad4(0x17a,0x182,0x150,0x1f6)](_0xc7ae63[_0x103ad4(0x196,0x21d,0x1e8,0x19e)],_0xc7ae63[_0x103ad4(0x21a,0x197,0x206,0x28a)])?(console['error'](_0xc7ae63[_0x5e0092(0x437,0x3c2,0x45f,0x3bc)],_0x3b294f),_0xc7ae63[_0x103ad4(0x200,0x26b,0x23b,0x202)](alert,_0xc7ae63[_0x103ad4(0x240,0x28b,0x219,0x282)](_0xc7ae63[_0x103ad4(0x208,0x237,0x218,0x1d4)],_0x3b294f[_0x5e0092(0x42d,0x3bd,0x478,0x3b4)]))):(_0x1d23a5[_0x103ad4(0x1dc,0x180,0x1f5,0x16a)]=_0x3b8cd0,_0x5b3cab[_0x103ad4(0x1e7,0x1bd,0x247,0x1d5)][_0x103ad4(0x1f5,0x1f0,0x1e4,0x17e)]=_0xc7ae63[_0x103ad4(0x205,0x232,0x24c,0x275)],_0x1a2e98[_0x103ad4(0x1e7,0x24e,0x1be,0x21c)]['display']=_0xc7ae63[_0x5e0092(0x432,0x3e5,0x475,0x482)],_0x3063a7[_0x103ad4(0x1e7,0x189,0x1ae,0x202)]['display']=_0x5e0092(0x3d7,0x454,0x44d,0x3a9)+'x');}}function updateNovelaiCharRefImagePreview(_0x25b16b){const _0x2d5d1a={};_0x2d5d1a[_0x4b6ba0(0x31,0x3e,0x4c,0xbd)]=_0x4b6ba0(-0x52,-0x5a,-0x71,-0xe0)+_0x382faa(0xa0,0x56,0x72,0x56)+_0x4b6ba0(-0x76,-0x6,-0x5b,-0xb8)+'mage:',_0x2d5d1a[_0x382faa(0x107,0xeb,0x86,0x74)]='previewIma'+_0x4b6ba0(-0x86,0x40,-0x13,-0x19)+_0x4b6ba0(0x44,-0x1e,-0x29,-0x7f),_0x2d5d1a['sweaQ']=_0x4b6ba0(0x13,-0x5c,-0xb,-0x62)+_0x382faa(0x6a,0x22,0x8d,0xf)+_0x4b6ba0(-0x8e,-0x4b,-0x5f,-0x7)+_0x4b6ba0(-0x33,-0x9c,-0x2f,-0x8c)+_0x382faa(0xd8,0xf4,0x85,0x4c)+_0x382faa(-0x5a,0x21,-0x5d,-0x5)+_0x382faa(-0xa,0x45,0x4f,0x3c);function _0x4b6ba0(_0x5cb1c7,_0x3e8e78,_0x544349,_0xee1bf7){return _0x3b3710(_0x5cb1c7-0x90,_0x544349- -0x3d3,_0x5cb1c7,_0xee1bf7-0x173);}_0x2d5d1a[_0x4b6ba0(0x14,0x67,0xa,0x84)]=_0x382faa(0x7b,0x8f,0x11,0x38)+_0x382faa(0xeb,0xa6,0x8f,0xe5)+_0x4b6ba0(-0x9b,0x10,-0x3b,0x30)+'btn',_0x2d5d1a[_0x4b6ba0(-0xa,-0x19,0x4,0x45)]=_0x4b6ba0(0xf,0x4e,0x84,0x108);function _0x382faa(_0x3f0d84,_0x108848,_0x5c758c,_0x2d3238){return _0x3b3710(_0x3f0d84-0x52,_0x5c758c- -0x3bc,_0x108848,_0x2d3238-0xb5);}_0x2d5d1a[_0x382faa(0xcf,0x9e,0x7e,0x84)]=_0x382faa(0x19,0x42,0x71,0x1d),_0x2d5d1a[_0x382faa(-0x24,0x62,-0x10,0x22)]=_0x4b6ba0(-0x1a,0x48,-0x26,0x4c),_0x2d5d1a[_0x4b6ba0(-0x87,-0xc,-0xa,-0x1b)]=_0x382faa(0x50,-0x3e,0x7,0x70)+'x',_0x2d5d1a[_0x382faa(0xbd,0x35,0x4e,-0x1e)]='UHjKq',_0x2d5d1a[_0x382faa(0x10e,0x29,0x8c,0x7f)]=_0x4b6ba0(0x82,0x27,0x6a,-0xa);const _0x25c2c9=_0x2d5d1a,_0x2ea2e5=document['getElement'+_0x382faa(0x52,0x24,0x5b,0xad)](_0x25c2c9[_0x4b6ba0(0xb5,0x5d,0x6f,0xbe)]),_0x58c74f=document[_0x382faa(-0x44,0x53,0x30,-0x59)+_0x4b6ba0(-0x71,0x3b,-0x2d,-0x15)](_0x25c2c9[_0x4b6ba0(0x7,-0xc2,-0x59,0x6)]),_0x1d0769=document[_0x382faa(0x52,-0x2c,0x37,-0x28)+_0x4b6ba0(0x64,0xb,0x44,0x99)](_0x25c2c9[_0x382faa(0x49,0x99,0x21,0x35)]);if(_0x25b16b&&_0x25b16b['startsWith'](_0x25c2c9[_0x382faa(0x84,-0x63,0x1b,-0x38)])){_0x2ea2e5['src']=_0x25b16b,_0x2ea2e5[_0x382faa(0x24,0x1b,0x20,-0x9)][_0x382faa(-0x32,0x1b,0x2e,-0x15)]=_0x25c2c9[_0x4b6ba0(0xdf,0x31,0x67,-0xe)],_0x58c74f[_0x4b6ba0(-0x61,0x4e,0x9,0x7b)][_0x382faa(-0x23,-0x17,0x2e,0x5f)]=_0x25c2c9[_0x382faa(0x18,-0x19,-0x10,0x4c)],_0x1d0769[_0x4b6ba0(-0x35,-0x1c,0x9,-0x76)]['display']=_0x25c2c9['YpEZK'];const _0x477fee=_0x25b16b[_0x382faa(-0x16,-0x97,-0x38,-0xb5)](','),_0x38ff94=_0x477fee[0x2b2+0x1d69*0x1+-0x201b]['split'](':')[0x3*0x99e+0x1f6*-0x7+-0xf1f][_0x382faa(-0x6c,-0xb8,-0x38,0x17)](';')[-0x14bf+-0x1ba3*0x1+0x1831*0x2];nai3CharRefImageMimeType=_0x38ff94,window[_0x382faa(0xef,0x7d,0x6f,-0x13)+_0x382faa(0x34,0x71,0x6d,0x77)]=_0x477fee[0x7f0+-0xd*0x15d+0x9ca];const _0x3cf734={};_0x3cf734['id']=NAI_CHAR_REF_CACHE_KEY,_0x3cf734[_0x382faa(0x2a,-0x27,-0x43,0x3b)]=_0x25b16b,dbs[_0x4b6ba0(0x7,-0x14,0x1f,0xa4)+_0x4b6ba0(-0x15,0x91,0x3a,0x94)](_0x3cf734);}else{if(_0x25c2c9[_0x4b6ba0(-0x22,0x67,0x37,-0x41)]==='UHjKq'){const _0x29d05a=_0x25c2c9[_0x382faa(0x7d,0x8a,0x8c,0xe6)][_0x382faa(-0xc,0x1d,-0x38,0x9)]('|');let _0x56a14e=0xc19*-0x2+0x1681+0x1b1*0x1;while(!![]){switch(_0x29d05a[_0x56a14e++]){case'0':window['nai3CharRe'+_0x382faa(0xe,0x73,0x6d,0xb2)]=null;continue;case'1':_0x2ea2e5[_0x382faa(0x35,0x21,0x15,0x36)]='';continue;case'2':_0x1d0769[_0x382faa(-0x46,0x6d,0x20,0x35)][_0x382faa(0x81,-0x3,0x2e,-0x38)]=_0x25c2c9[_0x4b6ba0(0x12,-0x58,-0x27,-0x1)];continue;case'3':_0x2ea2e5[_0x382faa(-0x1e,-0x33,0x20,0x3f)][_0x382faa(-0x2c,0x8a,0x2e,0x6c)]=_0x25c2c9[_0x382faa(-0x6f,0x5a,-0x10,0x79)];continue;case'4':_0x58c74f[_0x4b6ba0(0x6b,0x19,0x9,-0x80)][_0x382faa(0x10,-0x1c,0x2e,0xab)]=_0x4b6ba0(0x96,0xb1,0x85,0x66);continue;}break;}}else _0x579fb6[_0x4b6ba0(-0x89,-0x68,-0x54,-0x96)](_0x25c2c9[_0x382faa(0x7c,0x68,0x63,0xa9)],_0xf42715);}}function removeNovelaiCharRefImage(){updateNovelaiCharRefImagePreview(null);function _0x2a6122(_0x5e225d,_0x3f95d5,_0x418110,_0x84190b){return _0x3b3710(_0x5e225d-0x1d2,_0x5e225d- -0x138,_0x84190b,_0x84190b-0x14a);}dbs[_0x2a6122(0x23e,0x1f3,0x24c,0x201)+'e'](NAI_CHAR_REF_CACHE_KEY);}async function handleNovelaiCharRefImageUpload(_0x82a3b4){function _0x3ed787(_0x48cede,_0x27b034,_0x3c178b,_0x43969d){return _0x496e5d(_0x48cede-0x72,_0x3c178b- -0x43d,_0x48cede,_0x43969d-0x164);}const _0x7a82fb={'ReDwM':_0x3ed787(-0x77,-0x62,0x2,-0x6f),'vAiim':_0x1fc5a1(0x2da,0x2f4,0x357,0x2e8)+'x','gutBX':'3|5|4|2|0|'+'1','pcmaI':'none','KtiPF':_0x3ed787(-0x4b,0x6d,0x2d,-0xc),'wuxkL':function(_0x153279,_0x3e70e5){return _0x153279===_0x3e70e5;},'diNEi':_0x3ed787(-0x117,-0x101,-0xc2,-0x3c),'uMQgi':function(_0x22acad,_0x2c06a3){return _0x22acad(_0x2c06a3);},'HHBxs':function(_0x95106,_0x47af86){return _0x95106(_0x47af86);},'xzDlB':function(_0x3729b5,_0x51f6a5){return _0x3729b5!==_0x51f6a5;},'NIXRd':_0x3ed787(-0x34,-0xf2,-0xb0,-0xb7),'ZwSXw':_0x1fc5a1(0x251,0x2b1,0x244,0x2c0)+_0x1fc5a1(0x3c6,0x377,0x306,0x3d6)+'elAI\x20char\x20'+_0x1fc5a1(0x287,0x2f0,0x30f,0x30e),'ZjzOG':function(_0x15c2e4,_0x5513d8){return _0x15c2e4(_0x5513d8);},'tgGmm':function(_0xa6ae49,_0x2edc94){return _0xa6ae49+_0x2edc94;},'TvwNd':_0x3ed787(-0x123,-0xea,-0xa5,-0xa2)};function _0x1fc5a1(_0x329880,_0x1e6989,_0xe86e88,_0x142b89){return _0x496e5d(_0x329880-0x9e,_0x1e6989- -0xe1,_0xe86e88,_0x142b89-0x1d9);}const _0x31a536=_0x82a3b4['target'][_0x1fc5a1(0x334,0x2ea,0x2cc,0x278)][-0x24bd+-0x669+0x7*0x62a];if(!_0x31a536)return;try{if(_0x7a82fb[_0x1fc5a1(0x30d,0x310,0x2e5,0x2d9)](_0x7a82fb[_0x1fc5a1(0x348,0x38a,0x36f,0x34f)],_0x7a82fb[_0x1fc5a1(0x31a,0x38a,0x324,0x3b4)])){const _0x484054=await _0x7a82fb['uMQgi'](processUploadedImage,_0x31a536);_0x7a82fb[_0x1fc5a1(0x2a2,0x2e6,0x2f7,0x297)](updateNovelaiCharRefImagePreview,_0x484054);}else{_0x5d6c4b[_0x3ed787(-0x31,-0x37,-0x5a,-0x8)]=_0x11c7a8,_0x12754b[_0x3ed787(0x7,-0x8f,-0x4f,-0xe)][_0x1fc5a1(0x399,0x31b,0x2ad,0x30d)]=_0x7a82fb[_0x1fc5a1(0x39d,0x331,0x2ef,0x2d1)],_0x347f77[_0x3ed787(0x34,-0xa4,-0x4f,-0xce)]['display']='none',_0x2d474e[_0x1fc5a1(0x34e,0x30d,0x2e1,0x31a)][_0x3ed787(0x3,-0x37,-0x41,-0x5f)]=_0x7a82fb['vAiim'];const _0x1525c4=_0x3ec388[_0x3ed787(-0x72,-0x2b,-0xa7,-0x9b)](','),_0x296e16=_0x1525c4[-0xfd0+0x23a7+-0x13d7]['split'](':')[-0x24*-0xb7+0x1c96+0x1b*-0x203][_0x3ed787(-0x90,-0x29,-0xa7,-0x42)](';')[-0x1b18+0x1f04*0x1+-0x1*0x3ec];_0x3690ad=_0x296e16,_0x2ba8fe[_0x1fc5a1(0x2e8,0x339,0x33d,0x38e)+_0x1fc5a1(0x2bd,0x31c,0x326,0x39c)+'e']=_0x1525c4[-0xb*0x27+0x10*-0x21+0x3be];const _0x5f40c7={};_0x5f40c7['id']=_0x45df60,_0x5f40c7[_0x3ed787(-0x10c,-0xb7,-0xb2,-0x7f)]=_0x38ce24,_0x4639d7[_0x3ed787(-0x94,0x31,-0x39,0x2c)+_0x3ed787(-0x54,-0x5,-0x1e,-0x8e)](_0x5f40c7);}}catch(_0x4854d0){if(_0x7a82fb[_0x3ed787(-0x123,-0x99,-0xcd,-0x146)](_0x7a82fb[_0x3ed787(-0x7f,-0x13,0x9,0x25)],_0x7a82fb[_0x1fc5a1(0x33c,0x365,0x3b2,0x34f)])){const _0x272c1e=_0x7a82fb[_0x3ed787(-0x99,-0x90,-0x16,-0x8b)][_0x1fc5a1(0x2e9,0x2b5,0x304,0x2f2)]('|');let _0x5152e3=-0x3ce*0x4+-0x220d+0x1*0x3145;while(!![]){switch(_0x272c1e[_0x5152e3++]){case'0':_0xc843fc[_0x3ed787(0x4,-0x5f,0x7,-0x5)+_0x1fc5a1(0x2d1,0x297,0x22d,0x21d)]=null;continue;case'1':_0x112f2a=null;continue;case'2':_0x337c8d[_0x3ed787(-0xa2,-0xcd,-0x4f,-0xa7)]['display']=_0x7a82fb[_0x1fc5a1(0x283,0x2a3,0x27d,0x296)];continue;case'3':_0xf22f90[_0x3ed787(0x1d,-0x30,-0x5a,-0x3c)]='';continue;case'4':_0x333dfa[_0x1fc5a1(0x2b5,0x30d,0x31a,0x38e)][_0x3ed787(-0x13,-0x2a,-0x41,0x31)]=_0x7a82fb[_0x3ed787(0xa7,0x79,0x25,-0x3f)];continue;case'5':_0x41c0da[_0x3ed787(-0xc8,-0x4a,-0x4f,-0xa8)]['display']=_0x7a82fb[_0x1fc5a1(0x30f,0x2a3,0x26e,0x31a)];continue;}break;}}else console[_0x3ed787(-0x65,-0x55,-0xac,-0x108)](_0x7a82fb[_0x3ed787(-0x2b,-0x48,0x8,0x6)],_0x4854d0),_0x7a82fb[_0x3ed787(-0x6e,-0x98,-0x1f,-0x2)](alert,_0x7a82fb['tgGmm'](_0x7a82fb[_0x1fc5a1(0x398,0x36d,0x306,0x322)],_0x4854d0[_0x3ed787(-0x8d,-0x4e,-0x12,0x6e)]));}}function _0x3c9d(_0x37fb83,_0x3e1743){_0x37fb83=_0x37fb83-(0x1ed9+-0xf8d+-0x3*0x4c0);const _0xbccdb5=_0x2add();let _0x2d0a6b=_0xbccdb5[_0x37fb83];if(_0x3c9d['GJbkxb']===undefined){var _0x56b583=function(_0x10950d){const _0x3a77ea='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x20efd1='',_0x19d09b='',_0x3d24e8=_0x20efd1+_0x56b583;for(let _0x2da7ae=0xa97+-0x1*-0x1b47+-0x25de,_0x4f41d2,_0x264c1b,_0xd3c2a7=0x1*0x3c4+-0x1b70+0x17ac;_0x264c1b=_0x10950d['charAt'](_0xd3c2a7++);~_0x264c1b&&(_0x4f41d2=_0x2da7ae%(0x128e+-0x1c6e+0x9e4)?_0x4f41d2*(-0x1a6+0x2*0xe13+-0x1a40)+_0x264c1b:_0x264c1b,_0x2da7ae++%(-0x24aa+0x1*0xa60+0x1a4e))?_0x20efd1+=_0x3d24e8['charCodeAt'](_0xd3c2a7+(0x1e56+-0x19d2+-0x47a))-(0x2171+0x1b70+-0x3cd7)!==-0x6a4+-0x3*-0x5ef+-0x1*0xb29?String['fromCharCode'](0x17*-0x18a+-0x116*-0xa+0x1989&_0x4f41d2>>(-(0xb*-0x1a2+-0xc50*-0x2+-0x6a8)*_0x2da7ae&-0x6*0x221+0x2*-0xb7b+0x23c2)):_0x2da7ae:-0x71*0x1f+0x537+0x8*0x10f){_0x264c1b=_0x3a77ea['indexOf'](_0x264c1b);}for(let _0x4c18ae=0x43c+-0xa*-0x164+-0x1*0x1224,_0x3bdc22=_0x20efd1['length'];_0x4c18ae<_0x3bdc22;_0x4c18ae++){_0x19d09b+='%'+('00'+_0x20efd1['charCodeAt'](_0x4c18ae)['toString'](-0x26*-0x66+-0x124f+0x33b))['slice'](-(-0x1*-0x98f+-0xbc2+0x235));}return decodeURIComponent(_0x19d09b);};_0x3c9d['HLGdNK']=_0x56b583,_0x3c9d['ZIxCdU']={},_0x3c9d['GJbkxb']=!![];}const _0x128965=_0xbccdb5[0x1b42+-0x913+-0x122f],_0x4cb3ec=_0x37fb83+_0x128965,_0x28e613=_0x3c9d['ZIxCdU'][_0x4cb3ec];if(!_0x28e613){const _0x2893c9=function(_0x7198b3){this['vFtwjB']=_0x7198b3,this['RJlyuT']=[0x1100*-0x1+-0x83c+0x193d,0x1*0x3f1+-0x1f9+0x15*-0x18,0x778+-0x32*-0x3a+0x12cc*-0x1],this['zycAjJ']=function(){return'newState';},this['KsOBkZ']='\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*',this['fwoUqQ']='[\x27|\x22].+[\x27|\x22];?\x20*}';};_0x2893c9['prototype']['qBWwGR']=function(){const _0x56ca3a=new RegExp(this['KsOBkZ']+this['fwoUqQ']),_0x14de3b=_0x56ca3a['test'](this['zycAjJ']['toString']())?--this['RJlyuT'][0x2524+-0x9ef*0x3+-0x756]:--this['RJlyuT'][0x2689+-0x2*0xde2+-0xac5*0x1];return this['vYLWwz'](_0x14de3b);},_0x2893c9['prototype']['vYLWwz']=function(_0x521ea4){if(!Boolean(~_0x521ea4))return _0x521ea4;return this['kDlLTZ'](this['vFtwjB']);},_0x2893c9['prototype']['kDlLTZ']=function(_0x19ac87){for(let _0x2c8390=0x1638+-0x1b2d+0x1b*0x2f,_0x150a85=this['RJlyuT']['length'];_0x2c8390<_0x150a85;_0x2c8390++){this['RJlyuT']['push'](Math['round'](Math['random']())),_0x150a85=this['RJlyuT']['length'];}return _0x19ac87(this['RJlyuT'][0x34*-0x75+-0x2274+0x3a38]);},new _0x2893c9(_0x3c9d)['qBWwGR'](),_0x2d0a6b=_0x3c9d['HLGdNK'](_0x2d0a6b),_0x3c9d['ZIxCdU'][_0x4cb3ec]=_0x2d0a6b;}else _0x2d0a6b=_0x28e613;return _0x2d0a6b;}function updateComfyUIImagePreview(_0x133eb5){const _0xfffc0e={};_0xfffc0e[_0x542787(0x22d,0x28c,0x1f8,0x28b)]=_0x542787(0x228,0x28b,0x1b3,0x1a9)+_0x542787(0x274,0x201,0x291,0x1fb),_0xfffc0e[_0x38826c(0x24b,0x29f,0x2cb,0x2f4)]=_0x38826c(0x2eb,0x26c,0x254,0x28a)+_0x542787(0x22a,0x217,0x207,0x1ed)+_0x38826c(0x387,0x338,0x334,0x37b)+_0x542787(0x2ce,0x2f7,0x295,0x313)+_0x542787(0x2c3,0x293,0x345,0x2a4)+_0x38826c(0x31f,0x321,0x2e0,0x3a1)+'r',_0xfffc0e['ymKTP']='comfyui-re'+_0x542787(0x2d7,0x255,0x2ca,0x2ec)+'-btn',_0xfffc0e[_0x38826c(0x272,0x2b9,0x2f6,0x247)]=_0x542787(0x23c,0x1e0,0x2b1,0x248)+'x',_0xfffc0e[_0x542787(0x287,0x288,0x2c4,0x2a2)]=_0x38826c(0x364,0x366,0x339,0x38b)+'0',_0xfffc0e[_0x542787(0x248,0x2b9,0x29d,0x28a)]=_0x542787(0x226,0x287,0x1e7,0x27e);function _0x38826c(_0x59d7da,_0x3cd1d0,_0x5bdbb9,_0x2b9fce){return _0x496e5d(_0x59d7da-0x8f,_0x3cd1d0- -0x102,_0x2b9fce,_0x2b9fce-0xb8);}_0xfffc0e[_0x542787(0x231,0x25b,0x299,0x295)]=_0x542787(0x2d1,0x26f,0x249,0x340);function _0x542787(_0x25495f,_0x4f8e48,_0x2320da,_0x29676a){return _0x496e5d(_0x25495f-0x102,_0x25495f- -0x199,_0x4f8e48,_0x29676a-0x154);}const _0x2e7d72=_0xfffc0e,_0x21a382=document[_0x542787(0x26c,0x26f,0x234,0x238)+'ById'](_0x2e7d72['JFzDe']),_0x21e899=document['querySelec'+_0x542787(0x21f,0x20a,0x26c,0x20c)](_0x2e7d72[_0x38826c(0x2c7,0x29f,0x319,0x2df)]),_0xbe3aed=document[_0x38826c(0x283,0x303,0x37d,0x27e)+_0x542787(0x290,0x24b,0x28d,0x252)](_0x2e7d72[_0x542787(0x27e,0x28c,0x2ae,0x26e)]);_0x21a382[_0x542787(0x24a,0x21c,0x213,0x20c)]&&_0x21a382['src'][_0x38826c(0x349,0x2e0,0x35f,0x2cf)](_0x38826c(0x341,0x2d4,0x276,0x341))&&_0x21a382[_0x38826c(0x34a,0x2e1,0x2cd,0x335)]!==_0x133eb5&&URL[_0x38826c(0x316,0x33a,0x2e8,0x341)+_0x542787(0x2c6,0x2b9,0x256,0x32f)](_0x21a382[_0x38826c(0x283,0x2e1,0x337,0x2b5)]);if(_0x133eb5)_0x21a382[_0x542787(0x24a,0x1eb,0x287,0x251)]=_0x133eb5,_0x21a382['style'][_0x542787(0x263,0x1f8,0x267,0x1f7)]='block',_0x21e899[_0x542787(0x255,0x241,0x277,0x2c8)][_0x542787(0x263,0x200,0x1de,0x20e)]='none',_0xbe3aed[_0x38826c(0x268,0x2ec,0x36a,0x2ac)][_0x38826c(0x2cb,0x2fa,0x341,0x2bb)]=_0x2e7d72['Dcpot'];else{const _0x3a7734=_0x2e7d72[_0x38826c(0x38d,0x31e,0x348,0x37d)][_0x542787(0x1fd,0x1d0,0x213,0x1e0)]('|');let _0x212df5=-0x15b9*-0x1+0x20e6+-0x369f;while(!![]){switch(_0x3a7734[_0x212df5++]){case'0':comfyuiImageObjectURL=null;continue;case'1':_0x21a382[_0x542787(0x24a,0x26b,0x20c,0x255)]='';continue;case'2':_0x21a382[_0x542787(0x255,0x292,0x1e3,0x26e)][_0x38826c(0x2f1,0x2fa,0x32e,0x2f2)]=_0x2e7d72['ZIvkK'];continue;case'3':window['comfyuican'+_0x542787(0x1df,0x253,0x1ef,0x249)]=null;continue;case'4':_0x21e899[_0x542787(0x255,0x208,0x274,0x295)]['display']=_0x2e7d72[_0x542787(0x231,0x28e,0x1b3,0x251)];continue;case'5':_0xbe3aed[_0x38826c(0x2e4,0x2ec,0x280,0x26b)][_0x38826c(0x341,0x2fa,0x347,0x303)]=_0x2e7d72[_0x542787(0x248,0x2bb,0x259,0x208)];continue;}break;}}}function removeComfyUIImage(){function _0x507063(_0x9a7ab,_0x5ca7e4,_0x392cbb,_0x3066d7){return _0x3b3710(_0x9a7ab-0xf7,_0x392cbb- -0xc5,_0x3066d7,_0x3066d7-0x13d);}updateComfyUIImagePreview(null),dbs[_0x507063(0x272,0x25c,0x2b1,0x31f)+'e'](COMFYUI_REF_CACHE_KEY);}async function handleImageUpload2(_0x5c692d){const _0x118bac={'dYeHq':'imageInput'+_0x3db556(-0x200,-0x1f7,-0x1ee,-0x21b),'fQDsk':function(_0x295927,_0xce473b){return _0x295927===_0xce473b;},'WgtTI':_0x58314c(0x8e,0x89,0xf4,0x76),'fJuLK':function(_0x504158,_0x2f988d){return _0x504158(_0x2f988d);},'yVGrF':function(_0x57b379,_0x564d23){return _0x57b379(_0x564d23);},'ZbORd':'image','txhHF':function(_0x764499){return _0x764499();},'BwuSH':'POST','KYvIQ':function(_0x16097c,_0x4afbb3){return _0x16097c===_0x4afbb3;},'UWhJK':_0x3db556(-0x18f,-0x195,-0x175,-0x1a4),'lzRaq':'PoIzN','CDLcE':function(_0x3e592c,_0x40d751){return _0x3e592c(_0x40d751);},'GSsgK':function(_0x1a2e49,_0x2e6dfe){return _0x1a2e49+_0x2e6dfe;},'tDGqZ':_0x58314c(0x2b,-0x2,-0x3f,-0x36),'CFgVc':function(_0x48c143){return _0x48c143();},'FcqPz':'图片处理或上传时出错'+':\x20','caWNw':_0x3db556(-0x20e,-0x1f3,-0x253,-0x1a3)+':'},_0x16c029=extension_settings[extensionName],_0x31aef0=_0x5c692d['target'][_0x58314c(0x4e,0x5b,0x12,-0x10)][0x1e99+-0x1a94+-0x1*0x405];function _0x3db556(_0x2fa7ea,_0x70ceb3,_0x21a630,_0xf63bbe){return _0x496e5d(_0x2fa7ea-0xc6,_0x2fa7ea- -0x5a7,_0xf63bbe,_0xf63bbe-0xb2);}function _0x58314c(_0x5f9a2d,_0x1fd5f2,_0x164f0e,_0x2fd17b){return _0x3b3710(_0x5f9a2d-0x1e7,_0x2fd17b- -0x3c9,_0x5f9a2d,_0x2fd17b-0xbb);}if(!_0x31aef0)return;try{if(_0x118bac[_0x3db556(-0x138,-0xfe,-0xb5,-0x158)](_0x3db556(-0x15f,-0x17f,-0x1b9,-0x146),_0x118bac[_0x3db556(-0x174,-0x108,-0x148,-0xff)])){const _0xb93ef5=_0x2b8a78[_0x3db556(-0x22b,-0x1d1,-0x1b7,-0x218)](_0x3666ca,arguments);return _0x26a379=null,_0xb93ef5;}else{const _0xe27feb=await _0x118bac[_0x58314c(-0x3,0xa,-0xac,-0x33)](processUploadedImageToBlob,_0x31aef0),_0x56db8e=URL[_0x58314c(-0xb0,-0xbd,0x4a,-0x39)+_0x58314c(0x100,0xe,0x84,0x84)](_0xe27feb);comfyuiImageObjectURL=_0x56db8e,_0x118bac[_0x58314c(0x77,0x28,0xf,0x67)](updateComfyUIImagePreview,_0x56db8e);const _0xd6c921=new FormData();_0xd6c921['append'](_0x118bac[_0x3db556(-0x1ca,-0x157,-0x24d,-0x235)],_0xe27feb,_0x31aef0[_0x3db556(-0x15c,-0x140,-0x149,-0xe6)]);let _0x332c34=_0x16c029['comfyuiUrl']['trim']();if(!_0x332c34){_0x118bac[_0x3db556(-0x1ff,-0x25f,-0x27a,-0x1ef)](alert,'请先设置ComfyU'+'I\x20API地址。'),_0x118bac[_0x3db556(-0x1f9,-0x237,-0x20d,-0x20d)](removeComfyUIImage);return;}const _0x792193={};_0x792193[_0x58314c(-0xbc,-0x98,-0x20,-0x3c)]=_0x118bac[_0x3db556(-0x1e7,-0x1c2,-0x196,-0x20d)],_0x792193[_0x58314c(0x89,0x21,0x69,0x83)]=_0xd6c921;const _0x3754b9=await fetch(_0x332c34+('/upload/im'+_0x3db556(-0x1b7,-0x1a9,-0x18a,-0x162)),_0x792193);if(_0x3754b9['ok']){if(_0x118bac[_0x58314c(-0x88,0x34,-0x85,-0x40)](_0x118bac[_0x3db556(-0x18c,-0x13d,-0x1b0,-0x1c3)],_0x118bac['lzRaq']))_0x4447ab[_0x58314c(0x53,-0xf,0x6,0x2a)+_0x58314c(0x11,0x89,0xc9,0x4e)](_0x118bac[_0x3db556(-0x235,-0x1fc,-0x1b4,-0x2ba)])[_0x58314c(-0x53,-0x1e,-0x1d,-0x26)]();else{const _0xf3c7c4=await _0x3754b9[_0x3db556(-0x150,-0x17b,-0x13e,-0x19b)]();window[_0x3db556(-0x163,-0x17f,-0x16e,-0x131)+_0x58314c(-0x52,-0x81,-0x2a,-0x63)]=_0xf3c7c4[_0x58314c(0x90,0x30,0x67,0x70)],_0x118bac['CDLcE'](addLog,_0x58314c(0x28,0x1,-0x2a,-0x54)+_0x3db556(-0x169,-0x18b,-0x171,-0x107)+JSON[_0x3db556(-0x23c,-0x208,-0x29f,-0x1fb)](_0xf3c7c4)),console[_0x3db556(-0x212,-0x258,-0x297,-0x1bd)](_0x58314c(-0x25,-0x5e,-0x30,0xc)+_0x3db556(-0x147,-0x12e,-0x15f,-0x1ab),_0xf3c7c4);const _0x8277fe=new FileReader();_0x8277fe[_0x3db556(-0x191,-0x1e3,-0x160,-0x170)]=()=>{const _0x48f948=_0x8277fe['result'];function _0x21a4fd(_0x416693,_0x3c94a5,_0x3f03ef,_0x54832a){return _0x58314c(_0x416693,_0x3c94a5-0x56,_0x3f03ef-0x1d,_0x3f03ef-0x1b2);}const _0x13fd57={};_0x13fd57['data']=_0x48f948,_0x13fd57[_0x26f004(0x476,0x4cf,0x4ab,0x540)+'Name']=_0xf3c7c4[_0x21a4fd(0x236,0x22e,0x222,0x1df)];function _0x26f004(_0x435148,_0x1c3a9b,_0xb6606e,_0x98687c){return _0x3db556(_0x1c3a9b-0x605,_0x1c3a9b-0x59,_0xb6606e-0x11f,_0x98687c);}const _0x4e00c1=_0x13fd57,_0x2d566c={};_0x2d566c['id']=COMFYUI_REF_CACHE_KEY,_0x2d566c[_0x21a4fd(0x1b2,0x10b,0x162,0x158)]=_0x4e00c1,dbs[_0x21a4fd(0x1ed,0x210,0x1db,0x15d)+_0x21a4fd(0x171,0x181,0x1f6,0x247)](_0x2d566c);},_0x8277fe[_0x3db556(-0x244,-0x1d9,-0x1f8,-0x1d4)+_0x3db556(-0x1c9,-0x1c6,-0x16b,-0x1b0)](_0xe27feb);}}else{const _0xa1a2ac=await _0x3754b9[_0x58314c(-0x89,-0x31,-0xda,-0x65)]();_0x118bac[_0x3db556(-0x165,-0x175,-0x100,-0x1e0)](alert,_0x118bac[_0x58314c(-0x96,-0x80,-0x4c,-0x61)](_0x3db556(-0x1b3,-0x200,-0x135,-0x12b),_0xa1a2ac)),_0x118bac[_0x58314c(-0x56,-0x73,-0xa2,-0x33)](addLog,'图片上传失败,\x20错误'+_0x3db556(-0x1fb,-0x1a7,-0x20f,-0x22c)+_0xa1a2ac),console['error'](_0x118bac[_0x58314c(-0x101,-0x83,-0xf1,-0x79)],_0xa1a2ac),_0x118bac[_0x58314c(0x55,0x48,-0xc,-0xb)](removeComfyUIImage);}}}catch(_0x1c544d){_0x118bac[_0x58314c(-0xaf,-0x2e,-0xb3,-0x33)](alert,_0x118bac['GSsgK'](_0x118bac[_0x58314c(-0x8f,-0x58,-0xa3,-0x59)],_0x1c544d[_0x3db556(-0x17c,-0x121,-0x106,-0x190)])),console[_0x3db556(-0x216,-0x1d5,-0x295,-0x268)](_0x118bac['caWNw'],_0x1c544d),_0x118bac['CDLcE'](addLog,'图片上传失败,\x20错误'+'详情:\x20'+JSON[_0x3db556(-0x23c,-0x205,-0x28c,-0x20b)](_0x1c544d)),_0x118bac[_0x3db556(-0x1d7,-0x234,-0x199,-0x254)](removeComfyUIImage);}}async function loadCachedImages(){const _0x183f6f={'uKbvy':function(_0x19b283,_0x148661){return _0x19b283(_0x148661);},'KFqca':function(_0x5b3577,_0x1318b3){return _0x5b3577+_0x1318b3;},'wrxYs':_0x4cfcb3(0x500,0x55e,0x57d,0x484)+':\x20','nhfto':'图片处理或上传时出错'+':','hPrUl':function(_0x21f022){return _0x21f022();},'imful':function(_0x1756e0){return _0x1756e0();},'jSuMG':_0x4cfcb3(0x59d,0x5dd,0x5b7,0x5eb),'YllQH':_0x4cfcb3(0x526,0x52e,0x531,0x4bd),'OmXsf':_0x4cfcb3(0x5d1,0x579,0x608,0x616),'ORSUv':'previewIma'+'ge_nai_cha'+'r_ref','tNPTg':_0x42ca5e(0x3e7,0x36b,0x3b5,0x318)+'har-ref-im'+_0x42ca5e(0x362,0x317,0x317,0x39a)+'w-containe'+_0x4cfcb3(0x5ba,0x575,0x538,0x5a7)+_0x4cfcb3(0x4d8,0x55e,0x452,0x4a7)+_0x42ca5e(0x354,0x3ae,0x3e9,0x3c3),'SypPi':_0x4cfcb3(0x546,0x521,0x50c,0x4d2)+_0x42ca5e(0x3f0,0x3ee,0x441,0x3d4)+_0x42ca5e(0x2f6,0x33b,0x2f0,0x349)+_0x4cfcb3(0x53b,0x553,0x525,0x526),'JTTbK':_0x4cfcb3(0x53c,0x4f0,0x5bc,0x593)+'x','LjUYP':'4|1|2|3|0','XeuJL':function(_0x125767,_0x1e8266){return _0x125767===_0x1e8266;},'pzMRG':_0x42ca5e(0x382,0x387,0x402,0x33d),'TxYEo':function(_0x30ca57,_0x2c53b4){return _0x30ca57!==_0x2c53b4;},'YbyyA':_0x4cfcb3(0x50b,0x4f2,0x4d1,0x487),'FEQUf':'Error\x20load'+_0x42ca5e(0x448,0x3d1,0x3fa,0x3b0)+'\x20NovelAI\x20V'+_0x42ca5e(0x408,0x388,0x3cb,0x3d5),'FVrRD':_0x4cfcb3(0x512,0x4fb,0x4cd,0x4fa),'gaaUv':function(_0x2ddcb4,_0x2fc738){return _0x2ddcb4===_0x2fc738;},'tbeyk':_0x42ca5e(0x290,0x300,0x2ac,0x314),'vtkrd':_0x42ca5e(0x2d6,0x305,0x2cd,0x27e)+_0x4cfcb3(0x5a7,0x5e9,0x5a7,0x59d)+'\x20NovelAI\x20C'+_0x42ca5e(0x30f,0x344,0x3bd,0x317)+_0x42ca5e(0x3ee,0x3f4,0x452,0x46f),'GbDGw':function(_0x11c309,_0x55bf88){return _0x11c309!==_0x55bf88;},'uklIF':_0x42ca5e(0x441,0x403,0x447,0x43b),'htlmd':_0x42ca5e(0x3aa,0x37e,0x30a,0x3b6),'HEoUh':function(_0x20cb13,_0x2b21a5){return _0x20cb13(_0x2b21a5);},'JGjPV':function(_0x470d35,_0x1ae111){return _0x470d35===_0x1ae111;},'GKqZN':'string','tLFix':function(_0x54ed65,_0x37b284){return _0x54ed65(_0x37b284);},'rCQwS':_0x42ca5e(0x38b,0x30e,0x2c2,0x38c),'MxhHv':'tWSMg','XrXyv':_0x4cfcb3(0x4db,0x500,0x4e8,0x511)+_0x42ca5e(0x418,0x3d1,0x36a,0x417)+_0x42ca5e(0x393,0x31b,0x2d8,0x34e)+_0x4cfcb3(0x4e7,0x4ca,0x464,0x556)};await dbs['openDB']();function _0x4cfcb3(_0xe6647d,_0x222753,_0x5f2ccc,_0x3c28a4){return _0x496e5d(_0xe6647d-0xea,_0xe6647d-0x167,_0x222753,_0x3c28a4-0x130);}function _0x42ca5e(_0x3feac1,_0x3a9ec5,_0x5bf3f0,_0x1ede03){return _0x496e5d(_0x3feac1-0x131,_0x3a9ec5- -0x6f,_0x3feac1,_0x1ede03-0x75);}try{if(_0x183f6f[_0x4cfcb3(0x569,0x5c7,0x5d3,0x5de)](_0x183f6f[_0x4cfcb3(0x51e,0x56c,0x4da,0x4fa)],_0x183f6f[_0x42ca5e(0x385,0x348,0x301,0x365)])){const _0x1162de=await dbs['storeReadO'+_0x42ca5e(0x325,0x33a,0x396,0x375)](NAI_VIBE_CACHE_KEY);_0x1162de&&_0x1162de[_0x42ca5e(0x339,0x31c,0x38a,0x366)]&&(_0x183f6f['TxYEo'](_0x4cfcb3(0x50b,0x592,0x4f1,0x48f),_0x183f6f[_0x4cfcb3(0x57c,0x508,0x547,0x51d)])?(_0x183f6f[_0x42ca5e(0x445,0x3f6,0x3cd,0x37b)](_0x4b9f8a,_0x183f6f[_0x42ca5e(0x290,0x2f6,0x2ee,0x340)](_0x183f6f[_0x42ca5e(0x3eb,0x390,0x3f7,0x310)],_0x44ecf9['message'])),_0x55f0e4[_0x42ca5e(0x2a5,0x322,0x33a,0x334)](_0x183f6f['nhfto'],_0x5ac31c),_0x4e1a95(_0x42ca5e(0x3dc,0x375,0x367,0x34d)+_0x4cfcb3(0x513,0x55a,0x54f,0x4be)+_0x3228bd[_0x4cfcb3(0x4d2,0x47d,0x544,0x4d3)](_0x22de7d)),_0x183f6f[_0x4cfcb3(0x5d3,0x61d,0x5ae,0x564)](_0x4742f6)):_0x183f6f[_0x42ca5e(0x39d,0x3f6,0x467,0x38b)](updateNovelaiImagePreview,_0x1162de[_0x42ca5e(0x315,0x31c,0x2d5,0x323)]));}else _0xce23b0(_0xdd24a7[_0x4cfcb3(0x4f2,0x515,0x494,0x4e1)]);}catch(_0x35ed21){console[_0x4cfcb3(0x4f8,0x493,0x538,0x48b)](_0x183f6f[_0x42ca5e(0x29f,0x324,0x351,0x2d3)],_0x35ed21);}try{const _0x3839e1=await dbs['storeReadO'+_0x42ca5e(0x311,0x33a,0x2c5,0x308)](NAI_CHAR_REF_CACHE_KEY);_0x3839e1&&_0x3839e1[_0x4cfcb3(0x4f2,0x54e,0x4b0,0x570)]&&(_0x183f6f[_0x4cfcb3(0x578,0x4f8,0x599,0x4ff)](_0x183f6f[_0x42ca5e(0x3e4,0x37b,0x346,0x3c9)],_0x183f6f['FVrRD'])?(_0x183f6f['uKbvy'](_0x58697d,null),_0x2626e8[_0x42ca5e(0x389,0x319,0x29f,0x2e8)+'e'](_0x4528fd)):_0x183f6f[_0x42ca5e(0x398,0x3f6,0x3cc,0x3df)](updateNovelaiCharRefImagePreview,_0x3839e1[_0x4cfcb3(0x4f2,0x4a2,0x4a1,0x4b5)]));}catch(_0x1eeacc){_0x183f6f[_0x42ca5e(0x2fc,0x360,0x3e2,0x322)](_0x4cfcb3(0x58d,0x601,0x589,0x5b6),_0x183f6f['tbeyk'])?_0x183f6f[_0x42ca5e(0x3f5,0x39b,0x35b,0x371)](_0x263359):console['error'](_0x183f6f[_0x42ca5e(0x2f9,0x334,0x32a,0x33c)],_0x1eeacc);}try{if(_0x183f6f[_0x4cfcb3(0x4fe,0x487,0x563,0x48c)](_0x183f6f['uklIF'],_0x42ca5e(0x301,0x343,0x2ce,0x3a6))){const _0x453f5f=await dbs[_0x42ca5e(0x2a7,0x2fd,0x280,0x355)+_0x4cfcb3(0x510,0x591,0x52e,0x4e8)](COMFYUI_REF_CACHE_KEY);if(_0x453f5f&&_0x453f5f['data']&&_0x453f5f[_0x4cfcb3(0x4f2,0x51b,0x568,0x490)]['data']&&_0x453f5f[_0x42ca5e(0x2ed,0x31c,0x2a8,0x34f)][_0x42ca5e(0x422,0x402,0x37a,0x45d)+'Name']){if(_0x183f6f['htlmd']===_0x183f6f[_0x4cfcb3(0x4cb,0x4b5,0x4ae,0x4c7)]){const _0x1a7a9a=_0x453f5f[_0x42ca5e(0x2eb,0x31c,0x363,0x2e3)],_0x321d61=await _0x183f6f[_0x4cfcb3(0x58b,0x5cb,0x59f,0x5f0)](fetch,_0x1a7a9a['data']),_0x299c24=await _0x321d61[_0x42ca5e(0x35b,0x304,0x2b2,0x334)](),_0x3517e1=URL[_0x4cfcb3(0x509,0x584,0x4e1,0x4ef)+'ctURL'](_0x299c24);updateComfyUIImagePreview(_0x3517e1),comfyuiImageObjectURL=_0x3517e1,window[_0x4cfcb3(0x5ab,0x5b7,0x5fc,0x528)+_0x42ca5e(0x293,0x309,0x305,0x2a1)]=_0x1a7a9a['serverFile'+_0x42ca5e(0x381,0x31a,0x30f,0x38e)],_0x183f6f[_0x4cfcb3(0x5cc,0x64a,0x616,0x5e6)](addLog,_0x42ca5e(0x2c4,0x31f,0x387,0x385)+_0x4cfcb3(0x5bc,0x546,0x5b6,0x572)+_0x1a7a9a[_0x4cfcb3(0x5d8,0x61f,0x5d0,0x618)+_0x42ca5e(0x32c,0x31a,0x353,0x32c)]),console['log'](_0x4cfcb3(0x4ec,0x522,0x472,0x4c4)+'fyUI\x20image'+'\x20from\x20cach'+'e:\x20'+_0x1a7a9a['serverFile'+_0x4cfcb3(0x4f0,0x46c,0x529,0x543)]);}else _0x51c27f[_0x4cfcb3(0x5a3,0x59f,0x56a,0x5ae)+_0x4cfcb3(0x5c6,0x56a,0x544,0x5e6)](_0x5ac663[_0x4cfcb3(0x54a,0x585,0x51a,0x5c1)]);}else{if(_0x453f5f&&_0x183f6f[_0x42ca5e(0x475,0x3ff,0x38e,0x460)](typeof _0x453f5f[_0x42ca5e(0x2e0,0x31c,0x2cc,0x2a3)],_0x183f6f[_0x42ca5e(0x325,0x39f,0x316,0x369)])){const _0x4a471b=await fetch(_0x453f5f[_0x4cfcb3(0x4f2,0x571,0x492,0x497)]),_0x139313=await _0x4a471b['blob'](),_0x11c3fa=URL['createObje'+_0x42ca5e(0x41f,0x3f0,0x441,0x46e)](_0x139313);_0x183f6f[_0x4cfcb3(0x517,0x54f,0x59d,0x4dc)](updateComfyUIImagePreview,_0x11c3fa),comfyuiImageObjectURL=_0x11c3fa,console['warn'](_0x4cfcb3(0x4ec,0x4d2,0x4ac,0x548)+_0x42ca5e(0x391,0x34e,0x314,0x3a1)+_0x42ca5e(0x3b9,0x3c8,0x353,0x3b9)+_0x42ca5e(0x330,0x36d,0x350,0x385)+_0x42ca5e(0x30d,0x34b,0x3aa,0x2df)+'\x20re-upload'+_0x4cfcb3(0x562,0x4dc,0x5d0,0x5d2)+_0x42ca5e(0x30d,0x2fe,0x281,0x327)+_0x4cfcb3(0x516,0x4f9,0x54e,0x58b)+_0x42ca5e(0x43f,0x3de,0x3ee,0x45a));}}}else{const _0x323387=_0x183f6f['jSuMG']['split']('|');let _0x5a144d=0x2*-0xeaf+0x12*-0x90+0x277e;while(!![]){switch(_0x323387[_0x5a144d++]){case'0':_0x12a0d2[_0x4cfcb3(0x555,0x4d3,0x4cd,0x504)][_0x42ca5e(0x347,0x38d,0x3aa,0x3b2)]=_0x183f6f[_0x4cfcb3(0x5b1,0x5be,0x55e,0x5a4)];continue;case'1':_0x1372c2['nai3VibeTr'+_0x4cfcb3(0x564,0x594,0x5a9,0x5d7)+'e']=null;continue;case'2':_0xd77fb6[_0x42ca5e(0x3e4,0x37f,0x3ec,0x321)][_0x4cfcb3(0x563,0x56c,0x4f2,0x4f3)]=_0x183f6f[_0x4cfcb3(0x5b1,0x620,0x54e,0x61b)];continue;case'3':_0x564ae7[_0x42ca5e(0x369,0x37f,0x35d,0x3b0)][_0x4cfcb3(0x563,0x5c5,0x5b2,0x5af)]=_0x183f6f['OmXsf'];continue;case'4':_0xb50f03['src']='';continue;}break;}}}catch(_0x5cd08e){if(_0x183f6f[_0x4cfcb3(0x5d5,0x60c,0x5b1,0x634)](_0x183f6f['rCQwS'],_0x183f6f[_0x42ca5e(0x3e6,0x3a4,0x39c,0x368)])){const _0x185f6a=_0x10950d['getElement'+_0x42ca5e(0x42a,0x3ba,0x3a1,0x427)](_0x183f6f['ORSUv']),_0x4c846c=_0x3a77ea[_0x42ca5e(0x32e,0x38f,0x342,0x3ab)+_0x42ca5e(0x2c5,0x349,0x397,0x333)](_0x183f6f[_0x42ca5e(0x30c,0x331,0x367,0x317)]),_0x10df40=_0x20efd1['getElement'+_0x42ca5e(0x39f,0x3ba,0x3df,0x3c9)](_0x183f6f[_0x4cfcb3(0x530,0x53a,0x501,0x53d)]);if(_0x19d09b&&_0x3d24e8[_0x4cfcb3(0x549,0x500,0x5c9,0x5cf)](_0x4cfcb3(0x5d0,0x5a5,0x575,0x63a))){_0x185f6a[_0x4cfcb3(0x54a,0x5cf,0x57a,0x59e)]=_0x56ca3a,_0x185f6a[_0x42ca5e(0x31d,0x37f,0x314,0x2fc)][_0x42ca5e(0x40d,0x38d,0x31a,0x3f9)]=_0x42ca5e(0x433,0x3d0,0x3f0,0x363),_0x4c846c[_0x42ca5e(0x32e,0x37f,0x36e,0x3e2)]['display']=_0x183f6f[_0x4cfcb3(0x5b1,0x5e3,0x5c0,0x529)],_0x10df40[_0x42ca5e(0x349,0x37f,0x380,0x32e)][_0x42ca5e(0x367,0x38d,0x3d1,0x3e7)]=_0x183f6f[_0x4cfcb3(0x547,0x586,0x56d,0x580)];const _0x1df9a3=_0x14de3b[_0x42ca5e(0x34e,0x327,0x31b,0x320)](','),_0x280c48=_0x1df9a3[-0x884+-0x27*0x9d+0x206f][_0x42ca5e(0x2d8,0x327,0x352,0x2e1)](':')[0x1b93*-0x1+0x29d*-0x4+0x2608*0x1][_0x4cfcb3(0x4fd,0x4f0,0x4eb,0x539)](';')[-0x2*-0xe2c+-0xe38+-0x20*0x71];_0x521ea4=_0x280c48,_0x19ac87['nai3CharRe'+_0x42ca5e(0x34f,0x3cc,0x3e8,0x44b)]=_0x1df9a3[0x837+0x2*0xc77+-0x849*0x4];const _0xf202fe={};_0xf202fe['id']=_0x150a85,_0xf202fe[_0x42ca5e(0x373,0x31c,0x336,0x323)]=_0x2397b4,_0x2c8390[_0x42ca5e(0x3ac,0x395,0x3e4,0x3aa)+'rite'](_0xf202fe);}else{const _0x555403=_0x183f6f['LjUYP'][_0x42ca5e(0x383,0x327,0x360,0x355)]('|');let _0x325d87=-0x1591*0x1+0x2013+-0xa82;while(!![]){switch(_0x555403[_0x325d87++]){case'0':_0x2bf707[_0x4cfcb3(0x5a4,0x561,0x541,0x557)+_0x4cfcb3(0x5a2,0x5c6,0x5cc,0x5a8)]=null;continue;case'1':_0x185f6a[_0x42ca5e(0x3df,0x37f,0x3c6,0x375)][_0x42ca5e(0x332,0x38d,0x30b,0x3b8)]=_0x183f6f['YllQH'];continue;case'2':_0x4c846c[_0x4cfcb3(0x555,0x550,0x517,0x5c8)][_0x42ca5e(0x319,0x38d,0x30d,0x414)]=_0x183f6f[_0x4cfcb3(0x535,0x518,0x57a,0x4b4)];continue;case'3':_0x10df40[_0x42ca5e(0x300,0x37f,0x3c8,0x379)][_0x4cfcb3(0x563,0x559,0x578,0x55d)]=_0x183f6f['YllQH'];continue;case'4':_0x185f6a['src']='';continue;}break;}}}else console[_0x4cfcb3(0x4f8,0x4ff,0x4d9,0x484)](_0x183f6f[_0x42ca5e(0x416,0x397,0x357,0x325)],_0x5cd08e);}}export function initImageUpload(_0x35549c){const _0x3f072d={'yoLPm':_0x6dcbe6(-0x234,-0x2b2,-0x2ec,-0x2a8)+_0x5df0ae(0x43e,0x4b0,0x42b,0x4f4)+'ref','ZWcjX':function(_0xb447da,_0x448e79){return _0xb447da===_0x448e79;},'CcbJW':'XgYRR','GoAmc':_0x6dcbe6(-0x2d4,-0x2b2,-0x2e9,-0x311)+_0x5df0ae(0x44a,0x44f,0x4af,0x4bc),'QBpYw':function(_0x14d8f4){return _0x14d8f4();},'ZQWdv':function(_0x3ad430,_0x1de96c){return _0x3ad430(_0x1de96c);},'QPiuA':function(_0x48e6da,_0x4bc66a){return _0x48e6da!==_0x4bc66a;},'JseRT':_0x5df0ae(0x393,0x40e,0x3d9,0x439),'UvfkK':'imageInput'+'2','kJpjz':_0x5df0ae(0x44b,0x411,0x3e1,0x3c1)+_0x6dcbe6(-0x262,-0x256,-0x2be,-0x28e)+_0x6dcbe6(-0x167,-0x1b6,-0x1a9,-0x1af),'vLBqH':'click','LMpiV':'#imageInpu'+_0x6dcbe6(-0x19f,-0x1d7,-0x1fc,-0x23a),'AeFhF':_0x6dcbe6(-0x240,-0x1e1,-0x164,-0x203),'osdFP':_0x6dcbe6(-0x1f5,-0x24d,-0x1f6,-0x2ba)+_0x5df0ae(0x3ef,0x46d,0x481,0x4e5)+_0x6dcbe6(-0x252,-0x27c,-0x26e,-0x24a),'GoqbW':_0x6dcbe6(-0x1d1,-0x227,-0x240,-0x256)+_0x5df0ae(0x46a,0x4d4,0x457,0x4b3)+_0x5df0ae(0x3da,0x426,0x403,0x48e)+_0x5df0ae(0x495,0x42b,0x3b3,0x486),'TMZwg':_0x5df0ae(0x406,0x475,0x4b8,0x472)+'t2'};loadCachedImages(),_0x35549c[_0x5df0ae(0x439,0x49a,0x428,0x45d)](_0x3f072d['kJpjz'])['on'](_0x3f072d['vLBqH'],()=>{const _0x608981={};function _0x27123d(_0x30d080,_0xc7c24,_0x201701,_0x16b2dc){return _0x6dcbe6(_0x30d080,_0x201701-0x1be,_0x201701-0xdb,_0x16b2dc-0xd0);}_0x608981['qMCJA']=_0x3f072d[_0x27123d(0x45,-0x5d,0xa,0x41)];function _0x8fdd7f(_0x3c69c9,_0x29a630,_0x2bf17b,_0xb51478){return _0x5df0ae(_0x3c69c9-0xf1,_0x2bf17b- -0x6a8,_0xb51478,_0xb51478-0x118);}const _0x54bbbe=_0x608981;_0x3f072d['ZWcjX'](_0x3f072d[_0x27123d(-0x17,-0xb,-0x84,-0x58)],_0x8fdd7f(-0x165,-0x202,-0x1b7,-0x222))?document[_0x8fdd7f(-0x22c,-0x194,-0x1fb,-0x278)+_0x27123d(-0x1b,-0x1a,-0x33,-0x84)](_0x3f072d[_0x8fdd7f(-0x2ea,-0x2c2,-0x299,-0x291)])['click']():_0x42d915[_0x27123d(0x7,-0xb7,-0x57,-0x3)+_0x8fdd7f(-0x16e,-0x1f2,-0x1d7,-0x1b7)](_0x54bbbe[_0x27123d(-0xaa,-0x10e,-0xc8,-0xfc)])[_0x27123d(-0x97,-0x119,-0xa7,-0x67)]();}),_0x35549c[_0x6dcbe6(-0x257,-0x228,-0x293,-0x1b7)](_0x3f072d['LMpiV'])['on'](_0x3f072d['AeFhF'],handleNovelaiImageUpload);function _0x5df0ae(_0x58b301,_0x23e8f3,_0x52b59b,_0x38ad26){return _0x496e5d(_0x58b301-0xed,_0x23e8f3-0xa8,_0x52b59b,_0x38ad26-0x157);}_0x35549c['find'](_0x5df0ae(0x517,0x49b,0x512,0x4db)+_0x6dcbe6(-0x1c5,-0x1eb,-0x1e7,-0x1b0)+_0x6dcbe6(-0x1f9,-0x1b6,-0x22b,-0x165))['on'](_0x5df0ae(0x430,0x45d,0x3f1,0x497),()=>{function _0x24baeb(_0x3d953f,_0xf13b96,_0x8e1a4d,_0xbefed2){return _0x6dcbe6(_0x3d953f,_0x8e1a4d-0x64a,_0x8e1a4d-0x6,_0xbefed2-0xee);}_0x3f072d[_0x24baeb(0x448,0x3be,0x41c,0x401)](removeNovelaiImage);}),_0x35549c['find']('#novelai-s'+_0x6dcbe6(-0x224,-0x20a,-0x1da,-0x1f0)+_0x5df0ae(0x45a,0x426,0x465,0x41c)+'-btn')['on'](_0x3f072d[_0x6dcbe6(-0x163,-0x1c1,-0x167,-0x1fc)],()=>{function _0x2a4edb(_0x524d4b,_0x587b78,_0x11ca53,_0x209240){return _0x6dcbe6(_0x209240,_0x587b78-0x533,_0x11ca53-0x150,_0x209240-0x1cb);}function _0xd2af9(_0xe23c0b,_0x198157,_0x26f63c,_0x5e5c76){return _0x6dcbe6(_0x5e5c76,_0xe23c0b-0x565,_0x26f63c-0x1b2,_0x5e5c76-0xd5);}document['getElement'+'ById'](_0x3f072d[_0x2a4edb(0x318,0x37f,0x370,0x35a)])[_0xd2af9(0x300,0x2eb,0x2e2,0x2d8)]();}),_0x35549c['find'](_0x3f072d['osdFP'])['on'](_0x3f072d['AeFhF'],handleNovelaiCharRefImageUpload),_0x35549c[_0x5df0ae(0x4a8,0x49a,0x50e,0x4c3)](_0x3f072d[_0x6dcbe6(-0x1ea,-0x252,-0x213,-0x271)])['on'](_0x3f072d[_0x5df0ae(0x55f,0x501,0x4a6,0x57b)],()=>{function _0x2db845(_0x127467,_0x7dd5e0,_0x10a4a0,_0xf1bed7){return _0x6dcbe6(_0x7dd5e0,_0x127467-0xc3,_0x10a4a0-0x86,_0xf1bed7-0x188);}_0x3f072d[_0x2db845(-0x16b,-0x14f,-0x133,-0x1ee)](removeNovelaiCharRefImage);});function _0x6dcbe6(_0x5cdd3c,_0x201b16,_0x45ee91,_0x1da025){return _0x3b3710(_0x5cdd3c-0x8a,_0x201b16- -0x608,_0x5cdd3c,_0x1da025-0x34);}_0x35549c[_0x6dcbe6(-0x1af,-0x228,-0x267,-0x1c2)](_0x5df0ae(0x488,0x4a1,0x459,0x509)+_0x5df0ae(0x433,0x46c,0x4df,0x48e)+_0x5df0ae(0x4db,0x50c,0x51d,0x4d4))['on'](_0x3f072d['vLBqH'],()=>{function _0x58c02a(_0x4fc5d9,_0x4503e3,_0x1acc3f,_0x574fb4){return _0x5df0ae(_0x4fc5d9-0x130,_0x574fb4- -0x6d5,_0x1acc3f,_0x574fb4-0x16a);}function _0x4a6d71(_0x163a24,_0x1f2d64,_0x1a12b7,_0x2c99f8){return _0x6dcbe6(_0x163a24,_0x1f2d64-0x607,_0x1a12b7-0x2e,_0x2c99f8-0x5a);}const _0x4a3525={'ezACQ':function(_0x1cfe9a,_0x4496a2){function _0x23e4a7(_0x51f6f1,_0x17f472,_0x36a827,_0x32b3db){return _0x3c9d(_0x32b3db-0xdb,_0x17f472);}return _0x3f072d[_0x23e4a7(0x2da,0x335,0x277,0x2c6)](_0x1cfe9a,_0x4496a2);}};_0x3f072d[_0x58c02a(-0x23c,-0x21e,-0x1a7,-0x219)](_0x3f072d[_0x58c02a(-0x239,-0x26e,-0x203,-0x247)],_0x3f072d['JseRT'])?(_0x4a3525[_0x58c02a(-0x18e,-0x19c,-0x191,-0x200)](_0x38324,null),_0x248b88[_0x58c02a(-0x2ab,-0x31d,-0x28e,-0x2a5)+'e'](_0x1afc0c)):document[_0x4a6d71(0x3c2,0x3f2,0x40f,0x3ef)+'ById'](_0x3f072d[_0x58c02a(-0x1b4,-0x218,-0x2ac,-0x22d)])[_0x4a6d71(0x3df,0x3a2,0x3f1,0x324)]();}),_0x35549c[_0x5df0ae(0x41b,0x49a,0x422,0x41d)](_0x3f072d[_0x6dcbe6(-0x202,-0x1c8,-0x155,-0x21d)])['on'](_0x3f072d['AeFhF'],handleImageUpload2),_0x35549c['find'](_0x6dcbe6(-0x13c,-0x1c4,-0x198,-0x1cb)+_0x6dcbe6(-0x16c,-0x1eb,-0x204,-0x268)+_0x6dcbe6(-0x233,-0x1b6,-0x16e,-0x170))['on'](_0x5df0ae(0x459,0x45d,0x4d6,0x4a5),()=>{function _0x1a8a83(_0x2ec8c7,_0x154549,_0x4b4d08,_0x247c34){return _0x5df0ae(_0x2ec8c7-0x190,_0x154549- -0x67,_0x247c34,_0x247c34-0x7d);}_0x3f072d[_0x1a8a83(0x41a,0x42d,0x489,0x40b)](removeComfyUIImage);});}export{updateNovelaiImagePreview,updateNovelaiCharRefImagePreview,updateComfyUIImagePreview,nai3VibeTransferImageMimeType,nai3CharRefImageMimeType,comfyuiImageObjectURL};